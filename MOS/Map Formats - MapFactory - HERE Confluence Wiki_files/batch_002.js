;try {
/* module-key = 'com.atlassian.confluence.plugins.pagetree:pagetree-js-resources', location = 'soy/pagetree.soy' */
// This file was automatically generated from pagetree.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Pagetree.Macro.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Pagetree == 'undefined') { Confluence.Templates.Pagetree = {}; }
if (typeof Confluence.Templates.Pagetree.Macro == 'undefined') { Confluence.Templates.Pagetree.Macro = {}; }


Confluence.Templates.Pagetree.Macro.loadingIndicator = function(opt_data, opt_ignored) {
  return '<div class="plugin_pagetree_children_loading_wrapper"><div class="spinner"/><span class="plugin_pagetree_children_loading">' + soy.$$escapeHtml("Loading...") + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Pagetree.Macro.loadingIndicator.soyTemplateName = 'Confluence.Templates.Pagetree.Macro.loadingIndicator';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.pagetree:pagetree-js-resources', location = 'com/atlassian/confluence/plugins/pagetree/resource/javascript/pagetree.js' */
(function(){var A=function(M){this.$=M;
var H=this.$;
var b=999;
var c=true;
var K=false;
var W={};
var D={};
var N=function(k,j,f,i,e){if(j==undefined||j==null){j=!B(k)
}if(f==undefined||f==null){f=0
}if(!L(k,j)){var h=H("#children"+k);
if(Z(h)){var g=H("#plusminus"+k);
if(j==c){g.removeClass("icon-section-closed").addClass("icon-section-opened")
}else{g.removeClass("icon-section-opened").addClass("icon-section-closed")
}if(j==c){if(e==false){h.slideDown(300)
}else{h.removeClass("plugin-pagetree-hide-children");
h.animate({opacity:1})
}}else{if(e==false){h.slideUp(300)
}else{h.animate({opacity:0},{complete:function(){h.addClass("plugin-pagetree-hide-children")
}})
}}if(i){R(k)
}}else{J(k,new Array(),f,"",i,e)
}}if(i){R(k)
}};
var Z=function(e){return e.children("ul[id]").length>0
};
var B=function(f){var e=H("#plusminus"+f);
return(e.length>0)?(e.hasClass("icon-minus")||e.hasClass("icon-section-opened")):K
};
var L=function(f,e){return B(f)==e
};
var I=function(h,g,f){a(h,c,g,f)
};
var X=function(h,g,f){a(h,K,g,f)
};
var a=function(k,i,h,g){G(k);
var j=H("#"+k);
var f=j.find("div.plugin_pagetree_children_container");
f.each(function(e){var l=V(this.id);
N(l,i,b,e==f.length-1,g)
});
h.preventDefault();
h.stopPropagation()
};
var V=function(e){if(!e||e==undefined){return null
}if(e.indexOf("plusminus")!=-1){return e.substring("plusminus".length)
}if(e.indexOf("children")!=-1){return e.substring("children".length)
}return null
};
var C=function(e){if(!e||e==undefined){return null
}return S(e)[1]
};
var S=function(e){if(!e||e==undefined){return null
}return e.split("-")
};
var G=function(f){var e=C(f);
H("div.plugin_pagetree").each(function(g){if(g==e){H(this).find("span.plugin_pagetree_status").removeClass("hidden");
H(this).find("div.plugin_pagetree_expandcollapse").addClass("hidden")
}})
};
var R=function(f){var e=C(f);
H("div.plugin_pagetree").each(function(g){if(g==e){H(this).find("span.plugin_pagetree_status").addClass("hidden");
H(this).find("div.plugin_pagetree_expandcollapse").removeClass("hidden")
}})
};
var F=function(l,f,i,h,k,e,g){var j=W[l];
if(f=="Orphan"){j+="&hasRoot=false&spaceKey="+k
}else{j+="&hasRoot=true&pageId="+f
}j+="&treeId="+l+"&startDepth="+h+"&mobile="+g;
H.each(i,function(){j+="&ancestors="+this
});
j+="&treePageId="+e;
if(g==false){j=(AJS.params.serverUrl||"")+j
}return j
};
var Q=function(g){var f=g;
var e=null;
H("div.plugin_pagetree").each(function(h){if(h==f){e=H(this)
}});
return e
};
var P=function(e){var f=e.children("fieldset");
var g=new Object();
if(f.length>0){f.children("input").each(function(){g[this.name]=this.value
})
}return g
};
var O=function(e){var g=e.children("fieldset");
var h=new Array();
if(g.length>0){var f=g.children("fieldset");
if(f.length>0){f.children("input").each(function(){h.push(this.value)
})
}}return h
};
var E=function(g,f){var e=H("a.plugin_pagetree_childtoggle",g);
e.each(function(){var h=H(this);
h.attr("href","#").bind("click",function(k){var i=h.parent().parent().children("div.plugin_pagetree_children_container");
var j=i.attr("id");
var l=j.substring(8);
N(l,null,null,null,f);
k.preventDefault();
k.stopPropagation()
})
})
};
var U=function(e){var f=H(document.createElement("div"));
f.html(e);
return f.find("ul[id^='child_ul']").length
};
var J=function(n,g,s,q,j,f,h){var r=n;
var k=j;
var e=S(n);
var i=e[0];
var m=e[1];
var l=H("#children"+n);
var p=P(Q(m));
var t=false;
function o(){l.find(".plugin_pagetree_children_loading_wrapper .spinner").spin("small")
}l.append(Confluence.Templates.Pagetree.Macro.loadingIndicator());
if(h){setTimeout(function(){if(!t){o()
}},250)
}else{o()
}H.ajax({type:"GET",url:F(m,i,g,s,q,p.treePageId,f),dataType:"text",success:function(u){if(U(u)){l.html(u);
t=true;
if(l.children().length&&l.hasClass("hidden")){l.removeClass("hidden")
}E(l,f);
H("#plusminus"+r).addClass("icon-section-opened").removeClass("icon-section-closed");
H("#childrenspan"+D[parseInt(m)]+"-"+m).addClass("plugin_pagetree_current");
if(k){R(r)
}T(l);
if(AJS.PageGadget&&AJS.PageGadget.contentsUpdated){AJS.PageGadget.contentsUpdated()
}}else{window.location=p.loginUrl
}AJS.trigger("pagetree-children-loaded")
},error:function(u){if(u.status=="403"){l.text(p["i18n-pagetree.error.permission"])
}else{l.text(p["i18n-pagetree.error.general"])
}}})
};
var T=function(e){H("div.plugin_pagetree_children_container:empty",e).addClass("hidden")
};
var Y=function(e,j){var h=P(e);
var k=h.noRoot=="true";
var g=k?"Orphan-"+j:h.rootPageId+"-"+j;
var f=h.mobile=="true";
W[j]=h.treeRequestId;
if(f==false){D[j]=AJS.params.pageId
}else{D[j]=H("div.content-container").parent().attr("data-content-id")
}e.children("fieldset").each(function(){var l=H(this);
l.children("input[treeId]").attr("value",j);
l.children("input[rootPage]").attr("value",g)
});
if(k){e.find("div.plugin_pagetree_children").attr("id","childrenOrphan-"+j);
e.find("a.plugin_pagetree_expandall").click(function(l){I("childrenOrphan-"+j,l,f);
return false
});
e.find("a.plugin_pagetree_collapseall").click(function(l){X("childrenOrphan-"+j,l,f);
return false
})
}else{e.find("div.plugin_pagetree_children").attr("id","children"+g);
e.find("a.plugin_pagetree_expandall").click(function(l){I("children"+g,l,f);
return false
});
e.find("a.plugin_pagetree_collapseall").click(function(l){X("children"+g,l,f);
return false
})
}var i=O(e);
J(g,i,h.startDepth,h.spaceKey,"",f,true)
};
this.initPageTrees=function(){H("div.plugin_pagetree").each(function(e){Y(H(this),e)
});
d()
};
var d=function(){var e=self.placeFocus;
if(e){self.placeFocus=function(){var f=H("form[name='pagetreesearchform']");
f.attr("name","inlinecommentform");
e();
f.attr("name","pagetreesearchform")
}
}};
H(".open-flyout-to-search").bind("click",function(e){if(H(".fly-out-open").length){setTimeout(function(){ConfluenceMobile.flyout.hide()
},400)
}else{setTimeout(function(){ConfluenceMobile.flyout.show()
},400)
}e.stopPropagation();
e.preventDefault()
})
};
Confluence=Confluence||{};
Confluence.Plugins=Confluence.Plugins||{};
Confluence.Plugins.PagetreeMacro={bind:function(B){var C=new A(B);
C.initPageTrees()
}}
})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.pagetree:pagetree-js-resources', location = 'com/atlassian/confluence/plugins/pagetree/resource/javascript/pagetree-desktop.js' */
AJS.toInit(function(A){Confluence.Plugins.PagetreeMacro.bind(A)
});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.scandio.confluence.plugins.pocketquery:pocketquery-core-web-resources', location = '/pocketquery/js/pocketquery-core.js' */
var PocketQuery=PocketQuery||{};($||jQuery).extend(PocketQuery,(function(g){var k="https://www.scandio.de/en/2016/05/pocketquery-2-1-says-hello/";var d="Docs and News on PocketQuery 2.1";var m=null;function a(){var n="";n+='<a class="aui-message pocketquery-help" target="_blank" href="'+k+'">';n+='<span class="title">';n+='<span class="aui-icon icon-pocketquery"></span>';n+="<strong>"+d+"</strong>";n+="</span>";n+="</a>";return g(n)}function h(o,n){var n=n||{};var q=[];var p=function(r,t){var s=r;if(n.keyPrefix){r=n.keyPrefix+r}q.push(r+"="+o[r]);if(t===true){delete o[s]}};if(g.type(n.order)==="array"){g.each(n.order,function(r,s){p(s,true)})}g.each(Object.keys(o).sort(),function(r,s){p(s)});return q.join("&")}function b(p,o){var o=o||{};var n={};var q=p.split("&");g.each(q,function(r,t){var u=t.split("=");if(u.length===2){var s=u[0];var t=u[1];if(o.keyPrefix){s=o.keyPrefix+s}n[s]=t}});return n}function e(n){var o=n.children().get();if(o){o.sort(function(s,q){var r=g(s).text();var p=g(q).text();if(r<p){return -1}if(r>p){return 1}return 0});g.each(o,function(q,p){n.append(p)})}}function f(o){var n=new AJS.Dialog({width:400,height:300,id:"pocketquery-details-popup"});n.addHeader("Details for field "+o.header);n.addSubmit("Ok",function(){n.remove()});n.addPanel("","");n.getCurrentPanel().html('<div class="pocketquery-popup-content">'+o.content+"</div>");n.show()}function c(){var n=g(".pocketquery-result .pocketquery-table");if(n.length){g.fn.colResizable&&n.colResizable({liveDrag:true});n.find("td").dblclick(function(r){var q=g(this);var o=q.prevAll().length;var s=q.closest("table").find("th").eq(o).find("div").html();var p=q.html();f({header:s,content:p})});if(n.attr("data-sortable")!=="false"){n.tablesorter()}}}function j(n){m=g(n)}function l(){return m}function i(n){if(AJS.Meta.get("is-confluence-admin")){n(true)}else{g.get(AJS.Meta.get("context-path")+"/rest/pocketquery/1.0/view/is-pocketquery-admin",function(o){n(o.data)})}}AJS.toInit(function(){g("body").addClass("pocketquery")});if(!window.ConfluenceMobile){AJS.I18n.get("de.scandio.confluence.plugins.pocketquery",function(){AJS.trigger("pocketquery.loaded.properties")})}return{getHelpLink:a,objectToString:h,stringToObject:b,sortList:e,bindViewHandlers:c,setLastLoadedContainer:j,getLastLoadedContainer:l,isPocketQueryAdmin:i}}($||jQuery)));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.scandio.confluence.plugins.pocketquery:pocketquery-core-web-resources', location = '/pocketquery/js/pocketquery-logger.js' */
var PocketQuery=PocketQuery||{};($||jQuery).extend(PocketQuery,(function(e){var d={error:0,warn:1,info:2,log:3,debug:4};var c=1;function a(g){c=d[g]}function f(h,j,i){var h="PocketQuery -- "+h;if(i){h+=" -- "}if("console" in window){try{if(e.type(console[j])==="function"){if(c>=d[j]){if(i){console[j](h,i)}else{console[j](h)}}}else{if(e.type(console.log)==="function"){if(c>=d.log){if(i){console.log(h,i)}else{console.log(h)}}}}}catch(g){AJS.logError("Error invoking PocketQuery.logger method")}}}function b(g){return function(h,i){f(h,g,i)}}return{logger:{setLevel:a,info:b("info"),warn:b("warn"),debug:b("debug"),error:b("error")}}}($||jQuery)));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.scandio.confluence.plugins.pocketquery:pocketquery-main-web-resources', location = '/pocketquery/js/pocketquery-main.js' */
(function(a){PocketQuery.isPocketQueryAdmin(function(c){var b;if(!c){AJS.toInit(function(){b=a('#user-menu-link-user-content li a[href$="/pocketquery/admin.action"]');b.closest("li").remove()})}})}($||jQuery));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:help-dialog-extension', location = '/jira/help-dialog.js' */
if(Confluence.KeyboardShortcuts){Confluence.KeyboardShortcuts.Editor.push({context:"editor.actions",descKey:"Insert JIRA Issue/Filter"+":",keys:[["Ctrl+Shift+J"]]})};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:help-dialog-extension', location = 'js/help-dialog.js' */
AJS.toInit(function(a){Confluence.KeyboardShortcuts&&Confluence.KeyboardShortcuts.Autoformat.push({action:"@",context:"autoformat.autocomplete",description:"Mention"})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.edrup.confluence.plugins.svg-out:svg-out-scripts-232-panZoom', location = 'js/svg-out-panandzoom.js' */
AJS.toInit(function(){var h=function(w,r,x,D,m){this.panAndZoom=function(K,J,I,M,L){var E=w.getBoundingClientRect();C=l;l=l*K;if(l<r){l=r;K=l/C}if(l>x){l=x;K=l/C}var H=((E.left-J)*(1/K-1)-M)/(E.right-E.left+1)*y;var G=((E.top-I)*(1/K-1)-L)/(E.bottom-E.top+1)*v;k=k+H;u=u+G;y=y/K;v=v/K;var F=Math.round(k).toString()+" "+Math.round(u).toString()+" "+Math.round(y).toString()+" "+Math.round(v).toString();w.setAttribute("viewBox",F)};this.wheel=function(E){if((D==0)||(m==0)){return}E.preventDefault();var F=E.deltaY;F=-0.3<F&&F<0.3?F:(F>0?1:-1)*Math.log(Math.abs(F)+10)/30;this.panAndZoom(1/Math.pow(1.2,F),E.clientX,E.clientY,0,0)};this.move=function(E){E.preventDefault();if(E.buttons!=1){t=0}if(m==0){return}if(t==1){this.panAndZoom(1,0,0,E.clientX-j,E.clientY-i);j=E.clientX;i=E.clientY}};this.down=function(E){E.preventDefault();t=1;j=E.clientX;i=E.clientY;o=E.clientX;n=E.clientY};this.isChildOfLink=function(E){var F=E.target;while(F!=null){if(F.tagName){if(F.tagName.toLowerCase()=="a"){return true}}F=F.parentNode}return false};this.click=function(E){if(Math.abs(o-E.clientX)>10||Math.abs(n-E.clientY)>10){E.preventDefault()}else{if(m==0){if(this.isChildOfLink(E)==false){m=1}}}};this.touchinit=function(E){if(E.touches.length==1){q=E.touches[0].clientX;p=E.touches[0].clientY}if(E.touches.length==2){B=E.touches[1].clientX;A=E.touches[1].clientY}};this.touchmove=function(E){if(m==0){return}if(E.touches.length==1){E.preventDefault();this.panAndZoom(1,0,0,E.touches[0].clientX-q,E.touches[0].clientY-p);q=E.touches[0].clientX;p=E.touches[0].clientY}if(E.touches.length==2){E.preventDefault();var G=Math.sqrt(Math.pow(E.touches[1].clientX-E.touches[0].clientX,2)+Math.pow(E.touches[1].clientY-E.touches[0].clientY,2))/Math.sqrt(Math.pow(B-q,2)+Math.pow(A-p,2));var J=(E.touches[1].clientX+E.touches[0].clientX)/2;var I=(E.touches[1].clientY+E.touches[0].clientY)/2;var H=J-(B+q)/2;var F=I-(A+p)/2;this.panAndZoom(G,J,I,H,F);q=E.touches[0].clientX;p=E.touches[0].clientY;B=E.touches[1].clientX;A=E.touches[1].clientY}};this.splitViewbox=function(){var E=w.getAttribute("viewBox").split(" ",4);k=parseFloat(E[0]);u=parseFloat(E[1]);y=parseFloat(E[2]);v=parseFloat(E[3])};this.zoomIn=function(E){var F=w.getBoundingClientRect();this.panAndZoom(1.2,(F.right+F.left)/2,(F.bottom+F.top)/2,0,0);m=1};this.zoomOut=function(E){var F=w.getBoundingClientRect();this.panAndZoom(1/1.2,(F.right+F.left)/2,(F.bottom+F.top)/2,0,0);m=1};this.reset=function(E){l=1;C=1;w.setAttribute("viewBox",z);this.splitViewbox()};var t=0;var j=0;var i=0;var o=0;var n=0;var l=1;var C=1;var k=0;var u=0;var y=0;var v=0;var z=w.getAttribute("viewBox");this.splitViewbox();var q=0;var p=0;var B=0;var A=0;w.addEventListener("wheel",this.wheel.bind(this),false);w.addEventListener("mousemove",this.move.bind(this),false);w.addEventListener("mousedown",this.down.bind(this),false);w.addEventListener("click",this.click.bind(this),false);w.addEventListener("touchstart",this.touchinit.bind(this),false);w.addEventListener("touchend",this.touchinit.bind(this),false);w.addEventListener("touchmove",this.touchmove.bind(this),false);w.addEventListener("touchcancel",this.touchinit.bind(this),false)};var a=document.getElementsByClassName("svg-out");var d='<button id="$zoomInID" class="aui-button" style="width:30px;height:30px;margin-right:1px">+</button> <button id="$zoomResetID" class="aui-button" style="width:30px;height:30px;margin-left:1px;margin-right:1px">&#8634</button> <button id="$zoomOutID" class="aui-button" style="width:30px;height:30px;margin-left:1px">&#x2212</button>';for(s=0;s<a.length;s++){if(a[s].getAttribute("panAndZoom")=="true"){var f=(a[s].getAttribute("startActive")=="false")?0:1;var c=(a[s].getAttribute("useWheel")=="false")?0:1;var b=new h(a[s].firstElementChild,parseFloat(a[s].getAttribute("minZoom")),parseFloat(a[s].getAttribute("maxZoom")),c,f);if(a[s].getAttribute("zoomButtons")=="true"){var e=document.createElement("p");var g="svg-out-button-"+s.toString()+"-";e.innerHTML=d.replace("$zoomInID",g+"zoomIn").replace("$zoomOutID",g+"zoomOut").replace("$zoomResetID",g+"zoomReset");a[s].appendChild(e);document.getElementById("svg-out-button-"+s.toString()+"-zoomIn").addEventListener("click",b.zoomIn.bind(b));document.getElementById("svg-out-button-"+s.toString()+"-zoomOut").addEventListener("click",b.zoomOut.bind(b));document.getElementById("svg-out-button-"+s.toString()+"-zoomReset").addEventListener("click",b.reset.bind(b))}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.edrup.confluence.plugins.svg-out:svg-out-scripts-232-panZoom', location = 'js/svg-out-tooltip.js' */
AJS.toInit(function(){var e="http://www.w3.org/2000/svg";var b=document.getElementsByClassName("svg-out");for(s=0;s<b.length;s++){if(b[s].getAttribute("IEToolTips")=="true"){var c=b[s].getElementsByTagName("a");for(l=0;l<c.length;l++){if(c[l].hasAttribute("xlink:title")){var f=c[l].getAttribute("xlink:title");var a=document.createElementNS(e,"title");var d=document.createTextNode(f);a.appendChild(d);c[l].appendChild(a)}}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.edrup.confluence.plugins.svg-out:svg-out-scripts-232-bodyHint', location = 'js/svg-out-bodyHint.js' */
AJS.toInit(function(){var f=function(){if(AJS.Rte){if(AJS.Rte.getEditor()){if(AJS.Rte.getEditor().dom){if(AJS.Rte.getEditor().dom.getRoot()){b=true;console.log("svgOutBodyObserver added!");a.observe(AJS.Rte.getEditor().dom.getRoot(),d)}}}}};var c=new MutationObserver(function(){if(b==false){f()}});var a=new MutationObserver(function(g){g.forEach(function(h){for(n=0;n<h.addedNodes.length;n++){if(h.addedNodes[n].outerHTML.indexOf('data-macro-name="svg-out"')>-1){if(h.addedNodes[n].outerHTML.indexOf('<tbody><tr><td class="wysiwyg-macro-body"><p><br></p></td></tr></tbody>')>-1){console.log("New SVG Out macro with empty body detected!");var j="The body area can be used to replace links in the SVG and to add tool tips to them. Please read the \u003ca href=https://bitbucket.org/apurde/svg-out/wiki/Home\u003eSVG Out documentation\u003c/a\u003e for details.";var i=h.addedNodes[n].outerHTML.replace('<tbody><tr><td class="wysiwyg-macro-body"><p><br></p></td></tr></tbody>','<tbody><tr><td class="wysiwyg-macro-body"><p>'+j+"</p></td></tr></tbody>");h.addedNodes[n].outerHTML=i}}}})});var d={childList:true,subtree:true};var e={childList:true,subtree:true};var b=false;f();$("#editPageLink").click(function(){c.observe(document.body,e)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.edrup.confluence.plugins.svg-out:svg-out-scripts-232-IEAutoScale', location = 'js/svg-out-IEAutoScale.js' */
AJS.toInit(function(){var isIE=
/*@cc_on!@*/
false||!!document.documentMode;if(isIE){var svgouts=document.getElementsByClassName("svg-out");for(s=0;s<svgouts.length;s++){var svg=svgouts[s].firstElementChild;if(svg.getAttribute("width").indexOf("%")>0){var width=svg.getAttribute("width");var style=svg.getAttribute("style");var viewBoxValues=svg.getAttribute("viewBox").split(" ",4);style=style+";width:"+width+";height:1px;padding-bottom:calc("+width+"*"+viewBoxValues[3]+"/"+viewBoxValues[2]+");";svg.setAttribute("style",style);svg.removeAttribute("width");svg.setAttribute("preserveAspectRatio","xMidYMin slice")}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.communardo.confluence.plugins.subspace:subspace-resource', location = 'communardo_plugins/javascript/linktree.js' */
AJS.toInit(function(){jQuery(".edit_link").click(function(){var d=jQuery(this).attr("id").replace("edit_link_","");jQuery(this).hide();jQuery("#save_link_"+d).removeClass("hidden");a(d);return false});jQuery(".save_link").click(function(){var d=jQuery(this).attr("id").replace("save_link_","");b(d);return false});function a(d){jQuery("#link_alias_"+d).removeClass("readonly");jQuery("#link_alias_"+d).removeAttr("readonly");jQuery("#link_target_"+d).removeClass("readonly");jQuery("#link_target_"+d).removeAttr("readonly")}function b(e){var d=jQuery("#doeditlinkform");d.append('<input type="text" name="id" value="'+e+'"/>');d.append('<input type="text" name="alias" value="'+jQuery("#link_alias_"+e).val()+'"/>');d.append('<input type="text" name="target" value="'+jQuery("#link_target_"+e).val()+'"/>');d.submit()}jQuery(".button").each(function(d){jQuery(this).css("cursor","pointer");c(jQuery(this))});function c(d){if(d.hasClass("up")||d.hasClass("indent")){if(d.parent().prev().size()==0){d.hide()}}else{if(d.hasClass("down")){if(d.parent().next().size()==0){d.hide()}}else{if(d.hasClass("unindent")){if(d.parents("li").size()==1){d.hide()}}}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.communardo.confluence.plugins.subspace:subspace-resource', location = 'communardo_plugins/javascript/subspaces.js' */
AJS.toInit(function(){if(jQuery.browser.msie&&jQuery.browser.version=="7.0"){jQuery("div.subspaces-menu li ul").hover(function(){jQuery(this).children("li").children("a").css("width",jQuery(this).width()-40+"px")})}});var operationInProgressArray=new Array();function subspacesToggleStar(c){var a=c.src;var b=jQuery("#confluence-context-path").attr("content");if(c.src.indexOf("star_grey.gif")!=-1){c.src=b+"/images/icons/star_yellow.gif"}else{c.src=b+"/images/icons/star_grey.gif"}}function subspacesAddOrRemoveFromFavourites(e,f,a){if(operationInProgressArray[f.id]==null){operationInProgressArray[f.id]=true;var c;var b=jQuery("#confluence-context-path").attr("content");var d="json";if(a){d="labels"}if(f.src.indexOf("star_yellow.gif")!=-1){c=b+"/"+d+"/removespacefromfavourites.action"}else{c=b+"/"+d+"/addspacetofavourites.action"}AJS.safe.ajax({url:c,type:"POST",data:{key:e},success:function(){subspacesToggleStar(f);operationInProgressArray[f.id]=null},error:function(i,h,g){if(a){alert("Error : "+h);operationInProgressArray[f.id]=null}else{operationInProgressArray[f.id]=null;subspacesAddOrRemoveFromFavourites(e,f,true)}}})}}function subspacesGotoUrl(b){for(var a in operationInProgressArray){if(operationInProgressArray[a]==true){return}}window.location=b};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.communardo.confluence.plugins.subspace:subspace-resource', location = 'communardo_plugins/javascript/jquery.corner.2.09.js' */
/*!
 * jQuery corner plugin: simple corner rounding
 * Examples and documentation at: http://jquery.malsup.com/corner/
 * version 2.11 (15-JUN-2010)
 * Requires jQuery v1.3.2 or later
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * Authors: Dave Methvin and Mike Alsup
 */
(function(c){var a=document.createElement("div").style,h=a.MozBorderRadius!==undefined,j=a.WebkitBorderRadius!==undefined,e=a.borderRadius!==undefined||a.BorderRadius!==undefined,d=document.documentMode||0,l=c.browser.msie&&((c.browser.version<8&&!d)||d<8),i=c.browser.msie&&(function(){var n=document.createElement("div");try{n.style.setExpression("width","0+0");n.style.removeExpression("width")}catch(m){return false}return true})();c.support=c.support||{};c.support.borderRadius=h||j||e;function g(m,n){return parseInt(c.css(m,n))||0}function k(m){var m=parseInt(m).toString(16);return(m.length<2)?"0"+m:m}function b(o){while(o){var m=c.css(o,"backgroundColor"),n;if(m&&m!="transparent"&&m!="rgba(0, 0, 0, 0)"){if(m.indexOf("rgb")>=0){n=m.match(/\d+/g);return"#"+k(n[0])+k(n[1])+k(n[2])}return m}if(o.nodeName.toLowerCase()=="html"){break}o=o.parentNode}return"#ffffff"}function f(o,m,n){switch(o){case"round":return Math.round(n*(1-Math.cos(Math.asin(m/n))));case"cool":return Math.round(n*(1+Math.cos(Math.asin(m/n))));case"sharp":return Math.round(n*(1-Math.cos(Math.acos(m/n))));case"bite":return Math.round(n*(Math.cos(Math.asin((n-m-1)/n))));case"slide":return Math.round(n*(Math.atan2(m,n/m)));case"jut":return Math.round(n*(Math.atan2(n,(n-m-1))));case"curl":return Math.round(n*(Math.atan(m)));case"tear":return Math.round(n*(Math.cos(m)));case"wicked":return Math.round(n*(Math.tan(m)));case"long":return Math.round(n*(Math.sqrt(m)));case"sculpt":return Math.round(n*(Math.log((n-m-1),n)));case"dogfold":case"dog":return(m&1)?(m+1):n;case"dog2":return(m&2)?(m+1):n;case"dog3":return(m&3)?(m+1):n;case"fray":return(m%2)*n;case"notch":return n;case"bevelfold":case"bevel":return m+1}}c.fn.corner=function(m){if(this.length==0){if(!c.isReady&&this.selector){var n=this.selector,o=this.context;c(function(){c(n,o).corner(m)})}return this}return this.each(function(v){var u=c(this),D=[u.attr(c.fn.corner.defaults.metaAttr)||"",m||""].join(" ").toLowerCase(),K=/keep/.test(D),C=((D.match(/cc:(#[0-9a-f]+)/)||[])[1]),p=((D.match(/sc:(#[0-9a-f]+)/)||[])[1]),G=parseInt((D.match(/(\d+)px/)||[])[1])||10,E=/round|bevelfold|bevel|notch|bite|cool|sharp|slide|jut|curl|tear|fray|wicked|sculpt|long|dog3|dog2|dogfold|dog/,r=((D.match(E)||["round"])[0]),s=/dogfold|bevelfold/.test(D),q={T:0,B:1},z={TL:/top|tl|left/.test(D),TR:/top|tr|right/.test(D),BL:/bottom|bl|left/.test(D),BR:/bottom|br|right/.test(D)},H,N,F,I,y,O,B,L,J,x,M,P,A,t;if(!z.TL&&!z.TR&&!z.BL&&!z.BR){z={TL:1,TR:1,BL:1,BR:1}}if(c.fn.corner.defaults.useNative&&r=="round"&&(e||h||j)&&!C&&!p){if(z.TL){u.css(e?"border-top-left-radius":h?"-moz-border-radius-topleft":"-webkit-border-top-left-radius",G+"px")}if(z.TR){u.css(e?"border-top-right-radius":h?"-moz-border-radius-topright":"-webkit-border-top-right-radius",G+"px")}if(z.BL){u.css(e?"border-bottom-left-radius":h?"-moz-border-radius-bottomleft":"-webkit-border-bottom-left-radius",G+"px")}if(z.BR){u.css(e?"border-bottom-right-radius":h?"-moz-border-radius-bottomright":"-webkit-border-bottom-right-radius",G+"px")}return}H=document.createElement("div");c(H).css({overflow:"hidden",height:"1px",minHeight:"1px",fontSize:"1px",backgroundColor:p||"transparent",borderStyle:"solid"});N={T:parseInt(c.css(this,"paddingTop"))||0,R:parseInt(c.css(this,"paddingRight"))||0,B:parseInt(c.css(this,"paddingBottom"))||0,L:parseInt(c.css(this,"paddingLeft"))||0};if(typeof this.style.zoom!=undefined){this.style.zoom=1}if(!K){this.style.border="none"}H.style.borderColor=C||b(this.parentNode);F=c(this).outerHeight();for(I in q){y=q[I];if((y&&(z.BL||z.BR))||(!y&&(z.TL||z.TR))){H.style.borderStyle="none "+(z[I+"R"]?"solid":"none")+" none "+(z[I+"L"]?"solid":"none");O=document.createElement("div");c(O).addClass("jquery-corner");B=O.style;y?this.appendChild(O):this.insertBefore(O,this.firstChild);if(y&&F!="auto"){if(c.css(this,"position")=="static"){this.style.position="relative"}B.position="absolute";B.bottom=B.left=B.padding=B.margin="0";if(i){B.setExpression("width","this.parentNode.offsetWidth")}else{B.width="100%"}}else{if(!y&&c.browser.msie){if(c.css(this,"position")=="static"){this.style.position="relative"}B.position="absolute";B.top=B.left=B.right=B.padding=B.margin="0";if(i){L=g(this,"borderLeftWidth")+g(this,"borderRightWidth");B.setExpression("width","this.parentNode.offsetWidth - "+L+'+ "px"')}else{B.width="100%"}}else{B.position="relative";B.margin=!y?"-"+N.T+"px -"+N.R+"px "+(N.T-G)+"px -"+N.L+"px":(N.B-G)+"px -"+N.R+"px -"+N.B+"px -"+N.L+"px"}}for(J=0;J<G;J++){x=Math.max(0,f(r,J,G));M=H.cloneNode(false);M.style.borderWidth="0 "+(z[I+"R"]?x:0)+"px 0 "+(z[I+"L"]?x:0)+"px";y?O.appendChild(M):O.insertBefore(M,O.firstChild)}if(s&&c.support.boxModel){if(y&&l){continue}for(P in z){if(!z[P]){continue}if(y&&(P=="TL"||P=="TR")){continue}if(!y&&(P=="BL"||P=="BR")){continue}A={position:"absolute",border:"none",margin:0,padding:0,overflow:"hidden",backgroundColor:H.style.borderColor};t=c("<div/>").css(A).css({width:G+"px",height:"1px"});switch(P){case"TL":t.css({bottom:0,left:0});break;case"TR":t.css({bottom:0,right:0});break;case"BL":t.css({top:0,left:0});break;case"BR":t.css({top:0,right:0});break}O.appendChild(t[0]);var Q=c("<div/>").css(A).css({top:0,bottom:0,width:"1px",height:G+"px"});switch(P){case"TL":Q.css({left:G});break;case"TR":Q.css({right:G});break;case"BL":Q.css({left:G});break;case"BR":Q.css({right:G});break}O.appendChild(Q[0])}}}}})};c.fn.uncorner=function(){if(e||h||j){this.css(e?"border-radius":h?"-moz-border-radius":"-webkit-border-radius",0)}c("div.jquery-corner",this).remove();return this};c.fn.corner.defaults={useNative:true,metaAttr:"data-corner"}})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.communardo.confluence.plugins.subspace:subspace-resource', location = 'communardo_plugins/javascript/move.js' */
AJS.toInit(function(){var a=jQuery("#subspace-configuration #subspace-global-navigation");if(a.length>0&&jQuery("#com-atlassian-confluence.contenteditor").length==0){jQuery("#header").append(a);a.find(".subspaces-menu ul.level_0").corner("top 10px");var b=a.find(".subspaces-menu ul.level_0 > li:first");b.css("border-left","none")}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.communardo.confluence.plugins.subspace:subspace-breadcrumbs-resource', location = 'communardo_plugins/javascript/subspace_breadcrumbs.js' */
AJS.toInit(function(){modifyConfluenceBreadCrumbs()});jQuery.fn.reverse=[].reverse;function modifyConfluenceBreadCrumbs(){var a=jQuery("#confluence-context-path").attr("content");var d=jQuery("#subspace-breadcrumb-path");if(jQuery("#subspace-breadcrumb-path").length>0){var e=AJS.Meta.get("version-number")[0];var c=(e=="4")?1:0;jQuery('#breadcrumbs > li > span > a[href*="/collector/pages.action?"]').closest("li").hide();var b=jQuery("#subspace-breadcrumb-path li:last .space-url").text();jQuery('#breadcrumbs a[href$="'+b+'"]').closest("li").remove();if(jQuery("#breadcrumbs").children().length==0){d.children("li.breadcrumb").each(function(){jQuery("#breadcrumbs").append("<li> <span> <a href='"+a+jQuery(this).children(".space-url").text()+"'>"+jQuery(this).children(".space-name").text()+"</a> </span> </li>")})}else{d.children("li.breadcrumb").reverse().each(function(){jQuery("#breadcrumbs").children().eq(c).before("<li> <span> <a href='"+a+jQuery(this).children(".space-url").text()+"'>"+jQuery(this).children(".space-name").text()+"</a> </span> </li>")})}}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.communardo.confluence.plugins.subspace:subspace-search-resource', location = 'communardo_plugins/javascript/subspaces-search.js' */
AJS.toInit(function(){initSubspacesQuickSearch();initSubspacesSearchCheckboxToggle()});function initSubspacesQuickSearch(){jQuery(".subspaces-quicksearch .subspaces-quick-search-query").each(function(){var c=jQuery(this);c.focus(function(){if(jQuery(this).hasClass("placeholded")){jQuery(this).val("");jQuery(this).removeClass("placeholded")}});c.change(function(){if(jQuery(this).val()==""){jQuery(this).val(jQuery(this).attr("placeholder"));jQuery(this).addClass("placeholded")}});AJS.subspacequicksearch=AJS.quicksearch||{};AJS.subspacequicksearch.dropdownPostprocess=function(e){jQuery("a span",e).each(function(){var f=jQuery(this);var g=AJS.dropDown.getAdditionalPropertyValue(f,"spaceName")||"";if(g){g=" ("+AJS("i").html(g).text()+")"}f.attr("title",f.text()+g)})};var d=function(e,f){e.closest("form").find(".quick-nav-drop-down").append(f)};var a=c.parent().children(".subspacesSpaceKey").val();var b=c.parent().children(".includeSubspaces").val();c.subspacesquicksearch("/communardo_plugins/quicksearch/subspacesQuickSearch.action?spaceKey="+a+"&includeSubspaces="+b,null,{dropdownPostprocess:AJS.subspacequicksearch.dropdownPostprocess,dropdownPlacement:d})})}function initSubspacesSearchCheckboxToggle(){var a=jQuery("#topspaces_holder .checkbox_topLevelSpaces");a.click(function(){if(jQuery(this).is(":checked")){a.attr("checked",false);jQuery(this).attr("checked",true)}enableDisableSubspacesSearchElements()});enableDisableSubspacesSearchElements()}function enableDisableSubspacesSearchElements(){if(jQuery("#topspaces_holder .checkbox_topLevelSpaces").is(":checked")){jQuery("#search-filter-by-space").attr("disabled",true);jQuery("#checkbox_include_subspaces").attr("disabled",true)}else{jQuery("#search-filter-by-space").attr("disabled",false);jQuery("#checkbox_include_subspaces").attr("disabled",false)}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.communardo.confluence.plugins.subspace:subspace-search-resource', location = 'communardo_plugins/javascript/subspaces-quicksearch-dropdown.js' */
(function(a){a.fn.subspacesquicksearch=function(l,g,m){m=m||{};var f={cache_size:30,max_length:1,effect:"appear"};var i,c={},h=[],e;if(typeof l=="function"){var b=l();var k=function(){var n=l();if(n!=b){c={};h=[];b=n}return n}}else{var k=function(){return l}}var j=a(this);var d=function(v,q){var t=v.statusMessage?true:false;var p=t?[[{html:v.statusMessage,className:"error"}]]:v.contentNameMatches;if(!t){var s=v.query;if(!c[s]&&q=="success"){c[s]=v;h.push(s);if(h.length>f.cache_size){delete c[h.shift()]}}}if(v.query!=j.val()){return}var n=i;i=AJS.dropDown(p,m.ajsDropDownOptions)[0];i.jsonResult=v;if(m.dropdownPlacement){m.dropdownPlacement(j,i.$)}else{j.closest("form").find(".quick-nav-drop-down").append(i.$)}i.onhide=function(w){if(w=="escape"){j.focus()}};var r=a("span",i.$);for(var o=0,u=r.length-1;o<u;o++){(function(){var x=a(this),w=x.html();w=w.replace(new RegExp("("+v.queryTokens.join("|")+")","gi"),"<strong>$1</strong>");x.html(w)}).call(r[o])}if(m.dropdownPostprocess){m.dropdownPostprocess(i.$);i.hider=function(){m.dropdownPostprocess(i.$)}}a("a span",i.$).each(function(){var z=a(this),x=AJS("var","&#8230;"),B=x[0].offsetWidth,y=this.parentNode.parentNode.parentNode.parentNode.offsetWidth,A=false,w=20;AJS.dropDown.removeAllAdditionalProperties(z);z.wrapInner(a("<em>"));z.append(x);this.elpss=x;a("em",z).each(function(){var C=a(this);C.show();if(this.offsetLeft+this.offsetWidth+B>y-w){var J=this.childNodes;var I=false;for(var E=J.length-1;E>=0;E--){var F=J[E];var D=1;var H=(F.nodeType==3)?"nodeValue":"innerHTML";var G=F[H];do{if(D<=G.length){F[H]=G.substr(0,G.length-D++)}else{break}}while(this.offsetLeft+this.offsetWidth+B>y-w);if(D<=G.length){I=true;break}}if(I){A=true}else{C.hide()}}});if(!A){x.hide()}});if(n){i.show();i.method=f.effect;n.$.remove()}else{i.show(f.effect)}if(typeof g=="function"){g.apply(i)}};j.oldval=j.val();j.keyup(function(o){if(o.which==13||o.which==9){return}var p=j.val();if(p!=j.oldval){j.oldval=p;if(!j.hasClass("placeholded")){clearTimeout(e);if(AJS.params.quickNavEnabled&&(/[\S]{2,}/).test(p)){if(c[p]){d(c[p])}else{var n=jQuery("#confluence-context-path").attr("content");e=setTimeout(function(){return AJS.$.ajax({type:"GET",url:n+k(),data:{query:AJS.escape(p)},success:d,dataType:"json",global:false,timeout:5000,error:function(r,q,s){if(q=="timeout"){d({statusMessage:"Timeout",query:p},q)}}})},200)}}else{i&&i.hide()}}}});return this}})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:internal-aui-browser', location = 'js/aui/internal/browser.js' */
(function(A){AJS._internal=AJS._internal||{};AJS._internal.browser=A(AJS.$)})(function(B){var A={};var C=null;A.supportsCalc=function(){if(C===null){var D=B('<div style="height: 10px; height: -webkit-calc(20px + 0); height: calc(20px);"></div>');C=(20===D.appendTo(document.documentElement).height());D.remove()}return C};A.supportsRequestAnimationFrame=function(){return !!window.requestAnimationFrame};return A});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:dialog2', location = 'js/dialog2.js' */
(function(A){AJS.dialog2=A(AJS.$,AJS.layer,AJS._internal.widget)})(function(D,G,C){var F={"aui-focus":"false","aui-blanketed":"true"};function B(H){D.each(F,function(I,J){var K="data-"+I;if(!H[0].hasAttribute(K)){H.attr(K,J)}})}function A(H){if(H){this.$el=D(H)}else{this.$el=D(aui.dialog.dialog2({}))}B(this.$el)}A.prototype.on=function(I,H){G(this.$el).on(I,H);return this};A.prototype.off=function(I,H){G(this.$el).off(I,H);return this};A.prototype.show=function(){G(this.$el).show();return this};A.prototype.hide=function(){G(this.$el).hide();return this};A.prototype.remove=function(){G(this.$el).remove();return this};A.prototype.isVisible=function(){return G(this.$el).isVisible()};var E=C("dialog2",A);E.on=function(H,I){G.on(H,".aui-dialog2",I);return this};E.off=function(H,I){G.off(H,".aui-dialog2",I);return this};D(document).on("click",".aui-dialog2-header-close",function(H){H.preventDefault();E(D(this).closest(".aui-dialog2")).hide()});E.on("show",function(K,J){var I=[".aui-dialog2-content",".aui-dialog2-footer",".aui-dialog2-header"];var H;I.some(function(L){H=J.find(L+" :aui-tabbable");return H.length});H&&H.first().focus()});E.on("hide",function(J,I){var H=G(I);if(I.data("aui-remove-on-hide")){H.remove()}});return E});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:dialog2', location = 'soy/dialog2.soy' */
// This file was automatically generated from dialog2.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace aui.dialog.
 */

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.dialog == 'undefined') { aui.dialog = {}; }


aui.dialog.dialog2 = function(opt_data, opt_ignored) {
  return '' + aui.dialog.dialog2Chrome({id: opt_data.id, titleId: opt_data.id ? opt_data.id + '-dialog-title' : null, modal: opt_data.modal, tagName: opt_data.tagName, removeOnHide: opt_data.removeOnHide, visible: opt_data.visible, size: opt_data.size, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: '' + aui.dialog.dialog2Content({id: null, titleText: opt_data.titleText, titleContent: opt_data.titleContent, headerActionContent: opt_data.headerActionContent, headerSecondaryContent: opt_data.headerSecondaryContent, modal: opt_data.modal, content: opt_data.content, footerHintText: opt_data.footerHintText, footerHintContent: opt_data.footerHintContent, footerActionContent: opt_data.footerActionContent})});
};
if (goog.DEBUG) {
  aui.dialog.dialog2.soyTemplateName = 'aui.dialog.dialog2';
}


aui.dialog.dialog2Chrome = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<' + soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section') + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ((opt_data.titleId) ? ' aria-labelledby="' + soy.$$escapeHtml(opt_data.titleId) + '"' : '') + ' role="dialog" class=" aui-layer aui-dialog2 aui-dialog2-' + soy.$$escapeHtml(opt_data.size ? opt_data.size : 'medium') + aui.renderExtraClasses(opt_data) + '"' + ((opt_data.modal) ? 'data-aui-modal="true"' : '') + ((opt_data.removeOnHide) ? 'data-aui-remove-on-hide="true"' : '') + ((opt_data.visible != true) ? 'aria-hidden="true"' : '') + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</' + soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section') + '>';
};
if (goog.DEBUG) {
  aui.dialog.dialog2Chrome.soyTemplateName = 'aui.dialog.dialog2Chrome';
}


aui.dialog.dialog2Content = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '' + aui.dialog.dialog2Header({titleId: opt_data.id ? opt_data.id + '-dialog-title' : null, titleText: opt_data.titleText, titleContent: opt_data.titleContent, actionContent: opt_data.headerActionContent, secondaryContent: opt_data.headerSecondaryContent, modal: opt_data.modal}) + aui.dialog.dialog2Panel(opt_data) + aui.dialog.dialog2Footer({hintText: opt_data.footerHintText, hintContent: opt_data.footerHintContent, actionContent: opt_data.footerActionContent});
};
if (goog.DEBUG) {
  aui.dialog.dialog2Content.soyTemplateName = 'aui.dialog.dialog2Content';
}


aui.dialog.dialog2Header = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<header' + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ' class="aui-dialog2-header' + aui.renderExtraClasses(opt_data) + '"' + aui.renderExtraAttributes(opt_data) + '><h2 ' + ((opt_data.titleId) ? ' id="' + soy.$$escapeHtml(opt_data.titleId) + '"' : '') + ' class="aui-dialog2-header-main">' + ((opt_data.titleText) ? soy.$$escapeHtml(opt_data.titleText) : '') + ((opt_data.titleContent) ? soy.$$filterNoAutoescape(opt_data.titleContent) : '') + '</h2>' + ((opt_data.actionContent) ? '<div class="aui-dialog2-header-actions">' + soy.$$filterNoAutoescape(opt_data.actionContent) + '</div>' : '') + ((opt_data.secondaryContent) ? '<div class="aui-dialog2-header-secondary">' + soy.$$filterNoAutoescape(opt_data.secondaryContent) + '</div>' : '') + ((opt_data.modal != true) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml("Close") + '</span></a>' : '') + '</header>';
};
if (goog.DEBUG) {
  aui.dialog.dialog2Header.soyTemplateName = 'aui.dialog.dialog2Header';
}


aui.dialog.dialog2Footer = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<footer' + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ' class="aui-dialog2-footer' + aui.renderExtraClasses(opt_data) + '"' + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.actionContent) ? '<div class="aui-dialog2-footer-actions">' + soy.$$filterNoAutoescape(opt_data.actionContent) + '</div>' : '') + ((opt_data.hintText || opt_data.hintContent) ? '<div class="aui-dialog2-footer-hint">' + ((opt_data.hintText) ? soy.$$escapeHtml(opt_data.hintText) : '') + ((opt_data.hintContent) ? soy.$$filterNoAutoescape(opt_data.hintContent) : '') + '</div>' : '') + '</footer>';
};
if (goog.DEBUG) {
  aui.dialog.dialog2Footer.soyTemplateName = 'aui.dialog.dialog2Footer';
}


aui.dialog.dialog2Panel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div' + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ' class="aui-dialog2-content' + aui.renderExtraClasses(opt_data) + '"' + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</div>';
};
if (goog.DEBUG) {
  aui.dialog.dialog2Panel.soyTemplateName = 'aui.dialog.dialog2Panel';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:page-loading-indicator', location = '/includes/js/page-loading-indicator.js' */
define("confluence/page-loading-indicator",["jquery","underscore","ajs","confluence/templates"],function(c,g,a,h){return function(b){function d(){return c(".confluence-page-loading-blanket",b)}function e(){return c(".confluence-loading-indicator",b)}return{show:function(){0===d().length&&c(b).append(h.pageLoadingIndicator());d().show();e().spin({lines:12,length:8,width:4,radius:10,trail:60,speed:1.5,color:"#F0F0F0"})},hide:function(){e().stop();d().hide()},showUntilResolved:function(c,b){this.show();
c.always(g.bind(this.hide,this));b&&c.fail(function(){a.messages.error(".confluence-page-loading-errors",{body:b})})},showUntilDialogVisible:function(b,d){var f=this,e=d||"An error has occurred connecting to the server. Please try again.",g=c(".aui-dialog:visible"),h=c(".aui-dialog2:visible");!g.length&&!h.length&&f.show();b.always(f.hide).fail(function(){a.messages.error(".confluence-page-loading-errors",{body:e})});a.bind("show.dialog",function i(){a.unbind("show.dialog",i);f.hide()});if(null!=a.dialog2&&void 0!=a.dialog2)a.dialog2.on("show",
function j(){a.dialog2.off("show",j);f.hide()})},destroy:function(){b.remove(".confluence-page-loading-blanket")}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/page-loading-indicator","Confluence.PageLoadingIndicator");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:page-loading-indicator', location = '/includes/soy/page-loading-indicator.soy' */
// This file was automatically generated from page-loading-indicator.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }


Confluence.Templates.pageLoadingIndicator = function(opt_data, opt_ignored) {
  return '<div class="confluence-page-loading-errors"></div><div class="confluence-page-loading-blanket aui-blanket" aria-hidden="false"><div class="confluence-loading-indicator"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.pageLoadingIndicator.soyTemplateName = 'Confluence.Templates.pageLoadingIndicator';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:event', location = '/includes/js/api/event.js' */
define("confluence/api/event",["ajs"],function(a){return{bind:function(){a.bind.apply(this,arguments)},unbind:function(){a.unbind.apply(this,arguments)},trigger:function(){a.trigger.apply(this,arguments)},stopEvent:function(){a.stopEvent.apply(this,arguments)}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:deferred-loaders', location = '/includes/js/deferred-dialog-loader.js' */
define("confluence/deferred-dialog-loader",["underscore","jquery","ajs","confluence/page-loading-indicator","confluence/api/event"],function(a,d,e,g,f){return function(){var h=g(d("body"));a.each({userStatus:{resource:"confluence.userstatus:userstatus-resources",selector:"#create-user-status-link",event:"deferred.userstatus.click"},movePageDialogTools:{resource:"confluence.web.resources:page-move-resources",selector:"#action-move-page-dialog-link",event:"deferred.page-move.tools-menu"},movePageDialogEditor:{resource:"confluence.web.resources:page-move-resources",
selector:"#rte-button-location",event:"deferred.page-move.editor"},moveBlogDialogTools:{resource:"confluence.web.resources:page-move-resources",selector:"#action-move-blogpost-dialog-link",event:"deferred.blog-move.tools-menu"},availableGadgetsHelp:{resource:"com.atlassian.confluence.plugins.gadgets:gadget-directory-resources",selector:"#gadget-directory-link",event:"deferred.available-gadgets.help-menu"},aboutConfluenceHelp:{resource:"confluence.web.resources:about",selector:"#confluence-about-link",
event:"deferred.about-confluence.help-menu"}},function(b){d("body").on("click",b.selector,function(a){var c=WRM.require("wr!"+b.resource,function(){f.trigger(b.event)});h.showUntilDialogVisible(c);c=b.resource+".requested";e.Analytics?e.Analytics.triggerPrivacyPolicySafeEvent(c):f.trigger("analyticsEvent",{name:c});a.preventDefault()})})}});require("confluence/module-exporter").safeRequire("confluence/deferred-dialog-loader",function(a){require("ajs").toInit(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:deferred-loaders', location = '/includes/js/page-permissions-deferred-loader.js' */
define("confluence/page-permissions-deferred-loader","confluence/dark-features confluence/legacy ajs confluence/page-loading-indicator jquery wrm".split(" "),function(a,b,c,d,e,f){var g=d(e("body"));return function(a){var b=f.require("wr!com.atlassian.confluence.plugins.confluence-page-restrictions-dialog:dialog-resources",function(){c.trigger("deferred.page.permissions")});g.showUntilDialogVisible(b,"There was an error loading the page restrictions. Please try again later.");a.preventDefault()}});
require("confluence/module-exporter").safeRequire("confluence/page-permissions-deferred-loader",function(a){var b=require("ajs");b.toInit(function(c){c("body").on("click","#rte-button-restrictions,#action-page-permissions-link",a);b.bind("system-content-metadata.open-restrictions-dialog",a)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:nps-amd-shims', location = '/js/amd-shims/ajs.js' */
define("atlassian-nps-plugin/js/amd-shims/ajs",function(){return AJS});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:nps-amd-shims', location = '/js/amd-shims/templates.js' */
define("atlassian-nps-plugin/js/amd-shims/templates",function(){return NPS.Templates});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:nps-amd-shims', location = '/js/amd-shims/wrm.js' */
define("atlassian-nps-plugin/js/amd-shims/wrm",function(){return WRM});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:nps-util', location = '/js/nps/util.js' */
define("atlassian-nps-plugin/js/nps/util",["atlassian-nps-plugin/js/nps/product","atlassian-nps-plugin/js/amd-shims/ajs"],function(b,a){var c={};c.kfyShuffle=function(g){for(var f=g.length-1;f>0;f--){var d=Math.floor(Math.random()*(f+1));var e=g[f];g[f]=g[d];g[d]=e}return g};c.sendAnalyticsEvent=function(d,e){e=e||{};e.product=b.getProductName().toLowerCase();e.page=window.location.pathname.replace(/\//g," ");var f={name:"nps."+d,data:e};a.trigger("analyticsEvent",f)};c.hasShowingDialog=function(){return a.$(".aui-dialog:visible, aui-dialog2:visible").length>0};return c});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:nps-util', location = '/js/nps/submission.js' */
define("atlassian-nps-plugin/js/nps/submission",["atlassian-nps-plugin/js/nps/util"],function(b){var a={};a.showNotification=function(c){b.sendAnalyticsEvent("notification.show",c)};a.startSurvey=function(){b.sendAnalyticsEvent("survey.start",{})};a.cancelSurvey=function(c){var d={};if(c){d.cancelContext=c}b.sendAnalyticsEvent("survey.cancel",d)};a.ignoreSurvey=function(){b.sendAnalyticsEvent("survey.ignore",{})};a.submitSurvey=function(c){b.sendAnalyticsEvent("survey.submit",c)};a.scheduleNextSurveyDate=function(c){b.sendAnalyticsEvent("survey.schedule",c)};a.showAcknowledgementFlag=function(c){b.sendAnalyticsEvent("server.acknowledge.show",c)};a.acceptAcknowledgementFlag=function(c){b.sendAnalyticsEvent("server.acknowledge.accept",c)};a.closeAcknowledgementFlag=function(c){b.sendAnalyticsEvent("server.acknowledge.close",c)};a.updateNpsStatus=function(c){b.sendAnalyticsEvent("server.status.changed",c)};return a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources', location = '/js/nps/product/confluence.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources', location = '/js/nps/client-storage.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources', location = '/js/nps/config-manager-server.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources', location = '/js/nps/session-manager.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources', location = '/js/atlassian-nps-plugin.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources', location = '/js/bootstrap.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-select2', location = 'js-vendor/jquery/plugins/jquery.select2.js' */
(function(A){if(typeof A.fn.each2=="undefined"){A.extend(A.fn,{each2:function(E){var C=A([0]),D=-1,B=this.length;while(++D<B&&(C.context=C[0]=this[D])&&E.call(C[0],D,C)!==false){}return this}})}})(jQuery);(function(d,M){if(window.Select2!==M){return }var k,n,X,C,A,P,O={x:0,y:0},V,W,k={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(o){o=o.which?o.which:o;switch(o){case k.LEFT:case k.RIGHT:case k.UP:case k.DOWN:return true}return false},isControl:function(p){var o=p.which;switch(o){case k.SHIFT:case k.CTRL:case k.ALT:return true}if(p.metaKey){return true}return false},isFunctionKey:function(o){o=o.which?o.which:o;return o>=112&&o<=123}},b="<div class='select2-measure-scrollbar'></div>",D={"\u24B6":"A","\uFF21":"A","\u00C0":"A","\u00C1":"A","\u00C2":"A","\u1EA6":"A","\u1EA4":"A","\u1EAA":"A","\u1EA8":"A","\u00C3":"A","\u0100":"A","\u0102":"A","\u1EB0":"A","\u1EAE":"A","\u1EB4":"A","\u1EB2":"A","\u0226":"A","\u01E0":"A","\u00C4":"A","\u01DE":"A","\u1EA2":"A","\u00C5":"A","\u01FA":"A","\u01CD":"A","\u0200":"A","\u0202":"A","\u1EA0":"A","\u1EAC":"A","\u1EB6":"A","\u1E00":"A","\u0104":"A","\u023A":"A","\u2C6F":"A","\uA732":"AA","\u00C6":"AE","\u01FC":"AE","\u01E2":"AE","\uA734":"AO","\uA736":"AU","\uA738":"AV","\uA73A":"AV","\uA73C":"AY","\u24B7":"B","\uFF22":"B","\u1E02":"B","\u1E04":"B","\u1E06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24B8":"C","\uFF23":"C","\u0106":"C","\u0108":"C","\u010A":"C","\u010C":"C","\u00C7":"C","\u1E08":"C","\u0187":"C","\u023B":"C","\uA73E":"C","\u24B9":"D","\uFF24":"D","\u1E0A":"D","\u010E":"D","\u1E0C":"D","\u1E10":"D","\u1E12":"D","\u1E0E":"D","\u0110":"D","\u018B":"D","\u018A":"D","\u0189":"D","\uA779":"D","\u01F1":"DZ","\u01C4":"DZ","\u01F2":"Dz","\u01C5":"Dz","\u24BA":"E","\uFF25":"E","\u00C8":"E","\u00C9":"E","\u00CA":"E","\u1EC0":"E","\u1EBE":"E","\u1EC4":"E","\u1EC2":"E","\u1EBC":"E","\u0112":"E","\u1E14":"E","\u1E16":"E","\u0114":"E","\u0116":"E","\u00CB":"E","\u1EBA":"E","\u011A":"E","\u0204":"E","\u0206":"E","\u1EB8":"E","\u1EC6":"E","\u0228":"E","\u1E1C":"E","\u0118":"E","\u1E18":"E","\u1E1A":"E","\u0190":"E","\u018E":"E","\u24BB":"F","\uFF26":"F","\u1E1E":"F","\u0191":"F","\uA77B":"F","\u24BC":"G","\uFF27":"G","\u01F4":"G","\u011C":"G","\u1E20":"G","\u011E":"G","\u0120":"G","\u01E6":"G","\u0122":"G","\u01E4":"G","\u0193":"G","\uA7A0":"G","\uA77D":"G","\uA77E":"G","\u24BD":"H","\uFF28":"H","\u0124":"H","\u1E22":"H","\u1E26":"H","\u021E":"H","\u1E24":"H","\u1E28":"H","\u1E2A":"H","\u0126":"H","\u2C67":"H","\u2C75":"H","\uA78D":"H","\u24BE":"I","\uFF29":"I","\u00CC":"I","\u00CD":"I","\u00CE":"I","\u0128":"I","\u012A":"I","\u012C":"I","\u0130":"I","\u00CF":"I","\u1E2E":"I","\u1EC8":"I","\u01CF":"I","\u0208":"I","\u020A":"I","\u1ECA":"I","\u012E":"I","\u1E2C":"I","\u0197":"I","\u24BF":"J","\uFF2A":"J","\u0134":"J","\u0248":"J","\u24C0":"K","\uFF2B":"K","\u1E30":"K","\u01E8":"K","\u1E32":"K","\u0136":"K","\u1E34":"K","\u0198":"K","\u2C69":"K","\uA740":"K","\uA742":"K","\uA744":"K","\uA7A2":"K","\u24C1":"L","\uFF2C":"L","\u013F":"L","\u0139":"L","\u013D":"L","\u1E36":"L","\u1E38":"L","\u013B":"L","\u1E3C":"L","\u1E3A":"L","\u0141":"L","\u023D":"L","\u2C62":"L","\u2C60":"L","\uA748":"L","\uA746":"L","\uA780":"L","\u01C7":"LJ","\u01C8":"Lj","\u24C2":"M","\uFF2D":"M","\u1E3E":"M","\u1E40":"M","\u1E42":"M","\u2C6E":"M","\u019C":"M","\u24C3":"N","\uFF2E":"N","\u01F8":"N","\u0143":"N","\u00D1":"N","\u1E44":"N","\u0147":"N","\u1E46":"N","\u0145":"N","\u1E4A":"N","\u1E48":"N","\u0220":"N","\u019D":"N","\uA790":"N","\uA7A4":"N","\u01CA":"NJ","\u01CB":"Nj","\u24C4":"O","\uFF2F":"O","\u00D2":"O","\u00D3":"O","\u00D4":"O","\u1ED2":"O","\u1ED0":"O","\u1ED6":"O","\u1ED4":"O","\u00D5":"O","\u1E4C":"O","\u022C":"O","\u1E4E":"O","\u014C":"O","\u1E50":"O","\u1E52":"O","\u014E":"O","\u022E":"O","\u0230":"O","\u00D6":"O","\u022A":"O","\u1ECE":"O","\u0150":"O","\u01D1":"O","\u020C":"O","\u020E":"O","\u01A0":"O","\u1EDC":"O","\u1EDA":"O","\u1EE0":"O","\u1EDE":"O","\u1EE2":"O","\u1ECC":"O","\u1ED8":"O","\u01EA":"O","\u01EC":"O","\u00D8":"O","\u01FE":"O","\u0186":"O","\u019F":"O","\uA74A":"O","\uA74C":"O","\u01A2":"OI","\uA74E":"OO","\u0222":"OU","\u24C5":"P","\uFF30":"P","\u1E54":"P","\u1E56":"P","\u01A4":"P","\u2C63":"P","\uA750":"P","\uA752":"P","\uA754":"P","\u24C6":"Q","\uFF31":"Q","\uA756":"Q","\uA758":"Q","\u024A":"Q","\u24C7":"R","\uFF32":"R","\u0154":"R","\u1E58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1E5A":"R","\u1E5C":"R","\u0156":"R","\u1E5E":"R","\u024C":"R","\u2C64":"R","\uA75A":"R","\uA7A6":"R","\uA782":"R","\u24C8":"S","\uFF33":"S","\u1E9E":"S","\u015A":"S","\u1E64":"S","\u015C":"S","\u1E60":"S","\u0160":"S","\u1E66":"S","\u1E62":"S","\u1E68":"S","\u0218":"S","\u015E":"S","\u2C7E":"S","\uA7A8":"S","\uA784":"S","\u24C9":"T","\uFF34":"T","\u1E6A":"T","\u0164":"T","\u1E6C":"T","\u021A":"T","\u0162":"T","\u1E70":"T","\u1E6E":"T","\u0166":"T","\u01AC":"T","\u01AE":"T","\u023E":"T","\uA786":"T","\uA728":"TZ","\u24CA":"U","\uFF35":"U","\u00D9":"U","\u00DA":"U","\u00DB":"U","\u0168":"U","\u1E78":"U","\u016A":"U","\u1E7A":"U","\u016C":"U","\u00DC":"U","\u01DB":"U","\u01D7":"U","\u01D5":"U","\u01D9":"U","\u1EE6":"U","\u016E":"U","\u0170":"U","\u01D3":"U","\u0214":"U","\u0216":"U","\u01AF":"U","\u1EEA":"U","\u1EE8":"U","\u1EEE":"U","\u1EEC":"U","\u1EF0":"U","\u1EE4":"U","\u1E72":"U","\u0172":"U","\u1E76":"U","\u1E74":"U","\u0244":"U","\u24CB":"V","\uFF36":"V","\u1E7C":"V","\u1E7E":"V","\u01B2":"V","\uA75E":"V","\u0245":"V","\uA760":"VY","\u24CC":"W","\uFF37":"W","\u1E80":"W","\u1E82":"W","\u0174":"W","\u1E86":"W","\u1E84":"W","\u1E88":"W","\u2C72":"W","\u24CD":"X","\uFF38":"X","\u1E8A":"X","\u1E8C":"X","\u24CE":"Y","\uFF39":"Y","\u1EF2":"Y","\u00DD":"Y","\u0176":"Y","\u1EF8":"Y","\u0232":"Y","\u1E8E":"Y","\u0178":"Y","\u1EF6":"Y","\u1EF4":"Y","\u01B3":"Y","\u024E":"Y","\u1EFE":"Y","\u24CF":"Z","\uFF3A":"Z","\u0179":"Z","\u1E90":"Z","\u017B":"Z","\u017D":"Z","\u1E92":"Z","\u1E94":"Z","\u01B5":"Z","\u0224":"Z","\u2C7F":"Z","\u2C6B":"Z","\uA762":"Z","\u24D0":"a","\uFF41":"a","\u1E9A":"a","\u00E0":"a","\u00E1":"a","\u00E2":"a","\u1EA7":"a","\u1EA5":"a","\u1EAB":"a","\u1EA9":"a","\u00E3":"a","\u0101":"a","\u0103":"a","\u1EB1":"a","\u1EAF":"a","\u1EB5":"a","\u1EB3":"a","\u0227":"a","\u01E1":"a","\u00E4":"a","\u01DF":"a","\u1EA3":"a","\u00E5":"a","\u01FB":"a","\u01CE":"a","\u0201":"a","\u0203":"a","\u1EA1":"a","\u1EAD":"a","\u1EB7":"a","\u1E01":"a","\u0105":"a","\u2C65":"a","\u0250":"a","\uA733":"aa","\u00E6":"ae","\u01FD":"ae","\u01E3":"ae","\uA735":"ao","\uA737":"au","\uA739":"av","\uA73B":"av","\uA73D":"ay","\u24D1":"b","\uFF42":"b","\u1E03":"b","\u1E05":"b","\u1E07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24D2":"c","\uFF43":"c","\u0107":"c","\u0109":"c","\u010B":"c","\u010D":"c","\u00E7":"c","\u1E09":"c","\u0188":"c","\u023C":"c","\uA73F":"c","\u2184":"c","\u24D3":"d","\uFF44":"d","\u1E0B":"d","\u010F":"d","\u1E0D":"d","\u1E11":"d","\u1E13":"d","\u1E0F":"d","\u0111":"d","\u018C":"d","\u0256":"d","\u0257":"d","\uA77A":"d","\u01F3":"dz","\u01C6":"dz","\u24D4":"e","\uFF45":"e","\u00E8":"e","\u00E9":"e","\u00EA":"e","\u1EC1":"e","\u1EBF":"e","\u1EC5":"e","\u1EC3":"e","\u1EBD":"e","\u0113":"e","\u1E15":"e","\u1E17":"e","\u0115":"e","\u0117":"e","\u00EB":"e","\u1EBB":"e","\u011B":"e","\u0205":"e","\u0207":"e","\u1EB9":"e","\u1EC7":"e","\u0229":"e","\u1E1D":"e","\u0119":"e","\u1E19":"e","\u1E1B":"e","\u0247":"e","\u025B":"e","\u01DD":"e","\u24D5":"f","\uFF46":"f","\u1E1F":"f","\u0192":"f","\uA77C":"f","\u24D6":"g","\uFF47":"g","\u01F5":"g","\u011D":"g","\u1E21":"g","\u011F":"g","\u0121":"g","\u01E7":"g","\u0123":"g","\u01E5":"g","\u0260":"g","\uA7A1":"g","\u1D79":"g","\uA77F":"g","\u24D7":"h","\uFF48":"h","\u0125":"h","\u1E23":"h","\u1E27":"h","\u021F":"h","\u1E25":"h","\u1E29":"h","\u1E2B":"h","\u1E96":"h","\u0127":"h","\u2C68":"h","\u2C76":"h","\u0265":"h","\u0195":"hv","\u24D8":"i","\uFF49":"i","\u00EC":"i","\u00ED":"i","\u00EE":"i","\u0129":"i","\u012B":"i","\u012D":"i","\u00EF":"i","\u1E2F":"i","\u1EC9":"i","\u01D0":"i","\u0209":"i","\u020B":"i","\u1ECB":"i","\u012F":"i","\u1E2D":"i","\u0268":"i","\u0131":"i","\u24D9":"j","\uFF4A":"j","\u0135":"j","\u01F0":"j","\u0249":"j","\u24DA":"k","\uFF4B":"k","\u1E31":"k","\u01E9":"k","\u1E33":"k","\u0137":"k","\u1E35":"k","\u0199":"k","\u2C6A":"k","\uA741":"k","\uA743":"k","\uA745":"k","\uA7A3":"k","\u24DB":"l","\uFF4C":"l","\u0140":"l","\u013A":"l","\u013E":"l","\u1E37":"l","\u1E39":"l","\u013C":"l","\u1E3D":"l","\u1E3B":"l","\u017F":"l","\u0142":"l","\u019A":"l","\u026B":"l","\u2C61":"l","\uA749":"l","\uA781":"l","\uA747":"l","\u01C9":"lj","\u24DC":"m","\uFF4D":"m","\u1E3F":"m","\u1E41":"m","\u1E43":"m","\u0271":"m","\u026F":"m","\u24DD":"n","\uFF4E":"n","\u01F9":"n","\u0144":"n","\u00F1":"n","\u1E45":"n","\u0148":"n","\u1E47":"n","\u0146":"n","\u1E4B":"n","\u1E49":"n","\u019E":"n","\u0272":"n","\u0149":"n","\uA791":"n","\uA7A5":"n","\u01CC":"nj","\u24DE":"o","\uFF4F":"o","\u00F2":"o","\u00F3":"o","\u00F4":"o","\u1ED3":"o","\u1ED1":"o","\u1ED7":"o","\u1ED5":"o","\u00F5":"o","\u1E4D":"o","\u022D":"o","\u1E4F":"o","\u014D":"o","\u1E51":"o","\u1E53":"o","\u014F":"o","\u022F":"o","\u0231":"o","\u00F6":"o","\u022B":"o","\u1ECF":"o","\u0151":"o","\u01D2":"o","\u020D":"o","\u020F":"o","\u01A1":"o","\u1EDD":"o","\u1EDB":"o","\u1EE1":"o","\u1EDF":"o","\u1EE3":"o","\u1ECD":"o","\u1ED9":"o","\u01EB":"o","\u01ED":"o","\u00F8":"o","\u01FF":"o","\u0254":"o","\uA74B":"o","\uA74D":"o","\u0275":"o","\u01A3":"oi","\u0223":"ou","\uA74F":"oo","\u24DF":"p","\uFF50":"p","\u1E55":"p","\u1E57":"p","\u01A5":"p","\u1D7D":"p","\uA751":"p","\uA753":"p","\uA755":"p","\u24E0":"q","\uFF51":"q","\u024B":"q","\uA757":"q","\uA759":"q","\u24E1":"r","\uFF52":"r","\u0155":"r","\u1E59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1E5B":"r","\u1E5D":"r","\u0157":"r","\u1E5F":"r","\u024D":"r","\u027D":"r","\uA75B":"r","\uA7A7":"r","\uA783":"r","\u24E2":"s","\uFF53":"s","\u00DF":"s","\u015B":"s","\u1E65":"s","\u015D":"s","\u1E61":"s","\u0161":"s","\u1E67":"s","\u1E63":"s","\u1E69":"s","\u0219":"s","\u015F":"s","\u023F":"s","\uA7A9":"s","\uA785":"s","\u1E9B":"s","\u24E3":"t","\uFF54":"t","\u1E6B":"t","\u1E97":"t","\u0165":"t","\u1E6D":"t","\u021B":"t","\u0163":"t","\u1E71":"t","\u1E6F":"t","\u0167":"t","\u01AD":"t","\u0288":"t","\u2C66":"t","\uA787":"t","\uA729":"tz","\u24E4":"u","\uFF55":"u","\u00F9":"u","\u00FA":"u","\u00FB":"u","\u0169":"u","\u1E79":"u","\u016B":"u","\u1E7B":"u","\u016D":"u","\u00FC":"u","\u01DC":"u","\u01D8":"u","\u01D6":"u","\u01DA":"u","\u1EE7":"u","\u016F":"u","\u0171":"u","\u01D4":"u","\u0215":"u","\u0217":"u","\u01B0":"u","\u1EEB":"u","\u1EE9":"u","\u1EEF":"u","\u1EED":"u","\u1EF1":"u","\u1EE5":"u","\u1E73":"u","\u0173":"u","\u1E77":"u","\u1E75":"u","\u0289":"u","\u24E5":"v","\uFF56":"v","\u1E7D":"v","\u1E7F":"v","\u028B":"v","\uA75F":"v","\u028C":"v","\uA761":"vy","\u24E6":"w","\uFF57":"w","\u1E81":"w","\u1E83":"w","\u0175":"w","\u1E87":"w","\u1E85":"w","\u1E98":"w","\u1E89":"w","\u2C73":"w","\u24E7":"x","\uFF58":"x","\u1E8B":"x","\u1E8D":"x","\u24E8":"y","\uFF59":"y","\u1EF3":"y","\u00FD":"y","\u0177":"y","\u1EF9":"y","\u0233":"y","\u1E8F":"y","\u00FF":"y","\u1EF7":"y","\u1E99":"y","\u1EF5":"y","\u01B4":"y","\u024F":"y","\u1EFF":"y","\u24E9":"z","\uFF5A":"z","\u017A":"z","\u1E91":"z","\u017C":"z","\u017E":"z","\u1E93":"z","\u1E95":"z","\u01B6":"z","\u0225":"z","\u0240":"z","\u2C6C":"z","\uA763":"z"};V=d(document);A=(function(){var o=1;return function(){return o++}}());function E(r){var p,q,o,s;if(!r||r.length<1){return r}p="";for(q=0,o=r.length;q<o;q++){s=r.charAt(q);p+=D[s]||s}return p}function Q(q,r){var p=0,o=r.length;for(;p<o;p=p+1){if(T(q,r[p])){return p}}return -1}function m(){var o=d(b);o.appendTo("body");var p={width:o.width()-o[0].clientWidth,height:o.height()-o[0].clientHeight};o.remove();return p}function T(p,o){if(p===o){return true}if(p===M||o===M){return false}if(p===null||o===null){return false}if(p.constructor===String){return p+""===o+""}if(o.constructor===String){return o+""===p+""}return false}function I(p,r){var s,q,o;if(p===null||p.length<1){return[]}s=p.split(r);for(q=0,o=s.length;q<o;q=q+1){s[q]=d.trim(s[q])}return s}function H(o){return o.outerWidth(false)-o.width()}function f(p){var o="keyup-change-value";p.on("keydown",function(){if(d.data(p,o)===M){d.data(p,o,p.val())}});p.on("keyup",function(){var q=d.data(p,o);if(q!==M&&p.val()!==q){d.removeData(p,o);p.trigger("keyup-change")}})}V.on("mousemove",function(o){O.x=o.pageX;O.y=o.pageY});function j(o){o.on("mousemove",function(q){var p=O;if(p===M||p.x!==q.pageX||p.y!==q.pageY){d(q.target).trigger("mousemove-filtered",q)}})}function K(r,p,o){o=o||M;var q;return function(){var s=arguments;window.clearTimeout(q);q=window.setTimeout(function(){p.apply(o,s)},r)}}function S(q){var o=false,p;return function(){if(o===false){p=q();o=true}return p}}function L(o,q){var p=K(o,function(r){q.trigger("scroll-debounced",r)});q.on("scroll",function(r){if(Q(r.target,q.get())>=0){p(r)}})}function i(o){if(o[0]===document.activeElement){return }window.setTimeout(function(){var q=o[0],r=o.val().length,p;o.focus();if(o.is(":visible")&&q===document.activeElement){if(q.setSelectionRange){q.setSelectionRange(r,r)}else{if(q.createTextRange){p=q.createTextRange();p.collapse(false);p.select()}}}},0)}function F(o){o=d(o)[0];var r=0;var p=0;if("selectionStart" in o){r=o.selectionStart;p=o.selectionEnd-r}else{if("selection" in document){o.focus();var q=document.selection.createRange();p=document.selection.createRange().text.length;q.moveStart("character",-o.value.length);r=q.text.length-p}}return{offset:r,length:p}}function a(o){o.preventDefault();o.stopPropagation()}function B(o){o.preventDefault();o.stopImmediatePropagation()}function N(p){if(!P){var o=p[0].currentStyle||window.getComputedStyle(p[0],null);P=d(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:o.fontSize,fontFamily:o.fontFamily,fontStyle:o.fontStyle,fontWeight:o.fontWeight,letterSpacing:o.letterSpacing,textTransform:o.textTransform,whiteSpace:"nowrap"});P.attr("class","select2-sizer");d("body").append(P)}P.text(p.val());return P.width()}function J(p,t,o){var r,s=[],q;r=p.attr("class");if(r){r=""+r;d(r.split(" ")).each2(function(){if(this.indexOf("select2-")===0){s.push(this)}})}r=t.attr("class");if(r){r=""+r;d(r.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){q=o(this);if(q){s.push(q)}}})}p.attr("class",s.join(" "))}function U(t,s,q,o){var r=E(t.toUpperCase()).indexOf(E(s.toUpperCase())),p=s.length;if(r<0){q.push(o(t));return }q.push(o(t.substring(0,r)));q.push("<span class='select2-match'>");q.push(o(t.substring(r,r+p)));q.push("</span>");q.push(o(t.substring(r+p,t.length)))}function g(o){var p={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(o).replace(/[&<>"'\/\\]/g,function(q){return p[q]})}function e(p){var s,q=null,t=p.quietMillis||100,r=p.url,o=this;return function(u){window.clearTimeout(s);s=window.setTimeout(function(){var x=p.data,w=r,z=p.transport||d.fn.select2.ajaxDefaults.transport,v={type:p.type||"GET",cache:p.cache||false,jsonpCallback:p.jsonpCallback||M,dataType:p.dataType||"json"},y=d.extend({},d.fn.select2.ajaxDefaults.params,v);x=x?x.call(o,u.term,u.page,u.context):null;w=(typeof w==="function")?w.call(o,u.term,u.page,u.context):w;if(q){q.abort()}if(p.params){if(d.isFunction(p.params)){d.extend(y,p.params.call(o))}else{d.extend(y,p.params)}}d.extend(y,{url:w,dataType:p.dataType,data:x,success:function(AB){var AA=p.results(AB,u.page);u.callback(AA)}});q=z.call(o,y)},t)}}function h(p){var s=p,r,q,t=function(u){return""+u.text};if(d.isArray(s)){q=s;s={results:q}}if(d.isFunction(s)===false){q=s;s=function(){return q}}var o=s();if(o.text){t=o.text;if(!d.isFunction(t)){r=o.text;t=function(u){return u[r]}}}return function(w){var v=w.term,u={results:[]},x;if(v===""){w.callback(s());return }x=function(z,AB){var AA,y;z=z[0];if(z.children){AA={};for(y in z){if(z.hasOwnProperty(y)){AA[y]=z[y]}}AA.children=[];d(z.children).each2(function(AC,AD){x(AD,AA.children)});if(AA.children.length||w.matcher(v,t(AA),z)){AB.push(AA)}}else{if(w.matcher(v,t(z),z)){AB.push(z)}}};d(s().results).each2(function(z,y){x(y,u.results)});w.callback(u)}}function Z(p){var o=d.isFunction(p);return function(s){var r=s.term,q={results:[]};d(o?p():p).each(function(){var t=this.text!==M,u=t?this.text:this;if(r===""||s.matcher(r,u)){q.results.push(t?this:{id:this,text:this})}});s.callback(q)}}function Y(o,p){if(d.isFunction(o)){return true}if(!o){return false}throw new Error(p+" must be a function or a falsy value")}function c(o){return d.isFunction(o)?o():o}function R(o){var p=0;d.each(o,function(q,r){if(r.children){p+=R(r.children)}else{p++}});return p}function G(w,x,u,o){var p=w,y=false,r,v,s,q,t;if(!o.createSearchChoice||!o.tokenSeparators||o.tokenSeparators.length<1){return M}while(true){v=-1;for(s=0,q=o.tokenSeparators.length;s<q;s++){t=o.tokenSeparators[s];v=w.indexOf(t);if(v>=0){break}}if(v<0){break}r=w.substring(0,v);w=w.substring(v+t.length);if(r.length>0){r=o.createSearchChoice.call(this,r,x);if(r!==M&&r!==null&&o.id(r)!==M&&o.id(r)!==null){y=false;for(s=0,q=x.length;s<q;s++){if(T(o.id(r),o.id(x[s]))){y=true;break}}if(!y){u(r)}}}}if(p!==w){return w}}function l(o,p){var q=function(){};q.prototype=new o;q.prototype.constructor=q;q.prototype.parent=o.prototype;q.prototype=d.extend(q.prototype,p);return q}n=l(Object,{bind:function(p){var o=this;return function(){p.apply(o,arguments)}},init:function(s){var q,p,t=".select2-results";this.opts=s=this.prepareOpts(s);this.id=s.id;if(s.element.data("select2")!==M&&s.element.data("select2")!==null){s.element.data("select2").destroy()}this.container=this.createContainer();this.containerId="s2id_"+(s.element.attr("id")||"autogen"+A());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=S(function(){return s.element.closest("body")});J(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.attr("style",s.element.attr("style"));this.container.css(c(s.containerCss));this.container.addClass(c(s.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabindex");this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",a);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");J(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(c(s.dropdownCssClass));this.dropdown.data("select2",this);this.dropdown.on("click",a);this.results=q=this.container.find(t);this.search=p=this.container.find("input.select2-input");this.queryCount=0;this.resultsPage=0;this.context=null;this.initContainer();this.container.on("click",a);j(this.results);this.dropdown.on("mousemove-filtered touchstart touchmove touchend",t,this.bind(this.highlightUnderEvent));L(80,this.results);this.dropdown.on("scroll-debounced",t,this.bind(this.loadMoreIfNeeded));d(this.container).on("change",".select2-input",function(u){u.stopPropagation()});d(this.dropdown).on("change",".select2-input",function(u){u.stopPropagation()});if(d.fn.mousewheel){q.mousewheel(function(x,y,v,u){var w=q.scrollTop();if(u>0&&w-u<=0){q.scrollTop(0);a(x)}else{if(u<0&&q.get(0).scrollHeight-q.scrollTop()+u<=q.height()){q.scrollTop(q.get(0).scrollHeight-q.height());a(x)}}})}f(p);p.on("keyup-change input paste",this.bind(this.updateResults));p.on("focus",function(){p.addClass("select2-focused")});p.on("blur",function(){p.removeClass("select2-focused")});this.dropdown.on("mouseup",t,this.bind(function(u){if(d(u.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(u);this.selectHighlighted(u)}}));this.dropdown.on("click mouseup mousedown",function(u){u.stopPropagation()});if(d.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(s.maximumInputLength!==null){this.search.attr("maxlength",s.maximumInputLength)}var r=s.element.prop("disabled");if(r===M){r=false}this.enable(!r);var o=s.element.prop("readonly");if(o===M){o=false}this.readonly(o);W=W||m();this.autofocus=s.element.prop("autofocus");s.element.prop("autofocus",false);if(this.autofocus){this.focus()}this.nextSearchTerm=M},destroy:function(){var p=this.opts.element,o=p.data("select2");this.close();if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}if(o!==M){o.container.remove();o.dropdown.remove();p.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||false);if(this.elementTabIndex){p.attr({tabindex:this.elementTabIndex})}else{p.removeAttr("tabindex")}p.show()}},optionToData:function(o){if(o.is("option")){return{id:o.prop("value"),text:o.text(),element:o.get(),css:o.attr("class"),disabled:o.prop("disabled"),locked:T(o.attr("locked"),"locked")||T(o.data("locked"),true)}}else{if(o.is("optgroup")){return{text:o.attr("label"),children:[],element:o.get(),css:o.attr("class")}}}},prepareOpts:function(t){var r,p,o,s,q=this;r=t.element;if(r.get(0).tagName.toLowerCase()==="select"){this.select=p=t.element}if(p){d.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in t){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}t=d.extend({},{populateResults:function(u,v,x){var w,y=this.opts.id;w=function(AF,z,AE){var AG,AB,AL,AI,AC,AK,AA,AJ,AH,AD;AF=t.sortResults(AF,z,x);for(AG=0,AB=AF.length;AG<AB;AG=AG+1){AL=AF[AG];AC=(AL.disabled===true);AI=(!AC)&&(y(AL)!==M);AK=AL.children&&AL.children.length>0;AA=d("<li></li>");AA.addClass("select2-results-dept-"+AE);AA.addClass("select2-result");AA.addClass(AI?"select2-result-selectable":"select2-result-unselectable");if(AC){AA.addClass("select2-disabled")}if(AK){AA.addClass("select2-result-with-children")}AA.addClass(q.opts.formatResultCssClass(AL));AJ=d(document.createElement("div"));AJ.addClass("select2-result-label");AD=t.formatResult(AL,AJ,x,q.opts.escapeMarkup);if(AD!==M){AJ.html(AD)}AA.append(AJ);if(AK){AH=d("<ul></ul>");AH.addClass("select2-result-sub");w(AL.children,AH,AE+1);AA.append(AH)}AA.data("select2-data",AL);z.append(AA)}};w(v,u,0)}},d.fn.select2.defaults,t);if(typeof (t.id)!=="function"){o=t.id;t.id=function(u){return u[o]}}if(d.isArray(t.element.data("select2Tags"))){if("tags" in t){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+t.element.attr("id")}t.tags=t.element.data("select2Tags")}if(p){t.query=this.bind(function(y){var x={results:[],more:false},w=y.term,v,u,z;z=function(AA,AC){var AB;if(AA.is("option")){if(y.matcher(w,AA.text(),AA)){AC.push(q.optionToData(AA))}}else{if(AA.is("optgroup")){AB=q.optionToData(AA);AA.children().each2(function(AD,AE){z(AE,AB.children)});if(AB.children.length>0){AC.push(AB)}}}};v=r.children();if(this.getPlaceholder()!==M&&v.length>0){u=this.getPlaceholderOption();if(u){v=v.not(u)}}v.each2(function(AA,AB){z(AB,x.results)});y.callback(x)});t.id=function(u){return u.id};t.formatResultCssClass=function(u){return u.css}}else{if(!("query" in t)){if("ajax" in t){s=t.element.data("ajax-url");if(s&&s.length>0){t.ajax.url=s}t.query=e.call(t.element,t.ajax)}else{if("data" in t){t.query=h(t.data)}else{if("tags" in t){t.query=Z(t.tags);if(t.createSearchChoice===M){t.createSearchChoice=function(u){return{id:d.trim(u),text:d.trim(u)}}}if(t.initSelection===M){t.initSelection=function(u,w){var v=[];d(I(u.val(),t.separator)).each(function(){var y={id:this,text:this},x=t.tags;if(d.isFunction(x)){x=x()}d(x).each(function(){if(T(this.id,y.id)){y=this;return false}});v.push(y)});w(v)}}}}}}}if(typeof (t.query)!=="function"){throw"query function not defined for Select2 "+t.element.attr("id")}return t},monitorSource:function(){var p=this.opts.element,q,o;p.on("change.select2",this.bind(function(r){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));q=this.bind(function(){var s=p.prop("disabled");if(s===M){s=false}this.enable(!s);var r=p.prop("readonly");if(r===M){r=false}this.readonly(r);J(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(c(this.opts.containerCssClass));J(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(c(this.opts.dropdownCssClass))});p.on("propertychange.select2",q);if(this.mutationCallback===M){this.mutationCallback=function(r){r.forEach(q)}}o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(o!==M){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new o(this.mutationCallback);this.propertyObserver.observe(p.get(0),{attributes:true,subtree:false})}},triggerSelect:function(p){var o=d.Event("select2-selecting",{val:this.id(p),object:p});this.opts.element.trigger(o);return !o.isDefaultPrevented()},triggerChange:function(o){o=o||{};o=d.extend({},o,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(o);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange){this.opts.element.blur()}},isInterfaceEnabled:function(){return this.enabledInterface===true},enableInterface:function(){var o=this._enabled&&!this._readonly,p=!o;if(o===this.enabledInterface){return false}this.container.toggleClass("select2-container-disabled",p);this.close();this.enabledInterface=o;return true},enable:function(o){if(o===M){o=true}if(this._enabled===o){return }this._enabled=o;this.opts.element.prop("disabled",!o);this.enableInterface()},disable:function(){this.enable(false)},readonly:function(o){if(o===M){o=false}if(this._readonly===o){return false}this._readonly=o;this.opts.element.prop("readonly",o);this.enableInterface();return true},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var q=this.dropdown,t=this.container.offset(),AC=this.container.outerHeight(false),AD=this.container.outerWidth(false),y=q.outerHeight(false),AA=d(window),AH=AA.width(),w=AA.height(),p=AA.scrollLeft()+AH,AG=AA.scrollTop()+w,r=t.top+AC,AE=t.left,o=r+y<=AG,v=(t.top-y)>=this.body().scrollTop(),z=q.outerWidth(false),AJ=AE+z<=p,AI=q.hasClass("select2-drop-above"),u,AF,s,x,AB;if(AI){AF=true;if(!v&&o){s=true;AF=false}}else{AF=false;if(!o&&v){s=true;AF=true}}if(s){q.hide();t=this.container.offset();AC=this.container.outerHeight(false);AD=this.container.outerWidth(false);y=q.outerHeight(false);p=AA.scrollLeft()+AH;AG=AA.scrollTop()+w;r=t.top+AC;AE=t.left;z=q.outerWidth(false);AJ=AE+z<=p;q.show()}if(this.opts.dropdownAutoWidth){AB=d(".select2-results",q)[0];q.addClass("select2-drop-auto-width");q.css("width","");z=q.outerWidth(false)+(AB.scrollHeight===AB.clientHeight?0:W.width);z>AD?AD=z:z=AD;AJ=AE+z<=p}else{this.container.removeClass("select2-drop-auto-width")}if(this.body().css("position")!=="static"){u=this.body().offset();r-=u.top;AE-=u.left}if(!AJ){AE=t.left+AD-z}x={left:AE,width:AD};if(AF){x.bottom=w-t.top;x.top="auto";this.container.addClass("select2-drop-above");q.addClass("select2-drop-above")}else{x.top=r;x.bottom="auto";this.container.removeClass("select2-drop-above");q.removeClass("select2-drop-above")}x=d.extend(x,c(this.opts.dropdownCss));q.css(x)},shouldOpen:function(){var o;if(this.opened()){return false}if(this._enabled===false||this._readonly===true){return false}o=d.Event("select2-opening");this.opts.element.trigger(o);return !o.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}this.opening();return true},opening:function(){var t=this.containerId,o="scroll."+t,r="resize."+t,q="orientationchange."+t,p;this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.clearDropdownAlignmentPreference();if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}p=d("#select2-drop-mask");if(p.length==0){p=d(document.createElement("div"));p.attr("id","select2-drop-mask").attr("class","select2-drop-mask");p.hide();p.appendTo(this.body());p.on("mousedown touchstart click",function(v){var w=d("#select2-drop"),u;if(w.length>0){u=w.data("select2");if(u.opts.selectOnBlur){u.selectHighlighted({noFocus:true})}u.close({focus:true});v.preventDefault();v.stopPropagation()}})}if(this.dropdown.prev()[0]!==p[0]){this.dropdown.before(p)}d("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");p.show();this.positionDropdown();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");var s=this;this.container.parents().add(window).each(function(){d(this).on(r+" "+o+" "+q,function(u){s.positionDropdown()})})},close:function(){if(!this.opened()){return }var r=this.containerId,o="scroll."+r,q="resize."+r,p="orientationchange."+r;this.container.parents().add(window).each(function(){d(this).off(o).off(q).off(p)});this.clearDropdownAlignmentPreference();d("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.search.removeClass("select2-active");this.opts.element.trigger(d.Event("select2-close"))},externalSearch:function(o){this.open();this.search.val(o);this.updateResults(false)},clearSearch:function(){},getMaximumSelectionSize:function(){return c(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var r=this.results,q,o,v,u,s,t,p;o=this.highlight();if(o<0){return }if(o==0){r.scrollTop(0);return }q=this.findHighlightableChoices().find(".select2-result-label");v=d(q[o]);u=v.offset().top+v.outerHeight(true);if(o===q.length-1){p=r.find("li.select2-more-results");if(p.length>0){u=p.offset().top+p.outerHeight(true)}}s=r.offset().top+r.outerHeight(true);if(u>s){r.scrollTop(r.scrollTop()+(u-s))}t=v.offset().top-r.offset().top;if(t<0&&v.css("display")!="none"){r.scrollTop(r.scrollTop()+t)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled, .select2-selected)")},moveHighlight:function(r){var q=this.findHighlightableChoices(),p=this.highlight();while(p>-1&&p<q.length){p+=r;var o=d(q[p]);if(o.hasClass("select2-result-selectable")&&!o.hasClass("select2-disabled")&&!o.hasClass("select2-selected")){this.highlight(p);break}}},highlight:function(p){var r=this.findHighlightableChoices(),o,q;if(arguments.length===0){return Q(r.filter(".select2-highlighted")[0],r.get())}if(p>=r.length){p=r.length-1}if(p<0){p=0}this.removeHighlight();o=d(r[p]);o.addClass("select2-highlighted");this.ensureHighlightVisible();q=o.data("select2-data");if(q){this.opts.element.trigger({type:"select2-highlight",val:this.id(q),choice:q})}},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(p){var o=d(p.target).closest(".select2-result-selectable");if(o.length>0&&!o.is(".select2-highlighted")){var q=this.findHighlightableChoices();this.highlight(q.index(o))}else{if(o.length==0){this.removeHighlight()}}},loadMoreIfNeeded:function(){var s=this.results,r=s.find("li.select2-more-results"),u,t=this.resultsPage+1,o=this,q=this.search.val(),p=this.context;if(r.length===0){return }u=r.offset().top-s.offset().top-s.height();if(u<=this.opts.loadMorePadding){r.addClass("select2-active");this.opts.query({element:this.opts.element,term:q,page:t,context:p,matcher:this.opts.matcher,callback:this.bind(function(v){if(!o.opened()){return }o.opts.populateResults.call(this,s,v.results,{term:q,page:t,context:p});o.postprocessResults(v,false,false);if(v.more===true){r.detach().appendTo(s).text(o.opts.formatLoadMore(t+1));window.setTimeout(function(){o.loadMoreIfNeeded()},10)}else{r.remove()}o.positionDropdown();o.resultsPage=t;o.context=v.context;this.opts.element.trigger({type:"select2-loaded",items:v})})})}},tokenize:function(){},updateResults:function(w){var AA=this.search,u=this.results,o=this.opts,t,z=this,x,s=AA.val(),q=d.data(this.container,"select2-last-term"),y;if(w!==true&&q&&T(s,q)){return }d.data(this.container,"select2-last-term",s);if(w!==true&&(this.showSearchInput===false||!this.opened())){return }function v(){AA.removeClass("select2-active");z.positionDropdown()}function p(AB){u.html(AB);v()}y=++this.queryCount;var r=this.getMaximumSelectionSize();if(r>=1){t=this.data();if(d.isArray(t)&&t.length>=r&&Y(o.formatSelectionTooBig,"formatSelectionTooBig")){p("<li class='select2-selection-limit'>"+o.formatSelectionTooBig(r)+"</li>");return }}if(AA.val().length<o.minimumInputLength){if(Y(o.formatInputTooShort,"formatInputTooShort")){p("<li class='select2-no-results'>"+o.formatInputTooShort(AA.val(),o.minimumInputLength)+"</li>")}else{p("")}if(w&&this.showSearch){this.showSearch(true)}return }if(o.maximumInputLength&&AA.val().length>o.maximumInputLength){if(Y(o.formatInputTooLong,"formatInputTooLong")){p("<li class='select2-no-results'>"+o.formatInputTooLong(AA.val(),o.maximumInputLength)+"</li>")}else{p("")}return }if(o.formatSearching&&this.findHighlightableChoices().length===0){p("<li class='select2-searching'>"+o.formatSearching()+"</li>")}AA.addClass("select2-active");this.removeHighlight();x=this.tokenize();if(x!=M&&x!=null){AA.val(x)}this.resultsPage=1;o.query({element:o.element,term:AA.val(),page:this.resultsPage,context:null,matcher:o.matcher,callback:this.bind(function(AC){var AB;if(y!=this.queryCount){return }if(!this.opened()){this.search.removeClass("select2-active");return }this.context=(AC.context===M)?null:AC.context;if(this.opts.createSearchChoice&&AA.val()!==""){AB=this.opts.createSearchChoice.call(z,AA.val(),AC.results);if(AB!==M&&AB!==null&&z.id(AB)!==M&&z.id(AB)!==null){if(d(AC.results).filter(function(){return T(z.id(this),z.id(AB))}).length===0){AC.results.unshift(AB)}}}if(AC.results.length===0&&Y(o.formatNoMatches,"formatNoMatches")){p("<li class='select2-no-results'>"+o.formatNoMatches(AA.val())+"</li>");return }u.empty();z.opts.populateResults.call(this,u,AC.results,{term:AA.val(),page:this.resultsPage,context:null});if(AC.more===true&&Y(o.formatLoadMore,"formatLoadMore")){u.append("<li class='select2-more-results'>"+z.opts.escapeMarkup(o.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){z.loadMoreIfNeeded()},10)}this.postprocessResults(AC,w);v();this.opts.element.trigger({type:"select2-loaded",items:AC})})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur){this.selectHighlighted({noFocus:true})}this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){i(this.search)},selectHighlighted:function(p){var o=this.highlight(),q=this.results.find(".select2-highlighted"),r=q.closest(".select2-result").data("select2-data");if(r){this.highlight(o);this.onSelect(r,p)}else{if(p&&p.noFocus){this.close()}}},getPlaceholder:function(){var o;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((o=this.getPlaceholderOption())!==M?o.text():M)},getPlaceholderOption:function(){if(this.select){var o=this.select.children("option").first();if(this.opts.placeholderOption!==M){return(this.opts.placeholderOption==="first"&&o)||(typeof this.opts.placeholderOption==="function"&&this.opts.placeholderOption(this.select))}else{if(o.text()===""&&o.val()===""){return o}}}},initContainerWidth:function(){function p(){var u,s,v,t,r,q;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){u=this.opts.element.attr("style");if(u!==M){s=u.split(";");for(t=0,r=s.length;t<r;t=t+1){q=s[t].replace(/\s/g,"");v=q.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i);if(v!==null&&v.length>=1){return v[1]}}}if(this.opts.width==="resolve"){u=this.opts.element.css("width");if(u.indexOf("%")>0){return u}return(this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px")}return null}else{if(d.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var o=p.call(this);if(o!==null){this.container.css("width",o)}}});X=l(n,{createContainer:function(){var o=d(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return o},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.focusser.prop("disabled",!this.isInterfaceEnabled())}},opening:function(){var q,p,o;if(this.opts.minimumResultsForSearch>=0){this.showSearch(true)}this.parent.opening.apply(this,arguments);if(this.showSearchInput!==false){this.search.val(this.focusser.val())}this.search.focus();q=this.search.get(0);if(q.createTextRange){p=q.createTextRange();p.collapse(false);p.select()}else{if(q.setSelectionRange){o=this.search.val().length;q.setSelectionRange(o,o)}}if(this.search.val()===""){if(this.nextSearchTerm!=M){this.search.val(this.nextSearchTerm);this.search.select()}}this.focusser.prop("disabled",true).val("");this.updateResults(true);this.opts.element.trigger(d.Event("select2-open"))},close:function(o){if(!this.opened()){return }this.parent.close.apply(this,arguments);o=o||{focus:true};this.focusser.removeAttr("disabled");if(o.focus){this.focusser.focus()}},focus:function(){if(this.opened()){this.close()}else{this.focusser.removeAttr("disabled");this.focusser.focus()}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},destroy:function(){d("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments)},initContainer:function(){var p,o=this.container,q=this.dropdown;if(this.opts.minimumResultsForSearch<0){this.showSearch(false)}else{this.showSearch(true)}this.selection=p=o.find(".select2-choice");this.focusser=o.find(".select2-focusser");this.focusser.attr("id","s2id_autogen"+A());d("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id"));this.focusser.attr("tabindex",this.elementTabIndex);this.search.on("keydown",this.bind(function(r){if(!this.isInterfaceEnabled()){return }if(r.which===k.PAGE_UP||r.which===k.PAGE_DOWN){a(r);return }switch(r.which){case k.UP:case k.DOWN:this.moveHighlight((r.which===k.UP)?-1:1);a(r);return ;case k.ENTER:this.selectHighlighted();a(r);return ;case k.TAB:this.selectHighlighted({noFocus:true});return ;case k.ESC:this.cancel(r);a(r);return }}));this.search.on("blur",this.bind(function(r){if(document.activeElement===this.body().get(0)){window.setTimeout(this.bind(function(){this.search.focus()}),0)}}));this.focusser.on("keydown",this.bind(function(r){if(!this.isInterfaceEnabled()){return }if(r.which===k.TAB||k.isControl(r)||k.isFunctionKey(r)||r.which===k.ESC){return }if(this.opts.openOnEnter===false&&r.which===k.ENTER){a(r);return }if(r.which==k.DOWN||r.which==k.UP||(r.which==k.ENTER&&this.opts.openOnEnter)){if(r.altKey||r.ctrlKey||r.shiftKey||r.metaKey){return }this.open();a(r);return }if(r.which==k.DELETE||r.which==k.BACKSPACE){if(this.opts.allowClear){this.clear()}a(r);return }}));f(this.focusser);this.focusser.on("keyup-change input",this.bind(function(r){if(this.opts.minimumResultsForSearch>=0){r.stopPropagation();if(this.opened()){return }this.open()}}));p.on("mousedown","abbr",this.bind(function(r){if(!this.isInterfaceEnabled()){return }this.clear();B(r);this.close();this.selection.focus()}));p.on("mousedown",this.bind(function(r){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}if(this.opened()){this.close()}else{if(this.isInterfaceEnabled()){this.open()}}a(r)}));q.on("mousedown",this.bind(function(){this.search.focus()}));p.on("focus",this.bind(function(r){a(r)}));this.focusser.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active");this.opts.element.trigger(d.Event("select2-blur"))}}));this.search.on("focus",this.bind(function(){if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}this.container.addClass("select2-container-active")}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.setPlaceholder()},clear:function(q){var r=this.selection.data("select2-data");if(r){var p=d.Event("select2-clearing");this.opts.element.trigger(p);if(p.isDefaultPrevented()){return }var o=this.getPlaceholderOption();this.opts.element.val(o?o.val():"");this.selection.find(".select2-chosen").empty();this.selection.removeData("select2-data");this.setPlaceholder();if(q!==false){this.opts.element.trigger({type:"select2-removed",val:this.id(r),choice:r});this.triggerChange({removed:r})}}},initSelection:function(){var p;if(this.isPlaceholderOptionSelected()){this.updateSelection(null);this.close();this.setPlaceholder()}else{var o=this;this.opts.initSelection.call(null,this.opts.element,function(q){if(q!==M&&q!==null){o.updateSelection(q);o.close();o.setPlaceholder()}})}},isPlaceholderOptionSelected:function(){var o;if(!this.getPlaceholder()){return false}return((o=this.getPlaceholderOption())!==M&&o.prop("selected"))||(this.opts.element.val()==="")||(this.opts.element.val()===M)||(this.opts.element.val()===null)},prepareOpts:function(){var p=this.parent.prepareOpts.apply(this,arguments),o=this;if(p.element.get(0).tagName.toLowerCase()==="select"){p.initSelection=function(q,s){var r=q.find("option").filter(function(){return this.selected});s(o.optionToData(r))}}else{if("data" in p){p.initSelection=p.initSelection||function(r,t){var s=r.val();var q=null;p.query({matcher:function(u,x,v){var w=T(s,p.id(v));if(w){q=v}return w},callback:!d.isFunction(t)?d.noop:function(){t(q)}})}}}return p},getPlaceholder:function(){if(this.select){if(this.getPlaceholderOption()===M){return M}}return this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var o=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&o!==M){if(this.select&&this.getPlaceholderOption()===M){return }this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(o));this.selection.addClass("select2-default");this.container.removeClass("select2-allowclear")}},postprocessResults:function(t,p,s){var r=0,o=this,u=true;this.findHighlightableChoices().each2(function(v,w){if(T(o.id(w.data("select2-data")),o.opts.element.val())){r=v;return false}});if(s!==false){if(p===true&&r>=0){this.highlight(r)}else{this.highlight(0)}}if(p===true){var q=this.opts.minimumResultsForSearch;if(q>=0){this.showSearch(R(t.results)>=q)}}},showSearch:function(o){if(this.showSearchInput===o){return }this.showSearchInput=o;this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!o);this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!o);d(this.dropdown,this.container).toggleClass("select2-with-searchbox",o)},onSelect:function(q,p){if(!this.triggerSelect(q)){return }var o=this.opts.element.val(),r=this.data();this.opts.element.val(this.id(q));this.updateSelection(q);this.opts.element.trigger({type:"select2-selected",val:this.id(q),choice:q});this.nextSearchTerm=this.opts.nextSearchTerm(q,this.search.val());this.close();if(!p||!p.noFocus){this.focusser.focus()}if(!T(o,this.id(q))){this.triggerChange({added:q,removed:r})}},updateSelection:function(r){var p=this.selection.find(".select2-chosen"),q,o;this.selection.data("select2-data",r);p.empty();if(r!==null){q=this.opts.formatSelection(r,p,this.opts.escapeMarkup)}if(q!==M){p.append(q)}o=this.opts.formatSelectionCssClass(r,p);if(o!==M){p.addClass(o)}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==M){this.container.addClass("select2-allowclear")}},val:function(){var s,p=false,q=null,o=this,r=this.data();if(arguments.length===0){return this.opts.element.val()}s=arguments[0];if(arguments.length>1){p=arguments[1]}if(this.select){this.select.val(s).find("option").filter(function(){return this.selected}).each2(function(t,u){q=o.optionToData(u);return false});this.updateSelection(q);this.setPlaceholder();if(p){this.triggerChange({added:q,removed:r})}}else{if(!s&&s!==0){this.clear(p);return }if(this.opts.initSelection===M){throw new Error("cannot call val() if initSelection() is not defined")}this.opts.element.val(s);this.opts.initSelection(this.opts.element,function(t){o.opts.element.val(!t?"":o.id(t));o.updateSelection(t);o.setPlaceholder();if(p){o.triggerChange({added:t,removed:r})}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(q){var p,o=false;if(arguments.length===0){p=this.selection.data("select2-data");if(p==M){p=null}return p}else{if(arguments.length>1){o=arguments[1]}if(!q){this.clear(o)}else{p=this.data();this.opts.element.val(!q?"":this.id(q));this.updateSelection(q);if(o){this.triggerChange({added:q,removed:p})}}}}});C=l(n,{createContainer:function(){var o=d(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return o},prepareOpts:function(){var p=this.parent.prepareOpts.apply(this,arguments),o=this;if(p.element.get(0).tagName.toLowerCase()==="select"){p.initSelection=function(q,s){var r=[];q.find("option").filter(function(){return this.selected}).each2(function(t,u){r.push(o.optionToData(u))});s(r)}}else{if("data" in p){p.initSelection=p.initSelection||function(q,t){var r=I(q.val(),p.separator);var s=[];p.query({matcher:function(u,x,v){var w=d.grep(r,function(y){return T(y,p.id(v))}).length;if(w){s.push(v)}return w},callback:!d.isFunction(t)?d.noop:function(){var u=[];for(var x=0;x<r.length;x++){var y=r[x];for(var w=0;w<s.length;w++){var v=s[w];if(T(y,p.id(v))){u.push(v);s.splice(w,1);break}}}t(u)}})}}}return p},selectChoice:function(o){var p=this.container.find(".select2-search-choice-focus");if(p.length&&o&&o[0]==p[0]){}else{if(p.length){this.opts.element.trigger("choice-deselected",p)}p.removeClass("select2-search-choice-focus");if(o&&o.length){this.close();o.addClass("select2-search-choice-focus");this.opts.element.trigger("choice-selected",o)}}},destroy:function(){d("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments)},initContainer:function(){var o=".select2-choices",p;this.searchContainer=this.container.find(".select2-search-field");this.selection=p=this.container.find(o);var q=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(r){q.search[0].focus();q.selectChoice(d(this))});this.search.attr("id","s2id_autogen"+A());d("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id"));this.search.on("input paste",this.bind(function(){if(!this.isInterfaceEnabled()){return }if(!this.opened()){this.open()}}));this.search.attr("tabindex",this.elementTabIndex);this.keydowns=0;this.search.on("keydown",this.bind(function(v){if(!this.isInterfaceEnabled()){return }++this.keydowns;var t=p.find(".select2-search-choice-focus");var u=t.prev(".select2-search-choice:not(.select2-locked)");var s=t.next(".select2-search-choice:not(.select2-locked)");var w=F(this.search);if(t.length&&(v.which==k.LEFT||v.which==k.RIGHT||v.which==k.BACKSPACE||v.which==k.DELETE||v.which==k.ENTER)){var r=t;if(v.which==k.LEFT&&u.length){r=u}else{if(v.which==k.RIGHT){r=s.length?s:null}else{if(v.which===k.BACKSPACE){this.unselect(t.first());this.search.width(10);r=u.length?u:s}else{if(v.which==k.DELETE){this.unselect(t.first());this.search.width(10);r=s.length?s:null}else{if(v.which==k.ENTER){r=null}}}}}this.selectChoice(r);a(v);if(!r||!r.length){this.open()}return }else{if(((v.which===k.BACKSPACE&&this.keydowns==1)||v.which==k.LEFT)&&(w.offset==0&&!w.length)){this.selectChoice(p.find(".select2-search-choice:not(.select2-locked)").last());a(v);return }else{this.selectChoice(null)}}if(this.opened()){switch(v.which){case k.UP:case k.DOWN:this.moveHighlight((v.which===k.UP)?-1:1);a(v);return ;case k.ENTER:this.selectHighlighted();a(v);return ;case k.TAB:this.selectHighlighted({noFocus:true});this.close();return ;case k.ESC:this.cancel(v);a(v);return }}if(v.which===k.TAB||k.isControl(v)||k.isFunctionKey(v)||v.which===k.BACKSPACE||v.which===k.ESC){return }if(v.which===k.ENTER){if(this.opts.openOnEnter===false){return }else{if(v.altKey||v.ctrlKey||v.shiftKey||v.metaKey){return }}}this.open();if(v.which===k.PAGE_UP||v.which===k.PAGE_DOWN){a(v)}if(v.which===k.ENTER){a(v)}}));this.search.on("keyup",this.bind(function(r){this.keydowns=0;this.resizeSearch()}));this.search.on("blur",this.bind(function(r){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.selectChoice(null);if(!this.opened()){this.clearSearch()}r.stopImmediatePropagation();this.opts.element.trigger(d.Event("select2-blur"))}));this.container.on("click",o,this.bind(function(r){if(!this.isInterfaceEnabled()){return }if(d(r.target).closest(".select2-search-choice").length>0){return }this.selectChoice(null);this.clearPlaceholder();if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}this.open();this.focusSearch();r.preventDefault()}));this.container.on("focus",o,this.bind(function(){if(!this.isInterfaceEnabled()){return }if(!this.container.hasClass("select2-container-active")){this.opts.element.trigger(d.Event("select2-focus"))}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.clearSearch()},enableInterface:function(){if(this.parent.enableInterface.apply(this,arguments)){this.search.prop("disabled",!this.isInterfaceEnabled())}},initSelection:function(){var p;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var o=this;this.opts.initSelection.call(null,this.opts.element,function(q){if(q!==M&&q!==null){o.updateSelection(q);o.close();o.clearSearch()}})}},clearSearch:function(){var p=this.getPlaceholder(),o=this.getMaxSearchWidth();if(p!==M&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(p).addClass("select2-default");this.search.width(o>0?o:this.container.css("width"))}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.clearPlaceholder();this.resizeSearch();this.parent.opening.apply(this,arguments);this.focusSearch();this.updateResults(true);this.search.focus();this.opts.element.trigger(d.Event("select2-open"))},close:function(){if(!this.opened()){return }this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(r){var q=[],p=[],o=this;d(r).each(function(){if(Q(o.id(this),q)<0){q.push(o.id(this));p.push(this)}});r=p;this.selection.find(".select2-search-choice").remove();d(r).each(function(){o.addSelectedChoice(this)});o.postprocessResults()},tokenize:function(){var o=this.search.val();o=this.opts.tokenizer.call(this,o,this.data(),this.bind(this.onSelect),this.opts);if(o!=null&&o!=M){this.search.val(o);if(o.length>0){this.open()}}},onSelect:function(p,o){if(!this.triggerSelect(p)){return }this.addSelectedChoice(p);this.opts.element.trigger({type:"selected",val:this.id(p),choice:p});if(this.select||!this.opts.closeOnSelect){this.postprocessResults(p,false,this.opts.closeOnSelect===true)}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:p});if(!o||!o.noFocus){this.focusSearch()}},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(s){var u=!s.locked,q=d("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),v=d("<li class='select2-search-choice select2-locked'><div></div></li>");var r=u?q:v,o=this.id(s),p=this.getVal(),t,w;t=this.opts.formatSelection(s,r.find("div"),this.opts.escapeMarkup);if(t!=M){r.find("div").replaceWith("<div>"+t+"</div>")}w=this.opts.formatSelectionCssClass(s,r.find("div"));if(w!=M){r.addClass(w)}if(u){r.find(".select2-search-choice-close").on("mousedown",a).on("click dblclick",this.bind(function(x){if(!this.isInterfaceEnabled()){return }d(x.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(d(x.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();a(x)})).on("focus",this.bind(function(){if(!this.isInterfaceEnabled()){return }this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}r.data("select2-data",s);r.insertBefore(this.searchContainer);p.push(o);this.setVal(p)},unselect:function(q){var s=this.getVal(),r,p;q=q.closest(".select2-search-choice");if(q.length===0){throw"Invalid argument: "+q+". Must be .select2-search-choice"}r=q.data("select2-data");if(!r){return }while((p=Q(this.id(r),s))>=0){s.splice(p,1);this.setVal(s);if(this.select){this.postprocessResults()}}var o=d.Event("select2-removing");o.val=this.id(r);o.choice=r;this.opts.element.trigger(o);if(o.isDefaultPrevented()){return }q.remove();this.opts.element.trigger({type:"select2-removed",val:this.id(r),choice:r});this.triggerChange({removed:r})},postprocessResults:function(s,p,r){var t=this.getVal(),u=this.results.find(".select2-result"),q=this.results.find(".select2-result-with-children"),o=this;u.each2(function(w,v){var x=o.id(v.data("select2-data"));if(Q(x,t)>=0){v.addClass("select2-selected");v.find(".select2-result-selectable").addClass("select2-selected")}});q.each2(function(w,v){if(!v.is(".select2-result-selectable")&&v.find(".select2-result-selectable:not(.select2-selected)").length===0){v.addClass("select2-selected")}});if(this.highlight()==-1&&r!==false){o.highlight(0)}if(!this.opts.createSearchChoice&&!u.filter(".select2-result:not(.select2-selected)").length>0){if(!s||s&&!s.more&&this.results.find(".select2-no-results").length===0){if(Y(o.opts.formatNoMatches,"formatNoMatches")){this.results.append("<li class='select2-no-results'>"+o.opts.formatNoMatches(o.search.val())+"</li>")}}}},getMaxSearchWidth:function(){return this.selection.width()-H(this.search)},resizeSearch:function(){var t,r,q,o,p,s=H(this.search);t=N(this.search)+10;r=this.search.offset().left;q=this.selection.width();o=this.selection.offset().left;p=q-(r-o)-s;if(p<t){p=q-s}if(p<40){p=q-s}if(p<=0){p=t}this.search.width(Math.floor(p))},getVal:function(){var o;if(this.select){o=this.select.val();return o===null?[]:o}else{o=this.opts.element.val();return I(o,this.opts.separator)}},setVal:function(p){var o;if(this.select){this.select.val(p)}else{o=[];d(p).each(function(){if(Q(this,o)<0){o.push(this)}});this.opts.element.val(o.length===0?"":o.join(this.opts.separator))}},buildChangeDetails:function(o,r){var r=r.slice(0),o=o.slice(0);for(var q=0;q<r.length;q++){for(var p=0;p<o.length;p++){if(T(this.opts.id(r[q]),this.opts.id(o[p]))){r.splice(q,1);if(q>0){q--}o.splice(p,1);p--}}}return{added:r,removed:o}},val:function(r,p){var q,o=this;if(arguments.length===0){return this.getVal()}q=this.data();if(!q.length){q=[]}if(!r&&r!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(p){this.triggerChange({added:this.data(),removed:q})}return }this.setVal(r);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(p){this.triggerChange(this.buildChangeDetails(q,this.data()))}}else{if(this.opts.initSelection===M){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(t){var s=d.map(t,o.id);o.setVal(s);o.updateSelection(t);o.clearSearch();if(p){o.triggerChange(o.buildChangeDetails(q,o.data()))}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var p=[],o=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){p.push(o.opts.id(d(this).data("select2-data")))});this.setVal(p);this.triggerChange()},data:function(q,r){var p=this,s,o;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return d(this).data("select2-data")}).get()}else{o=this.data();if(!q){q=[]}s=d.map(q,function(t){return p.opts.id(t)});this.setVal(s);this.updateSelection(q);this.clearSearch();if(r){this.triggerChange(this.buildChangeDetails(o,this.data()))}}}});d.fn.select2=function(){var t=Array.prototype.slice.call(arguments,0),p,s,o,v,x,w=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],u=["opened","isFocused","container","dropdown"],q=["val","data"],r={search:"externalSearch"};this.each(function(){if(t.length===0||typeof (t[0])==="object"){p=t.length===0?{}:d.extend({},t[0]);p.element=d(this);if(p.element.get(0).tagName.toLowerCase()==="select"){x=p.element.prop("multiple")}else{x=p.multiple||false;if("tags" in p){p.multiple=x=true}}s=x?new C():new X();s.init(p)}else{if(typeof (t[0])==="string"){if(Q(t[0],w)<0){throw"Unknown method: "+t[0]}v=M;s=d(this).data("select2");if(s===M){return }o=t[0];if(o==="container"){v=s.container}else{if(o==="dropdown"){v=s.dropdown}else{if(r[o]){o=r[o]}v=s[o].apply(s,t.slice(1))}}if(Q(t[0],u)>=0||(Q(t[0],q)&&t.length==1)){return false}}else{throw"Invalid arguments to select2 plugin: "+t}}});return(v===M)?this:v};d.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(p,q,s,o){var r=[];U(p.text,s.term,r,o);return r.join("")},formatSelection:function(q,p,o){return q?o(q.text):M},sortResults:function(p,o,q){return p},formatResultCssClass:function(o){return M},formatSelectionCssClass:function(p,o){return M},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(o,p){var q=p-o.length;return"Please enter "+q+" more character"+(q==1?"":"s")},formatInputTooLong:function(p,o){var q=p.length-o;return"Please delete "+q+" character"+(q==1?"":"s")},formatSelectionTooBig:function(o){return"You can only select "+o+" item"+(o==1?"":"s")},formatLoadMore:function(o){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(o){return o.id},matcher:function(o,p){return E(""+p).toUpperCase().indexOf(E(""+o).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:G,escapeMarkup:g,blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(o){return o},adaptDropdownCssClass:function(o){return null},nextSearchTerm:function(o,p){return M}};d.fn.select2.ajaxDefaults={transport:d.ajax,params:{type:"GET",cache:false,dataType:"json"}};window.Select2={query:{ajax:e,local:h,tags:Z},util:{debounce:K,markMatch:U,escapeMarkup:g,stripDiacritics:E},"class":{"abstract":n,single:X,multi:C}}}(jQuery));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-select2', location = 'js/aui-select2.js' */
(function(C){var E=C.fn.select2;var D="aui-select2-container";var B="aui-select2-drop aui-dropdown2 aui-style-default";var A="aui-has-avatar";C.fn.auiSelect2=function(I){var H;if(C.isPlainObject(I)){var F=C.extend({},I);var G=F.hasAvatar?" "+A:"";F.containerCssClass=D+G+(F.containerCssClass?" "+F.containerCssClass:"");F.dropdownCssClass=B+G+(F.dropdownCssClass?" "+F.dropdownCssClass:"");H=Array.prototype.slice.call(arguments,1);H.unshift(F)}else{if(!arguments.length){H=[{containerCssClass:D,dropdownCssClass:B}]}else{H=arguments}}return E.apply(this,H)}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/jquery.auto-complete.js' */
/*
	jQuery autoComplete v1.0.7
    Copyright (c) 2014 Simon Steinberger / Pixabay
    GitHub: https://github.com/Pixabay/jQuery-autoComplete
	License: http://www.opensource.org/licenses/mit-license.php
*/

(function($){
    $.fn.confiFormsAutoComplete = function(options){
        var o = $.extend({}, $.fn.confiFormsAutoComplete.defaults, options);

        // public methods
        if (typeof options == 'string') {
            this.each(function(){
                var that = $(this);
                if (options == 'destroy') {
                    $(window).off('resize.autocomplete', that.updateSC);
                    that.off('blur.autocomplete focus.autocomplete keydown.autocomplete keyup.autocomplete');
                    if (that.data('autocomplete'))
                        that.attr('autocomplete', that.data('autocomplete'));
                    else
                        that.removeAttr('autocomplete');
                    $(that.data('sc')).remove();
                    that.removeData('sc').removeData('autocomplete');
                }
            });
            return this;
        }

        return this.each(function(){
            var that = $(this);
            // sc = 'suggestions container'
            that.sc = $('<div class="autocomplete-suggestions '+o.menuClass+'"></div>');
            that.data('sc', that.sc).data('autocomplete', that.attr('autocomplete'));
            that.attr('autocomplete', 'off');
            that.cache = {};
            that.last_val = '';

            that.updateSC = function(resize, next){
                that.sc.css({
                    top: that.offset().top + that.outerHeight(),
                    left: that.offset().left,
                    width: that.outerWidth()
                });
                if (!resize) {
                    that.sc.show();
                    if (!that.sc.maxHeight) that.sc.maxHeight = parseInt(that.sc.css('max-height'));
                    if (!that.sc.suggestionHeight) that.sc.suggestionHeight = $('.autocomplete-suggestion', that.sc).first().outerHeight();
                    if (that.sc.suggestionHeight)
                        if (!next) that.sc.scrollTop(0);
                        else {
                            var scrTop = that.sc.scrollTop(), selTop = next.offset().top - that.sc.offset().top;
                            if (selTop + that.sc.suggestionHeight - that.sc.maxHeight > 0)
                                that.sc.scrollTop(selTop + that.sc.suggestionHeight + scrTop - that.sc.maxHeight);
                            else if (selTop < 0)
                                that.sc.scrollTop(selTop + scrTop);
                        }
                }
            }
            $(window).on('resize.autocomplete', that.updateSC);

            that.sc.appendTo('body');

            that.sc.on('mouseleave', '.autocomplete-suggestion', function (){
                $('.autocomplete-suggestion.selected').removeClass('selected');
            });

            that.sc.on('mouseenter', '.autocomplete-suggestion', function (){
                $('.autocomplete-suggestion.selected').removeClass('selected');
                $(this).addClass('selected');
            });

            that.sc.on('mousedown', '.autocomplete-suggestion', function (e){
                var item = $(this), v = item.data('val');
                if (v || item.hasClass('autocomplete-suggestion')) { // else outside click
                    that.val(v);
                    o.onSelect(e, v, item);
                    that.sc.hide();
                }
                return false;
            });

            that.on('blur.autocomplete', function(){
                try { over_sb = $('.autocomplete-suggestions:hover').length; } catch(e){ over_sb = 0; } // IE7 fix :hover
                if (!over_sb) {
                    that.last_val = that.val();
                    that.sc.hide();
                    setTimeout(function(){ that.sc.hide(); }, 350); // hide suggestions on fast input
                } else if (!that.is(':focus')) setTimeout(function(){ that.focus(); }, 20);
            });

            if (!o.minChars) that.on('focus.autocomplete', function(){ that.last_val = '\n'; that.trigger('keyup.autocomplete'); });

            function suggest(data){
                var val = that.val();
                that.cache[val] = data;
                if (data.length && val.length >= o.minChars) {
                    var s = '';
                    for (var i=0;i<data.length;i++) s += o.renderItem(data[i], val);
                    that.sc.html(s);
                    that.updateSC(0);
                }
                else
                    that.sc.hide();
            }

            that.on('keydown.autocomplete', function(e){
                // down (40), up (38)
                if ((e.which == 40 || e.which == 38) && that.sc.html()) {
                    var next, sel = $('.autocomplete-suggestion.selected', that.sc);
                    if (!sel.length) {
                        next = (e.which == 40) ? $('.autocomplete-suggestion', that.sc).first() : $('.autocomplete-suggestion', that.sc).last();
                        that.val(next.addClass('selected').data('val'));
                    } else {
                        next = (e.which == 40) ? sel.next('.autocomplete-suggestion') : sel.prev('.autocomplete-suggestion');
                        if (next.length) { sel.removeClass('selected'); that.val(next.addClass('selected').data('val')); }
                        else { sel.removeClass('selected'); that.val(that.last_val); next = 0; }
                    }
                    that.updateSC(0, next);
                    return false;
                }
                // esc
                else if (e.which == 27) that.val(that.last_val).sc.hide();
                // enter or tab
                else if (e.which == 13 || e.which == 9) {
                    var sel = $('.autocomplete-suggestion.selected', that.sc);
                    if (sel.length && that.sc.is(':visible')) { o.onSelect(e, sel.data('val'), sel); setTimeout(function(){ that.sc.hide(); }, 20); }
                }
            });

            that.on('keyup.autocomplete', function(e){
                if (!~$.inArray(e.which, [13, 27, 35, 36, 37, 38, 39, 40])) {
                    var val = that.val();
                    if (val.length >= o.minChars) {
                        if (val != that.last_val) {
                            that.last_val = val;
                            clearTimeout(that.timer);
                            if (o.cache) {
                                if (val in that.cache) { suggest(that.cache[val]); return; }
                                // no requests if previous suggestions were empty
                                for (var i=1; i<val.length-o.minChars; i++) {
                                    var part = val.slice(0, val.length-i);
                                    if (part in that.cache && !that.cache[part].length) { suggest([]); return; }
                                }
                            }
                            that.timer = setTimeout(function(){ o.source(val, suggest) }, o.delay);
                        }
                    } else {
                        that.last_val = val;
                        that.sc.hide();
                    }
                }
            });
        });
    }

    $.fn.confiFormsAutoComplete.defaults = {
        source: 0,
        minChars: 3,
        delay: 150,
        cache: 1,
        menuClass: '',
        renderItem: function (item, search){
            // escape special characters
            search = search.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
            var re = new RegExp("(" + search.split(' ').join('|') + ")", "gi");
            return '<div class="autocomplete-suggestion" data-val="' + item + '">' + item.replace(re, "<b>$1</b>") + '</div>';
        },
        onSelect: function(e, term, item){}
    };
}(jQuery));

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/confiforms.js' */
function cfSerializeFormParams(obj) {
  if (window.FormData !== undefined) {
    var formData = new FormData();
    AJS.$.each(AJS.$(obj).find("input[type='file']"), function (i, tag) {
      AJS.$.each(AJS.$(tag)[0].files, function (i, file) {
        formData.append(tag.name, file);
      });
    });
    var params = AJS.$(obj).serializeArray();
    AJS.$.each(params, function (i, val) {
      formData.append(val.name, val.value);
    });
    return formData;
  }
}

function removeConfKeyBindings() {
 // this is needed as otherwise 'm' is treated as shortcut and wysiwyg does not accept m letter and other weird things...
  AJS.Confluence.KeyboardShortcuts.enabled = false;
  AJS.Confluence.KeyboardShortcuts.ready = false;
  AJS.trigger("remove-bindings.keyboardshortcuts");
  AJS.$(document).unbind('keydown keypress').unbind('keydown keypress keyup');

  AJS.$(document).ready(function() {
    AJS.Confluence.KeyboardShortcuts.enabled = false;
    AJS.Confluence.KeyboardShortcuts.ready = false;
    AJS.trigger("remove-bindings.keyboardshortcuts");
    AJS.$(document).unbind('keydown keypress').unbind('keydown keypress keyup');
  });
}

//function progressBar(formNameHash) {
//  return "<div id='"+formNameHash+"_div' style='text-align:center'><span class='aui-icon aui-icon-small aui-iconfont-configure'>...</span></div>"
//}

function remoteFilterRows(query, pageId, storagePageId, bodyHash, formNameHash, sourceType) {
  doFilterRows(query, '', pageId, storagePageId, bodyHash, formNameHash, sourceType, '#' + formNameHash + '_div');
}

function doFilterRows(query, additionalCondition, pageId, storagePageId, bodyHash, formNameHash, sourceType, elemSelectorToReplace) {
  AJS.$('#i_confiform_search_loading_btn_' + formNameHash).show();
  
  var freeTextSearch = true;
  if (elemSelectorToReplace == null) {
    freeTextSearch = false;
  }

  AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/table.action',
      data: ({pageId: pageId, storagePageId: storagePageId, bodyHash: bodyHash, cfFilter: query, additionalCondition:additionalCondition, sourceType: sourceType, freeTextSearch : freeTextSearch}),
      timeout: 60000, // 60 sec
      success: function (data) {
        AJS.$('#i_confiform_search_loading_btn_' + formNameHash).hide();

        if (elemSelectorToReplace == null) {
          elemSelectorToReplace = "div[data-macro-hash='" + bodyHash + "']";
        }

        if (AJS.$(elemSelectorToReplace).length > 0) {
          AJS.$(elemSelectorToReplace).replaceWith(data);
        } else {
          AJS.$('#i_confiform_search_loading_btn_' + formNameHash).after('<div style="color:red;margin-top: 20px">Could not find a ConfiForms view macro to apply the filter. Make sure you have <strong>ConfiForms ListView, CalendarView, PlainView, CleanView or TableView/CardView on the same page</strong> (showing the data from the same form); and for <strong>TableView/CardView/CleanView/PlainView you have enabled filter support</strong>.</div>');
        }
        // AJS.$('#i_confiform_search_'+formNameHash).focus();
      },
      error: function (jqXHR, textStatus, errorThrown) {
        AJS.$('#i_confiform_search_loading_btn_' + formNameHash).hide();
      }
    });
}

function navigatePager(pageId, storagePageId, bodyHash, cfId, formNameHash, sourceType) {
  AJS.$('#i_pager_ui_wait_' + formNameHash).show();

  var query = AJS.$('#i_confiform_search_' + formNameHash).val();

  AJS.$.ajax({
    url: AJS.params.contextPath + '/ajax/confiforms/table.action',
    data: ({pageId: pageId, storagePageId: storagePageId, cf_id: cfId, bodyHash: bodyHash, cfFilter: query, sourceType: sourceType, freeTextSearch: true}),
    timeout: 60000, // 60 sec
    success: function (data) {
      AJS.$('#'+formNameHash +'_div').replaceWith(data);
      AJS.$('#i_pager_ui_wait_' + formNameHash).hide();
    },
    error: function (jqXHR, textStatus, errorThrown) {
    }
  });
}

function entryDelete(entryId, pageId, storagePageId, formName) {
  if (confirm('Are you sure you want to delete this record? This action could not be undone.')) {
    AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/delete.action',
      data: ({pageId: pageId, storagePageId: storagePageId, entryId: entryId, registrationFormName: formName}),
      timeout: 60000, // 60 sec
      success: function (data) {
        var dataJSON = tryToParseResponseAsJSON(data);
        if (AJS.$.trim(dataJSON['status']) == 'DELETED') {
          if (AJS.$('#action-messages-confiforms')) {
            AJS.$('#action-messages-confiforms').remove();
          }

          AJS.$('.i_confiform_entry_' + entryId).fadeOut(1000, function () {
            AJS.$('.i_confiform_entry_' + entryId).remove();
          });
        }
        if (dataJSON['js'] != null && dataJSON['js'] != '') {
          eval(dataJSON['js']);
        }
      },
      error: function (jqXHR, textStatus, errorThrown) {
        alert('Could not delete this entry:' + textStatus + ' ' + errorThrown);
      }
    });
  }
}

function entrySaveFromTable(formName, entryId) {
  submitSaveEntryRequest(entryId, '#i_cf_inline_form_table_' + formName, 'table');
}

function entrySaveFromCard(formName, entryId) {
  submitSaveEntryRequest(entryId, '#i_cf_inline_form_table_' + formName, 'card');
}

function entrySave(entryId) {
  submitSaveEntryRequest(entryId, '#i_cf_inline_form_' + entryId, 'list');
}

function onRulesApplied(data, formName, excludeUserActionOnly, formId) {
  var json = tryToParseResponseAsJSON(data);
  for (var i = 0; i < json["actions"].length; i++) {
    var rule = json["actions"][i];
    var field = rule['field'];
    var act = rule['action'];
    var val = rule['value'];
    var complex = rule['complex'];
    var label = rule['label'];
    var select2 = rule['select2'];
    var handlerType = rule['handlerType'];

    if (excludeUserActionOnly && (rule['onUserActionOnly'] == true)) {
      // we need to exclude action/rules which are set to be invoked on user interaction only
    } else {
      try {
        var fieldSelector = '#i_' + field;
        if (complex) {
          fieldSelector = fieldSelector + '_Value';
        }

        if ('id' == field || 'entryId' == field) {
          fieldSelector = '#confiform_entry_id';
        }

        if ('Set value' == act || 'Set expression' == act || 'Lookup and set value' == act || 'Lookup and set DB value' == act || 'Lookup and set JIRA issue data' == act || 'Reset value' == act) {
          AJS.$(formName).find(fieldSelector).each(function () {
            resetIfCheckBoxOrRadio(AJS.$(this));
            processWithSetValue(AJS.$(this), val, true, select2, handlerType);
          });
          if (complex) {
            AJS.$(formName).find('#i_' + field + '_Label').each(function () {
              processWithSetLabel(AJS.$(this), label, true);
            });
          }
        }

        if ('Set value if empty' == act) {
          AJS.$(formName).find(fieldSelector).each(function () {
            resetIfCheckBoxOrRadio(AJS.$(this));
            processWithSetValue(AJS.$(this), val, false, select2, handlerType);
          });
          if (complex) {
            AJS.$(formName).find('#i_' + field + '_Label').each(function () {
              processWithSetLabel(AJS.$(this), label, false);
            });
          }
        }

        if ('Show field' == act) {
          if (val != null && val != '') {
            AJS.$(formName).find(fieldSelector).each(function () {
              processToggleValue(AJS.$(this), val, true, field, formName);
            });
          } else {
            AJS.$(formName).find('#i_' + field).show();
            AJS.$(formName).find('#i_labelfor_' + field).css('display', 'block');
            AJS.$(formName).find('.i_holdingrow_' + field).show();
            AJS.$(formName).find('#i_desc_' + field).show();
          }
        }

        if ('Hide field' == act) {
          if (val != null && val != '') {
            AJS.$(formName).find(fieldSelector).each(function () {
              processToggleValue(AJS.$(this), val, false, field, formName);
            });
          } else {
            AJS.$(formName).find('#i_' + field).hide();
            AJS.$(formName).find('#i_labelfor_' + field).hide();
            AJS.$(formName).find('.i_holdingrow_' + field).hide();
            AJS.$(formName).find('#i_desc_' + field).hide();
          }
        }

        if ('Apply Filter on a field' == act) {
          if (val != null) {
            AJS.$(formName).find('#i_holdingrow_' + field).replaceWith(val);
            eval("var formId='" + formId + "'; " + label); // javascript for a field
          }
        }

        if ('Run custom JavaScript' == act) {
          eval(val);
        }

        if ('Apply CSS on a field' == act) {
          if (val != null) {
            var cssStyles = val.split(";");
            for (var key = 0; key < cssStyles.length; key++) {
              var kv = cssStyles[key];
              if (kv != null) {
                var nameAndVal = kv.split(":");
                if (nameAndVal.length == 2) {
                  if ('class' == nameAndVal[0]) {
                    AJS.$(formName).find('#i_' + field).addClass(nameAndVal[1]);
                  } else {
                    AJS.$(formName).find('#i_' + field).css(nameAndVal[0], nameAndVal[1]);
                  }
                }
              }
            }
          }
        }
      } catch (e) {
        // no luck executing the rule...
      }
    }
  }
}

function processToggleValue(elem, val, show, field, formName) {
  if (elem.attr('type') == 'checkbox' || elem.attr('type') == 'radio') {
    if (elem.val() == val) {
      if (show) {
        elem.parent().show();
      } else {
        elem.parent().hide();
      }
    }
  } else if (elem.attr('type') == 'select') {
    elem.find('option').each(function (){
      if (AJS.$(this).val() == val) {
        if (show) {
          AJS.$(this).show();
        } else {
          AJS.$(this).hide();
        }
      }
    });
  } else {
    if (show) {
      AJS.$(formName).find('#i_' + field).show();
      AJS.$(formName).find('#i_labelfor_' + field).css('display', 'block');
      AJS.$(formName).find('.i_holdingrow_' + field).show();
      AJS.$(formName).find('#i_desc_' + field).show();
    } else {
      AJS.$(formName).find('#i_' + field).hide();
      AJS.$(formName).find('#i_labelfor_' + field).hide();
      AJS.$(formName).find('.i_holdingrow_' + field).hide();
      AJS.$(formName).find('#i_desc_' + field).hide();
    }
  }
}

function resetIfCheckBoxOrRadio(elem) {
  if (elem.attr('type') == 'checkbox' || elem.attr('type') == 'radio') {
      elem.removeAttr('checked');
  }
}

function tryProcessAsJSON(val) {
  try {
    return AJS.$.parseJSON(val);
  } catch (e) {
    return val;
  }
}
function processWithSetValue(elem, val, force, isSelect2, handlerType) {
  if (elem.attr('type') == 'checkbox' || elem.attr('type') == 'radio') {
    if (strStartsWith(val, '[')) {
      if (val != null && val != '') {
        val = val.replace(/'/g, '"');
        val = tryProcessAsJSON(val);
      }
    }

    if (AJS.$.isArray(val)) {
      for (var key = 0; key < val.length; key++) {
        if (elem.val() == val[key]) {
          var oldVal = elem.prop('checked');
          elem.prop('checked', true);
          if (!oldVal) {
            triggerUpdateEvent(elem, handlerType);
          }
        }
      }
    } else {
      if (elem.val() == val) {
        var oldVal = elem.prop('checked');
        elem.prop('checked', true);
        if (!oldVal) {
          triggerUpdateEvent(elem, handlerType);
        }
      }
    }
  } else {
    if (force || elem.val() == '') {
      if (isSelect2) {
        if (strStartsWith(val, '[')) {
          if (val != null && val != '') {
            val = val.replace(/'/g, '"');
            val = tryProcessAsJSON(val);
          }
        }
        if (val != null && !AJS.$.isArray(val)) {
          val = val.split(',');
        }
        if (val == null) {
          val = '';
        }
        var oldVal =  elem.select2("val");
        elem.select2("val", val);
        if (oldVal != val) {
          triggerUpdateEvent(elem, handlerType);
        }
      } else {
        var oldVal =  elem.val();
        if (strStartsWith(val, '[')) {
          if (val != null && val != '') {
            val = val.replace(/'/g, '"');
            val = tryProcessAsJSON(val);
          }
          for (var key = 0; key < val.length; key++) {
            elem.val(elem.val() + val[key]);
          }
        } else {
          elem.val(val);
        }
        if (oldVal != elem.val()) {
          triggerUpdateEvent(elem, handlerType);
        }
      }
    }
  }
}

function clearCanvasIfAsked(canvasValueHolderElement) {
  var el = AJS.$(canvasValueHolderElement);
  if (el != null) {
    var v = el.val();
    if (v == null || v == '') {
      var n = el.attr('id');
      var btn = AJS.$(el.parent()).find('#' + n + '_btn');
      if (btn != null) {
        btn.click();
        el.focus();
      }
    }
  }
}

function triggerUpdateEvent(elem, handlerType) {
  if (handlerType != null && handlerType != '') {
    AJS.$(elem).trigger(handlerType);
  }
}

function processWithSetLabel(elem, labelValue, force) {
  if (force || elem.val() == '') {
    elem.val(labelValue);
  }
}

function onEntrySaved(entryId, data, formName, sourceType) {
  if (sourceType != null) {
    if (sourceType == 'list') {
      AJS.$('div.i_confiform_entry_' + entryId).replaceWith(data);
    } else if (sourceType == 'card') {
      AJS.$(formName).find('tr.i_confiform_entry_' + entryId).each(function () {
        if (AJS.$(this).hasClass('cardItem')) {
          AJS.$(this).replaceWith(data);
        }
      });
    } else {
      AJS.$(formName).find('tr.i_confiform_entry_' + entryId).each(function () {
        if (AJS.$(this).hasClass('tableItem')) {
          AJS.$(this).replaceWith(data);
        }
      });
    }

    AJS.$(formName).find("button[id^='i_confiform_edit_button_']").each(function () {
      AJS.$(this).removeAttr('disabled');
    });

    try {
      AJS.$('.i_confiform_entry_' + entryId).effect("highlight", {}, 4000);
    } catch (e) {
      // is this correct?
    }
  }
}

function submitSaveEntryRequest(entryId, formName, sourceType) {
  AJS.$('.i_confiform_entry_' + entryId).each(function () {
    if (AJS.$(this).hasClass('error')) {
      AJS.$(this).remove();
    }
  });

  // IE8/9 case with file uploads
  if (window.FormData == undefined) {
    // we need to handle file uploads using iframe...
    handleFormSaveIE(formName, '/ajax/confiforms/save.action', function(data, formName) {onEntrySaved(entryId, data, formName, sourceType)});
  } else {
    AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/save.action',
      data: cfSerializeFormParams(formName),
      cache: false,
      processData: false,
      contentType: false,
      timeout: 180000, // 180 sec
      type: 'POST',
      success: function (data) {
        onEntrySaved(entryId, data, formName, sourceType);
      },
      error: function (jqXHR, textStatus, errorThrown) {
        alert('Could not save this entry:' + textStatus + ' ' + errorThrown);
      }
    });
  }
}

function submitSaveEntryRequestWithCallBackFunc(entryId, formName, sourceType, callbackFunc) {
  AJS.$('.i_confiform_entry_' + entryId).each(function () {
    if (AJS.$(this).hasClass('error')) {
      AJS.$(this).remove();
    }
  });

  // IE8/9 case with file uploads
  if (window.FormData == undefined) {
    // we need to handle file uploads using iframe...
    handleFormSaveIE(formName, '/ajax/confiforms/save.action', function(data, formName) {callbackFunc(entryId, data, formName, sourceType)});
  } else {
    AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/save.action',
      data: cfSerializeFormParams(formName),
      cache: false,
      processData: false,
      contentType: false,
      timeout: 180000, // 180 sec
      type: 'POST',
      success: function (data) {
        callbackFunc(entryId, data, formName, sourceType);
      },
      error: function (jqXHR, textStatus, errorThrown) {
        alert('Could not save this entry:' + textStatus + ' ' + errorThrown);
      }
    });
  }
}

function checkCondition(formName, hideForm, formId, fieldName) {
  if (hideForm) {
    AJS.$(formName).hide();
  }

  AJS.$('.i_cf_rules_loading').show();
  AJS.$('.save-cf-btn').prop('disabled', true);

  // IE8/9 case with file uploads
  if (window.FormData == undefined) {
    // we need to handle file uploads using iframe...
    handleFormSaveIE(formName, '/ajax/confiforms/applyrules.action?fld=' + fieldName, function(data, formName) {
      onRulesApplied(data, formName, hideForm, formId); // when hideForm is true then it is not a user interaction (we will exclude those rules)
      if (!AJS.$(formName).is(":visible")) {
        AJS.$(formName).show();
      }
      AJS.$('.i_cf_rules_loading').hide();
      AJS.$('.save-cf-btn').prop('disabled', false);
    });
  } else {
    AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/applyrules.action?fld=' + fieldName,
      data: cfSerializeFormParams(formName),
      cache: false,
      processData: false,
      contentType: false,
      timeout: 180000, // 180 sec
      type: 'POST',
      success: function (data) {
        onRulesApplied(data, formName, hideForm, formId); // when hideForm is true then it is not a user interaction (we will exclude those rules)
        if (!AJS.$(formName).is(":visible")) {
          AJS.$(formName).show();
        }
        AJS.$('.i_cf_rules_loading').hide();
        AJS.$('.save-cf-btn').prop('disabled', false);
      },
      error: function (jqXHR, textStatus, errorThrown) {
        if (!AJS.$(formName).is(":visible")) {
          AJS.$(formName).show();
        }
        AJS.$('.i_cf_rules_loading').hide();
        AJS.$('.save-cf-btn').prop('disabled', false);
      }
    });
  }
}

function cancelEdit(entryId, pageId, storagePageId, formName, hash, sourceType) {
  inlineEdit(entryId, pageId, storagePageId, formName, hash, false, sourceType, false);
}

function inlineEntryEdit(entryId, pageId, storagePageId, formName, hash, sourceType, resetId) {
  inlineEdit(entryId, pageId, storagePageId, formName, hash, true, sourceType, resetId);
}

function inlineEdit(entryId, pageId, storagePageId, formName, hash, mode, sourceType, resetId) {
  AJS.$.ajax({
    url: AJS.params.contextPath + '/ajax/confiforms/inline.action',
    timeout: 90000, // 90 sec
    data: ({pageId: pageId, storagePageId: storagePageId, entryId: entryId, registrationFormName: formName, hash: hash, edit: mode, sourceType: sourceType, resetId:resetId}),
    success: function (data) {
      if (resetId) {
        if (sourceType == 'table' || sourceType == 'card' || sourceType == 'grid') {
          AJS.$('#' + hash + '_table tr:last').after(data);
        } else {
          AJS.$('#'+hash+'_div').append(data);
        }
        //inlineEdit(entryId, pageId, storagePageId, formName, hash, false, sourceType, false);
      } else {
        tryToUpdateTheRow(sourceType, pageId, storagePageId, formName, entryId, hash, data);
        tryToUpdateTheRow(sourceType, pageId, storagePageId, formName, '', hash, data); // if there is a copy function used then it might be that the row is without an id
      }

      if (resetId) {
        entryId = '';
      }

      if (sourceType == 'table' || sourceType == 'card' || sourceType == 'grid') { // if table
        var selector = "table[id='" + hash + "_table']";
        // disable others
        AJS.$(selector).find("button[id^='i_confiform_edit_button_']").each(function () {
          if (mode) {
            if (AJS.$(this).attr('id') != ('i_confiform_edit_button_' + entryId)) {
              AJS.$(this).attr('disabled', 'disabled');
            }
          } else {
            AJS.$(this).removeAttr('disabled');
          }
        });
      }
    },
    error: function (jqXHR, textStatus, errorThrown) {
      alert('Failed to complete the request:' + textStatus + ' ' + errorThrown);
    }
  });
}

function tryToUpdateTheRow(sourceType, pageId, storagePageId, formName, entryId, hash, data) {
  console.log('Trying to update the row for ' + sourceType + ' using hash = ' + hash + ' and entryId = ' + entryId);

  if (sourceType == 'table' || sourceType == 'grid') {
    AJS.$('#'+hash+'_table').find('tr.i_confiform_entry_' + entryId).each(function () {
      if (AJS.$(this).hasClass('tableItem')) {
        AJS.$(this).replaceWith(data);
      }
    });
  } else if (sourceType == 'card') {
    AJS.$('#'+hash+'_table').find('tr.i_confiform_entry_' + entryId).each(function () {
      if (AJS.$(this).hasClass('cardItem')) {
        AJS.$(this).replaceWith(data);
      }
    });
  } else {
    AJS.$('#'+hash+'_div').find('div.i_confiform_entry_' + entryId).replaceWith(data);
  }

  // add events handlers back
  if (sourceType == 'table' || sourceType == 'grid') {
    AJS.$('#'+hash+'_table').find('tr.i_confiform_entry_' + entryId).each(function () {
      if (AJS.$(this).hasClass('tableItem')) {
        cfBindActionButtonClickEvents(AJS.$(this), entryId, pageId, storagePageId, formName, hash, sourceType);
      }
    });
  } else if (sourceType == 'card') {
    AJS.$('#'+hash+'_table').find('tr.i_confiform_entry_' + entryId).each(function () {
      if (AJS.$(this).hasClass('cardItem')) {
        cfBindActionButtonClickEvents(AJS.$(this), entryId, pageId, storagePageId, formName, hash, sourceType);
      }
    });
  } else {
    AJS.$('#'+hash+'_div').find('div.i_confiform_entry_' + entryId).each(function () {
      cfBindActionButtonClickEvents(AJS.$(this), entryId, pageId, storagePageId, formName, hash, sourceType);
    });
  }
}

function showAdminUI(formHash, url, params) {
  AJS.$('#i_admin_ui_wait_' + formHash).show();
  AJS.$.ajax({
    url: url,
    data: params,
    timeout: 600000, // 600 sec
    success: function (data) {
      AJS.$('#i_admin_ui_wait_' + formHash).hide();
      AJS.$('#i_confiform_admin_ui_table_' + formHash).html(data);
    },
    error: function (jqXHR, textStatus, errorThrown) {
      var errorPane = "<div class='aui-message error' id='action-errors-confiform' style='margin-top: 10px;padding-bottom: 10px'><ul>";
      errorPane = errorPane + "<li>Error communicating with server. " + ' ' + errorThrown + " (" + textStatus + ")" + "</li>";
      errorPane = errorPane + "</ul></div>";
      AJS.$('#i_admin_ui_wait_' + formHash).hide();
      AJS.$('#i_confiform_admin_ui_table_' + formHash).html(errorPane);
    }
  });
}

function showAdminTable(pageId, formName, formHash, withAudit) {
  showAdminUI(formHash, AJS.params.contextPath + '/ajax/confiforms/admin.action', ({pageId: pageId, registrationFormName: formName, withAudit: withAudit}));
}

function showFormWizard(pageId, formName, formHash) {
  showAdminUI(formHash, AJS.params.contextPath + '/ajax/confiforms/wizard.action', ({pageId: pageId, registrationFormName: formName}));
}

function showImportUI(pageId, formName, formHash) {
  showAdminUI(formHash, AJS.params.contextPath + '/ajax/confiforms/import.action', ({pageId: pageId, formName: formName}));
}

function showCleanupUI(pageId, formName, formHash) {
  showAdminUI(formHash, AJS.params.contextPath + '/ajax/confiforms/cleanup.action', ({pageId: pageId, formName: formName}));
}

function showRecoveryUI(pageId, formName, formHash) {
  showAdminUI(formHash, AJS.params.contextPath + '/ajax/confiforms/recovery.action', ({pageId: pageId, formName: formName}));
}

function showChangeLog(pageId, formName, formHash, setId) {
  if (setId != '') {
    AJS.$('#i_changelog_wait_' + formHash).show();

    AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/changeset.action',
      data: ({pageId: pageId, registrationFormName: formName, setId: setId}),
      timeout: 600000, // 600 sec
      success: function (data) {
        AJS.$('#i_changelog_wait_' + formHash).hide();
        AJS.$('#i_confiform_changelog_table_' + formHash).html(data);
      },
      error: function (jqXHR, textStatus, errorThrown) {
        var errorPane = "<div class='aui-message error' id='action-errors-confiform' style='margin-top: 10px;padding-bottom: 10px'><ul>";
        errorPane = errorPane + "<li>Error communicating with server. " + ' ' + errorThrown + " (" + textStatus + ")" + "</li>";
        errorPane = errorPane + "</ul></div>";
        AJS.$('#i_changelog_wait_' + formHash).hide();
        AJS.$('#i_confiform_changelog_table_' + formHash).html(errorPane);
      }
    });
  }
}

function setCFUserAutocomplete(element, onItemSelected) {
  if (element != null) {
    var xhr;

    element.blur(function () {
      if (AJS.$(this).val() == '' && onItemSelected != null) {
        onItemSelected('');
      }
    });
    element.keyup(function () {
      if (AJS.$(this).val() == '' && onItemSelected != null) {
        onItemSelected('');
      }
    });

    element.confiFormsAutoComplete({
      minChars: 2,
      cache: false,
      onSelect: function(e, v, item){
        var username = item.attr('data-internal');
        if (username == null) {
          username = '';
        }
        onItemSelected(username.trim());
        try {
          e.preventDefault();
        } catch (e) {
        }
        return false;
      },
      renderItem: function (item, search){
          //search = search.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
          //var re = new RegExp("(" + search.split(' ').join('|') + ")", "gi");
        return "<a class='autocomplete-suggestion text' title='"+item.id+"' style='display: block;' data-internal='"+item.id+"' data-val='"+item.label+"'><img data-internal='"+item.id+"' data-val='"+item.label+"' src='"
          + item.avatar + "' style='margin-top:3px; display: inline;height: 20px;max-height: 20px'/><span data-internal='"+item.id+"' data-val='"+item.label+"' style='display: inline;padding-left: 5px;font-size: inherit; padding-right: 0; cursor: pointer'>" + item.label + "</span></a>";
      },
      source: function (term, response) {
        try {
          xhr.abort();
        } catch (e) {
        }
        xhr = AJS.$.getJSON(AJS.params.contextPath + "/rest/prototype/1/search/user.json?max-results=15", {query: ""+ term}, function (data) {
          var r = new Array();
          var jsonResult = data.result;

          for (var key = 0; key < jsonResult.length; key++) {
            r[key] = {
              "id": jsonResult[key].username,
              "label": substrUser(jsonResult[key].title + ' (' + jsonResult[key].username + ')'),
              "value": jsonResult[key].title,
              "avatar": jsonResult[key].thumbnailLink.href
            };
          }
          response(r);
        });
      }
    });
  }
}

function setCFValueAutocomplete(element, availableValuesJSONElement, onItemSelected) {
  var availableValues = AJS.$.parseJSON(availableValuesJSONElement.html());

  var choices = new Array();
  for (var key = 0; key < availableValues.length; key++) {
    choices[key] = availableValues[key].name;
  }

  if (element != null) {
    element.blur(function () {
      if (AJS.$(this).val() == '' && onItemSelected != null) {
        onItemSelected('');
      }
    });
    element.keyup(function () {
      if (AJS.$(this).val() == '' && onItemSelected != null) {
        onItemSelected('');
      }
    });

    element.confiFormsAutoComplete({
      source: function (term, suggest) {
        term = term.toLowerCase();
        var matches = [];
        for (i = 0; i < choices.length; i++)
          if (~choices[i].toLowerCase().indexOf(term)) matches.push(choices[i]);
        suggest(matches);
      },
      minChars: 1,
      cache:false,
      renderItem: function (item, search) {
        return '<div style="display: block;" class="autocomplete-suggestion text" data-val="' + item + '">' + item + '</div>';

      },
      onSelect: function (e, v, item) {
        try {
          e.preventDefault();
        } catch (e) {
        }
        return false;
      }
    });
  }
}

function setCFPagesAutoComplete(element, onItemSelected) {
  if (element != null) {
    element.blur(function () {
      if (AJS.$(this).val() == '' && onItemSelected != null) {
        onItemSelected('');
      }
    });
    element.keyup(function () {
      if (AJS.$(this).val() == '' && onItemSelected != null) {
        onItemSelected('');
      }
    });

    var xhr;

    element.confiFormsAutoComplete({
      minChars: 2,
      cache: false,
      onSelect: function(e, v, item){
        onItemSelected(item.data('internal'));
        try {
          e.preventDefault();
        } catch (e) {
        }
        return false;
      },
      renderItem: function (item, search){
          //search = search.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
          //var re = new RegExp("(" + search.split(' ').join('|') + ")", "gi");
        return "<a class='autocomplete-suggestion text' style='display: block;' data-internal='"+item.id+"' title='"+encodeHTML(item.label)+"' data-val='"+encodeHTML(item.label)+"'>"
        + "<span data-internal='"+item.id+ "' data-val='"+encodeHTML(item.label)+"' style='padding-left: 10px;font-size: inherit;padding-right: 0; cursor: pointer'>" + encodeHTML(item.label) + "</span>" +"</a>";
      },
      source: function (term, response) {
        try {
          xhr.abort();
        } catch (e) {
        }

        xhr = AJS.$.getJSON(AJS.params.contextPath + "/rest/prototype/1/search/name.json?max-results=10&pageSize=10&type=page%2Cblogpost", {query: "" + term}, function (rawData) {
          var data = AJS.$.parseJSON(JSON.stringify(rawData));
          var r = new Array();
          if (data.group && data.group.length > 0) {
            var jsonResult = data.group[0].result;
            for (var key=0;key<jsonResult.length;key++){
              r[key] = { "id": jsonResult[key].id,
                "label": jsonResult[key].space.key + ':' + jsonResult[key].title
              };
            }
          }
          response(r);
        });
      }
    });
  }
}

function substrUser(s) {
  var maxLength = 30;
  return s.length > maxLength ? s.substring(0, maxLength) + '...' : s;
}

function printEntry(formName) {
    // IE8/9 case with file uploads
  if (window.FormData == undefined) {
    // we need to handle file uploads using iframe...
    handleFormSaveIE(formName, '/ajax/confiforms/print.action', function(result, formName){
      AJS.$('<div>'+result+'</div>').printElement();
    });
  } else {
    AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/print.action',
      data: cfSerializeFormParams(formName),
      cache: false,
      processData: false,
      contentType: false,
      timeout: 180000, // 180 sec
      type: 'POST',
      success: function (result) {
        AJS.$('<div>'+result+'</div>').printElement();
      },
      error: function (jqXHR, textStatus, errorThrown) {
        alert('Error getting printed form: ' + textStatus + ' details = ' + errorThrown);
      }
    });
  }
}

//function submitValidateEntryRequest(formName) {
//  handleFormSaveIE(formName, '/ajax/confiforms/trysave.action', function(validationResult, formName) {onSubmitResult(validationResult, formName)});
//}

function onSubmitResult(validationResult, formName, btn, errorHandler) {
  if (validationResult["errors"].length == 0) {
    AJS.$(formName).submit();
  } else {
    if (btn != null) {
      //btn.css('color', '#FFFFFF');
      btn.removeAttr('disabled');
    }
    AJS.$('.i_cf_rules_loading').hide();

    AJS.$('.action-errors-confiform_pane').remove();

    var errorPane = "<div class='aui-message error action-errors-confiform_pane' id='action-errors-confiform' style='margin-top: 10px;padding-bottom: 10px'><ul>";
    for (var i = 0; i < validationResult["errors"].length; i++) {
      errorPane = errorPane + "<li>" + validationResult["errors"][i] + "</li>";
    }
    errorPane = errorPane + "</ul></div>";
    AJS.$(errorPane).insertBefore(AJS.$(formName));
    if (errorHandler!= null) {
      errorHandler(errorPane);
    }
    if (validationResult["fields"] != null) {
      for (var i = 0; i < validationResult["fields"].length; i++) {
        AJS.$(formName).find('#i_' + validationResult["fields"][i]).css('border-color', '');
        AJS.$(formName).find('#i_' + validationResult["fields"][i]).removeClass('cf_validation_error');
      }
    }
    if (validationResult["fieldsWithError"] != null) {
      for (var i = 0; i < validationResult["fieldsWithError"].length; i++) {
        AJS.$(formName).find('#i_' + validationResult["fieldsWithError"][i]).css('border-color', 'red');
        AJS.$(formName).find('#i_' + validationResult["fieldsWithError"][i]).addClass('cf_validation_error');
      }
    }
    AJS.$('.dialog-panel-body').scrollTop(0);
    window.scroll(0, AJS.$('.action-errors-confiform_pane').offset().top);
  }
}

function getSearchQuery(form) {
  return AJS.$(form).serialize();
}

function submitValidateEntryRequest(btn, formName, errorHandler) {
  if (btn == null) {
    btn = AJS.$('.my-create-dialog-create-button');
  }
  AJS.$('.i_cf_rules_loading').show();
  if (btn != null) {
    //btn.css('color', '#c0c0c0');
    btn.attr('disabled', 'disabled');
  }
  // IE8/9 case with file uploads
  if (window.FormData == undefined) {
    // we need to handle file uploads using iframe...
    handleFormSaveIE(formName, '/ajax/confiforms/trysave.action', function(validationResult, formName){
      onSubmitResult(tryToParseResponseAsJSON(validationResult), formName, btn, errorHandler);
    });
  } else {
    AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/trysave.action',
      data: cfSerializeFormParams(formName),
      cache: false,
      processData: false,
      contentType: false,
      timeout: 180000, // 90 sec
      type: 'POST',
      success: function (validationResult) {
        onSubmitResult(tryToParseResponseAsJSON(validationResult), formName, btn, errorHandler);
      },
      error: function (jqXHR, textStatus, errorThrown) {
        AJS.$('.action-errors-confiform_pane').remove();
        AJS.$('.i_cf_rules_loading').hide();

        var errorPane = "<div class='aui-message error action-errors-confiform_pane' id='action-errors-confiform' style='margin-top: 10px;padding-bottom: 10px'><ul>";
        errorPane = errorPane + "<li>Operation has failed. Error communicating with the server. " + ' ' + errorThrown + " (" + textStatus + ")" + "</li>";
        errorPane = errorPane + "</ul></div>";
        AJS.$(errorPane).insertBefore(AJS.$(formName));

        if (btn != null) {
          //btn.css('color', '#000000');
          btn.removeAttr('disabled');
        }
        if (errorHandler!= null) {
          errorHandler(errorPane);
        }
        AJS.$('.dialog-panel-body').scrollTop(0);
        window.scroll(0, AJS.$('.action-errors-confiform_pane').offset().top);
      }
    });
  }
}

function strStartsWith(str, prefix) {
  return str != null && str.indexOf(prefix) === 0;
}

function strEndsWith(str, suffix) {
  return str != null && str.match(suffix+"$")==suffix;
}

function tryToParseResponseAsJSON(validationResult){
  try {
    var res = AJS.$.parseJSON(validationResult);
    if (typeof res == 'object') {
      return res;
    }
  } catch (e) {
    // silence, will go for string replacement
  }

  if (strStartsWith(validationResult, '<PRE>') && strEndsWith(validationResult, "</PRE>")) {
    validationResult = validationResult.substring(5, validationResult.length - 6);
  }
  if (strStartsWith(validationResult, '<pre>') && strEndsWith(validationResult, "</pre>")) {
    validationResult = validationResult.substring(5, validationResult.length - 6);
  }

  return AJS.$.parseJSON(validationResult);
}

function handleFormSaveIE(formName, url, okHandlerFunc) {
  var form = AJS.$(formName);
  // Create the iframe...
  var iframe = document.createElement("iframe");
  iframe.setAttribute("id", "cf_upload_iframe");
  iframe.setAttribute("name", "cf_upload_iframe");
  iframe.setAttribute("width", "0");
  iframe.setAttribute("height", "0");
  iframe.setAttribute("border", "0");
  iframe.setAttribute("style", "border: none;display: none;");
  iframe.setAttribute("src","javascript:false;");

  // Add to document...
  form.append(iframe);
  window.frames['cf_upload_iframe'].name = "cf_upload_iframe";

  var iframeId = document.getElementById("cf_upload_iframe");

  var originalurl = form.attr("action");
  var originaltarget = form.attr("target");

  // Add event...
  var eventHandler = function () {
    if (iframeId.detachEvent) iframeId.detachEvent("onload", eventHandler);
    else iframeId.removeEventListener("load", eventHandler, false);

    var content = '';
    // Message from server...
    if (iframeId) {
      if (iframeId.contentDocument) {
        content = iframeId.contentDocument.body.innerHTML;
      } else if (iframeId.contentWindow) {
        content = iframeId.contentWindow.document.body.innerHTML;
      } else if (iframeId.document && iframeId.document.body) {
        content = iframeId.document.body.innerHTML;
      }
    }

    form.attr("target", originaltarget);
    form.attr("action", originalurl);

    var element = document.getElementById("cf_upload_iframe");
    if (element && element.parentNode) {
      element.parentNode.removeChild(element);
    }

    //getting the response from server
    okHandlerFunc(content, formName);
  };

  if (iframeId.addEventListener) iframeId.addEventListener("load", eventHandler, true);
  if (iframeId.attachEvent) iframeId.attachEvent("onload", eventHandler);

  // Set properties of form...
  form.attr("target", "cf_upload_iframe");
  form.attr("action", AJS.params.contextPath + url);
  form.attr("method", "post");
  form.attr("enctype", "multipart/form-data");
  form.attr("encoding", "multipart/form-data");

  // remove onsubmit handler, otherwhise goes to infinite loop
  AJS.$(formName).unbind('submit');

  form.submit();// Submit the form...
}

function setInternalDate(el, fldName, pfx) {
  var d = AJS.$(el.form).find('#i_sel_' + fldName + '_day_' + pfx).val();
  var m = AJS.$(el.form).find('#i_sel_' + fldName + '_month_' + pfx).val();
  var y = AJS.$(el.form).find('#i_sel_' + fldName + '_year_' + pfx).val();

  AJS.$(el.form).find('#i_' + fldName + '_' + pfx).val(d +'.' + m + '.' + y);
}

function quickEnroll(pageId, entryId, fieldName, formName, storagePageId, el, formNameHash, entryPaneType) {
  AJS.$(el).attr('disabled','disabled');
  AJS.$.ajax({
    url: AJS.params.contextPath + '/ajax/confiforms/enroll.action',
    data: ({pageId: pageId, storagePageId: storagePageId, entryId: entryId, registrationFormName: formName, fieldName: fieldName}),
    timeout: 180000, // 180 sec
    success: function (data) {
      tryToUpdateTheRow(entryPaneType, pageId, storagePageId, formName, entryId, formNameHash, data);
    },
    error: function (jqXHR, textStatus, errorThrown) {
      alert('Could not compete quick enroll, due to technical reasons:' + textStatus + ' ' + errorThrown);
    }
  });
}

function cfUnbindActionClickEvents(elem) {
  AJS.$(elem).find('.confiforms-quick-enroll').unbind('click');
  AJS.$(elem).find('.confiforms-quick-comment').unbind('click');
  AJS.$(elem).find('.confiforms-quick-vote').unbind('click');
  AJS.$(elem).find('.confiforms-cancel-vote').unbind('click');
  AJS.$(elem).find('.confiforms-action-button').unbind('click');
}

function cfBindActionButtonClickEvents(entryPane, entryId, actionPageId, storagePageId, registrationFormName, formNameHash, entryPaneType) {
  cfUnbindActionClickEvents(entryPane);

  AJS.$(entryPane).find('.confiforms-quick-enroll').click(function(){
    var fieldName = AJS.$(this).attr('name');
    quickEnroll(actionPageId, entryId, fieldName, registrationFormName, storagePageId, AJS.$(this), formNameHash, entryPaneType);
  });
  AJS.$(entryPane).find('.confiforms-quick-comment').click(function(){
    var fieldName = AJS.$(this).attr('name');
    quickComment(actionPageId, entryId, fieldName, registrationFormName, storagePageId, AJS.$(this));
  });
  AJS.$(entryPane).find('.confiforms-quick-vote').click(function(){
    var fieldName = AJS.$(this).attr('name');
    quickVote(actionPageId, entryId, fieldName, registrationFormName, storagePageId, entryPane, AJS.$(this), true);
  });
  AJS.$(entryPane).find('.confiforms-cancel-vote').click(function(){
    var fieldName = AJS.$(this).attr('name');
    quickVote(actionPageId, entryId, fieldName, registrationFormName, storagePageId, entryPane, AJS.$(this), false);
  });
  AJS.$(entryPane).find('.confiforms-action-button').click(function(){
    var fieldName = AJS.$(this).attr('name');
    quickUpdate(actionPageId, entryId, fieldName, registrationFormName, storagePageId, AJS.$(this), formNameHash, entryPaneType);
  });
}

function cfBindActionButtonEvents(entryPane, actionPageId, storagePageId, registrationFormName, formNameHash, entryPaneType) {
  var entryId = AJS.$(entryPane).attr('confi-data-id');
  cfBindActionButtonClickEvents(entryPane, entryId, actionPageId, storagePageId, registrationFormName, formNameHash, entryPaneType);
}

function quickComment(pageId, entryId, fieldName, formName, storagePageId, el) {
  // AJS.$(el).attr('disabled','disabled');
  var fieldValue = AJS.$(el).parent().find('#i_' + fieldName).val();
  if (fieldValue != null && fieldValue != '') {
    AJS.$.ajax({
      url: AJS.params.contextPath + '/ajax/confiforms/comment.action',
      data: ({
        pageId: pageId,
        storagePageId: storagePageId,
        entryId: entryId,
        registrationFormName: formName,
        fieldName: fieldName,
        fieldValue: fieldValue
      }),
      timeout: 180000, // 180 sec
      success: function (data) {
        var paneToReplace = AJS.$(el).parent().parent().parent();
        paneToReplace.find('#comments_list').replaceWith(AJS.$(data).find('#comments_list'));
        AJS.$(el).parent().find('#i_' + fieldName).val('');
        AJS.$(el).parent().find('#i_' + fieldName).focus();
      },
      error: function (jqXHR, textStatus, errorThrown) {
        alert('Could not compete quick comment action, due to technical reasons:' + textStatus + ' ' + errorThrown);
      }
    });
  }
}

function quickUpdate(pageId, entryId, fieldName, formName, storagePageId, el, paramsHash, sourceType) {
  AJS.$(el).attr('disabled','disabled');
  var actionValues = AJS.$(el).attr('data-action-values');

  AJS.$.ajax({
    url: AJS.params.contextPath + '/ajax/confiforms/quickaction.action',
    data: ({pageId: pageId, storagePageId: storagePageId, entryId: entryId, registrationFormName: formName, fieldName: fieldName, actionValues: actionValues}),
    timeout: 180000, // 180 sec
    success: function (data) {
      cancelEdit(entryId, pageId, storagePageId, formName, paramsHash, sourceType);
    },
    error: function (jqXHR, textStatus, errorThrown) {
      alert('Could not compete quick enroll, due to technical reasons:' + textStatus + ' ' + errorThrown);
    }
  });
}

function toggleInlineCommentBox(elem) {
  AJS.$(elem).parent().find('#inlineCommentPane').show();
  AJS.$(elem).hide();
  AJS.$(elem).parent().find('#inlineCommentPane').find('textarea').focus();
}

function quickVote(pageId, entryId, fieldName, formName, storagePageId, entryPane, btn, voteOrRemove) {
  AJS.$(btn).hide();
  AJS.$.ajax({
    url: AJS.params.contextPath + '/ajax/confiforms/vote.action',
    data: ({pageId: pageId, storagePageId: storagePageId, entryId: entryId, registrationFormName: formName, fieldName: fieldName, voteOrRemove: voteOrRemove}),
    timeout: 180000, // 180 sec
    success: function (data) {
      AJS.$(entryPane).find('#i_votesCountHolder_' + fieldName).replaceWith(data);
    },
    error: function (jqXHR, textStatus, errorThrown) {
      alert('Could not complete the quick vote, due to technical reasons:' + textStatus + ' ' + errorThrown);
    }
  });
}

function deleteAttachment(pageId, entryId, fieldName, formName, storagePageId, btn) {
  if (confirm('Are you sure you want to delete this attachment? This action could not be undone.')) {
      var attachmentId = AJS.$(btn).attr('data-rel');
      AJS.$.ajax({
        url: AJS.params.contextPath + '/ajax/confiforms/deleteattachment.action',
        data: ({pageId: pageId, storagePageId: storagePageId, entryId: entryId, registrationFormName: formName, fieldName: fieldName, attachmentId: attachmentId}),
        timeout: 180000, // 180 sec
        success: function (data) {
          if (AJS.$.trim(data) == 'DELETED') {
              AJS.$(btn.parent()).remove();
          } else {
            alert('Could not delete this attachment:' + data);
          }
        },
        error: function (jqXHR, textStatus, errorThrown) {
          alert('Could not delete this attachment:' + textStatus + ' ' + errorThrown);
        }
      });
    }
}

function prepareMultiSelect(elem){
  AJS.$(elem).show();
  AJS.$(elem).auiSelect2({placeholder: ' ', allowClear: true, width: 'resolve'});
}

function asCssStyles(css) {
  var kv = css.split(';');
}
function prepareAdvancedSelect(elem, css){
  AJS.$(elem).show();
  if (css != null && css != '') {
    var cssStyles = AJS.$.parseJSON(css);
    AJS.$(elem).auiSelect2({placeholder: ' ', allowClear: true, dropdownCss: cssStyles, containerCss: cssStyles});
  } else {
    AJS.$(elem).auiSelect2({placeholder: ' ', allowClear: true});
  }
}

function prepareMultiSelectWithTags(elem, availableValuesJSONElement){
  var tags = availableValuesJSONElement.html();

  var tagsJSON = AJS.$.parseJSON(tags);
  var tagsArray = [];

  for (var key=0;key<tagsJSON.length;key++){
    tagsArray[key] = tagsJSON[key]["name"];
  }

  AJS.$(elem).show();
  AJS.$(elem).auiSelect2({tags: tagsArray, tokenSeparators: [","], multiple: true, width: 'resolve'});
}

function prepareMultiuser(userElems, multi){
  AJS.$(userElems).each(function() {
    var elem = AJS.$(this);

    AJS.$(elem).show();

    AJS.$(elem).auiSelect2({
        hasAvatar: true, // auiSelect2 speciffic option, adds styling needed to properly display avatars
        multiple: multi, // make the control a multi-select
        minimumInputLength: 2,
        initSelection: function (element, callback) {
          var v = AJS.$(element).val();
          var names = v.split(',');

          var usernames = [];
          for (var key = 0; key < names.length; key++) {
            usernames.push({username: names[key], title : '', thumbnailLink: {href:''}});
          }
          callback(usernames);
        },
        ajax: {
            url: AJS.params.contextPath + "/rest/prototype/1/search/user.json",
            type: "GET",
            dataType: 'json',
            cache: false,
            // query parameters for the remote ajax call
            data: function data(term) {
                return {
                    query: term,
                    maxResults: 15,
                    showAvatar: true
                };
            },
            // parse data from the server into form select2 expects
            results: function results(data) {
              var d = AJS.$.parseJSON(JSON.stringify(data));
                return {
                    results: d.result
                };
            }
        },
        // specify id parameter of each user entity
        id: function id(user) {
            return user.username;
        },
        // define how selected element should look like
        formatSelection: function formatSelection(user) {
            var avatarHtml = aui.avatar.avatar({
                size: 'xxsmall',
                avatarImageUrl: user.thumbnailLink.href
            });
            var resultText = user.username;
            if (user.title != null && user.title != '') {
              resultText = user.title + " - (" + user.username + ")";
            }
            return avatarHtml + myDefaultEscapeMarkup(resultText);
        },
        // define how single option should look like
        formatResult: function formatResult(user, container, query, escapeMarkup) {
            // format result string
            var resultText = user.username;
            if (user.title != null && user.title != '') {
              resultText = user.title + " - (" + user.username + ")";
            }
            var avatarHtml = aui.avatar.avatar({
                size: 'small',
                avatarImageUrl: user.thumbnailLink.href
            });
            var higlightedMatch = [];
            // we need this to disable html escaping by select2 as we are doing it on our own
            var noopEscapeMarkup = function noopEscapeMarkup(s) { return s; }
            // highlight matches of the query term using matcher provided by the select2 library
            if (escapeMarkup) {
              Select2.util.markMatch(escapeMarkup(resultText), escapeMarkup(query.term), higlightedMatch, noopEscapeMarkup);
            } else {
              Select2.util.markMatch(myDefaultEscapeMarkup(resultText), myDefaultEscapeMarkup(query.term), higlightedMatch, noopEscapeMarkup);
            }
            // convert array to string
            higlightedMatch = higlightedMatch.join("");
            return avatarHtml + higlightedMatch;
        },
        // define message showed when there are no matches
        formatNoMatches: function formatNoMatches(query) {
            return "No matches found";
        }
    });

    var exdata = AJS.$(elem).attr('existing-data');
    if (exdata != null && exdata != '') {
      AJS.$(elem).select2('data', AJS.$.parseJSON(exdata));
    }
  });
}

function setClassifierValue(formFieldName, classifierName, htmlDropdownForm){
  var dropdownForm = AJS.$(htmlDropdownForm);
  resetClassifierInfo(dropdownForm, formFieldName);

  var thisClassifiedDropDown = dropdownForm.find('#i_' + formFieldName + '_' + classifierName);

  var classifierJSON = AJS.$.parseJSON(thisClassifiedDropDown.attr('data-classifiers'));
  var dataSet = AJS.$.parseJSON(dropdownForm.find('#i_' + formFieldName + 'HolderJSON').html());

  for (var key=0;key<dataSet.length;key++){
    if (isMatchingClassifierValue(dropdownForm, formFieldName, dataSet[key], classifierJSON)) {
      dropdownForm.find('#i_' + formFieldName+'Holder').val(dataSet[key]['id']);
      dropdownForm.find('#i_' + formFieldName + '_span').show();
      dropdownForm.find('#i_' + formFieldName+'Holder').trigger("blur");
    }
  }

  if (dropdownForm.find('#i_' + formFieldName + 'Holder').val() == '') {
    dropdownForm.find('#i_' + formFieldName + '_span_error').show();
    dropdownForm.find('#i_' + formFieldName+'Holder').trigger("blur");
  }
}

function isMatchingClassifierValue(dropdownForm, formFieldName, row, classifierJSON) {
  var r = true;
  for (var classifier=0;classifier<classifierJSON.length;classifier++){
    if (row[classifierJSON[classifier]['name']] != dropdownForm.find('#i_' + formFieldName + '_' + classifierJSON[classifier]['name']).val()) {
      r = false;
    }
  }
  return r;
}

function resetClassifierInfo(dropdownForm, formFieldName) {
  dropdownForm.find('#i_' + formFieldName + '_span_error').hide();
  dropdownForm.find('#i_' + formFieldName + '_span').hide();
  dropdownForm.find('#i_' + formFieldName + 'Holder').val('');
}

function filterClassifierChoices(formFieldName, classifierName, nextClassifierName, htmlDropdownForm) {
  var dropdownForm = AJS.$(htmlDropdownForm);
  resetClassifierInfo(dropdownForm, formFieldName);

  var thisClassifiedDropDown = dropdownForm.find('#i_' + formFieldName + '_' + classifierName);
  var nextClassifiedDropDown = dropdownForm.find('#i_' + formFieldName + '_' + nextClassifierName);
  var nextClassifiedLabel = dropdownForm.find('#i_labelfor_' + formFieldName + '_' + nextClassifierName);

  var classifierJSON = AJS.$.parseJSON(thisClassifiedDropDown.attr('data-classifiers'));
  var dropdownVal = thisClassifiedDropDown.val();

  var dataSet = AJS.$.parseJSON(dropdownForm.find('#i_' + formFieldName +'HolderJSON').html());

  var addedValues = [];

  nextClassifiedDropDown.empty();
  if (dropdownVal != '') {
    nextClassifiedDropDown.append('<option value=""></option>');
    var i = 0;
    var matchingChoicesCount = 0;
    for (var key = 0; key < dataSet.length; key++) {
      if (isMatchingClassifierValue(dropdownForm, formFieldName, dataSet[key], classifierJSON)) {
        if (!isValueAdded(dataSet[key][nextClassifierName], addedValues)) {
          nextClassifiedDropDown.append('<option value="' + dataSet[key][nextClassifierName] + '">' + dataSet[key][nextClassifierName + '_caption'] + '</option>');
          addedValues[i++] = dataSet[key][nextClassifierName];
        }
        matchingChoicesCount++
      }
    }
  }

  if (addedValues.length <= 1 && matchingChoicesCount <= 1) {
    nextClassifiedDropDown.show();
    if (nextClassifiedLabel != null) {
      nextClassifiedLabel.css('display', 'block');
    }
    AJS.$(nextClassifiedDropDown).find('option').last().prop('selected', true);
    nextClassifiedDropDown.trigger('change');
    setClassifierValue(formFieldName, classifierName, htmlDropdownForm);
  } else {
    if (dropdownVal == '' || dropdownVal == null) {
      nextClassifiedDropDown.hide();
      if (nextClassifiedLabel != null) {
        nextClassifiedLabel.hide();
      }
    } else {
      if (nextClassifiedLabel != null) {
        nextClassifiedLabel.css('display', 'block');
      }
      nextClassifiedDropDown.show();
      nextClassifiedDropDown.focus();
    }
    nextClassifiedDropDown.trigger('change');
  }
}

function isValueAdded(val, addedValues) {
  for (var i = 0; i < addedValues.length; i++) {
    if (addedValues[i] == val) {
      return true;
    }
  }
  return false;
}

function lookupJiraIssueDetails(elem, fieldName) {
  var jiElem = AJS.$(elem);
  jiElem.closest('form').find('#i_' + fieldName + '_jira_info').html('');
  if (jiElem.val() != '') {
    AJS.$.ajax({
      url: AJS.params.contextPath + "/plugins/servlet/confiform/proxy",
      data: ({key: jiElem.val(), appLink: jiElem.attr('appLink')}),
      timeout: 180000, // 180 sec
      success: function (data) {
        jiElem.closest('form').find('#i_' + fieldName + '_jira_info').html(data);
      },
      error: function (jqXHR, textStatus, errorThrown) {
      }
    });
  }
}

function myDefaultEscapeMarkup(markup) {
  var replace_map = {
    '\\': '&#92;',
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#39;',
    "/": '&#47;'
  };

  return String(markup).replace(/[&<>"'\/\\]/g, function (match) {
    return replace_map[match];
  });
}

function applySearchExpression(el, query) {
  var result = false;

  try {
    var fieldSeparator = query.indexOf(":");

    var searchQuery = query;
    if (fieldSeparator > -1) {
      var fieldName = query.substr(0, fieldSeparator);
      el = AJS.$(el).find('#i_sel_' + fieldName);
      if (el == null) {
        return false;
      }

      searchQuery = query.substr(fieldSeparator + 1);
    }

    var qs = searchQuery.split(' ');
    var result = true;
    for (i = 0; i < qs.length; i++) {
      try {
        if (qs[i].trim().length > 0 && el.text().trim().search(new RegExp(qs[i].trim(), "i")) < 0) {
          result = false;
        }
      } catch (e) {
        //
      }
    }
  } catch (e) {
    return false;
  }
  return result;
}

function showImageInDialog(imgPath) {
  var formId = "i_confiform_imgpreview_dialog_" + Math.floor((Math.random()*1000)+1);

  var w = $( window ).width() * 0.75;
  var h = $( window ).height() * 0.75;

  if (w > 800) {
   w = 800;
  }

  if (h > w) {
   h = w;
  }

  var imageHtml = '<p align="center" style="width: 100%"><img width="100%" height="100%" src="' + imgPath + '"/></p>';

  removeConfKeyBindings();

  var popup = new AJS.Dialog({width:w, height:h, id:formId, closeOnEscape: true, closeOnOutsideClick: true});
  popup.addHeader('Image Preview');
  popup.addPanel("ImagePreview", imageHtml);

  popup.addCancel("Close", function(dialog) {
     dialog.hide().remove();
  });

  popup.show();
}

function refreshCaptcha(elem, fieldName) {
  var cElem = AJS.$(elem);
  var f = cElem.closest('form').find('img[id="i_'+fieldName+'Captcha"]');
  if (f) {
    f.prop('src', AJS.params.contextPath + '/plugins/servlet/confiform/captcha?rnd=' + Math.floor((Math.random()*1000)+1));
  }
}

function tryToAddQTip(elem, ttext) {
  if (window.jQuery) {
    elem.qtip({
      content: {
        text: ttext,
        title: 'Change history'
      },
      style: {
        classes: 'qtip-light qtip-shadow'
      }
    });
  }
}

function executeJS(cookieName, jsCode) {
  if (AJS.$.cookie(cookieName) != null) {
   AJS.$.cookie(cookieName, '', { path: '/', expires:-1 });
   if (jsCode != null) {
     jsCode();
   }
  }
}

function decodeHTML(value) {
  if (value == null) {
    return "";
  }
  return value.replace(/&apos;/g, "'")
    .replace(/&quot;/g, '"')
    .replace(/&gt;/g, '>')
    .replace(/&lt;/g, '<')
    .replace(/&amp;/g, '&');
}

function encodeHTML(value) {
  if (value == null) {
    return "";
  }
  return value.replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&apos;');
}

function getElementValue(elem) {
  if (elem.length == 1) {
    if ('checkbox' == elem.attr('type') || 'radio' == elem.attr('type')) {
      return elem.prop('checked');
    } else {
      return elem.val();
    }
  } else {
    var result = '';
    AJS.$(elem).each(function() {
      var e = AJS.$(this);
      if ('checkbox' == e.attr('type') || 'radio' == e.attr('type')){
        if (e.prop('checked')) {
          result = e.val();
        }
      }
    });
    return result;
  }
}

function saveQuickEditForFieldValue(pageId, storagePageId, formName, entryId, fieldName, cellElement) {
  var fieldValue = getElementValue(AJS.$(cellElement).find('#i_' + fieldName));

  if (fieldValue == null){
    fieldValue = '';
  }
  var actionValues = fieldName + '=' + fieldValue;
  AJS.$.ajax({
    url: AJS.params.contextPath + '/ajax/confiforms/quickaction.action',
    data: ({pageId: pageId, storagePageId: storagePageId, entryId: entryId, registrationFormName: formName, fieldName: fieldName, actionValues: actionValues}),
    timeout: 180000, // 180 sec
    success: function (data) {
      cancelQuickEdit(pageId, storagePageId, formName, entryId, fieldName, cellElement);
    },
    error: function (jqXHR, textStatus, errorThrown) {
      alert('Could not compete quick edit action, due to technical reasons:' + textStatus + ' ' + errorThrown);
    }
  });
}

function saveQuickEdit(pageId, storagePageId, formName, entryId, fieldName, formId, cellElement, isCheckbox, postfix) {
  if (cellElement != null) {
    AJS.$(cellElement).find('.cf_qe_wait_icon').show();
  }
  var fieldValue = getElementValue(AJS.$(cellElement).find('#i_' + fieldName + postfix));

  if (isCheckbox || fieldValue == null || fieldValue == '') {
    saveQuickEditForFieldValue(pageId, storagePageId, formName, entryId, fieldName, cellElement);
  } else {
    submitSaveEntryRequestWithCallBackFunc(entryId, '#' + formId, null, function () {
      cancelQuickEdit(pageId, storagePageId, formName, entryId, fieldName, cellElement);
    });
  }
}

function cancelQuickEdit(pageId, storagePageId, formName, entryId, fieldName, cellElement) {
  if (cellElement != null) {
    AJS.$(cellElement).find('.cf_qe_wait_icon').show();
  }
  quickEdit(pageId, storagePageId, formName, entryId, fieldName, cellElement, 'view');
}

function showQuickEdit(pageId, storagePageId, formName, entryId, fieldName, cellElement) {
  quickEdit(pageId, storagePageId, formName, entryId, fieldName, cellElement, 'edit');
}

function quickEdit(pageId, storagePageId, formName, entryId, fieldName, cellElement, mode) {
  AJS.$.ajax({
    url: AJS.params.contextPath + '/ajax/confiforms/quickedit.action',
    data: ({pageId: pageId, storagePageId: storagePageId, entryId: entryId, registrationFormName: formName,
      fieldName: fieldName, mode: mode}),
    timeout: 180000, // 180 sec
    success: function (data) {
      var json = tryToParseResponseAsJSON(data);

      if (AJS.$(cellElement).closest('form').length > 0) {
          AJS.$(cellElement).closest('form').attr('id', json['formId']);
      }

      AJS.$(cellElement).html(json['html']);
      if('edit' == mode && json['formId']) {
        var fieldElement = AJS.$('#'+json['formId']).find("#i_" + fieldName);
        if (fieldElement != null && ('hidden' != fieldElement.attr('type'))) {
          fieldElement.focus();
        }
      }
      if (json['js']) {
        eval("var formId='" + json['formId'] + "'; " + json['js']);
      }
    },
    error: function (jqXHR, textStatus, errorThrown) {
      alert('Could not compete quick edit action, due to technical reasons:' + textStatus + ' ' + errorThrown);
    }
  });
}
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/moment.min.js' */
//! moment.js
//! version : 2.11.2
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

;(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    global.confimoment = factory()
}(this, function () { 'use strict';

    var hookCallback;

    function utils_hooks__hooks () {
        return hookCallback.apply(null, arguments);
    }

    // This is done to register the method called with moment()
    // without creating circular dependencies.
    function setHookCallback (callback) {
        hookCallback = callback;
    }

    function isArray(input) {
        return Object.prototype.toString.call(input) === '[object Array]';
    }

    function isDate(input) {
        return input instanceof Date || Object.prototype.toString.call(input) === '[object Date]';
    }

    function map(arr, fn) {
        var res = [], i;
        for (i = 0; i < arr.length; ++i) {
            res.push(fn(arr[i], i));
        }
        return res;
    }

    function hasOwnProp(a, b) {
        return Object.prototype.hasOwnProperty.call(a, b);
    }

    function extend(a, b) {
        for (var i in b) {
            if (hasOwnProp(b, i)) {
                a[i] = b[i];
            }
        }

        if (hasOwnProp(b, 'toString')) {
            a.toString = b.toString;
        }

        if (hasOwnProp(b, 'valueOf')) {
            a.valueOf = b.valueOf;
        }

        return a;
    }

    function create_utc__createUTC (input, format, locale, strict) {
        return createLocalOrUTC(input, format, locale, strict, true).utc();
    }

    function defaultParsingFlags() {
        // We need to deep clone this object.
        return {
            empty           : false,
            unusedTokens    : [],
            unusedInput     : [],
            overflow        : -2,
            charsLeftOver   : 0,
            nullInput       : false,
            invalidMonth    : null,
            invalidFormat   : false,
            userInvalidated : false,
            iso             : false
        };
    }

    function getParsingFlags(m) {
        if (m._pf == null) {
            m._pf = defaultParsingFlags();
        }
        return m._pf;
    }

    function valid__isValid(m) {
        if (m._isValid == null) {
            var flags = getParsingFlags(m);
            m._isValid = !isNaN(m._d.getTime()) &&
                flags.overflow < 0 &&
                !flags.empty &&
                !flags.invalidMonth &&
                !flags.invalidWeekday &&
                !flags.nullInput &&
                !flags.invalidFormat &&
                !flags.userInvalidated;

            if (m._strict) {
                m._isValid = m._isValid &&
                    flags.charsLeftOver === 0 &&
                    flags.unusedTokens.length === 0 &&
                    flags.bigHour === undefined;
            }
        }
        return m._isValid;
    }

    function valid__createInvalid (flags) {
        var m = create_utc__createUTC(NaN);
        if (flags != null) {
            extend(getParsingFlags(m), flags);
        }
        else {
            getParsingFlags(m).userInvalidated = true;
        }

        return m;
    }

    function isUndefined(input) {
        return input === void 0;
    }

    // Plugins that add properties should also add the key here (null value),
    // so we can properly clone ourselves.
    var momentProperties = utils_hooks__hooks.momentProperties = [];

    function copyConfig(to, from) {
        var i, prop, val;

        if (!isUndefined(from._isAMomentObject)) {
            to._isAMomentObject = from._isAMomentObject;
        }
        if (!isUndefined(from._i)) {
            to._i = from._i;
        }
        if (!isUndefined(from._f)) {
            to._f = from._f;
        }
        if (!isUndefined(from._l)) {
            to._l = from._l;
        }
        if (!isUndefined(from._strict)) {
            to._strict = from._strict;
        }
        if (!isUndefined(from._tzm)) {
            to._tzm = from._tzm;
        }
        if (!isUndefined(from._isUTC)) {
            to._isUTC = from._isUTC;
        }
        if (!isUndefined(from._offset)) {
            to._offset = from._offset;
        }
        if (!isUndefined(from._pf)) {
            to._pf = getParsingFlags(from);
        }
        if (!isUndefined(from._locale)) {
            to._locale = from._locale;
        }

        if (momentProperties.length > 0) {
            for (i in momentProperties) {
                prop = momentProperties[i];
                val = from[prop];
                if (!isUndefined(val)) {
                    to[prop] = val;
                }
            }
        }

        return to;
    }

    var updateInProgress = false;

    // Moment prototype object
    function ConfiMoment(config) {
        copyConfig(this, config);
        this._d = new Date(config._d != null ? config._d.getTime() : NaN);
        // Prevent infinite loop in case updateOffset creates new moment
        // objects.
        if (updateInProgress === false) {
            updateInProgress = true;
            utils_hooks__hooks.updateOffset(this);
            updateInProgress = false;
        }
    }

    function isMoment (obj) {
        return obj instanceof ConfiMoment || (obj != null && obj._isAMomentObject != null);
    }

    function absFloor (number) {
        if (number < 0) {
            return Math.ceil(number);
        } else {
            return Math.floor(number);
        }
    }

    function toInt(argumentForCoercion) {
        var coercedNumber = +argumentForCoercion,
            value = 0;

        if (coercedNumber !== 0 && isFinite(coercedNumber)) {
            value = absFloor(coercedNumber);
        }

        return value;
    }

    // compare two arrays, return the number of differences
    function compareArrays(array1, array2, dontConvert) {
        var len = Math.min(array1.length, array2.length),
            lengthDiff = Math.abs(array1.length - array2.length),
            diffs = 0,
            i;
        for (i = 0; i < len; i++) {
            if ((dontConvert && array1[i] !== array2[i]) ||
                (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {
                diffs++;
            }
        }
        return diffs + lengthDiff;
    }

    function Locale() {
    }

    // internal storage for locale config files
    var locales = {};
    var globalLocale;

    function normalizeLocale(key) {
        return key ? key.toLowerCase().replace('_', '-') : key;
    }

    // pick the locale from the array
    // try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each
    // substring from most specific to least, but move to the next array item if it's a more specific variant than the current root
    function chooseLocale(names) {
        var i = 0, j, next, locale, split;

        while (i < names.length) {
            split = normalizeLocale(names[i]).split('-');
            j = split.length;
            next = normalizeLocale(names[i + 1]);
            next = next ? next.split('-') : null;
            while (j > 0) {
                locale = loadLocale(split.slice(0, j).join('-'));
                if (locale) {
                    return locale;
                }
                if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {
                    //the next array item is better than a shallower substring of this one
                    break;
                }
                j--;
            }
            i++;
        }
        return null;
    }

    function loadLocale(name) {
        var oldLocale = null;
        // TODO: Find a better way to register and load all the locales in Node
        if (!locales[name] && (typeof module !== 'undefined') &&
                module && module.exports) {
            try {
                oldLocale = globalLocale._abbr;
                require('./locale/' + name);
                // because defineLocale currently also sets the global locale, we
                // want to undo that for lazy loaded locales
                locale_locales__getSetGlobalLocale(oldLocale);
            } catch (e) { }
        }
        return locales[name];
    }

    // This function will load locale and then set the global locale.  If
    // no arguments are passed in, it will simply return the current global
    // locale key.
    function locale_locales__getSetGlobalLocale (key, values) {
        var data;
        if (key) {
            if (isUndefined(values)) {
                data = locale_locales__getLocale(key);
            }
            else {
                data = defineLocale(key, values);
            }

            if (data) {
                // moment.duration._locale = moment._locale = data;
                globalLocale = data;
            }
        }

        return globalLocale._abbr;
    }

    function defineLocale (name, values) {
        if (values !== null) {
            values.abbr = name;
            locales[name] = locales[name] || new Locale();
            locales[name].set(values);

            // backwards compat for now: also set the locale
            locale_locales__getSetGlobalLocale(name);

            return locales[name];
        } else {
            // useful for testing
            delete locales[name];
            return null;
        }
    }

    // returns locale data
    function locale_locales__getLocale (key) {
        var locale;

        if (key && key._locale && key._locale._abbr) {
            key = key._locale._abbr;
        }

        if (!key) {
            return globalLocale;
        }

        if (!isArray(key)) {
            //short-circuit everything else
            locale = loadLocale(key);
            if (locale) {
                return locale;
            }
            key = [key];
        }

        return chooseLocale(key);
    }

    var aliases = {};

    function addUnitAlias (unit, shorthand) {
        var lowerCase = unit.toLowerCase();
        aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;
    }

    function normalizeUnits(units) {
        return typeof units === 'string' ? aliases[units] || aliases[units.toLowerCase()] : undefined;
    }

    function normalizeObjectUnits(inputObject) {
        var normalizedInput = {},
            normalizedProp,
            prop;

        for (prop in inputObject) {
            if (hasOwnProp(inputObject, prop)) {
                normalizedProp = normalizeUnits(prop);
                if (normalizedProp) {
                    normalizedInput[normalizedProp] = inputObject[prop];
                }
            }
        }

        return normalizedInput;
    }

    function isFunction(input) {
        return input instanceof Function || Object.prototype.toString.call(input) === '[object Function]';
    }

    function makeGetSet (unit, keepTime) {
        return function (value) {
            if (value != null) {
                get_set__set(this, unit, value);
                utils_hooks__hooks.updateOffset(this, keepTime);
                return this;
            } else {
                return get_set__get(this, unit);
            }
        };
    }

    function get_set__get (mom, unit) {
        return mom.isValid() ?
            mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]() : NaN;
    }

    function get_set__set (mom, unit, value) {
        if (mom.isValid()) {
            mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);
        }
    }

    // MOMENTS

    function getSet (units, value) {
        var unit;
        if (typeof units === 'object') {
            for (unit in units) {
                this.set(unit, units[unit]);
            }
        } else {
            units = normalizeUnits(units);
            if (isFunction(this[units])) {
                return this[units](value);
            }
        }
        return this;
    }

    function zeroFill(number, targetLength, forceSign) {
        var absNumber = '' + Math.abs(number),
            zerosToFill = targetLength - absNumber.length,
            sign = number >= 0;
        return (sign ? (forceSign ? '+' : '') : '-') +
            Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;
    }

    var formattingTokens = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;

    var localFormattingTokens = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;

    var formatFunctions = {};

    var formatTokenFunctions = {};

    // token:    'M'
    // padded:   ['MM', 2]
    // ordinal:  'Mo'
    // callback: function () { this.month() + 1 }
    function addFormatToken (token, padded, ordinal, callback) {
        var func = callback;
        if (typeof callback === 'string') {
            func = function () {
                return this[callback]();
            };
        }
        if (token) {
            formatTokenFunctions[token] = func;
        }
        if (padded) {
            formatTokenFunctions[padded[0]] = function () {
                return zeroFill(func.apply(this, arguments), padded[1], padded[2]);
            };
        }
        if (ordinal) {
            formatTokenFunctions[ordinal] = function () {
                return this.localeData().ordinal(func.apply(this, arguments), token);
            };
        }
    }

    function removeFormattingTokens(input) {
        if (input.match(/\[[\s\S]/)) {
            return input.replace(/^\[|\]$/g, '');
        }
        return input.replace(/\\/g, '');
    }

    function makeFormatFunction(format) {
        var array = format.match(formattingTokens), i, length;

        for (i = 0, length = array.length; i < length; i++) {
            if (formatTokenFunctions[array[i]]) {
                array[i] = formatTokenFunctions[array[i]];
            } else {
                array[i] = removeFormattingTokens(array[i]);
            }
        }

        return function (mom) {
            var output = '';
            for (i = 0; i < length; i++) {
                output += array[i] instanceof Function ? array[i].call(mom, format) : array[i];
            }
            return output;
        };
    }

    // format date using native date object
    function formatMoment(m, format) {
        if (!m.isValid()) {
            return m.localeData().invalidDate();
        }

        format = expandFormat(format, m.localeData());
        formatFunctions[format] = formatFunctions[format] || makeFormatFunction(format);

        return formatFunctions[format](m);
    }

    function expandFormat(format, locale) {
        var i = 5;

        function replaceLongDateFormatTokens(input) {
            return locale.longDateFormat(input) || input;
        }

        localFormattingTokens.lastIndex = 0;
        while (i >= 0 && localFormattingTokens.test(format)) {
            format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);
            localFormattingTokens.lastIndex = 0;
            i -= 1;
        }

        return format;
    }

    var match1         = /\d/;            //       0 - 9
    var match2         = /\d\d/;          //      00 - 99
    var match3         = /\d{3}/;         //     000 - 999
    var match4         = /\d{4}/;         //    0000 - 9999
    var match6         = /[+-]?\d{6}/;    // -999999 - 999999
    var match1to2      = /\d\d?/;         //       0 - 99
    var match3to4      = /\d\d\d\d?/;     //     999 - 9999
    var match5to6      = /\d\d\d\d\d\d?/; //   99999 - 999999
    var match1to3      = /\d{1,3}/;       //       0 - 999
    var match1to4      = /\d{1,4}/;       //       0 - 9999
    var match1to6      = /[+-]?\d{1,6}/;  // -999999 - 999999

    var matchUnsigned  = /\d+/;           //       0 - inf
    var matchSigned    = /[+-]?\d+/;      //    -inf - inf

    var matchOffset    = /Z|[+-]\d\d:?\d\d/gi; // +00:00 -00:00 +0000 -0000 or Z
    var matchShortOffset = /Z|[+-]\d\d(?::?\d\d)?/gi; // +00 -00 +00:00 -00:00 +0000 -0000 or Z

    var matchTimestamp = /[+-]?\d+(\.\d{1,3})?/; // 123456789 123456789.123

    // any word (or two) characters or numbers including two/three word month in arabic.
    // includes scottish gaelic two word and hyphenated months
    var matchWord = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;


    var regexes = {};

    function addRegexToken (token, regex, strictRegex) {
        regexes[token] = isFunction(regex) ? regex : function (isStrict, localeData) {
            return (isStrict && strictRegex) ? strictRegex : regex;
        };
    }

    function getParseRegexForToken (token, config) {
        if (!hasOwnProp(regexes, token)) {
            return new RegExp(unescapeFormat(token));
        }

        return regexes[token](config._strict, config._locale);
    }

    // Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript
    function unescapeFormat(s) {
        return regexEscape(s.replace('\\', '').replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (matched, p1, p2, p3, p4) {
            return p1 || p2 || p3 || p4;
        }));
    }

    function regexEscape(s) {
        return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
    }

    var tokens = {};

    function addParseToken (token, callback) {
        var i, func = callback;
        if (typeof token === 'string') {
            token = [token];
        }
        if (typeof callback === 'number') {
            func = function (input, array) {
                array[callback] = toInt(input);
            };
        }
        for (i = 0; i < token.length; i++) {
            tokens[token[i]] = func;
        }
    }

    function addWeekParseToken (token, callback) {
        addParseToken(token, function (input, array, config, token) {
            config._w = config._w || {};
            callback(input, config._w, config, token);
        });
    }

    function addTimeToArrayFromToken(token, input, config) {
        if (input != null && hasOwnProp(tokens, token)) {
            tokens[token](input, config._a, config, token);
        }
    }

    var YEAR = 0;
    var MONTH = 1;
    var DATE = 2;
    var HOUR = 3;
    var MINUTE = 4;
    var SECOND = 5;
    var MILLISECOND = 6;
    var WEEK = 7;
    var WEEKDAY = 8;

    function daysInMonth(year, month) {
        return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();
    }

    // FORMATTING

    addFormatToken('M', ['MM', 2], 'Mo', function () {
        return this.month() + 1;
    });

    addFormatToken('MMM', 0, 0, function (format) {
        return this.localeData().monthsShort(this, format);
    });

    addFormatToken('MMMM', 0, 0, function (format) {
        return this.localeData().months(this, format);
    });

    // ALIASES

    addUnitAlias('month', 'M');

    // PARSING

    addRegexToken('M',    match1to2);
    addRegexToken('MM',   match1to2, match2);
    addRegexToken('MMM',  function (isStrict, locale) {
        return locale.monthsShortRegex(isStrict);
    });
    addRegexToken('MMMM', function (isStrict, locale) {
        return locale.monthsRegex(isStrict);
    });

    addParseToken(['M', 'MM'], function (input, array) {
        array[MONTH] = toInt(input) - 1;
    });

    addParseToken(['MMM', 'MMMM'], function (input, array, config, token) {
        var month = config._locale.monthsParse(input, token, config._strict);
        // if we didn't find a month name, mark the date as invalid.
        if (month != null) {
            array[MONTH] = month;
        } else {
            getParsingFlags(config).invalidMonth = input;
        }
    });

    // LOCALES

    var MONTHS_IN_FORMAT = /D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/;
    var defaultLocaleMonths = 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_');
    function localeMonths (m, format) {
        return isArray(this._months) ? this._months[m.month()] :
            this._months[MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'][m.month()];
    }

    var defaultLocaleMonthsShort = 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');
    function localeMonthsShort (m, format) {
        return isArray(this._monthsShort) ? this._monthsShort[m.month()] :
            this._monthsShort[MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'][m.month()];
    }

    function localeMonthsParse (monthName, format, strict) {
        var i, mom, regex;

        if (!this._monthsParse) {
            this._monthsParse = [];
            this._longMonthsParse = [];
            this._shortMonthsParse = [];
        }

        for (i = 0; i < 12; i++) {
            // make the regex if we don't have it already
            mom = create_utc__createUTC([2000, i]);
            if (strict && !this._longMonthsParse[i]) {
                this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');
                this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');
            }
            if (!strict && !this._monthsParse[i]) {
                regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');
                this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');
            }
            // test the regex
            if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {
                return i;
            } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {
                return i;
            } else if (!strict && this._monthsParse[i].test(monthName)) {
                return i;
            }
        }
    }

    // MOMENTS

    function setMonth (mom, value) {
        var dayOfMonth;

        if (!mom.isValid()) {
            // No op
            return mom;
        }

        // TODO: Move this out of here!
        if (typeof value === 'string') {
            value = mom.localeData().monthsParse(value);
            // TODO: Another silent failure?
            if (typeof value !== 'number') {
                return mom;
            }
        }

        dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));
        mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);
        return mom;
    }

    function getSetMonth (value) {
        if (value != null) {
            setMonth(this, value);
            utils_hooks__hooks.updateOffset(this, true);
            return this;
        } else {
            return get_set__get(this, 'Month');
        }
    }

    function getDaysInMonth () {
        return daysInMonth(this.year(), this.month());
    }

    var defaultMonthsShortRegex = matchWord;
    function monthsShortRegex (isStrict) {
        if (this._monthsParseExact) {
            if (!hasOwnProp(this, '_monthsRegex')) {
                computeMonthsParse.call(this);
            }
            if (isStrict) {
                return this._monthsShortStrictRegex;
            } else {
                return this._monthsShortRegex;
            }
        } else {
            return this._monthsShortStrictRegex && isStrict ?
                this._monthsShortStrictRegex : this._monthsShortRegex;
        }
    }

    var defaultMonthsRegex = matchWord;
    function monthsRegex (isStrict) {
        if (this._monthsParseExact) {
            if (!hasOwnProp(this, '_monthsRegex')) {
                computeMonthsParse.call(this);
            }
            if (isStrict) {
                return this._monthsStrictRegex;
            } else {
                return this._monthsRegex;
            }
        } else {
            return this._monthsStrictRegex && isStrict ?
                this._monthsStrictRegex : this._monthsRegex;
        }
    }

    function computeMonthsParse () {
        function cmpLenRev(a, b) {
            return b.length - a.length;
        }

        var shortPieces = [], longPieces = [], mixedPieces = [],
            i, mom;
        for (i = 0; i < 12; i++) {
            // make the regex if we don't have it already
            mom = create_utc__createUTC([2000, i]);
            shortPieces.push(this.monthsShort(mom, ''));
            longPieces.push(this.months(mom, ''));
            mixedPieces.push(this.months(mom, ''));
            mixedPieces.push(this.monthsShort(mom, ''));
        }
        // Sorting makes sure if one month (or abbr) is a prefix of another it
        // will match the longer piece.
        shortPieces.sort(cmpLenRev);
        longPieces.sort(cmpLenRev);
        mixedPieces.sort(cmpLenRev);
        for (i = 0; i < 12; i++) {
            shortPieces[i] = regexEscape(shortPieces[i]);
            longPieces[i] = regexEscape(longPieces[i]);
            mixedPieces[i] = regexEscape(mixedPieces[i]);
        }

        this._monthsRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');
        this._monthsShortRegex = this._monthsRegex;
        this._monthsStrictRegex = new RegExp('^(' + longPieces.join('|') + ')$', 'i');
        this._monthsShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')$', 'i');
    }

    function checkOverflow (m) {
        var overflow;
        var a = m._a;

        if (a && getParsingFlags(m).overflow === -2) {
            overflow =
                a[MONTH]       < 0 || a[MONTH]       > 11  ? MONTH :
                a[DATE]        < 1 || a[DATE]        > daysInMonth(a[YEAR], a[MONTH]) ? DATE :
                a[HOUR]        < 0 || a[HOUR]        > 24 || (a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0)) ? HOUR :
                a[MINUTE]      < 0 || a[MINUTE]      > 59  ? MINUTE :
                a[SECOND]      < 0 || a[SECOND]      > 59  ? SECOND :
                a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND :
                -1;

            if (getParsingFlags(m)._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {
                overflow = DATE;
            }
            if (getParsingFlags(m)._overflowWeeks && overflow === -1) {
                overflow = WEEK;
            }
            if (getParsingFlags(m)._overflowWeekday && overflow === -1) {
                overflow = WEEKDAY;
            }

            getParsingFlags(m).overflow = overflow;
        }

        return m;
    }

    function warn(msg) {
        if (utils_hooks__hooks.suppressDeprecationWarnings === false &&
                (typeof console !==  'undefined') && console.warn) {
            console.warn('Deprecation warning: ' + msg);
        }
    }

    function deprecate(msg, fn) {
        var firstTime = true;

        return extend(function () {
            if (firstTime) {
                warn(msg + '\nArguments: ' + Array.prototype.slice.call(arguments).join(', ') + '\n' + (new Error()).stack);
                firstTime = false;
            }
            return fn.apply(this, arguments);
        }, fn);
    }

    var deprecations = {};

    function deprecateSimple(name, msg) {
        if (!deprecations[name]) {
            warn(msg);
            deprecations[name] = true;
        }
    }

    utils_hooks__hooks.suppressDeprecationWarnings = false;

    // iso 8601 regex
    // 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)
    var extendedIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/;
    var basicIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/;

    var tzRegex = /Z|[+-]\d\d(?::?\d\d)?/;

    var isoDates = [
        ['YYYYYY-MM-DD', /[+-]\d{6}-\d\d-\d\d/],
        ['YYYY-MM-DD', /\d{4}-\d\d-\d\d/],
        ['GGGG-[W]WW-E', /\d{4}-W\d\d-\d/],
        ['GGGG-[W]WW', /\d{4}-W\d\d/, false],
        ['YYYY-DDD', /\d{4}-\d{3}/],
        ['YYYY-MM', /\d{4}-\d\d/, false],
        ['YYYYYYMMDD', /[+-]\d{10}/],
        ['YYYYMMDD', /\d{8}/],
        // YYYYMM is NOT allowed by the standard
        ['GGGG[W]WWE', /\d{4}W\d{3}/],
        ['GGGG[W]WW', /\d{4}W\d{2}/, false],
        ['YYYYDDD', /\d{7}/]
    ];

    // iso time formats and regexes
    var isoTimes = [
        ['HH:mm:ss.SSSS', /\d\d:\d\d:\d\d\.\d+/],
        ['HH:mm:ss,SSSS', /\d\d:\d\d:\d\d,\d+/],
        ['HH:mm:ss', /\d\d:\d\d:\d\d/],
        ['HH:mm', /\d\d:\d\d/],
        ['HHmmss.SSSS', /\d\d\d\d\d\d\.\d+/],
        ['HHmmss,SSSS', /\d\d\d\d\d\d,\d+/],
        ['HHmmss', /\d\d\d\d\d\d/],
        ['HHmm', /\d\d\d\d/],
        ['HH', /\d\d/]
    ];

    var aspNetJsonRegex = /^\/?Date\((\-?\d+)/i;

    // date from iso format
    function configFromISO(config) {
        var i, l,
            string = config._i,
            match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string),
            allowTime, dateFormat, timeFormat, tzFormat;

        if (match) {
            getParsingFlags(config).iso = true;

            for (i = 0, l = isoDates.length; i < l; i++) {
                if (isoDates[i][1].exec(match[1])) {
                    dateFormat = isoDates[i][0];
                    allowTime = isoDates[i][2] !== false;
                    break;
                }
            }
            if (dateFormat == null) {
                config._isValid = false;
                return;
            }
            if (match[3]) {
                for (i = 0, l = isoTimes.length; i < l; i++) {
                    if (isoTimes[i][1].exec(match[3])) {
                        // match[2] should be 'T' or space
                        timeFormat = (match[2] || ' ') + isoTimes[i][0];
                        break;
                    }
                }
                if (timeFormat == null) {
                    config._isValid = false;
                    return;
                }
            }
            if (!allowTime && timeFormat != null) {
                config._isValid = false;
                return;
            }
            if (match[4]) {
                if (tzRegex.exec(match[4])) {
                    tzFormat = 'Z';
                } else {
                    config._isValid = false;
                    return;
                }
            }
            config._f = dateFormat + (timeFormat || '') + (tzFormat || '');
            configFromStringAndFormat(config);
        } else {
            config._isValid = false;
        }
    }

    // date from iso format or fallback
    function configFromString(config) {
        var matched = aspNetJsonRegex.exec(config._i);

        if (matched !== null) {
            config._d = new Date(+matched[1]);
            return;
        }

        configFromISO(config);
        if (config._isValid === false) {
            delete config._isValid;
            utils_hooks__hooks.createFromInputFallback(config);
        }
    }

    utils_hooks__hooks.createFromInputFallback = deprecate(
        'moment construction falls back to js Date. This is ' +
        'discouraged and will be removed in upcoming major ' +
        'release. Please refer to ' +
        'https://github.com/moment/moment/issues/1407 for more info.',
        function (config) {
            config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));
        }
    );

    function createDate (y, m, d, h, M, s, ms) {
        //can't just apply() to create a date:
        //http://stackoverflow.com/questions/181348/instantiating-a-javascript-object-by-calling-prototype-constructor-apply
        var date = new Date(y, m, d, h, M, s, ms);

        //the date constructor remaps years 0-99 to 1900-1999
        if (y < 100 && y >= 0 && isFinite(date.getFullYear())) {
            date.setFullYear(y);
        }
        return date;
    }

    function createUTCDate (y) {
        var date = new Date(Date.UTC.apply(null, arguments));

        //the Date.UTC function remaps years 0-99 to 1900-1999
        if (y < 100 && y >= 0 && isFinite(date.getUTCFullYear())) {
            date.setUTCFullYear(y);
        }
        return date;
    }

    // FORMATTING

    addFormatToken('Y', 0, 0, function () {
        var y = this.year();
        return y <= 9999 ? '' + y : '+' + y;
    });

    addFormatToken(0, ['YY', 2], 0, function () {
        return this.year() % 100;
    });

    addFormatToken(0, ['YYYY',   4],       0, 'year');
    addFormatToken(0, ['YYYYY',  5],       0, 'year');
    addFormatToken(0, ['YYYYYY', 6, true], 0, 'year');

    // ALIASES

    addUnitAlias('year', 'y');

    // PARSING

    addRegexToken('Y',      matchSigned);
    addRegexToken('YY',     match1to2, match2);
    addRegexToken('YYYY',   match1to4, match4);
    addRegexToken('YYYYY',  match1to6, match6);
    addRegexToken('YYYYYY', match1to6, match6);

    addParseToken(['YYYYY', 'YYYYYY'], YEAR);
    addParseToken('YYYY', function (input, array) {
        array[YEAR] = input.length === 2 ? utils_hooks__hooks.parseTwoDigitYear(input) : toInt(input);
    });
    addParseToken('YY', function (input, array) {
        array[YEAR] = utils_hooks__hooks.parseTwoDigitYear(input);
    });
    addParseToken('Y', function (input, array) {
        array[YEAR] = parseInt(input, 10);
    });

    // HELPERS

    function daysInYear(year) {
        return isLeapYear(year) ? 366 : 365;
    }

    function isLeapYear(year) {
        return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;
    }

    // HOOKS

    utils_hooks__hooks.parseTwoDigitYear = function (input) {
        return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);
    };

    // MOMENTS

    var getSetYear = makeGetSet('FullYear', false);

    function getIsLeapYear () {
        return isLeapYear(this.year());
    }

    // start-of-first-week - start-of-year
    function firstWeekOffset(year, dow, doy) {
        var // first-week day -- which january is always in the first week (4 for iso, 1 for other)
            fwd = 7 + dow - doy,
            // first-week day local weekday -- which local weekday is fwd
            fwdlw = (7 + createUTCDate(year, 0, fwd).getUTCDay() - dow) % 7;

        return -fwdlw + fwd - 1;
    }

    //http://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday
    function dayOfYearFromWeeks(year, week, weekday, dow, doy) {
        var localWeekday = (7 + weekday - dow) % 7,
            weekOffset = firstWeekOffset(year, dow, doy),
            dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset,
            resYear, resDayOfYear;

        if (dayOfYear <= 0) {
            resYear = year - 1;
            resDayOfYear = daysInYear(resYear) + dayOfYear;
        } else if (dayOfYear > daysInYear(year)) {
            resYear = year + 1;
            resDayOfYear = dayOfYear - daysInYear(year);
        } else {
            resYear = year;
            resDayOfYear = dayOfYear;
        }

        return {
            year: resYear,
            dayOfYear: resDayOfYear
        };
    }

    function weekOfYear(mom, dow, doy) {
        var weekOffset = firstWeekOffset(mom.year(), dow, doy),
            week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1,
            resWeek, resYear;

        if (week < 1) {
            resYear = mom.year() - 1;
            resWeek = week + weeksInYear(resYear, dow, doy);
        } else if (week > weeksInYear(mom.year(), dow, doy)) {
            resWeek = week - weeksInYear(mom.year(), dow, doy);
            resYear = mom.year() + 1;
        } else {
            resYear = mom.year();
            resWeek = week;
        }

        return {
            week: resWeek,
            year: resYear
        };
    }

    function weeksInYear(year, dow, doy) {
        var weekOffset = firstWeekOffset(year, dow, doy),
            weekOffsetNext = firstWeekOffset(year + 1, dow, doy);
        return (daysInYear(year) - weekOffset + weekOffsetNext) / 7;
    }

    // Pick the first defined of two or three arguments.
    function defaults(a, b, c) {
        if (a != null) {
            return a;
        }
        if (b != null) {
            return b;
        }
        return c;
    }

    function currentDateArray(config) {
        // hooks is actually the exported moment object
        var nowValue = new Date(utils_hooks__hooks.now());
        if (config._useUTC) {
            return [nowValue.getUTCFullYear(), nowValue.getUTCMonth(), nowValue.getUTCDate()];
        }
        return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];
    }

    // convert an array to a date.
    // the array should mirror the parameters below
    // note: all values past the year are optional and will default to the lowest possible value.
    // [year, month, day , hour, minute, second, millisecond]
    function configFromArray (config) {
        var i, date, input = [], currentDate, yearToUse;

        if (config._d) {
            return;
        }

        currentDate = currentDateArray(config);

        //compute day of the year from weeks and weekdays
        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {
            dayOfYearFromWeekInfo(config);
        }

        //if the day of the year is set, figure out what it is
        if (config._dayOfYear) {
            yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);

            if (config._dayOfYear > daysInYear(yearToUse)) {
                getParsingFlags(config)._overflowDayOfYear = true;
            }

            date = createUTCDate(yearToUse, 0, config._dayOfYear);
            config._a[MONTH] = date.getUTCMonth();
            config._a[DATE] = date.getUTCDate();
        }

        // Default to current date.
        // * if no year, month, day of month are given, default to today
        // * if day of month is given, default month and year
        // * if month is given, default only year
        // * if year is given, don't default anything
        for (i = 0; i < 3 && config._a[i] == null; ++i) {
            config._a[i] = input[i] = currentDate[i];
        }

        // Zero out whatever was not defaulted, including time
        for (; i < 7; i++) {
            config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];
        }

        // Check for 24:00:00.000
        if (config._a[HOUR] === 24 &&
                config._a[MINUTE] === 0 &&
                config._a[SECOND] === 0 &&
                config._a[MILLISECOND] === 0) {
            config._nextDay = true;
            config._a[HOUR] = 0;
        }

        config._d = (config._useUTC ? createUTCDate : createDate).apply(null, input);
        // Apply timezone offset from input. The actual utcOffset can be changed
        // with parseZone.
        if (config._tzm != null) {
            config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
        }

        if (config._nextDay) {
            config._a[HOUR] = 24;
        }
    }

    function dayOfYearFromWeekInfo(config) {
        var w, weekYear, week, weekday, dow, doy, temp, weekdayOverflow;

        w = config._w;
        if (w.GG != null || w.W != null || w.E != null) {
            dow = 1;
            doy = 4;

            // TODO: We need to take the current isoWeekYear, but that depends on
            // how we interpret now (local, utc, fixed offset). So create
            // a now version of current config (take local/utc/offset flags, and
            // create now).
            weekYear = defaults(w.GG, config._a[YEAR], weekOfYear(local__createLocal(), 1, 4).year);
            week = defaults(w.W, 1);
            weekday = defaults(w.E, 1);
            if (weekday < 1 || weekday > 7) {
                weekdayOverflow = true;
            }
        } else {
            dow = config._locale._week.dow;
            doy = config._locale._week.doy;

            weekYear = defaults(w.gg, config._a[YEAR], weekOfYear(local__createLocal(), dow, doy).year);
            week = defaults(w.w, 1);

            if (w.d != null) {
                // weekday -- low day numbers are considered next week
                weekday = w.d;
                if (weekday < 0 || weekday > 6) {
                    weekdayOverflow = true;
                }
            } else if (w.e != null) {
                // local weekday -- counting starts from begining of week
                weekday = w.e + dow;
                if (w.e < 0 || w.e > 6) {
                    weekdayOverflow = true;
                }
            } else {
                // default to begining of week
                weekday = dow;
            }
        }
        if (week < 1 || week > weeksInYear(weekYear, dow, doy)) {
            getParsingFlags(config)._overflowWeeks = true;
        } else if (weekdayOverflow != null) {
            getParsingFlags(config)._overflowWeekday = true;
        } else {
            temp = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy);
            config._a[YEAR] = temp.year;
            config._dayOfYear = temp.dayOfYear;
        }
    }

    // constant that refers to the ISO standard
    utils_hooks__hooks.ISO_8601 = function () {};

    // date from string and format string
    function configFromStringAndFormat(config) {
        // TODO: Move this to another part of the creation flow to prevent circular deps
        if (config._f === utils_hooks__hooks.ISO_8601) {
            configFromISO(config);
            return;
        }

        config._a = [];
        getParsingFlags(config).empty = true;

        // This array is used to make a Date, either with `new Date` or `Date.UTC`
        var string = '' + config._i,
            i, parsedInput, tokens, token, skipped,
            stringLength = string.length,
            totalParsedInputLength = 0;

        tokens = expandFormat(config._f, config._locale).match(formattingTokens) || [];

        for (i = 0; i < tokens.length; i++) {
            token = tokens[i];
            parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];
            // console.log('token', token, 'parsedInput', parsedInput,
            //         'regex', getParseRegexForToken(token, config));
            if (parsedInput) {
                skipped = string.substr(0, string.indexOf(parsedInput));
                if (skipped.length > 0) {
                    getParsingFlags(config).unusedInput.push(skipped);
                }
                string = string.slice(string.indexOf(parsedInput) + parsedInput.length);
                totalParsedInputLength += parsedInput.length;
            }
            // don't parse if it's not a known token
            if (formatTokenFunctions[token]) {
                if (parsedInput) {
                    getParsingFlags(config).empty = false;
                }
                else {
                    getParsingFlags(config).unusedTokens.push(token);
                }
                addTimeToArrayFromToken(token, parsedInput, config);
            }
            else if (config._strict && !parsedInput) {
                getParsingFlags(config).unusedTokens.push(token);
            }
        }

        // add remaining unparsed input length to the string
        getParsingFlags(config).charsLeftOver = stringLength - totalParsedInputLength;
        if (string.length > 0) {
            getParsingFlags(config).unusedInput.push(string);
        }

        // clear _12h flag if hour is <= 12
        if (getParsingFlags(config).bigHour === true &&
                config._a[HOUR] <= 12 &&
                config._a[HOUR] > 0) {
            getParsingFlags(config).bigHour = undefined;
        }
        // handle meridiem
        config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR], config._meridiem);

        configFromArray(config);
        checkOverflow(config);
    }


    function meridiemFixWrap (locale, hour, meridiem) {
        var isPm;

        if (meridiem == null) {
            // nothing to do
            return hour;
        }
        if (locale.meridiemHour != null) {
            return locale.meridiemHour(hour, meridiem);
        } else if (locale.isPM != null) {
            // Fallback
            isPm = locale.isPM(meridiem);
            if (isPm && hour < 12) {
                hour += 12;
            }
            if (!isPm && hour === 12) {
                hour = 0;
            }
            return hour;
        } else {
            // this is not supposed to happen
            return hour;
        }
    }

    // date from string and array of format strings
    function configFromStringAndArray(config) {
        var tempConfig,
            bestMoment,

            scoreToBeat,
            i,
            currentScore;

        if (config._f.length === 0) {
            getParsingFlags(config).invalidFormat = true;
            config._d = new Date(NaN);
            return;
        }

        for (i = 0; i < config._f.length; i++) {
            currentScore = 0;
            tempConfig = copyConfig({}, config);
            if (config._useUTC != null) {
                tempConfig._useUTC = config._useUTC;
            }
            tempConfig._f = config._f[i];
            configFromStringAndFormat(tempConfig);

            if (!valid__isValid(tempConfig)) {
                continue;
            }

            // if there is any input that was not parsed add a penalty for that format
            currentScore += getParsingFlags(tempConfig).charsLeftOver;

            //or tokens
            currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;

            getParsingFlags(tempConfig).score = currentScore;

            if (scoreToBeat == null || currentScore < scoreToBeat) {
                scoreToBeat = currentScore;
                bestMoment = tempConfig;
            }
        }

        extend(config, bestMoment || tempConfig);
    }

    function configFromObject(config) {
        if (config._d) {
            return;
        }

        var i = normalizeObjectUnits(config._i);
        config._a = map([i.year, i.month, i.day || i.date, i.hour, i.minute, i.second, i.millisecond], function (obj) {
            return obj && parseInt(obj, 10);
        });

        configFromArray(config);
    }

    function createFromConfig (config) {
        var res = new ConfiMoment(checkOverflow(prepareConfig(config)));
        if (res._nextDay) {
            // Adding is smart enough around DST
            res.add(1, 'd');
            res._nextDay = undefined;
        }

        return res;
    }

    function prepareConfig (config) {
        var input = config._i,
            format = config._f;

        config._locale = config._locale || locale_locales__getLocale(config._l);

        if (input === null || (format === undefined && input === '')) {
            return valid__createInvalid({nullInput: true});
        }

        if (typeof input === 'string') {
            config._i = input = config._locale.preparse(input);
        }

        if (isMoment(input)) {
            return new ConfiMoment(checkOverflow(input));
        } else if (isArray(format)) {
            configFromStringAndArray(config);
        } else if (format) {
            configFromStringAndFormat(config);
        } else if (isDate(input)) {
            config._d = input;
        } else {
            configFromInput(config);
        }

        if (!valid__isValid(config)) {
            config._d = null;
        }

        return config;
    }

    function configFromInput(config) {
        var input = config._i;
        if (input === undefined) {
            config._d = new Date(utils_hooks__hooks.now());
        } else if (isDate(input)) {
            config._d = new Date(+input);
        } else if (typeof input === 'string') {
            configFromString(config);
        } else if (isArray(input)) {
            config._a = map(input.slice(0), function (obj) {
                return parseInt(obj, 10);
            });
            configFromArray(config);
        } else if (typeof(input) === 'object') {
            configFromObject(config);
        } else if (typeof(input) === 'number') {
            // from milliseconds
            config._d = new Date(input);
        } else {
            utils_hooks__hooks.createFromInputFallback(config);
        }
    }

    function createLocalOrUTC (input, format, locale, strict, isUTC) {
        var c = {};

        if (typeof(locale) === 'boolean') {
            strict = locale;
            locale = undefined;
        }
        // object construction must be done this way.
        // https://github.com/moment/moment/issues/1423
        c._isAMomentObject = true;
        c._useUTC = c._isUTC = isUTC;
        c._l = locale;
        c._i = input;
        c._f = format;
        c._strict = strict;

        return createFromConfig(c);
    }

    function local__createLocal (input, format, locale, strict) {
        return createLocalOrUTC(input, format, locale, strict, false);
    }

    var prototypeMin = deprecate(
         'moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548',
         function () {
             var other = local__createLocal.apply(null, arguments);
             if (this.isValid() && other.isValid()) {
                 return other < this ? this : other;
             } else {
                 return valid__createInvalid();
             }
         }
     );

    var prototypeMax = deprecate(
        'moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548',
        function () {
            var other = local__createLocal.apply(null, arguments);
            if (this.isValid() && other.isValid()) {
                return other > this ? this : other;
            } else {
                return valid__createInvalid();
            }
        }
    );

    // Pick a moment m from moments so that m[fn](other) is true for all
    // other. This relies on the function fn to be transitive.
    //
    // moments should either be an array of moment objects or an array, whose
    // first element is an array of moment objects.
    function pickBy(fn, moments) {
        var res, i;
        if (moments.length === 1 && isArray(moments[0])) {
            moments = moments[0];
        }
        if (!moments.length) {
            return local__createLocal();
        }
        res = moments[0];
        for (i = 1; i < moments.length; ++i) {
            if (!moments[i].isValid() || moments[i][fn](res)) {
                res = moments[i];
            }
        }
        return res;
    }

    // TODO: Use [].sort instead?
    function min () {
        var args = [].slice.call(arguments, 0);

        return pickBy('isBefore', args);
    }

    function max () {
        var args = [].slice.call(arguments, 0);

        return pickBy('isAfter', args);
    }

    var now = function () {
        return Date.now ? Date.now() : +(new Date());
    };

    function Duration (duration) {
        var normalizedInput = normalizeObjectUnits(duration),
            years = normalizedInput.year || 0,
            quarters = normalizedInput.quarter || 0,
            months = normalizedInput.month || 0,
            weeks = normalizedInput.week || 0,
            days = normalizedInput.day || 0,
            hours = normalizedInput.hour || 0,
            minutes = normalizedInput.minute || 0,
            seconds = normalizedInput.second || 0,
            milliseconds = normalizedInput.millisecond || 0;

        // representation for dateAddRemove
        this._milliseconds = +milliseconds +
            seconds * 1e3 + // 1000
            minutes * 6e4 + // 1000 * 60
            hours * 36e5; // 1000 * 60 * 60
        // Because of dateAddRemove treats 24 hours as different from a
        // day when working around DST, we need to store them separately
        this._days = +days +
            weeks * 7;
        // It is impossible translate months into days without knowing
        // which months you are are talking about, so we have to store
        // it separately.
        this._months = +months +
            quarters * 3 +
            years * 12;

        this._data = {};

        this._locale = locale_locales__getLocale();

        this._bubble();
    }

    function isDuration (obj) {
        return obj instanceof Duration;
    }

    // FORMATTING

    function offset (token, separator) {
        addFormatToken(token, 0, 0, function () {
            var offset = this.utcOffset();
            var sign = '+';
            if (offset < 0) {
                offset = -offset;
                sign = '-';
            }
            return sign + zeroFill(~~(offset / 60), 2) + separator + zeroFill(~~(offset) % 60, 2);
        });
    }

    offset('Z', ':');
    offset('ZZ', '');

    // PARSING

    addRegexToken('Z',  matchShortOffset);
    addRegexToken('ZZ', matchShortOffset);
    addParseToken(['Z', 'ZZ'], function (input, array, config) {
        config._useUTC = true;
        config._tzm = offsetFromString(matchShortOffset, input);
    });

    // HELPERS

    // timezone chunker
    // '+10:00' > ['10',  '00']
    // '-1530'  > ['-15', '30']
    var chunkOffset = /([\+\-]|\d\d)/gi;

    function offsetFromString(matcher, string) {
        var matches = ((string || '').match(matcher) || []);
        var chunk   = matches[matches.length - 1] || [];
        var parts   = (chunk + '').match(chunkOffset) || ['-', 0, 0];
        var minutes = +(parts[1] * 60) + toInt(parts[2]);

        return parts[0] === '+' ? minutes : -minutes;
    }

    // Return a moment from input, that is local/utc/zone equivalent to model.
    function cloneWithOffset(input, model) {
        var res, diff;
        if (model._isUTC) {
            res = model.clone();
            diff = (isMoment(input) || isDate(input) ? +input : +local__createLocal(input)) - (+res);
            // Use low-level api, because this fn is low-level api.
            res._d.setTime(+res._d + diff);
            utils_hooks__hooks.updateOffset(res, false);
            return res;
        } else {
            return local__createLocal(input).local();
        }
    }

    function getDateOffset (m) {
        // On Firefox.24 Date#getTimezoneOffset returns a floating point.
        // https://github.com/moment/moment/pull/1871
        return -Math.round(m._d.getTimezoneOffset() / 15) * 15;
    }

    // HOOKS

    // This function will be called whenever a moment is mutated.
    // It is intended to keep the offset in sync with the timezone.
    utils_hooks__hooks.updateOffset = function () {};

    // MOMENTS

    // keepLocalTime = true means only change the timezone, without
    // affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->
    // 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset
    // +0200, so we adjust the time as needed, to be valid.
    //
    // Keeping the time actually adds/subtracts (one hour)
    // from the actual represented time. That is why we call updateOffset
    // a second time. In case it wants us to change the offset again
    // _changeInProgress == true case, then we have to adjust, because
    // there is no such time in the given timezone.
    function getSetOffset (input, keepLocalTime) {
        var offset = this._offset || 0,
            localAdjust;
        if (!this.isValid()) {
            return input != null ? this : NaN;
        }
        if (input != null) {
            if (typeof input === 'string') {
                input = offsetFromString(matchShortOffset, input);
            } else if (Math.abs(input) < 16) {
                input = input * 60;
            }
            if (!this._isUTC && keepLocalTime) {
                localAdjust = getDateOffset(this);
            }
            this._offset = input;
            this._isUTC = true;
            if (localAdjust != null) {
                this.add(localAdjust, 'm');
            }
            if (offset !== input) {
                if (!keepLocalTime || this._changeInProgress) {
                    add_subtract__addSubtract(this, create__createDuration(input - offset, 'm'), 1, false);
                } else if (!this._changeInProgress) {
                    this._changeInProgress = true;
                    utils_hooks__hooks.updateOffset(this, true);
                    this._changeInProgress = null;
                }
            }
            return this;
        } else {
            return this._isUTC ? offset : getDateOffset(this);
        }
    }

    function getSetZone (input, keepLocalTime) {
        if (input != null) {
            if (typeof input !== 'string') {
                input = -input;
            }

            this.utcOffset(input, keepLocalTime);

            return this;
        } else {
            return -this.utcOffset();
        }
    }

    function setOffsetToUTC (keepLocalTime) {
        return this.utcOffset(0, keepLocalTime);
    }

    function setOffsetToLocal (keepLocalTime) {
        if (this._isUTC) {
            this.utcOffset(0, keepLocalTime);
            this._isUTC = false;

            if (keepLocalTime) {
                this.subtract(getDateOffset(this), 'm');
            }
        }
        return this;
    }

    function setOffsetToParsedOffset () {
        if (this._tzm) {
            this.utcOffset(this._tzm);
        } else if (typeof this._i === 'string') {
            this.utcOffset(offsetFromString(matchOffset, this._i));
        }
        return this;
    }

    function hasAlignedHourOffset (input) {
        if (!this.isValid()) {
            return false;
        }
        input = input ? local__createLocal(input).utcOffset() : 0;

        return (this.utcOffset() - input) % 60 === 0;
    }

    function isDaylightSavingTime () {
        return (
            this.utcOffset() > this.clone().month(0).utcOffset() ||
            this.utcOffset() > this.clone().month(5).utcOffset()
        );
    }

    function isDaylightSavingTimeShifted () {
        if (!isUndefined(this._isDSTShifted)) {
            return this._isDSTShifted;
        }

        var c = {};

        copyConfig(c, this);
        c = prepareConfig(c);

        if (c._a) {
            var other = c._isUTC ? create_utc__createUTC(c._a) : local__createLocal(c._a);
            this._isDSTShifted = this.isValid() &&
                compareArrays(c._a, other.toArray()) > 0;
        } else {
            this._isDSTShifted = false;
        }

        return this._isDSTShifted;
    }

    function isLocal () {
        return this.isValid() ? !this._isUTC : false;
    }

    function isUtcOffset () {
        return this.isValid() ? this._isUTC : false;
    }

    function isUtc () {
        return this.isValid() ? this._isUTC && this._offset === 0 : false;
    }

    // ASP.NET json date format regex
    var aspNetRegex = /^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/;

    // from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html
    // somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere
    var isoRegex = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;

    function create__createDuration (input, key) {
        var duration = input,
            // matching against regexp is expensive, do it on demand
            match = null,
            sign,
            ret,
            diffRes;

        if (isDuration(input)) {
            duration = {
                ms : input._milliseconds,
                d  : input._days,
                M  : input._months
            };
        } else if (typeof input === 'number') {
            duration = {};
            if (key) {
                duration[key] = input;
            } else {
                duration.milliseconds = input;
            }
        } else if (!!(match = aspNetRegex.exec(input))) {
            sign = (match[1] === '-') ? -1 : 1;
            duration = {
                y  : 0,
                d  : toInt(match[DATE])        * sign,
                h  : toInt(match[HOUR])        * sign,
                m  : toInt(match[MINUTE])      * sign,
                s  : toInt(match[SECOND])      * sign,
                ms : toInt(match[MILLISECOND]) * sign
            };
        } else if (!!(match = isoRegex.exec(input))) {
            sign = (match[1] === '-') ? -1 : 1;
            duration = {
                y : parseIso(match[2], sign),
                M : parseIso(match[3], sign),
                d : parseIso(match[4], sign),
                h : parseIso(match[5], sign),
                m : parseIso(match[6], sign),
                s : parseIso(match[7], sign),
                w : parseIso(match[8], sign)
            };
        } else if (duration == null) {// checks for null or undefined
            duration = {};
        } else if (typeof duration === 'object' && ('from' in duration || 'to' in duration)) {
            diffRes = momentsDifference(local__createLocal(duration.from), local__createLocal(duration.to));

            duration = {};
            duration.ms = diffRes.milliseconds;
            duration.M = diffRes.months;
        }

        ret = new Duration(duration);

        if (isDuration(input) && hasOwnProp(input, '_locale')) {
            ret._locale = input._locale;
        }

        return ret;
    }

    create__createDuration.fn = Duration.prototype;

    function parseIso (inp, sign) {
        // We'd normally use ~~inp for this, but unfortunately it also
        // converts floats to ints.
        // inp may be undefined, so careful calling replace on it.
        var res = inp && parseFloat(inp.replace(',', '.'));
        // apply sign while we're at it
        return (isNaN(res) ? 0 : res) * sign;
    }

    function positiveMomentsDifference(base, other) {
        var res = {milliseconds: 0, months: 0};

        res.months = other.month() - base.month() +
            (other.year() - base.year()) * 12;
        if (base.clone().add(res.months, 'M').isAfter(other)) {
            --res.months;
        }

        res.milliseconds = +other - +(base.clone().add(res.months, 'M'));

        return res;
    }

    function momentsDifference(base, other) {
        var res;
        if (!(base.isValid() && other.isValid())) {
            return {milliseconds: 0, months: 0};
        }

        other = cloneWithOffset(other, base);
        if (base.isBefore(other)) {
            res = positiveMomentsDifference(base, other);
        } else {
            res = positiveMomentsDifference(other, base);
            res.milliseconds = -res.milliseconds;
            res.months = -res.months;
        }

        return res;
    }

    // TODO: remove 'name' arg after deprecation is removed
    function createAdder(direction, name) {
        return function (val, period) {
            var dur, tmp;
            //invert the arguments, but complain about it
            if (period !== null && !isNaN(+period)) {
                deprecateSimple(name, 'moment().' + name  + '(period, number) is deprecated. Please use moment().' + name + '(number, period).');
                tmp = val; val = period; period = tmp;
            }

            val = typeof val === 'string' ? +val : val;
            dur = create__createDuration(val, period);
            add_subtract__addSubtract(this, dur, direction);
            return this;
        };
    }

    function add_subtract__addSubtract (mom, duration, isAdding, updateOffset) {
        var milliseconds = duration._milliseconds,
            days = duration._days,
            months = duration._months;

        if (!mom.isValid()) {
            // No op
            return;
        }

        updateOffset = updateOffset == null ? true : updateOffset;

        if (milliseconds) {
            mom._d.setTime(+mom._d + milliseconds * isAdding);
        }
        if (days) {
            get_set__set(mom, 'Date', get_set__get(mom, 'Date') + days * isAdding);
        }
        if (months) {
            setMonth(mom, get_set__get(mom, 'Month') + months * isAdding);
        }
        if (updateOffset) {
            utils_hooks__hooks.updateOffset(mom, days || months);
        }
    }

    var add_subtract__add      = createAdder(1, 'add');
    var add_subtract__subtract = createAdder(-1, 'subtract');

    function moment_calendar__calendar (time, formats) {
        // We want to compare the start of today, vs this.
        // Getting start-of-today depends on whether we're local/utc/offset or not.
        var now = time || local__createLocal(),
            sod = cloneWithOffset(now, this).startOf('day'),
            diff = this.diff(sod, 'days', true),
            format = diff < -6 ? 'sameElse' :
                diff < -1 ? 'lastWeek' :
                diff < 0 ? 'lastDay' :
                diff < 1 ? 'sameDay' :
                diff < 2 ? 'nextDay' :
                diff < 7 ? 'nextWeek' : 'sameElse';

        var output = formats && (isFunction(formats[format]) ? formats[format]() : formats[format]);

        return this.format(output || this.localeData().calendar(format, this, local__createLocal(now)));
    }

    function clone () {
        return new ConfiMoment(this);
    }

    function isAfter (input, units) {
        var localInput = isMoment(input) ? input : local__createLocal(input);
        if (!(this.isValid() && localInput.isValid())) {
            return false;
        }
        units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');
        if (units === 'millisecond') {
            return +this > +localInput;
        } else {
            return +localInput < +this.clone().startOf(units);
        }
    }

    function isBefore (input, units) {
        var localInput = isMoment(input) ? input : local__createLocal(input);
        if (!(this.isValid() && localInput.isValid())) {
            return false;
        }
        units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');
        if (units === 'millisecond') {
            return +this < +localInput;
        } else {
            return +this.clone().endOf(units) < +localInput;
        }
    }

    function isBetween (from, to, units) {
        return this.isAfter(from, units) && this.isBefore(to, units);
    }

    function isSame (input, units) {
        var localInput = isMoment(input) ? input : local__createLocal(input),
            inputMs;
        if (!(this.isValid() && localInput.isValid())) {
            return false;
        }
        units = normalizeUnits(units || 'millisecond');
        if (units === 'millisecond') {
            return +this === +localInput;
        } else {
            inputMs = +localInput;
            return +(this.clone().startOf(units)) <= inputMs && inputMs <= +(this.clone().endOf(units));
        }
    }

    function isSameOrAfter (input, units) {
        return this.isSame(input, units) || this.isAfter(input,units);
    }

    function isSameOrBefore (input, units) {
        return this.isSame(input, units) || this.isBefore(input,units);
    }

    function diff (input, units, asFloat) {
        var that,
            zoneDelta,
            delta, output;

        if (!this.isValid()) {
            return NaN;
        }

        that = cloneWithOffset(input, this);

        if (!that.isValid()) {
            return NaN;
        }

        zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;

        units = normalizeUnits(units);

        if (units === 'year' || units === 'month' || units === 'quarter') {
            output = monthDiff(this, that);
            if (units === 'quarter') {
                output = output / 3;
            } else if (units === 'year') {
                output = output / 12;
            }
        } else {
            delta = this - that;
            output = units === 'second' ? delta / 1e3 : // 1000
                units === 'minute' ? delta / 6e4 : // 1000 * 60
                units === 'hour' ? delta / 36e5 : // 1000 * 60 * 60
                units === 'day' ? (delta - zoneDelta) / 864e5 : // 1000 * 60 * 60 * 24, negate dst
                units === 'week' ? (delta - zoneDelta) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst
                delta;
        }
        return asFloat ? output : absFloor(output);
    }

    function monthDiff (a, b) {
        // difference in months
        var wholeMonthDiff = ((b.year() - a.year()) * 12) + (b.month() - a.month()),
            // b is in (anchor - 1 month, anchor + 1 month)
            anchor = a.clone().add(wholeMonthDiff, 'months'),
            anchor2, adjust;

        if (b - anchor < 0) {
            anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');
            // linear across the month
            adjust = (b - anchor) / (anchor - anchor2);
        } else {
            anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');
            // linear across the month
            adjust = (b - anchor) / (anchor2 - anchor);
        }

        return -(wholeMonthDiff + adjust);
    }

    utils_hooks__hooks.defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';

    function toString () {
        return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');
    }

    function moment_format__toISOString () {
        var m = this.clone().utc();
        if (0 < m.year() && m.year() <= 9999) {
            if (isFunction(Date.prototype.toISOString)) {
                // native implementation is ~50x faster, use it when we can
                return this.toDate().toISOString();
            } else {
                return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
            }
        } else {
            return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
        }
    }

    function format (inputString) {
        var output = formatMoment(this, inputString || utils_hooks__hooks.defaultFormat);
        return this.localeData().postformat(output);
    }

    function from (time, withoutSuffix) {
        if (this.isValid() &&
                ((isMoment(time) && time.isValid()) ||
                 local__createLocal(time).isValid())) {
            return create__createDuration({to: this, from: time}).locale(this.locale()).humanize(!withoutSuffix);
        } else {
            return this.localeData().invalidDate();
        }
    }

    function fromNow (withoutSuffix) {
        return this.from(local__createLocal(), withoutSuffix);
    }

    function to (time, withoutSuffix) {
        if (this.isValid() &&
                ((isMoment(time) && time.isValid()) ||
                 local__createLocal(time).isValid())) {
            return create__createDuration({from: this, to: time}).locale(this.locale()).humanize(!withoutSuffix);
        } else {
            return this.localeData().invalidDate();
        }
    }

    function toNow (withoutSuffix) {
        return this.to(local__createLocal(), withoutSuffix);
    }

    // If passed a locale key, it will set the locale for this
    // instance.  Otherwise, it will return the locale configuration
    // variables for this instance.
    function locale (key) {
        var newLocaleData;

        if (key === undefined) {
            return this._locale._abbr;
        } else {
            newLocaleData = locale_locales__getLocale(key);
            if (newLocaleData != null) {
                this._locale = newLocaleData;
            }
            return this;
        }
    }

    var lang = deprecate(
        'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',
        function (key) {
            if (key === undefined) {
                return this.localeData();
            } else {
                return this.locale(key);
            }
        }
    );

    function localeData () {
        return this._locale;
    }

    function startOf (units) {
        units = normalizeUnits(units);
        // the following switch intentionally omits break keywords
        // to utilize falling through the cases.
        switch (units) {
        case 'year':
            this.month(0);
            /* falls through */
        case 'quarter':
        case 'month':
            this.date(1);
            /* falls through */
        case 'week':
        case 'isoWeek':
        case 'day':
            this.hours(0);
            /* falls through */
        case 'hour':
            this.minutes(0);
            /* falls through */
        case 'minute':
            this.seconds(0);
            /* falls through */
        case 'second':
            this.milliseconds(0);
        }

        // weeks are a special case
        if (units === 'week') {
            this.weekday(0);
        }
        if (units === 'isoWeek') {
            this.isoWeekday(1);
        }

        // quarters are also special
        if (units === 'quarter') {
            this.month(Math.floor(this.month() / 3) * 3);
        }

        return this;
    }

    function endOf (units) {
        units = normalizeUnits(units);
        if (units === undefined || units === 'millisecond') {
            return this;
        }
        return this.startOf(units).add(1, (units === 'isoWeek' ? 'week' : units)).subtract(1, 'ms');
    }

    function to_type__valueOf () {
        return +this._d - ((this._offset || 0) * 60000);
    }

    function unix () {
        return Math.floor(+this / 1000);
    }

    function toDate () {
        return this._offset ? new Date(+this) : this._d;
    }

    function toArray () {
        var m = this;
        return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];
    }

    function toObject () {
        var m = this;
        return {
            years: m.year(),
            months: m.month(),
            date: m.date(),
            hours: m.hours(),
            minutes: m.minutes(),
            seconds: m.seconds(),
            milliseconds: m.milliseconds()
        };
    }

    function toJSON () {
        // JSON.stringify(new Date(NaN)) === 'null'
        return this.isValid() ? this.toISOString() : 'null';
    }

    function moment_valid__isValid () {
        return valid__isValid(this);
    }

    function parsingFlags () {
        return extend({}, getParsingFlags(this));
    }

    function invalidAt () {
        return getParsingFlags(this).overflow;
    }

    function creationData() {
        return {
            input: this._i,
            format: this._f,
            locale: this._locale,
            isUTC: this._isUTC,
            strict: this._strict
        };
    }

    // FORMATTING

    addFormatToken(0, ['gg', 2], 0, function () {
        return this.weekYear() % 100;
    });

    addFormatToken(0, ['GG', 2], 0, function () {
        return this.isoWeekYear() % 100;
    });

    function addWeekYearFormatToken (token, getter) {
        addFormatToken(0, [token, token.length], 0, getter);
    }

    addWeekYearFormatToken('gggg',     'weekYear');
    addWeekYearFormatToken('ggggg',    'weekYear');
    addWeekYearFormatToken('GGGG',  'isoWeekYear');
    addWeekYearFormatToken('GGGGG', 'isoWeekYear');

    // ALIASES

    addUnitAlias('weekYear', 'gg');
    addUnitAlias('isoWeekYear', 'GG');

    // PARSING

    addRegexToken('G',      matchSigned);
    addRegexToken('g',      matchSigned);
    addRegexToken('GG',     match1to2, match2);
    addRegexToken('gg',     match1to2, match2);
    addRegexToken('GGGG',   match1to4, match4);
    addRegexToken('gggg',   match1to4, match4);
    addRegexToken('GGGGG',  match1to6, match6);
    addRegexToken('ggggg',  match1to6, match6);

    addWeekParseToken(['gggg', 'ggggg', 'GGGG', 'GGGGG'], function (input, week, config, token) {
        week[token.substr(0, 2)] = toInt(input);
    });

    addWeekParseToken(['gg', 'GG'], function (input, week, config, token) {
        week[token] = utils_hooks__hooks.parseTwoDigitYear(input);
    });

    // MOMENTS

    function getSetWeekYear (input) {
        return getSetWeekYearHelper.call(this,
                input,
                this.week(),
                this.weekday(),
                this.localeData()._week.dow,
                this.localeData()._week.doy);
    }

    function getSetISOWeekYear (input) {
        return getSetWeekYearHelper.call(this,
                input, this.isoWeek(), this.isoWeekday(), 1, 4);
    }

    function getISOWeeksInYear () {
        return weeksInYear(this.year(), 1, 4);
    }

    function getWeeksInYear () {
        var weekInfo = this.localeData()._week;
        return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);
    }

    function getSetWeekYearHelper(input, week, weekday, dow, doy) {
        var weeksTarget;
        if (input == null) {
            return weekOfYear(this, dow, doy).year;
        } else {
            weeksTarget = weeksInYear(input, dow, doy);
            if (week > weeksTarget) {
                week = weeksTarget;
            }
            return setWeekAll.call(this, input, week, weekday, dow, doy);
        }
    }

    function setWeekAll(weekYear, week, weekday, dow, doy) {
        var dayOfYearData = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy),
            date = createUTCDate(dayOfYearData.year, 0, dayOfYearData.dayOfYear);

        // console.log("got", weekYear, week, weekday, "set", date.toISOString());
        this.year(date.getUTCFullYear());
        this.month(date.getUTCMonth());
        this.date(date.getUTCDate());
        return this;
    }

    // FORMATTING

    addFormatToken('Q', 0, 'Qo', 'quarter');

    // ALIASES

    addUnitAlias('quarter', 'Q');

    // PARSING

    addRegexToken('Q', match1);
    addParseToken('Q', function (input, array) {
        array[MONTH] = (toInt(input) - 1) * 3;
    });

    // MOMENTS

    function getSetQuarter (input) {
        return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);
    }

    // FORMATTING

    addFormatToken('w', ['ww', 2], 'wo', 'week');
    addFormatToken('W', ['WW', 2], 'Wo', 'isoWeek');

    // ALIASES

    addUnitAlias('week', 'w');
    addUnitAlias('isoWeek', 'W');

    // PARSING

    addRegexToken('w',  match1to2);
    addRegexToken('ww', match1to2, match2);
    addRegexToken('W',  match1to2);
    addRegexToken('WW', match1to2, match2);

    addWeekParseToken(['w', 'ww', 'W', 'WW'], function (input, week, config, token) {
        week[token.substr(0, 1)] = toInt(input);
    });

    // HELPERS

    // LOCALES

    function localeWeek (mom) {
        return weekOfYear(mom, this._week.dow, this._week.doy).week;
    }

    var defaultLocaleWeek = {
        dow : 0, // Sunday is the first day of the week.
        doy : 6  // The week that contains Jan 1st is the first week of the year.
    };

    function localeFirstDayOfWeek () {
        return this._week.dow;
    }

    function localeFirstDayOfYear () {
        return this._week.doy;
    }

    // MOMENTS

    function getSetWeek (input) {
        var week = this.localeData().week(this);
        return input == null ? week : this.add((input - week) * 7, 'd');
    }

    function getSetISOWeek (input) {
        var week = weekOfYear(this, 1, 4).week;
        return input == null ? week : this.add((input - week) * 7, 'd');
    }

    // FORMATTING

    addFormatToken('D', ['DD', 2], 'Do', 'date');

    // ALIASES

    addUnitAlias('date', 'D');

    // PARSING

    addRegexToken('D',  match1to2);
    addRegexToken('DD', match1to2, match2);
    addRegexToken('Do', function (isStrict, locale) {
        return isStrict ? locale._ordinalParse : locale._ordinalParseLenient;
    });

    addParseToken(['D', 'DD'], DATE);
    addParseToken('Do', function (input, array) {
        array[DATE] = toInt(input.match(match1to2)[0], 10);
    });

    // MOMENTS

    var getSetDayOfMonth = makeGetSet('Date', true);

    // FORMATTING

    addFormatToken('d', 0, 'do', 'day');

    addFormatToken('dd', 0, 0, function (format) {
        return this.localeData().weekdaysMin(this, format);
    });

    addFormatToken('ddd', 0, 0, function (format) {
        return this.localeData().weekdaysShort(this, format);
    });

    addFormatToken('dddd', 0, 0, function (format) {
        return this.localeData().weekdays(this, format);
    });

    addFormatToken('e', 0, 0, 'weekday');
    addFormatToken('E', 0, 0, 'isoWeekday');

    // ALIASES

    addUnitAlias('day', 'd');
    addUnitAlias('weekday', 'e');
    addUnitAlias('isoWeekday', 'E');

    // PARSING

    addRegexToken('d',    match1to2);
    addRegexToken('e',    match1to2);
    addRegexToken('E',    match1to2);
    addRegexToken('dd',   matchWord);
    addRegexToken('ddd',  matchWord);
    addRegexToken('dddd', matchWord);

    addWeekParseToken(['dd', 'ddd', 'dddd'], function (input, week, config, token) {
        var weekday = config._locale.weekdaysParse(input, token, config._strict);
        // if we didn't get a weekday name, mark the date as invalid
        if (weekday != null) {
            week.d = weekday;
        } else {
            getParsingFlags(config).invalidWeekday = input;
        }
    });

    addWeekParseToken(['d', 'e', 'E'], function (input, week, config, token) {
        week[token] = toInt(input);
    });

    // HELPERS

    function parseWeekday(input, locale) {
        if (typeof input !== 'string') {
            return input;
        }

        if (!isNaN(input)) {
            return parseInt(input, 10);
        }

        input = locale.weekdaysParse(input);
        if (typeof input === 'number') {
            return input;
        }

        return null;
    }

    // LOCALES

    var defaultLocaleWeekdays = 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');
    function localeWeekdays (m, format) {
        return isArray(this._weekdays) ? this._weekdays[m.day()] :
            this._weekdays[this._weekdays.isFormat.test(format) ? 'format' : 'standalone'][m.day()];
    }

    var defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');
    function localeWeekdaysShort (m) {
        return this._weekdaysShort[m.day()];
    }

    var defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_');
    function localeWeekdaysMin (m) {
        return this._weekdaysMin[m.day()];
    }

    function localeWeekdaysParse (weekdayName, format, strict) {
        var i, mom, regex;

        if (!this._weekdaysParse) {
            this._weekdaysParse = [];
            this._minWeekdaysParse = [];
            this._shortWeekdaysParse = [];
            this._fullWeekdaysParse = [];
        }

        for (i = 0; i < 7; i++) {
            // make the regex if we don't have it already

            mom = local__createLocal([2000, 1]).day(i);
            if (strict && !this._fullWeekdaysParse[i]) {
                this._fullWeekdaysParse[i] = new RegExp('^' + this.weekdays(mom, '').replace('.', '\.?') + '$', 'i');
                this._shortWeekdaysParse[i] = new RegExp('^' + this.weekdaysShort(mom, '').replace('.', '\.?') + '$', 'i');
                this._minWeekdaysParse[i] = new RegExp('^' + this.weekdaysMin(mom, '').replace('.', '\.?') + '$', 'i');
            }
            if (!this._weekdaysParse[i]) {
                regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');
                this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');
            }
            // test the regex
            if (strict && format === 'dddd' && this._fullWeekdaysParse[i].test(weekdayName)) {
                return i;
            } else if (strict && format === 'ddd' && this._shortWeekdaysParse[i].test(weekdayName)) {
                return i;
            } else if (strict && format === 'dd' && this._minWeekdaysParse[i].test(weekdayName)) {
                return i;
            } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {
                return i;
            }
        }
    }

    // MOMENTS

    function getSetDayOfWeek (input) {
        if (!this.isValid()) {
            return input != null ? this : NaN;
        }
        var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
        if (input != null) {
            input = parseWeekday(input, this.localeData());
            return this.add(input - day, 'd');
        } else {
            return day;
        }
    }

    function getSetLocaleDayOfWeek (input) {
        if (!this.isValid()) {
            return input != null ? this : NaN;
        }
        var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;
        return input == null ? weekday : this.add(input - weekday, 'd');
    }

    function getSetISODayOfWeek (input) {
        if (!this.isValid()) {
            return input != null ? this : NaN;
        }
        // behaves the same as moment#day except
        // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)
        // as a setter, sunday should belong to the previous week.
        return input == null ? this.day() || 7 : this.day(this.day() % 7 ? input : input - 7);
    }

    // FORMATTING

    addFormatToken('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');

    // ALIASES

    addUnitAlias('dayOfYear', 'DDD');

    // PARSING

    addRegexToken('DDD',  match1to3);
    addRegexToken('DDDD', match3);
    addParseToken(['DDD', 'DDDD'], function (input, array, config) {
        config._dayOfYear = toInt(input);
    });

    // HELPERS

    // MOMENTS

    function getSetDayOfYear (input) {
        var dayOfYear = Math.round((this.clone().startOf('day') - this.clone().startOf('year')) / 864e5) + 1;
        return input == null ? dayOfYear : this.add((input - dayOfYear), 'd');
    }

    // FORMATTING

    function hFormat() {
        return this.hours() % 12 || 12;
    }

    addFormatToken('H', ['HH', 2], 0, 'hour');
    addFormatToken('h', ['hh', 2], 0, hFormat);

    addFormatToken('hmm', 0, 0, function () {
        return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2);
    });

    addFormatToken('hmmss', 0, 0, function () {
        return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2) +
            zeroFill(this.seconds(), 2);
    });

    addFormatToken('Hmm', 0, 0, function () {
        return '' + this.hours() + zeroFill(this.minutes(), 2);
    });

    addFormatToken('Hmmss', 0, 0, function () {
        return '' + this.hours() + zeroFill(this.minutes(), 2) +
            zeroFill(this.seconds(), 2);
    });

    function meridiem (token, lowercase) {
        addFormatToken(token, 0, 0, function () {
            return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);
        });
    }

    meridiem('a', true);
    meridiem('A', false);

    // ALIASES

    addUnitAlias('hour', 'h');

    // PARSING

    function matchMeridiem (isStrict, locale) {
        return locale._meridiemParse;
    }

    addRegexToken('a',  matchMeridiem);
    addRegexToken('A',  matchMeridiem);
    addRegexToken('H',  match1to2);
    addRegexToken('h',  match1to2);
    addRegexToken('HH', match1to2, match2);
    addRegexToken('hh', match1to2, match2);

    addRegexToken('hmm', match3to4);
    addRegexToken('hmmss', match5to6);
    addRegexToken('Hmm', match3to4);
    addRegexToken('Hmmss', match5to6);

    addParseToken(['H', 'HH'], HOUR);
    addParseToken(['a', 'A'], function (input, array, config) {
        config._isPm = config._locale.isPM(input);
        config._meridiem = input;
    });
    addParseToken(['h', 'hh'], function (input, array, config) {
        array[HOUR] = toInt(input);
        getParsingFlags(config).bigHour = true;
    });
    addParseToken('hmm', function (input, array, config) {
        var pos = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos));
        array[MINUTE] = toInt(input.substr(pos));
        getParsingFlags(config).bigHour = true;
    });
    addParseToken('hmmss', function (input, array, config) {
        var pos1 = input.length - 4;
        var pos2 = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos1));
        array[MINUTE] = toInt(input.substr(pos1, 2));
        array[SECOND] = toInt(input.substr(pos2));
        getParsingFlags(config).bigHour = true;
    });
    addParseToken('Hmm', function (input, array, config) {
        var pos = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos));
        array[MINUTE] = toInt(input.substr(pos));
    });
    addParseToken('Hmmss', function (input, array, config) {
        var pos1 = input.length - 4;
        var pos2 = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos1));
        array[MINUTE] = toInt(input.substr(pos1, 2));
        array[SECOND] = toInt(input.substr(pos2));
    });

    // LOCALES

    function localeIsPM (input) {
        // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays
        // Using charAt should be more compatible.
        return ((input + '').toLowerCase().charAt(0) === 'p');
    }

    var defaultLocaleMeridiemParse = /[ap]\.?m?\.?/i;
    function localeMeridiem (hours, minutes, isLower) {
        if (hours > 11) {
            return isLower ? 'pm' : 'PM';
        } else {
            return isLower ? 'am' : 'AM';
        }
    }


    // MOMENTS

    // Setting the hour should keep the time, because the user explicitly
    // specified which hour he wants. So trying to maintain the same hour (in
    // a new timezone) makes sense. Adding/subtracting hours does not follow
    // this rule.
    var getSetHour = makeGetSet('Hours', true);

    // FORMATTING

    addFormatToken('m', ['mm', 2], 0, 'minute');

    // ALIASES

    addUnitAlias('minute', 'm');

    // PARSING

    addRegexToken('m',  match1to2);
    addRegexToken('mm', match1to2, match2);
    addParseToken(['m', 'mm'], MINUTE);

    // MOMENTS

    var getSetMinute = makeGetSet('Minutes', false);

    // FORMATTING

    addFormatToken('s', ['ss', 2], 0, 'second');

    // ALIASES

    addUnitAlias('second', 's');

    // PARSING

    addRegexToken('s',  match1to2);
    addRegexToken('ss', match1to2, match2);
    addParseToken(['s', 'ss'], SECOND);

    // MOMENTS

    var getSetSecond = makeGetSet('Seconds', false);

    // FORMATTING

    addFormatToken('S', 0, 0, function () {
        return ~~(this.millisecond() / 100);
    });

    addFormatToken(0, ['SS', 2], 0, function () {
        return ~~(this.millisecond() / 10);
    });

    addFormatToken(0, ['SSS', 3], 0, 'millisecond');
    addFormatToken(0, ['SSSS', 4], 0, function () {
        return this.millisecond() * 10;
    });
    addFormatToken(0, ['SSSSS', 5], 0, function () {
        return this.millisecond() * 100;
    });
    addFormatToken(0, ['SSSSSS', 6], 0, function () {
        return this.millisecond() * 1000;
    });
    addFormatToken(0, ['SSSSSSS', 7], 0, function () {
        return this.millisecond() * 10000;
    });
    addFormatToken(0, ['SSSSSSSS', 8], 0, function () {
        return this.millisecond() * 100000;
    });
    addFormatToken(0, ['SSSSSSSSS', 9], 0, function () {
        return this.millisecond() * 1000000;
    });


    // ALIASES

    addUnitAlias('millisecond', 'ms');

    // PARSING

    addRegexToken('S',    match1to3, match1);
    addRegexToken('SS',   match1to3, match2);
    addRegexToken('SSS',  match1to3, match3);

    var token;
    for (token = 'SSSS'; token.length <= 9; token += 'S') {
        addRegexToken(token, matchUnsigned);
    }

    function parseMs(input, array) {
        array[MILLISECOND] = toInt(('0.' + input) * 1000);
    }

    for (token = 'S'; token.length <= 9; token += 'S') {
        addParseToken(token, parseMs);
    }
    // MOMENTS

    var getSetMillisecond = makeGetSet('Milliseconds', false);

    // FORMATTING

    addFormatToken('z',  0, 0, 'zoneAbbr');
    addFormatToken('zz', 0, 0, 'zoneName');

    // MOMENTS

    function getZoneAbbr () {
        return this._isUTC ? 'UTC' : '';
    }

    function getZoneName () {
        return this._isUTC ? 'Coordinated Universal Time' : '';
    }

    var confimomentPrototype__proto = ConfiMoment.prototype;

    confimomentPrototype__proto.add               = add_subtract__add;
    confimomentPrototype__proto.calendar          = moment_calendar__calendar;
    confimomentPrototype__proto.clone             = clone;
    confimomentPrototype__proto.diff              = diff;
    confimomentPrototype__proto.endOf             = endOf;
    confimomentPrototype__proto.format            = format;
    confimomentPrototype__proto.from              = from;
    confimomentPrototype__proto.fromNow           = fromNow;
    confimomentPrototype__proto.to                = to;
    confimomentPrototype__proto.toNow             = toNow;
    confimomentPrototype__proto.get               = getSet;
    confimomentPrototype__proto.invalidAt         = invalidAt;
    confimomentPrototype__proto.isAfter           = isAfter;
    confimomentPrototype__proto.isBefore          = isBefore;
    confimomentPrototype__proto.isBetween         = isBetween;
    confimomentPrototype__proto.isSame            = isSame;
    confimomentPrototype__proto.isSameOrAfter     = isSameOrAfter;
    confimomentPrototype__proto.isSameOrBefore    = isSameOrBefore;
    confimomentPrototype__proto.isValid           = moment_valid__isValid;
    confimomentPrototype__proto.lang              = lang;
    confimomentPrototype__proto.locale            = locale;
    confimomentPrototype__proto.localeData        = localeData;
    confimomentPrototype__proto.max               = prototypeMax;
    confimomentPrototype__proto.min               = prototypeMin;
    confimomentPrototype__proto.parsingFlags      = parsingFlags;
    confimomentPrototype__proto.set               = getSet;
    confimomentPrototype__proto.startOf           = startOf;
    confimomentPrototype__proto.subtract          = add_subtract__subtract;
    confimomentPrototype__proto.toArray           = toArray;
    confimomentPrototype__proto.toObject          = toObject;
    confimomentPrototype__proto.toDate            = toDate;
    confimomentPrototype__proto.toISOString       = moment_format__toISOString;
    confimomentPrototype__proto.toJSON            = toJSON;
    confimomentPrototype__proto.toString          = toString;
    confimomentPrototype__proto.unix              = unix;
    confimomentPrototype__proto.valueOf           = to_type__valueOf;
    confimomentPrototype__proto.creationData      = creationData;

    // Year
    confimomentPrototype__proto.year       = getSetYear;
    confimomentPrototype__proto.isLeapYear = getIsLeapYear;

    // Week Year
    confimomentPrototype__proto.weekYear    = getSetWeekYear;
    confimomentPrototype__proto.isoWeekYear = getSetISOWeekYear;

    // Quarter
    confimomentPrototype__proto.quarter = confimomentPrototype__proto.quarters = getSetQuarter;

    // Month
    confimomentPrototype__proto.month       = getSetMonth;
    confimomentPrototype__proto.daysInMonth = getDaysInMonth;

    // Week
    confimomentPrototype__proto.week           = confimomentPrototype__proto.weeks        = getSetWeek;
    confimomentPrototype__proto.isoWeek        = confimomentPrototype__proto.isoWeeks     = getSetISOWeek;
    confimomentPrototype__proto.weeksInYear    = getWeeksInYear;
    confimomentPrototype__proto.isoWeeksInYear = getISOWeeksInYear;

    // Day
    confimomentPrototype__proto.date       = getSetDayOfMonth;
    confimomentPrototype__proto.day        = confimomentPrototype__proto.days             = getSetDayOfWeek;
    confimomentPrototype__proto.weekday    = getSetLocaleDayOfWeek;
    confimomentPrototype__proto.isoWeekday = getSetISODayOfWeek;
    confimomentPrototype__proto.dayOfYear  = getSetDayOfYear;

    // Hour
    confimomentPrototype__proto.hour = confimomentPrototype__proto.hours = getSetHour;

    // Minute
    confimomentPrototype__proto.minute = confimomentPrototype__proto.minutes = getSetMinute;

    // Second
    confimomentPrototype__proto.second = confimomentPrototype__proto.seconds = getSetSecond;

    // Millisecond
    confimomentPrototype__proto.millisecond = confimomentPrototype__proto.milliseconds = getSetMillisecond;

    // Offset
    confimomentPrototype__proto.utcOffset            = getSetOffset;
    confimomentPrototype__proto.utc                  = setOffsetToUTC;
    confimomentPrototype__proto.local                = setOffsetToLocal;
    confimomentPrototype__proto.parseZone            = setOffsetToParsedOffset;
    confimomentPrototype__proto.hasAlignedHourOffset = hasAlignedHourOffset;
    confimomentPrototype__proto.isDST                = isDaylightSavingTime;
    confimomentPrototype__proto.isDSTShifted         = isDaylightSavingTimeShifted;
    confimomentPrototype__proto.isLocal              = isLocal;
    confimomentPrototype__proto.isUtcOffset          = isUtcOffset;
    confimomentPrototype__proto.isUtc                = isUtc;
    confimomentPrototype__proto.isUTC                = isUtc;

    // Timezone
    confimomentPrototype__proto.zoneAbbr = getZoneAbbr;
    confimomentPrototype__proto.zoneName = getZoneName;

    // Deprecations
    confimomentPrototype__proto.dates  = deprecate('dates accessor is deprecated. Use date instead.', getSetDayOfMonth);
    confimomentPrototype__proto.months = deprecate('months accessor is deprecated. Use month instead', getSetMonth);
    confimomentPrototype__proto.years  = deprecate('years accessor is deprecated. Use year instead', getSetYear);
    confimomentPrototype__proto.zone   = deprecate('moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779', getSetZone);

    var confimomentPrototype = confimomentPrototype__proto;

    function moment__createUnix (input) {
        return local__createLocal(input * 1000);
    }

    function moment__createInZone () {
        return local__createLocal.apply(null, arguments).parseZone();
    }

    var defaultCalendar = {
        sameDay : '[Today at] LT',
        nextDay : '[Tomorrow at] LT',
        nextWeek : 'dddd [at] LT',
        lastDay : '[Yesterday at] LT',
        lastWeek : '[Last] dddd [at] LT',
        sameElse : 'L'
    };

    function locale_calendar__calendar (key, mom, now) {
        var output = this._calendar[key];
        return isFunction(output) ? output.call(mom, now) : output;
    }

    var defaultLongDateFormat = {
        LTS  : 'h:mm:ss A',
        LT   : 'h:mm A',
        L    : 'MM/DD/YYYY',
        LL   : 'MMMM D, YYYY',
        LLL  : 'MMMM D, YYYY h:mm A',
        LLLL : 'dddd, MMMM D, YYYY h:mm A'
    };

    function longDateFormat (key) {
        var format = this._longDateFormat[key],
            formatUpper = this._longDateFormat[key.toUpperCase()];

        if (format || !formatUpper) {
            return format;
        }

        this._longDateFormat[key] = formatUpper.replace(/MMMM|MM|DD|dddd/g, function (val) {
            return val.slice(1);
        });

        return this._longDateFormat[key];
    }

    var defaultInvalidDate = 'Invalid date';

    function invalidDate () {
        return this._invalidDate;
    }

    var defaultOrdinal = '%d';
    var defaultOrdinalParse = /\d{1,2}/;

    function ordinal (number) {
        return this._ordinal.replace('%d', number);
    }

    function preParsePostFormat (string) {
        return string;
    }

    var defaultRelativeTime = {
        future : 'in %s',
        past   : '%s ago',
        s  : 'a few seconds',
        m  : 'a minute',
        mm : '%d minutes',
        h  : 'an hour',
        hh : '%d hours',
        d  : 'a day',
        dd : '%d days',
        M  : 'a month',
        MM : '%d months',
        y  : 'a year',
        yy : '%d years'
    };

    function relative__relativeTime (number, withoutSuffix, string, isFuture) {
        var output = this._relativeTime[string];
        return (isFunction(output)) ?
            output(number, withoutSuffix, string, isFuture) :
            output.replace(/%d/i, number);
    }

    function pastFuture (diff, output) {
        var format = this._relativeTime[diff > 0 ? 'future' : 'past'];
        return isFunction(format) ? format(output) : format.replace(/%s/i, output);
    }

    function locale_set__set (config) {
        var prop, i;
        for (i in config) {
            prop = config[i];
            if (isFunction(prop)) {
                this[i] = prop;
            } else {
                this['_' + i] = prop;
            }
        }
        // Lenient ordinal parsing accepts just a number in addition to
        // number + (possibly) stuff coming from _ordinalParseLenient.
        this._ordinalParseLenient = new RegExp(this._ordinalParse.source + '|' + (/\d{1,2}/).source);
    }

    var prototype__proto = Locale.prototype;

    prototype__proto._calendar       = defaultCalendar;
    prototype__proto.calendar        = locale_calendar__calendar;
    prototype__proto._longDateFormat = defaultLongDateFormat;
    prototype__proto.longDateFormat  = longDateFormat;
    prototype__proto._invalidDate    = defaultInvalidDate;
    prototype__proto.invalidDate     = invalidDate;
    prototype__proto._ordinal        = defaultOrdinal;
    prototype__proto.ordinal         = ordinal;
    prototype__proto._ordinalParse   = defaultOrdinalParse;
    prototype__proto.preparse        = preParsePostFormat;
    prototype__proto.postformat      = preParsePostFormat;
    prototype__proto._relativeTime   = defaultRelativeTime;
    prototype__proto.relativeTime    = relative__relativeTime;
    prototype__proto.pastFuture      = pastFuture;
    prototype__proto.set             = locale_set__set;

    // Month
    prototype__proto.months            =        localeMonths;
    prototype__proto._months           = defaultLocaleMonths;
    prototype__proto.monthsShort       =        localeMonthsShort;
    prototype__proto._monthsShort      = defaultLocaleMonthsShort;
    prototype__proto.monthsParse       =        localeMonthsParse;
    prototype__proto._monthsRegex      = defaultMonthsRegex;
    prototype__proto.monthsRegex       = monthsRegex;
    prototype__proto._monthsShortRegex = defaultMonthsShortRegex;
    prototype__proto.monthsShortRegex  = monthsShortRegex;

    // Week
    prototype__proto.week = localeWeek;
    prototype__proto._week = defaultLocaleWeek;
    prototype__proto.firstDayOfYear = localeFirstDayOfYear;
    prototype__proto.firstDayOfWeek = localeFirstDayOfWeek;

    // Day of Week
    prototype__proto.weekdays       =        localeWeekdays;
    prototype__proto._weekdays      = defaultLocaleWeekdays;
    prototype__proto.weekdaysMin    =        localeWeekdaysMin;
    prototype__proto._weekdaysMin   = defaultLocaleWeekdaysMin;
    prototype__proto.weekdaysShort  =        localeWeekdaysShort;
    prototype__proto._weekdaysShort = defaultLocaleWeekdaysShort;
    prototype__proto.weekdaysParse  =        localeWeekdaysParse;

    // Hours
    prototype__proto.isPM = localeIsPM;
    prototype__proto._meridiemParse = defaultLocaleMeridiemParse;
    prototype__proto.meridiem = localeMeridiem;

    function lists__get (format, index, field, setter) {
        var locale = locale_locales__getLocale();
        var utc = create_utc__createUTC().set(setter, index);
        return locale[field](utc, format);
    }

    function list (format, index, field, count, setter) {
        if (typeof format === 'number') {
            index = format;
            format = undefined;
        }

        format = format || '';

        if (index != null) {
            return lists__get(format, index, field, setter);
        }

        var i;
        var out = [];
        for (i = 0; i < count; i++) {
            out[i] = lists__get(format, i, field, setter);
        }
        return out;
    }

    function lists__listMonths (format, index) {
        return list(format, index, 'months', 12, 'month');
    }

    function lists__listMonthsShort (format, index) {
        return list(format, index, 'monthsShort', 12, 'month');
    }

    function lists__listWeekdays (format, index) {
        return list(format, index, 'weekdays', 7, 'day');
    }

    function lists__listWeekdaysShort (format, index) {
        return list(format, index, 'weekdaysShort', 7, 'day');
    }

    function lists__listWeekdaysMin (format, index) {
        return list(format, index, 'weekdaysMin', 7, 'day');
    }

    locale_locales__getSetGlobalLocale('en', {
        ordinalParse: /\d{1,2}(th|st|nd|rd)/,
        ordinal : function (number) {
            var b = number % 10,
                output = (toInt(number % 100 / 10) === 1) ? 'th' :
                (b === 1) ? 'st' :
                (b === 2) ? 'nd' :
                (b === 3) ? 'rd' : 'th';
            return number + output;
        }
    });

    // Side effect imports
    utils_hooks__hooks.lang = deprecate('moment.lang is deprecated. Use moment.locale instead.', locale_locales__getSetGlobalLocale);
    utils_hooks__hooks.langData = deprecate('moment.langData is deprecated. Use moment.localeData instead.', locale_locales__getLocale);

    var mathAbs = Math.abs;

    function duration_abs__abs () {
        var data           = this._data;

        this._milliseconds = mathAbs(this._milliseconds);
        this._days         = mathAbs(this._days);
        this._months       = mathAbs(this._months);

        data.milliseconds  = mathAbs(data.milliseconds);
        data.seconds       = mathAbs(data.seconds);
        data.minutes       = mathAbs(data.minutes);
        data.hours         = mathAbs(data.hours);
        data.months        = mathAbs(data.months);
        data.years         = mathAbs(data.years);

        return this;
    }

    function duration_add_subtract__addSubtract (duration, input, value, direction) {
        var other = create__createDuration(input, value);

        duration._milliseconds += direction * other._milliseconds;
        duration._days         += direction * other._days;
        duration._months       += direction * other._months;

        return duration._bubble();
    }

    // supports only 2.0-style add(1, 's') or add(duration)
    function duration_add_subtract__add (input, value) {
        return duration_add_subtract__addSubtract(this, input, value, 1);
    }

    // supports only 2.0-style subtract(1, 's') or subtract(duration)
    function duration_add_subtract__subtract (input, value) {
        return duration_add_subtract__addSubtract(this, input, value, -1);
    }

    function absCeil (number) {
        if (number < 0) {
            return Math.floor(number);
        } else {
            return Math.ceil(number);
        }
    }

    function bubble () {
        var milliseconds = this._milliseconds;
        var days         = this._days;
        var months       = this._months;
        var data         = this._data;
        var seconds, minutes, hours, years, monthsFromDays;

        // if we have a mix of positive and negative values, bubble down first
        // check: https://github.com/moment/moment/issues/2166
        if (!((milliseconds >= 0 && days >= 0 && months >= 0) ||
                (milliseconds <= 0 && days <= 0 && months <= 0))) {
            milliseconds += absCeil(monthsToDays(months) + days) * 864e5;
            days = 0;
            months = 0;
        }

        // The following code bubbles up values, see the tests for
        // examples of what that means.
        data.milliseconds = milliseconds % 1000;

        seconds           = absFloor(milliseconds / 1000);
        data.seconds      = seconds % 60;

        minutes           = absFloor(seconds / 60);
        data.minutes      = minutes % 60;

        hours             = absFloor(minutes / 60);
        data.hours        = hours % 24;

        days += absFloor(hours / 24);

        // convert days to months
        monthsFromDays = absFloor(daysToMonths(days));
        months += monthsFromDays;
        days -= absCeil(monthsToDays(monthsFromDays));

        // 12 months -> 1 year
        years = absFloor(months / 12);
        months %= 12;

        data.days   = days;
        data.months = months;
        data.years  = years;

        return this;
    }

    function daysToMonths (days) {
        // 400 years have 146097 days (taking into account leap year rules)
        // 400 years have 12 months === 4800
        return days * 4800 / 146097;
    }

    function monthsToDays (months) {
        // the reverse of daysToMonths
        return months * 146097 / 4800;
    }

    function as (units) {
        var days;
        var months;
        var milliseconds = this._milliseconds;

        units = normalizeUnits(units);

        if (units === 'month' || units === 'year') {
            days   = this._days   + milliseconds / 864e5;
            months = this._months + daysToMonths(days);
            return units === 'month' ? months : months / 12;
        } else {
            // handle milliseconds separately because of floating point math errors (issue #1867)
            days = this._days + Math.round(monthsToDays(this._months));
            switch (units) {
                case 'week'   : return days / 7     + milliseconds / 6048e5;
                case 'day'    : return days         + milliseconds / 864e5;
                case 'hour'   : return days * 24    + milliseconds / 36e5;
                case 'minute' : return days * 1440  + milliseconds / 6e4;
                case 'second' : return days * 86400 + milliseconds / 1000;
                // Math.floor prevents floating point math errors here
                case 'millisecond': return Math.floor(days * 864e5) + milliseconds;
                default: throw new Error('Unknown unit ' + units);
            }
        }
    }

    // TODO: Use this.as('ms')?
    function duration_as__valueOf () {
        return (
            this._milliseconds +
            this._days * 864e5 +
            (this._months % 12) * 2592e6 +
            toInt(this._months / 12) * 31536e6
        );
    }

    function makeAs (alias) {
        return function () {
            return this.as(alias);
        };
    }

    var asMilliseconds = makeAs('ms');
    var asSeconds      = makeAs('s');
    var asMinutes      = makeAs('m');
    var asHours        = makeAs('h');
    var asDays         = makeAs('d');
    var asWeeks        = makeAs('w');
    var asMonths       = makeAs('M');
    var asYears        = makeAs('y');

    function duration_get__get (units) {
        units = normalizeUnits(units);
        return this[units + 's']();
    }

    function makeGetter(name) {
        return function () {
            return this._data[name];
        };
    }

    var milliseconds = makeGetter('milliseconds');
    var seconds      = makeGetter('seconds');
    var minutes      = makeGetter('minutes');
    var hours        = makeGetter('hours');
    var days         = makeGetter('days');
    var months       = makeGetter('months');
    var years        = makeGetter('years');

    function weeks () {
        return absFloor(this.days() / 7);
    }

    var round = Math.round;
    var thresholds = {
        s: 45,  // seconds to minute
        m: 45,  // minutes to hour
        h: 22,  // hours to day
        d: 26,  // days to month
        M: 11   // months to year
    };

    // helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize
    function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {
        return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);
    }

    function duration_humanize__relativeTime (posNegDuration, withoutSuffix, locale) {
        var duration = create__createDuration(posNegDuration).abs();
        var seconds  = round(duration.as('s'));
        var minutes  = round(duration.as('m'));
        var hours    = round(duration.as('h'));
        var days     = round(duration.as('d'));
        var months   = round(duration.as('M'));
        var years    = round(duration.as('y'));

        var a = seconds < thresholds.s && ['s', seconds]  ||
                minutes <= 1           && ['m']           ||
                minutes < thresholds.m && ['mm', minutes] ||
                hours   <= 1           && ['h']           ||
                hours   < thresholds.h && ['hh', hours]   ||
                days    <= 1           && ['d']           ||
                days    < thresholds.d && ['dd', days]    ||
                months  <= 1           && ['M']           ||
                months  < thresholds.M && ['MM', months]  ||
                years   <= 1           && ['y']           || ['yy', years];

        a[2] = withoutSuffix;
        a[3] = +posNegDuration > 0;
        a[4] = locale;
        return substituteTimeAgo.apply(null, a);
    }

    // This function allows you to set a threshold for relative time strings
    function duration_humanize__getSetRelativeTimeThreshold (threshold, limit) {
        if (thresholds[threshold] === undefined) {
            return false;
        }
        if (limit === undefined) {
            return thresholds[threshold];
        }
        thresholds[threshold] = limit;
        return true;
    }

    function humanize (withSuffix) {
        var locale = this.localeData();
        var output = duration_humanize__relativeTime(this, !withSuffix, locale);

        if (withSuffix) {
            output = locale.pastFuture(+this, output);
        }

        return locale.postformat(output);
    }

    var iso_string__abs = Math.abs;

    function iso_string__toISOString() {
        // for ISO strings we do not use the normal bubbling rules:
        //  * milliseconds bubble up until they become hours
        //  * days do not bubble at all
        //  * months bubble up until they become years
        // This is because there is no context-free conversion between hours and days
        // (think of clock changes)
        // and also not between days and months (28-31 days per month)
        var seconds = iso_string__abs(this._milliseconds) / 1000;
        var days         = iso_string__abs(this._days);
        var months       = iso_string__abs(this._months);
        var minutes, hours, years;

        // 3600 seconds -> 60 minutes -> 1 hour
        minutes           = absFloor(seconds / 60);
        hours             = absFloor(minutes / 60);
        seconds %= 60;
        minutes %= 60;

        // 12 months -> 1 year
        years  = absFloor(months / 12);
        months %= 12;


        // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js
        var Y = years;
        var M = months;
        var D = days;
        var h = hours;
        var m = minutes;
        var s = seconds;
        var total = this.asSeconds();

        if (!total) {
            // this is the same as C#'s (Noda) and python (isodate)...
            // but not other JS (goog.date)
            return 'P0D';
        }

        return (total < 0 ? '-' : '') +
            'P' +
            (Y ? Y + 'Y' : '') +
            (M ? M + 'M' : '') +
            (D ? D + 'D' : '') +
            ((h || m || s) ? 'T' : '') +
            (h ? h + 'H' : '') +
            (m ? m + 'M' : '') +
            (s ? s + 'S' : '');
    }

    var duration_prototype__proto = Duration.prototype;

    duration_prototype__proto.abs            = duration_abs__abs;
    duration_prototype__proto.add            = duration_add_subtract__add;
    duration_prototype__proto.subtract       = duration_add_subtract__subtract;
    duration_prototype__proto.as             = as;
    duration_prototype__proto.asMilliseconds = asMilliseconds;
    duration_prototype__proto.asSeconds      = asSeconds;
    duration_prototype__proto.asMinutes      = asMinutes;
    duration_prototype__proto.asHours        = asHours;
    duration_prototype__proto.asDays         = asDays;
    duration_prototype__proto.asWeeks        = asWeeks;
    duration_prototype__proto.asMonths       = asMonths;
    duration_prototype__proto.asYears        = asYears;
    duration_prototype__proto.valueOf        = duration_as__valueOf;
    duration_prototype__proto._bubble        = bubble;
    duration_prototype__proto.get            = duration_get__get;
    duration_prototype__proto.milliseconds   = milliseconds;
    duration_prototype__proto.seconds        = seconds;
    duration_prototype__proto.minutes        = minutes;
    duration_prototype__proto.hours          = hours;
    duration_prototype__proto.days           = days;
    duration_prototype__proto.weeks          = weeks;
    duration_prototype__proto.months         = months;
    duration_prototype__proto.years          = years;
    duration_prototype__proto.humanize       = humanize;
    duration_prototype__proto.toISOString    = iso_string__toISOString;
    duration_prototype__proto.toString       = iso_string__toISOString;
    duration_prototype__proto.toJSON         = iso_string__toISOString;
    duration_prototype__proto.locale         = locale;
    duration_prototype__proto.localeData     = localeData;

    // Deprecations
    duration_prototype__proto.toIsoString = deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)', iso_string__toISOString);
    duration_prototype__proto.lang = lang;

    // Side effect imports

    // FORMATTING

    addFormatToken('X', 0, 0, 'unix');
    addFormatToken('x', 0, 0, 'valueOf');

    // PARSING

    addRegexToken('x', matchSigned);
    addRegexToken('X', matchTimestamp);
    addParseToken('X', function (input, array, config) {
        config._d = new Date(parseFloat(input, 10) * 1000);
    });
    addParseToken('x', function (input, array, config) {
        config._d = new Date(toInt(input));
    });

    // Side effect imports


    utils_hooks__hooks.version = '2.11.2';

    setHookCallback(local__createLocal);

    utils_hooks__hooks.fn                    = confimomentPrototype;
    utils_hooks__hooks.min                   = min;
    utils_hooks__hooks.max                   = max;
    utils_hooks__hooks.now                   = now;
    utils_hooks__hooks.utc                   = create_utc__createUTC;
    utils_hooks__hooks.unix                  = moment__createUnix;
    utils_hooks__hooks.months                = lists__listMonths;
    utils_hooks__hooks.isDate                = isDate;
    utils_hooks__hooks.locale                = locale_locales__getSetGlobalLocale;
    utils_hooks__hooks.invalid               = valid__createInvalid;
    utils_hooks__hooks.duration              = create__createDuration;
    utils_hooks__hooks.isMoment              = isMoment;
    utils_hooks__hooks.weekdays              = lists__listWeekdays;
    utils_hooks__hooks.parseZone             = moment__createInZone;
    utils_hooks__hooks.localeData            = locale_locales__getLocale;
    utils_hooks__hooks.isDuration            = isDuration;
    utils_hooks__hooks.monthsShort           = lists__listMonthsShort;
    utils_hooks__hooks.weekdaysMin           = lists__listWeekdaysMin;
    utils_hooks__hooks.defineLocale          = defineLocale;
    utils_hooks__hooks.weekdaysShort         = lists__listWeekdaysShort;
    utils_hooks__hooks.normalizeUnits        = normalizeUnits;
    utils_hooks__hooks.relativeTimeThreshold = duration_humanize__getSetRelativeTimeThreshold;
    utils_hooks__hooks.prototype             = confimomentPrototype;

    var _moment = utils_hooks__hooks;

    return _moment;

}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/excanvas.js' */
// Copyright 2006 Google Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.


// Known Issues:
//
// * Patterns only support repeat.
// * Radial gradient are not implemented. The VML version of these look very
//   different from the canvas one.
// * Clipping paths are not implemented.
// * Coordsize. The width and height attribute have higher priority than the
//   width and height style values which isn't correct.
// * Painting mode isn't implemented.
// * Canvas width/height should is using content-box by default. IE in
//   Quirks mode will draw the canvas using border-box. Either change your
//   doctype to HTML5
//   (http://www.whatwg.org/specs/web-apps/current-work/#the-doctype)
//   or use Box Sizing Behavior from WebFX
//   (http://webfx.eae.net/dhtml/boxsizing/boxsizing.html)
// * Non uniform scaling does not correctly scale strokes.
// * Optimize. There is always room for speed improvements.

// Only add this code if we do not already have a canvas implementation
if (!document.createElement('canvas').getContext) {

(function() {

  // alias some functions to make (compiled) code shorter
  var m = Math;
  var mr = m.round;
  var ms = m.sin;
  var mc = m.cos;
  var abs = m.abs;
  var sqrt = m.sqrt;

  // this is used for sub pixel precision
  var Z = 10;
  var Z2 = Z / 2;

  var IE_VERSION = +navigator.userAgent.match(/MSIE ([\d.]+)?/)[1];

  /**
   * This funtion is assigned to the <canvas> elements as element.getContext().
   * @this {HTMLElement}
   * @return {CanvasRenderingContext2D_}
   */
  function getContext() {
    return this.context_ ||
        (this.context_ = new CanvasRenderingContext2D_(this));
  }

  var slice = Array.prototype.slice;

  /**
   * Binds a function to an object. The returned function will always use the
   * passed in {@code obj} as {@code this}.
   *
   * Example:
   *
   *   g = bind(f, obj, a, b)
   *   g(c, d) // will do f.call(obj, a, b, c, d)
   *
   * @param {Function} f The function to bind the object to
   * @param {Object} obj The object that should act as this when the function
   *     is called
   * @param {*} var_args Rest arguments that will be used as the initial
   *     arguments when the function is called
   * @return {Function} A new function that has bound this
   */
  function bind(f, obj, var_args) {
    var a = slice.call(arguments, 2);
    return function() {
      return f.apply(obj, a.concat(slice.call(arguments)));
    };
  }

  function encodeHtmlAttribute(s) {
    return String(s).replace(/&/g, '&amp;').replace(/"/g, '&quot;');
  }

  function addNamespace(doc, prefix, urn) {
    if (!doc.namespaces[prefix]) {
      doc.namespaces.add(prefix, urn, '#default#VML');
    }
  }

  function addNamespacesAndStylesheet(doc) {
    addNamespace(doc, 'g_vml_', 'urn:schemas-microsoft-com:vml');
    addNamespace(doc, 'g_o_', 'urn:schemas-microsoft-com:office:office');

    // Setup default CSS.  Only add one style sheet per document
    if (!doc.styleSheets['ex_canvas_']) {
      var ss = doc.createStyleSheet();
      ss.owningElement.id = 'ex_canvas_';
      ss.cssText = 'canvas{display:inline-block;overflow:hidden;' +
          // default size is 300x150 in Gecko and Opera
          'text-align:left;width:300px;height:150px}';
    }
  }

  // Add namespaces and stylesheet at startup.
  addNamespacesAndStylesheet(document);

  var G_vmlCanvasManager_ = {
    init: function(opt_doc) {
      var doc = opt_doc || document;
      // Create a dummy element so that IE will allow canvas elements to be
      // recognized.
      doc.createElement('canvas');
      doc.attachEvent('onreadystatechange', bind(this.init_, this, doc));
    },

    init_: function(doc) {
      // find all canvas elements
      var els = doc.getElementsByTagName('canvas');
      for (var i = 0; i < els.length; i++) {
        this.initElement(els[i]);
      }
    },

    /**
     * Public initializes a canvas element so that it can be used as canvas
     * element from now on. This is called automatically before the page is
     * loaded but if you are creating elements using createElement you need to
     * make sure this is called on the element.
     * @param {HTMLElement} el The canvas element to initialize.
     * @return {HTMLElement} the element that was created.
     */
    initElement: function(el) {
      if (!el.getContext) {
        el.getContext = getContext;

        // Add namespaces and stylesheet to document of the element.
        addNamespacesAndStylesheet(el.ownerDocument);

        // Remove fallback content. There is no way to hide text nodes so we
        // just remove all childNodes. We could hide all elements and remove
        // text nodes but who really cares about the fallback content.
        el.innerHTML = '';

        // do not use inline function because that will leak memory
        el.attachEvent('onpropertychange', onPropertyChange);
        el.attachEvent('onresize', onResize);

        var attrs = el.attributes;
        if (attrs.width && attrs.width.specified) {
          // TODO: use runtimeStyle and coordsize
          // el.getContext().setWidth_(attrs.width.nodeValue);
          el.style.width = attrs.width.nodeValue + 'px';
        } else {
          el.width = el.clientWidth;
        }
        if (attrs.height && attrs.height.specified) {
          // TODO: use runtimeStyle and coordsize
          // el.getContext().setHeight_(attrs.height.nodeValue);
          el.style.height = attrs.height.nodeValue + 'px';
        } else {
          el.height = el.clientHeight;
        }
        //el.getContext().setCoordsize_()
      }
      return el;
    }
  };

  function onPropertyChange(e) {
    var el = e.srcElement;

    switch (e.propertyName) {
      case 'width':
        el.getContext().clearRect();
        el.style.width = el.attributes.width.nodeValue + 'px';
        // In IE8 this does not trigger onresize.
        el.firstChild.style.width =  el.clientWidth + 'px';
        break;
      case 'height':
        el.getContext().clearRect();
        el.style.height = el.attributes.height.nodeValue + 'px';
        el.firstChild.style.height = el.clientHeight + 'px';
        break;
    }
  }

  function onResize(e) {
    var el = e.srcElement;
    if (el.firstChild) {
      el.firstChild.style.width =  el.clientWidth + 'px';
      el.firstChild.style.height = el.clientHeight + 'px';
    }
  }

  G_vmlCanvasManager_.init();

  // precompute "00" to "FF"
  var decToHex = [];
  for (var i = 0; i < 16; i++) {
    for (var j = 0; j < 16; j++) {
      decToHex[i * 16 + j] = i.toString(16) + j.toString(16);
    }
  }

  function createMatrixIdentity() {
    return [
      [1, 0, 0],
      [0, 1, 0],
      [0, 0, 1]
    ];
  }

  function matrixMultiply(m1, m2) {
    var result = createMatrixIdentity();

    for (var x = 0; x < 3; x++) {
      for (var y = 0; y < 3; y++) {
        var sum = 0;

        for (var z = 0; z < 3; z++) {
          sum += m1[x][z] * m2[z][y];
        }

        result[x][y] = sum;
      }
    }
    return result;
  }

  function copyState(o1, o2) {
    o2.fillStyle     = o1.fillStyle;
    o2.lineCap       = o1.lineCap;
    o2.lineJoin      = o1.lineJoin;
    o2.lineWidth     = o1.lineWidth;
    o2.miterLimit    = o1.miterLimit;
    o2.shadowBlur    = o1.shadowBlur;
    o2.shadowColor   = o1.shadowColor;
    o2.shadowOffsetX = o1.shadowOffsetX;
    o2.shadowOffsetY = o1.shadowOffsetY;
    o2.strokeStyle   = o1.strokeStyle;
    o2.globalAlpha   = o1.globalAlpha;
    o2.font          = o1.font;
    o2.textAlign     = o1.textAlign;
    o2.textBaseline  = o1.textBaseline;
    o2.arcScaleX_    = o1.arcScaleX_;
    o2.arcScaleY_    = o1.arcScaleY_;
    o2.lineScale_    = o1.lineScale_;
    o2.rotation_     = o1.rotation_; // used for images
  }

  var colorData = {
    aliceblue: '#F0F8FF',
    antiquewhite: '#FAEBD7',
    aquamarine: '#7FFFD4',
    azure: '#F0FFFF',
    beige: '#F5F5DC',
    bisque: '#FFE4C4',
    black: '#000000',
    blanchedalmond: '#FFEBCD',
    blueviolet: '#8A2BE2',
    brown: '#A52A2A',
    burlywood: '#DEB887',
    cadetblue: '#5F9EA0',
    chartreuse: '#7FFF00',
    chocolate: '#D2691E',
    coral: '#FF7F50',
    cornflowerblue: '#6495ED',
    cornsilk: '#FFF8DC',
    crimson: '#DC143C',
    cyan: '#00FFFF',
    darkblue: '#00008B',
    darkcyan: '#008B8B',
    darkgoldenrod: '#B8860B',
    darkgray: '#A9A9A9',
    darkgreen: '#006400',
    darkgrey: '#A9A9A9',
    darkkhaki: '#BDB76B',
    darkmagenta: '#8B008B',
    darkolivegreen: '#556B2F',
    darkorange: '#FF8C00',
    darkorchid: '#9932CC',
    darkred: '#8B0000',
    darksalmon: '#E9967A',
    darkseagreen: '#8FBC8F',
    darkslateblue: '#483D8B',
    darkslategray: '#2F4F4F',
    darkslategrey: '#2F4F4F',
    darkturquoise: '#00CED1',
    darkviolet: '#9400D3',
    deeppink: '#FF1493',
    deepskyblue: '#00BFFF',
    dimgray: '#696969',
    dimgrey: '#696969',
    dodgerblue: '#1E90FF',
    firebrick: '#B22222',
    floralwhite: '#FFFAF0',
    forestgreen: '#228B22',
    gainsboro: '#DCDCDC',
    ghostwhite: '#F8F8FF',
    gold: '#FFD700',
    goldenrod: '#DAA520',
    grey: '#808080',
    greenyellow: '#ADFF2F',
    honeydew: '#F0FFF0',
    hotpink: '#FF69B4',
    indianred: '#CD5C5C',
    indigo: '#4B0082',
    ivory: '#FFFFF0',
    khaki: '#F0E68C',
    lavender: '#E6E6FA',
    lavenderblush: '#FFF0F5',
    lawngreen: '#7CFC00',
    lemonchiffon: '#FFFACD',
    lightblue: '#ADD8E6',
    lightcoral: '#F08080',
    lightcyan: '#E0FFFF',
    lightgoldenrodyellow: '#FAFAD2',
    lightgreen: '#90EE90',
    lightgrey: '#D3D3D3',
    lightpink: '#FFB6C1',
    lightsalmon: '#FFA07A',
    lightseagreen: '#20B2AA',
    lightskyblue: '#87CEFA',
    lightslategray: '#778899',
    lightslategrey: '#778899',
    lightsteelblue: '#B0C4DE',
    lightyellow: '#FFFFE0',
    limegreen: '#32CD32',
    linen: '#FAF0E6',
    magenta: '#FF00FF',
    mediumaquamarine: '#66CDAA',
    mediumblue: '#0000CD',
    mediumorchid: '#BA55D3',
    mediumpurple: '#9370DB',
    mediumseagreen: '#3CB371',
    mediumslateblue: '#7B68EE',
    mediumspringgreen: '#00FA9A',
    mediumturquoise: '#48D1CC',
    mediumvioletred: '#C71585',
    midnightblue: '#191970',
    mintcream: '#F5FFFA',
    mistyrose: '#FFE4E1',
    moccasin: '#FFE4B5',
    navajowhite: '#FFDEAD',
    oldlace: '#FDF5E6',
    olivedrab: '#6B8E23',
    orange: '#FFA500',
    orangered: '#FF4500',
    orchid: '#DA70D6',
    palegoldenrod: '#EEE8AA',
    palegreen: '#98FB98',
    paleturquoise: '#AFEEEE',
    palevioletred: '#DB7093',
    papayawhip: '#FFEFD5',
    peachpuff: '#FFDAB9',
    peru: '#CD853F',
    pink: '#FFC0CB',
    plum: '#DDA0DD',
    powderblue: '#B0E0E6',
    rosybrown: '#BC8F8F',
    royalblue: '#4169E1',
    saddlebrown: '#8B4513',
    salmon: '#FA8072',
    sandybrown: '#F4A460',
    seagreen: '#2E8B57',
    seashell: '#FFF5EE',
    sienna: '#A0522D',
    skyblue: '#87CEEB',
    slateblue: '#6A5ACD',
    slategray: '#708090',
    slategrey: '#708090',
    snow: '#FFFAFA',
    springgreen: '#00FF7F',
    steelblue: '#4682B4',
    tan: '#D2B48C',
    thistle: '#D8BFD8',
    tomato: '#FF6347',
    turquoise: '#40E0D0',
    violet: '#EE82EE',
    wheat: '#F5DEB3',
    whitesmoke: '#F5F5F5',
    yellowgreen: '#9ACD32'
  };


  function getRgbHslContent(styleString) {
    var start = styleString.indexOf('(', 3);
    var end = styleString.indexOf(')', start + 1);
    var parts = styleString.substring(start + 1, end).split(',');
    // add alpha if needed
    if (parts.length != 4 || styleString.charAt(3) != 'a') {
      parts[3] = 1;
    }
    return parts;
  }

  function percent(s) {
    return parseFloat(s) / 100;
  }

  function clamp(v, min, max) {
    return Math.min(max, Math.max(min, v));
  }

  function hslToRgb(parts){
    var r, g, b, h, s, l;
    h = parseFloat(parts[0]) / 360 % 360;
    if (h < 0)
      h++;
    s = clamp(percent(parts[1]), 0, 1);
    l = clamp(percent(parts[2]), 0, 1);
    if (s == 0) {
      r = g = b = l; // achromatic
    } else {
      var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
      var p = 2 * l - q;
      r = hueToRgb(p, q, h + 1 / 3);
      g = hueToRgb(p, q, h);
      b = hueToRgb(p, q, h - 1 / 3);
    }

    return '#' + decToHex[~~(r * 255)] +
        decToHex[~~(g * 255)] +
        decToHex[~~(b * 255)];
  }

  function hueToRgb(m1, m2, h) {
    if (h < 0)
      h++;
    if (h > 1)
      h--;

    if (6 * h < 1)
      return m1 + (m2 - m1) * 6 * h;
    else if (2 * h < 1)
      return m2;
    else if (3 * h < 2)
      return m1 + (m2 - m1) * (2 / 3 - h) * 6;
    else
      return m1;
  }

  var processStyleCache = {};

  function processStyle(styleString) {
    if (styleString in processStyleCache) {
      return processStyleCache[styleString];
    }

    var str, alpha = 1;

    styleString = String(styleString);
    if (styleString.charAt(0) == '#') {
      str = styleString;
    } else if (/^rgb/.test(styleString)) {
      var parts = getRgbHslContent(styleString);
      var str = '#', n;
      for (var i = 0; i < 3; i++) {
        if (parts[i].indexOf('%') != -1) {
          n = ~~(percent(parts[i]) * 255);
        } else {
          n = +parts[i];
        }
        str += decToHex[clamp(n, 0, 255)];
      }
      alpha = +parts[3];
    } else if (/^hsl/.test(styleString)) {
      var parts = getRgbHslContent(styleString);
      str = hslToRgb(parts);
      alpha = parts[3];
    } else {
      str = colorData[styleString] || styleString;
    }
    return processStyleCache[styleString] = {color: str, alpha: alpha};
  }

  var DEFAULT_STYLE = {
    style: 'normal',
    variant: 'normal',
    weight: 'normal',
    size: 10,
    family: 'sans-serif'
  };

  // Internal text style cache
  var fontStyleCache = {};

  function processFontStyle(styleString) {
    if (fontStyleCache[styleString]) {
      return fontStyleCache[styleString];
    }

    var el = document.createElement('div');
    var style = el.style;
    try {
      style.font = styleString;
    } catch (ex) {
      // Ignore failures to set to invalid font.
    }

    return fontStyleCache[styleString] = {
      style: style.fontStyle || DEFAULT_STYLE.style,
      variant: style.fontVariant || DEFAULT_STYLE.variant,
      weight: style.fontWeight || DEFAULT_STYLE.weight,
      size: style.fontSize || DEFAULT_STYLE.size,
      family: style.fontFamily || DEFAULT_STYLE.family
    };
  }

  function getComputedStyle(style, element) {
    var computedStyle = {};

    for (var p in style) {
      computedStyle[p] = style[p];
    }

    // Compute the size
    var canvasFontSize = parseFloat(element.currentStyle.fontSize),
        fontSize = parseFloat(style.size);

    if (typeof style.size == 'number') {
      computedStyle.size = style.size;
    } else if (style.size.indexOf('px') != -1) {
      computedStyle.size = fontSize;
    } else if (style.size.indexOf('em') != -1) {
      computedStyle.size = canvasFontSize * fontSize;
    } else if(style.size.indexOf('%') != -1) {
      computedStyle.size = (canvasFontSize / 100) * fontSize;
    } else if (style.size.indexOf('pt') != -1) {
      computedStyle.size = fontSize / .75;
    } else {
      computedStyle.size = canvasFontSize;
    }

    // Different scaling between normal text and VML text. This was found using
    // trial and error to get the same size as non VML text.
    computedStyle.size *= 0.981;

    return computedStyle;
  }

  function buildStyle(style) {
    return style.style + ' ' + style.variant + ' ' + style.weight + ' ' +
        style.size + 'px ' + style.family;
  }

  var lineCapMap = {
    'butt': 'flat',
    'round': 'round'
  };

  function processLineCap(lineCap) {
    return lineCapMap[lineCap] || 'square';
  }

  /**
   * This class implements CanvasRenderingContext2D interface as described by
   * the WHATWG.
   * @param {HTMLElement} canvasElement The element that the 2D context should
   * be associated with
   */
  function CanvasRenderingContext2D_(canvasElement) {
    this.m_ = createMatrixIdentity();

    this.mStack_ = [];
    this.aStack_ = [];
    this.currentPath_ = [];

    // Canvas context properties
    this.strokeStyle = '#000';
    this.fillStyle = '#000';

    this.lineWidth = 1;
    this.lineJoin = 'miter';
    this.lineCap = 'butt';
    this.miterLimit = Z * 1;
    this.globalAlpha = 1;
    this.font = '10px sans-serif';
    this.textAlign = 'left';
    this.textBaseline = 'alphabetic';
    this.canvas = canvasElement;

    var cssText = 'width:' + canvasElement.clientWidth + 'px;height:' +
        canvasElement.clientHeight + 'px;overflow:hidden;position:absolute';
    var el = canvasElement.ownerDocument.createElement('div');
    el.style.cssText = cssText;
    canvasElement.appendChild(el);

    var overlayEl = el.cloneNode(false);
    // Use a non transparent background.
    overlayEl.style.backgroundColor = 'red';
    overlayEl.style.filter = 'alpha(opacity=0)';
    canvasElement.appendChild(overlayEl);

    this.element_ = el;
    this.arcScaleX_ = 1;
    this.arcScaleY_ = 1;
    this.lineScale_ = 1;
    this.rotation_ = 0;
  }

  var contextPrototype = CanvasRenderingContext2D_.prototype;
  contextPrototype.clearRect = function() {
    if (this.textMeasureEl_) {
      this.textMeasureEl_.removeNode(true);
      this.textMeasureEl_ = null;
    }
    this.element_.innerHTML = '';
  };

  contextPrototype.beginPath = function() {
    // TODO: Branch current matrix so that save/restore has no effect
    //       as per safari docs.
    this.currentPath_ = [];
  };

  contextPrototype.moveTo = function(aX, aY) {
    var p = getCoords(this, aX, aY);
    this.currentPath_.push({type: 'moveTo', x: p.x, y: p.y});
    this.currentX_ = p.x;
    this.currentY_ = p.y;
  };

  contextPrototype.lineTo = function(aX, aY) {
    var p = getCoords(this, aX, aY);
    this.currentPath_.push({type: 'lineTo', x: p.x, y: p.y});

    this.currentX_ = p.x;
    this.currentY_ = p.y;
  };

  contextPrototype.bezierCurveTo = function(aCP1x, aCP1y,
                                            aCP2x, aCP2y,
                                            aX, aY) {
    var p = getCoords(this, aX, aY);
    var cp1 = getCoords(this, aCP1x, aCP1y);
    var cp2 = getCoords(this, aCP2x, aCP2y);
    bezierCurveTo(this, cp1, cp2, p);
  };

  // Helper function that takes the already fixed cordinates.
  function bezierCurveTo(self, cp1, cp2, p) {
    self.currentPath_.push({
      type: 'bezierCurveTo',
      cp1x: cp1.x,
      cp1y: cp1.y,
      cp2x: cp2.x,
      cp2y: cp2.y,
      x: p.x,
      y: p.y
    });
    self.currentX_ = p.x;
    self.currentY_ = p.y;
  }

  contextPrototype.quadraticCurveTo = function(aCPx, aCPy, aX, aY) {
    // the following is lifted almost directly from
    // http://developer.mozilla.org/en/docs/Canvas_tutorial:Drawing_shapes

    var cp = getCoords(this, aCPx, aCPy);
    var p = getCoords(this, aX, aY);

    var cp1 = {
      x: this.currentX_ + 2.0 / 3.0 * (cp.x - this.currentX_),
      y: this.currentY_ + 2.0 / 3.0 * (cp.y - this.currentY_)
    };
    var cp2 = {
      x: cp1.x + (p.x - this.currentX_) / 3.0,
      y: cp1.y + (p.y - this.currentY_) / 3.0
    };

    bezierCurveTo(this, cp1, cp2, p);
  };

  contextPrototype.arc = function(aX, aY, aRadius,
                                  aStartAngle, aEndAngle, aClockwise) {
    aRadius *= Z;
    var arcType = aClockwise ? 'at' : 'wa';

    var xStart = aX + mc(aStartAngle) * aRadius - Z2;
    var yStart = aY + ms(aStartAngle) * aRadius - Z2;

    var xEnd = aX + mc(aEndAngle) * aRadius - Z2;
    var yEnd = aY + ms(aEndAngle) * aRadius - Z2;

    // IE won't render arches drawn counter clockwise if xStart == xEnd.
    if (xStart == xEnd && !aClockwise) {
      xStart += 0.125; // Offset xStart by 1/80 of a pixel. Use something
                       // that can be represented in binary
    }

    var p = getCoords(this, aX, aY);
    var pStart = getCoords(this, xStart, yStart);
    var pEnd = getCoords(this, xEnd, yEnd);

    this.currentPath_.push({type: arcType,
                           x: p.x,
                           y: p.y,
                           radius: aRadius,
                           xStart: pStart.x,
                           yStart: pStart.y,
                           xEnd: pEnd.x,
                           yEnd: pEnd.y});

  };

  contextPrototype.rect = function(aX, aY, aWidth, aHeight) {
    this.moveTo(aX, aY);
    this.lineTo(aX + aWidth, aY);
    this.lineTo(aX + aWidth, aY + aHeight);
    this.lineTo(aX, aY + aHeight);
    this.closePath();
  };

  contextPrototype.strokeRect = function(aX, aY, aWidth, aHeight) {
    var oldPath = this.currentPath_;
    this.beginPath();

    this.moveTo(aX, aY);
    this.lineTo(aX + aWidth, aY);
    this.lineTo(aX + aWidth, aY + aHeight);
    this.lineTo(aX, aY + aHeight);
    this.closePath();
    this.stroke();

    this.currentPath_ = oldPath;
  };

  contextPrototype.fillRect = function(aX, aY, aWidth, aHeight) {
    var oldPath = this.currentPath_;
    this.beginPath();

    this.moveTo(aX, aY);
    this.lineTo(aX + aWidth, aY);
    this.lineTo(aX + aWidth, aY + aHeight);
    this.lineTo(aX, aY + aHeight);
    this.closePath();
    this.fill();

    this.currentPath_ = oldPath;
  };

  contextPrototype.createLinearGradient = function(aX0, aY0, aX1, aY1) {
    var gradient = new CanvasGradient_('gradient');
    gradient.x0_ = aX0;
    gradient.y0_ = aY0;
    gradient.x1_ = aX1;
    gradient.y1_ = aY1;
    return gradient;
  };

  contextPrototype.createRadialGradient = function(aX0, aY0, aR0,
                                                   aX1, aY1, aR1) {
    var gradient = new CanvasGradient_('gradientradial');
    gradient.x0_ = aX0;
    gradient.y0_ = aY0;
    gradient.r0_ = aR0;
    gradient.x1_ = aX1;
    gradient.y1_ = aY1;
    gradient.r1_ = aR1;
    return gradient;
  };

  contextPrototype.drawImage = function(image) {
    var dx, dy, dw, dh, sx, sy, sw, sh;

    // to fix new Image() we check the existance of runtimeStyle
    var rts = image.runtimeStyle.width;

    // to find the original width we overide the width and height
    if(rts) {
      var oldRuntimeWidth = image.runtimeStyle.width;
      var oldRuntimeHeight = image.runtimeStyle.height;

      image.runtimeStyle.width = 'auto';
      image.runtimeStyle.height = 'auto';
    }

    // get the original size
    var w = image.width;
    var h = image.height;

    // and remove overides
    if(rts) {
      image.runtimeStyle.width = oldRuntimeWidth;
      image.runtimeStyle.height = oldRuntimeHeight;
    }

    if (arguments.length == 3) {
      dx = arguments[1];
      dy = arguments[2];
      sx = sy = 0;
      sw = dw = w;
      sh = dh = h;
    } else if (arguments.length == 5) {
      dx = arguments[1];
      dy = arguments[2];
      dw = arguments[3];
      dh = arguments[4];
      sx = sy = 0;
      sw = w;
      sh = h;
    } else if (arguments.length == 9) {
      sx = arguments[1];
      sy = arguments[2];
      sw = arguments[3];
      sh = arguments[4];
      dx = arguments[5];
      dy = arguments[6];
      dw = arguments[7];
      dh = arguments[8];
    } else {
      throw Error('Invalid number of arguments');
    }

    var d = getCoords(this, dx, dy);

    var w2 = sw / 2;
    var h2 = sh / 2;

    var vmlStr = [];

    var W = 10;
    var H = 10;

    var scaleX = scaleY = 1;

    // FIX: divs give better quality then vml image and also fixes transparent PNG's
    vmlStr.push(' <div style="position:absolute;');

    // If filters are necessary (rotation exists), create them
    // filters are bog-slow, so only create them if abbsolutely necessary
    // The following check doesn't account for skews (which don't exist
    // in the canvas spec (yet) anyway.
    if (this.m_[0][0] != 1 || this.m_[0][1] ||
        this.m_[1][1] != 1 || this.m_[1][0]) {
      var filter = [];

      // Scaling images using width & height instead of Transform Matrix
      // because of quality loss
      var c = mc(this.rotation_);
      var s = ms(this.rotation_);

      // Inverse rotation matrix
      var irm = [
        [c,  -s, 0],
        [s, c, 0],
        [0,  0, 1]
      ];

      // Get unrotated matrix to get only scaling values
      var urm = matrixMultiply(irm, this.m_);
      scaleX = urm[0][0];
      scaleY = urm[1][1];

      // Apply only rotation and translation to Matrix
      filter.push('M11=', c, ',',
                  'M12=', -s, ',',
                  'M21=', s, ',',
                  'M22=', c, ',',
                  'Dx=', d.x / Z, ',',
                  'Dy=', d.y / Z);

      // Bounding box calculation (need to minimize displayed area so that
      // filters don't waste time on unused pixels.
      var max = d;
      var c2 = getCoords(this, dx + dw, dy);
      var c3 = getCoords(this, dx, dy + dh);
      var c4 = getCoords(this, dx + dw, dy + dh);

      max.x = m.max(max.x, c2.x, c3.x, c4.x);
      max.y = m.max(max.y, c2.y, c3.y, c4.y);

      vmlStr.push('padding:0 ', mr(max.x / Z), 'px ', mr(max.y / Z),
                  'px 0;filter:progid:DXImageTransform.Microsoft.Matrix(',
                  filter.join(''), ", sizingmethod='clip');");
    } else {
      vmlStr.push('top:', mr(d.y / Z), 'px;left:', mr(d.x / Z), 'px;');
    }

    vmlStr.push(' ">');

    // Draw a special cropping div if needed
    if (sx || sy) {
      // Apply scales to width and height
      vmlStr.push('<div style="overflow: hidden; width:', Math.ceil((dw + sx * dw / sw) * scaleX), 'px;',
                  ' height:', Math.ceil((dh + sy * dh / sh) * scaleY), 'px;',
                  ' filter:progid:DxImageTransform.Microsoft.Matrix(Dx=',
                  -sx * dw / sw * scaleX, ',Dy=', -sy * dh / sh * scaleY, ');">');
    }


    // Apply scales to width and height
    vmlStr.push('<div style="width:', Math.round(scaleX * w * dw / sw), 'px;',
                ' height:', Math.round(scaleY * h * dh / sh), 'px;',
                ' filter:');

    // If there is a globalAlpha, apply it to image
    if(this.globalAlpha < 1) {
      vmlStr.push(' progid:DXImageTransform.Microsoft.Alpha(opacity=' + (this.globalAlpha * 100) + ')');
    }

    vmlStr.push(' progid:DXImageTransform.Microsoft.AlphaImageLoader(src=', image.src, ',sizingMethod=scale)">');

    // Close the crop div if necessary
    if (sx || sy) vmlStr.push('</div>');

    vmlStr.push('</div></div>');

    this.element_.insertAdjacentHTML('beforeEnd', vmlStr.join(''));
  };

  contextPrototype.stroke = function(aFill) {
    var lineStr = [];
    var lineOpen = false;

    var W = 10;
    var H = 10;

    lineStr.push('<g_vml_:shape',
                 ' filled="', !!aFill, '"',
                 ' style="position:absolute;width:', W, 'px;height:', H, 'px;"',
                 ' coordorigin="0,0"',
                 ' coordsize="', Z * W, ',', Z * H, '"',
                 ' stroked="', !aFill, '"',
                 ' path="');

    var newSeq = false;
    var min = {x: null, y: null};
    var max = {x: null, y: null};

    for (var i = 0; i < this.currentPath_.length; i++) {
      var p = this.currentPath_[i];
      var c;

      switch (p.type) {
        case 'moveTo':
          c = p;
          lineStr.push(' m ', mr(p.x), ',', mr(p.y));
          break;
        case 'lineTo':
          lineStr.push(' l ', mr(p.x), ',', mr(p.y));
          break;
        case 'close':
          lineStr.push(' x ');
          p = null;
          break;
        case 'bezierCurveTo':
          lineStr.push(' c ',
                       mr(p.cp1x), ',', mr(p.cp1y), ',',
                       mr(p.cp2x), ',', mr(p.cp2y), ',',
                       mr(p.x), ',', mr(p.y));
          break;
        case 'at':
        case 'wa':
          lineStr.push(' ', p.type, ' ',
                       mr(p.x - this.arcScaleX_ * p.radius), ',',
                       mr(p.y - this.arcScaleY_ * p.radius), ' ',
                       mr(p.x + this.arcScaleX_ * p.radius), ',',
                       mr(p.y + this.arcScaleY_ * p.radius), ' ',
                       mr(p.xStart), ',', mr(p.yStart), ' ',
                       mr(p.xEnd), ',', mr(p.yEnd));
          break;
      }


      // TODO: Following is broken for curves due to
      //       move to proper paths.

      // Figure out dimensions so we can do gradient fills
      // properly
      if (p) {
        if (min.x == null || p.x < min.x) {
          min.x = p.x;
        }
        if (max.x == null || p.x > max.x) {
          max.x = p.x;
        }
        if (min.y == null || p.y < min.y) {
          min.y = p.y;
        }
        if (max.y == null || p.y > max.y) {
          max.y = p.y;
        }
      }
    }
    lineStr.push(' ">');

    if (!aFill) {
      appendStroke(this, lineStr);
    } else {
      appendFill(this, lineStr, min, max);
    }

    lineStr.push('</g_vml_:shape>');

    this.element_.insertAdjacentHTML('beforeEnd', lineStr.join(''));
  };

  function appendStroke(ctx, lineStr) {
    var a = processStyle(ctx.strokeStyle);
    var color = a.color;
    var opacity = a.alpha * ctx.globalAlpha;
    var lineWidth = ctx.lineScale_ * ctx.lineWidth;

    // VML cannot correctly render a line if the width is less than 1px.
    // In that case, we dilute the color to make the line look thinner.
    if (lineWidth < 1) {
      opacity *= lineWidth;
    }

    lineStr.push(
      '<g_vml_:stroke',
      ' opacity="', opacity, '"',
      ' joinstyle="', ctx.lineJoin, '"',
      ' miterlimit="', ctx.miterLimit, '"',
      ' endcap="', processLineCap(ctx.lineCap), '"',
      ' weight="', lineWidth, 'px"',
      ' color="', color, '" />'
    );
  }

  function appendFill(ctx, lineStr, min, max) {
    var fillStyle = ctx.fillStyle;
    var arcScaleX = ctx.arcScaleX_;
    var arcScaleY = ctx.arcScaleY_;
    var width = max.x - min.x;
    var height = max.y - min.y;
    if (fillStyle instanceof CanvasGradient_) {
      // TODO: Gradients transformed with the transformation matrix.
      var angle = 0;
      var focus = {x: 0, y: 0};

      // additional offset
      var shift = 0;
      // scale factor for offset
      var expansion = 1;

      if (fillStyle.type_ == 'gradient') {
        var x0 = fillStyle.x0_ / arcScaleX;
        var y0 = fillStyle.y0_ / arcScaleY;
        var x1 = fillStyle.x1_ / arcScaleX;
        var y1 = fillStyle.y1_ / arcScaleY;
        var p0 = getCoords(ctx, x0, y0);
        var p1 = getCoords(ctx, x1, y1);
        var dx = p1.x - p0.x;
        var dy = p1.y - p0.y;
        angle = Math.atan2(dx, dy) * 180 / Math.PI;

        // The angle should be a non-negative number.
        if (angle < 0) {
          angle += 360;
        }

        // Very small angles produce an unexpected result because they are
        // converted to a scientific notation string.
        if (angle < 1e-6) {
          angle = 0;
        }
      } else {
        var p0 = getCoords(ctx, fillStyle.x0_, fillStyle.y0_);
        focus = {
          x: (p0.x - min.x) / width,
          y: (p0.y - min.y) / height
        };

        width  /= arcScaleX * Z;
        height /= arcScaleY * Z;
        var dimension = m.max(width, height);
        shift = 2 * fillStyle.r0_ / dimension;
        expansion = 2 * fillStyle.r1_ / dimension - shift;
      }

      // We need to sort the color stops in ascending order by offset,
      // otherwise IE won't interpret it correctly.
      var stops = fillStyle.colors_;
      stops.sort(function(cs1, cs2) {
        return cs1.offset - cs2.offset;
      });

      var length = stops.length;
      var color1 = stops[0].color;
      var color2 = stops[length - 1].color;
      var opacity1 = stops[0].alpha * ctx.globalAlpha;
      var opacity2 = stops[length - 1].alpha * ctx.globalAlpha;

      var colors = [];
      for (var i = 0; i < length; i++) {
        var stop = stops[i];
        colors.push(stop.offset * expansion + shift + ' ' + stop.color);
      }

      // When colors attribute is used, the meanings of opacity and o:opacity2
      // are reversed.
      lineStr.push('<g_vml_:fill type="', fillStyle.type_, '"',
                   ' method="none" focus="100%"',
                   ' color="', color1, '"',
                   ' color2="', color2, '"',
                   ' colors="', colors.join(','), '"',
                   ' opacity="', opacity2, '"',
                   ' g_o_:opacity2="', opacity1, '"',
                   ' angle="', angle, '"',
                   ' focusposition="', focus.x, ',', focus.y, '" />');
    } else if (fillStyle instanceof CanvasPattern_) {
      if (width && height) {
        var deltaLeft = -min.x;
        var deltaTop = -min.y;
        lineStr.push('<g_vml_:fill',
                     ' position="',
                     deltaLeft / width * arcScaleX * arcScaleX, ',',
                     deltaTop / height * arcScaleY * arcScaleY, '"',
                     ' type="tile"',
                     // TODO: Figure out the correct size to fit the scale.
                     //' size="', w, 'px ', h, 'px"',
                     ' src="', fillStyle.src_, '" />');
       }
    } else {
      var a = processStyle(ctx.fillStyle);
      var color = a.color;
      var opacity = a.alpha * ctx.globalAlpha;
      lineStr.push('<g_vml_:fill color="', color, '" opacity="', opacity,
                   '" />');
    }
  }

  contextPrototype.fill = function() {
    this.stroke(true);
  };

  contextPrototype.closePath = function() {
    this.currentPath_.push({type: 'close'});
  };

  function getCoords(ctx, aX, aY) {
    var m = ctx.m_;
    return {
      x: Z * (aX * m[0][0] + aY * m[1][0] + m[2][0]) - Z2,
      y: Z * (aX * m[0][1] + aY * m[1][1] + m[2][1]) - Z2
    };
  };

  contextPrototype.save = function() {
    var o = {};
    copyState(this, o);
    this.aStack_.push(o);
    this.mStack_.push(this.m_);
    this.m_ = matrixMultiply(createMatrixIdentity(), this.m_);
  };

  contextPrototype.restore = function() {
    if (this.aStack_.length) {
      copyState(this.aStack_.pop(), this);
      this.m_ = this.mStack_.pop();
    }
  };

  function matrixIsFinite(m) {
    return isFinite(m[0][0]) && isFinite(m[0][1]) &&
        isFinite(m[1][0]) && isFinite(m[1][1]) &&
        isFinite(m[2][0]) && isFinite(m[2][1]);
  }

  function setM(ctx, m, updateLineScale) {
    if (!matrixIsFinite(m)) {
      return;
    }
    ctx.m_ = m;

    if (updateLineScale) {
      // Get the line scale.
      // Determinant of this.m_ means how much the area is enlarged by the
      // transformation. So its square root can be used as a scale factor
      // for width.
      var det = m[0][0] * m[1][1] - m[0][1] * m[1][0];
      ctx.lineScale_ = sqrt(abs(det));
    }
  }

  contextPrototype.translate = function(aX, aY) {
    var m1 = [
      [1,  0,  0],
      [0,  1,  0],
      [aX, aY, 1]
    ];

    setM(this, matrixMultiply(m1, this.m_), false);
  };

  contextPrototype.rotate = function(aRot) {
    var c = mc(aRot);
    var s = ms(aRot);

    this.rotation_ += aRot;

    var m1 = [
      [c,  s, 0],
      [-s, c, 0],
      [0,  0, 1]
    ];

    setM(this, matrixMultiply(m1, this.m_), false);
  };

  contextPrototype.scale = function(aX, aY) {
    this.arcScaleX_ *= aX;
    this.arcScaleY_ *= aY;
    var m1 = [
      [aX, 0,  0],
      [0,  aY, 0],
      [0,  0,  1]
    ];

    setM(this, matrixMultiply(m1, this.m_), true);
  };

  contextPrototype.transform = function(m11, m12, m21, m22, dx, dy) {
    var m1 = [
      [m11, m12, 0],
      [m21, m22, 0],
      [dx,  dy,  1]
    ];

    setM(this, matrixMultiply(m1, this.m_), true);
  };

  contextPrototype.setTransform = function(m11, m12, m21, m22, dx, dy) {
    var m = [
      [m11, m12, 0],
      [m21, m22, 0],
      [dx,  dy,  1]
    ];

    setM(this, m, true);
  };

  /**
   * The text drawing function.
   * The maxWidth argument isn't taken in account, since no browser supports
   * it yet.
   */
  contextPrototype.drawText_ = function(text, x, y, maxWidth, stroke) {
    var m = this.m_,
        delta = 1000,
        left = 0,
        right = delta,
        offset = {x: 0, y: 0},
        lineStr = [];

    var fontStyle = getComputedStyle(processFontStyle(this.font),
                                     this.element_);

    var fontStyleString = buildStyle(fontStyle);

    var elementStyle = this.element_.currentStyle;
    var textAlign = this.textAlign.toLowerCase();
    switch (textAlign) {
      case 'left':
      case 'center':
      case 'right':
        break;
      case 'end':
        textAlign = elementStyle.direction == 'ltr' ? 'right' : 'left';
        break;
      case 'start':
        textAlign = elementStyle.direction == 'rtl' ? 'right' : 'left';
        break;
      default:
        textAlign = 'left';
    }

    // 1.75 is an arbitrary number, as there is no info about the text baseline
    switch (this.textBaseline) {
      case 'hanging':
      case 'top':
        offset.y = fontStyle.size / 1.75;
        break;
      case 'middle':
        break;
      default:
      case null:
      case 'alphabetic':
      case 'ideographic':
      case 'bottom':
        offset.y = -fontStyle.size / 2.25;
        break;
    }

    switch(textAlign) {
      case 'right':
        left = delta;
        right = 0.05;
        break;
      case 'center':
        left = right = delta / 2;
        break;
    }

    var d = getCoords(this, x + offset.x, y + offset.y);

    lineStr.push('<g_vml_:line from="', -left ,' 0" to="', right ,' 0.05" ',
                 ' coordsize="100 100" coordorigin="0 0"',
                 ' filled="', !stroke, '" stroked="', !!stroke,
                 '" style="position:absolute;width:1px;height:1px;">');

    if (stroke) {
      appendStroke(this, lineStr);
    } else {
      // TODO: Fix the min and max params.
      appendFill(this, lineStr, {x: -left, y: 0},
                 {x: right, y: fontStyle.size});
    }

    var skewM = m[0][0].toFixed(3) + ',' + m[1][0].toFixed(3) + ',' +
                m[0][1].toFixed(3) + ',' + m[1][1].toFixed(3) + ',0,0';

    var skewOffset = mr(d.x / Z) + ',' + mr(d.y / Z);

    lineStr.push('<g_vml_:skew on="t" matrix="', skewM ,'" ',
                 ' offset="', skewOffset, '" origin="', left ,' 0" />',
                 '<g_vml_:path textpathok="true" />',
                 '<g_vml_:textpath on="true" string="',
                 encodeHtmlAttribute(text),
                 '" style="v-text-align:', textAlign,
                 ';font:', encodeHtmlAttribute(fontStyleString),
                 '" /></g_vml_:line>');

    this.element_.insertAdjacentHTML('beforeEnd', lineStr.join(''));
  };

  contextPrototype.fillText = function(text, x, y, maxWidth) {
    this.drawText_(text, x, y, maxWidth, false);
  };

  contextPrototype.strokeText = function(text, x, y, maxWidth) {
    this.drawText_(text, x, y, maxWidth, true);
  };

  contextPrototype.measureText = function(text) {
    if (!this.textMeasureEl_) {
      var s = '<span style="position:absolute;' +
          'top:-20000px;left:0;padding:0;margin:0;border:none;' +
          'white-space:pre;"></span>';
      this.element_.insertAdjacentHTML('beforeEnd', s);
      this.textMeasureEl_ = this.element_.lastChild;
    }
    var doc = this.element_.ownerDocument;
    this.textMeasureEl_.innerHTML = '';
    // FIX: Apply current font style to textMeasureEl to get correct size
    var fontStyle = getComputedStyle(processFontStyle(this.font), this.element_),
        fontStyleString = buildStyle(fontStyle);
    this.textMeasureEl_.style.font = fontStyleString;

    // Don't use innerHTML or innerText because they allow markup/whitespace.
    this.textMeasureEl_.appendChild(doc.createTextNode(text));
    return {width: this.textMeasureEl_.offsetWidth};
  };

  /******** STUBS ********/
  contextPrototype.clip = function() {
    // TODO: Implement
  };

  contextPrototype.arcTo = function() {
    // TODO: Implement
  };

  contextPrototype.createPattern = function(image, repetition) {
    return new CanvasPattern_(image, repetition);
  };

  // Gradient / Pattern Stubs
  function CanvasGradient_(aType) {
    this.type_ = aType;
    this.x0_ = 0;
    this.y0_ = 0;
    this.r0_ = 0;
    this.x1_ = 0;
    this.y1_ = 0;
    this.r1_ = 0;
    this.colors_ = [];
  }

  CanvasGradient_.prototype.addColorStop = function(aOffset, aColor) {
    aColor = processStyle(aColor);
    this.colors_.push({offset: aOffset,
                       color: aColor.color,
                       alpha: aColor.alpha});
  };

  function CanvasPattern_(image, repetition) {
    assertImageIsValid(image);
    switch (repetition) {
      case 'repeat':
      case null:
      case '':
        this.repetition_ = 'repeat';
        break
      case 'repeat-x':
      case 'repeat-y':
      case 'no-repeat':
        this.repetition_ = repetition;
        break;
      default:
        throwException('SYNTAX_ERR');
    }

    this.src_ = image.src;
    this.width_ = image.width;
    this.height_ = image.height;
  }

  function throwException(s) {
    throw new DOMException_(s);
  }

  function assertImageIsValid(img) {
    if (!img || img.nodeType != 1 || img.tagName != 'IMG') {
      throwException('TYPE_MISMATCH_ERR');
    }
    if (img.readyState != 'complete') {
      throwException('INVALID_STATE_ERR');
    }
  }

  function DOMException_(s) {
    this.code = this[s];
    this.message = s +': DOM Exception ' + this.code;
  }
  var p = DOMException_.prototype = new Error;
  p.INDEX_SIZE_ERR = 1;
  p.DOMSTRING_SIZE_ERR = 2;
  p.HIERARCHY_REQUEST_ERR = 3;
  p.WRONG_DOCUMENT_ERR = 4;
  p.INVALID_CHARACTER_ERR = 5;
  p.NO_DATA_ALLOWED_ERR = 6;
  p.NO_MODIFICATION_ALLOWED_ERR = 7;
  p.NOT_FOUND_ERR = 8;
  p.NOT_SUPPORTED_ERR = 9;
  p.INUSE_ATTRIBUTE_ERR = 10;
  p.INVALID_STATE_ERR = 11;
  p.SYNTAX_ERR = 12;
  p.INVALID_MODIFICATION_ERR = 13;
  p.NAMESPACE_ERR = 14;
  p.INVALID_ACCESS_ERR = 15;
  p.VALIDATION_ERR = 16;
  p.TYPE_MISMATCH_ERR = 17;

  // set up externs
  G_vmlCanvasManager = G_vmlCanvasManager_;
  CanvasRenderingContext2D = CanvasRenderingContext2D_;
  CanvasGradient = CanvasGradient_;
  CanvasPattern = CanvasPattern_;
  DOMException = DOMException_;
})();

} // if
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/fabric.min.js' */
/* build: `node build.js modules=ALL exclude=gestures,cufon,json minifier=uglifyjs` *//*! Fabric.js Copyright 2008-2014, Printio (Juriy Zaytsev, Maxim Chernyak) */var fabric=fabric||{version:"1.4.13"};typeof exports!="undefined"&&(exports.fabric=fabric),typeof document!="undefined"&&typeof window!="undefined"?(fabric.document=document,fabric.window=window):(fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.document.createWindow?fabric.window=fabric.document.createWindow():fabric.window=fabric.document.parentWindow),fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement,fabric.isLikelyNode=typeof Buffer!="undefined"&&typeof window=="undefined",fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width"],fabric.DPI=96,fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",function(){function e(e,t){if(!this.__eventListeners[e])return;t?fabric.util.removeFromArray(this.__eventListeners[e],t):this.__eventListeners[e].length=0}function t(e,t){this.__eventListeners||(this.__eventListeners={});if(arguments.length===1)for(var n in e)this.on(n,e[n]);else this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(t);return this}function n(t,n){if(!this.__eventListeners)return;if(arguments.length===0)this.__eventListeners={};else if(arguments.length===1&&typeof arguments[0]=="object")for(var r in t)e.call(this,r,t[r]);else e.call(this,t,n);return this}function r(e,t){if(!this.__eventListeners)return;var n=this.__eventListeners[e];if(!n)return;for(var r=0,i=n.length;r<i;r++)n[r].call(this,t||{});return this}fabric.Observable={observe:t,stopObserving:n,fire:r,on:t,off:n,trigger:r}}(),fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var e=0,t=arguments.length;e<t;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(e,t,n){var r=this.getObjects();return n?r[t]=e:r.splice(t,0,e),this._onObjectAdded(e),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){var e=this.getObjects(),t;for(var n=0,r=arguments.length;n<r;n++)t=e.indexOf(arguments[n]),t!==-1&&(e.splice(t,1),this._onObjectRemoved(arguments[n]));return this.renderOnAddRemove&&this.renderAll(),this},forEachObject:function(e,t){var n=this.getObjects(),r=n.length;while(r--)e.call(t,n[r],r,n);return this},getObjects:function(e){return typeof e=="undefined"?this._objects:this._objects.filter(function(t){return t.type===e})},item:function(e){return this.getObjects()[e]},isEmpty:function(){return this.getObjects().length===0},size:function(){return this.getObjects().length},contains:function(e){return this.getObjects().indexOf(e)>-1},complexity:function(){return this.getObjects().reduce(function(e,t){return e+=t.complexity?t.complexity():0,e},0)}},function(e){var t=Math.sqrt,n=Math.atan2,r=Math.PI/180;fabric.util={removeFromArray:function(e,t){var n=e.indexOf(t);return n!==-1&&e.splice(n,1),e},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},degreesToRadians:function(e){return e*r},radiansToDegrees:function(e){return e/r},rotatePoint:function(e,t,n){var r=Math.sin(n),i=Math.cos(n);e.subtractEquals(t);var s=e.x*i-e.y*r,o=e.x*r+e.y*i;return(new fabric.Point(s,o)).addEquals(t)},transformPoint:function(e,t,n){return n?new fabric.Point(t[0]*e.x+t[1]*e.y,t[2]*e.x+t[3]*e.y):new fabric.Point(t[0]*e.x+t[1]*e.y+t[4],t[2]*e.x+t[3]*e.y+t[5])},invertTransform:function(e){var t=e.slice(),n=1/(e[0]*e[3]-e[1]*e[2]);t=[n*e[3],-n*e[1],-n*e[2],n*e[0],0,0];var r=fabric.util.transformPoint({x:e[4],y:e[5]},t);return t[4]=-r.x,t[5]=-r.y,t},toFixed:function(e,t){return parseFloat(Number(e).toFixed(t))},parseUnit:function(e,t){var n=/\D{0,2}$/.exec(e),r=parseFloat(e);t||(t=fabric.Text.DEFAULT_SVG_FONT_SIZE);switch(n[0]){case"mm":return r*fabric.DPI/25.4;case"cm":return r*fabric.DPI/2.54;case"in":return r*fabric.DPI;case"pt":return r*fabric.DPI/72;case"pc":return r*fabric.DPI/72*12;case"em":return r*t;default:return r}},falseFunction:function(){return!1},getKlass:function(e,t){return e=fabric.util.string.camelize(e.charAt(0).toUpperCase()+e.slice(1)),fabric.util.resolveNamespace(t)[e]},resolveNamespace:function(t){if(!t)return fabric;var n=t.split("."),r=n.length,i=e||fabric.window;for(var s=0;s<r;++s)i=i[n[s]];return i},loadImage:function(e,t,n,r){if(!e){t&&t.call(n,e);return}var i=fabric.util.createImage();i.onload=function(){t&&t.call(n,i),i=i.onload=i.onerror=null},i.onerror=function(){fabric.log("Error loading "+i.src),t&&t.call(n,null,!0),i=i.onload=i.onerror=null},e.indexOf("data")!==0&&typeof r!="undefined"&&(i.crossOrigin=r),i.src=e},enlivenObjects:function(e,t,n,r){function i(){++o===u&&t&&t(s)}e=e||[];var s=[],o=0,u=e.length;if(!u){t&&t(s);return}e.forEach(function(e,t){if(!e||!e.type){i();return}var o=fabric.util.getKlass(e.type,n);o.async?o.fromObject(e,function(n,o){o||(s[t]=n,r&&r(e,s[t])),i()}):(s[t]=o.fromObject(e),r&&r(e,s[t]),i())})},groupSVGElements:function(e,t,n){var r;return r=new fabric.PathGroup(e,t),typeof n!="undefined"&&r.setSourcePath(n),r},populateWithProperties:function(e,t,n){if(n&&Object.prototype.toString.call(n)==="[object Array]")for(var r=0,i=n.length;r<i;r++)n[r]in e&&(t[n[r]]=e[n[r]])},drawDashedLine:function(e,r,i,s,o,u){var a=s-r,f=o-i,l=t(a*a+f*f),c=n(f,a),h=u.length,p=0,d=!0;e.save(),e.translate(r,i),e.moveTo(0,0),e.rotate(c),r=0;while(l>r)r+=u[p++%h],r>l&&(r=l),e[d?"lineTo":"moveTo"](r,0),d=!d;e.restore()},createCanvasElement:function(e){return e||(e=fabric.document.createElement("canvas")),!e.getContext&&typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(e),e},createImage:function(){return fabric.isLikelyNode?new(require("canvas").Image):fabric.document.createElement("img")},createAccessors:function(e){var t=e.prototype;for(var n=t.stateProperties.length;n--;){var r=t.stateProperties[n],i=r.charAt(0).toUpperCase()+r.slice(1),s="set"+i,o="get"+i;t[o]||(t[o]=function(e){return new Function('return this.get("'+e+'")')}(r)),t[s]||(t[s]=function(e){return new Function("value",'return this.set("'+e+'", value)')}(r))}},clipContext:function(e,t){t.save(),t.beginPath(),e.clipTo(t),t.clip()},multiplyTransformMatrices:function(e,t){var n=[[e[0],e[2],e[4]],[e[1],e[3],e[5]],[0,0,1]],r=[[t[0],t[2],t[4]],[t[1],t[3],t[5]],[0,0,1]],i=[];for(var s=0;s<3;s++){i[s]=[];for(var o=0;o<3;o++){var u=0;for(var a=0;a<3;a++)u+=n[s][a]*r[a][o];i[s][o]=u}}return[i[0][0],i[1][0],i[0][1],i[1][1],i[0][2],i[1][2]]},getFunctionBody:function(e){return(String(e).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(e,t,n,r){r>0&&(t>r?t-=r:t=0,n>r?n-=r:n=0);var i=!0,s=e.getImageData(t,n,r*2||1,r*2||1);for(var o=3,u=s.data.length;o<u;o+=4){var a=s.data[o];i=a<=0;if(i===!1)break}return s=null,i}}}(typeof exports!="undefined"?exports:this),function(){function i(t,n,i,u,a,f,l){var c=r.call(arguments);if(e[c])return e[c];var h=Math.PI,p=l*h/180,d=Math.sin(p),v=Math.cos(p),m=0,g=0;i=Math.abs(i),u=Math.abs(u);var y=-v*t*.5-d*n*.5,b=-v*n*.5+d*t*.5,w=i*i,E=u*u,S=b*b,x=y*y,T=w*E-w*S-E*x,N=0;if(T<0){var C=Math.sqrt(1-T/(w*E));i*=C,u*=C}else N=(a===f?-1:1)*Math.sqrt(T/(w*S+E*x));var k=N*i*b/u,L=-N*u*y/i,A=v*k-d*L+t*.5,O=d*k+v*L+n*.5,M=o(1,0,(y-k)/i,(b-L)/u),_=o((y-k)/i,(b-L)/u,(-y-k)/i,(-b-L)/u);f===0&&_>0?_-=2*h:f===1&&_<0&&(_+=2*h);var D=Math.ceil(Math.abs(_/h*2)),P=[],H=_/D,B=8/3*Math.sin(H/4)*Math.sin(H/4)/Math.sin(H/2),j=M+H;for(var F=0;F<D;F++)P[F]=s(M,j,v,d,i,u,A,O,B,m,g),m=P[F][4],g=P[F][5],M=j,j+=H;return e[c]=P,P}function s(e,n,i,s,o,u,a,f,l,c,h){var p=r.call(arguments);if(t[p])return t[p];var d=Math.cos(e),v=Math.sin(e),m=Math.cos(n),g=Math.sin(n),y=i*o*m-s*u*g+a,b=s*o*m+i*u*g+f,w=c+l*(-i*o*v-s*u*d),E=h+l*(-s*o*v+i*u*d),S=y+l*(i*o*g+s*u*m),x=b+l*(s*o*g-i*u*m);return t[p]=[w,E,S,x,y,b],t[p]}function o(e,t,n,r){var i=Math.atan2(t,e),s=Math.atan2(r,n);return s>=i?s-i:2*Math.PI-(i-s)}function u(e,t,i,s,o,u,a,f){var l=r.call(arguments);if(n[l])return n[l];var c=Math.sqrt,h=Math.min,p=Math.max,d=Math.abs,v=[],m=[[],[]],g,y,b,w,E,S,x,T;y=6*e-12*i+6*o,g=-3*e+9*i-9*o+3*a,b=3*i-3*e;for(var N=0;N<2;++N){N>0&&(y=6*t-12*s+6*u,g=-3*t+9*s-9*u+3*f,b=3*s-3*t);if(d(g)<1e-12){if(d(y)<1e-12)continue;w=-b/y,0<w&&w<1&&v.push(w);continue}x=y*y-4*b*g;if(x<0)continue;T=c(x),E=(-y+T)/(2*g),0<E&&E<1&&v.push(E),S=(-y-T)/(2*g),0<S&&S<1&&v.push(S)}var C,k,L=v.length,A=L,O;while(L--)w=v[L],O=1-w,C=O*O*O*e+3*O*O*w*i+3*O*w*w*o+w*w*w*a,m[0][L]=C,k=O*O*O*t+3*O*O*w*s+3*O*w*w*u+w*w*w*f,m[1][L]=k;m[0][A]=e,m[1][A]=t,m[0][A+1]=a,m[1][A+1]=f;var M=[{x:h.apply(null,m[0]),y:h.apply(null,m[1])},{x:p.apply(null,m[0]),y:p.apply(null,m[1])}];return n[l]=M,M}var e={},t={},n={},r=Array.prototype.join;fabric.util.drawArc=function(e,t,n,r){var s=r[0],o=r[1],u=r[2],a=r[3],f=r[4],l=r[5],c=r[6],h=[[],[],[],[]],p=i(l-t,c-n,s,o,a,f,u);for(var d=0,v=p.length;d<v;d++)h[d][0]=p[d][0]+t,h[d][1]=p[d][1]+n,h[d][2]=p[d][2]+t,h[d][3]=p[d][3]+n,h[d][4]=p[d][4]+t,h[d][5]=p[d][5]+n,e.bezierCurveTo.apply(e,h[d])},fabric.util.getBoundsOfArc=function(e,t,n,r,s,o,a,f,l){var c=0,h=0,p=[],d=[],v=i(f-e,l-t,n,r,o,a,s);for(var m=0,g=v.length;m<g;m++)p=u(c,h,v[m][0],v[m][1],v[m][2],v[m][3],v[m][4],v[m][5]),p[0].x+=e,p[0].y+=t,p[1].x+=e,p[1].y+=t,d.push(p[0]),d.push(p[1]),c=v[m][4],h=v[m][5];return d},fabric.util.getBoundsOfCurve=u}(),function(){function t(t,n){var r=e.call(arguments,2),i=[];for(var s=0,o=t.length;s<o;s++)i[s]=r.length?t[s][n].apply(t[s],r):t[s][n].call(t[s]);return i}function n(e,t){return i(e,t,function(e,t){return e>=t})}function r(e,t){return i(e,t,function(e,t){return e<t})}function i(e,t,n){if(!e||e.length===0)return;var r=e.length-1,i=t?e[r][t]:e[r];if(t)while(r--)n(e[r][t],i)&&(i=e[r][t]);else while(r--)n(e[r],i)&&(i=e[r]);return i}var e=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(this===void 0||this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(n===0)return-1;var r=0;arguments.length>0&&(r=Number(arguments[1]),r!==r?r=0:r!==0&&r!==Number.POSITIVE_INFINITY&&r!==Number.NEGATIVE_INFINITY&&(r=(r>0||-1)*Math.floor(Math.abs(r))));if(r>=n)return-1;var i=r>=0?r:Math.max(n-Math.abs(r),0);for(;i<n;i++)if(i in t&&t[i]===e)return i;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,r=this.length>>>0;n<r;n++)n in this&&e.call(t,this[n],n,this)}),Array.prototype.map||(Array.prototype.map=function(e,t){var n=[];for(var r=0,i=this.length>>>0;r<i;r++)r in this&&(n[r]=e.call(t,this[r],r,this));return n}),Array.prototype.every||(Array.prototype.every=function(e,t){for(var n=0,r=this.length>>>0;n<r;n++)if(n in this&&!e.call(t,this[n],n,this))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e,t){for(var n=0,r=this.length>>>0;n<r;n++)if(n in this&&e.call(t,this[n],n,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var n=[],r;for(var i=0,s=this.length>>>0;i<s;i++)i in this&&(r=this[i],e.call(t,r,i,this)&&n.push(r));return n}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=this.length>>>0,n=0,r;if(arguments.length>1)r=arguments[1];else do{if(n in this){r=this[n++];break}if(++n>=t)throw new TypeError}while(!0);for(;n<t;n++)n in this&&(r=e.call(null,r,this[n],n,this));return r}),fabric.util.array={invoke:t,min:r,max:n}}(),function(){function e(e,t){for(var n in t)e[n]=t[n];return e}function t(t){return e({},t)}fabric.util.object={extend:e,clone:t}}(),function(){function e(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})}function t(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())}function n(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}),fabric.util.string={camelize:e,capitalize:t,escapeXml:n}}(),function(){var e=Array.prototype.slice,t=Function.prototype.apply,n=function(){};Function.prototype.bind||(Function.prototype.bind=function(r){var i=this,s=e.call(arguments,1),o;return s.length?o=function(){return t.call(i,this instanceof n?this:r,s.concat(e.call(arguments)))}:o=function(){return t.call(i,this instanceof n?this:r,arguments)},n.prototype=this.prototype,o.prototype=new n,o})}(),function(){function i(){}function s(t){var n=this.constructor.superclass.prototype[t];return arguments.length>1?n.apply(this,e.call(arguments,1)):n.call(this)}function o(){function u(){this.initialize.apply(this,arguments)}var n=null,o=e.call(arguments,0);typeof o[0]=="function"&&(n=o.shift()),u.superclass=n,u.subclasses=[],n&&(i.prototype=n.prototype,u.prototype=new i,n.subclasses.push(u));for(var a=0,f=o.length;a<f;a++)r(u,o[a],n);return u.prototype.initialize||(u.prototype.initialize=t),u.prototype.constructor=u,u.prototype.callSuper=s,u}var e=Array.prototype.slice,t=function(){},n=function(){for(var e in{toString:1})if(e==="toString")return!1;return!0}(),r=function(e,t,r){for(var i in t)i in e.prototype&&typeof e.prototype[i]=="function"&&(t[i]+"").indexOf("callSuper")>-1?e.prototype[i]=function(e){return function(){var n=this.constructor.superclass;this.constructor.superclass=r;var i=t[e].apply(this,arguments);this.constructor.superclass=n;if(e!=="initialize")return i}}(i):e.prototype[i]=t[i],n&&(t.toString!==Object.prototype.toString&&(e.prototype.toString=t.toString),t.valueOf!==Object.prototype.valueOf&&(e.prototype.valueOf=t.valueOf))};fabric.util.createClass=o}(),function(){function t(e){var t=Array.prototype.slice.call(arguments,1),n,r,i=t.length;for(r=0;r<i;r++){n=typeof e[t[r]];if(!/^(?:function|object|unknown)$/.test(n))return!1}return!0}function s(e,t){return{handler:t,wrappedHandler:o(e,t)}}function o(e,t){return function(r){t.call(n(e),r||fabric.window.event)}}function u(e,t){return function(n){if(c[e]&&c[e][t]){var r=c[e][t];for(var i=0,s=r.length;i<s;i++)r[i].call(this,n||fabric.window.event)}}}function d(t,n){t||(t=fabric.window.event);var r=t.target||(typeof t.srcElement!==e?t.srcElement:null),i=fabric.util.getScrollLeftTop(r,n);return{x:v(t)+i.left,y:m(t)+i.top}}function g(e,t,n){var r=e.type==="touchend"?"changedTouches":"touches";return e[r]&&e[r][0]?e[r][0][t]-(e[r][0][t]-e[r][0][n])||e[n]:e[n]}var e="unknown",n,r,i=function(){var e=0;return function(t){return t.__uniqueID||(t.__uniqueID="uniqueID__"+e++)}}();(function(){var e={};n=function(t){return e[t]},r=function(t,n){e[t]=n}})();var a=t(fabric.document.documentElement,"addEventListener","removeEventListener")&&t(fabric.window,"addEventListener","removeEventListener"),f=t(fabric.document.documentElement,"attachEvent","detachEvent")&&t(fabric.window,"attachEvent","detachEvent"),l={},c={},h,p;a?(h=function(e,t,n){e.addEventListener(t,n,!1)},p=function(e,t,n){e.removeEventListener(t,n,!1)}):f?(h=function(e,t,n){var o=i(e);r(o,e),l[o]||(l[o]={}),l[o][t]||(l[o][t]=[]);var u=s(o,n);l[o][t].push(u),e.attachEvent("on"+t,u.wrappedHandler)},p=function(e,t,n){var r=i(e),s;if(l[r]&&l[r][t])for(var o=0,u=l[r][t].length;o<u;o++)s=l[r][t][o],s&&s.handler===n&&(e.detachEvent("on"+t,s.wrappedHandler),l[r][t][o]=null)}):(h=function(e,t,n){var r=i(e);c[r]||(c[r]={});if(!c[r][t]){c[r][t]=[];var s=e["on"+t];s&&c[r][t].push(s),e["on"+t]=u(r,t)}c[r][t].push(n)},p=function(e,t,n){var r=i(e);if(c[r]&&c[r][t]){var s=c[r][t];for(var o=0,u=s.length;o<u;o++)s[o]===n&&s.splice(o,1)}}),fabric.util.addListener=h,fabric.util.removeListener=p;var v=function(t){return typeof t.clientX!==e?t.clientX:0},m=function(t){return typeof t.clientY!==e?t.clientY:0};fabric.isTouchSupported&&(v=function(e){return g(e,"pageX","clientX")},m=function(e){return g(e,"pageY","clientY")}),fabric.util.getPointer=d,fabric.util.object.extend(fabric.util,fabric.Observable)}(),function(){function e(e,t){var n=e.style;if(!n)return e;if(typeof t=="string")return e.style.cssText+=";"+t,t.indexOf("opacity")>-1?s(e,t.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var r in t)if(r==="opacity")s(e,t[r]);else{var i=r==="float"||r==="cssFloat"?typeof n.styleFloat=="undefined"?"cssFloat":"styleFloat":r;n[i]=t[r]}return e}var t=fabric.document.createElement("div"),n=typeof t.style.opacity=="string",r=typeof t.style.filter=="string",i=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,s=function(e){return e};n?s=function(e,t){return e.style.opacity=t,e}:r&&(s=function(e,t){var n=e.style;return e.currentStyle&&!e.currentStyle.hasLayout&&(n.zoom=1),i.test(n.filter)?(t=t>=.9999?"":"alpha(opacity="+t*100+")",n.filter=n.filter.replace(i,t)):n.filter+=" alpha(opacity="+t*100+")",e}),fabric.util.setStyle=e}(),function(){function t(e){return typeof e=="string"?fabric.document.getElementById(e):e}function s(e,t){var n=fabric.document.createElement(e);for(var r in t)r==="class"?n.className=t[r]:r==="for"?n.htmlFor=t[r]:n.setAttribute(r,t[r]);return n}function o(e,t){e&&(" "+e.className+" ").indexOf(" "+t+" ")===-1&&(e.className+=(e.className?" ":"")+t)}function u(e,t,n){return typeof t=="string"&&(t=s(t,n)),e.parentNode&&e.parentNode.replaceChild(t,e),t.appendChild(e),t}function a(e,t){var n,r,i=0,s=0,o=fabric.document.documentElement,u=fabric.document.body||{scrollLeft:0,scrollTop:0};r=e;while(e&&e.parentNode&&!n)e=e.parentNode,e.nodeType===1&&fabric.util.getElementStyle(e,"position")==="fixed"&&(n=e),e.nodeType===1&&r!==t&&fabric.util.getElementStyle(e,"position")==="absolute"?(i=0,s=0):e===fabric.document?(i=u.scrollLeft||o.scrollLeft||0,s=u.scrollTop||o.scrollTop||0):(i+=e.scrollLeft||0,s+=e.scrollTop||0);return{left:i,top:s}}function f(e){var t,n=e&&e.ownerDocument,r={left:0,top:0},i={left:0,top:0},s,o={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!n)return{left:0,top:0};for(var u in o)i[o[u]]+=parseInt(l(e,u),10)||0;return t=n.documentElement,typeof e.getBoundingClientRect!="undefined"&&(r=e.getBoundingClientRect()),s=fabric.util.getScrollLeftTop(e,null),{left:r.left+s.left-(t.clientLeft||0)+i.left,top:r.top+s.top-(t.clientTop||0)+i.top}}var e=Array.prototype.slice,n,r=function(t){return e.call(t,0)};try{n=r(fabric.document.childNodes)instanceof Array}catch(i){}n||(r=function(e){var t=new Array(e.length),n=e.length;while(n--)t[n]=e[n];return t});var l;fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?l=function(e,t){var n=fabric.document.defaultView.getComputedStyle(e,null);return n?n[t]:undefined}:l=function(e,t){var n=e.style[t];return!n&&e.currentStyle&&(n=e.currentStyle[t]),n},function(){function n(e){return typeof e.onselectstart!="undefined"&&(e.onselectstart=fabric.util.falseFunction),t?e.style[t]="none":typeof e.unselectable=="string"&&(e.unselectable="on"),e}function r(e){return typeof e.onselectstart!="undefined"&&(e.onselectstart=null),t?e.style[t]="":typeof e.unselectable=="string"&&(e.unselectable=""),e}var e=fabric.document.documentElement.style,t="userSelect"in e?"userSelect":"MozUserSelect"in e?"MozUserSelect":"WebkitUserSelect"in e?"WebkitUserSelect":"KhtmlUserSelect"in e?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=n,fabric.util.makeElementSelectable=r}(),function(){function e(e,t){var n=fabric.document.getElementsByTagName("head")[0],r=fabric.document.createElement("script"),i=!0;r.onload=r.onreadystatechange=function(e){if(i){if(typeof this.readyState=="string"&&this.readyState!=="loaded"&&this.readyState!=="complete")return;i=!1,t(e||fabric.window.event),r=r.onload=r.onreadystatechange=null}},r.src=e,n.appendChild(r)}fabric.util.getScript=e}(),fabric.util.getById=t,fabric.util.toArray=r,fabric.util.makeElement=s,fabric.util.addClass=o,fabric.util.wrapElement=u,fabric.util.getScrollLeftTop=a,fabric.util.getElementOffset=f,fabric.util.getElementStyle=l}(),function(){function e(e,t){return e+(/\?/.test(e)?"&":"?")+t}function n(){}function r(r,i){i||(i={});var s=i.method?i.method.toUpperCase():"GET",o=i.onComplete||function(){},u=t(),a;return u.onreadystatechange=function(){u.readyState===4&&(o(u),u.onreadystatechange=n)},s==="GET"&&(a=null,typeof i.parameters=="string"&&(r=e(r,i.parameters))),u.open(s,r,!0),(s==="POST"||s==="PUT")&&u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(a),u}var t=function(){var e=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}];for(var t=e.length;t--;)try{var n=e[t]();if(n)return e[t]}catch(r){}}();fabric.util.request=r}(),fabric.log=function(){},fabric.warn=function(){},typeof console!="undefined"&&["log","warn"].forEach(function(e){typeof console[e]!="undefined"&&console[e].apply&&(fabric[e]=function(){return console[e].apply(console,arguments)})}),function(){function e(e){n(function(t){e||(e={});var r=t||+(new Date),i=e.duration||500,s=r+i,o,u=e.onChange||function(){},a=e.abort||function(){return!1},f=e.easing||function(e,t,n,r){return-n*Math.cos(e/r*(Math.PI/2))+n+t},l="startValue"in e?e.startValue:0,c="endValue"in e?e.endValue:100,h=e.byValue||c-l;e.onStart&&e.onStart(),function p(t){o=t||+(new Date);var c=o>s?i:o-r;if(a()){e.onComplete&&e.onComplete();return}u(f(c,l,h,i));if(o>s){e.onComplete&&e.onComplete();return}n(p)}(r)})}function n(){return t.apply(fabric.window,arguments)}var t=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(e){fabric.window.setTimeout(e,1e3/60)};fabric.util.animate=e,fabric.util.requestAnimFrame=n}(),function(){function e(e,t,n,r){return e<Math.abs(t)?(e=t,r=n/4):r=n/(2*Math.PI)*Math.asin(t/e),{a:e,c:t,p:n,s:r}}function t(e,t,n){return e.a*Math.pow(2,10*(t-=1))*Math.sin((t*n-e.s)*2*Math.PI/e.p)}function n(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t}function r(e,t,n,r){return e/=r/2,e<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t}function i(e,t,n,r){return n*(e/=r)*e*e*e+t}function s(e,t,n,r){return-n*((e=e/r-1)*e*e*e-1)+t}function o(e,t,n,r){return e/=r/2,e<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t}function u(e,t,n,r){return n*(e/=r)*e*e*e*e+t}function a(e,t,n,r){return n*((e=e/r-1)*e*e*e*e+1)+t}function f(e,t,n,r){return e/=r/2,e<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t}function l(e,t,n,r){return-n*Math.cos(e/r*(Math.PI/2))+n+t}function c(e,t,n,r){return n*Math.sin(e/r*(Math.PI/2))+t}function h(e,t,n,r){return-n/2*(Math.cos(Math.PI*e/r)-1)+t}function p(e,t,n,r){return e===0?t:n*Math.pow(2,10*(e/r-1))+t}function d(e,t,n,r){return e===r?t+n:n*(-Math.pow(2,-10*e/r)+1)+t}function v(e,t,n,r){return e===0?t:e===r?t+n:(e/=r/2,e<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(-Math.pow(2,-10*--e)+2)+t)}function m(e,t,n,r){return-n*(Math.sqrt(1-(e/=r)*e)-1)+t}function g(e,t,n,r){return n*Math.sqrt(1-(e=e/r-1)*e)+t}function y(e,t,n,r){return e/=r/2,e<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t}function b(n,r,i,s){var o=1.70158,u=0,a=i;if(n===0)return r;n/=s;if(n===1)return r+i;u||(u=s*.3);var f=e(a,i,u,o);return-t(f,n,s)+r}function w(t,n,r,i){var s=1.70158,o=0,u=r;if(t===0)return n;t/=i;if(t===1)return n+r;o||(o=i*.3);var a=e(u,r,o,s);return a.a*Math.pow(2,-10*t)*Math.sin((t*i-a.s)*2*Math.PI/a.p)+a.c+n}function E(n,r,i,s){var o=1.70158,u=0,a=i;if(n===0)return r;n/=s/2;if(n===2)return r+i;u||(u=s*.3*1.5);var f=e(a,i,u,o);return n<1?-0.5*t(f,n,s)+r:f.a*Math.pow(2,-10*(n-=1))*Math.sin((n*s-f.s)*2*Math.PI/f.p)*.5+f.c+r}function S(e,t,n,r,i){return i===undefined&&(i=1.70158),n*(e/=r)*e*((i+1)*e-i)+t}function x(e,t,n,r,i){return i===undefined&&(i=1.70158),n*((e=e/r-1)*e*((i+1)*e+i)+1)+t}function T(e,t,n,r,i){return i===undefined&&(i=1.70158),e/=r/2,e<1?n/2*e*e*(((i*=1.525)+1)*e-i)+t:n/2*((e-=2)*e*(((i*=1.525)+1)*e+i)+2)+t}function N(e,t,n,r){return n-C(r-e,0,n,r)+t}function C(e,t,n,r){return(e/=r)<1/2.75?n*7.5625*e*e+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t}function k(e,t,n,r){return e<r/2?N(e*2,0,n,r)*.5+t:C(e*2-r,0,n,r)*.5+n*.5+t}fabric.util.ease={easeInQuad:function(e,t,n,r){return n*(e/=r)*e+t},easeOutQuad:function(e,t,n,r){return-n*(e/=r)*(e-2)+t},easeInOutQuad:function(e,t,n,r){return e/=r/2,e<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,r){return n*(e/=r)*e*e+t},easeOutCubic:n,easeInOutCubic:r,easeInQuart:i,easeOutQuart:s,easeInOutQuart:o,easeInQuint:u,easeOutQuint:a,easeInOutQuint:f,easeInSine:l,easeOutSine:c,easeInOutSine:h,easeInExpo:p,easeOutExpo:d,easeInOutExpo:v,easeInCirc:m,easeOutCirc:g,easeInOutCirc:y,easeInElastic:b,easeOutElastic:w,easeInOutElastic:E,easeInBack:S,easeOutBack:x,easeInOutBack:T,easeInBounce:N,easeOutBounce:C,easeInOutBounce:k}}(),function(e){"use strict";function l(e){return e in a?a[e]:e}function c(e,n,r,i){var s=Object.prototype.toString.call(n)==="[object Array]",a;return e!=="fill"&&e!=="stroke"||n!=="none"?e==="strokeDashArray"?n=n.replace(/,/g," ").split(/\s+/).map(function(e){return parseFloat(e)}):e==="transformMatrix"?r&&r.transformMatrix?n=u(r.transformMatrix,t.parseTransformAttribute(n)):n=t.parseTransformAttribute(n):e==="visible"?(n=n==="none"||n==="hidden"?!1:!0,r&&r.visible===!1&&(n=!1)):e==="originX"?n=n==="start"?"left":n==="end"?"right":"center":a=s?n.map(o):o(n,i):n="",!s&&isNaN(a)?n:a}function h(e){for(var n in f){if(!e[n]||typeof e[f[n]]=="undefined")continue;if(e[n].indexOf("url(")===0)continue;var r=new t.Color(e[n]);e[n]=r.setAlpha(s(r.getAlpha()*e[f[n]],2)).toRgba()}return e}function p(e,t){var n,r;e.replace(/;$/,"").split(";").forEach(function(e){var i=e.split(":");n=l(i[0].trim().toLowerCase()),r=c(n,i[1].trim()),t[n]=r})}function d(e,t){var n,r;for(var i in e){if(typeof e[i]=="undefined")continue;n=l(i.toLowerCase()),r=c(n,e[i]),t[n]=r}}function v(e,n){var r={};for(var i in t.cssRules[n])if(m(e,i.split(" ")))for(var s in t.cssRules[n][i])r[s]=t.cssRules[n][i][s];return r}function m(e,t){var n,r=!0;return n=y(e,t.pop()),n&&t.length&&(r=g(e,t)),n&&r&&t.length===0}function g(e,t){var n,r=!0;while(e.parentNode&&e.parentNode.nodeType===1&&t.length)r&&(n=t.pop()),e=e.parentNode,r=y(e,n);return t.length===0}function y(e,t){var n=e.nodeName,r=e.getAttribute("class"),i=e.getAttribute("id"),s;s=new RegExp("^"+n,"i"),t=t.replace(s,""),i&&t.length&&(s=new RegExp("#"+i+"(?![a-zA-Z\\-]+)","i"),t=t.replace(s,""));if(r&&t.length){r=r.split(" ");for(var o=r.length;o--;)s=new RegExp("\\."+r[o]+"(?![a-zA-Z\\-]+)","i"),t=t.replace(s,"")}return t.length===0}function b(e){var t=e.getElementsByTagName("use");while(t.length){var n=t[0],r=n.getAttribute("xlink:href").substr(1),i=n.getAttribute("x")||0,s=n.getAttribute("y")||0,o=e.getElementById(r).cloneNode(!0),u=(o.getAttribute("transform")||"")+" translate("+i+", "+s+")",a;for(var f=0,l=n.attributes,c=l.length;f<c;f++){var h=l.item(f);if(h.nodeName==="x"||h.nodeName==="y"||h.nodeName==="xlink:href")continue;h.nodeName==="transform"?u=h.nodeValue+" "+u:o.setAttribute(h.nodeName,h.nodeValue)}o.setAttribute("transform",u),o.setAttribute("instantiated_by_use","1"),o.removeAttribute("id"),a=n.parentNode,a.replaceChild(o,n)}}function w(e,n,r){var i=new RegExp("^\\s*("+t.reNum+"+)\\s*,?"+"\\s*("+t.reNum+"+)\\s*,?"+"\\s*("+t.reNum+"+)\\s*,?"+"\\s*("+t.reNum+"+)\\s*"+"$"),s=e.getAttribute("viewBox"),o=1,u=1,a=0,f=0,l,c,h,p;if(!s||!(s=s.match(i)))return;a=-parseFloat(s[1]),f=-parseFloat(s[2]),l=parseFloat(s[3]),c=parseFloat(s[4]),n&&n!==l&&(o=n/l),r&&r!==c&&(u=r/c),u=o=o>u?u:o;if(o===1&&u===1&&a===0&&f===0)return;h="matrix("+o+" 0"+" 0 "+u+" "+a*o+" "+f*u+")";if(e.tagName==="svg"){p=e.ownerDocument.createElement("g");while(e.firstChild!=null)p.appendChild(e.firstChild);e.appendChild(p)}else p=e,h+=p.getAttribute("transform");p.setAttribute("transform",h)}function S(e){var n=e.objects,i=e.options;return n=n.map(function(e){return t[r(e.type)].fromObject(e)}),{objects:n,options:i}}function x(e,t,n){t[n]&&t[n].toSVG&&e.push('<pattern x="0" y="0" id="',n,'Pattern" ','width="',t[n].source.width,'" height="',t[n].source.height,'" patternUnits="userSpaceOnUse">','<image x="0" y="0" ','width="',t[n].source.width,'" height="',t[n].source.height,'" xlink:href="',t[n].source.src,'"></image></pattern>')}var t=e.fabric||(e.fabric={}),n=t.util.object.extend,r=t.util.string.capitalize,i=t.util.object.clone,s=t.util.toFixed,o=t.util.parseUnit,u=t.util.multiplyTransformMatrices,a={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},f={stroke:"strokeOpacity",fill:"fillOpacity"};t.cssRules={},t.gradientDefs={},t.parseTransformAttribute=function(){function e(e,t){var n=t[0];e[0]=Math.cos(n),e[1]=Math.sin(n),e[2]=-Math.sin(n),e[3]=Math.cos(n)}function n(e,t){var n=t[0],r=t.length===2?t[1]:t[0];e[0]=n,e[3]=r}function r(e,n){e[2]=Math.tan(t.util.degreesToRadians(n[0]))}function i(e,n){e[1]=Math.tan(t.util.degreesToRadians(n[0]))}function s(e,t){e[4]=t[0],t.length===2&&(e[5]=t[1])}var o=[1,0,0,1,0,0],u=t.reNum,a="(?:\\s+,?\\s*|,\\s*)",f="(?:(skewX)\\s*\\(\\s*("+u+")\\s*\\))",l="(?:(skewY)\\s*\\(\\s*("+u+")\\s*\\))",c="(?:(rotate)\\s*\\(\\s*("+u+")(?:"+a+"("+u+")"+a+"("+u+"))?\\s*\\))",h="(?:(scale)\\s*\\(\\s*("+u+")(?:"+a+"("+u+"))?\\s*\\))",p="(?:(translate)\\s*\\(\\s*("+u+")(?:"+a+"("+u+"))?\\s*\\))",d="(?:(matrix)\\s*\\(\\s*("+u+")"+a+"("+u+")"+a+"("+u+")"+a+"("+u+")"+a+"("+u+")"+a+"("+u+")"+"\\s*\\))",v="(?:"+d+"|"+p+"|"+h+"|"+c+"|"+f+"|"+l+")",m="(?:"+v+"(?:"+a+v+")*"+")",g="^\\s*(?:"+m+"?)\\s*$",y=new RegExp(g),b=new RegExp(v,"g");return function(u){var a=o.concat(),f=[];if(!u||u&&!y.test(u))return a;u.replace(b,function(u){var l=(new RegExp(v)).exec(u).filter(function(e){return e!==""&&e!=null}),c=l[1],h=l.slice(2).map(parseFloat);switch(c){case"translate":s(a,h);break;case"rotate":h[0]=t.util.degreesToRadians(h[0]),e(a,h);break;case"scale":n(a,h);break;case"skewX":r(a,h);break;case"skewY":i(a,h);break;case"matrix":a=h}f.push(a.concat()),a=o.concat()});var l=f[0];while(f.length>1)f.shift(),l=t.util.multiplyTransformMatrices(l,f[0]);return l}}(),t.parseSVGDocument=function(){function r(e,t){while(e&&(e=e.parentNode))if(t.test(e.nodeName)&&!e.getAttribute("instantiated_by_use"))return!0;return!1}var e=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,n=/^(symbol|image|marker|pattern|view)$/;return function(s,u,a){if(!s)return;b(s);var f=new Date,l=t.Object.__uid++,c=o(s.getAttribute("width")||"100%"),h=o(s.getAttribute("height")||"100%");w(s,c,h);var p=t.util.toArray(s.getElementsByTagName("*"));if(p.length===0&&t.isLikelyNode){p=s.selectNodes('//*[name(.)!="svg"]');var d=[];for(var v=0,m=p.length;v<m;v++)d[v]=p[v];p=d}var g=p.filter(function(t){return n.test(t.tagName)&&w(t,0,0),e.test(t.tagName)&&!r(t,/^(?:pattern|defs|symbol)$/)});if(!g||g&&!g.length){u&&u([],{});return}var y={width:c,height:h,widthAttr:c,heightAttr:h,svgUid:l};t.gradientDefs[l]=t.getGradientDefs(s),t.cssRules[l]=t.getCSSRules(s),t.parseElements(g,function(e){t.documentParsingTime=new Date-f,u&&u(e,y)},i(y),a)}}();var E={has:function(e,t){t(!1)},get:function(){},set:function(){}};n(t,{parseFontDeclaration:function(e,n){var r="(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)",i=e.match(r);if(!i)return;var s=i[1],u=i[3],a=i[4],f=i[5],l=i[6];s&&(n.fontStyle=s),u&&(n.fontWeight=isNaN(parseFloat(u))?u:parseFloat(u)),a&&(n.fontSize=o(a)),l&&(n.fontFamily=l),f&&(n.lineHeight=f==="normal"?1:f)},getGradientDefs:function(e){var t=e.getElementsByTagName("linearGradient"),n=e.getElementsByTagName("radialGradient"),r,i,s=0,o,u,a=[],f={},l={};a.length=t.length+n.length,i=t.length;while(i--)a[s++]=t[i];i=n.length;while(i--)a[s++]=n[i];while(s--)r=a[s],u=r.getAttribute("xlink:href"),o=r.getAttribute("id"),u&&(l[o]=u.substr(1)),f[o]=r;for(o in l){var c=f[l[o]].cloneNode(!0);r=f[o];while(c.firstChild)r.appendChild(c.firstChild)}return f},parseAttributes:function(e,r,i){if(!e)return;var s,o={},u;typeof i=="undefined"&&(i=e.getAttribute("svgUid")),e.parentNode&&/^symbol|[g|a]$/i.test(e.parentNode.nodeName)&&(o=t.parseAttributes(e.parentNode,r,i)),u=o&&o.fontSize||e.getAttribute("font-size")||t.Text.DEFAULT_SVG_FONT_SIZE
;var a=r.reduce(function(t,n){return s=e.getAttribute(n),s&&(n=l(n),s=c(n,s,o,u),t[n]=s),t},{});return a=n(a,n(v(e,i),t.parseStyleAttribute(e))),a.font&&t.parseFontDeclaration(a.font,a),h(n(o,a))},parseElements:function(e,n,r,i){(new t.ElementsParser(e,n,r,i)).parse()},parseStyleAttribute:function(e){var t={},n=e.getAttribute("style");return n?(typeof n=="string"?p(n,t):d(n,t),t):t},parsePointsAttribute:function(e){if(!e)return null;e=e.replace(/,/g," ").trim(),e=e.split(/\s+/);var t=[],n,r;n=0,r=e.length;for(;n<r;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t},getCSSRules:function(e){var n=e.getElementsByTagName("style"),r={},i;for(var s=0,o=n.length;s<o;s++){var u=n[s].textContent;u=u.replace(/\/\*[\s\S]*?\*\//g,"");if(u.trim()==="")continue;i=u.match(/[^{]*\{[\s\S]*?\}/g),i=i.map(function(e){return e.trim()}),i.forEach(function(e){var n=e.match(/([\s\S]*?)\s*\{([^}]*)\}/),i={},s=n[2].trim(),o=s.replace(/;$/,"").split(/\s*;\s*/);for(var u=0,a=o.length;u<a;u++){var f=o[u].split(/\s*:\s*/),h=l(f[0]),p=c(h,f[1],f[0]);i[h]=p}e=n[1],e.split(",").forEach(function(e){e=e.replace(/^svg/i,"").trim();if(e==="")return;r[e]=t.util.object.clone(i)})})}return r},loadSVGFromURL:function(e,n,r){function i(i){var s=i.responseXML;s&&!s.documentElement&&t.window.ActiveXObject&&i.responseText&&(s=new ActiveXObject("Microsoft.XMLDOM"),s.async="false",s.loadXML(i.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));if(!s||!s.documentElement)return;t.parseSVGDocument(s.documentElement,function(r,i){E.set(e,{objects:t.util.array.invoke(r,"toObject"),options:i}),n(r,i)},r)}e=e.replace(/^\n\s*/,"").trim(),E.has(e,function(r){r?E.get(e,function(e){var t=S(e);n(t.objects,t.options)}):new t.util.request(e,{method:"get",onComplete:i})})},loadSVGFromString:function(e,n,r){e=e.trim();var i;if(typeof DOMParser!="undefined"){var s=new DOMParser;s&&s.parseFromString&&(i=s.parseFromString(e,"text/xml"))}else t.window.ActiveXObject&&(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(e.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));t.parseSVGDocument(i.documentElement,function(e,t){n(e,t)},r)},createSVGFontFacesMarkup:function(e){var t="";for(var n=0,r=e.length;n<r;n++){if(e[n].type!=="text"||!e[n].path)continue;t+=["@font-face {","font-family: ",e[n].fontFamily,"; ","src: url('",e[n].path,"')","}"].join("")}return t&&(t=['<style type="text/css">',"<![CDATA[",t,"]]>","</style>"].join("")),t},createSVGRefElementsMarkup:function(e){var t=[];return x(t,e,"backgroundColor"),x(t,e,"overlayColor"),t.join("")}})}(typeof exports!="undefined"?exports:this),fabric.ElementsParser=function(e,t,n,r){this.elements=e,this.callback=t,this.options=n,this.reviver=r,this.svgUid=n&&n.svgUid||0},fabric.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var e=0,t=this.elements.length;e<t;e++)this.elements[e].setAttribute("svgUid",this.svgUid),function(e,t){setTimeout(function(){e.createObject(e.elements[t],t)},0)}(this,e)},fabric.ElementsParser.prototype.createObject=function(e,t){var n=fabric[fabric.util.string.capitalize(e.tagName)];if(n&&n.fromElement)try{this._createObject(n,e,t)}catch(r){fabric.log(r)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(e,t,n){if(e.async)e.fromElement(t,this.createCallback(n,t),this.options);else{var r=e.fromElement(t,this.options);this.resolveGradient(r,"fill"),this.resolveGradient(r,"stroke"),this.reviver&&this.reviver(t,r),this.instances[n]=r,this.checkIfDone()}},fabric.ElementsParser.prototype.createCallback=function(e,t){var n=this;return function(r){n.resolveGradient(r,"fill"),n.resolveGradient(r,"stroke"),n.reviver&&n.reviver(t,r),n.instances[e]=r,n.checkIfDone()}},fabric.ElementsParser.prototype.resolveGradient=function(e,t){var n=e.get(t);if(!/^url\(/.test(n))return;var r=n.slice(5,n.length-1);fabric.gradientDefs[this.svgUid][r]&&e.set(t,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][r],e))},fabric.ElementsParser.prototype.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(e){return e!=null}),this.callback(this.instances))},function(e){"use strict";function n(e,t){this.x=e,this.y=t}var t=e.fabric||(e.fabric={});if(t.Point){t.warn("fabric.Point is already defined");return}t.Point=n,n.prototype={constructor:n,add:function(e){return new n(this.x+e.x,this.y+e.y)},addEquals:function(e){return this.x+=e.x,this.y+=e.y,this},scalarAdd:function(e){return new n(this.x+e,this.y+e)},scalarAddEquals:function(e){return this.x+=e,this.y+=e,this},subtract:function(e){return new n(this.x-e.x,this.y-e.y)},subtractEquals:function(e){return this.x-=e.x,this.y-=e.y,this},scalarSubtract:function(e){return new n(this.x-e,this.y-e)},scalarSubtractEquals:function(e){return this.x-=e,this.y-=e,this},multiply:function(e){return new n(this.x*e,this.y*e)},multiplyEquals:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return new n(this.x/e,this.y/e)},divideEquals:function(e){return this.x/=e,this.y/=e,this},eq:function(e){return this.x===e.x&&this.y===e.y},lt:function(e){return this.x<e.x&&this.y<e.y},lte:function(e){return this.x<=e.x&&this.y<=e.y},gt:function(e){return this.x>e.x&&this.y>e.y},gte:function(e){return this.x>=e.x&&this.y>=e.y},lerp:function(e,t){return new n(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)},distanceFrom:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},midPointFrom:function(e){return new n(this.x+(e.x-this.x)/2,this.y+(e.y-this.y)/2)},min:function(e){return new n(Math.min(this.x,e.x),Math.min(this.y,e.y))},max:function(e){return new n(Math.max(this.x,e.x),Math.max(this.y,e.y))},toString:function(){return this.x+","+this.y},setXY:function(e,t){this.x=e,this.y=t},setFromPoint:function(e){this.x=e.x,this.y=e.y},swap:function(e){var t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}}}(typeof exports!="undefined"?exports:this),function(e){"use strict";function n(e){this.status=e,this.points=[]}var t=e.fabric||(e.fabric={});if(t.Intersection){t.warn("fabric.Intersection is already defined");return}t.Intersection=n,t.Intersection.prototype={appendPoint:function(e){this.points.push(e)},appendPoints:function(e){this.points=this.points.concat(e)}},t.Intersection.intersectLineLine=function(e,r,i,s){var o,u=(s.x-i.x)*(e.y-i.y)-(s.y-i.y)*(e.x-i.x),a=(r.x-e.x)*(e.y-i.y)-(r.y-e.y)*(e.x-i.x),f=(s.y-i.y)*(r.x-e.x)-(s.x-i.x)*(r.y-e.y);if(f!==0){var l=u/f,c=a/f;0<=l&&l<=1&&0<=c&&c<=1?(o=new n("Intersection"),o.points.push(new t.Point(e.x+l*(r.x-e.x),e.y+l*(r.y-e.y)))):o=new n}else u===0||a===0?o=new n("Coincident"):o=new n("Parallel");return o},t.Intersection.intersectLinePolygon=function(e,t,r){var i=new n,s=r.length;for(var o=0;o<s;o++){var u=r[o],a=r[(o+1)%s],f=n.intersectLineLine(e,t,u,a);i.appendPoints(f.points)}return i.points.length>0&&(i.status="Intersection"),i},t.Intersection.intersectPolygonPolygon=function(e,t){var r=new n,i=e.length;for(var s=0;s<i;s++){var o=e[s],u=e[(s+1)%i],a=n.intersectLinePolygon(o,u,t);r.appendPoints(a.points)}return r.points.length>0&&(r.status="Intersection"),r},t.Intersection.intersectPolygonRectangle=function(e,r,i){var s=r.min(i),o=r.max(i),u=new t.Point(o.x,s.y),a=new t.Point(s.x,o.y),f=n.intersectLinePolygon(s,u,e),l=n.intersectLinePolygon(u,o,e),c=n.intersectLinePolygon(o,a,e),h=n.intersectLinePolygon(a,s,e),p=new n;return p.appendPoints(f.points),p.appendPoints(l.points),p.appendPoints(c.points),p.appendPoints(h.points),p.points.length>0&&(p.status="Intersection"),p}}(typeof exports!="undefined"?exports:this),function(e){"use strict";function n(e){e?this._tryParsingColor(e):this.setSource([0,0,0,1])}function r(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var t=e.fabric||(e.fabric={});if(t.Color){t.warn("fabric.Color is already defined.");return}t.Color=n,t.Color.prototype={_tryParsingColor:function(e){var t;e in n.colorNameMap&&(e=n.colorNameMap[e]);if(e==="transparent"){this.setSource([255,255,255,0]);return}t=n.sourceFromHex(e),t||(t=n.sourceFromRgb(e)),t||(t=n.sourceFromHsl(e)),t&&this.setSource(t)},_rgbToHsl:function(e,n,r){e/=255,n/=255,r/=255;var i,s,o,u=t.util.array.max([e,n,r]),a=t.util.array.min([e,n,r]);o=(u+a)/2;if(u===a)i=s=0;else{var f=u-a;s=o>.5?f/(2-u-a):f/(u+a);switch(u){case e:i=(n-r)/f+(n<r?6:0);break;case n:i=(r-e)/f+2;break;case r:i=(e-n)/f+4}i/=6}return[Math.round(i*360),Math.round(s*100),Math.round(o*100)]},getSource:function(){return this._source},setSource:function(e){this._source=e},toRgb:function(){var e=this.getSource();return"rgb("+e[0]+","+e[1]+","+e[2]+")"},toRgba:function(){var e=this.getSource();return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"},toHsl:function(){var e=this.getSource(),t=this._rgbToHsl(e[0],e[1],e[2]);return"hsl("+t[0]+","+t[1]+"%,"+t[2]+"%)"},toHsla:function(){var e=this.getSource(),t=this._rgbToHsl(e[0],e[1],e[2]);return"hsla("+t[0]+","+t[1]+"%,"+t[2]+"%,"+e[3]+")"},toHex:function(){var e=this.getSource(),t,n,r;return t=e[0].toString(16),t=t.length===1?"0"+t:t,n=e[1].toString(16),n=n.length===1?"0"+n:n,r=e[2].toString(16),r=r.length===1?"0"+r:r,t.toUpperCase()+n.toUpperCase()+r.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(e){var t=this.getSource();return t[3]=e,this.setSource(t),this},toGrayscale:function(){var e=this.getSource(),t=parseInt((e[0]*.3+e[1]*.59+e[2]*.11).toFixed(0),10),n=e[3];return this.setSource([t,t,t,n]),this},toBlackWhite:function(e){var t=this.getSource(),n=(t[0]*.3+t[1]*.59+t[2]*.11).toFixed(0),r=t[3];return e=e||127,n=Number(n)<Number(e)?0:255,this.setSource([n,n,n,r]),this},overlayWith:function(e){e instanceof n||(e=new n(e));var t=[],r=this.getAlpha(),i=.5,s=this.getSource(),o=e.getSource();for(var u=0;u<3;u++)t.push(Math.round(s[u]*(1-i)+o[u]*i));return t[3]=r,this.setSource(t),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,t.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},t.Color.fromRgb=function(e){return n.fromSource(n.sourceFromRgb(e))},t.Color.sourceFromRgb=function(e){var t=e.match(n.reRGBa);if(t){var r=parseInt(t[1],10)/(/%$/.test(t[1])?100:1)*(/%$/.test(t[1])?255:1),i=parseInt(t[2],10)/(/%$/.test(t[2])?100:1)*(/%$/.test(t[2])?255:1),s=parseInt(t[3],10)/(/%$/.test(t[3])?100:1)*(/%$/.test(t[3])?255:1);return[parseInt(r,10),parseInt(i,10),parseInt(s,10),t[4]?parseFloat(t[4]):1]}},t.Color.fromRgba=n.fromRgb,t.Color.fromHsl=function(e){return n.fromSource(n.sourceFromHsl(e))},t.Color.sourceFromHsl=function(e){var t=e.match(n.reHSLa);if(!t)return;var i=(parseFloat(t[1])%360+360)%360/360,s=parseFloat(t[2])/(/%$/.test(t[2])?100:1),o=parseFloat(t[3])/(/%$/.test(t[3])?100:1),u,a,f;if(s===0)u=a=f=o;else{var l=o<=.5?o*(s+1):o+s-o*s,c=o*2-l;u=r(c,l,i+1/3),a=r(c,l,i),f=r(c,l,i-1/3)}return[Math.round(u*255),Math.round(a*255),Math.round(f*255),t[4]?parseFloat(t[4]):1]},t.Color.fromHsla=n.fromHsl,t.Color.fromHex=function(e){return n.fromSource(n.sourceFromHex(e))},t.Color.sourceFromHex=function(e){if(e.match(n.reHex)){var t=e.slice(e.indexOf("#")+1),r=t.length===3,i=r?t.charAt(0)+t.charAt(0):t.substring(0,2),s=r?t.charAt(1)+t.charAt(1):t.substring(2,4),o=r?t.charAt(2)+t.charAt(2):t.substring(4,6);return[parseInt(i,16),parseInt(s,16),parseInt(o,16),1]}},t.Color.fromSource=function(e){var t=new n;return t.setSource(e),t}}(typeof exports!="undefined"?exports:this),function(){function e(e){var t=e.getAttribute("style"),n=e.getAttribute("offset"),r,i,s;n=parseFloat(n)/(/%$/.test(n)?100:1),n=n<0?0:n>1?1:n;if(t){var o=t.split(/\s*;\s*/);o[o.length-1]===""&&o.pop();for(var u=o.length;u--;){var a=o[u].split(/\s*:\s*/),f=a[0].trim(),l=a[1].trim();f==="stop-color"?r=l:f==="stop-opacity"&&(s=l)}}return r||(r=e.getAttribute("stop-color")||"rgb(0,0,0)"),s||(s=e.getAttribute("stop-opacity")),r=new fabric.Color(r),i=r.getAlpha(),s=isNaN(parseFloat(s))?1:parseFloat(s),s*=i,{offset:n,color:r.toRgb(),opacity:s}}function t(e){return{x1:e.getAttribute("x1")||0,y1:e.getAttribute("y1")||0,x2:e.getAttribute("x2")||"100%",y2:e.getAttribute("y2")||0}}function n(e){return{x1:e.getAttribute("fx")||e.getAttribute("cx")||"50%",y1:e.getAttribute("fy")||e.getAttribute("cy")||"50%",r1:0,x2:e.getAttribute("cx")||"50%",y2:e.getAttribute("cy")||"50%",r2:e.getAttribute("r")||"50%"}}function r(e,t,n){var r,i=0,s=1,o="";for(var u in t){r=parseFloat(t[u],10),typeof t[u]=="string"&&/^\d+%$/.test(t[u])?s=.01:s=1;if(u==="x1"||u==="x2"||u==="r2")s*=n==="objectBoundingBox"?e.width:1,i=n==="objectBoundingBox"?e.left||0:0;else if(u==="y1"||u==="y2")s*=n==="objectBoundingBox"?e.height:1,i=n==="objectBoundingBox"?e.top||0:0;t[u]=r*s+i}if(e.type==="ellipse"&&t.r2!==null&&n==="objectBoundingBox"&&e.rx!==e.ry){var a=e.ry/e.rx;o=" scale(1, "+a+")",t.y1&&(t.y1/=a),t.y2&&(t.y2/=a)}return o}fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(e){e||(e={});var t={};this.id=fabric.Object.__uid++,this.type=e.type||"linear",t={x1:e.coords.x1||0,y1:e.coords.y1||0,x2:e.coords.x2||0,y2:e.coords.y2||0},this.type==="radial"&&(t.r1=e.coords.r1||0,t.r2=e.coords.r2||0),this.coords=t,this.colorStops=e.colorStops.slice(),e.gradientTransform&&(this.gradientTransform=e.gradientTransform),this.offsetX=e.offsetX||this.offsetX,this.offsetY=e.offsetY||this.offsetY},addColorStop:function(e){for(var t in e){var n=new fabric.Color(e[t]);this.colorStops.push({offset:t,color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(e){var t=fabric.util.object.clone(this.coords),n,r;this.colorStops.sort(function(e,t){return e.offset-t.offset});if(!e.group||e.group.type!=="path-group")for(var i in t)if(i==="x1"||i==="x2"||i==="r2")t[i]+=this.offsetX-e.width/2;else if(i==="y1"||i==="y2")t[i]+=this.offsetY-e.height/2;r='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"',this.gradientTransform&&(r+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),this.type==="linear"?n=["<linearGradient ",r,' x1="',t.x1,'" y1="',t.y1,'" x2="',t.x2,'" y2="',t.y2,'">\n']:this.type==="radial"&&(n=["<radialGradient ",r,' cx="',t.x2,'" cy="',t.y2,'" r="',t.r2,'" fx="',t.x1,'" fy="',t.y1,'">\n']);for(var s=0;s<this.colorStops.length;s++)n.push("<stop ",'offset="',this.colorStops[s].offset*100+"%",'" style="stop-color:',this.colorStops[s].color,this.colorStops[s].opacity!=null?";stop-opacity: "+this.colorStops[s].opacity:";",'"/>\n');return n.push(this.type==="linear"?"</linearGradient>\n":"</radialGradient>\n"),n.join("")},toLive:function(e,t){var n,r=fabric.util.object.clone(this.coords);if(!this.type)return;if(t.group&&t.group.type==="path-group")for(var i in r)if(i==="x1"||i==="x2")r[i]+=-this.offsetX+t.width/2;else if(i==="y1"||i==="y2")r[i]+=-this.offsetY+t.height/2;this.type==="linear"?n=e.createLinearGradient(r.x1,r.y1,r.x2,r.y2):this.type==="radial"&&(n=e.createRadialGradient(r.x1,r.y1,r.r1,r.x2,r.y2,r.r2));for(var s=0,o=this.colorStops.length;s<o;s++){var u=this.colorStops[s].color,a=this.colorStops[s].opacity,f=this.colorStops[s].offset;typeof a!="undefined"&&(u=(new fabric.Color(u)).setAlpha(a).toRgba()),n.addColorStop(parseFloat(f),u)}return n}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(i,s){var o=i.getElementsByTagName("stop"),u=i.nodeName==="linearGradient"?"linear":"radial",a=i.getAttribute("gradientUnits")||"objectBoundingBox",f=i.getAttribute("gradientTransform"),l=[],c={},h;u==="linear"?c=t(i):u==="radial"&&(c=n(i));for(var p=o.length;p--;)l.push(e(o[p]));h=r(s,c,a);var d=new fabric.Gradient({type:u,coords:c,colorStops:l,offsetX:-s.left,offsetY:-s.top});if(f||h!=="")d.gradientTransform=fabric.parseTransformAttribute((f||"")+h);return d},forObject:function(e,t){return t||(t={}),r(e,t.coords,"userSpaceOnUse"),new fabric.Gradient(t)}})}(),fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(e){e||(e={}),this.id=fabric.Object.__uid++;if(e.source)if(typeof e.source=="string")if(typeof fabric.util.getFunctionBody(e.source)!="undefined")this.source=new Function(fabric.util.getFunctionBody(e.source));else{var t=this;this.source=fabric.util.createImage(),fabric.util.loadImage(e.source,function(e){t.source=e})}else this.source=e.source;e.repeat&&(this.repeat=e.repeat),e.offsetX&&(this.offsetX=e.offsetX),e.offsetY&&(this.offsetY=e.offsetY)},toObject:function(){var e;return typeof this.source=="function"?e=String(this.source):typeof this.source.src=="string"&&(e=this.source.src),{source:e,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(e){var t=typeof this.source=="function"?this.source():this.source,n=t.width/e.getWidth(),r=t.height/e.getHeight(),i=this.offsetX/e.getWidth(),s=this.offsetY/e.getHeight(),o="";if(this.repeat==="repeat-x"||this.repeat==="no-repeat")r=1;if(this.repeat==="repeat-y"||this.repeat==="no-repeat")n=1;return t.src?o=t.src:t.toDataURL&&(o=t.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+i+'" y="'+s+'" width="'+n+'" height="'+r+'">\n'+'<image x="0" y="0"'+' width="'+t.width+'" height="'+t.height+'" xlink:href="'+o+'"></image>\n'+"</pattern>\n"},toLive:function(e){var t=typeof this.source=="function"?this.source():this.source;if(!t)return"";if(typeof t.src!="undefined"){if(!t.complete)return"";if(t.naturalWidth===0||t.naturalHeight===0)return""}return e.createPattern(t,this.repeat)}}),function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Shadow){t.warn("fabric.Shadow is already defined.");return}t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(e){typeof e=="string"&&(e=this._parseShadow(e));for(var n in e)this[n]=e[n];this.id=t.Object.__uid++},_parseShadow:function(e){var n=e.trim(),r=t.Shadow.reOffsetsAndBlur.exec(n)||[],i=n.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:i.trim(),offsetX:parseInt(r[1],10)||0,offsetY:parseInt(r[2],10)||0,blur:parseInt(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(e){var t="SourceAlpha",n=40,r=40;return e&&(e.fill===this.color||e.stroke===this.color)&&(t="SourceGraphic"),e.width&&e.height&&(n=Math.abs(this.offsetX/e.getWidth())*100+20,r=Math.abs(this.offsetY/e.getHeight())*100+20),'<filter id="SVGID_'+this.id+'" y="-'+r+'%" height="'+(100+2*r)+'%" '+'x="-'+n+'%" width="'+(100+2*n)+'%" '+">\n"+'	<feGaussianBlur in="'+t+'" stdDeviation="'+(this.blur?this.blur/3:0)+'"></feGaussianBlur>\n'+'	<feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset>\n'+"	<feMerge>\n"+"		<feMergeNode></feMergeNode>\n"+'		<feMergeNode in="SourceGraphic"></feMergeNode>\n'+"	</feMerge>\n"+"</filter>\n"},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};var e={},n=t.Shadow.prototype;return this.color!==n.color&&(e.color=this.color),this.blur!==n.blur&&(e.blur=this.blur),this.offsetX!==n.offsetX&&(e.offsetX=this.offsetX),this.offsetY!==n.offsetY&&(e.offsetY=this.offsetY),e}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/}(typeof exports!="undefined"?exports:this),function(){"use strict";if(fabric.StaticCanvas){fabric.warn("fabric.StaticCanvas is already defined.");return}var e=fabric.util.object.extend,t=fabric.util.getElementOffset,n=fabric.util.removeFromArray,r=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(e,t){t||(t={}),this._initStatic(e,t),fabric.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(e,t){this._objects=[],this._createLowerCanvas(e),this._initOptions(t),this._setImageSmoothing(),t.overlayImage&&this.setOverlayImage(t.overlayImage,this.renderAll.bind(this)),t.backgroundImage&&this.setBackgroundImage(t.backgroundImage,this.renderAll.bind(this)),t.backgroundColor&&this.setBackgroundColor(t.backgroundColor,this.renderAll.bind(this)),t.overlayColor&&this.setOverlayColor(t.overlayColor,this.renderAll.bind(this)),this.calcOffset()},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(e,t,n){return this.__setBgOverlayImage("overlayImage",e,t,n)},setBackgroundImage:function(e,t,n){return this.__setBgOverlayImage("backgroundImage",e,t,n)},setOverlayColor:function(e,t){return this.__setBgOverlayColor("overlayColor",e,t)},setBackgroundColor:function(e,t){return this.__setBgOverlayColor("backgroundColor",e,t)},_setImageSmoothing:function(){var e=this.getContext();e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.webkitImageSmoothingEnabled=this.imageSmoothingEnabled,e.mozImageSmoothingEnabled=this.imageSmoothingEnabled,e.msImageSmoothingEnabled=this.imageSmoothingEnabled,e.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(e,t,n,r){return typeof t=="string"?fabric.util.loadImage(t,function(t){this[e]=new fabric.Image(t,r),n&&n()},this,r&&r.crossOrigin):(this[e]=t,n&&n()),this},__setBgOverlayColor:function(e,t,n){if(t&&t.source){var r=this;fabric.util.loadImage(t.source,function(i){r[e]=new fabric.Pattern({source:i,repeat:t.repeat,offsetX:t.offsetX,offsetY:t.offsetY}),n&&n()})}else this[e]=t,n&&n();return this},_createCanvasElement:function(){var e=fabric.document.createElement("canvas");e.style||(e.style={});if(!e)throw r;return this._initCanvasElement(e),e},_initCanvasElement:function(e){fabric.util.createCanvasElement(e);if(typeof e.getContext=="undefined")throw r},_initOptions:function(e){for(var t in e)this[t]=e[t];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0;if(!this.lowerCanvasEl.style)return;this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice()},_createLowerCanvas:function(e){this.lowerCanvasEl=fabric.util.getById(e)||this._createCanvasElement(),this._initCanvasElement(this.lowerCanvasEl),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(e,t){return this.setDimensions({width:e},t)},setHeight:function(e,t){return this.setDimensions({height:e},t)},setDimensions:function(e,t){var n;t=t||{};for(var r in e)n=e[r],t.cssOnly||(this._setBackstoreDimension(r,e[r]),n+="px"),t.backstoreOnly||this._setCssDimension(r,n);return t.cssOnly||this.renderAll(),this.calcOffset(),this},_setBackstoreDimension:function(e,t){return this.lowerCanvasEl[e]=t,this.upperCanvasEl&&(this.upperCanvasEl[e]=t),this.cacheCanvasEl&&(this.cacheCanvasEl[e]=t),this[e]=t,this},_setCssDimension:function(e,t){return this.lowerCanvasEl.style[e]=t,this.upperCanvasEl&&(this.upperCanvasEl.style[e]=t),this.wrapperEl&&(this.wrapperEl.style[e]=t),this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(e){this.viewportTransform=e,this.renderAll();for(var t=0,n=this._objects.length;t<n;t++)this._objects[t].setCoords();return this},zoomToPoint:function(e,t){var n=e;e=fabric.util.transformPoint(e,fabric.util.invertTransform(this.viewportTransform)),this.viewportTransform[0]=t,this.viewportTransform[3]=t;var r=fabric.util.transformPoint(e,this.viewportTransform);this.viewportTransform[4]+=n.x-r.x,this.viewportTransform[5]+=n.y-r.y,this.renderAll();for(var i=0,s=this._objects.length;i<s;i++)this._objects[i].setCoords();return this},setZoom:function(e){return this.zoomToPoint(new fabric.Point(0,0),e),this},absolutePan:function(e){this.viewportTransform[4]=-e.x,this.viewportTransform[5]=-e.y,this.renderAll();for(var t=0,n=this._objects.length;t<n;t++)this._objects[t].setCoords();return this},relativePan:function(e){return this.absolutePan(new fabric.Point(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(e,t){if(!t)return;e.save();var n=this.viewportTransform;e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._shouldRenderObject(t)&&t.render(e),e.restore(),this.controlsAboveOverlay||t._renderControls(e)},_shouldRenderObject:function(e){return e?e!==this.getActiveGroup()||!this.preserveObjectStacking:!1},_onObjectAdded:function(e){this.stateful&&e.setupState(),e.canvas=this,e.setCoords(),this.fire("object:added",{target:e}),e.fire("added")},_onObjectRemoved:function(e){this.getActiveObject()===e&&(this.fire("before:selection:cleared",{target:e}),this._discardActiveObject(),this.fire("selection:cleared")),this.fire("object:removed",{target:e}),e.fire("removed")},clearContext:function(e){return e.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.discardActiveGroup&&this.discardActiveGroup(),this.discardActiveObject&&this.discardActiveObject(),this.clearContext(this.contextContainer),this.contextTop&&this.clearContext(this.contextTop),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(e){var t=this[e===!0&&this.interactive?"contextTop":"contextContainer"],n=this.getActiveGroup();return this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop),e||this.clearContext(t),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,t),this._renderBackground(t),this._renderObjects(t,n),this._renderActiveGroup(t,n),this.clipTo&&t.restore(),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render"),this},_renderObjects:function(e,t){var n,r;if(!t||this.preserveObjectStacking)for(n=0,r=this._objects.length;n<r;++n)this._draw(e,this._objects[n]);else for(n=0,r=this._objects.length;n<r;++n)this._objects[n]&&!t.contains(this._objects[n])&&this._draw(e,this._objects[n])},_renderActiveGroup:function(e,t){if(t){var n=[];this.forEachObject(function(e){t.contains(e)&&n.push(e)}),t._set("objects",n),this._draw(e,t)}},_renderBackground:function(e){this.backgroundColor&&(e.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(e):this.backgroundColor,e.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height)),this.backgroundImage&&this._draw(e,this.backgroundImage)},_renderOverlay:function(e){this.overlayColor&&(e.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(e):this.overlayColor,e.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height)),this.overlayImage&&this._draw(e,this.overlayImage)},renderTop:function(){var e=this.contextTop||this.contextContainer;this.clearContext(e),this.selection&&this._groupSelector&&this._drawSelection();var t=this.getActiveGroup();return t&&t.render(e),this._renderOverlay(e),this.fire("after:render"),this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(e){return this._centerObject(e,new fabric.Point(this.getCenter().left,e.getCenterPoint().y)),this.renderAll(),this},centerObjectV:function(e){return this._centerObject(e,new fabric.Point(e.getCenterPoint().x,this.getCenter().top)),this.renderAll(),this},centerObject:function(e){var t=this.getCenter();return this._centerObject(e,new fabric.Point(t.left,t.top)),this.renderAll(),this},_centerObject:function(e,t){return e.setPositionByOrigin(t,"center","center"),this},toDatalessJSON:function(e){return this.toDatalessObject(e)},toObject:function(e){return this._toObjectMethod("toObject",e)},toDatalessObject:function(e){return this._toObjectMethod("toDatalessObject",e)},_toObjectMethod:function(t,n){var r=this.getActiveGroup();r&&this.discardActiveGroup();var i={objects:this._toObjects(t,n)};return e(i,this.__serializeBgOverlay()),fabric.util.populateWithProperties(this,i,n),r&&(this.setActiveGroup(new fabric.Group(r.getObjects(),{originX:"center",originY:"center"})),r.forEachObject(function(e){e.set("active",!0)}),this._currentTransform&&(this._currentTransform.target=this.getActiveGroup())),i},_toObjects:function(e,t){return this.getObjects().map(function(n){return this._toObject(n,e,t)},this)},_toObject:function(e,t,n){var r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);var i=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=r),i},__serializeBgOverlay:function(){var e={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};return this.overlayColor&&(e.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor),this.backgroundImage&&(e.backgroundImage=this.backgroundImage.toObject()),this.overlayImage&&(e.overlayImage=this.overlayImage.toObject()),e},svgViewportTransformation:!0,toSVG:function(e,t){e||(e={});var n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this._setSVGBgOverlayColor(n,"backgroundColor"),this._setSVGBgOverlayImage(n,"backgroundImage"),this._setSVGObjects(n,t),this._setSVGBgOverlayColor(n,"overlayColor"),this._setSVGBgOverlayImage(n,"overlayImage"),n.push("</svg>"),n.join("")},_setSVGPreamble:function(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(e,t){var n,r,i;t.viewBox?(n=t.viewBox.width,r=t.viewBox.height):(n=this.width,r=this.height,this.svgViewportTransformation||(i=this.viewportTransform,n/=i[0],r/=i[3])),e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',r,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,t.viewBox?'viewBox="'+t.viewBox.x+" "+t.viewBox.y+" "+t.viewBox.width+" "+t.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(e,t){var n=this.getActiveGroup();n&&this.discardActiveGroup();for(var r=0,i=this.getObjects(),s=i.length;r<s;r++)e.push(i[r].toSVG(t));n&&(this.setActiveGroup(new fabric.Group(n.getObjects())),n.forEachObject(function(e){e.set("active",!0)}))},_setSVGBgOverlayImage:function(e,t){this[t]&&this[t].toSVG&&e.push(this[t].toSVG())},_setSVGBgOverlayColor:function(e,t){this[t]&&this[t].source?e.push('<rect x="',this[t].offsetX,'" y="',this[t].offsetY,'" ','width="',this[t].repeat==="repeat-y"||this[t].repeat==="no-repeat"?this[t].source.width:this.width,'" height="',this[t].repeat==="repeat-x"||this[t].repeat==="no-repeat"?this[t].source.height:this.height,'" fill="url(#'+t+'Pattern)"',"></rect>"):this[t]&&t==="overlayColor"&&e.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[t],'"',"></rect>")},sendToBack:function(e){return n(this._objects,e),this._objects.unshift(e),this.renderAll&&this.renderAll()},bringToFront:function(e){return n(this._objects,e),this._objects.push(e),this.renderAll&&this.renderAll()},sendBackwards:function(e,t){var r=this._objects.indexOf(e);if(r!==0){var i=this._findNewLowerIndex(e,r,t);n(this._objects,e),this._objects.splice(i,0,e),this.renderAll&&this.renderAll()}return this},_findNewLowerIndex:function(e,t,n){var r;if(n){r=t;for(var i=t-1;i>=0;--i){var s=e.intersectsWithObject(this._objects[i])||e.isContainedWithinObject(this._objects
[i])||this._objects[i].isContainedWithinObject(e);if(s){r=i;break}}}else r=t-1;return r},bringForward:function(e,t){var r=this._objects.indexOf(e);if(r!==this._objects.length-1){var i=this._findNewUpperIndex(e,r,t);n(this._objects,e),this._objects.splice(i,0,e),this.renderAll&&this.renderAll()}return this},_findNewUpperIndex:function(e,t,n){var r;if(n){r=t;for(var i=t+1;i<this._objects.length;++i){var s=e.intersectsWithObject(this._objects[i])||e.isContainedWithinObject(this._objects[i])||this._objects[i].isContainedWithinObject(e);if(s){r=i;break}}}else r=t+1;return r},moveTo:function(e,t){return n(this._objects,e),this._objects.splice(t,0,e),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this.interactive&&this.removeListeners(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): "+"{ objects: "+this.getObjects().length+" }>"}}),e(fabric.StaticCanvas.prototype,fabric.Observable),e(fabric.StaticCanvas.prototype,fabric.Collection),e(fabric.StaticCanvas.prototype,fabric.DataURLExporter),e(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(e){var t=fabric.util.createCanvasElement();if(!t||!t.getContext)return null;var n=t.getContext("2d");if(!n)return null;switch(e){case"getImageData":return typeof n.getImageData!="undefined";case"setLineDash":return typeof n.setLineDash!="undefined";case"toDataURL":return typeof t.toDataURL!="undefined";case"toDataURLWithQuality":try{return t.toDataURL("image/jpeg",0),!0}catch(r){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}(),fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",setShadow:function(e){return this.shadow=new fabric.Shadow(e),this},_setBrushStyles:function(){var e=this.canvas.contextTop;e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.lineJoin=this.strokeLineJoin},_setShadow:function(){if(!this.shadow)return;var e=this.canvas.contextTop;e.shadowColor=this.shadow.color,e.shadowBlur=this.shadow.blur,e.shadowOffsetX=this.shadow.offsetX,e.shadowOffsetY=this.shadow.offsetY},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}}),function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(e){this.canvas=e,this._points=[]},onMouseDown:function(e){this._prepareForDrawing(e),this._captureDrawingPath(e),this._render()},onMouseMove:function(e){this._captureDrawingPath(e),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(e){var t=new fabric.Point(e.x,e.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(e){this._points.push(e)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(e){var t=new fabric.Point(e.x,e.y);this._addPoint(t)},_render:function(){var e=this.canvas.contextTop,t=this.canvas.viewportTransform,n=this._points[0],r=this._points[1];e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5]),e.beginPath(),this._points.length===2&&n.x===r.x&&n.y===r.y&&(n.x-=.5,r.x+=.5),e.moveTo(n.x,n.y);for(var i=1,s=this._points.length;i<s;i++){var o=n.midPointFrom(r);e.quadraticCurveTo(n.x,n.y,o.x,o.y),n=this._points[i],r=this._points[i+1]}e.lineTo(n.x,n.y),e.stroke(),e.restore()},convertPointsToSVGPath:function(e){var t=[],n=new fabric.Point(e[0].x,e[0].y),r=new fabric.Point(e[1].x,e[1].y);t.push("M ",e[0].x," ",e[0].y," ");for(var i=1,s=e.length;i<s;i++){var o=n.midPointFrom(r);t.push("Q ",n.x," ",n.y," ",o.x," ",o.y," "),n=new fabric.Point(e[i].x,e[i].y),i+1<e.length&&(r=new fabric.Point(e[i+1].x,e[i+1].y))}return t.push("L ",n.x," ",n.y," "),t},createPath:function(e){var t=new fabric.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,originX:"center",originY:"center"});return this.shadow&&(this.shadow.affectStroke=!0,t.setShadow(this.shadow)),t},_finalizeAndAddPath:function(){var e=this.canvas.contextTop;e.closePath();var t=this.convertPointsToSVGPath(this._points).join("");if(t==="M 0 0 Q 0 0 0 0 L 0 0"){this.canvas.renderAll();return}var n=this.createPath(t);this.canvas.add(n),n.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:n})}})}(),fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(e){this.canvas=e,this.points=[]},drawDot:function(e){var t=this.addPoint(e),n=this.canvas.contextTop,r=this.canvas.viewportTransform;n.save(),n.transform(r[0],r[1],r[2],r[3],r[4],r[5]),n.fillStyle=t.fill,n.beginPath(),n.arc(t.x,t.y,t.radius,0,Math.PI*2,!1),n.closePath(),n.fill(),n.restore()},onMouseDown:function(e){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)},onMouseMove:function(e){this.drawDot(e)},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var t=[];for(var n=0,r=this.points.length;n<r;n++){var i=this.points[n],s=new fabric.Circle({radius:i.radius,left:i.x,top:i.y,originX:"center",originY:"center",fill:i.fill});this.shadow&&s.setShadow(this.shadow),t.push(s)}var o=new fabric.Group(t,{originX:"center",originY:"center"});o.canvas=this.canvas,this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.renderAll()},addPoint:function(e){var t=new fabric.Point(e.x,e.y),n=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,r=(new fabric.Color(this.color)).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return t.radius=n,t.fill=r,this.points.push(t),t}}),fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e,this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.render()},onMouseMove:function(e){this.addSprayChunk(e),this.render()},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var t=[];for(var n=0,r=this.sprayChunks.length;n<r;n++){var i=this.sprayChunks[n];for(var s=0,o=i.length;s<o;s++){var u=new fabric.Rect({width:i[s].width,height:i[s].width,left:i[s].x+1,top:i[s].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&u.setShadow(this.shadow),t.push(u)}}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var a=new fabric.Group(t,{originX:"center",originY:"center"});a.canvas=this.canvas,this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.renderAll()},_getOptimizedRects:function(e){var t={},n;for(var r=0,i=e.length;r<i;r++)n=e[r].left+""+e[r].top,t[n]||(t[n]=e[r]);var s=[];for(n in t)s.push(t[n]);return s},render:function(){var e=this.canvas.contextTop;e.fillStyle=this.color;var t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5]);for(var n=0,r=this.sprayChunkPoints.length;n<r;n++){var i=this.sprayChunkPoints[n];typeof i.opacity!="undefined"&&(e.globalAlpha=i.opacity),e.fillRect(i.x,i.y,i.width,i.width)}e.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];var t,n,r,i=this.width/2;for(var s=0;s<this.density;s++){t=fabric.util.getRandomInt(e.x-i,e.x+i),n=fabric.util.getRandomInt(e.y-i,e.y+i),this.dotWidthVariance?r=fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):r=this.dotWidth;var o=new fabric.Point(t,n);o.width=r,this.randomOpacity&&(o.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(o)}this.sprayChunks.push(this.sprayChunkPoints)}}),fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var e=20,t=5,n=fabric.document.createElement("canvas"),r=n.getContext("2d");return n.width=n.height=e+t,r.fillStyle=this.color,r.beginPath(),r.arc(e/2,e/2,e/2,0,Math.PI*2,!1),r.closePath(),r.fill(),n},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(e){var t=this.callSuper("createPath",e);return t.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction()}),t}}),function(){var e=fabric.util.getPointer,t=fabric.util.degreesToRadians,n=fabric.util.radiansToDegrees,r=Math.atan2,i=Math.abs,s=.5;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(e,t){t||(t={}),this._initStatic(e,t),this._initInteractive(),this._createCacheCanvas(),fabric.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_resetCurrentTransform:function(e){var t=this._currentTransform;t.target.set({scaleX:t.original.scaleX,scaleY:t.original.scaleY,left:t.original.left,top:t.original.top}),this._shouldCenterTransform(e,t.target)?t.action==="rotate"?this._setOriginToCenter(t.target):(t.originX!=="center"&&(t.originX==="right"?t.mouseXSign=-1:t.mouseXSign=1),t.originY!=="center"&&(t.originY==="bottom"?t.mouseYSign=-1:t.mouseYSign=1),t.originX="center",t.originY="center"):(t.originX=t.original.originX,t.originY=t.original.originY)},containsPoint:function(e,t){var n=this.getPointer(e,!0),r=this._normalizePointer(t,n);return t.containsPoint(r)||t._findTargetCorner(n)},_normalizePointer:function(e,t){var n=this.getActiveGroup(),r=t.x,i=t.y,s=n&&e.type!=="group"&&n.contains(e),o;return s&&(o=new fabric.Point(n.left,n.top),o=fabric.util.transformPoint(o,this.viewportTransform,!0),r-=o.x,i-=o.y),{x:r,y:i}},isTargetTransparent:function(e,t,n){var r=e.hasBorders,i=e.transparentCorners;e.hasBorders=e.transparentCorners=!1,this._draw(this.contextCache,e),e.hasBorders=r,e.transparentCorners=i;var s=fabric.util.isTransparent(this.contextCache,t,n,this.targetFindTolerance);return this.clearContext(this.contextCache),s},_shouldClearSelection:function(e,t){var n=this.getActiveGroup(),r=this.getActiveObject();return!t||t&&n&&!n.contains(t)&&n!==t&&!e.shiftKey||t&&!t.evented||t&&!t.selectable&&r&&r!==t},_shouldCenterTransform:function(e,t){if(!t)return;var n=this._currentTransform,r;return n.action==="scale"||n.action==="scaleX"||n.action==="scaleY"?r=this.centeredScaling||t.centeredScaling:n.action==="rotate"&&(r=this.centeredRotation||t.centeredRotation),r?!e.altKey:e.altKey},_getOriginFromCorner:function(e,t){var n={x:e.originX,y:e.originY};if(t==="ml"||t==="tl"||t==="bl")n.x="right";else if(t==="mr"||t==="tr"||t==="br")n.x="left";if(t==="tl"||t==="mt"||t==="tr")n.y="bottom";else if(t==="bl"||t==="mb"||t==="br")n.y="top";return n},_getActionFromCorner:function(e,t){var n="drag";return t&&(n=t==="ml"||t==="mr"?"scaleX":t==="mt"||t==="mb"?"scaleY":t==="mtr"?"rotate":"scale"),n},_setupCurrentTransform:function(e,n){if(!n)return;var r=this.getPointer(e),i=n._findTargetCorner(this.getPointer(e,!0)),s=this._getActionFromCorner(n,i),o=this._getOriginFromCorner(n,i);this._currentTransform={target:n,action:s,scaleX:n.scaleX,scaleY:n.scaleY,offsetX:r.x-n.left,offsetY:r.y-n.top,originX:o.x,originY:o.y,ex:r.x,ey:r.y,left:n.left,top:n.top,theta:t(n.angle),width:n.width*n.scaleX,mouseXSign:1,mouseYSign:1},this._currentTransform.original={left:n.left,top:n.top,scaleX:n.scaleX,scaleY:n.scaleY,originX:o.x,originY:o.y},this._resetCurrentTransform(e)},_translateObject:function(e,t){var n=this._currentTransform.target;n.get("lockMovementX")||n.set("left",e-this._currentTransform.offsetX),n.get("lockMovementY")||n.set("top",t-this._currentTransform.offsetY)},_scaleObject:function(e,t,n){var r=this._currentTransform,i=r.target,s=i.get("lockScalingX"),o=i.get("lockScalingY"),u=i.get("lockScalingFlip");if(s&&o)return;var a=i.translateToOriginPoint(i.getCenterPoint(),r.originX,r.originY),f=i.toLocalPoint(new fabric.Point(e,t),r.originX,r.originY);this._setLocalMouse(f,r),this._setObjectScale(f,r,s,o,n,u),i.setPositionByOrigin(a,r.originX,r.originY)},_setObjectScale:function(e,t,n,r,i,s){var o=t.target,u=!1,a=!1,f=o.stroke?o.strokeWidth:0;t.newScaleX=e.x/(o.width+f/2),t.newScaleY=e.y/(o.height+f/2),s&&t.newScaleX<=0&&t.newScaleX<o.scaleX&&(u=!0),s&&t.newScaleY<=0&&t.newScaleY<o.scaleY&&(a=!0),i==="equally"&&!n&&!r?u||a||this._scaleObjectEqually(e,o,t):i?i==="x"&&!o.get("lockUniScaling")?u||n||o.set("scaleX",t.newScaleX):i==="y"&&!o.get("lockUniScaling")&&(a||r||o.set("scaleY",t.newScaleY)):(u||n||o.set("scaleX",t.newScaleX),a||r||o.set("scaleY",t.newScaleY)),u||a||this._flipObject(t,i)},_scaleObjectEqually:function(e,t,n){var r=e.y+e.x,i=t.stroke?t.strokeWidth:0,s=(t.height+i/2)*n.original.scaleY+(t.width+i/2)*n.original.scaleX;n.newScaleX=n.original.scaleX*r/s,n.newScaleY=n.original.scaleY*r/s,t.set("scaleX",n.newScaleX),t.set("scaleY",n.newScaleY)},_flipObject:function(e,t){e.newScaleX<0&&t!=="y"&&(e.originX==="left"?e.originX="right":e.originX==="right"&&(e.originX="left")),e.newScaleY<0&&t!=="x"&&(e.originY==="top"?e.originY="bottom":e.originY==="bottom"&&(e.originY="top"))},_setLocalMouse:function(e,t){var n=t.target;t.originX==="right"?e.x*=-1:t.originX==="center"&&(e.x*=t.mouseXSign*2,e.x<0&&(t.mouseXSign=-t.mouseXSign)),t.originY==="bottom"?e.y*=-1:t.originY==="center"&&(e.y*=t.mouseYSign*2,e.y<0&&(t.mouseYSign=-t.mouseYSign)),i(e.x)>n.padding?e.x<0?e.x+=n.padding:e.x-=n.padding:e.x=0,i(e.y)>n.padding?e.y<0?e.y+=n.padding:e.y-=n.padding:e.y=0},_rotateObject:function(e,t){var i=this._currentTransform;if(i.target.get("lockRotation"))return;var s=r(i.ey-i.top,i.ex-i.left),o=r(t-i.top,e-i.left),u=n(o-s+i.theta);u<0&&(u=360+u),i.target.angle=u%360},setCursor:function(e){this.upperCanvasEl.style.cursor=e},_resetObjectTransform:function(e){e.scaleX=1,e.scaleY=1,e.setAngle(0)},_drawSelection:function(){var e=this.contextTop,t=this._groupSelector,n=t.left,r=t.top,o=i(n),u=i(r);e.fillStyle=this.selectionColor,e.fillRect(t.ex-(n>0?0:-n),t.ey-(r>0?0:-r),o,u),e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor;if(this.selectionDashArray.length>1){var a=t.ex+s-(n>0?0:o),f=t.ey+s-(r>0?0:u);e.beginPath(),fabric.util.drawDashedLine(e,a,f,a+o,f,this.selectionDashArray),fabric.util.drawDashedLine(e,a,f+u-1,a+o,f+u-1,this.selectionDashArray),fabric.util.drawDashedLine(e,a,f,a,f+u,this.selectionDashArray),fabric.util.drawDashedLine(e,a+o-1,f,a+o-1,f+u,this.selectionDashArray),e.closePath(),e.stroke()}else e.strokeRect(t.ex+s-(n>0?0:o),t.ey+s-(r>0?0:u),o,u)},_isLastRenderedObject:function(e){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(e,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(e,!0))},findTarget:function(e,t){if(this.skipTargetFind)return;if(this._isLastRenderedObject(e))return this.lastRenderedObjectWithControlsAboveOverlay;var n=this.getActiveGroup();if(n&&!t&&this.containsPoint(e,n))return n;var r=this._searchPossibleTargets(e);return this._fireOverOutEvents(r),r},_fireOverOutEvents:function(e){e?this._hoveredTarget!==e&&(this.fire("mouse:over",{target:e}),e.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),this._hoveredTarget=e):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(e,t,n){if(t&&t.visible&&t.evented&&this.containsPoint(e,t)){if(!this.perPixelTargetFind&&!t.perPixelTargetFind||!!t.isEditing)return!0;var r=this.isTargetTransparent(t,n.x,n.y);if(!r)return!0}},_searchPossibleTargets:function(e){var t,n=this.getPointer(e,!0),r=this._objects.length;while(r--)if(this._checkTarget(e,this._objects[r],n)){this.relatedTarget=this._objects[r],t=this._objects[r];break}return t},getPointer:function(t,n,r){r||(r=this.upperCanvasEl);var i=e(t,r),s=r.getBoundingClientRect(),o=s.width||0,u=s.height||0,a;if(!o||!u)"top"in s&&"bottom"in s&&(u=Math.abs(s.top-s.bottom)),"right"in s&&"left"in s&&(o=Math.abs(s.right-s.left));return this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,n||(i=fabric.util.transformPoint(i,fabric.util.invertTransform(this.viewportTransform))),o===0||u===0?a={width:1,height:1}:a={width:r.width/o,height:r.height/u},{x:i.x*a.width,y:i.y*a.height}},_createUpperCanvas:function(){var e=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+e),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(e){var t=this.getWidth()||e.width,n=this.getHeight()||e.height;fabric.util.setStyle(e,{position:"absolute",width:t+"px",height:n+"px",left:0,top:0}),e.width=t,e.height=n,fabric.util.makeElementUnselectable(e)},_copyCanvasStyle:function(e,t){t.style.cssText=e.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(e){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=e,e.set("active",!0)},setActiveObject:function(e,t){return this._setActiveObject(e),this.renderAll(),this.fire("object:selected",{target:e,e:t}),e.fire("selected",{e:t}),this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=null},discardActiveObject:function(e){return this._discardActiveObject(),this.renderAll(),this.fire("selection:cleared",{e:e}),this},_setActiveGroup:function(e){this._activeGroup=e,e&&e.set("active",!0)},setActiveGroup:function(e,t){return this._setActiveGroup(e),e&&(this.fire("object:selected",{target:e,e:t}),e.fire("selected",{e:t})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var e=this.getActiveGroup();e&&e.destroy(),this.setActiveGroup(null)},discardActiveGroup:function(e){return this._discardActiveGroup(),this.fire("selection:cleared",{e:e}),this},deactivateAll:function(){var e=this.getObjects(),t=0,n=e.length;for(;t<n;t++)e[t].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(e){var t=this.getActiveGroup()||this.getActiveObject();return t&&this.fire("before:selection:cleared",{target:t,e:e}),this.deactivateAll(),t&&this.fire("selection:cleared",{e:e}),this},drawControls:function(e){var t=this.getActiveGroup();t?this._drawGroupControls(e,t):this._drawObjectsControls(e)},_drawGroupControls:function(e,t){t._renderControls(e)},_drawObjectsControls:function(e){for(var t=0,n=this._objects.length;t<n;++t){if(!this._objects[t]||!this._objects[t].active)continue;this._objects[t]._renderControls(e),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[t]}}});for(var o in fabric.StaticCanvas)o!=="prototype"&&(fabric.Canvas[o]=fabric.StaticCanvas[o]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){}),fabric.Element=fabric.Canvas}(),function(){var e={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},t=fabric.util.addListener,n=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this._bindEvents(),t(fabric.window,"resize",this._onResize),t(this.upperCanvasEl,"mousedown",this._onMouseDown),t(this.upperCanvasEl,"mousemove",this._onMouseMove),t(this.upperCanvasEl,"mousewheel",this._onMouseWheel),t(this.upperCanvasEl,"touchstart",this._onMouseDown),t(this.upperCanvasEl,"touchmove",this._onMouseMove),typeof Event!="undefined"&&"add"in Event&&(Event.add(this.upperCanvasEl,"gesture",this._onGesture),Event.add(this.upperCanvasEl,"drag",this._onDrag),Event.add(this.upperCanvasEl,"orientation",this._onOrientationChange),Event.add(this.upperCanvasEl,"shake",this._onShake),Event.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){n(fabric.window,"resize",this._onResize),n(this.upperCanvasEl,"mousedown",this._onMouseDown),n(this.upperCanvasEl,"mousemove",this._onMouseMove),n(this.upperCanvasEl,"mousewheel",this._onMouseWheel),n(this.upperCanvasEl,"touchstart",this._onMouseDown),n(this.upperCanvasEl,"touchmove",this._onMouseMove),typeof Event!="undefined"&&"remove"in Event&&(Event.remove(this.upperCanvasEl,"gesture",this._onGesture),Event.remove(this.upperCanvasEl,"drag",this._onDrag),Event.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),Event.remove(this.upperCanvasEl,"shake",this._onShake),Event.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(e,t){this.__onTransformGesture&&this.__onTransformGesture(e,t)},_onDrag:function(e,t){this.__onDrag&&this.__onDrag(e,t)},_onMouseWheel:function(e,t){this.__onMouseWheel&&this.__onMouseWheel(e,t)},_onOrientationChange:function(e,t){this.__onOrientationChange&&this.__onOrientationChange(e,t)},_onShake:function(e,t){this.__onShake&&this.__onShake(e,t)},_onLongPress:function(e,t){this.__onLongPress&&this.__onLongPress(e,t)},_onMouseDown:function(e){this.__onMouseDown(e),t(fabric.document,"touchend",this._onMouseUp),t(fabric.document,"touchmove",this._onMouseMove),n(this.upperCanvasEl,"mousemove",this._onMouseMove),n(this.upperCanvasEl,"touchmove",this._onMouseMove),e.type==="touchstart"?n(this.upperCanvasEl,"mousedown",this._onMouseDown):(t(fabric.document,"mouseup",this._onMouseUp),t(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(e){this.__onMouseUp(e),n(fabric.document,"mouseup",this._onMouseUp),n(fabric.document,"touchend",this._onMouseUp),n(fabric.document,"mousemove",this._onMouseMove),n(fabric.document,"touchmove",this._onMouseMove),t(this.upperCanvasEl,"mousemove",this._onMouseMove),t(this.upperCanvasEl,"touchmove",this._onMouseMove);if(e.type==="touchend"){var r=this;setTimeout(function(){t(r.upperCanvasEl,"mousedown",r._onMouseDown)},400)}},_onMouseMove:function(e){!this.allowTouchScrolling&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)},_onResize:function(){this.calcOffset()},_shouldRender:function(e,t){var n=this.getActiveGroup()||this.getActiveObject();return!!(e&&(e.isMoving||e!==n)||!e&&!!n||!e&&!n&&!this._groupSelector||t&&this._previousPointer&&this.selection&&(t.x!==this._previousPointer.x||t.y!==this._previousPointer.y))},__onMouseUp:function(e){var t;if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(e);return}this._currentTransform?(this._finalizeCurrentTransform(),t=this._currentTransform.target):t=this.findTarget(e,!0);var n=this._shouldRender(t,this.getPointer(e));this._maybeGroupObjects(e),t&&(t.isMoving=!1),n&&this.renderAll(),this._handleCursorAndEvent(e,t)},_handleCursorAndEvent:function(e,t){this._setCursorFromEvent(e,t);var n=this;setTimeout(function(){n._setCursorFromEvent(e,t)},50),this.fire("mouse:up",{target:t,e:e}),t&&t.fire("mouseup",{e:e})},_finalizeCurrentTransform:function(){var e=this._currentTransform,t=e.target;t._scaling&&(t._scaling=!1),t.setCoords(),this.stateful&&t.hasStateChanged()&&(this.fire("object:modified",{target:t}),t.fire("modified")),this._restoreOriginXY(t)},_restoreOriginXY:function(e){if(this._previousOriginX&&this._previousOriginY){var t=e.translateToOriginPoint(e.getCenterPoint(),this._previousOriginX,this._previousOriginY);e.originX=this._previousOriginX,e.originY=this._previousOriginY,e.left=t.x,e.top=t.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(e){this._isCurrentlyDrawing=!0,this.discardActiveObject(e).renderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop);var t=fabric.util.invertTransform(this.viewportTransform),n=fabric.util.transformPoint(this.getPointer(e,!0),t);this.freeDrawingBrush.onMouseDown(n),this.fire("mouse:down",{e:e});var r=this.findTarget(e);typeof r!="undefined"&&r.fire("mousedown",{e:e,target:r})},_onMouseMoveInDrawingMode:function(e){if(this._isCurrentlyDrawing){var t=fabric.util.invertTransform(this.viewportTransform),n=fabric.util.transformPoint(this.getPointer(e,!0),t);this.freeDrawingBrush.onMouseMove(n)}this.setCursor(this.freeDrawingCursor),this.fire("mouse:move",{e:e});var r=this.findTarget(e);typeof r!="undefined"&&r.fire("mousemove",{e:e,target:r})},_onMouseUpInDrawingMode:function(e){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this.fire("mouse:up",{e:e});var t=this.findTarget(e);typeof t!="undefined"&&t.fire("mouseup",{e:e,target:t})},__onMouseDown:function(e){var t="which"in e?e.which===1:e.button===1;if(!t&&!fabric.isTouchSupported)return;if(this.isDrawingMode){this._onMouseDownInDrawingMode(e);return}if(this._currentTransform)return;var n=this.findTarget(e),r=this.getPointer(e,!0);this._previousPointer=r;var i=this._shouldRender(n,r),s=this._shouldGroup(e,n);this._shouldClearSelection(e,n)?this._clearSelection(e,n,r):s&&(this._handleGrouping(e,n),n=this.getActiveGroup()),n&&n.selectable&&!s&&(this._beforeTransform(e,n),this._setupCurrentTransform(e,n)),i&&this.renderAll(),this.fire("mouse:down",{target:n,e:e}),n&&n.fire("mousedown",{e:e})},_beforeTransform:function(e,t){var n;this.stateful&&t.saveState(),(n=t._findTargetCorner(this.getPointer(e)))&&this.onBeforeScaleRotate(t),t!==this.getActiveGroup()&&t!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(t,e))},_clearSelection:function(e,t,n){this.deactivateAllWithDispatch(e),t&&t.selectable?this.setActiveObject(t,e):this.selection&&(this._groupSelector={ex:n.x,ey:n.y,top:0,left:0})},_setOriginToCenter:function(e){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var t=e.getCenterPoint();e.originX="center",e.originY="center",e.left=t.x,e.top=t.y,this._currentTransform.left=e.left,this._currentTransform.top=e.top},_setCenterToOrigin:function(e){var t=e.translateToOriginPoint(e.getCenterPoint(),this._previousOriginX,this._previousOriginY);e.originX=this._previousOriginX,e.originY=this._previousOriginY,e.left=t.x,e.top=t.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(e){var t,n;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(e);return}if(typeof e.touches!="undefined"&&e.touches.length>1)return;var r=this._groupSelector;r?(n=this.getPointer(e,!0),r.left=n.x-r.ex,r.top=n.y-r.ey,this.renderTop()):this._currentTransform?this._transformObject(e):(t=this.findTarget(e),!t||t&&!t.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(e,t)),this.fire("mouse:move",{target:t,e:e}),t&&t.fire("mousemove",{e:e})},_transformObject:function(e){var t=this.getPointer(e),n=this._currentTransform;n.reset=!1,n.target.isMoving=!0,this._beforeScaleTransform(e,n),this._performTransformAction(e,n,t),this.renderAll()},_performTransformAction:function(e,t,n){var r=n.x,i=n.y,s=t.target,o=t.action;o==="rotate"?(this._rotateObject(r,i),this._fire("rotating",s,e)):o==="scale"?(this._onScale(e,t,r,i),this._fire("scaling",s,e)):o==="scaleX"?(this._scaleObject(r,i,"x"),this._fire("scaling",s,e)):o==="scaleY"?(this._scaleObject(r,i,"y"),this._fire("scaling",s,e)):(this._translateObject(r,i),this._fire("moving",s,e),this.setCursor(this.moveCursor))},_fire:function(e,t,n){this.fire("object:"+e,{target:t,e:n}),t.fire(e,{e:n})},_beforeScaleTransform:function(e,t){if(t.action==="scale"||t.action==="scaleX"||t.action==="scaleY"){var n=this._shouldCenterTransform(e,t.target);if(n&&(t.originX!=="center"||t.originY!=="center")||!n&&t.originX==="center"&&t.originY==="center")this._resetCurrentTransform(e),t.reset=!0}},_onScale:function(e,t,n,r){(e.shiftKey||this.uniScaleTransform)&&!t.target.get("lockUniScaling")?(t.currentAction="scale",this._scaleObject(n,r)):(!t.reset&&t.currentAction==="scale"&&this._resetCurrentTransform(e,t.target),t.currentAction="scaleEqually",this._scaleObject(n,r,"equally"))},_setCursorFromEvent:function(e,t){if(!t||!t.selectable)return this.setCursor(this.defaultCursor),!1;var n=this.getActiveGroup(),r=t._findTargetCorner&&(!n||!n.contains(t))&&t._findTargetCorner(this.getPointer(e,!0));return r?this._setCornerCursor(r,t):this.setCursor(t.hoverCursor||this.hoverCursor),!0},_setCornerCursor:function(t,n){if(t in e)this.setCursor(this._getRotatedCornerCursor(t,n));else{if(t!=="mtr"||!n.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}},_getRotatedCornerCursor:function(t,n){var r=Math.round(n.getAngle()%360/45);return r<0&&(r+=8),r+=e[t],r%=8,this.cursorMap[r]}})}(),function(){var e=Math.min,t=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(e,t){var n=this.getActiveObject();return e.shiftKey&&(this.getActiveGroup()||n&&n!==t)&&this.selection},_handleGrouping:function(e,t){if(t===this.getActiveGroup()){t=this.findTarget(e,!0);if(!t||t.isType("group"))return}this.getActiveGroup()?this._updateActiveGroup(t,e):this._createActiveGroup(t,e),this._activeGroup&&this._activeGroup.saveCoords()},_updateActiveGroup:function(e,t){var n=this.getActiveGroup();if(n.contains(e)){n.removeWithUpdate(e),this._resetObjectTransform(n),e.set("active",!1);if(n.size()===1){this.discardActiveGroup(t),this.setActiveObject(n.item(0));return}}else n.addWithUpdate(e),this._resetObjectTransform(n);this.fire("selection:created",{target:n,e:t}),n.set("active",!0)},_createActiveGroup:function(e,t){if(this._activeObject&&e!==this._activeObject){var n=this._createGroup(e);n.addWithUpdate(),this.setActiveGroup(n),this._activeObject=null,this.fire("selection:created",{target:n,e:t})}e.set("active",!0)},_createGroup:function(e){var t=this.getObjects(),n=t.indexOf(this._activeObject)<t.indexOf(e),r=n?[this._activeObject,e]:[e,this._activeObject];return new fabric.Group(r,{canvas:this})},_groupSelectedObjects:function(e){var t=this._collectObjects();t.length===1?this.setActiveObject(t[0],e):t.length>1&&(t=new fabric.Group(t.reverse(),{canvas:this}),t.addWithUpdate(),this.setActiveGroup(t,e),t.saveCoords(),this.fire("selection:created",{target:t}),this.renderAll())},_collectObjects:function(){var n=[],r,i=this._groupSelector.ex,s=this._groupSelector.ey,o=i+this._groupSelector.left,u=s+this._groupSelector.top,a=new fabric.Point(e(i,o),e(s,u)),f=new fabric.Point(t(i,o),t(s,u)),l=i===o&&s===u
;for(var c=this._objects.length;c--;){r=this._objects[c];if(!r||!r.selectable||!r.visible)continue;if(r.intersectsWithRect(a,f)||r.isContainedWithinRect(a,f)||r.containsPoint(a)||r.containsPoint(f)){r.set("active",!0),n.push(r);if(l)break}}return n},_maybeGroupObjects:function(e){this.selection&&this._groupSelector&&this._groupSelectedObjects(e);var t=this.getActiveGroup();t&&(t.setObjectsCoords().setCoords(),t.isMoving=!1,this.setCursor(this.defaultCursor)),this._groupSelector=null,this._currentTransform=null}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var t=e.format||"png",n=e.quality||1,r=e.multiplier||1,i={left:e.left,top:e.top,width:e.width,height:e.height};return r!==1?this.__toDataURLWithMultiplier(t,n,i,r):this.__toDataURL(t,n,i)},__toDataURL:function(e,t,n){this.renderAll(!0);var r=this.upperCanvasEl||this.lowerCanvasEl,i=this.__getCroppedCanvas(r,n);e==="jpg"&&(e="jpeg");var s=fabric.StaticCanvas.supports("toDataURLWithQuality")?(i||r).toDataURL("image/"+e,t):(i||r).toDataURL("image/"+e);return this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),i&&(i=null),s},__getCroppedCanvas:function(e,t){var n,r,i="left"in t||"top"in t||"width"in t||"height"in t;return i&&(n=fabric.util.createCanvasElement(),r=n.getContext("2d"),n.width=t.width||this.width,n.height=t.height||this.height,r.drawImage(e,-t.left||0,-t.top||0)),n},__toDataURLWithMultiplier:function(e,t,n,r){var i=this.getWidth(),s=this.getHeight(),o=i*r,u=s*r,a=this.getActiveObject(),f=this.getActiveGroup(),l=this.contextTop||this.contextContainer;r>1&&this.setWidth(o).setHeight(u),l.scale(r,r),n.left&&(n.left*=r),n.top&&(n.top*=r),n.width?n.width*=r:r<1&&(n.width=o),n.height?n.height*=r:r<1&&(n.height=u),f?this._tempRemoveBordersControlsFromGroup(f):a&&this.deactivateAll&&this.deactivateAll(),this.renderAll(!0);var c=this.__toDataURL(e,t,n);return this.width=i,this.height=s,l.scale(1/r,1/r),this.setWidth(i).setHeight(s),f?this._restoreBordersControlsOnGroup(f):a&&this.setActiveObject&&this.setActiveObject(a),this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),c},toDataURLWithMultiplier:function(e,t,n){return this.toDataURL({format:e,multiplier:t,quality:n})},_tempRemoveBordersControlsFromGroup:function(e){e.origHasControls=e.hasControls,e.origBorderColor=e.borderColor,e.hasControls=!0,e.borderColor="rgba(0,0,0,0)",e.forEachObject(function(e){e.origBorderColor=e.borderColor,e.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(e){e.hideControls=e.origHideControls,e.borderColor=e.origBorderColor,e.forEachObject(function(e){e.borderColor=e.origBorderColor,delete e.origBorderColor})}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(e,t,n){return this.loadFromJSON(e,t,n)},loadFromJSON:function(e,t,n){if(!e)return;var r=typeof e=="string"?JSON.parse(e):e;this.clear();var i=this;return this._enlivenObjects(r.objects,function(){i._setBgOverlay(r,t)},n),this},_setBgOverlay:function(e,t){var n=this,r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!e.backgroundImage&&!e.overlayImage&&!e.background&&!e.overlay){t&&t();return}var i=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&(n.renderAll(),t&&t())};this.__setBgOverlay("backgroundImage",e.backgroundImage,r,i),this.__setBgOverlay("overlayImage",e.overlayImage,r,i),this.__setBgOverlay("backgroundColor",e.background,r,i),this.__setBgOverlay("overlayColor",e.overlay,r,i),i()},__setBgOverlay:function(e,t,n,r){var i=this;if(!t){n[e]=!0;return}e==="backgroundImage"||e==="overlayImage"?fabric.Image.fromObject(t,function(t){i[e]=t,n[e]=!0,r&&r()}):this["set"+fabric.util.string.capitalize(e,!0)](t,function(){n[e]=!0,r&&r()})},_enlivenObjects:function(e,t,n){var r=this;if(!e||e.length===0){t&&t();return}var i=this.renderOnAddRemove;this.renderOnAddRemove=!1,fabric.util.enlivenObjects(e,function(e){e.forEach(function(e,t){r.insertAt(e,t,!0)}),r.renderOnAddRemove=i,t&&t()},null,n)},_toDataURL:function(e,t){this.clone(function(n){t(n.toDataURL(e))})},_toDataURLWithMultiplier:function(e,t,n){this.clone(function(r){n(r.toDataURLWithMultiplier(e,t))})},clone:function(e,t){var n=JSON.stringify(this.toJSON(t));this.cloneWithoutData(function(t){t.loadFromJSON(n,function(){e&&e(t)})})},cloneWithoutData:function(e){var t=fabric.document.createElement("canvas");t.width=this.getWidth(),t.height=this.getHeight();var n=new fabric.Canvas(t);n.clipTo=this.clipTo,this.backgroundImage?(n.setBackgroundImage(this.backgroundImage.src,function(){n.renderAll(),e&&e(n)}),n.backgroundImageOpacity=this.backgroundImageOpacity,n.backgroundImageStretch=this.backgroundImageStretch):e&&e(n)}}),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,r=t.util.toFixed,i=t.util.string.capitalize,s=t.util.degreesToRadians,o=t.StaticCanvas.supports("setLineDash");if(t.Object)return;t.Object=t.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),initialize:function(e){e&&this.setOptions(e)},_initGradient:function(e){e.fill&&e.fill.colorStops&&!(e.fill instanceof t.Gradient)&&this.set("fill",new t.Gradient(e.fill))},_initPattern:function(e){e.fill&&e.fill.source&&!(e.fill instanceof t.Pattern)&&this.set("fill",new t.Pattern(e.fill)),e.stroke&&e.stroke.source&&!(e.stroke instanceof t.Pattern)&&this.set("stroke",new t.Pattern(e.stroke))},_initClipping:function(e){if(!e.clipTo||typeof e.clipTo!="string")return;var n=t.util.getFunctionBody(e.clipTo);typeof n!="undefined"&&(this.clipTo=new Function("ctx",n))},setOptions:function(e){for(var t in e)this.set(t,e[t]);this._initGradient(e),this._initPattern(e),this._initClipping(e)},transform:function(e,t){this.group&&this.group.transform(e,t);var n=t?this._getLeftTopCoords():this.getCenterPoint();e.translate(n.x,n.y),e.rotate(s(this.angle)),e.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(e){var n=t.Object.NUM_FRACTION_DIGITS,i={type:this.type,originX:this.originX,originY:this.originY,left:r(this.left,n),top:r(this.top,n),width:r(this.width,n),height:r(this.height,n),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,n),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:r(this.strokeMiterLimit,n),scaleX:r(this.scaleX,n),scaleY:r(this.scaleY,n),angle:r(this.getAngle(),n),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,n),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};return this.includeDefaultValues||(i=this._removeDefaultValues(i)),t.util.populateWithProperties(this,i,e),i},toDatalessObject:function(e){return this.toObject(e)},_removeDefaultValues:function(e){var n=t.util.getKlass(e.type).prototype,r=n.stateProperties;return r.forEach(function(t){e[t]===n[t]&&delete e[t]}),e},toString:function(){return"#<fabric."+i(this.type)+">"},get:function(e){return this[e]},_setObject:function(e){for(var t in e)this._set(t,e[t])},set:function(e,t){return typeof e=="object"?this._setObject(e):typeof t=="function"&&e!=="clipTo"?this._set(e,t(this.get(e))):this._set(e,t),this},_set:function(e,n){var i=e==="scaleX"||e==="scaleY";return i&&(n=this._constrainScale(n)),e==="scaleX"&&n<0?(this.flipX=!this.flipX,n*=-1):e==="scaleY"&&n<0?(this.flipY=!this.flipY,n*=-1):e==="width"||e==="height"?this.minScaleLimit=r(Math.min(.1,1/Math.max(this.width,this.height)),2):e==="shadow"&&n&&!(n instanceof t.Shadow)&&(n=new t.Shadow(n)),this[e]=n,this},toggle:function(e){var t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this},setSourcePath:function(e){return this.sourcePath=e,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(e,n){if(this.width===0&&this.height===0||!this.visible)return;e.save(),this._setupCompositeOperation(e),n||this.transform(e),this._setStrokeStyles(e),this._setFillStyles(e),this.group&&this.group.type==="path-group"&&e.translate(-this.group.width/2,-this.group.height/2),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this._setOpacity(e),this._setShadow(e),this.clipTo&&t.util.clipContext(this,e),this._render(e,n),this.clipTo&&e.restore(),this._removeShadow(e),this._restoreCompositeOperation(e),e.restore()},_setOpacity:function(e){this.group&&this.group._setOpacity(e),e.globalAlpha*=this.opacity},_setStrokeStyles:function(e){this.stroke&&(e.lineWidth=this.strokeWidth,e.lineCap=this.strokeLineCap,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,e.strokeStyle=this.stroke.toLive?this.stroke.toLive(e,this):this.stroke)},_setFillStyles:function(e){this.fill&&(e.fillStyle=this.fill.toLive?this.fill.toLive(e,this):this.fill)},_renderControls:function(e,n){var r=this.getViewportTransform();e.save();if(this.active&&!n){var i;this.group&&(i=t.util.transformPoint(this.group.getCenterPoint(),r),e.translate(i.x,i.y),e.rotate(s(this.group.angle))),i=t.util.transformPoint(this.getCenterPoint(),r,null!=this.group),this.group&&(i.x*=this.group.scaleX,i.y*=this.group.scaleY),e.translate(i.x,i.y),e.rotate(s(this.angle)),this.drawBorders(e),this.drawControls(e)}e.restore()},_setShadow:function(e){if(!this.shadow)return;var t=this.canvas&&this.canvas._currentMultiplier||1;e.shadowColor=this.shadow.color,e.shadowBlur=this.shadow.blur*t*(this.scaleX+this.scaleY)/2,e.shadowOffsetX=this.shadow.offsetX*t*this.scaleX,e.shadowOffsetY=this.shadow.offsetY*t*this.scaleY},_removeShadow:function(e){if(!this.shadow)return;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0},_renderFill:function(e){if(!this.fill)return;e.save();if(this.fill.gradientTransform){var t=this.fill.gradientTransform;e.transform.apply(e,t)}this.fill.toLive&&e.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore(),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e)},_renderStroke:function(e){if(!this.stroke||this.strokeWidth===0)return;e.save();if(this.strokeDashArray)1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),o?(e.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(e)):this._renderDashedStroke&&this._renderDashedStroke(e),e.stroke();else{if(this.stroke.gradientTransform){var t=this.stroke.gradientTransform;e.transform.apply(e,t)}this._stroke?this._stroke(e):e.stroke()}this._removeShadow(e),e.restore()},clone:function(e,n){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(n),e):new t.Object(this.toObject(n))},cloneAsImage:function(e){var n=this.toDataURL();return t.util.loadImage(n,function(n){e&&e(new t.Image(n))}),this},toDataURL:function(e){e||(e={});var n=t.util.createCanvasElement(),r=this.getBoundingRect();n.width=r.width,n.height=r.height,t.util.wrapElement(n,"div");var i=new t.Canvas(n);e.format==="jpg"&&(e.format="jpeg"),e.format==="jpeg"&&(i.backgroundColor="#fff");var s={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1),this.setPositionByOrigin(new t.Point(n.width/2,n.height/2),"center","center");var o=this.canvas;i.add(this);var u=i.toDataURL(e);return this.set(s).setCoords(),this.canvas=o,i.dispose(),i=null,u},isType:function(e){return this.type===e},complexity:function(){return 0},toJSON:function(e){return this.toObject(e)},setGradient:function(e,n){n||(n={});var r={colorStops:[]};r.type=n.type||(n.r1||n.r2?"radial":"linear"),r.coords={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2};if(n.r1||n.r2)r.coords.r1=n.r1,r.coords.r2=n.r2;for(var i in n.colorStops){var s=new t.Color(n.colorStops[i]);r.colorStops.push({offset:i,color:s.toRgb(),opacity:s.getAlpha()})}return this.set(e,t.Gradient.forObject(this,r))},setPatternFill:function(e){return this.set("fill",new t.Pattern(e))},setShadow:function(e){return this.set("shadow",e?new t.Shadow(e):null)},setColor:function(e){return this.set("fill",e),this},setAngle:function(e){var t=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return t&&this._setOriginToCenter(),this.set("angle",e),t&&this._resetOrigin(),this},centerH:function(){return this.canvas.centerObjectH(this),this},centerV:function(){return this.canvas.centerObjectV(this),this},center:function(){return this.canvas.centerObject(this),this},remove:function(){return this.canvas.remove(this),this},getLocalPointer:function(e,t){t=t||this.canvas.getPointer(e);var n=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:t.x-n.x,y:t.y-n.y}},_setupCompositeOperation:function(e){this.globalCompositeOperation&&(this._prevGlobalCompositeOperation=e.globalCompositeOperation,e.globalCompositeOperation=this.globalCompositeOperation)},_restoreCompositeOperation:function(e){this.globalCompositeOperation&&this._prevGlobalCompositeOperation&&(e.globalCompositeOperation=this._prevGlobalCompositeOperation)}}),t.util.createAccessors(t.Object),t.Object.prototype.rotate=t.Object.prototype.setAngle,n(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object.__uid=0}(typeof exports!="undefined"?exports:this),function(){var e=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(t,n,r){var i=t.x,s=t.y,o=this.stroke?this.strokeWidth:0;return n==="left"?i=t.x+(this.getWidth()+o*this.scaleX)/2:n==="right"&&(i=t.x-(this.getWidth()+o*this.scaleX)/2),r==="top"?s=t.y+(this.getHeight()+o*this.scaleY)/2:r==="bottom"&&(s=t.y-(this.getHeight()+o*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(i,s),t,e(this.angle))},translateToOriginPoint:function(t,n,r){var i=t.x,s=t.y,o=this.stroke?this.strokeWidth:0;return n==="left"?i=t.x-(this.getWidth()+o*this.scaleX)/2:n==="right"&&(i=t.x+(this.getWidth()+o*this.scaleX)/2),r==="top"?s=t.y-(this.getHeight()+o*this.scaleY)/2:r==="bottom"&&(s=t.y+(this.getHeight()+o*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(i,s),t,e(this.angle))},getCenterPoint:function(){var e=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(e,this.originX,this.originY)},getPointByOrigin:function(e,t){var n=this.getCenterPoint();return this.translateToOriginPoint(n,e,t)},toLocalPoint:function(t,n,r){var i=this.getCenterPoint(),s=this.stroke?this.strokeWidth:0,o,u;return n&&r?(n==="left"?o=i.x-(this.getWidth()+s*this.scaleX)/2:n==="right"?o=i.x+(this.getWidth()+s*this.scaleX)/2:o=i.x,r==="top"?u=i.y-(this.getHeight()+s*this.scaleY)/2:r==="bottom"?u=i.y+(this.getHeight()+s*this.scaleY)/2:u=i.y):(o=this.left,u=this.top),fabric.util.rotatePoint(new fabric.Point(t.x,t.y),i,-e(this.angle)).subtractEquals(new fabric.Point(o,u))},setPositionByOrigin:function(e,t,n){var r=this.translateToCenterPoint(e,t,n),i=this.translateToOriginPoint(r,this.originX,this.originY);this.set("left",i.x),this.set("top",i.y)},adjustPosition:function(t){var n=e(this.angle),r=this.getWidth()/2,i=Math.cos(n)*r,s=Math.sin(n)*r,o=this.getWidth(),u=Math.cos(n)*o,a=Math.sin(n)*o;this.originX==="center"&&t==="left"||this.originX==="right"&&t==="center"?(this.left-=i,this.top-=s):this.originX==="left"&&t==="center"||this.originX==="center"&&t==="right"?(this.left+=i,this.top+=s):this.originX==="left"&&t==="right"?(this.left+=u,this.top+=a):this.originX==="right"&&t==="left"&&(this.left-=u,this.top-=a),this.setCoords(),this.originX=t},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var e=this.getCenterPoint();this.originX="center",this.originY="center",this.left=e.x,this.top=e.y},_resetOrigin:function(){var e=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=e.x,this.top=e.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})}(),function(){var e=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(e,t){var n=this.oCoords,r=new fabric.Point(n.tl.x,n.tl.y),i=new fabric.Point(n.tr.x,n.tr.y),s=new fabric.Point(n.bl.x,n.bl.y),o=new fabric.Point(n.br.x,n.br.y),u=fabric.Intersection.intersectPolygonRectangle([r,i,o,s],e,t);return u.status==="Intersection"},intersectsWithObject:function(e){function t(e){return{tl:new fabric.Point(e.tl.x,e.tl.y),tr:new fabric.Point(e.tr.x,e.tr.y),bl:new fabric.Point(e.bl.x,e.bl.y),br:new fabric.Point(e.br.x,e.br.y)}}var n=t(this.oCoords),r=t(e.oCoords),i=fabric.Intersection.intersectPolygonPolygon([n.tl,n.tr,n.br,n.bl],[r.tl,r.tr,r.br,r.bl]);return i.status==="Intersection"},isContainedWithinObject:function(e){var t=e.getBoundingRect(),n=new fabric.Point(t.left,t.top),r=new fabric.Point(t.left+t.width,t.top+t.height);return this.isContainedWithinRect(n,r)},isContainedWithinRect:function(e,t){var n=this.getBoundingRect();return n.left>=e.x&&n.left+n.width<=t.x&&n.top>=e.y&&n.top+n.height<=t.y},containsPoint:function(e){var t=this._getImageLines(this.oCoords),n=this._findCrossPoints(e,t);return n!==0&&n%2===1},_getImageLines:function(e){return{topline:{o:e.tl,d:e.tr},rightline:{o:e.tr,d:e.br},bottomline:{o:e.br,d:e.bl},leftline:{o:e.bl,d:e.tl}}},_findCrossPoints:function(e,t){var n,r,i,s,o,u,a=0,f;for(var l in t){f=t[l];if(f.o.y<e.y&&f.d.y<e.y)continue;if(f.o.y>=e.y&&f.d.y>=e.y)continue;f.o.x===f.d.x&&f.o.x>=e.x?(o=f.o.x,u=e.y):(n=0,r=(f.d.y-f.o.y)/(f.d.x-f.o.x),i=e.y-n*e.x,s=f.o.y-r*f.o.x,o=-(i-s)/(n-r),u=i+n*o),o>=e.x&&(a+=1);if(a===2)break}return a},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var e=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],t=fabric.util.array.min(e),n=fabric.util.array.max(e),r=Math.abs(t-n),i=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],s=fabric.util.array.min(i),o=fabric.util.array.max(i),u=Math.abs(s-o);return{left:t,top:s,width:r,height:u}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e},scale:function(e){return e=this._constrainScale(e),e<0&&(this.flipX=!this.flipX,this.flipY=!this.flipY,e*=-1),this.scaleX=e,this.scaleY=e,this.setCoords(),this},scaleToWidth:function(e){var t=this.getBoundingRectWidth()/this.getWidth();return this.scale(e/this.width/t)},scaleToHeight:function(e){var t=this.getBoundingRectHeight()/this.getHeight();return this.scale(e/this.height/t)},setCoords:function(){var t=this.strokeWidth,n=e(this.angle),r=this.getViewportTransform(),i=function(e){return fabric.util.transformPoint(e,r)},s=this.width,o=this.height,u=this.strokeLineCap==="round"||this.strokeLineCap==="square",a=this.type==="line"&&this.width===0,f=this.type==="line"&&this.height===0,l=a||f,c=u&&f||!l,h=u&&a||!l;a?s=t:f&&(o=t),c&&(s+=s>0?t:-t),h&&(o+=o>0?t:-t),this.currentWidth=s*this.scaleX,this.currentHeight=o*this.scaleY,this.currentWidth<0&&(this.currentWidth=Math.abs(this.currentWidth));var p=Math.sqrt(Math.pow(this.currentWidth/2,2)+Math.pow(this.currentHeight/2,2)),d=Math.atan(isFinite(this.currentHeight/this.currentWidth)?this.currentHeight/this.currentWidth:0),v=Math.cos(d+n)*p,m=Math.sin(d+n)*p,g=Math.sin(n),y=Math.cos(n),b=this.getCenterPoint(),w=new fabric.Point(this.currentWidth,this.currentHeight),E=new fabric.Point(b.x-v,b.y-m),S=new fabric.Point(E.x+w.x*y,E.y+w.x*g),x=new fabric.Point(E.x-w.y*g,E.y+w.y*y),T=new fabric.Point(E.x+w.x/2*y,E.y+w.x/2*g),N=i(E),C=i(S),k=i(new fabric.Point(S.x-w.y*g,S.y+w.y*y)),L=i(x),A=i(new fabric.Point(E.x-w.y/2*g,E.y+w.y/2*y)),O=i(T),M=i(new fabric.Point(S.x-w.y/2*g,S.y+w.y/2*y)),_=i(new fabric.Point(x.x+w.x/2*y,x.y+w.x/2*g)),D=i(new fabric.Point(T.x,T.y)),P=Math.cos(d+n)*this.padding*Math.sqrt(2),H=Math.sin(d+n)*this.padding*Math.sqrt(2);return N=N.add(new fabric.Point(-P,-H)),C=C.add(new fabric.Point(H,-P)),k=k.add(new fabric.Point(P,H)),L=L.add(new fabric.Point(-H,P)),A=A.add(new fabric.Point((-P-H)/2,(-H+P)/2)),O=O.add(new fabric.Point((H-P)/2,-(H+P)/2)),M=M.add(new fabric.Point((H+P)/2,(H-P)/2)),_=_.add(new fabric.Point((P-H)/2,(P+H)/2)),D=D.add(new fabric.Point((H-P)/2,-(H+P)/2)),this.oCoords={tl:N,tr:C,br:k,bl:L,ml:A,mt:O,mr:M,mb:_,mtr:D},this._setCornerCoords&&this._setCornerCoords(),this}})}(),fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(e){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas.sendBackwards(this,e),this},bringForward:function(e){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas.bringForward(this,e),this},moveTo:function(e){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas.moveTo(this,e),this}}),fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(){var e=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",t=this.fillRule,n=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):"",s=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",a=typeof this.opacity!="undefined"?this.opacity:"1",f=this.visible?"":" visibility: hidden;",l=this.shadow&&this.type!=="text"?"filter: url(#SVGID_"+this.shadow.id+");":"";return["stroke: ",n,"; ","stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",s,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",u,"; ","fill: ",e,"; ","fill-rule: ",t,"; ","opacity: ",a,";",l,f].join("")},getSvgTransform:function(){if(this.group&&this.group.type==="path-group")return"";var e=fabric.util.toFixed,t=this.getAngle(),n=!this.canvas||this.canvas.svgViewportTransformation?this.getViewportTransform():[1,0,0,1,0,0],r=fabric.util.transformPoint(this.getCenterPoint(),n),i=fabric.Object.NUM_FRACTION_DIGITS,s=this.type==="path-group"?"":"translate("+e(r.x,i)+" "+e(r.y,i)+")",o=t!==0?" rotate("+e(t,i)+")":"",u=this.scaleX===1&&this.scaleY===1&&n[0]===1&&n[3]===1?"":" scale("+e(this.scaleX*n[0],i)+" "+e(this.scaleY*n[3],i)+")",a=this.type==="path-group"?this.width*n[0]:0,f=this.flipX?" matrix(-1 0 0 1 "+a+" 0) ":"",l=this.type==="path-group"?this.height*n[3]:0,c=this.flipY?" matrix(1 0 0 -1 0 "+l+")":"";return[s,o,u,f,c].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+")":""},_createBaseSVGMarkup:function(){var e=[];return this.fill&&this.fill.toLive&&e.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&e.push(this.stroke.toSVG(this,!1)),this.shadow&&e.push(this.shadow.toSVG(this)),e}}),fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(e){return this.get(e)!==this.originalState[e]},this)},saveState:function(e){return this.stateProperties.forEach(function(e){this.originalState[e]=this.get(e)},this),e&&e.stateProperties&&e.stateProperties.forEach(function(e){this.originalState[e]=this.get(e)},this),this},setupState:function(){return this.originalState={},this.saveState(),this}}),function(){var e=fabric.util.degreesToRadians,t=function(){return typeof G_vmlCanvasManager!="undefined"};fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(e){if(!this.hasControls||!this.active)return!1;var t=e.x,n=e.y,r,i;for(var s in this.oCoords){if(!this.isControlVisible(s))continue;if(s==="mtr"&&!this.hasRotatingPoint)continue;if(!(!this.get("lockUniScaling")||s!=="mt"&&s!=="mr"&&s!=="mb"&&s!=="ml"))continue;i=this._getImageLines(this.oCoords[s].corner),r=this._findCrossPoints({x:t,y:n},i);if(r!==0&&r%2===1)return this.__corner=s,s}return!1},_setCornerCoords:function(){var t=this.oCoords,n=e(this.angle),r=e(45-this.angle),i=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,s=i*Math.cos(r),o=i*Math.sin(r),u=Math.sin(n),a=Math.cos(n);t.tl.corner={tl:{x:t.tl.x-o,y:t.tl.y-s},tr:{x:t.tl.x+s,y:t.tl.y-o},bl:{x:t.tl.x-s,y:t.tl.y+o},br:{x:t.tl.x+o,y:t.tl.y+s}},t.tr.corner={tl:{x:t.tr.x-o,y:t.tr.y-s},tr:{x:t.tr.x+s,y:t.tr.y-o},br:{x:t.tr.x+o,y:t.tr.y+s},bl:{x:t.tr.x-s,y:t.tr.y+o}},t.bl.corner={tl:{x:t.bl.x-o,y:t.bl.y-s},bl:{x:t.bl.x-s,y:t.bl.y+o},br:{x:t.bl.x+o,y:t.bl.y+s},tr:{x:t.bl.x+s,y:t.bl.y-o}},t.br.corner={tr:{x:t.br.x+s,y:t.br.y-o},bl:{x:t.br.x-s,y:t.br.y+o},br:{x:t.br.x+o,y:t.br.y+s},tl:{x:t.br.x-o,y:t.br.y-s}},t.ml.corner={tl:{x:t.ml.x-o,y:t.ml.y-s},tr:{x:t.ml.x+s,y:t.ml.y-o},bl:{x:t.ml.x-s,y:t.ml.y+o},br:{x:t.ml.x+o,y:t.ml.y+s}},t.mt.corner={tl:{x:t.mt.x-o,y:t.mt.y-s},tr:{x:t.mt.x+s,y:t.mt.y-o},bl:{x:t.mt.x-s,y:t.mt.y+o},br:{x:t.mt.x+o,y:t.mt.y+s}},t.mr.corner={tl:{x:t.mr.x-o,y:t.mr.y-s},tr:{x:t.mr.x+s,y:t.mr.y-o},bl:{x:t.mr.x-s,y:t.mr.y+o},br:{x:t.mr.x+o,y:t.mr.y+s}},t.mb.corner={tl:{x:t.mb.x-o,y:t.mb.y-s},tr:{x:t.mb.x+s,y:t.mb.y-o},bl:{x:t.mb.x-s,y:t.mb.y+o},br:{x:t.mb.x+o,y:t.mb.y+s}},t.mtr.corner={tl:{x:t.mtr.x-o+u*this.rotatingPointOffset,y:t.mtr.y-s-a*this.rotatingPointOffset},tr:{x:t.mtr.x+s+u*this.rotatingPointOffset,y:t.mtr.y-o-a*this.rotatingPointOffset},bl:{x:t.mtr.x-s+u*this.rotatingPointOffset,y:t.mtr.y+o-a*this.rotatingPointOffset},br:{x:t.mtr.x+o+u*this.rotatingPointOffset,y:t.mtr.y+s-a*this.rotatingPointOffset}}},drawBorders:function(e){if(!this.hasBorders)return this;var t=this.padding,n=t*2,r=this.getViewportTransform();e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,e.strokeStyle=this.borderColor;var i=1/this._constrainScale(this.scaleX),s=1/this._constrainScale(this.scaleY);e.lineWidth=1/this.borderScaleFactor;var o=this.getWidth(),u=this.getHeight(),a=this.strokeWidth,f=this.strokeLineCap==="round"||this.strokeLineCap==="square",l=this.type==="line"&&this.width===0,c=this.type==="line"&&this.height===0,h=l||c,p=f&&c||!h,d=f&&l||!h;l?o=a/i:c&&(u=a/s),p&&(o+=a/i),d&&(u+=a/s);var v=fabric.util.transformPoint(new fabric.Point(o,u),r,!0),m=v.x,g=v.y;this.group&&(m*=this.group.scaleX,g*=this.group.scaleY),e.strokeRect(~~(-(m/2)-t)-.5,~~(-(g/2)-t)-.5,~~(m+n)+1,~~(g+n)+1);if(this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var y=(-g-t*2)/2;e.beginPath(),e.moveTo(0,y),e.lineTo(0,y-this.rotatingPointOffset),e.closePath(),e.stroke()}return e.restore(),this},drawControls:function(e){if(!this.hasControls)return this;var t=this.cornerSize,n=t/2,r=this.getViewportTransform(),i=this.strokeWidth,s=this.width,o=this.height,u=this.strokeLineCap==="round"||this.strokeLineCap==="square",a=this.type==="line"&&this.width===0,f=this.type==="line"&&this.height===0,l=a||f,c=u&&f||!l,h=u&&a||!l;a?s=i:f&&(o=i),c&&(s+=i),h&&(o+=i),s*=this.scaleX,o*=this.scaleY;var p=fabric.util.transformPoint(new fabric.Point(s,o),r,!0),d=p.x,v=p.y,m=-(d/2),g=-(v/2),y=this.padding,b=n,w=n-t,E=this.transparentCorners?"strokeRect":"fillRect";return e.save(),e.lineWidth=1,e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,e.strokeStyle=e.fillStyle=this.cornerColor,this._drawControl("tl",e,E,m-b-y,g-b-y),this._drawControl("tr",e,E,m+d-b+y,g-b-y),this._drawControl("bl",e,E,m-b-y,g+v+w+y),this._drawControl("br",e,E,m+d+w+y,g+v+w+y),this.get("lockUniScaling")||(this._drawControl("mt",e,E,m+d/2-b,g-b-y),this._drawControl("mb",e,E,m+d/2-b,g+v+w+y),this._drawControl("mr",e,E,m+d+w+y,g+v/2-b),this._drawControl("ml",e,E,m-b-y,g+v/2-b)),this.hasRotatingPoint&&this._drawControl("mtr",e,E,m+d/2-b,g-this.rotatingPointOffset-this.cornerSize/2-y),e.restore(),this},_drawControl:function(e,n,r,i,s){var o=this.cornerSize;this.isControlVisible(e)&&(t()||this.transparentCorners||n.clearRect(i,s,o,o),n[r](i,s,o,o))},isControlVisible:function(e){return this._getControlsVisibility()[e]},setControlVisible:function(e,t){return this._getControlsVisibility()[e]=t,this},setControlsVisibility:function(e){e||(e={});for(var t in e)this.setControlVisible(t,e[t]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){t=t||{};var n=function(){},r=t.onComplete||n,i=t.onChange||n,s=this;return fabric.util.animate({startValue:e.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(t){e.set("left",t),s.renderAll(),i()},onComplete:function(){e.setCoords(),r()}}),this},fxCenterObjectV:function(e,t){t=t||{};var n=function(){},r=t.onComplete||n,i=t.onChange||n,s=this;return fabric.util.animate({startValue:e.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(t){e.set("top",t),s.renderAll(),i()},onComplete:function(){e.setCoords(),r()}}),this},fxRemove:function(e,t){t=t||{};var n=function(){},r=t.onComplete||n,i=t.onChange||n,s=this;return fabric.util.animate({startValue:e.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){e.set("active",!1)},onChange:function(t){e.set("opacity",t),s.renderAll(),i()},onComplete:function(){s.remove(e),r()}}),this}}),fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var e=[],t,n;for(t in arguments[0])e.push(t);for(var r=0,i=e.length;r<i;r++)t=e[r],n=r!==i-1,this._animate(t,arguments[0][t],arguments[1],n)}else this._animate.apply(this,arguments);return this},_animate:function(e,t,n,r){var i=this,s;t=t.toString(),n?n=fabric.util.object.clone(n):n={},~e.indexOf(".")&&(s=e.split("."));var o=s?this.get(s[0])[s[1]]:this.get(e);"from"in n||(n.from=o),~t.indexOf("=")?t=o+parseFloat(t.replace("=","")):t=parseFloat(t),fabric.util.animate({startValue:n.from,endValue:t,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(){return n.abort.call(i)},onChange:function(t){s?i[s[0]][s[1]]=t:i.set(e,t);if(r)return;n.onChange&&n.onChange()},onComplete:function(){if(r)return;i.setCoords(),n.onComplete&&n.onComplete()}})}}),function(e){"use strict";function s(e,t){var n=e.origin,r=e.axis1,i=e.axis2,s=e.dimension,o=t.nearest,u=t.center,a=t.farthest;return function(){switch(this.get(n)){case o:return Math.min(this.get(r),this.get(i));case u:return Math.min(this.get(r),this.get(i))+.5*this.get(s);case a:return Math.max(this.get(r),this.get(i))}}}var t=e.fabric||(e.fabric={}),n=t.util.object.extend,r={x1:1,x2:1,y1:1,y2:1},i=t.StaticCanvas.supports("setLineDash");if(t.Line){t.warn("fabric.Line is already defined");return}t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(e,t){t=t||{},e||(e=[0,0,0,0]),this.callSuper("initialize",t),this.set("x1",e[0]),this.set("y1",e[1]),this.set("x2",e[2]),this.set("y2",e[3]
),this._setWidthHeight(t)},_setWidthHeight:function(e){e||(e={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in e?e.left:this._getLeftToOriginX(),this.top="top"in e?e.top:this._getTopToOriginY()},_set:function(e,t){return this.callSuper("_set",e,t),typeof r[e]!="undefined"&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(e,t){e.beginPath();if(t){var n=this.getCenterPoint();e.translate(n.x-this.strokeWidth/2,n.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&i){var r=this.calcLinePoints();e.moveTo(r.x1,r.y1),e.lineTo(r.x2,r.y2)}e.lineWidth=this.strokeWidth;var s=e.strokeStyle;e.strokeStyle=this.stroke||e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=s},_renderDashedStroke:function(e){var n=this.calcLinePoints();e.beginPath(),t.util.drawDashedLine(e,n.x1,n.y1,n.x2,n.y2,this.strokeDashArray),e.closePath()},toObject:function(e){return n(this.callSuper("toObject",e),this.calcLinePoints())},calcLinePoints:function(){var e=this.x1<=this.x2?-1:1,t=this.y1<=this.y2?-1:1,n=e*this.width*.5,r=t*this.height*.5,i=e*this.width*-0.5,s=t*this.height*-0.5;return{x1:n,x2:i,y1:r,y2:s}},toSVG:function(e){var t=this._createBaseSVGMarkup(),n={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};if(!this.group||this.group.type!=="path-group")n=this.calcLinePoints();return t.push("<line ",'x1="',n.x1,'" y1="',n.y1,'" x2="',n.x2,'" y2="',n.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),e?e(t.join("")):t.join("")},complexity:function(){return 1}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(e,r){var i=t.parseAttributes(e,t.Line.ATTRIBUTE_NAMES),s=[i.x1||0,i.y1||0,i.x2||0,i.y2||0];return new t.Line(s,n(i,r))},t.Line.fromObject=function(e){var n=[e.x1,e.y1,e.x2,e.y2];return new t.Line(n,e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";function i(e){return"radius"in e&&e.radius>0}var t=e.fabric||(e.fabric={}),n=Math.PI,r=t.util.object.extend;if(t.Circle){t.warn("fabric.Circle is already defined.");return}t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:n*2,initialize:function(e){e=e||{},this.callSuper("initialize",e),this.set("radius",e.radius||0),this.startAngle=e.startAngle||this.startAngle,this.endAngle=e.endAngle||this.endAngle},_set:function(e,t){return this.callSuper("_set",e,t),e==="radius"&&this.setRadius(t),this},toObject:function(e){return r(this.callSuper("toObject",e),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(e){var t=this._createBaseSVGMarkup(),r=0,i=0,s=(this.endAngle-this.startAngle)%(2*n);if(s===0)this.group&&this.group.type==="path-group"&&(r=this.left+this.radius,i=this.top+this.radius),t.push("<circle ",'cx="'+r+'" cy="'+i+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');else{var o=Math.cos(this.startAngle)*this.radius,u=Math.sin(this.startAngle)*this.radius,a=Math.cos(this.endAngle)*this.radius,f=Math.sin(this.endAngle)*this.radius,l=s>n?"1":"0";t.push('<path d="M '+o+" "+u," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+a+" "+f,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')}return e?e(t.join("")):t.join("")},_render:function(e,t){e.beginPath(),e.arc(t?this.left+this.radius:0,t?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1),this._renderFill(e),this._renderStroke(e)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(e){this.radius=e,this.set("width",e*2).set("height",e*2)},complexity:function(){return 1}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(e,n){n||(n={});var s=t.parseAttributes(e,t.Circle.ATTRIBUTE_NAMES);if(!i(s))throw new Error("value of `r` attribute is required and can not be negative");s.left=s.left||0,s.top=s.top||0;var o=new t.Circle(r(s,n));return o.left-=o.radius,o.top-=o.radius,o},t.Circle.fromObject=function(e){return new t.Circle(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Triangle){t.warn("fabric.Triangle is already defined");return}t.Triangle=t.util.createClass(t.Object,{type:"triangle",initialize:function(e){e=e||{},this.callSuper("initialize",e),this.set("width",e.width||100).set("height",e.height||100)},_render:function(e){var t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderFill(e),this._renderStroke(e)},_renderDashedStroke:function(e){var n=this.width/2,r=this.height/2;e.beginPath(),t.util.drawDashedLine(e,-n,r,0,-r,this.strokeDashArray),t.util.drawDashedLine(e,0,-r,n,r,this.strokeDashArray),t.util.drawDashedLine(e,n,r,-n,r,this.strokeDashArray),e.closePath()},toSVG:function(e){var t=this._createBaseSVGMarkup(),n=this.width/2,r=this.height/2,i=[-n+" "+r,"0 "+ -r,n+" "+r].join(",");return t.push("<polygon ",'points="',i,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),e?e(t.join("")):t.join("")},complexity:function(){return 1}}),t.Triangle.fromObject=function(e){return new t.Triangle(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=Math.PI*2,r=t.util.object.extend;if(t.Ellipse){t.warn("fabric.Ellipse is already defined.");return}t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,initialize:function(e){e=e||{},this.callSuper("initialize",e),this.set("rx",e.rx||0),this.set("ry",e.ry||0)},_set:function(e,t){this.callSuper("_set",e,t);switch(e){case"rx":this.rx=t,this.set("width",t*2);break;case"ry":this.ry=t,this.set("height",t*2)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(e){return r(this.callSuper("toObject",e),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(e){var t=this._createBaseSVGMarkup(),n=0,r=0;return this.group&&this.group.type==="path-group"&&(n=this.left+this.rx,r=this.top+this.ry),t.push("<ellipse ",'cx="',n,'" cy="',r,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),e?e(t.join("")):t.join("")},_render:function(e,t){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(t?this.left+this.rx:0,t?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,n,!1),e.restore(),this._renderFill(e),this._renderStroke(e)},complexity:function(){return 1}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(e,n){n||(n={});var i=t.parseAttributes(e,t.Ellipse.ATTRIBUTE_NAMES);i.left=i.left||0,i.top=i.top||0;var s=new t.Ellipse(r(i,n));return s.top-=s.ry,s.left-=s.rx,s},t.Ellipse.fromObject=function(e){return new t.Ellipse(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;if(t.Rect){console.warn("fabric.Rect is already defined");return}var r=t.Object.prototype.stateProperties.concat();r.push("rx","ry","x","y"),t.Rect=t.util.createClass(t.Object,{stateProperties:r,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(e){e=e||{},this.callSuper("initialize",e),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(e,t){if(this.width===1&&this.height===1){e.fillRect(0,0,1,1);return}var n=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,s=this.height,o=t?this.left:-this.width/2,u=t?this.top:-this.height/2,a=n!==0||r!==0,f=.4477152502;e.beginPath(),e.moveTo(o+n,u),e.lineTo(o+i-n,u),a&&e.bezierCurveTo(o+i-f*n,u,o+i,u+f*r,o+i,u+r),e.lineTo(o+i,u+s-r),a&&e.bezierCurveTo(o+i,u+s-f*r,o+i-f*n,u+s,o+i-n,u+s),e.lineTo(o+n,u+s),a&&e.bezierCurveTo(o+f*n,u+s,o,u+s-f*r,o,u+s-r),e.lineTo(o,u+r),a&&e.bezierCurveTo(o,u+f*r,o+f*n,u,o+n,u),e.closePath(),this._renderFill(e),this._renderStroke(e)},_renderDashedStroke:function(e){var n=-this.width/2,r=-this.height/2,i=this.width,s=this.height;e.beginPath(),t.util.drawDashedLine(e,n,r,n+i,r,this.strokeDashArray),t.util.drawDashedLine(e,n+i,r,n+i,r+s,this.strokeDashArray),t.util.drawDashedLine(e,n+i,r+s,n,r+s,this.strokeDashArray),t.util.drawDashedLine(e,n,r+s,n,r,this.strokeDashArray),e.closePath()},toObject:function(e){var t=n(this.callSuper("toObject",e),{rx:this.get("rx")||0,ry:this.get("ry")||0});return this.includeDefaultValues||this._removeDefaultValues(t),t},toSVG:function(e){var t=this._createBaseSVGMarkup(),n=this.left,r=this.top;if(!this.group||this.group.type!=="path-group")n=-this.width/2,r=-this.height/2;return t.push("<rect ",'x="',n,'" y="',r,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),e?e(t.join("")):t.join("")},complexity:function(){return 1}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(e,r){if(!e)return null;r=r||{};var i=t.parseAttributes(e,t.Rect.ATTRIBUTE_NAMES);return i.left=i.left||0,i.top=i.top||0,new t.Rect(n(r?t.util.object.clone(r):{},i))},t.Rect.fromObject=function(e){return new t.Rect(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={});if(t.Polyline){t.warn("fabric.Polyline is already defined");return}t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(e,n){return t.Polygon.prototype.initialize.call(this,e,n)},_calcDimensions:function(){return t.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return t.Polygon.prototype._applyPointOffset.call(this)},toObject:function(e){return t.Polygon.prototype.toObject.call(this,e)},toSVG:function(e){return t.Polygon.prototype.toSVG.call(this,e)},_render:function(e){t.Polygon.prototype.commonRender.call(this,e),this._renderFill(e),this._renderStroke(e)},_renderDashedStroke:function(e){var n,r;e.beginPath();for(var i=0,s=this.points.length;i<s;i++)n=this.points[i],r=this.points[i+1]||n,t.util.drawDashedLine(e,n.x,n.y,r.x,r.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElement=function(e,n){if(!e)return null;n||(n={});var r=t.parsePointsAttribute(e.getAttribute("points")),i=t.parseAttributes(e,t.Polyline.ATTRIBUTE_NAMES);return r===null?null:new t.Polyline(r,t.util.object.extend(i,n))},t.Polyline.fromObject=function(e){var n=e.points;return new t.Polyline(n,e,!0)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,r=t.util.array.min,i=t.util.array.max,s=t.util.toFixed;if(t.Polygon){t.warn("fabric.Polygon is already defined");return}t.Polygon=t.util.createClass(t.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(e,t){t=t||{},this.points=e,this.callSuper("initialize",t),this._calcDimensions(),"top"in t||(this.top=this.minY),"left"in t||(this.left=this.minX)},_calcDimensions:function(){var e=this.points,t=r(e,"x"),n=r(e,"y"),s=i(e,"x"),o=i(e,"y");this.width=s-t||1,this.height=o-n||1,this.minX=t,this.minY=n},_applyPointOffset:function(){this.points.forEach(function(e){e.x-=this.minX+this.width/2,e.y-=this.minY+this.height/2},this)},toObject:function(e){return n(this.callSuper("toObject",e),{points:this.points.concat()})},toSVG:function(e){var t=[],n=this._createBaseSVGMarkup();for(var r=0,i=this.points.length;r<i;r++)t.push(s(this.points[r].x,2),",",s(this.points[r].y,2)," ");return n.push("<",this.type," ",'points="',t.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n'),e?e(n.join("")):n.join("")},_render:function(e){this.commonRender(e),this._renderFill(e);if(this.stroke||this.strokeDashArray)e.closePath(),this._renderStroke(e)},commonRender:function(e){var t;e.beginPath(),this._applyPointOffset&&((!this.group||this.group.type!=="path-group")&&this._applyPointOffset(),this._applyPointOffset=null),e.moveTo(this.points[0].x,this.points[0].y);for(var n=0,r=this.points.length;n<r;n++)t=this.points[n],e.lineTo(t.x,t.y)},_renderDashedStroke:function(e){t.Polyline.prototype._renderDashedStroke.call(this,e),e.closePath()},complexity:function(){return this.points.length}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=function(e,r){if(!e)return null;r||(r={});var i=t.parsePointsAttribute(e.getAttribute("points")),s=t.parseAttributes(e,t.Polygon.ATTRIBUTE_NAMES);return i===null?null:new t.Polygon(i,n(s,r))},t.Polygon.fromObject=function(e){return new t.Polygon(e.points,e,!0)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.array.min,r=t.util.array.max,i=t.util.object.extend,s=Object.prototype.toString,o=t.util.drawArc,u={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},a={m:"l",M:"L"};if(t.Path){t.warn("fabric.Path is already defined");return}t.Path=t.util.createClass(t.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(e,t){t=t||{},this.setOptions(t);if(!e)throw new Error("`path` argument is required");var n=s.call(e)==="[object Array]";this.path=n?e:e.match&&e.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(!this.path)return;n||(this.path=this._parsePath());var r=this._parseDimensions();this.minX=r.left,this.minY=r.top,this.width=r.width,this.height=r.height,r.left+=this.originX==="center"?this.width/2:this.originX==="right"?this.width:0,r.top+=this.originY==="center"?this.height/2:this.originY==="bottom"?this.height:0,this.top=this.top||r.top,this.left=this.left||r.left,this.pathOffset=this.pathOffset||{x:this.minX+this.width/2,y:this.minY+this.height/2},t.sourcePath&&this.setSourcePath(t.sourcePath)},_render:function(e){var t,n=null,r=0,i=0,s=0,u=0,a=0,f=0,l,c,h,p,d=-this.pathOffset.x,v=-this.pathOffset.y;this.group&&this.group.type==="path-group"&&(d=0,v=0),e.beginPath();for(var m=0,g=this.path.length;m<g;++m){t=this.path[m];switch(t[0]){case"l":s+=t[1],u+=t[2],e.lineTo(s+d,u+v);break;case"L":s=t[1],u=t[2],e.lineTo(s+d,u+v);break;case"h":s+=t[1],e.lineTo(s+d,u+v);break;case"H":s=t[1],e.lineTo(s+d,u+v);break;case"v":u+=t[1],e.lineTo(s+d,u+v);break;case"V":u=t[1],e.lineTo(s+d,u+v);break;case"m":s+=t[1],u+=t[2],r=s,i=u,e.moveTo(s+d,u+v);break;case"M":s=t[1],u=t[2],r=s,i=u,e.moveTo(s+d,u+v);break;case"c":l=s+t[5],c=u+t[6],a=s+t[3],f=u+t[4],e.bezierCurveTo(s+t[1]+d,u+t[2]+v,a+d,f+v,l+d,c+v),s=l,u=c;break;case"C":s=t[5],u=t[6],a=t[3],f=t[4],e.bezierCurveTo(t[1]+d,t[2]+v,a+d,f+v,s+d,u+v);break;case"s":l=s+t[3],c=u+t[4],a=a?2*s-a:s,f=f?2*u-f:u,e.bezierCurveTo(a+d,f+v,s+t[1]+d,u+t[2]+v,l+d,c+v),a=s+t[1],f=u+t[2],s=l,u=c;break;case"S":l=t[3],c=t[4],a=2*s-a,f=2*u-f,e.bezierCurveTo(a+d,f+v,t[1]+d,t[2]+v,l+d,c+v),s=l,u=c,a=t[1],f=t[2];break;case"q":l=s+t[3],c=u+t[4],a=s+t[1],f=u+t[2],e.quadraticCurveTo(a+d,f+v,l+d,c+v),s=l,u=c;break;case"Q":l=t[3],c=t[4],e.quadraticCurveTo(t[1]+d,t[2]+v,l+d,c+v),s=l,u=c,a=t[1],f=t[2];break;case"t":l=s+t[1],c=u+t[2],n[0].match(/[QqTt]/)===null?(a=s,f=u):n[0]==="t"?(a=2*s-h,f=2*u-p):n[0]==="q"&&(a=2*s-a,f=2*u-f),h=a,p=f,e.quadraticCurveTo(a+d,f+v,l+d,c+v),s=l,u=c,a=s+t[1],f=u+t[2];break;case"T":l=t[1],c=t[2],a=2*s-a,f=2*u-f,e.quadraticCurveTo(a+d,f+v,l+d,c+v),s=l,u=c;break;case"a":o(e,s+d,u+v,[t[1],t[2],t[3],t[4],t[5],t[6]+s+d,t[7]+u+v]),s+=t[6],u+=t[7];break;case"A":o(e,s+d,u+v,[t[1],t[2],t[3],t[4],t[5],t[6]+d,t[7]+v]),s=t[6],u=t[7];break;case"z":case"Z":s=r,u=i,e.closePath()}n=t}this._renderFill(e),this._renderStroke(e)},render:function(e,n){if(!this.visible)return;e.save(),this._setupCompositeOperation(e),n||this.transform(e),this._setStrokeStyles(e),this._setFillStyles(e),this.group&&this.group.type==="path-group"&&e.translate(-this.group.width/2,-this.group.height/2),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),this._setOpacity(e),this._setShadow(e),this.clipTo&&t.util.clipContext(this,e),this._render(e,n),this.clipTo&&e.restore(),this._removeShadow(e),this._restoreCompositeOperation(e),e.restore()},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(e){var t=i(this.callSuper("toObject",e),{path:this.path.map(function(e){return e.slice()}),pathOffset:this.pathOffset});return this.sourcePath&&(t.sourcePath=this.sourcePath),this.transformMatrix&&(t.transformMatrix=this.transformMatrix),t},toDatalessObject:function(e){var t=this.toObject(e);return this.sourcePath&&(t.path=this.sourcePath),delete t.sourcePath,t},toSVG:function(e){var t=[],n=this._createBaseSVGMarkup(),r="";for(var i=0,s=this.path.length;i<s;i++)t.push(this.path[i].join(" "));var o=t.join(" ");if(!this.group||this.group.type!=="path-group")r="translate("+ -this.pathOffset.x+", "+ -this.pathOffset.y+")";return n.push("<path ",'d="',o,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),r,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n"),e?e(n.join("")):n.join("")},complexity:function(){return this.path.length},_parsePath:function(){var e=[],t=[],n,r,i=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/ig,s,o;for(var f=0,l,c=this.path.length;f<c;f++){n=this.path[f],o=n.slice(1).trim(),t.length=0;while(s=i.exec(o))t.push(s[0]);l=[n.charAt(0)];for(var h=0,p=t.length;h<p;h++)r=parseFloat(t[h]),isNaN(r)||l.push(r);var d=l[0],v=u[d.toLowerCase()],m=a[d]||d;if(l.length-1>v)for(var g=1,y=l.length;g<y;g+=v)e.push([d].concat(l.slice(g,g+v))),d=m;else e.push(l)}return e},_parseDimensions:function(){var e=[],i=[],s,o=null,u=0,a=0,f=0,l=0,c=0,h=0,p,d,v,m,g;for(var y=0,b=this.path.length;y<b;++y){s=this.path[y];switch(s[0]){case"l":f+=s[1],l+=s[2],g=[];break;case"L":f=s[1],l=s[2],g=[];break;case"h":f+=s[1],g=[];break;case"H":f=s[1],g=[];break;case"v":l+=s[1],g=[];break;case"V":l=s[1],g=[];break;case"m":f+=s[1],l+=s[2],u=f,a=l,g=[];break;case"M":f=s[1],l=s[2],u=f,a=l,g=[];break;case"c":p=f+s[5],d=l+s[6],c=f+s[3],h=l+s[4],g=t.util.getBoundsOfCurve(f,l,f+s[1],l+s[2],c,h,p,d),f=p,l=d;break;case"C":f=s[5],l=s[6],c=s[3],h=s[4],g=t.util.getBoundsOfCurve(f,l,s[1],s[2],c,h,f,l);break;case"s":p=f+s[3],d=l+s[4],c=c?2*f-c:f,h=h?2*l-h:l,g=t.util.getBoundsOfCurve(f,l,c,h,f+s[1],l+s[2],p,d),c=f+s[1],h=l+s[2],f=p,l=d;break;case"S":p=s[3],d=s[4],c=2*f-c,h=2*l-h,g=t.util.getBoundsOfCurve(f,l,c,h,s[1],s[2],p,d),f=p,l=d,c=s[1],h=s[2];break;case"q":p=f+s[3],d=l+s[4],c=f+s[1],h=l+s[2],g=t.util.getBoundsOfCurve(f,l,c,h,c,h,p,d),f=p,l=d;break;case"Q":c=s[1],h=s[2],g=t.util.getBoundsOfCurve(f,l,c,h,c,h,s[3],s[4]),f=s[3],l=s[4];break;case"t":p=f+s[1],d=l+s[2],o[0].match(/[QqTt]/)===null?(c=f,h=l):o[0]==="t"?(c=2*f-v,h=2*l-m):o[0]==="q"&&(c=2*f-c,h=2*l-h),v=c,m=h,g=t.util.getBoundsOfCurve(f,l,c,h,c,h,p,d),f=p,l=d,c=f+s[1],h=l+s[2];break;case"T":p=s[1],d=s[2],c=2*f-c,h=2*l-h,g=t.util.getBoundsOfCurve(f,l,c,h,c,h,p,d),f=p,l=d;break;case"a":g=t.util.getBoundsOfArc(f,l,s[1],s[2],s[3],s[4],s[5],s[6]+f,s[7]+l),f+=s[6],l+=s[7];break;case"A":g=t.util.getBoundsOfArc(f,l,s[1],s[2],s[3],s[4],s[5],s[6],s[7]),f=s[6],l=s[7];break;case"z":case"Z":f=u,l=a}o=s,g.forEach(function(t){e.push(t.x),i.push(t.y)}),e.push(f),i.push(l)}var w=n(e),E=n(i),S=r(e),x=r(i),T=S-w,N=x-E,C={left:w,top:E,width:T,height:N};return C}}),t.Path.fromObject=function(e,n){typeof e.path=="string"?t.loadSVGFromURL(e.path,function(r){var i=r[0],s=e.path;delete e.path,t.util.object.extend(i,e),i.setSourcePath(s),n(i)}):n(new t.Path(e.path,e))},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(e,n,r){var s=t.parseAttributes(e,t.Path.ATTRIBUTE_NAMES);n&&n(new t.Path(s.d,i(s,r)))},t.Path.async=!0}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,r=t.util.array.invoke,i=t.Object.prototype.toObject;if(t.PathGroup){t.warn("fabric.PathGroup is already defined");return}t.PathGroup=t.util.createClass(t.Path,{type:"path-group",fill:"",initialize:function(e,t){t=t||{},this.paths=e||[];for(var n=this.paths.length;n--;)this.paths[n].group=this;this.setOptions(t),t.widthAttr&&(this.scaleX=t.widthAttr/t.width),t.heightAttr&&(this.scaleY=t.heightAttr/t.height),this.setCoords(),t.sourcePath&&this.setSourcePath(t.sourcePath)},render:function(e){if(!this.visible)return;e.save();var n=this.transformMatrix;n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(e),this._setShadow(e),this.clipTo&&t.util.clipContext(this,e);for(var r=0,i=this.paths.length;r<i;++r)this.paths[r].render(e,!0);this.clipTo&&e.restore(),this._removeShadow(e),e.restore()},_set:function(e,t){if(e==="fill"&&t&&this.isSameColor()){var n=this.paths.length;while(n--)this.paths[n]._set(e,t)}return this.callSuper("_set",e,t)},toObject:function(e){var t=n(i.call(this,e),{paths:r(this.getObjects(),"toObject",e)});return this.sourcePath&&(t.sourcePath=this.sourcePath),t},toDatalessObject:function(e){var t=this.toObject(e);return this.sourcePath&&(t.paths=this.sourcePath),t},toSVG:function(e){var t=this.getObjects(),n="translate("+this.left+" "+this.top+")",r=["<g ",'style="',this.getSvgStyles(),'" ','transform="',n,this.getSvgTransform(),'" ',">\n"];for(var i=0,s=t.length;i<s;i++)r.push(t[i].toSVG(e));return r.push("</g>\n"),e?e(r.join("")):r.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var e=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(t){return(t.get("fill")||"").toLowerCase()===e})},complexity:function(){return this.paths.reduce(function(e,t){return e+(t&&t.complexity?t.complexity():0)},0)},getObjects:function(){return this.paths}}),t.PathGroup.fromObject=function(e,n){typeof e.paths=="string"?t.loadSVGFromURL(e.paths,function(r){var i=e.paths;delete e.paths;var s=t.util.groupSVGElements(r,e,i);n(s)}):t.util.enlivenObjects(e.paths,function(r){delete e.paths,n(new t.PathGroup(r,e))})},t.PathGroup.async=!0}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,r=t.util.array.min,i=t.util.array.max,s=t.util.array.invoke;if(t.Group)return;var o={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",initialize:function(e,t){t=t||{},this._objects=e||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;this.originalState={},this.callSuper("initialize"),t.originX&&(this.originX=t.originX),t.originY&&(this.originY=t.originY),this._calcBounds(),this._updateObjectsCoords(),t&&n(this,t),this.setCoords(),this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(e){var t=e.getLeft(),n=e.getTop(),r=this.getCenterPoint();e.set({originalLeft:t,originalTop:n,left:t-r.x,top:n-r.y}),e.setCoords(),e.__origHasControls=e.hasControls,e.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(e){return this._restoreObjectsState(),e&&(this._objects.push(e),e.group=this),this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(e){e.set("active",!0),e.group=this},removeWithUpdate:function(e){return this._moveFlippedObject(e),this._restoreObjectsState(),this.forEachObject(this._setObjectActive,this),this.remove(e),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(e){e.group=this},_onObjectRemoved:function(e){delete e.group,e.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(e,t){if(e in this.delegatedProperties){var n=this._objects.length;this[e]=t;while(n--)this._objects[n].set(e,t)}else this[e]=t},toObject:function(e){return n(this.callSuper("toObject",e),{objects:s(this._objects,"toObject",e)})},render:function(e){if(!this.visible)return;e.save(),this.clipTo&&t.util.clipContext(this,e);for(var n=0,r=this._objects.length;n<r;n++)this._renderObject(this._objects[n],e);this.clipTo&&e.restore(),e.restore()},_renderControls:function(e,t){this.callSuper("_renderControls",e,t);for(var n=0,r=this._objects.length;n<r;n++)this._objects[n]._renderControls(e)},_renderObject:function(e,t){var n=e.hasRotatingPoint;if(!e.visible)return;e.hasRotatingPoint=!1,e.render(t),e.hasRotatingPoint=n},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},_moveFlippedObject:function(e){var t=e.get("originX"),n=e.get("originY"),r=e.getCenterPoint();e.set({originX:"center",originY:"center",left:r.x,top:r.y}),this._toggleFlipping(e);var i=e.getPointByOrigin(t,n);return e.set({originX:t,originY:n,left:i.x,top:i.y}),this},_toggleFlipping:function(e){this.flipX&&(e.toggle("flipX"),e.set("left",-e.get("left")),e.setAngle(-e.getAngle())),this.flipY&&(e.toggle("flipY"),e.set("top",-e.get("top")),e.setAngle(-e.getAngle()))},_restoreObjectState:function(e){return this._setObjectPosition(e),e.setCoords(),e.hasControls=e.__origHasControls,delete e.__origHasControls,e.set("active",!1),e.setCoords(),delete e.group,this},_setObjectPosition:function(e){var t=this.getCenterPoint(),n=this._getRotatedLeftTop(e);e.set({angle:e.getAngle()+this.getAngle(),left:t.x+n.left,top:t.y+n.top,scaleX:e.get("scaleX")*this.get("scaleX"),scaleY:e.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(e){var t=this.getAngle()*(Math.PI/180);return{left:-Math.sin(t)*e.getTop()*this.get("scaleY")+Math.cos(t)*e.getLeft()*this.get("scaleX"),top:Math.cos(t)*e.getTop()*this.get("scaleY")+Math.sin(t)*e.getLeft()*this.get("scaleX")}},destroy:function(){return this._objects.forEach(this._moveFlippedObject,this),this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(e){e.setCoords()}),this},_calcBounds:function(e){var t=[],n=[],r;for(var i=0,s=this._objects.length;i<s;++i){r=this._objects[i],r.setCoords();for(var o in r.oCoords)t.push(r.oCoords[o].x),n.push(r.oCoords[o].y)}this.set(this._getBounds(t,n,e))},_getBounds:function(e,n,s){var o=t.util.invertTransform(this.getViewportTransform()),u=t.util.transformPoint(new t.Point(r(e),r(n)),o),a=t.util.transformPoint(new t.Point(i(e),i(n)),o),f={width:a.x-u.x||0,height:a.y-u.y||0};return s||(f.left=u.x||0,f.top=u.y||0,this.originX==="center"&&(f.left+=f.width/2),this.originX==="right"&&(f.left+=f.width),this.originY==="center"&&(f.top+=f.height/2),this.originY==="bottom"&&(f.top+=f.height)),f},toSVG:function(e){var t=["<g ",'transform="',this.getSvgTransform(),'">\n'];for(var n=0,r=this._objects.length;n<r;n++)t.push(this._objects[n].toSVG(e));return t.push("</g>\n"),e?e(t.join("")):t.join("")},get:function(e){if(e in o){if(this[e])return this[e];for(var t=0,n=this._objects.length;t<n;t++)if(this._objects[t][e])return!0;return!1}return e in this.delegatedProperties?this._objects[0]&&this._objects[0].get(e):this[e]}}),t.Group.fromObject=function(e,n){t.util.enlivenObjects(e.objects,function(r){delete e.objects,n&&n(new t.Group(r,e))})},t.Group.async=!0}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=fabric.util.object.extend;e.fabric||(e.fabric={});if(e.fabric.Image){fabric.warn("fabric.Image is already defined.");return}fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",_lastScaleX:1,_lastScaleY:1,initialize:function(e,t){t||(t={}),this.filters=[],this.resizeFilters=[],this.callSuper("initialize",t),this._initElement(e,t),this._initConfig(t),t.filters&&(this.filters=t.filters,this.applyFilters())},getElement:function(){return this._element},setElement:function(e,t,n){return this._element=e,this._originalElement=e,this._initConfig(n),this.filters.length!==0?this.applyFilters(t):t&&t(),this},setCrossOrigin:function(e){return this.crossOrigin=e,this._element.crossOrigin=e,this},getOriginalSize:function(){var e=this.getElement();return{width:e.width,height:e.height}},_stroke:function(e){e.save(),this._setStrokeStyles(e),e.beginPath(),e.strokeRect(-this.width/2,-this.height/2,this.width,this.height),e.closePath(),e.restore()},_renderDashedStroke:function(e){var t=-this.width/2,n=-this.height/2,r=this.width,i=this.height;e.save(),this._setStrokeStyles(e),e.beginPath(),fabric.util.drawDashedLine(e,t,n,t+r,n,this.strokeDashArray),fabric.util.drawDashedLine(e,t+r,n,t+r,n+i,this.strokeDashArray),fabric.util.drawDashedLine(e,t+r,n+i,t,n+i,this.strokeDashArray),fabric.util.drawDashedLine(e,t,n+i,t,n,this.strokeDashArray),e.closePath(),e.restore()},toObject:function(e){return t(this.callSuper("toObject",e),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(e){return e&&e.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice})},toSVG:function(e){var t=[],n=-this.width/2,r=-this.height/2,i="none";this.group&&this.group.type==="path-group"&&(n=this.left,r=this.top),this.alignX!=="none"&&this.alignY!=="none"&&(i="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice),t.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',n,'" y="',r,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',i,'"',"></image>\n");if(this.stroke||this.strokeDashArray){var s=this.fill;this.fill=null,t.push("<rect ",'x="',n,'" y="',r,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=s}return t.push("</g>\n"),e?e(t.join("")):t.join("")},getSrc:function(){if(this.getElement())return this.getElement().src||this.getElement()._src},setSrc:function(e,t,n){fabric.util.loadImage(e,function(e){return this.setElement(e,t,n)},this,n&&n.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(e,t){this.constructor.fromObject(this.toObject(t),e)},applyFilters:function(e,t,n,r){t=t||this.filters,n=n||this._originalElement;if(!n)return;var i=n,s=fabric.util.createCanvasElement(),o=fabric.util.createImage(),u=this;return s.width=i.width,s.height=i.height,s.getContext("2d").drawImage(i,0,0,i.width,i.height),t.length===0?(this._element=n,e&&e(),s):(t.forEach(function(e){e&&e.applyTo(s,e.scaleX||u.scaleX,e.scaleY||u.scaleY),!r&&e.type==="Resize"&&(u.width*=e.scaleX,u.height*=e.scaleY)}),o.width=s.width,o.height=s.height,fabric.isLikelyNode?(o.src=s.toBuffer(undefined,fabric.Image.pngCompression),u._element=o,!r&&(u._filteredEl=o),e&&e()):(o.onload=function(){u._element=o,!r&&(u._filteredEl=o),e&&e(),o.onload=s=i=null},o.src=s.toDataURL("image/png")),s)},_render:function(e,t){var n,r,i=this._findMargins(),s;n=t?this.left:-this.width/2,r=t?this.top:-this.height/2,this.meetOrSlice==="slice"&&(e.beginPath(),e.rect(n,r,this.width,this.height),e.clip()),this.isMoving===!1&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,s=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!1)):s=this._element,s&&e.drawImage(s,n+i.marginX,r+i.marginY,i.width,i.height),this._renderStroke(e)},_needsResize:function(){return this.scaleX!==this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var e=this.width,t=this.height,n,r,i=0,s=0;if(this.alignX!=="none"||this.alignY!=="none")n=[this.width/this._element.width,this.height/this._element.height],r=this.meetOrSlice==="meet"?Math.min.apply(null,n):Math.max.apply(null,n),e=this._element.width*r,t=this._element.height*r,this.alignX==="Mid"&&(i=(this.width-e)/2),this.alignX==="Max"&&(i=this.width-e),this.alignY==="Mid"&&(s=(this.height-t)/2),this.alignY==="Max"&&(s=this.height-
t);return{width:e,height:t,marginX:i,marginY:s}},_resetWidthHeight:function(){var e=this.getElement();this.set("width",e.width),this.set("height",e.height)},_initElement:function(e){this.setElement(fabric.util.getById(e)),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(e){e||(e={}),this.setOptions(e),this._setWidthHeight(e),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(e,t){e.filters&&e.filters.length?fabric.util.enlivenObjects(e.filters,function(e){t&&t(e)},"fabric.Image.filters"):t&&t()},_setWidthHeight:function(e){this.width="width"in e?e.width:this.getElement()?this.getElement().width||0:0,this.height="height"in e?e.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(e,t){fabric.util.loadImage(e.src,function(n){fabric.Image.prototype._initFilters.call(e,e,function(r){e.filters=r||[];var i=new fabric.Image(n,e);t&&t(i)})},null,e.crossOrigin)},fabric.Image.fromURL=function(e,t,n){fabric.util.loadImage(e,function(e){t(new fabric.Image(e,n))},null,n&&n.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),fabric.Image.fromElement=function(e,n,r){var i=fabric.parseAttributes(e,fabric.Image.ATTRIBUTE_NAMES),s="xMidYMid",o="meet",u,a,f;i.preserveAspectRatio&&(f=i.preserveAspectRatio.split(" ")),f&&f.length&&(o=f.pop(),o!=="meet"&&o!=="slice"?(s=o,o="meet"):f.length&&(s=f.pop())),u=s!=="none"?s.slice(1,4):"none",a=s!=="none"?s.slice(5,8):"none",i.alignX=u,i.alignY=a,i.meetOrSlice=o,fabric.Image.fromURL(i["xlink:href"],n,t(r?fabric.util.object.clone(r):{},i))},fabric.Image.async=!0,fabric.Image.pngCompression=1}(typeof exports!="undefined"?exports:this),fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.getAngle()%360;return e>0?Math.round((e-1)/90)*90:Math.round(e/90)*90},straighten:function(){return this.setAngle(this._getAngleValueForStraighten()),this},fxStraighten:function(e){e=e||{};var t=function(){},n=e.onComplete||t,r=e.onChange||t,i=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(e){i.setAngle(e),r()},onComplete:function(){i.setCoords(),n()},onStart:function(){i.set("active",!1)}}),this}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(e){return e.straighten(),this.renderAll(),this},fxStraightenObject:function(e){return e.fxStraighten({onChange:this.renderAll.bind(this)}),this}}),fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}}),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.Brightness=t.util.createClass(t.Image.filters.BaseFilter,{type:"Brightness",initialize:function(e){e=e||{},this.brightness=e.brightness||0},applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=this.brightness;for(var s=0,o=r.length;s<o;s+=4)r[s]+=i,r[s+1]+=i,r[s+2]+=i;t.putImageData(n,0,0)},toObject:function(){return n(this.callSuper("toObject"),{brightness:this.brightness})}}),t.Image.filters.Brightness.fromObject=function(e){return new t.Image.filters.Brightness(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.Convolute=t.util.createClass(t.Image.filters.BaseFilter,{type:"Convolute",initialize:function(e){e=e||{},this.opaque=e.opaque,this.matrix=e.matrix||[0,0,0,0,1,0,0,0,0];var n=t.util.createCanvasElement();this.tmpCtx=n.getContext("2d")},_createImageData:function(e,t){return this.tmpCtx.createImageData(e,t)},applyTo:function(e){var t=this.matrix,n=e.getContext("2d"),r=n.getImageData(0,0,e.width,e.height),i=Math.round(Math.sqrt(t.length)),s=Math.floor(i/2),o=r.data,u=r.width,a=r.height,f=u,l=a,c=this._createImageData(f,l),h=c.data,p=this.opaque?1:0;for(var d=0;d<l;d++)for(var v=0;v<f;v++){var m=d,g=v,y=(d*f+v)*4,b=0,w=0,E=0,S=0;for(var x=0;x<i;x++)for(var T=0;T<i;T++){var N=m+x-s,C=g+T-s;if(N<0||N>a||C<0||C>u)continue;var k=(N*u+C)*4,L=t[x*i+T];b+=o[k]*L,w+=o[k+1]*L,E+=o[k+2]*L,S+=o[k+3]*L}h[y]=b,h[y+1]=w,h[y+2]=E,h[y+3]=S+p*(255-S)}n.putImageData(c,0,0)},toObject:function(){return n(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=function(e){return new t.Image.filters.Convolute(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.GradientTransparency=t.util.createClass(t.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(e){e=e||{},this.threshold=e.threshold||100},applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=this.threshold,s=r.length;for(var o=0,u=r.length;o<u;o+=4)r[o+3]=i+255*(s-o)/s;t.putImageData(n,0,0)},toObject:function(){return n(this.callSuper("toObject"),{threshold:this.threshold})}}),t.Image.filters.GradientTransparency.fromObject=function(e){return new t.Image.filters.GradientTransparency(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={});t.Image.filters.Grayscale=t.util.createClass(t.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=n.width*n.height*4,s=0,o;while(s<i)o=(r[s]+r[s+1]+r[s+2])/3,r[s]=o,r[s+1]=o,r[s+2]=o,s+=4;t.putImageData(n,0,0)}}),t.Image.filters.Grayscale.fromObject=function(){return new t.Image.filters.Grayscale}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={});t.Image.filters.Invert=t.util.createClass(t.Image.filters.BaseFilter,{type:"Invert",applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=r.length,s;for(s=0;s<i;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2];t.putImageData(n,0,0)}}),t.Image.filters.Invert.fromObject=function(){return new t.Image.filters.Invert}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.Mask=t.util.createClass(t.Image.filters.BaseFilter,{type:"Mask",initialize:function(e){e=e||{},this.mask=e.mask,this.channel=[0,1,2,3].indexOf(e.channel)>-1?e.channel:0},applyTo:function(e){if(!this.mask)return;var n=e.getContext("2d"),r=n.getImageData(0,0,e.width,e.height),i=r.data,s=this.mask.getElement(),o=t.util.createCanvasElement(),u=this.channel,a,f=r.width*r.height*4;o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0,s.width,s.height);var l=o.getContext("2d").getImageData(0,0,s.width,s.height),c=l.data;for(a=0;a<f;a+=4)i[a+3]=c[a+u];n.putImageData(r,0,0)},toObject:function(){return n(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}}),t.Image.filters.Mask.fromObject=function(e,n){t.util.loadImage(e.mask.src,function(r){e.mask=new t.Image(r,e.mask),n&&n(new t.Image.filters.Mask(e))})},t.Image.filters.Mask.async=!0}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.Noise=t.util.createClass(t.Image.filters.BaseFilter,{type:"Noise",initialize:function(e){e=e||{},this.noise=e.noise||0},applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=this.noise,s;for(var o=0,u=r.length;o<u;o+=4)s=(.5-Math.random())*i,r[o]+=s,r[o+1]+=s,r[o+2]+=s;t.putImageData(n,0,0)},toObject:function(){return n(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=function(e){return new t.Image.filters.Noise(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.Pixelate=t.util.createClass(t.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(e){e=e||{},this.blocksize=e.blocksize||4},applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=n.height,s=n.width,o,u,a,f,l,c,h;for(u=0;u<i;u+=this.blocksize)for(a=0;a<s;a+=this.blocksize){o=u*4*s+a*4,f=r[o],l=r[o+1],c=r[o+2],h=r[o+3];for(var p=u,d=u+this.blocksize;p<d;p++)for(var v=a,m=a+this.blocksize;v<m;v++)o=p*4*s+v*4,r[o]=f,r[o+1]=l,r[o+2]=c,r[o+3]=h}t.putImageData(n,0,0)},toObject:function(){return n(this.callSuper("toObject"),{blocksize:this.blocksize})}}),t.Image.filters.Pixelate.fromObject=function(e){return new t.Image.filters.Pixelate(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.RemoveWhite=t.util.createClass(t.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(e){e=e||{},this.threshold=e.threshold||30,this.distance=e.distance||20},applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=this.threshold,s=this.distance,o=255-i,u=Math.abs,a,f,l;for(var c=0,h=r.length;c<h;c+=4)a=r[c],f=r[c+1],l=r[c+2],a>o&&f>o&&l>o&&u(a-f)<s&&u(a-l)<s&&u(f-l)<s&&(r[c+3]=1);t.putImageData(n,0,0)},toObject:function(){return n(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}}),t.Image.filters.RemoveWhite.fromObject=function(e){return new t.Image.filters.RemoveWhite(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={});t.Image.filters.Sepia=t.util.createClass(t.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=r.length,s,o;for(s=0;s<i;s+=4)o=.3*r[s]+.59*r[s+1]+.11*r[s+2],r[s]=o+100,r[s+1]=o+50,r[s+2]=o+255;t.putImageData(n,0,0)}}),t.Image.filters.Sepia.fromObject=function(){return new t.Image.filters.Sepia}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={});t.Image.filters.Sepia2=t.util.createClass(t.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(e){var t=e.getContext("2d"),n=t.getImageData(0,0,e.width,e.height),r=n.data,i=r.length,s,o,u,a;for(s=0;s<i;s+=4)o=r[s],u=r[s+1],a=r[s+2],r[s]=(o*.393+u*.769+a*.189)/1.351,r[s+1]=(o*.349+u*.686+a*.168)/1.203,r[s+2]=(o*.272+u*.534+a*.131)/2.14;t.putImageData(n,0,0)}}),t.Image.filters.Sepia2.fromObject=function(){return new t.Image.filters.Sepia2}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.Tint=t.util.createClass(t.Image.filters.BaseFilter,{type:"Tint",initialize:function(e){e=e||{},this.color=e.color||"#000000",this.opacity=typeof e.opacity!="undefined"?e.opacity:(new t.Color(this.color)).getAlpha()},applyTo:function(e){var n=e.getContext("2d"),r=n.getImageData(0,0,e.width,e.height),i=r.data,s=i.length,o,u,a,f,l,c,h,p,d;d=(new t.Color(this.color)).getSource(),u=d[0]*this.opacity,a=d[1]*this.opacity,f=d[2]*this.opacity,p=1-this.opacity;for(o=0;o<s;o+=4)l=i[o],c=i[o+1],h=i[o+2],i[o]=u+l*p,i[o+1]=a+c*p,i[o+2]=f+h*p;n.putImageData(r,0,0)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}}),t.Image.filters.Tint.fromObject=function(e){return new t.Image.filters.Tint(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Image.filters.Multiply=t.util.createClass(t.Image.filters.BaseFilter,{type:"Multiply",initialize:function(e){e=e||{},this.color=e.color||"#000000"},applyTo:function(e){var n=e.getContext("2d"),r=n.getImageData(0,0,e.width,e.height),i=r.data,s=i.length,o,u;u=(new t.Color(this.color)).getSource();for(o=0;o<s;o+=4)i[o]*=u[0]/255,i[o+1]*=u[1]/255,i[o+2]*=u[2]/255;n.putImageData(r,0,0)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color})}}),t.Image.filters.Multiply.fromObject=function(e){return new t.Image.filters.Multiply(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric;t.Image.filters.Blend=t.util.createClass({type:"Blend",initialize:function(e){e=e||{},this.color=e.color||"#000",this.image=e.image||!1,this.mode=e.mode||"multiply",this.alpha=e.alpha||1},applyTo:function(e){var n=e.getContext("2d"),r=n.getImageData(0,0,e.width,e.height),i=r.data,s,o,u,a,f,l,c,h=!1;if(this.image){h=!0;var p=t.util.createCanvasElement();p.width=this.image.width,p.height=this.image.height;var d=new t.StaticCanvas(p);d.add(this.image);var v=d.getContext("2d");c=v.getImageData(0,0,d.width,d.height).data}else c=(new t.Color(this.color)).getSource(),s=c[0]*this.alpha,o=c[1]*this.alpha,u=c[2]*this.alpha;for(var m=0,g=i.length;m<g;m+=4){a=i[m],f=i[m+1],l=i[m+2],h&&(s=c[m]*this.alpha,o=c[m+1]*this.alpha,u=c[m+2]*this.alpha);switch(this.mode){case"multiply":i[m]=a*s/255,i[m+1]=f*o/255,i[m+2]=l*u/255;break;case"screen":i[m]=1-(1-a)*(1-s),i[m+1]=1-(1-f)*(1-o),i[m+2]=1-(1-l)*(1-u);break;case"add":i[m]=Math.min(255,a+s),i[m+1]=Math.min(255,f+o),i[m+2]=Math.min(255,l+u);break;case"diff":case"difference":i[m]=Math.abs(a-s),i[m+1]=Math.abs(f-o),i[m+2]=Math.abs(l-u);break;case"subtract":var y=a-s,b=f-o,w=l-u;i[m]=y<0?0:y,i[m+1]=b<0?0:b,i[m+2]=w<0?0:w;break;case"darken":i[m]=Math.min(a,s),i[m+1]=Math.min(f,o),i[m+2]=Math.min(l,u);break;case"lighten":i[m]=Math.max(a,s),i[m+1]=Math.max(f,o),i[m+2]=Math.max(l,u)}}n.putImageData(r,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.Blend.fromObject=function(e){return new t.Image.filters.Blend(e)}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=Math.pow,r=Math.floor,i=Math.sqrt,s=Math.abs,o=Math.max,u=Math.round,a=Math.sin,f=Math.ceil;t.Image.filters.Resize=t.util.createClass(t.Image.filters.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,applyTo:function(e,t,n){this.rcpScaleX=1/t,this.rcpScaleY=1/n;var r=e.width,i=e.height,s=u(r*t),o=u(i*n),a;this.resizeType==="sliceHack"&&(a=this.sliceByTwo(e,r,i,s,o)),this.resizeType==="hermite"&&(a=this.hermiteFastResize(e,r,i,s,o)),this.resizeType==="bilinear"&&(a=this.bilinearFiltering(e,r,i,s,o)),this.resizeType==="lanczos"&&(a=this.lanczosResize(e,r,i,s,o)),e.width=s,e.height=o,e.getContext("2d").putImageData(a,0,0)},sliceByTwo:function(e,n,i,s,u){var a=e.getContext("2d"),f,l=.5,c=.5,h=1,p=1,d=!1,v=!1,m=n,g=i,y=t.util.createCanvasElement(),b=y.getContext("2d");s=r(s),u=r(u),y.width=o(s,n),y.height=o(u,i),s>n&&(l=2,h=-1),u>i&&(c=2,p=-1),f=a.getImageData(0,0,n,i),e.width=o(s,n),e.height=o(u,i),a.putImageData(f,0,0);while(!d||!v)n=m,i=g,s*h<r(m*l*h)?m=r(m*l):(m=s,d=!0),u*p<r(g*c*p)?g=r(g*c):(g=u,v=!0),f=a.getImageData(0,0,n,i),b.putImageData(f,0,0),a.clearRect(0,0,m,g),a.drawImage(y,0,0,n,i,0,0,m,g);return a.getImageData(0,0,s,u)},lanczosResize:function(e,t,o,u,l){function c(e){return function(t){if(t>e)return 0;t*=Math.PI;if(s(t)<1e-16)return 1;var n=t/e;return a(t)*a(n)/t/n}}function h(e){var a,f,c,p,d,L,A,O,M,_,D;C.x=(e+.5)*b,k.x=r(C.x);for(a=0;a<l;a++){C.y=(a+.5)*w,k.y=r(C.y),d=0,L=0,A=0,O=0,M=0;for(f=k.x-x;f<=k.x+x;f++){if(f<0||f>=t)continue;_=r(1e3*s(f-C.x)),N[_]||(N[_]={});for(var P=k.y-T;P<=k.y+T;P++){if(P<0||P>=o)continue;D=r(1e3*s(P-C.y)),N[_][D]||(N[_][D]=y(i(n(_*E,2)+n(D*S,2))/1e3)),c=N[_][D],c>0&&(p=(P*t+f)*4,d+=c,L+=c*m[p],A+=c*m[p+1],O+=c*m[p+2],M+=c*m[p+3])}}p=(a*u+e)*4,g[p]=L/d,g[p+1]=A/d,g[p+2]=O/d,g[p+3]=M/d}return++e<u?h(e):v}var p=e.getContext("2d"),d=p.getImageData(0,0,t,o),v=p.getImageData(0,0,u,l),m=d.data,g=v.data,y=c(this.lanczosLobes),b=this.rcpScaleX,w=this.rcpScaleY,E=2/this.rcpScaleX,S=2/this.rcpScaleY,x=f(b*this.lanczosLobes/2),T=f(w*this.lanczosLobes/2),N={},C={},k={};return h(0)},bilinearFiltering:function(e,t,n,i,s){var o,u,a,f,l,c,h,p,d,v,m,g,y=0,b,w=this.rcpScaleX,E=this.rcpScaleY,S=e.getContext("2d"),x=4*(t-1),T=S.getImageData(0,0,t,n),N=T.data,C=S.getImageData(0,0,i,s),k=C.data;for(h=0;h<s;h++)for(p=0;p<i;p++){l=r(w*p),c=r(E*h),d=w*p-l,v=E*h-c,b=4*(c*t+l);for(m=0;m<4;m++)o=N[b+m],u=N[b+4+m],a=N[b+x+m],f=N[b+x+4+m],g=o*(1-d)*(1-v)+u*d*(1-v)+a*v*(1-d)+f*d*v,k[y++]=g}return C},hermiteFastResize:function(e,t,n,o,u){var a=this.rcpScaleX,l=this.rcpScaleY,c=f(a/2),h=f(l/2),p=e.getContext("2d"),d=p.getImageData(0,0,t,n),v=d.data,m=p.getImageData(0,0,o,u),g=m.data;for(var y=0;y<u;y++)for(var b=0;b<o;b++){var w=(b+y*o)*4,E=0,S=0,x=0,T=0,N=0,C=0,k=0,L=(y+.5)*l;for(var A=r(y*l);A<(y+1)*l;A++){var O=s(L-(A+.5))/h,M=(b+.5)*a,_=O*O;for(var D=r(b*a);D<(b+1)*a;D++){var P=s(M-(D+.5))/c,H=i(_+P*P);if(H>1&&H<-1)continue;E=2*H*H*H-3*H*H+1,E>0&&(P=4*(D+A*t),k+=E*v[P+3],x+=E,v[P+3]<255&&(E=E*v[P+3]/250),T+=E*v[P],N+=E*v[P+1],C+=E*v[P+2],S+=E)}}g[w]=T/S,g[w+1]=N/S,g[w+2]=C/S,g[w+3]=k/x}return m}}),t.Image.filters.Resize.fromObject=function(){return new t.Image.filters.Resize}}(typeof exports!="undefined"?exports:this),function(e){"use strict";var t=e.fabric||(e.fabric={}),n=t.util.object.extend,r=t.util.object.clone,i=t.util.toFixed,s=t.StaticCanvas.supports("setLineDash");if(t.Text){t.warn("fabric.Text is already defined");return}var o=t.Object.prototype.stateProperties.concat();o.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor","useNative","path"),t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,textDecoration:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.3,textBackgroundColor:"",path:null,useNative:!0,stateProperties:o,stroke:null,shadow:null,initialize:function(e,t){t=t||{},this.text=e,this.__skipDimension=!0,this.setOptions(t),this.__skipDimension=!1,this._initDimensions()},_initDimensions:function(){if(this.__skipDimension)return;var e=t.util.createCanvasElement();this._render(e.getContext("2d"))},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(e){typeof Cufon=="undefined"||this.useNative===!0?this._renderViaNative(e):this._renderViaCufon(e)},_renderViaNative:function(e){var n=this.text.split(this._reNewline);this._setTextStyles(e),this.width=this._getTextWidth(e,n),this.height=this._getTextHeight(e,n),this.clipTo&&t.util.clipContext(this,e),this._renderTextBackground(e,n),this._translateForTextAlign(e),this._renderText(e,n),this.textAlign!=="left"&&this.textAlign!=="justify"&&e.restore(),this._renderTextDecoration(e,n),this.clipTo&&e.restore(),this._setBoundaries(e,n),this._totalLineHeight=0},_renderText:function(e,t){e.save(),this._setOpacity(e),this._setShadow(e),this._setupCompositeOperation(e),this._renderTextFill(e,t),this._renderTextStroke(e,t),this._restoreCompositeOperation(e),this._removeShadow(e),e.restore()},_translateForTextAlign:function(e){this.textAlign!=="left"&&this.textAlign!=="justify"&&(e.save(),e.translate(this.textAlign==="center"?this.width/2:this.width,0))},_setBoundaries:function(e,t){this._boundaries=[];for(var n=0,r=t.length;n<r;n++){var i=this._getLineWidth(e,t[n]),s=this._getLineLeftOffset(i);this._boundaries.push({height:this.fontSize*this.lineHeight,width:i,left:s})}},_setTextStyles:function(e){this._setFillStyles(e),this._setStrokeStyles(e),e.textBaseline="alphabetic",this.skipTextAlign||(e.textAlign=this.textAlign),e.font=this._getFontDeclaration()},_getTextHeight:function(e,t){return this.fontSize*t.length*this.lineHeight},_getTextWidth:function(e,t){var n=e.measureText(t[0]||"|").width;for(var r=1,i=t.length;r<i;r++){var s=e.measureText(t[r]).width;s>n&&(n=s)}return n},_renderChars:function(e,t,n,r,i){t[e](n,r,i)},_renderTextLine:function(e,t,n,r,i,s){i-=this.fontSize/4;if(this.textAlign!=="justify"){this._renderChars(e,t,n,r,i,s);return}var o=t.measureText(n).width,u=this.width;if(u>o){var a=n.split(/\s+/),f=t.measureText(n.replace(/\s+/g,"")).width,l=u-f,c=a.length-1,h=l/c,p=0;for(var d=0,v=a.length;d<v;d++)this._renderChars(e,t,a[d],r+p,i,s),p+=t.measureText(a[d]).width+h}else this._renderChars(e,t,n,r,i,s)},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(e,t){if(!this.fill&&!this._skipFillStrokeCheck)return;this._boundaries=[];var n=0;for(var r=0,i=t.length;r<i;r++){var s=this._getHeightOfLine(e,r,t);n+=s,this._renderTextLine("fillText",e,t[r],this._getLeftOffset(),this._getTopOffset()+n,r)}this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e)},_renderTextStroke:function(e,t){if((!this.stroke||this.strokeWidth===0)&&!this._skipFillStrokeCheck)return;var n=0;e.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),s&&e.setLineDash(this.strokeDashArray)),e.beginPath();for(var r=0,i=t.length;r<i;r++){var o=this._getHeightOfLine(e,r,t);n+=o,this._renderTextLine("strokeText",e,t[r],this._getLeftOffset(),this._getTopOffset()+n,r)}e.closePath(),e.restore()},_getHeightOfLine:function(){return this.fontSize*this.lineHeight},_renderTextBackground:function(e,t){this._renderTextBoxBackground(e),this._renderTextLinesBackground(e,t)},_renderTextBoxBackground:function(e){if(!this.backgroundColor)return;e.save(),e.fillStyle=this.backgroundColor,e.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),e.restore()},_renderTextLinesBackground:function(e,t){if(!this.textBackgroundColor)return;e.save(),e.fillStyle=this.textBackgroundColor;for(var n=0,r=t.length;n<r;n++)if(t[n]!==""){var i=this._getLineWidth(e,t[n]),s=this._getLineLeftOffset(i);e.fillRect(this._getLeftOffset()+s,this._getTopOffset()+n*this.fontSize*this.lineHeight,i,this.fontSize*this.lineHeight)}e.restore()},_getLineLeftOffset:function(e){return this.textAlign==="center"?(this.width-e)/2:this.textAlign==="right"?this.width-e:0},_getLineWidth:function(e,t){return this.textAlign==="justify"?this.width:e.measureText(t).width},_renderTextDecoration:function(e,t){function i(i){for(var s=0,o=t.length;s<o;s++){var u=r._getLineWidth(e,t[s]),a=r._getLineLeftOffset(u);e.fillRect(r._getLeftOffset()+a,~~(i+s*r._getHeightOfLine(e,s,t)-n),u,1)}}if(!this.textDecoration)return;var n=this._getTextHeight(e,t)/2,r=this;this.textDecoration.indexOf("underline")>-1&&i(this.fontSize*this.lineHeight),this.textDecoration.indexOf("line-through")>-1&&i(this.fontSize*this.lineHeight-this.fontSize/2),this.textDecoration.indexOf("overline")>-1&&i(this.fontSize*this.lineHeight-this.fontSize)},_getFontDeclaration:function(){return[t.isLikelyNode?this.fontWeight:this.fontStyle,t.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",t.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(e,t){if(!this.visible)return;e.save(),t||this.transform(e);var n=this.group&&this.group.type==="path-group";n&&e.translate(-this.group.width/2,-this.group.height/2),this.transformMatrix&&e.transform.apply(e,this.transformMatrix),n&&e.translate(this.left,this.top),this._render(e),e.restore()},toObject:function(e){var t=n(this.callSuper("toObject",e),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,path:this.path,textBackgroundColor:this.textBackgroundColor,useNative:this.useNative});return this.includeDefaultValues||this._removeDefaultValues(t),t},toSVG:function(e){var t=[],n=this.text.split(this._reNewline),r=this._getSVGLeftTopOffsets(n),i=this._getSVGTextAndBg(r.lineTop,r.textLeft,n),s=this._getSVGShadows(r.lineTop,n);return r.textTop+=this._fontAscent?this._fontAscent/5*this.lineHeight:0,this._wrapSVGTextAndBg(t,i,s,r),e?e(t.join("")):t.join("")},_getSVGLeftTopOffsets:function(e){var t=this.useNative?this.fontSize*this.lineHeight:-this._fontAscent-this._fontAscent/5*this.lineHeight,n=-(this.width/2),r=this.useNative?this.fontSize*this.lineHeight-.25*this.fontSize:this.height/2-e.length*this.fontSize-this._totalLineHeight;return{textLeft:n+(this.group&&this.group.type==="path-group"?this.left:0),textTop:r+(this.group&&this.group.type==="path-group"?this.top:0),lineTop:t}},_wrapSVGTextAndBg:function(e,t,n,r){e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',t.textBgRects.join(""),"<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" ','transform="translate(',i(r.textLeft,2)," ",i(r.textTop,2),')">',n.join(""),t.textSpans.join(""),"</text>\n","</g>\n")},_getSVGShadows:function(e,n){var r=[],s,o,u=1;if(!this.shadow||!this._boundaries)return r;for(s=0,o=n.length;s<o;s++)if(n[s]!==""){var a=this._boundaries&&this._boundaries[s]?this._boundaries[s].left:0;r.push('<tspan x="',i(a+u+this.shadow.offsetX,2),s===0||this.useNative?'" y':'" dy','="',i(this.useNative?e*s-this.height/2+this.shadow.offsetY:e+(s===0?this.shadow.offsetY:0),2),'" ',this._getFillAttributes(this.shadow.color),">",t.util.string.escapeXml(n[s]),"</tspan>"),u=1}else u++;return r},_getSVGTextAndBg:function(e,t,n){var r=[],i=[],s=1;this._setSVGBg(i);for(var o=0,u=n.length;o<u;o++){n[o]!==""?(this._setSVGTextLineText(n[o],o,r,e,s,i),s=1):s++;if(!this.textBackgroundColor||!this._boundaries)continue;this._setSVGTextLineBg(i,o,t,e)}return{textSpans:r,textBgRects:i}},_setSVGTextLineText:function(e,n,r,s,o){var u=this._boundaries&&this._boundaries[n]?i(this._boundaries[n].left,2):0;r.push('<tspan x="',u,'" ',n===0||this.useNative?"y":"dy",'="',i(this.useNative?s*n-this.height/2:s*o,2),'" ',this._getFillAttributes(this.fill),">",t.util.string.escapeXml(e),"</tspan>")},_setSVGTextLineBg:function(e,t,n,r){e.push("<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',i(n+this._boundaries[t].left,2),'" y="',i(r*t-this.height/2,2),'" width="',i(this._boundaries[t].width,2),'" height="',i(this._boundaries[t].height,2),'"></rect>\n')},_setSVGBg:function(e){this.backgroundColor&&this._boundaries&&e.push("<rect ",this._getFillAttributes(this.backgroundColor),' x="',i(-this.width/2,2),'" y="',i(-this.height/2,2),'" width="',i(this.width,2),'" height="',i(this.height,2),'"></rect>')},_getFillAttributes:function(e){var n=e&&typeof e=="string"?new t.Color(e):"";return!n||!n.getSource()||n.getAlpha()===1?'fill="'+e+'"':'opacity="'+n.getAlpha()+'" fill="'+n.setAlpha(1).toRgb()+'"'},_set:function(e,t){e==="fontFamily"&&this.path&&(this.path=this.path.replace(/(.*?)([^\/]*)(\.font\.js)/,"$1"+t+"$3")),this.callSuper("_set",e,t),e in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(e,n){if(!e)return null;var r=t.parseAttributes(e,t.Text.ATTRIBUTE_NAMES);n=t.util.object.extend(n?t.util.object.clone(n):{},r),n.top=n.top||0,n.left=n.left||0,"dx"in r&&(n.left+=r.dx),"dy"in r&&(n.top+=r.dy),"fontSize"in n||(n.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE),n.originX||(n.originX="left"),n.top+=n.fontSize/4;var i=new t.Text(e.textContent,n),s=0;return i.originX==="left"&&(s=i.getWidth()/2),i.originX==="right"&&(s=-i.getWidth()/2),i.set({left:i.getLeft()+s,top:i.getTop()-i.getHeight()/2}),i},t.Text.fromObject=function(e){return new t.Text(e.text,r(e))},t.util.createAccessors(t.Text)}(typeof exports!="undefined"?exports:this),function(){var e=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,styles:null,caching:!0,_skipFillStrokeCheck:!0,_reSpace:/\s|\n/,_fontSizeFraction:4,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,_charWidthsCache:{},initialize:function(e,t){this.styles=t?t.styles||{}:{},this.callSuper("initialize",e,t),this.initBehavior(),fabric.IText.instances.push(this),this.__lineWidths={},this.__lineHeights={},this.__lineOffsets={}},isEmptyStyles:function(){if(!this.styles)return!0;var e=this.styles;for(var t in e)for(var n in e[t])for(var r in e[t][n])return!1;return!0},setSelectionStart:function(e){this.selectionStart!==e&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})),this.selectionStart=e,this.hiddenTextarea&&(this.hiddenTextarea.selectionStart=e)},setSelectionEnd:function(e){this.selectionEnd!==e&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})),this.selectionEnd=e,this.hiddenTextarea&&(this.hiddenTextarea.selectionEnd=e)},getSelectionStyles:function(e,t){if(arguments.length===2){var n=[];for(var r=e;r<t;r++)n.push(this.getSelectionStyles(r));return n}var i=this.get2DCursorLocation(e);return this.styles[i.lineIndex]?this.styles[i.lineIndex][i.charIndex]||{}:{}},setSelectionStyles:function(e){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,e);else for(var t=this.selectionStart;t<this.selectionEnd;t++)this._extendStyles(t,e);return this},_extendStyles:function(e,t){var n=this.get2DCursorLocation(e);this.styles[n.lineIndex]||(this.styles[n.lineIndex]={}),this.styles[n.lineIndex][n.charIndex]||(this.styles[n.lineIndex][n.charIndex]={}),fabric.util.object.extend(this.styles[n.lineIndex][n.charIndex],t)},_render:function(e){this.callSuper("_render",e),this.ctx=e,this.isEditing&&this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(!this.active)return;var e=this.text.split(""),t;this.selectionStart===this.selectionEnd?(t=this._getCursorBoundaries(e,"cursor"),this.renderCursor(t)):(t=this._getCursorBoundaries(e,"selection"),this.renderSelection(e,t))},get2DCursorLocation:function(e){typeof e=="undefined"&&(e=this.selectionStart);var t=this.text.slice(0,e),n=t.split(this._reNewline);return{lineIndex:n.length-1,charIndex:n[n.length-1].length}},getCurrentCharStyle:function(e,t){var n=this.styles[e]&&this.styles[e][t===0?0:t-1];return{fontSize:n&&n.fontSize||this.fontSize,fill:n&&n.fill||this.fill,textBackgroundColor:n&&n.textBackgroundColor||this.textBackgroundColor,textDecoration:n&&n.textDecoration||this.textDecoration,fontFamily:n&&n.fontFamily||this.fontFamily,fontWeight:n&&n.fontWeight||this.fontWeight,fontStyle:n&&n.fontStyle||this.fontStyle,stroke:n&&n.stroke||this.stroke,strokeWidth:n&&n.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(e,t){return this.styles[e]&&this.styles[e][t===0?0:t-1]&&this.styles[e][t===0?0:t-1].fontSize||this.fontSize},getCurrentCharColor:function(e,t){return this.styles[e]&&this.styles[e][t===0?0:t-1]&&this.styles[e][t===0?0:t-1].fill||this.cursorColor},_getCursorBoundaries:function(e,t){var n=this.get2DCursorLocation(),r=this.text.split(this._reNewline),i=Math.round(this._getLeftOffset()),s=this._getTopOffset(),o=this._getCursorBoundariesOffsets(e,t,n,r);return{left:i,top:s,leftOffset:o.left+o.lineLeft,topOffset:o.top}},_getCursorBoundariesOffsets:function(e,t,n,r){var i=0,s=0,o=0,u=0,a=t==="cursor"?this._getHeightOfLine(this.ctx,0)-this.getCurrentCharFontSize(n.lineIndex,n.charIndex):0;for(var f=0;f<this.selectionStart;f++){if(e[f]==="\n"){u=0;var l=s+(t==="cursor"?1:0);a+=this._getCachedLineHeight(l),s++,o=0}else u+=this._getWidthOfChar(this.ctx,e[f],s,o),o++;i=this._getCachedLineOffset(s,r)}return this._clearCache(),{top:a,left:u,lineLeft:i}},_clearCache:function(){this.__lineWidths={},this.__lineHeights={},this.__lineOffsets={}},_getCachedLineHeight:function(e){return this.__lineHeights[e]||(this.__lineHeights[e]=this._getHeightOfLine(this.ctx,e))},_getCachedLineWidth:function(e,t){return this.__lineWidths[e]||(this.__lineWidths[e]=this._getWidthOfLine(this.ctx,e,t))},_getCachedLineOffset:function(e,t){var n=this._getCachedLineWidth(e,t);return this.__lineOffsets[e]||(this.__lineOffsets[e]=this.
_getLineLeftOffset(n))},renderCursor:function(e){var t=this.ctx;t.save();var n=this.get2DCursorLocation(),r=n.lineIndex,i=n.charIndex,s=this.getCurrentCharFontSize(r,i),o=r===0&&i===0?this._getCachedLineOffset(r,this.text.split(this._reNewline)):e.leftOffset;t.fillStyle=this.getCurrentCharColor(r,i),t.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,t.fillRect(e.left+o,e.top+e.topOffset,this.cursorWidth/this.scaleX,s),t.restore()},renderSelection:function(e,t){var n=this.ctx;n.save(),n.fillStyle=this.selectionColor;var r=this.get2DCursorLocation(this.selectionStart),i=this.get2DCursorLocation(this.selectionEnd),s=r.lineIndex,o=i.lineIndex,u=this.text.split(this._reNewline);for(var a=s;a<=o;a++){var f=this._getCachedLineOffset(a,u)||0,l=this._getCachedLineHeight(a),c=0;if(a===s)for(var h=0,p=u[a].length;h<p;h++)h>=r.charIndex&&(a!==o||h<i.charIndex)&&(c+=this._getWidthOfChar(n,u[a][h],a,h)),h<r.charIndex&&(f+=this._getWidthOfChar(n,u[a][h],a,h));else if(a>s&&a<o)c+=this._getCachedLineWidth(a,u)||5;else if(a===o)for(var d=0,v=i.charIndex;d<v;d++)c+=this._getWidthOfChar(n,u[a][d],a,d);n.fillRect(t.left+f,t.top+t.topOffset,c,l),t.topOffset+=l}n.restore()},_renderChars:function(e,t,n,r,i,s){if(this.isEmptyStyles())return this._renderCharsFast(e,t,n,r,i);this.skipTextAlign=!0,r-=this.textAlign==="center"?this.width/2:this.textAlign==="right"?this.width:0;var o=this.text.split(this._reNewline),u=this._getWidthOfLine(t,s,o),a=this._getHeightOfLine(t,s,o),f=this._getLineLeftOffset(u),l=n.split(""),c,h="";r+=f||0,t.save();for(var p=0,d=l.length;p<=d;p++){c=c||this.getCurrentCharStyle(s,p);var v=this.getCurrentCharStyle(s,p+1);if(this._hasStyleChanged(c,v)||p===d)this._renderChar(e,t,s,p-1,h,r,i,a),h="",c=v;h+=l[p]}t.restore()},_renderCharsFast:function(e,t,n,r,i){this.skipTextAlign=!1,e==="fillText"&&this.fill&&this.callSuper("_renderChars",e,t,n,r,i),e==="strokeText"&&this.stroke&&this.callSuper("_renderChars",e,t,n,r,i)},_renderChar:function(e,t,n,r,i,s,o,u){var a,f,l;if(this.styles&&this.styles[n]&&(a=this.styles[n][r])){var c=a.stroke||this.stroke,h=a.fill||this.fill;t.save(),f=this._applyCharStylesGetWidth(t,i,n,r,a),l=this._getHeightOfChar(t,i,n,r),h&&t.fillText(i,s,o),c&&t.strokeText(i,s,o),this._renderCharDecoration(t,a,s,o,f,u,l),t.restore(),t.translate(f,0)}else e==="strokeText"&&this.stroke&&t[e](i,s,o),e==="fillText"&&this.fill&&t[e](i,s,o),f=this._applyCharStylesGetWidth(t,i,n,r),this._renderCharDecoration(t,null,s,o,f,u),t.translate(t.measureText(i).width,0)},_hasStyleChanged:function(e,t){return e.fill!==t.fill||e.fontSize!==t.fontSize||e.textBackgroundColor!==t.textBackgroundColor||e.textDecoration!==t.textDecoration||e.fontFamily!==t.fontFamily||e.fontWeight!==t.fontWeight||e.fontStyle!==t.fontStyle||e.stroke!==t.stroke||e.strokeWidth!==t.strokeWidth},_renderCharDecoration:function(e,t,n,r,i,s,o){var u=t?t.textDecoration||this.textDecoration:this.textDecoration,a=(t?t.fontSize:null)||this.fontSize;if(!u)return;u.indexOf("underline")>-1&&this._renderCharDecorationAtOffset(e,n,r+this.fontSize/this._fontSizeFraction,i,0,this.fontSize/20),u.indexOf("line-through")>-1&&this._renderCharDecorationAtOffset(e,n,r+this.fontSize/this._fontSizeFraction,i,o/2,a/20),u.indexOf("overline")>-1&&this._renderCharDecorationAtOffset(e,n,r,i,s-this.fontSize/this._fontSizeFraction,this.fontSize/20)},_renderCharDecorationAtOffset:function(e,t,n,r,i,s){e.fillRect(t,n-i,r,s)},_renderTextLine:function(e,t,n,r,i,s){i+=this.fontSize/4,this.callSuper("_renderTextLine",e,t,n,r,i,s)},_renderTextDecoration:function(e,t){if(this.isEmptyStyles())return this.callSuper("_renderTextDecoration",e,t)},_renderTextLinesBackground:function(e,t){if(!this.textBackgroundColor&&!this.styles)return;e.save(),this.textBackgroundColor&&(e.fillStyle=this.textBackgroundColor);var n=0,r=this.fontSize/this._fontSizeFraction;for(var i=0,s=t.length;i<s;i++){var o=this._getHeightOfLine(e,i,t);if(t[i]===""){n+=o;continue}var u=this._getWidthOfLine(e,i,t),a=this._getLineLeftOffset(u);this.textBackgroundColor&&(e.fillStyle=this.textBackgroundColor,e.fillRect(this._getLeftOffset()+a,this._getTopOffset()+n+r,u,o));if(this.styles[i])for(var f=0,l=t[i].length;f<l;f++)if(this.styles[i]&&this.styles[i][f]&&this.styles[i][f].textBackgroundColor){var c=t[i][f];e.fillStyle=this.styles[i][f].textBackgroundColor,e.fillRect(this._getLeftOffset()+a+this._getWidthOfCharsAt(e,i,f,t),this._getTopOffset()+n+r,this._getWidthOfChar(e,c,i,f,t)+1,o)}n+=o}e.restore()},_getCacheProp:function(e,t){return e+t.fontFamily+t.fontSize+t.fontWeight+t.fontStyle+t.shadow},_applyCharStylesGetWidth:function(t,n,r,i,s){var o=s||this.styles[r]&&this.styles[r][i];o?o=e(o):o={},this._applyFontStyles(o);var u=this._getCacheProp(n,o);if(this.isEmptyStyles()&&this._charWidthsCache[u]&&this.caching)return this._charWidthsCache[u];typeof o.shadow=="string"&&(o.shadow=new fabric.Shadow(o.shadow));var a=o.fill||this.fill;return t.fillStyle=a.toLive?a.toLive(t):a,o.stroke&&(t.strokeStyle=o.stroke&&o.stroke.toLive?o.stroke.toLive(t):o.stroke),t.lineWidth=o.strokeWidth||this.strokeWidth,t.font=this._getFontDeclaration.call(o),this._setShadow.call(o,t),this.caching?(this._charWidthsCache[u]||(this._charWidthsCache[u]=t.measureText(n).width),this._charWidthsCache[u]):t.measureText(n).width},_applyFontStyles:function(e){e.fontFamily||(e.fontFamily=this.fontFamily),e.fontSize||(e.fontSize=this.fontSize),e.fontWeight||(e.fontWeight=this.fontWeight),e.fontStyle||(e.fontStyle=this.fontStyle)},_getStyleDeclaration:function(t,n){return this.styles[t]&&this.styles[t][n]?e(this.styles[t][n]):{}},_getWidthOfChar:function(e,t,n,r){if(this.textAlign==="justify"&&/\s/.test(t))return this._getWidthOfSpace(e,n);var i=this._getStyleDeclaration(n,r);this._applyFontStyles(i);var s=this._getCacheProp(t,i);if(this._charWidthsCache[s]&&this.caching)return this._charWidthsCache[s];if(e){e.save();var o=this._applyCharStylesGetWidth(e,t,n,r);return e.restore(),o}},_getHeightOfChar:function(e,t,n,r){return this.styles[n]&&this.styles[n][r]?this.styles[n][r].fontSize||this.fontSize:this.fontSize},_getWidthOfCharAt:function(e,t,n,r){r=r||this.text.split(this._reNewline);var i=r[t].split("")[n];return this._getWidthOfChar(e,i,t,n)},_getHeightOfCharAt:function(e,t,n,r){r=r||this.text.split(this._reNewline);var i=r[t].split("")[n];return this._getHeightOfChar(e,i,t,n)},_getWidthOfCharsAt:function(e,t,n,r){var i=0;for(var s=0;s<n;s++)i+=this._getWidthOfCharAt(e,t,s,r);return i},_getWidthOfLine:function(e,t,n){return this._getWidthOfCharsAt(e,t,n[t].length,n)},_getWidthOfSpace:function(e,t){var n=this.text.split(this._reNewline),r=n[t],i=r.split(/\s+/),s=this._getWidthOfWords(e,r,t),o=this.width-s,u=i.length-1,a=o/u;return a},_getWidthOfWords:function(e,t,n){var r=0;for(var i=0;i<t.length;i++){var s=t[i];s.match(/\s/)||(r+=this._getWidthOfChar(e,s,n,i))}return r},_getTextWidth:function(e,t){if(this.isEmptyStyles())return this.callSuper("_getTextWidth",e,t);var n=this._getWidthOfLine(e,0,t);for(var r=1,i=t.length;r<i;r++){var s=this._getWidthOfLine(e,r,t);s>n&&(n=s)}return n},_getHeightOfLine:function(e,t,n){n=n||this.text.split(this._reNewline);var r=this._getHeightOfChar(e,n[t][0],t,0),i=n[t],s=i.split("");for(var o=1,u=s.length;o<u;o++){var a=this._getHeightOfChar(e,s[o],t,o);a>r&&(r=a)}return r*this.lineHeight},_getTextHeight:function(e,t){var n=0;for(var r=0,i=t.length;r<i;r++)n+=this._getHeightOfLine(e,r,t);return n},_getTopOffset:function(){var e=fabric.Text.prototype._getTopOffset.call(this);return e-this.fontSize/this._fontSizeFraction},_renderTextBoxBackground:function(e){if(!this.backgroundColor)return;e.save(),e.fillStyle=this.backgroundColor,e.fillRect(this._getLeftOffset(),this._getTopOffset()+this.fontSize/this._fontSizeFraction,this.width,this.height),e.restore()},toObject:function(t){return fabric.util.object.extend(this.callSuper("toObject",t),{styles:e(this.styles)})}}),fabric.IText.fromObject=function(t){return new fabric.IText(t.text,e(t))},fabric.IText.instances=[]}(),function(){var e=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var e=this;setTimeout(function(){e.selected=!0},100)})},initAddedHandler:function(){this.on("added",function(){this.canvas&&!this.canvas._hasITextHandlers&&(this.canvas._hasITextHandlers=!0,this._initCanvasHandlers())})},_initCanvasHandlers:function(){this.canvas.on("selection:cleared",function(){fabric.IText.prototype.exitEditingOnOthers.call()}),this.canvas.on("mouse:up",function(){fabric.IText.instances.forEach(function(e){e.__isMousedown=!1})}),this.canvas.on("object:selected",function(e){fabric.IText.prototype.exitEditingOnOthers.call(e.target)})},_tick:function(){if(this._abortCursorAnimation)return;var e=this;this.animate("_currentCursorOpacity",1,{duration:this.cursorDuration,onComplete:function(){e._onTickComplete()},onChange:function(){e.canvas&&e.canvas.renderAll()},abort:function(){return e._abortCursorAnimation}})},_onTickComplete:function(){if(this._abortCursorAnimation)return;var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){e.animate("_currentCursorOpacity",0,{duration:this.cursorDuration/2,onComplete:function(){e._tick()},onChange:function(){e.canvas&&e.canvas.renderAll()},abort:function(){return e._abortCursorAnimation}})},100)},initDelayedCursor:function(e){var t=this,n=e?0:this.cursorDelay;e&&(this._abortCursorAnimation=!0,clearTimeout(this._cursorTimeout1),this._currentCursorOpacity=1,this.canvas&&this.canvas.renderAll()),this._cursorTimeout2&&clearTimeout(this._cursorTimeout2),this._cursorTimeout2=setTimeout(function(){t._abortCursorAnimation=!1,t._tick()},n)},abortCursorAnimation:function(){this._abortCursorAnimation=!0,clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,this.canvas&&this.canvas.renderAll();var e=this;setTimeout(function(){e._abortCursorAnimation=!1},10)},selectAll:function(){this.selectionStart=0,this.selectionEnd=this.text.length,this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(e){var t=0,n=e-1;if(this._reSpace.test(this.text.charAt(n)))while(this._reSpace.test(this.text.charAt(n)))t++,n--;while(/\S/.test(this.text.charAt(n))&&n>-1)t++,n--;return e-t},findWordBoundaryRight:function(e){var t=0,n=e;if(this._reSpace.test(this.text.charAt(n)))while(this._reSpace.test(this.text.charAt(n)))t++,n++;while(/\S/.test(this.text.charAt(n))&&n<this.text.length)t++,n++;return e+t},findLineBoundaryLeft:function(e){var t=0,n=e-1;while(!/\n/.test(this.text.charAt(n))&&n>-1)t++,n--;return e-t},findLineBoundaryRight:function(e){var t=0,n=e;while(!/\n/.test(this.text.charAt(n))&&n<this.text.length)t++,n++;return e+t},getNumNewLinesInSelectedText:function(){var e=this.getSelectedText(),t=0;for(var n=0,r=e.split(""),i=r.length;n<i;n++)r[n]==="\n"&&t++;return t},searchWordBoundary:function(e,t){var n=this._reSpace.test(this.text.charAt(e))?e-1:e,r=this.text.charAt(n),i=/[ \n\.,;!\?\-]/;while(!i.test(r)&&n>0&&n<this.text.length)n+=t,r=this.text.charAt(n);return i.test(r)&&r!=="\n"&&(n+=t===1?0:1),n},selectWord:function(e){var t=this.searchWordBoundary(e,-1),n=this.searchWordBoundary(e,1);this.setSelectionStart(t),this.setSelectionEnd(n),this.initDelayedCursor(!0)},selectLine:function(e){var t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);this.setSelectionStart(t),this.setSelectionEnd(n),this.initDelayedCursor(!0)},enterEditing:function(){if(this.isEditing||!this.editable)return;return this.exitEditingOnOthers(),this.isEditing=!0,this.initHiddenTextarea(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._tick(),this.canvas&&this.canvas.renderAll(),this.fire("editing:entered"),this.canvas&&this.canvas.fire("text:editing:entered",{target:this}),this},exitEditingOnOthers:function(){fabric.IText.instances.forEach(function(e){e.selected=!1,e.isEditing&&e.exitEditing()},this)},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){if(!this.hiddenTextarea)return;this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){if(!this._savedProps)return;this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor)},exitEditing:function(){return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this.fire("editing:exited"),this.canvas&&this.canvas.fire("text:editing:exited",{target:this}),this},_removeExtraneousStyles:function(){var e=this.text.split(this._reNewline);for(var t in this.styles)e[t]||delete this.styles[t]},_removeCharsFromTo:function(e,t){var n=t;while(n!==e){var r=this.get2DCursorLocation(n).charIndex;n--;var i=this.get2DCursorLocation(n).charIndex,s=i>r;s?this.removeStyleObject(s,n+1):this.removeStyleObject(this.get2DCursorLocation(n).charIndex===0,n)}this.text=this.text.slice(0,e)+this.text.slice(t)},insertChars:function(e){var t=this.text.slice(this.selectionStart,this.selectionStart+1)==="\n";this.text=this.text.slice(0,this.selectionStart)+e+this.text.slice(this.selectionEnd),this.selectionStart===this.selectionEnd&&this.insertStyleObjects(e,t,this.copiedStyles),this.selectionStart+=e.length,this.selectionEnd=this.selectionStart,this.canvas&&this.canvas.renderAll().renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},insertNewlineStyleObject:function(t,n,r){this.shiftLineStyles(t,1),this.styles[t+1]||(this.styles[t+1]={});var i=this.styles[t][n-1],s={};if(r)s[0]=e(i),this.styles[t+1]=s;else{for(var o in this.styles[t])parseInt(o,10)>=n&&(s[parseInt(o,10)-n]=this.styles[t][o],delete this.styles[t][o]);this.styles[t+1]=s}},insertCharStyleObject:function(t,n,r){var i=this.styles[t],s=e(i);n===0&&!r&&(n=1);for(var o in s){var u=parseInt(o,10);u>=n&&(i[u+1]=s[u])}this.styles[t][n]=r||e(i[n-1])},insertStyleObjects:function(e,t,n){var r=this.get2DCursorLocation(),i=r.lineIndex,s=r.charIndex;this.styles[i]||(this.styles[i]={}),e==="\n"?this.insertNewlineStyleObject(i,s,t):n?this._insertStyles(n):this.insertCharStyleObject(i,s)},_insertStyles:function(e){for(var t=0,n=e.length;t<n;t++){var r=this.get2DCursorLocation(this.selectionStart+t),i=r.lineIndex,s=r.charIndex;this.insertCharStyleObject(i,s,e[t])}},shiftLineStyles:function(t,n){var r=e(this.styles);for(var i in this.styles){var s=parseInt(i,10);s>t&&(this.styles[s+n]=r[s])}},removeStyleObject:function(t,n){var r=this.get2DCursorLocation(n),i=r.lineIndex,s=r.charIndex;if(t){var o=this.text.split(this._reNewline),u=o[i-1],a=u?u.length:0;this.styles[i-1]||(this.styles[i-1]={});for(s in this.styles[i])this.styles[i-1][parseInt(s,10)+a]=this.styles[i][s];this.shiftLineStyles(i,-1)}else{var f=this.styles[i];if(f){var l=this.selectionStart===this.selectionEnd?-1:0;delete f[s+l]}var c=e(f);for(var h in c){var p=parseInt(h,10);p>=s&&p!==0&&(f[p-1]=c[p],delete f[p])}}},insertNewline:function(){this.insertChars("\n")}})}(),fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+(new Date),this.__lastLastClickTime=+(new Date),this.__lastPointer={},this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(e){this.__newClickTime=+(new Date);var t=this.canvas.getPointer(e.e);this.isTripleClick(t)?(this.fire("tripleclick",e),this._stopEvent(e.e)):this.isDoubleClick(t)&&(this.fire("dblclick",e),this._stopEvent(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected},isDoubleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y&&this.__lastIsEditing},isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler(),this.initMousedownHandler(),this.initMousemoveHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("dblclick",function(e){this.selectWord(this.getSelectionStartFromPointer(e.e))}),this.on("tripleclick",function(e){this.selectLine(this.getSelectionStartFromPointer(e.e))})},initMousedownHandler:function(){this.on("mousedown",function(e){var t=this.canvas.getPointer(e.e);this.__mousedownX=t.x,this.__mousedownY=t.y,this.__isMousedown=!0,this.hiddenTextarea&&this.canvas&&this.canvas.wrapperEl.appendChild(this.hiddenTextarea),this.selected&&this.setCursorByClick(e.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.initDelayedCursor(!0))})},initMousemoveHandler:function(){this.on("mousemove",function(e){if(!this.__isMousedown||!this.isEditing)return;var t=this.getSelectionStartFromPointer(e.e);t>=this.__selectionStartOnMouseDown?(this.setSelectionStart(this.__selectionStartOnMouseDown),this.setSelectionEnd(t)):(this.setSelectionStart(t),this.setSelectionEnd(this.__selectionStartOnMouseDown))})},_isObjectMoved:function(e){var t=this.canvas.getPointer(e);return this.__mousedownX!==t.x||this.__mousedownY!==t.y},initMouseupHandler:function(){this.on("mouseup",function(e){this.__isMousedown=!1;if(this._isObjectMoved(e.e))return;this.__lastSelected&&(this.enterEditing(),this.initDelayedCursor(!0)),this.selected=!0})},setCursorByClick:function(e){var t=this.getSelectionStartFromPointer(e);e.shiftKey?t<this.selectionStart?(this.setSelectionEnd(this.selectionStart),this.setSelectionStart(t)):this.setSelectionEnd(t):(this.setSelectionStart(t),this.setSelectionEnd(t))},_getLocalRotatedPointer:function(e){var t=this.canvas.getPointer(e),n=new fabric.Point(t.x,t.y),r=new fabric.Point(this.left,this.top),i=fabric.util.rotatePoint(n,r,fabric.util.degreesToRadians(-this.angle));return this.getLocalPointer(e,i)},getSelectionStartFromPointer:function(e){var t=this._getLocalRotatedPointer(e),n=this.text.split(this._reNewline),r=0,i=0,s=0,o=0,u;for(var a=0,f=n.length;a<f;a++){s+=this._getHeightOfLine(this.ctx,a)*this.scaleY;var l=this._getWidthOfLine(this.ctx,a,n),c=this._getLineLeftOffset(l);i=c*this.scaleX,this.flipX&&(n[a]=n[a].split("").reverse().join(""));for(var h=0,p=n[a].length;h<p;h++){var d=n[a][h];r=i,i+=this._getWidthOfChar(this.ctx,d,a,this.flipX?p-h:h)*this.scaleX;if(s<=t.y||i<=t.x){o++;continue}return this._getNewSelectionStartFromOffset(t,r,i,o+a,p)}if(t.y<s)return this._getNewSelectionStartFromOffset(t,r,i,o+a,p)}if(typeof u=="undefined")return this.text.length},_getNewSelectionStartFromOffset:function(e,t,n,r,i){var s=e.x-t,o=n-e.x,u=o>s?0:1,a=r+u;return this.flipX&&(a=i-a),a>this.text.length&&(a=this.text.length),a}}),fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.style.cssText="position: fixed; bottom: 20px; left: 0px; opacity: 0; width: 0px; height: 0px; z-index: -999;",fabric.document.body.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keypress",this.onKeyPress.bind(this)),fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",9:"exitEditing",27:"exitEditing",13:"insertNewline",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMap:{65:"selectAll",88:"cut"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(!this.isEditing)return;if(e.keyCode in this._keysMap)this[this._keysMap[e.keyCode]](e);else{if(!(e.keyCode in this._ctrlKeysMap&&(e.ctrlKey||e.metaKey)))return;this[this._ctrlKeysMap[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.renderAll()},forwardDelete:function(e){this.selectionStart===this.selectionEnd&&this.moveCursorRight(e),this.removeChars(e)},copy:function(e){var t=this.getSelectedText(),n=this._getClipboardData(e);n&&n.setData("text",t),this.copiedText=t,this.copiedStyles=this.getSelectionStyles(this.selectionStart,this.selectionEnd)},paste:function(e){var t=null,n=this._getClipboardData(e);n?t=n.getData("text"):t=this.copiedText,t&&this.insertChars(t)},cut:function(e){if(this.selectionStart===this.selectionEnd)return;this.copy(),this.removeChars(e)},_getClipboardData:function(e){return e&&(e.clipboardData||fabric.window.clipboardData)},onKeyPress:function(e){if(!this.isEditing||e.metaKey||e.ctrlKey)return;e.which!==0&&this.insertChars(String.fromCharCode(e.which)),e.stopPropagation()},getDownCursorOffset:function(e,t){var n=t?this.selectionEnd:this.selectionStart,r=this.text.split(this._reNewline),i,s,o=this.text.slice(0,n),u=this.text.slice(n),a=o.slice(o.lastIndexOf("\n")+1),f=u.match(/(.*)\n?/)[1],l=(u.match(/.*\n(.*)\n?/)||{})[1]||"",c=this.get2DCursorLocation(n);if(c.lineIndex===r.length-1||e.metaKey||e.keyCode===34)return this.text.length-n;var h=this._getWidthOfLine(this.ctx,c.lineIndex,r);s=this._getLineLeftOffset(h);var p=s,d=c.lineIndex;for(var v=0,m=a.length;v<m;v++)i=a[v],p+=this._getWidthOfChar(this.ctx,i,d,v);var g=this._getIndexOnNextLine(c,l,p,r);return f.length+1+g},_getIndexOnNextLine:function(e,t,n,r){var i=e.lineIndex+1,s=this._getWidthOfLine(this.ctx,i,r),o=this._getLineLeftOffset(s),u=o,a=0,f;for(var l=0,c=t.length;l<c;l++){var h=t[l],p=this._getWidthOfChar(this.ctx,h,i,l);u+=p;if(u>n){f=!0;var d=u-p,v=u,m=Math.abs(d-n),g=Math.abs(v-n);a=g<m?l+1:l;break}}return f||(a=t.length),a},moveCursorDown:function(e){this.abortCursorAnimation(),this._currentCursorOpacity=1;var t=this.getDownCursorOffset(e,this._selectionDirection==="right");e.shiftKey?this.moveCursorDownWithShift(t):this.moveCursorDownWithoutShift(t),this.initDelayedCursor()},moveCursorDownWithoutShift:function(e){this._selectionDirection="right",this.selectionStart+=e,this.selectionStart>this.text.length&&(this.selectionStart=this.text.length),this.selectionEnd=this.selectionStart,this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},swapSelectionPoints:function(){var e=this.selectionEnd;this.selectionEnd=this.selectionStart,this.selectionStart=e},moveCursorDownWithShift:function(e){this.selectionEnd===this.selectionStart&&(this._selectionDirection="right");var t=this._selectionDirection==="right"?"selectionEnd":"selectionStart";this[t]+=e,this.selectionEnd<this.selectionStart&&this._selectionDirection==="left"&&(this.swapSelectionPoints(),this._selectionDirection="right"),this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length),this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},getUpCursorOffset:function(e,t){var n=t?this.selectionEnd:this.selectionStart,r=this.get2DCursorLocation(n);if(r.lineIndex===0||e.metaKey||e.keyCode===33)return n;var i=this.text.slice(0,n),s=i.slice(i.lastIndexOf("\n")+1),o=(i.match(/\n?(.*)\n.*$/)||{})[1]||"",u=this.text.split(this._reNewline),a,f=this._getWidthOfLine(this.ctx,r.lineIndex,u),l=this._getLineLeftOffset(f),c=l,h=r.lineIndex;for(var p=0,d=s.length;p<d;p++)a=s[p],c+=this._getWidthOfChar(this.ctx,a,h,p);var v=this._getIndexOnPrevLine(r,o,c,u);return o.length-v+s.length},_getIndexOnPrevLine:function(e,t,n,r){var i=e.lineIndex-1,s=this._getWidthOfLine(this.ctx,i,r),o=this._getLineLeftOffset(s),u=o,a=0,f;for(var l=0,c=t.length;l<c;l++){var h=t[l],p=this._getWidthOfChar(this.ctx,h,i,l);u+=p;if(u>n){f=!0;var d=u-p,v=u,m=Math.abs(d-n),g=Math.abs(v-n);a=g<m?l:l-1;break}}return f||(a=t.length-1),a},moveCursorUp:function(e){this.abortCursorAnimation(),this._currentCursorOpacity=1;var t=this.getUpCursorOffset(e,this._selectionDirection==="right");e.shiftKey?this.moveCursorUpWithShift(t):this.moveCursorUpWithoutShift(t),this.initDelayedCursor()},moveCursorUpWithShift:function(e){this.selectionEnd===this.selectionStart&&(this._selectionDirection="left");var t=this._selectionDirection==="right"?"selectionEnd":"selectionStart";this[t]-=e,this.selectionEnd<this.selectionStart&&this._selectionDirection==="right"&&(this.swapSelectionPoints(),this._selectionDirection="left"),this.selectionStart<0&&(this.selectionStart=0),this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},moveCursorUpWithoutShift:function(e){this.selectionStart===this.selectionEnd&&(this.selectionStart-=e),this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd=this.selectionStart,this._selectionDirection="left",this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},moveCursorLeft:function(e){if(this.selectionStart===0&&this.selectionEnd===0)return;this.abortCursorAnimation(),this._currentCursorOpacity=1,e.shiftKey?this.moveCursorLeftWithShift(e):this.moveCursorLeftWithoutShift(e),this.initDelayedCursor()},_move:function(e,t,n){e.altKey?this[t]=this["findWordBoundary"+n](this[t]):e.metaKey||e.keyCode===35||e.keyCode===36?this[t]=this["findLineBoundary"+n](this[t]):this[t]+=n==="Left"?-1:1},_moveLeft:function(e,t){this._move(e,t,"Left")},_moveRight:function(e,t){this._move(e,t,"Right")},moveCursorLeftWithoutShift:function(e){this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this._moveLeft(e,"selectionStart"),this.selectionEnd=this.selectionStart,this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},moveCursorLeftWithShift:function(e){this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):(this._selectionDirection="left",this._moveLeft(e,"selectionStart"),this.text.charAt(this.selectionStart)==="\n"&&this.selectionStart--,this.selectionStart<0&&(this.selectionStart=0)),this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},moveCursorRight:function(e){if(this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length)return;this.abortCursorAnimation(),this._currentCursorOpacity=1,e.shiftKey?this.moveCursorRightWithShift(e):this.moveCursorRightWithoutShift(e),this.initDelayedCursor()},moveCursorRightWithShift:function(e){this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):(this._selectionDirection="right",this._moveRight(e,"selectionEnd"),this.text.charAt(this.selectionEnd-1)==="\n"&&this.selectionEnd++,this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length)),this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},moveCursorRightWithoutShift:function(e){this._selectionDirection="right",this.selectionStart===this.selectionEnd?(this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):(this.selectionEnd+=this.getNumNewLinesInSelectedText(),this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length),this.selectionStart=this.selectionEnd),this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},removeChars:function(e){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(e):this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.selectionEnd=this.selectionStart,this._removeExtraneousStyles(),this.canvas&&this.canvas.renderAll().renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(e){if(this.selectionStart!==0)if(e.metaKey){var t=this.findLineBoundaryLeft(this.selectionStart);this._removeCharsFromTo(t,this.selectionStart),this.selectionStart=t}else if(e.altKey){var n=this.findWordBoundaryLeft(this.selectionStart);this._removeCharsFromTo(n,this.selectionStart),this.selectionStart=n}else{var r=this.text.slice(this.selectionStart-1,this.selectionStart)==="\n";this.removeStyleObject(r),this.selectionStart--,this.text=this.text.slice(0,this.selectionStart)+this.text.slice(this.selectionStart+1)}}}),fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(e,t,n,r,i,s){this.styles[t]?this._setSVGTextLineChars(e,t,n,r,i,s):this.callSuper("_setSVGTextLineText",e,t,n,r,i)},_setSVGTextLineChars:function(e,t,n,r,i,s){var o=t===0||this.useNative?"y":"dy",u=e.split(""),a=0,f=this._getSVGLineLeftOffset(t),l=this._getSVGLineTopOffset(t),c=this._getHeightOfLine(this.ctx,t);for(var h=0,p=u.length;h<p;h++){var d=this.styles[t][h]||{};n.push(this._createTextCharSpan(u[h],d,f,l,o,a));var v=this._getWidthOfChar(this.ctx,u[h],t,h);d.textBackgroundColor&&s.push(this._createTextCharBg(d,f,l,c,v,a)),a+=v}},_getSVGLineLeftOffset:function(e){return this._boundaries&&this._boundaries[e]?fabric.util.toFixed(this._boundaries[e].left,2):0},_getSVGLineTopOffset:function(e){var t=0;for(var n=0;n<=e;n++)t+=this._getHeightOfLine(this.ctx,n);return t-this.height/2},_createTextCharBg:function(e,t,n,r,i,s){return['<rect fill="',e.textBackgroundColor,'" transform="translate(',-this.width/2," ",-this.height+r,")",'" x="',t+s,'" y="',n+r,'" width="',i,'" height="',r,'"></rect>'].join("")},_createTextCharSpan:function(e,t,n,r,i,s){var o=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text"},t));return['<tspan x="',n+s,'" ',i,'="',r,'" ',t.fontFamily?'font-family="'+t.fontFamily.replace(/"/g,"'")+'" ':"",t.fontSize?'font-size="'+t.fontSize+'" ':"",t.fontStyle?'font-style="'+t.fontStyle+'" ':"",t.fontWeight?'font-weight="'+t.fontWeight+'" ':"",t.textDecoration?'text-decoration="'+t.textDecoration+'" ':"",'style="',o,'">',fabric.util.string.escapeXml(e),"</tspan>"].join("")}}),function(){function request(e,t,n){var r=URL.parse(e);r.port||(r.port=r.protocol.indexOf("https:")===0?443:80);var i=r.port===443?HTTPS:HTTP,s=i.request({hostname:r.hostname,port:r.port,path:r.path,method:"GET"},function(e){var r="";t&&e.setEncoding(t),e.on("end",function(){n(r)}),e.on("data",function(t){e.statusCode===200&&(r+=t)})});s.on("error",function(e){e.errno===process.ECONNREFUSED?fabric.log("ECONNREFUSED: connection refused to "+r.hostname+":"+r.port):fabric.log(e.message)}),s.end()}function requestFs(e,t){var n=require("fs");n.readFile(e,function(e,n){if(e)throw fabric.log(e),e;t(n)})}if(typeof document!="undefined"&&typeof window!="undefined")return;var DOMParser=require("xmldom").DOMParser,URL=require("url"),HTTP=require("http"),HTTPS=require("https"),Canvas=require("canvas"),Image=require("canvas").Image;fabric.util.loadImage=function(e,t,n){function r(r){i.src=new Buffer(r,"binary"),i._src=e,t&&t.call(n,i)}var i=new Image;e&&(e instanceof Buffer||e.indexOf("data")===0)?(i.src=i._src=e,t&&t.call(n,i)):e&&e.indexOf("http")!==0?requestFs(e,r):e?request(e,"binary",r):t&&t.call(n,e)},fabric.loadSVGFromURL=function(e,t,n){e=e.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim(),e.indexOf("http")!==0?requestFs(e,function(
e){fabric.loadSVGFromString(e.toString(),t,n)}):request(e,"",function(e){fabric.loadSVGFromString(e,t,n)})},fabric.loadSVGFromString=function(e,t,n){var r=(new DOMParser).parseFromString(e);fabric.parseSVGDocument(r.documentElement,function(e,n){t&&t(e,n)},n)},fabric.util.getScript=function(url,callback){request(url,"",function(body){eval(body),callback&&callback()})},fabric.Image.fromObject=function(e,t){fabric.util.loadImage(e.src,function(n){var r=new fabric.Image(n);r._initConfig(e),r._initFilters(e,function(e){r.filters=e||[],t&&t(r)})})},fabric.createCanvasForNode=function(e,t,n,r){r=r||n;var i=fabric.document.createElement("canvas"),s=new Canvas(e||600,t||600,r);i.style={},i.width=s.width,i.height=s.height;var o=fabric.Canvas||fabric.StaticCanvas,u=new o(i,n);return u.contextContainer=s.getContext("2d"),u.nodeCanvas=s,u.Font=Canvas.Font,u},fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()},fabric.StaticCanvas.prototype.createJPEGStream=function(e){return this.nodeCanvas.createJPEGStream(e)};var origSetWidth=fabric.StaticCanvas.prototype.setWidth;fabric.StaticCanvas.prototype.setWidth=function(e,t){return origSetWidth.call(this,e,t),this.nodeCanvas.width=e,this},fabric.Canvas&&(fabric.Canvas.prototype.setWidth=fabric.StaticCanvas.prototype.setWidth);var origSetHeight=fabric.StaticCanvas.prototype.setHeight;fabric.StaticCanvas.prototype.setHeight=function(e,t){return origSetHeight.call(this,e,t),this.nodeCanvas.height=e,this},fabric.Canvas&&(fabric.Canvas.prototype.setHeight=fabric.StaticCanvas.prototype.setHeight)}();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/jquery.printElement.min.js' */
/// <reference path="http://code.jquery.com/jquery-1.4.1-vsdoc.js" />
/*
* Print Element Plugin 1.2
*
* Copyright (c) 2010 Erik Zaadi
*
* Inspired by PrintArea (http://plugins.jquery.com/project/PrintArea) and
* http://stackoverflow.com/questions/472951/how-do-i-print-an-iframe-from-javascript-in-safari-chrome
*
*  Home Page : http://projects.erikzaadi/jQueryPlugins/jQuery.printElement
*  Issues (bug reporting) : http://github.com/erikzaadi/jQueryPlugins/issues/labels/printElement
*  jQuery plugin page : http://plugins.jquery.com/project/printElement
*
*  Thanks to David B (http://github.com/ungenio) and icgJohn (http://www.blogger.com/profile/11881116857076484100)
*  For their great contributions!
*
* Dual licensed under the MIT and GPL licenses:
*   http://www.opensource.org/licenses/mit-license.php
*   http://www.gnu.org/licenses/gpl.html
*
*   Note, Iframe Printing is not supported in Opera and Chrome 3.0, a popup window will be shown instead
*/
; (function (window, undefined) {
    var document = window["document"];
    var $ = window["jQuery"];
    $.fn["printElement"] = function (options) {
        var mainOptions = $.extend({}, $.fn["printElement"]["defaults"], options);
        //iframe mode is not supported for opera and chrome 3.0 (it prints the entire page).
        //http://www.google.com/support/forum/p/Webmasters/thread?tid=2cb0f08dce8821c3&hl=en
        if (mainOptions["printMode"] == 'iframe') {
            if ((/opera/.test(navigator.userAgent.toLowerCase())) || (/chrome/.test(navigator.userAgent.toLowerCase())))
                mainOptions["printMode"] = 'popup';
        }
        //Remove previously printed iframe if exists
        $("[id^='printElement_']").remove();

        return this.each(function () {
            //Support Metadata Plug-in if available
            var opts = $.meta ? $.extend({}, mainOptions, $(this).data()) : mainOptions;
            _printElement($(this), opts);
        });
    };
    $.fn["printElement"]["defaults"] = {
        //"printMode": 'iframe', //Usage : iframe / popup
        "printMode": 'popup', //Usage : iframe / popup
        "pageTitle": '', //Print Page Title
        "overrideElementCSS": null,
        /* Can be one of the following 3 options:
        * 1 : boolean (pass true for stripping all css linked)
        * 2 : array of $.fn.printElement.cssElement (s)
        * 3 : array of strings with paths to alternate css files (optimized for print)
        */
        "printBodyOptions": {
            "styleToAdd": 'padding:10px;margin:10px;', //style attributes to add to the body of print document
            "classNameToAdd": '' //css class to add to the body of print document
        },
        "leaveOpen": false, // in case of popup, leave the print page open or not
        "iframeElementOptions": {
            "styleToAdd": 'border:none;position:absolute;width:0px;height:0px;bottom:0px;left:0px;', //style attributes to add to the iframe element
            "classNameToAdd": '' //css class to add to the iframe element
        }
    };
    $.fn["printElement"]["cssElement"] = {
        "href": '',
        "media": ''
    };
    function _printElement(element, opts) {
        //Create markup to be printed
        var html = _getMarkup(element, opts);

        var popupOrIframe = null;
        var documentToWriteTo = null;
        if (opts["printMode"].toLowerCase() == 'popup') {
            popupOrIframe = window.open('about:blank', 'printElementWindow', 'width=650,height=440,scrollbars=yes');
            documentToWriteTo = popupOrIframe.document;
        }
        else {
            //The random ID is to overcome a safari bug http://www.cjboco.com.sharedcopy.com/post.cfm/442dc92cd1c0ca10a5c35210b8166882.html
            var printElementID = "printElement_" + (Math.round(Math.random() * 99999)).toString();
            //Native creation of the element is faster..
            var iframe = document.createElement('IFRAME');
            $(iframe).attr({
                style: opts["iframeElementOptions"]["styleToAdd"],
                id: printElementID,
                className: opts["iframeElementOptions"]["classNameToAdd"],
                frameBorder: 0,
                scrolling: 'no',
                src: 'about:blank'
            });
            document.body.appendChild(iframe);
            documentToWriteTo = (iframe.contentWindow || iframe.contentDocument);
            if (documentToWriteTo.document)
                documentToWriteTo = documentToWriteTo.document;
            iframe = document.frames ? document.frames[printElementID] : document.getElementById(printElementID);
            popupOrIframe = iframe.contentWindow || iframe;
        }
        focus();
        documentToWriteTo.open();
        documentToWriteTo.write(html);
        documentToWriteTo.close();
        _callPrint(popupOrIframe);
    };

    function _callPrint(element) {
        if (element && element["printPage"])
            element["printPage"]();
        else
            setTimeout(function () {
                _callPrint(element);
            }, 50);
    }

    function _getElementHTMLIncludingFormElements(element) {
        var $element = $(element);
        //Radiobuttons and checkboxes
        $(":checked", $element).each(function () {
            this.setAttribute('checked', 'checked');
        });
        //simple text inputs
        $("input[type='text']", $element).each(function () {
            this.setAttribute('value', $(this).val());
        });
        $("select", $element).each(function () {
            var $select = $(this);
            $("option", $select).each(function () {
                if ($select.val() == $(this).val())
                    this.setAttribute('selected', 'selected');
            });
        });
        $("textarea", $element).each(function () {
            //Thanks http://blog.ekini.net/2009/02/24/jquery-getting-the-latest-textvalue-inside-a-textarea/
            var value = $(this).attr('value');
            //fix for issue 7 (http://plugins.jquery.com/node/13503 and http://github.com/erikzaadi/jQueryPlugins/issues#issue/7)
            if ($.browser.mozilla && this.firstChild)
                this.firstChild.textContent = value;
            else
                this.innerHTML = value;
        });
        //http://dbj.org/dbj/?p=91
        var elementHtml = $('<div></div>').append($element.clone()).html();
        return elementHtml;
    }

    function _getBaseHref() {
        var port = (window.location.port) ? ':' + window.location.port : '';
        return window.location.protocol + '//' + window.location.hostname + port + window.location.pathname;
    }

    function _getMarkup(element, opts) {
        var $element = $(element);
        var elementHtml = _getElementHTMLIncludingFormElements(element);

        var html = new Array();

        // Copy doctype if it's present
        if (document.doctype) {
            var node = document.doctype;
            html.push(
                "<!DOCTYPE "
                + node.name
                + (node.publicId ? ' PUBLIC "' + node.publicId + '"' : '')
                + (!node.publicId && node.systemId ? ' SYSTEM' : '')
                + (node.systemId ? ' "' + node.systemId + '"' : '')
                + '>'
            );
        }
        html.push('<html><head><title>' + opts["pageTitle"] + '</title>');
        if (opts["overrideElementCSS"]) {
            if (opts["overrideElementCSS"].length > 0) {
                for (var x = 0; x < opts["overrideElementCSS"].length; x++) {
                    var current = opts["overrideElementCSS"][x];
                    if (typeof (current) == 'string')
                        html.push('<link type="text/css" rel="stylesheet" href="' + current + '" >');
                    else
                        html.push('<link type="text/css" rel="stylesheet" href="' + current["href"] + '" media="' + current["media"] + '" >');
                }
            }
        }
        else {
            $("link", document).filter(function () {
                return $(this).attr("rel").toLowerCase() == "stylesheet";
            }).each(function () {
                html.push('<link type="text/css" rel="stylesheet" href="' + $(this).attr("href") + '" media="' + $(this).attr('media') + '" >');
            });
        }
        //Ensure that relative links work
        html.push('<base href="' + _getBaseHref() + '" />');
        html.push('</head><body style="' + opts["printBodyOptions"]["styleToAdd"] + '" class="' + opts["printBodyOptions"]["classNameToAdd"] + '">');
        html.push('<div class="' + $element.attr('class') + '">' + elementHtml + '</div>');
        html.push('<script type="text/javascript">function printPage(){focus();print();' + ((!(/opera/.test(navigator.userAgent.toLowerCase())) && !opts["leaveOpen"] && opts["printMode"].toLowerCase() == 'popup') ? 'close();' : '') + '}</script>');
        html.push('</body></html>');

        return html.join('');
    };
})(window);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/jquery.mask.min.js' */
/**
 * jquery.mask.js
 * @version: v1.11.4
 * @author: Igor Escobar
 *
 * Created by Igor Escobar on 2012-03-10. Please report any bug at http://blog.igorescobar.com
 *
 * Copyright (c) 2012 Igor Escobar http://blog.igorescobar.com
 *
 * The MIT License (http://www.opensource.org/licenses/mit-license.php)
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */

/* jshint laxbreak: true */
/* global define, jQuery, Zepto */

'use strict';

// UMD (Universal Module Definition) patterns for JavaScript modules that work everywhere.
// https://github.com/umdjs/umd/blob/master/jqueryPluginCommonjs.js
(function (factory) {

    if (typeof define === 'function' && define.amd) {
        define(['jquery'], factory);
    } else if (typeof exports === 'object') {
        module.exports = factory(require('jquery'));
    } else {
        factory(jQuery || Zepto);
    }

}(function ($) {

    var Mask = function (el, mask, options) {
        el = $(el);

        var jMask = this, oldValue = el.val(), regexMask;

        mask = typeof mask === 'function' ? mask(el.val(), undefined, el,  options) : mask;

        var p = {
            invalid: [],
            getCaret: function () {
                try {
                    var sel,
                        pos = 0,
                        ctrl = el.get(0),
                        dSel = document.selection,
                        cSelStart = ctrl.selectionStart;

                    // IE Support
                    if (dSel && navigator.appVersion.indexOf('MSIE 10') === -1) {
                        sel = dSel.createRange();
                        sel.moveStart('character', el.is('input') ? -el.val().length : -el.text().length);
                        pos = sel.text.length;
                    }
                    // Firefox support
                    else if (cSelStart || cSelStart === '0') {
                        pos = cSelStart;
                    }

                    return pos;
                } catch (e) {}
            },
            setCaret: function(pos) {
                try {
                    if (el.is(':focus')) {
                        var range, ctrl = el.get(0);

                        if (ctrl.setSelectionRange) {
                            ctrl.setSelectionRange(pos,pos);
                        } else if (ctrl.createTextRange) {
                            range = ctrl.createTextRange();
                            range.collapse(true);
                            range.moveEnd('character', pos);
                            range.moveStart('character', pos);
                            range.select();
                        }
                    }
                } catch (e) {}
            },
            events: function() {
                el
                .on('keyup.mask', p.behaviour)
                .on('paste.mask drop.mask', function() {
                    setTimeout(function() {
                        el.keydown().keyup();
                    }, 100);
                })
                .on('change.mask', function(){
                    el.data('changed', true);
                })
                .on('blur.mask', function(){
                    if (oldValue !== el.val() && !el.data('changed')) {
                        el.triggerHandler('change');
                    }
                    el.data('changed', false);
                })
                // it's very important that this callback remains in this position
                // otherwhise oldValue it's going to work buggy
                .on('keydown.mask, blur.mask', function() {
                    oldValue = el.val();
                })
                // select all text on focus
                .on('focus.mask', function (e) {
                    if (options.selectOnFocus === true) {
                        $(e.target).select();
                    }
                })
                // clear the value if it not complete the mask
                .on('focusout.mask', function() {
                    if (options.clearIfNotMatch && !regexMask.test(p.val())) {
                       p.val('');
                   }
                });
            },
            getRegexMask: function() {
                var maskChunks = [], translation, pattern, optional, recursive, oRecursive, r;

                for (var i = 0; i < mask.length; i++) {
                    translation = jMask.translation[mask.charAt(i)];

                    if (translation) {

                        pattern = translation.pattern.toString().replace(/.{1}$|^.{1}/g, '');
                        optional = translation.optional;
                        recursive = translation.recursive;

                        if (recursive) {
                            maskChunks.push(mask.charAt(i));
                            oRecursive = {digit: mask.charAt(i), pattern: pattern};
                        } else {
                            maskChunks.push(!optional && !recursive ? pattern : (pattern + '?'));
                        }

                    } else {
                        maskChunks.push(mask.charAt(i).replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&'));
                    }
                }

                r = maskChunks.join('');

                if (oRecursive) {
                    r = r.replace(new RegExp('(' + oRecursive.digit + '(.*' + oRecursive.digit + ')?)'), '($1)?')
                         .replace(new RegExp(oRecursive.digit, 'g'), oRecursive.pattern);
                }

                return new RegExp(r);
            },
            destroyEvents: function() {
                el.off(['keydown', 'keyup', 'paste', 'drop', 'blur', 'focusout', ''].join('.mask '));
            },
            val: function(v) {
                var isInput = el.is('input'),
                    method = isInput ? 'val' : 'text',
                    r;

                if (arguments.length > 0) {
                    if (el[method]() !== v) {
                        el[method](v);
                    }
                    r = el;
                } else {
                    r = el[method]();
                }

                return r;
            },
            getMCharsBeforeCount: function(index, onCleanVal) {
                for (var count = 0, i = 0, maskL = mask.length; i < maskL && i < index; i++) {
                    if (!jMask.translation[mask.charAt(i)]) {
                        index = onCleanVal ? index + 1 : index;
                        count++;
                    }
                }
                return count;
            },
            caretPos: function (originalCaretPos, oldLength, newLength, maskDif) {
                var translation = jMask.translation[mask.charAt(Math.min(originalCaretPos - 1, mask.length - 1))];

                return !translation ? p.caretPos(originalCaretPos + 1, oldLength, newLength, maskDif)
                                    : Math.min(originalCaretPos + newLength - oldLength - maskDif, newLength);
            },
            behaviour: function(e) {
                e = e || window.event;
                p.invalid = [];
                var keyCode = e.keyCode || e.which;
                if ($.inArray(keyCode, jMask.byPassKeys) === -1) {

                    var caretPos = p.getCaret(),
                        currVal = p.val(),
                        currValL = currVal.length,
                        changeCaret = caretPos < currValL,
                        newVal = p.getMasked(),
                        newValL = newVal.length,
                        maskDif = p.getMCharsBeforeCount(newValL - 1) - p.getMCharsBeforeCount(currValL - 1);

                    p.val(newVal);

                    // change caret but avoid CTRL+A
                    if (changeCaret && !(keyCode === 65 && e.ctrlKey)) {
                        // Avoid adjusting caret on backspace or delete
                        if (!(keyCode === 8 || keyCode === 46)) {
                            caretPos = p.caretPos(caretPos, currValL, newValL, maskDif);
                        }
                        p.setCaret(caretPos);
                    }

                    return p.callbacks(e);
                }
            },
            getMasked: function(skipMaskChars) {
                var buf = [],
                    value = p.val(),
                    m = 0, maskLen = mask.length,
                    v = 0, valLen = value.length,
                    offset = 1, addMethod = 'push',
                    resetPos = -1,
                    lastMaskChar,
                    check;

                if (options.reverse) {
                    addMethod = 'unshift';
                    offset = -1;
                    lastMaskChar = 0;
                    m = maskLen - 1;
                    v = valLen - 1;
                    check = function () {
                        return m > -1 && v > -1;
                    };
                } else {
                    lastMaskChar = maskLen - 1;
                    check = function () {
                        return m < maskLen && v < valLen;
                    };
                }

                while (check()) {
                    var maskDigit = mask.charAt(m),
                        valDigit = value.charAt(v),
                        translation = jMask.translation[maskDigit];

                    if (translation) {
                        if (valDigit.match(translation.pattern)) {
                            buf[addMethod](valDigit);
                             if (translation.recursive) {
                                if (resetPos === -1) {
                                    resetPos = m;
                                } else if (m === lastMaskChar) {
                                    m = resetPos - offset;
                                }

                                if (lastMaskChar === resetPos) {
                                    m -= offset;
                                }
                            }
                            m += offset;
                        } else if (translation.optional) {
                            m += offset;
                            v -= offset;
                        } else if (translation.fallback) {
                            buf[addMethod](translation.fallback);
                            m += offset;
                            v -= offset;
                        } else {
                          p.invalid.push({p: v, v: valDigit, e: translation.pattern});
                        }
                        v += offset;
                    } else {
                        if (!skipMaskChars) {
                            buf[addMethod](maskDigit);
                        }

                        if (valDigit === maskDigit) {
                            v += offset;
                        }

                        m += offset;
                    }
                }

                var lastMaskCharDigit = mask.charAt(lastMaskChar);
                if (maskLen === valLen + 1 && !jMask.translation[lastMaskCharDigit]) {
                    buf.push(lastMaskCharDigit);
                }

                return buf.join('');
            },
            callbacks: function (e) {
                var val = p.val(),
                    changed = val !== oldValue,
                    defaultArgs = [val, e, el, options],
                    callback = function(name, criteria, args) {
                        if (typeof options[name] === 'function' && criteria) {
                            options[name].apply(this, args);
                        }
                    };

                callback('onChange', changed === true, defaultArgs);
                callback('onKeyPress', changed === true, defaultArgs);
                callback('onComplete', val.length === mask.length, defaultArgs);
                callback('onInvalid', p.invalid.length > 0, [val, e, el, p.invalid, options]);
            }
        };


        // public methods
        jMask.mask = mask;
        jMask.options = options;
        jMask.remove = function() {
            var caret = p.getCaret();
            p.destroyEvents();
            p.val(jMask.getCleanVal());
            p.setCaret(caret - p.getMCharsBeforeCount(caret));
            return el;
        };

        // get value without mask
        jMask.getCleanVal = function() {
           return p.getMasked(true);
        };

       jMask.init = function(onlyMask) {
            onlyMask = onlyMask || false;
            options = options || {};

            jMask.byPassKeys = $.jMaskGlobals.byPassKeys;
            jMask.translation = $.jMaskGlobals.translation;

            jMask.translation = $.extend({}, jMask.translation, options.translation);
            jMask = $.extend(true, {}, jMask, options);

            regexMask = p.getRegexMask();

            if (onlyMask === false) {

                if (options.placeholder) {
                    el.attr('placeholder' , options.placeholder);
                }

                // autocomplete needs to be off. we can't intercept events
                // the browser doesn't  fire any kind of event when something is
                // selected in a autocomplete list so we can't sanitize it.
                el.attr('autocomplete', 'off');
                p.destroyEvents();
                p.events();

                var caret = p.getCaret();
                p.val(p.getMasked());
                p.setCaret(caret + p.getMCharsBeforeCount(caret, true));

            } else {
                p.events();
                p.val(p.getMasked());
            }
        };

        jMask.init(!el.is('input'));
    };

    $.maskWatchers = {};
    var HTMLAttributes = function () {
            var input = $(this),
                options = {},
                prefix = 'data-mask-',
                mask = input.attr('data-mask');

            if (input.attr(prefix + 'reverse')) {
                options.reverse = true;
            }

            if (input.attr(prefix + 'clearifnotmatch')) {
                options.clearIfNotMatch = true;
            }

            if (input.attr(prefix + 'selectonfocus') === 'true') {
               options.selectOnFocus = true;
            }

            if (notSameMaskObject(input, mask, options)) {
                return input.data('maskme', new Mask(this, mask, options));
            }
        },
        notSameMaskObject = function(field, mask, options) {
            options = options || {};
            var maskObject = $(field).data('maskme'),
                stringify = JSON.stringify,
                value = $(field).val() || $(field).text();
            try {
                if (typeof mask === 'function') {
                    mask = mask(value);
                }
                return typeof maskObject !== 'object' || stringify(maskObject.options) !== stringify(options) || maskObject.mask !== mask;
            } catch (e) {}
        };


    $.fn.maskme = function(mask, options) {
        options = options || {};
        var selector = this.selector,
            globals = $.jMaskGlobals,
            interval = $.jMaskGlobals.watchInterval,
            maskFunction = function() {
                if (notSameMaskObject(this, mask, options)) {
                    return $(this).data('maskme', new Mask(this, mask, options));
                }
            };

        $(this).each(maskFunction);

        if (selector && selector !== '' && globals.watchInputs) {
            clearInterval($.maskWatchers[selector]);
            $.maskWatchers[selector] = setInterval(function(){
                $(document).find(selector).each(maskFunction);
            }, interval);
        }
        return this;
    };

    $.fn.unmaskme = function() {
        clearInterval($.maskWatchers[this.selector]);
        delete $.maskWatchers[this.selector];
        return this.each(function() {
            var dataMask = $(this).data('maskme');
            if (dataMask) {
                dataMask.remove().removeData('maskme');
            }
        });
    };

    $.fn.cleanVal = function() {
        return this.data('maskme').getCleanVal();
    };

    $.applyDataMask = function(selector) {
        selector = selector || $.jMaskGlobals.maskElements;
        var $selector = (selector instanceof $) ? selector : $(selector);
        $selector.filter($.jMaskGlobals.dataMaskAttr).each(HTMLAttributes);
    };

    var globals = {
        maskElements: 'input,td,span,div',
        dataMaskAttr: '*[data-mask]',
        dataMask: true,
        watchInterval: 300,
        watchInputs: true,
        watchDataMask: false,
        byPassKeys: [9, 16, 17, 18, 36, 37, 38, 39, 40, 91],
        translation: {
            '0': {pattern: /\d/},
            '9': {pattern: /\d/, optional: true},
            '#': {pattern: /\d/, recursive: true},
            'A': {pattern: /[a-zA-Z0-9]/},
            'S': {pattern: /[a-zA-Z]/}
        }
    };

    $.jMaskGlobals = $.jMaskGlobals || {};
    globals = $.jMaskGlobals = $.extend(true, {}, globals, $.jMaskGlobals);

    // looking for inputs with data-mask attribute
    if (globals.dataMask) { $.applyDataMask(); }

    setInterval(function(){
        if ($.jMaskGlobals.watchDataMask) { $.applyDataMask(); }
    }, globals.watchInterval);
}));

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/jquery-te-1.4.0.min.js' */
/*!
 *
 * jQuery TE 1.4.0 , http://jqueryte.com/
 * Copyright (C) 2013, Fatih Koca (fattih@fattih.com), (http://jqueryte.com/about)

 * jQuery TE is provided under the MIT LICENSE.
 *
*/

(function($){		
	$.fn.jqte = function(options){
  
		// default titles of buttons
		var varsTitle = [
			{title:"Text Format"},
			{title:"Font Size"},
			{title:"Color"},
			{title:"Bold",hotkey:"B"},
			{title:"Italic",hotkey:"I"},
			{title:"Underline",hotkey:"U"},
			{title:"Ordered List",hotkey:"."},
			{title:"Unordered List",hotkey:","},
			{title:"Subscript",hotkey:"down arrow"},
			{title:"Superscript",hotkey:"up arrow"},
			{title:"Outdent",hotkey:"left arrow"},
			{title:"Indent",hotkey:"right arrow"},
			{title:"Justify Left"},
			{title:"Justify Center"},
			{title:"Justify Right"},
			{title:"Strike Through",hotkey:"K"},
			{title:"Add Link",hotkey:"L"},
			{title:"Remove Link"},
			{title:"Cleaner Style",hotkey:"Delete"},
			{title:"Horizontal Rule",hotkey:"H"},
			{title:"Source"}
			];
		
		// default text formats
		var formats = [["p","Normal"],["h1","Header 1"],["h2","Header 2"],["h3","Header 3"],["h4","Header 4"],["h5","Header 5"],["h6","Header 6"],["pre","Preformatted"]];
		
		// default font sizes
		var fsizes = ["10","12","16","18","20","24","28"];
		
		// default rgb values of colors
		var colors = [
		"0,0,0","68,68,68","102,102,102","153,153,153","204,204,204","238,238,238","243,243,243","255,255,255",
		null,
		"255,0,0","255,153,0","255,255,0","0,255,0","0,255,255","0,0,255","153,0,255","255,0,255",
		null,
		"244,204,204","252,229,205","255,242,204","217,234,211","208,224,227","207,226,243","217,210,233","234,209,220",
		"234,153,153","249,203,156","255,229,153","182,215,168","162,196,201","159,197,232","180,167,214","213,166,189",
		"224,102,102","246,178,107","255,217,102","147,196,125","118,165,175","111,168,220","142,124,195","194,123,160",
		"204,0,0","230,145,56","241,194,50","106,168,79","69,129,142","61,133,198","103,78,167","166,77,121",
		"153,0,0","180,95,6","191,144,0","56,118,29","19,79,92","11,83,148","53,28,117","116,27,71",
		"102,0,0","120,63,4","127,96,0","39,78,19","12,52,61","7,55,99","32,18,77","76,17,48"
		];
		
		// default link-type names
		var linktypes = ["Web Address","E-mail Address","Picture URL"];
		
		var vars = $.extend({
			// options
			'status'		: true,
			'css' 			: "jqte",
			'title'			: true,
			'titletext'		: varsTitle,
			'button'		: "OK",
			'format'		: true,
			'formats'		: formats,
			'fsize' 		: true,
			'fsizes'		: fsizes,
			'funit'			: "px",
			'color'			: true,
			'linktypes'		: linktypes,
			'b' 			: true,
			'i' 			: true,
			'u' 			: true,
			'ol' 			: true,
			'ul' 			: true,
			'sub'			: true,
			'sup'			: true,
			'outdent'		: true,
			'indent'		: true,
			'left'			: true,
			'center'		: true,
			'right'			: true,
			'strike'		: true,
			'link'			: true,
			'unlink'		: true,
			'remove'		: true,
			'rule'			: true,
			'source'		: true,
			'placeholder'	: false,
			'br'			: false,
			'p'				: true,
			
			// events
			'change'		: "",
			'focus'			: "",
			'blur'			: ""
		}, options);
		
		// methods
		$.fn.jqteVal = function(value){
			$(this).closest("."+vars.css).find("."+vars.css+"_editor").html(value);
		}
		
		// browser information is received
		var thisBrowser = navigator.userAgent.toLowerCase();
		
		// if browser is ie and it version is 7 or even older, close title property
		if(/msie [1-7]./.test(thisBrowser))
			vars.title = false;
		
		var buttons = [];
		
		// insertion function for parameters to toolbar
		function addParams(name,command,key,tag,emphasis)
		{
			var thisCssNo  = buttons.length+1;
			return buttons.push({name:name, cls:thisCssNo, command:command, key:key, tag:tag, emphasis:emphasis});
		};
		
		// add parameters for toolbar buttons
		addParams('format','formats','','',false); // text format button  --> no hotkey
		addParams('fsize','fSize','','',false); // font size button --> no hotkey
		addParams('color','colors','','',false); // text color button  --> no hotkey
		addParams('b','Bold','B',["b","strong"],true); // bold --> ctrl + b
		addParams('i','Italic','I',["i","em"],true); // italic --> ctrl + i
		addParams('u','Underline','U',["u"],true); // underline --> ctrl + u
		addParams('ol','insertorderedlist','',["ol"],true); // ordered list --> ctrl + .(dot)
		addParams('ul','insertunorderedlist','',["ul"],true); // unordered list --> ctrl + ,(comma)
		addParams('sub','subscript','(',["sub"],true); // sub script --> ctrl + down arrow
		addParams('sup','superscript','&',["sup"],true); // super script --> ctrl + up arrow
		addParams('outdent','outdent','%',["blockquote"],false); // outdent --> ctrl + left arrow
		addParams('indent','indent','\'',["blockquote"],true); // indent --> ctrl + right arrow
		addParams('left','justifyLeft','','',false); // justify Left --> no hotkey
		addParams('center','justifyCenter','','',false); // justify center --> no hotkey
		addParams('right','justifyRight','','',false); // justify right --> no hotkey
		addParams('strike','strikeThrough','K',["strike"],true); // strike through --> ctrl + K
		addParams('link','linkcreator','L',["a"],true); // insertion link  --> ctrl + L
		addParams('unlink','unlink','',["a"],false); // remove link --> ctrl + N 
		addParams('remove','removeformat','.','',false); // remove all styles --> ctrl + delete
		addParams('rule','inserthorizontalrule','H',["hr"],false); // insertion horizontal rule --> ctrl + H
		addParams('source','displaysource','','',false); // feature of displaying source

		return this.each(function(){
			if(!$(this).data("jqte") || $(this).data("jqte")==null || $(this).data("jqte")=="undefined")
				$(this).data("jqte",true);
			else 
				$(this).data("jqte",false);
			
			// is the status false of the editor
			if(!vars.status || !$(this).data("jqte"))
			{
				// if wanting the false status later
				if($(this).closest("."+vars.css).length>0)
				{
					var editorValue	= $(this).closest("."+vars.css).find("."+vars.css+"_editor").html();
					
					// add all attributes of element
					var thisElementAttrs = "";
					
					$($(this)[0].attributes).each(function()
					{
						if(this.nodeName!="style")
							thisElementAttrs = thisElementAttrs+" "+this.nodeName+'="'+this.nodeValue+'"';
					});
					
					var thisElementTag = $(this).is("[data-origin]") && $(this).attr("data-origin")!="" ? $(this).attr("data-origin") : "textarea";
					
					// the contents of this element
					var createValue	= '>'+editorValue;
					
					// if this element is input or option
					if(thisElementTag=="input" || thisElementTag=="option")
					{
						// encode special html characters
						editorValue = editorValue.replace(/"/g,'&#34;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
						
						// the value of this element
						createValue	= 'value="'+editorValue+'">';
					}
					
					var thisClone = $(this).clone();
					
					$(this).data("jqte",false).closest("."+vars.css).before(thisClone).remove();
					thisClone.replaceWith('<'+ thisElementTag + thisElementAttrs + createValue + '</'+thisElementTag+'>');
				}
				return;
			}
			
			// element will converted to the jqte editor
			var thisElement = $(this);
			
			// tag name of the element
			var thisElementTag = $(this).prop('tagName').toLowerCase();
			
			// tag name of origin
			$(this).attr("data-origin",thisElementTag);
			
			// contents of the element
			var thisElementVal = $(this).is("[value]") || thisElementTag == "textarea" ? $(this).val() : $(this).html();
			
			// decode special html characters
			thisElementVal = thisElementVal.replace(/&#34;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&amp;/g,'&');
			
			// start jqte editor to after the element
			$(this).after('<div class="'+vars.css+'"></div>');
			
			// jqte
			var jQTE = $(this).next('.'+vars.css);
			
			// insert toolbar in jqte editor
			jQTE.html('<div class="'+vars.css+"_toolbar"+'" role="toolbar" unselectable></div><div class="'+vars.css+'_linkform" style="display:none" role="dialog"></div><div class="'+vars.css+"_editor"+'"></div>');
			
			var toolbar			= jQTE.find('.'+vars.css+"_toolbar"); // the toolbar variable
			var linkform		= jQTE.find('.'+vars.css+"_linkform"); // the link-form-area in the toolbar variable
			var editor			= jQTE.find('.'+vars.css+"_editor"); // the text-field of jqte editor
			var emphasize		= vars.css+"_tool_depressed"; // highlight style of the toolbar buttons
			
			// add to some tools in link form area
			linkform.append('<div class="'+vars.css+'_linktypeselect" unselectable></div><input class="'+vars.css+'_linkinput" type="text/css" value=""><div class="'+vars.css+'_linkbutton" unselectable>'+vars.button+'</div> <div style="height:1px;float:none;clear:both"></div>');
			
			var linktypeselect	= linkform.find("."+vars.css+"_linktypeselect"); // the tool of link-type-selector
			var linkinput		= linkform.find("."+vars.css+"_linkinput"); // the input of insertion link
			var linkbutton		= linkform.find("."+vars.css+"_linkbutton"); // the button of insertion link
			
			// add to the link-type-selector sub tool parts
			linktypeselect.append('<div class="'+vars.css+'_linktypeview" unselectable></div><div class="'+vars.css+'_linktypes" role="menu" unselectable></div>');

			var linktypes		= linktypeselect.find("."+vars.css+"_linktypes"); // the select box of link types
			var linktypeview	= linktypeselect.find("."+vars.css+"_linktypeview"); // the link type preview
			var setdatalink		= vars.css+"-setlink"; // the selected text add to mark as "link will be added"
			
			// create to the source-area
			editor.after('<div class="'+vars.css+'_source '+vars.css+'_hiddenField"></div>');
			
			var sourceField = jQTE.find("."+vars.css+"_source"); // the source-area variable
			
			// move the element to the source-area
			thisElement.appendTo(sourceField);
			
			// if the element isn't a textarea, convert this to textarea
			if(thisElementTag!="textarea")
			{
				// add all attributes of element to new textarea (type and value except)
				var thisElementAttrs = "";
				
				$(thisElement[0].attributes).each(function(){
					if(this.nodeName!="type" && this.nodeName!="value")
						thisElementAttrs = thisElementAttrs+" "+this.nodeName+'="'+this.nodeValue+'"';
				});
				
				// convert the element to textarea
				thisElement.replaceWith('<textarea '+thisElementAttrs+'>'+thisElementVal+'</textarea>');
				
				// update to variable of thisElement
				thisElement = sourceField.find("textarea");
			}

			// add feature editable to the text-field ve copy from the element's value to text-field
			editor.attr("contenteditable","true").html(thisElementVal);

			// insertion the toolbar button
			for(var n = 0; n < buttons.length; n++)
			{
				// if setting of this button is activated (is it true?)
				if(vars[buttons[n].name])
				{
					// if it have a title, add to this button
					var buttonHotkey = buttons[n].key.length>0 ? vars.titletext[n].hotkey!=null && vars.titletext[n].hotkey!="undefined" && vars.titletext[n].hotkey!="" ? ' (Ctrl+'+vars.titletext[n].hotkey+')' : '' : '';
					var buttonTitle = vars.titletext[n].title!=null && vars.titletext[n].title!="undefined" && vars.titletext[n].title!="" ? vars.titletext[n].title+buttonHotkey : '';
					
					// add this button to the toolbar
					toolbar.append('<div class="'+vars.css+'_tool '+vars.css+'_tool_'+buttons[n].cls+'" role="button" data-tool="'+n+'" unselectable><a class="'+vars.css+'_tool_icon" unselectable></a></div>');
					
					// add the parameters to this button
					toolbar.find('.'+vars.css+'_tool[data-tool='+n+']').data({tag : buttons[n].tag, command : buttons[n].command, emphasis : buttons[n].emphasis, title : buttonTitle});
					
					// format-selector field
					if(buttons[n].name=="format" && $.isArray(vars.formats))
					{
						// selected text format
						var toolLabel = vars.formats[0][1].length>0 && vars.formats[0][1]!="undefined" ? vars.formats[0][1] : "";
						
						toolbar.find("."+vars.css+'_tool_'+buttons[n].cls).find("."+vars.css+"_tool_icon").replaceWith('<a class="'+vars.css+'_tool_label" unselectable><span class="'+vars.css+'_tool_text" unselectable>'+toolLabel+'</span><span class="'+vars.css+'_tool_icon" unselectable></span></a>');
						
						toolbar.find("."+vars.css+'_tool_'+buttons[n].cls)
							.append('<div class="'+vars.css+'_formats" unselectable></div>');
						
						// add font-sizes to font-size-selector
						for(var f = 0; f < vars.formats.length; f++)
						{
							toolbar.find("."+vars.css+"_formats").append('<a '+vars.css+'-formatval="'+ vars.formats[f][0] +'" class="'+vars.css+'_format'+' '+vars.css+'_format_'+f+'" role="menuitem" unselectable>'+ vars.formats[f][1] +'</a>');
						}
						
						toolbar.find("."+vars.css+"_formats").data("status",false);
					}
					
					// font-size-selector field
					else if(buttons[n].name=="fsize" && $.isArray(vars.fsizes))
					{
						toolbar.find("."+vars.css+'_tool_'+buttons[n].cls)
							.append('<div class="'+vars.css+'_fontsizes" unselectable></div>');
						
						// add font-sizes to font-size-selector
						for(var f = 0; f < vars.fsizes.length; f++)
						{
							toolbar.find("."+vars.css+"_fontsizes").append('<a '+vars.css+'-styleval="'+ vars.fsizes[f] +'" class="'+vars.css+'_fontsize'+'" style="font-size:'+ vars.fsizes[f]  + vars.funit+'" role="menuitem" unselectable>Abcdefgh...</a>');
						}
					}
					
					// color-selector field
					else if(buttons[n].name=="color" && $.isArray(colors))
					{
						toolbar.find("."+vars.css+'_tool_'+buttons[n].cls)
							.append('<div class="'+vars.css+'_cpalette" unselectable></div>');
						
						// create color palette to color-selector field
						for(var c = 0; c < colors.length; c++)
						{
							if(colors[c]!=null)
								toolbar.find("."+vars.css+"_cpalette").append('<a '+vars.css+'-styleval="'+ colors[c] +'" class="'+vars.css+'_color'+'" style="background-color: rgb('+ colors[c] +')" role="gridcell" unselectable></a>');
							else
								toolbar.find("."+vars.css+"_cpalette").append('<div class="'+vars.css+"_colorSeperator"+'"></div>');
						}
					}
				}
			}
			
			// the default value of the link-type
			linktypes.data("linktype","0");
			
			// add link types to link-type-selector
			for(var n = 0; n < 3; n++)
			{
				linktypes.append('<a '+vars.css+'-linktype="'+n+'" unselectable>'+vars.linktypes[n]+'</a>');
				
				linktypeview.html('<div class="'+vars.css+'_linktypearrow" unselectable></div><div class="'+vars.css+'_linktypetext">'+linktypes.find('a:eq('+linktypes.data("linktype")+')').text()+'</div>');
			}
			
			// add the prefix of css according to browser
			var prefixCss = "";

			if(/msie/.test(thisBrowser)) // ie
				prefixCss = '-ms-';
			else if(/chrome/.test(thisBrowser) || /safari/.test(thisBrowser) || /yandex/.test(thisBrowser)) // webkit group (safari, chrome, yandex)
				prefixCss = '-webkit-';
			else if(/mozilla/.test(thisBrowser)) // firefox
				prefixCss = '-moz-';
			else if(/opera/.test(thisBrowser)) // opera
				prefixCss = '-o-';
			else if(/konqueror/.test(thisBrowser)) // konqueror
				prefixCss = '-khtml-';
			else 
				prefixCss = '';
				
			// the feature of placeholder
			if(vars.placeholder && vars.placeholder!="")
			{
				jQTE.prepend('<div class="'+vars.css+'_placeholder" unselectable><div class="'+vars.css+'_placeholder_text">'+vars.placeholder+'</div></div>');
				
				var placeHolder = jQTE.find("."+vars.css+"_placeholder");
				
				placeHolder.click(function(){
					editor.focus();
				});
			}
			
			// make unselectable to unselectable attribute ones
			jQTE.find("[unselectable]")
				.css(prefixCss+"user-select","none")
				.addClass("unselectable")
				.attr("unselectable","on")
				.on("selectstart mousedown",false);
			
			// each button of the toolbar
			var toolbutton = toolbar.find("."+vars.css+"_tool");
			
			// format menu
			var formatbar = toolbar.find("."+vars.css+"_formats");
			
			// font-size filed
			var fsizebar = toolbar.find("."+vars.css+"_fontsizes");
			
			// color palette
			var cpalette = toolbar.find("."+vars.css+"_cpalette");
			
			// get the selected text as plain format
			function selectionGet()
			{
				// for webkit, mozilla, opera
				if (window.getSelection)
					return window.getSelection();
				// for ie
				else if (document.selection && document.selection.createRange && document.selection.type != "None")
					return document.selection.createRange();
			}
			
			// the function of changing to the selected text with "execCommand" method
			function selectionSet(addCommand,thirdParam)
			{
				var	range,
					sel = selectionGet();

				// for webkit, mozilla, opera
				if (window.getSelection)
				{
					if (sel.anchorNode && sel.getRangeAt)
						range = sel.getRangeAt(0);
						
					if(range)
					{
						sel.removeAllRanges();
						sel.addRange(range);
					}
					
					if(!thisBrowser.match(/msie/))
						document.execCommand('StyleWithCSS', false, false);
					
					document.execCommand(addCommand, false, thirdParam);
				}
				
				// for ie
				else if (document.selection && document.selection.createRange && document.selection.type != "None")
				{
					range = document.selection.createRange();
					range.execCommand(addCommand, false, thirdParam);
				}
				
				// change styles to around tags
				affectStyleAround(false,false);
			}
			
			// the function of changing to the selected text with tags and tags's attributes
			function replaceSelection(tTag,tAttr,tVal) {
				
				// first, prevent to conflict of different jqte editors
				if(editor.not(":focus"))
					editor.focus();
				
				// for webkit, mozilla, opera			
				if (window.getSelection)
				{
					var selObj = selectionGet(), selRange, newElement, documentFragment;
					
					if (selObj.anchorNode && selObj.getRangeAt)
					{
						selRange = selObj.getRangeAt(0);
						
						// create to new element
						newElement = document.createElement(tTag);
						
						// add the attribute to the new element
						$(newElement).attr(tAttr,tVal);
						
						// extract to the selected text
						documentFragment = selRange.extractContents();
						
						// add the contents to the new element
						newElement.appendChild(documentFragment);
						
						selRange.insertNode(newElement);
						selObj.removeAllRanges();
						
						// if the attribute is "style", change styles to around tags
						if(tAttr=="style")
							affectStyleAround($(newElement),tVal);
						// for other attributes
						else
							affectStyleAround($(newElement),false);
					}
				}
				// for ie
				else if (document.selection && document.selection.createRange && document.selection.type != "None")
				{
					var range = document.selection.createRange();
					var selectedText = range.htmlText;
					
					var newText = '<'+tTag+' '+tAttr+'="'+tVal+'">'+selectedText+'</'+tTag+'>';
					
					document.selection.createRange().pasteHTML(newText);
				}
			}
			
			// the function of getting to the parent tag
			var getSelectedNode = function() {
				var node,selection;
				if(window.getSelection) {
					selection = getSelection();
					node = selection.anchorNode;
				}
				if(!node && document.selection && document.selection.createRange && document.selection.type != "None")
				{
					selection = document.selection;
					var range = selection.getRangeAt ? selection.getRangeAt(0) : selection.createRange();
					node = range.commonAncestorContainer ? range.commonAncestorContainer :
						   range.parentElement ? range.parentElement() : range.item(0);
				}
				if(node) {
					return (node.nodeName == "#text" ? $(node.parentNode) : $(node));
				}
				else 
					return false;
			};
			
			// the function of replacement styles to the around tags (parent and child)
			function affectStyleAround(element,style)
			{
				var selectedTag = getSelectedNode(); // the selected node
				
				selectedTag = selectedTag ? selectedTag : element;
				
				// (for replacement with execCommand) affect to child tags with parent tag's styles
				if(selectedTag && style==false)
				{
					// apply to the selected node with parent tag's styles
					if(selectedTag.parent().is("[style]"))
						selectedTag.attr("style",selectedTag.parent().attr("style"));
						
					// apply to child tags with parent tag's styles
					if(selectedTag.is("[style]"))
						selectedTag.find("*").attr("style",selectedTag.attr("style"));
				}
				// (for replacement with html changing method)
				else if(element && style && element.is("[style]"))
				{
					var styleKey = style.split(";"); // split the styles
					
					styleKey = styleKey[0].split(":") // get the key of first style feature
					
					// apply to child tags with parent tag's styles
					if(element.is("[style*="+styleKey[0]+"]"))
						element.find("*").css(styleKey[0],styleKey[1]);
						
					// select to the selected node again
					selectText(element);
				}
			}

			// the function of making selected to a element
			function selectText(element)
			{
				if(element)
				{
					var element = element[0];
					
					if (document.body.createTextRange)
					{
						var range = document.body.createTextRange();
						range.moveToElementText(element);
						range.select();
					}
					else if (window.getSelection)
					{
						var selection = window.getSelection();  
						var range = document.createRange();
						
						if(element != "undefined" && element != null)
						{
							range.selectNodeContents(element);
							
							selection.removeAllRanges();
							selection.addRange(range);
							
							if($(element).is(":empty"))
							{
								$(element).append("&nbsp;");
									selectText($(element));
							}
						}
					}
				}
			}

			// the function of converting text to link
			function selected2link()
			{
				if(!toolbar.data("sourceOpened"))
				{
					var selectedTag = getSelectedNode(); // the selected node
					var thisHrefLink = "http://"; // default the input value of the link-form-field

					// display the link-form-field
					linkAreaSwitch(true);

					if(selectedTag)
					{
						
						var thisTagName  = selectedTag.prop('tagName').toLowerCase();
						
						// if tag name of the selected node is "a" and the selected node have "href" attribute
						if(thisTagName == "a" && selectedTag.is('[href]'))
						{
							thisHrefLink = selectedTag.attr('href');
							
							selectedTag.attr(setdatalink,"");
						}
						// if it don't have "a" tag name
						else 
							replaceSelection("a",setdatalink,"");
						
					}
					else 
						linkinput.val(thisHrefLink).focus();
					
					// the method of displaying-hiding to link-types
					linktypeselect.click(function(e)
					{
						if($(e.target).hasClass(vars.css+"_linktypetext") || $(e.target).hasClass(vars.css+"_linktypearrow"))
							linktypeSwitch(true);
					});
					
					// the method of selecting to link-types
					linktypes.find("a").click(function()
					{
						var thisLinkType = $(this).attr(vars.css+"-linktype");
						
						linktypes.data("linktype",thisLinkType)
						
						linktypeview.find("."+vars.css+"_linktypetext").html(linktypes.find('a:eq('+linktypes.data("linktype")+')').text());
						
						linkInputSet(thisHrefLink);
						
						linktypeSwitch();
					});
					
					linkInputSet(thisHrefLink);
					
					// the method of link-input
					linkinput
						// auto focus
						.focus()
						// update to value
						.val(thisHrefLink)
						// the event of key to enter in link-input
						.bind("keypress keyup",function(e)
						{
							if(e.keyCode==13)
							{
								linkRecord(jQTE.find("["+setdatalink+"]"));
								return false;
							}
						});
					
					// the event of click link-button
					linkbutton.click(function()
					{
						linkRecord(jQTE.find("["+setdatalink+"]"));
					});
				}
				else
					// hide the link-form-field
					linkAreaSwitch(false);
			}

			function linkRecord(thisSelection)
			{
				// focus to link-input
				linkinput.focus();
				
				// select to the selected node
				selectText(thisSelection);
				
				// remove pre-link attribute (mark as "link will be added") of the selected node
				thisSelection.removeAttr(setdatalink);
				
				// if not selected to link-type of picture
				if(linktypes.data("linktype")!="2")
					selectionSet("createlink",linkinput.val()); // insert link url of link-input to the selected node
				// if selected to link-type of picture
				else
				{
					selectionSet("insertImage",linkinput.val()); // insert image url of link-input to the selected node

					// the method of all pictures in the editor
					editor.find("img").each(function(){
						var emptyPrevLinks = $(this).prev("a");
						var emptyNextLinks = $(this).next("a");
						
						// if "a" tags of the front and rear of the picture is empty, remove
						if(emptyPrevLinks.length>0 && emptyPrevLinks.html()=="")
							emptyPrevLinks.remove();
						else if(emptyNextLinks.length>0 && emptyNextLinks.html()=="")
							emptyNextLinks.remove();
					});
				}

				// hide the link-form-field
				linkAreaSwitch();
				
				// export contents of the text to the sources
				editor.trigger("change");
			}

			// the function of switching link-form-field
			function linkAreaSwitch(status)
			{
				// remove all pre-link attribute (mark as "link will be added")
				clearSetElement("["+setdatalink+"]:not([href])");
				jQTE.find("["+setdatalink+"][href]").removeAttr(setdatalink);
				
				if(status)
				{
					toolbar.data("linkOpened",true);
					linkform.show();
				}
				else
				{ 
					toolbar.data("linkOpened",false);
					linkform.hide();
				}
				
				linktypeSwitch();
			}
			
			// the function of switching link-type-selector
			function linktypeSwitch(status)
			{
				if(status)
					linktypes.show();
				else
					linktypes.hide();
			}
			
			// the function of updating the link-input according to the link-type
			function linkInputSet(thisHrefLink)
			{
				var currentType = linktypes.data("linktype");
				
				// if selected type of e-mail
				if(currentType=="1" && (linkinput.val()=="http://" || linkinput.is("[value^=http://]") || !linkinput.is("[value^=mailto]"))) 
					linkinput.val("mailto:");
				else if(currentType!="1" && !linkinput.is("[value^=http://]"))
						linkinput.val("http://");
				else
					linkinput.val(thisHrefLink);
			}
			
			// the function of adding style to selected text
			function selected2style(styleCommand)
			{
				if(!toolbar.data("sourceOpened"))
				{
					
					// if selected to changing the font-size value
					if(styleCommand=="fSize")
						styleField = fsizebar;
					
					// if selected to changing the text-color value
					else if(styleCommand=="colors")
						styleField = cpalette;
					
					// display the style-field
					styleFieldSwitch(styleField,true);
					
					// the event of click to style button
					styleField.find("a").unbind("click").click(function()
					{
						var styleValue = $(this).attr(vars.css + "-styleval"); // the property of style value to be added
						
						// if selected to changing the font-size value
						if(styleCommand=="fSize")
						{
							styleType  = "font-size";
							styleValue = styleValue + vars.funit; // combine the value with size unit
						}
						// if selected to changing the text-color value
						else if(styleCommand=="colors")
						{
							styleType  = "color";
							styleValue = "rgb("+styleValue + ")"; // combine color value with rgb
						}
						
						var prevStyles = refuseStyle(styleType); // affect styles to child tags (and extract to the new style attributes)
						
						// change to selected text
						replaceSelection("span","style",styleType+":"+styleValue+";"+prevStyles);
						
						// hide all style-fields
						styleFieldSwitch("",false);
						
						// remove title bubbles
						$('.'+vars.css+'_title').remove();
						
						// export contents of the text to the sources
						editor.trigger("change");
					});
					
				}
				else
					// hide the style-field
					styleFieldSwitch(styleField,false);
					
				// hide the link-form-field
				linkAreaSwitch(false);
			}
			
			// the function of switching the style-field
			function styleFieldSwitch(styleField,status)
			{
				var mainData="", // the style data of the actual wanted
					allData = [{"d":"fsizeOpened","f":fsizebar},{"d":"cpallOpened","f":cpalette}]; // all style datas
				
				// if the style data of the actual wanted isn't empty
				if(styleField!="")
				{
					// return to all datas and find the main data
					for(var si=0; si < allData.length; si++)
					{
						if(styleField==allData[si]["f"])
							mainData = allData[si];
					}
				}
				// display the style-field
				if(status)
				{
					toolbar.data(mainData["d"],true); // stil seme alannn aldn belirten parametre yaz 
					mainData["f"].slideDown(100); // stil seme alann a
					
					// return to all datas and close the fields of external datas
					for(var si=0; si < allData.length; si++)
					{
						if(mainData["d"]!=allData[si]["d"])
						{
							toolbar.data(allData[si]["d"],false);
							allData[si]["f"].slideUp(100);
						}
					}
				}
				// hide all style-fields
				else
				{
					// return to all datas and close all style fields
					for(var si=0; si < allData.length; si++)
					{
						toolbar.data(allData[si]["d"],false);
						allData[si]["f"].slideUp(100);
					}
				}
			}
			
			// the function of removing all pre-link attribute (mark as "link will be added")
			function clearSetElement(elem)
			{
				jQTE.find(elem).each(function(){
					$(this).before($(this).html()).remove();
				});
			}
			
			// the function of refusing some styles
			function refuseStyle(refStyle)
			{
				var selectedTag = getSelectedNode(); // the selected node
				
				// if the selected node have attribute of "style" and it have unwanted style
				if(selectedTag && selectedTag.is("[style]") && selectedTag.css(refStyle)!="")
				{
					var refValue = selectedTag.css(refStyle); // first get key of unwanted style
					
					selectedTag.css(refStyle,""); // clear unwanted style
					
					var cleanStyle = selectedTag.attr("style"); // cleaned style
					
					selectedTag.css(refStyle,refValue); // add unwanted style to the selected node again
					
					return cleanStyle; // print cleaned style
				}
				else
					return "";
			}
			
			// the function of adding style to selected text
			function selected2format()
			{
				formatFieldSwitch(true);
				
				formatbar.find("a").click(function()
				{
					$("*",this).click(function(e)
					{
						e.preventDefault();
						return false;
					});
					
					formatLabelView($(this).text());
					
					var formatValue = $(this).attr(vars.css + "-formatval"); // the type of format value
					
					// convert to selected format
					selectionSet("formatBlock",'<'+formatValue+'>');
					
					formatFieldSwitch(false);
				});
			}
			
			// the function of switching the style-field
			function formatFieldSwitch(status)
			{				
				var thisStatus = status ? true : false;
				
				thisStatus = status && formatbar.data("status") ? true : false;
				
				if(thisStatus || !status)
					formatbar.data("status",false).slideUp(200);
				else
					formatbar.data("status",true).slideDown(200);
			}
			
			// change format label
			function formatLabelView(str)
			{
				var formatLabel = formatbar.closest("."+vars.css+"_tool").find("."+vars.css+"_tool_label").find("."+vars.css+"_tool_text");
				
				if(str.length > 10)
						str = str.substr(0,7) + "...";
				
				// change format label of button
				formatLabel.html(str);
			}

			// the function of insertion a specific form to texts
			function extractToText(strings)
			{
				var $htmlContent, $htmlPattern, $htmlReplace;

				// first remove to unnecessary gaps
				$htmlContent = strings.replace(/\n/gim,'').replace(/\r/gim,'').replace(/\t/gim,'').replace(/&nbsp;/gim,' ');

				$htmlPattern =  [
					/\<span(|\s+.*?)><span(|\s+.*?)>(.*?)<\/span><\/span>/gim, // trim nested spans
					/<(\w*[^p])\s*[^\/>]*>\s*<\/\1>/gim, // remove empty or white-spaces tags (ignore paragraphs (<p>) and breaks (<br>))
					/\<div(|\s+.*?)>(.*?)\<\/div>/gim, // convert div to p
					/\<strong(|\s+.*?)>(.*?)\<\/strong>/gim, // convert strong to b
					/\<em(|\s+.*?)>(.*?)\<\/em>/gim // convert em to i
				];

				$htmlReplace = [
					'<span$2>$3</span>',
					'',
					'<p$1>$2</p>',
					'<b$1>$2</b>',
					'<i$1>$2</i>'
				];
				
				// repeat the cleaning process 5 times
				for(c=0; c<5; c++)
				{
					// create loop as the number of pattern
					for(var i = 0; i < $htmlPattern.length; i++)
					{
						$htmlContent = $htmlContent.replace($htmlPattern[i], $htmlReplace[i]);
					}
				}

				// if paragraph is false (<p>), convert <p> to <br>
				if(!vars.p)
					$htmlContent = $htmlContent.replace(/\<p(|\s+.*?)>(.*?)\<\/p>/ig, '<br/>$2');

				// if break is false (<br>), convert <br> to <p>
				if(!vars.br)
				{
					$htmlPattern =  [
						/\<br>(.*?)/ig,
						/\<br\/>(.*?)/ig
					];

					$htmlReplace = [
						'<p>$1</p>',
						'<p>$1</p>'
					];

					// create loop as the number of pattern (for breaks)
					for (var i = 0; i < $htmlPattern.length; i++) {
						$htmlContent = $htmlContent.replace($htmlPattern[i], $htmlReplace[i]);
					}
				}

				// if paragraph and break is false (<p> && <br>), convert <p> to <div>
				if(!vars.p && !vars.br)
					$htmlContent = $htmlContent.replace(/\<p>(.*?)\<\/p>/ig, '<div>$1</div>');

				return $htmlContent;
			}

			// the function of exporting contents of the text field to the source field (to be the standard in all browsers)
			function postToSource()
			{
				// clear unnecessary tags when editor view empty
				var sourceStrings = editor.text()=="" && editor.html().length<12 ? "" : editor.html();
				
				thisElement.val(extractToText(sourceStrings));
			}

			// the function of exporting contents of the source field to the text field (to be the standard in all browsers)
			function postToEditor()
			{
				editor.html(extractToText(thisElement.val()));
			}

			// the function of getting parent (or super parent) tag name of the selected node
			function detectElement(tags){
			
				var resultdetect=false, $node = getSelectedNode(), parentsTag;
				
				if($node)
				{
					$.each(tags, function(i, val){
						parentsTag = $node.prop('tagName').toLowerCase();

						if (parentsTag == val)
							resultdetect = true;
						else
						{
							$node.parents().each(function(){
								parentsTag = $(this).prop('tagName').toLowerCase();
								if (parentsTag == val)
									resultdetect = true;
							});
						}
					});
					
					return resultdetect;
				}
				else 
					return false;
			};

			// the function of highlighting the toolbar buttons according to the cursor position in jqte editor
			function buttonEmphasize(e)
			{
				for(var n = 0; n < buttons.length; n++)
				{				
					if(vars[buttons[n].name] && buttons[n].emphasis && buttons[n].tag!='')
						detectElement(buttons[n].tag) ? toolbar.find('.'+vars.css+'_tool_'+buttons[n].cls).addClass(emphasize) : $('.'+vars.css+'_tool_'+buttons[n].cls).removeClass(emphasize);
				}
				// showing text format
				if(vars.format && $.isArray(vars.formats))
				{
					var isFoundFormat = false;
					
					for(var f = 0; f < vars.formats.length; f++)
					{
						var thisFormat = [];
						thisFormat[0] = vars.formats[f][0];
						
						if(vars.formats[f][0].length>0 && detectElement(thisFormat))
						{
							formatLabelView(vars.formats[f][1]);
							
							isFoundFormat = true;
							break;
						}
					}
					
					if(!isFoundFormat)
						formatLabelView(vars.formats[0][1]);
				}
				
				// hide all style-fields
				styleFieldSwitch("",false);
				formatFieldSwitch(false);
			}

			// the event of click to the toolbar buttons
			toolbutton
				.unbind("click")
				.click(function(e){	
					// if source button is clicked
					if($(this).data('command')=='displaysource' && !toolbar.data("sourceOpened"))
					{
						// hide all the toolbar buttons (except the source button)
						toolbar.find("."+vars.css+"_tool").addClass(vars.css+"_hiddenField");
						$(this).removeClass(vars.css+"_hiddenField");
						
						// update to data of source displaying
						toolbar.data("sourceOpened",true);
						
						// equalize height of the text field with height of the source field
						thisElement.css("height",editor.outerHeight());
						
						sourceField.removeClass(vars.css+"_hiddenField");
						editor.addClass(vars.css+"_hiddenField");
						thisElement.focus();
						
						// hide the link-form-field
						linkAreaSwitch(false);
						
						// hide all style-fields
						styleFieldSwitch("",false);
						
						// hide format field
						formatFieldSwitch();
						
						// hide placeholder
						if(vars.placeholder && vars.placeholder!="")
							placeHolder.hide();
					}
					// if other buttons is clicked
					else
					{
						// if source field is closed
						if(!toolbar.data("sourceOpened"))
						{
							// if insert-link-button is clicked
							if($(this).data('command')=='linkcreator')
							{
								if(!toolbar.data("linkOpened"))
									selected2link();
								else
								{
									// hide the link-form-field
									linkAreaSwitch(false);
									
									// hide format field
									formatFieldSwitch(false);
								}
							}
							
							// if the format button is clicked
							else if($(this).data('command')=='formats')
							{
								if($(this).data('command')=='formats' && !$(e.target).hasClass(vars.css+"_format"))
									selected2format();
									
								// hide all style-fields
								styleFieldSwitch("",false);
								
								if(editor.not(":focus"))
									editor.focus();
							}
							
							// if the style buttons are clicked
							else if($(this).data('command')=='fSize' || $(this).data('command')=='colors')
							{
								if(
								($(this).data('command')=='fSize' && !$(e.target).hasClass(vars.css+"_fontsize")) || // the font-size button
								($(this).data('command')=='colors' && !$(e.target).hasClass(vars.css+"_color")) // the color button
								)
								selected2style($(this).data('command'));
								
								// hide format field
								formatFieldSwitch(false);
								
								if(editor.not(":focus"))
									editor.focus();
							}

							// if other buttons is clicked
							else
							{
								// first, prevent to conflict of different jqte editors
								if(editor.not(":focus"))
									editor.focus();

								// apply command of clicked button to the selected text
								selectionSet($(this).data('command'),null);

								// hide all menu-fields
								styleFieldSwitch("",false);
								formatFieldSwitch(false);
								linktypeSwitch();

								// to highlight the toolbar buttons according to the cursor position in jqte editor
								$(this).data('emphasis')==true && !$(this).hasClass(emphasize) ? $(this).addClass(emphasize) : $(this).removeClass(emphasize);

								sourceField.addClass(vars.css+"_hiddenField");
								editor.removeClass(vars.css+"_hiddenField");
							}

						}
						// hide the source field and display the text field
						else
						{
							// update to data of source hiding
							toolbar.data("sourceOpened",false);

							// display all the toolbar buttons
							toolbar.find("."+vars.css+"_tool").removeClass(vars.css+"_hiddenField");

							sourceField.addClass(vars.css+"_hiddenField");
							editor.removeClass(vars.css+"_hiddenField");
						}
						
						if(vars.placeholder && vars.placeholder!="")
							editor.html()!="" ? placeHolder.hide() : placeHolder.show();
					}
					
					// export contents of the text to the sources
					editor.trigger("change");
				})
				// the event of showing to the title bubble when mouse over of the toolbar buttons
				.hover(function(e){
					if(vars.title && $(this).data("title")!="" && ( $(e.target).hasClass(vars.css+"_tool") || $(e.target).hasClass(vars.css+"_tool_icon") ))
					{
						$('.'+vars.css+'_title').remove();

						// create the title bubble
						jQTE.append('<div class="'+vars.css+'_title"><div class="'+vars.css+'_titleArrow"><div class="'+vars.css+'_titleArrowIcon"></div></div><div class="'+vars.css+'_titleText">'+$(this).data("title")+'</div></div>');
						
						var thisTitle = $('.'+vars.css+'_title:first');
						var thisArrow = thisTitle.find('.'+vars.css+'_titleArrowIcon');
						var thisPosition = $(this).position();
						var thisAlignX = thisPosition.left + $(this).outerWidth() - (thisTitle.outerWidth()/2) - ($(this).outerWidth()/2);
						var thisAlignY = (thisPosition.top + $(this).outerHeight() + 5);

						// show the title bubble and set to its position
						thisTitle.delay(400).css({'top':thisAlignY, 'left':thisAlignX}).fadeIn(200);
					}
				},function(){
					$('.'+vars.css+'_title').remove();
				});

			// prevent multiple calling postToSource()
			var editorChangeTimer = null;

			// the methods of the text fields
			editor

				// trigger change method of the text field when the text field modified
				.bind("keypress keyup keydown drop cut copy paste DOMCharacterDataModified DOMSubtreeModified",function()
				{
					// export contents of the text to the sources
					if(!toolbar.data("sourceOpened"))
						$(this).trigger("change");
						
					// hide the link-type-field
					linktypeSwitch();
					
					// if the change method is added run the change method   
					if($.isFunction(vars.change))
						vars.change();
						
					// the feature of placeholder
					if(vars.placeholder && vars.placeholder!="")
						$(this).text()!="" ? placeHolder.hide() : placeHolder.show();
				})
				.bind("change",function()
				{
					if(!toolbar.data("sourceOpened"))
					{
						clearTimeout(editorChangeTimer);
						editorChangeTimer = setTimeout(postToSource,10);
					}
				})

				// run to keyboard shortcuts
				.keydown(function(e)
				{
					// if ctrl key is clicked
					if(e.ctrlKey)
					{
						// check all toolbar buttons
						for(var n = 0; n < buttons.length; n++)
						{
							// if this settings of this button is activated (is it true)
							// if the keyed button with ctrl is same of hotkey of this button
							if(vars[buttons[n].name] && e.keyCode == buttons[n].key.charCodeAt(0))
							{
								if(buttons[n].command!='' && buttons[n].command!='linkcreator')
									selectionSet(buttons[n].command,null);
								
								else if(buttons[n].command=='linkcreator')
									selected2link();
									
								return false;
							}
						}
					}
				})

				// method of triggering to the highlight button
				.bind("mouseup keyup",buttonEmphasize)

				// the event of focus to the text field
				.focus(function()
				{
					// if the focus method is added run the focus method   
					if($.isFunction(vars.focus))
						vars.focus();
					
					// add onfocus class
					jQTE.addClass(vars.css+"_focused");
					
					// prevent focus problem on opera
					if(/opera/.test(thisBrowser))
					{
						var range = document.createRange();
						range.selectNodeContents(editor[0]);
						range.collapse(false);
						var selection = window.getSelection();
						selection.removeAllRanges();
						selection.addRange(range);
					}
				})

				// the event of focus out from the text field
				.focusout(function()
				{
					// remove to highlights of all toolbar buttons
					toolbutton.removeClass(emphasize);
					
					// hide all menu-fields
					styleFieldSwitch("",false);
					formatFieldSwitch(false);
					linktypeSwitch();					
					
					// if the blur method is added run the blur method   
					if($.isFunction(vars.blur))
						vars.blur();
					
					// remove onfocus class	
					jQTE.removeClass(vars.css+"_focused");
					
					// show default text format
					if($.isArray(vars.formats))
						formatLabelView(vars.formats[0][1]);
				});

			// the event of key in the source field
			thisElement
				.bind("keydown keyup",function()
				{
					// export contents of the source to the text field
					setTimeout(postToEditor,0);
					
					// auto extension for the source field
					$(this).height($(this)[0].scrollHeight);
					
					// if the source field is empty, shorten to the source field
					if($(this).val()=="")
						$(this).height(0);
				})
				.focus(function()
				{
					// add onfocus class
					jQTE.addClass(vars.css+"_focused");
				})
				.focusout(function()
				{
					// remove onfocus class	
					jQTE.removeClass(vars.css+"_focused");
				});
		});
	};
})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/fullcalendar.min.js' */
/*!
 * FullCalendar v2.5.0
 * Docs & License: http://fullcalendar.io/
 * (c) 2015 Adam Shaw
 */

(function(factory) {
	if (typeof define === 'function' && define.amd) {
		define([ 'jquery', 'confimoment' ], factory);
	}
	else if (typeof exports === 'object') { // Node/CommonJS
		module.exports = factory(require('jquery'), require('confimoment'));
	}
	else {
		factory(jQuery, confimoment);
	}
})(function($, confimoment) {

;;

var FC = $.confiFormsCalendar = {
	version: "2.5.0",
	internalApiVersion: 1
};
var fcViews = FC.views = {};


$.fn.confiFormsCalendar = function(options) {
	var args = Array.prototype.slice.call(arguments, 1); // for a possible method call
	var res = this; // what this function will return (this jQuery object by default)

	this.each(function(i, _element) { // loop each DOM element involved
		var element = $(_element);
		var calendar = element.data('confiFormsCalendar'); // get the existing calendar object (if any)
		var singleRes; // the returned value of this single method call

		// a method call
		if (typeof options === 'string') {
			if (calendar && $.isFunction(calendar[options])) {
				singleRes = calendar[options].apply(calendar, args);
				if (!i) {
					res = singleRes; // record the first method call result
				}
				if (options === 'destroy') { // for the destroy method, must remove Calendar object data
					element.removeData('confiFormsCalendar');
				}
			}
		}
		// a new calendar initialization
		else if (!calendar) { // don't initialize twice
			calendar = new Calendar(element, options);
			element.data('confiFormsCalendar', calendar);
			calendar.render();
		}
	});

	return res;
};


var complexOptions = [ // names of options that are objects whose properties should be combined
	'header',
	'buttonText',
	'buttonIcons',
	'themeButtonIcons'
];


// Merges an array of option objects into a single object
function mergeOptions(optionObjs) {
	return mergeProps(optionObjs, complexOptions);
}


// Given options specified for the calendar's constructor, massages any legacy options into a non-legacy form.
// Converts View-Option-Hashes into the View-Specific-Options format.
function massageOverrides(input) {
	var overrides = { views: input.views || {} }; // the output. ensure a `views` hash
	var subObj;

	// iterate through all option override properties (except `views`)
	$.each(input, function(name, val) {
		if (name != 'views') {

			// could the value be a legacy View-Option-Hash?
			if (
				$.isPlainObject(val) &&
				!/(time|duration|interval)$/i.test(name) && // exclude duration options. might be given as objects
				$.inArray(name, complexOptions) == -1 // complex options aren't allowed to be View-Option-Hashes
			) {
				subObj = null;

				// iterate through the properties of this possible View-Option-Hash value
				$.each(val, function(subName, subVal) {

					// is the property targeting a view?
					if (/^(month|week|day|default|basic(Week|Day)?|agenda(Week|Day)?)$/.test(subName)) {
						if (!overrides.views[subName]) { // ensure the view-target entry exists
							overrides.views[subName] = {};
						}
						overrides.views[subName][name] = subVal; // record the value in the `views` object
					}
					else { // a non-View-Option-Hash property
						if (!subObj) {
							subObj = {};
						}
						subObj[subName] = subVal; // accumulate these unrelated values for later
					}
				});

				if (subObj) { // non-View-Option-Hash properties? transfer them as-is
					overrides[name] = subObj;
				}
			}
			else {
				overrides[name] = val; // transfer normal options as-is
			}
		}
	});

	return overrides;
}

;;

// exports
FC.intersectRanges = intersectRanges;
FC.applyAll = applyAll;
FC.debounce = debounce;
FC.isInt = isInt;
FC.htmlEscape = htmlEscape;
FC.cssToStr = cssToStr;
FC.proxy = proxy;
FC.capitaliseFirstLetter = capitaliseFirstLetter;


/* FullCalendar-specific DOM Utilities
----------------------------------------------------------------------------------------------------------------------*/


// Given the scrollbar widths of some other container, create borders/margins on rowEls in order to match the left
// and right space that was offset by the scrollbars. A 1-pixel border first, then margin beyond that.
function compensateScroll(rowEls, scrollbarWidths) {
	if (scrollbarWidths.left) {
		rowEls.css({
			'border-left-width': 1,
			'margin-left': scrollbarWidths.left - 1
		});
	}
	if (scrollbarWidths.right) {
		rowEls.css({
			'border-right-width': 1,
			'margin-right': scrollbarWidths.right - 1
		});
	}
}


// Undoes compensateScroll and restores all borders/margins
function uncompensateScroll(rowEls) {
	rowEls.css({
		'margin-left': '',
		'margin-right': '',
		'border-left-width': '',
		'border-right-width': ''
	});
}


// Make the mouse cursor express that an event is not allowed in the current area
function disableCursor() {
	$('body').addClass('fc-not-allowed');
}


// Returns the mouse cursor to its original look
function enableCursor() {
	$('body').removeClass('fc-not-allowed');
}


// Given a total available height to fill, have `els` (essentially child rows) expand to accomodate.
// By default, all elements that are shorter than the recommended height are expanded uniformly, not considering
// any other els that are already too tall. if `shouldRedistribute` is on, it considers these tall rows and
// reduces the available height.
function distributeHeight(els, availableHeight, shouldRedistribute) {

	// *FLOORING NOTE*: we floor in certain places because zoom can give inaccurate floating-point dimensions,
	// and it is better to be shorter than taller, to avoid creating unnecessary scrollbars.

	var minOffset1 = Math.floor(availableHeight / els.length); // for non-last element
	var minOffset2 = Math.floor(availableHeight - minOffset1 * (els.length - 1)); // for last element *FLOORING NOTE*
	var flexEls = []; // elements that are allowed to expand. array of DOM nodes
	var flexOffsets = []; // amount of vertical space it takes up
	var flexHeights = []; // actual css height
	var usedHeight = 0;

	undistributeHeight(els); // give all elements their natural height

	// find elements that are below the recommended height (expandable).
	// important to query for heights in a single first pass (to avoid reflow oscillation).
	els.each(function(i, el) {
		var minOffset = i === els.length - 1 ? minOffset2 : minOffset1;
		var naturalOffset = $(el).outerHeight(true);

		if (naturalOffset < minOffset) {
			flexEls.push(el);
			flexOffsets.push(naturalOffset);
			flexHeights.push($(el).height());
		}
		else {
			// this element stretches past recommended height (non-expandable). mark the space as occupied.
			usedHeight += naturalOffset;
		}
	});

	// readjust the recommended height to only consider the height available to non-maxed-out rows.
	if (shouldRedistribute) {
		availableHeight -= usedHeight;
		minOffset1 = Math.floor(availableHeight / flexEls.length);
		minOffset2 = Math.floor(availableHeight - minOffset1 * (flexEls.length - 1)); // *FLOORING NOTE*
	}

	// assign heights to all expandable elements
	$(flexEls).each(function(i, el) {
		var minOffset = i === flexEls.length - 1 ? minOffset2 : minOffset1;
		var naturalOffset = flexOffsets[i];
		var naturalHeight = flexHeights[i];
		var newHeight = minOffset - (naturalOffset - naturalHeight); // subtract the margin/padding

		if (naturalOffset < minOffset) { // we check this again because redistribution might have changed things
			$(el).height(newHeight);
		}
	});
}


// Undoes distrubuteHeight, restoring all els to their natural height
function undistributeHeight(els) {
	els.height('');
}


// Given `els`, a jQuery set of <td> cells, find the cell with the largest natural width and set the widths of all the
// cells to be that width.
// PREREQUISITE: if you want a cell to take up width, it needs to have a single inner element w/ display:inline
function matchCellWidths(els) {
	var maxInnerWidth = 0;

	els.find('> *').each(function(i, innerEl) {
		var innerWidth = $(innerEl).outerWidth();
		if (innerWidth > maxInnerWidth) {
			maxInnerWidth = innerWidth;
		}
	});

	maxInnerWidth++; // sometimes not accurate of width the text needs to stay on one line. insurance

	els.width(maxInnerWidth);

	return maxInnerWidth;
}


// Turns a container element into a scroller if its contents is taller than the allotted height.
// Returns true if the element is now a scroller, false otherwise.
// NOTE: this method is best because it takes weird zooming dimensions into account
function setPotentialScroller(containerEl, height) {
	containerEl.height(height).addClass('fc-scroller');

	// are scrollbars needed?
	if (containerEl[0].scrollHeight - 1 > containerEl[0].clientHeight) { // !!! -1 because IE is often off-by-one :(
		return true;
	}

	unsetScroller(containerEl); // undo
	return false;
}


// Takes an element that might have been a scroller, and turns it back into a normal element.
function unsetScroller(containerEl) {
	containerEl.height('').removeClass('fc-scroller');
}


/* General DOM Utilities
----------------------------------------------------------------------------------------------------------------------*/

FC.getOuterRect = getOuterRect;
FC.getClientRect = getClientRect;
FC.getContentRect = getContentRect;
FC.getScrollbarWidths = getScrollbarWidths;


// borrowed from https://github.com/jquery/jquery-ui/blob/1.11.0/ui/core.js#L51
function getScrollParent(el) {
	var position = el.css('position'),
		scrollParent = el.parents().filter(function() {
			var parent = $(this);
			return (/(auto|scroll)/).test(
				parent.css('overflow') + parent.css('overflow-y') + parent.css('overflow-x')
			);
		}).eq(0);

	return position === 'fixed' || !scrollParent.length ? $(el[0].ownerDocument || document) : scrollParent;
}


// Queries the outer bounding area of a jQuery element.
// Returns a rectangle with absolute coordinates: left, right (exclusive), top, bottom (exclusive).
function getOuterRect(el) {
	var offset = el.offset();

	return {
		left: offset.left,
		right: offset.left + el.outerWidth(),
		top: offset.top,
		bottom: offset.top + el.outerHeight()
	};
}


// Queries the area within the margin/border/scrollbars of a jQuery element. Does not go within the padding.
// Returns a rectangle with absolute coordinates: left, right (exclusive), top, bottom (exclusive).
// NOTE: should use clientLeft/clientTop, but very unreliable cross-browser.
function getClientRect(el) {
	var offset = el.offset();
	var scrollbarWidths = getScrollbarWidths(el);
	var left = offset.left + getCssFloat(el, 'border-left-width') + scrollbarWidths.left;
	var top = offset.top + getCssFloat(el, 'border-top-width') + scrollbarWidths.top;

	return {
		left: left,
		right: left + el[0].clientWidth, // clientWidth includes padding but NOT scrollbars
		top: top,
		bottom: top + el[0].clientHeight // clientHeight includes padding but NOT scrollbars
	};
}


// Queries the area within the margin/border/padding of a jQuery element. Assumed not to have scrollbars.
// Returns a rectangle with absolute coordinates: left, right (exclusive), top, bottom (exclusive).
function getContentRect(el) {
	var offset = el.offset(); // just outside of border, margin not included
	var left = offset.left + getCssFloat(el, 'border-left-width') + getCssFloat(el, 'padding-left');
	var top = offset.top + getCssFloat(el, 'border-top-width') + getCssFloat(el, 'padding-top');

	return {
		left: left,
		right: left + el.width(),
		top: top,
		bottom: top + el.height()
	};
}


// Returns the computed left/right/top/bottom scrollbar widths for the given jQuery element.
// NOTE: should use clientLeft/clientTop, but very unreliable cross-browser.
function getScrollbarWidths(el) {
	var leftRightWidth = el.innerWidth() - el[0].clientWidth; // the paddings cancel out, leaving the scrollbars
	var widths = {
		left: 0,
		right: 0,
		top: 0,
		bottom: el.innerHeight() - el[0].clientHeight // the paddings cancel out, leaving the bottom scrollbar
	};

	if (getIsLeftRtlScrollbars() && el.css('direction') == 'rtl') { // is the scrollbar on the left side?
		widths.left = leftRightWidth;
	}
	else {
		widths.right = leftRightWidth;
	}

	return widths;
}


// Logic for determining if, when the element is right-to-left, the scrollbar appears on the left side

var _isLeftRtlScrollbars = null;

function getIsLeftRtlScrollbars() { // responsible for caching the computation
	if (_isLeftRtlScrollbars === null) {
		_isLeftRtlScrollbars = computeIsLeftRtlScrollbars();
	}
	return _isLeftRtlScrollbars;
}

function computeIsLeftRtlScrollbars() { // creates an offscreen test element, then removes it
	var el = $('<div><div/></div>')
		.css({
			position: 'absolute',
			top: -1000,
			left: 0,
			border: 0,
			padding: 0,
			overflow: 'scroll',
			direction: 'rtl'
		})
		.appendTo('body');
	var innerEl = el.children();
	var res = innerEl.offset().left > el.offset().left; // is the inner div shifted to accommodate a left scrollbar?
	el.remove();
	return res;
}


// Retrieves a jQuery element's computed CSS value as a floating-point number.
// If the queried value is non-numeric (ex: IE can return "medium" for border width), will just return zero.
function getCssFloat(el, prop) {
	return parseFloat(el.css(prop)) || 0;
}


// Returns a boolean whether this was a left mouse click and no ctrl key (which means right click on Mac)
function isPrimaryMouseButton(ev) {
	return ev.which == 1 && !ev.ctrlKey;
}


/* Geometry
----------------------------------------------------------------------------------------------------------------------*/

FC.intersectRects = intersectRects;

// Returns a new rectangle that is the intersection of the two rectangles. If they don't intersect, returns false
function intersectRects(rect1, rect2) {
	var res = {
		left: Math.max(rect1.left, rect2.left),
		right: Math.min(rect1.right, rect2.right),
		top: Math.max(rect1.top, rect2.top),
		bottom: Math.min(rect1.bottom, rect2.bottom)
	};

	if (res.left < res.right && res.top < res.bottom) {
		return res;
	}
	return false;
}


// Returns a new point that will have been moved to reside within the given rectangle
function constrainPoint(point, rect) {
	return {
		left: Math.min(Math.max(point.left, rect.left), rect.right),
		top: Math.min(Math.max(point.top, rect.top), rect.bottom)
	};
}


// Returns a point that is the center of the given rectangle
function getRectCenter(rect) {
	return {
		left: (rect.left + rect.right) / 2,
		top: (rect.top + rect.bottom) / 2
	};
}


// Subtracts point2's coordinates from point1's coordinates, returning a delta
function diffPoints(point1, point2) {
	return {
		left: point1.left - point2.left,
		top: point1.top - point2.top
	};
}


/* Object Ordering by Field
----------------------------------------------------------------------------------------------------------------------*/

FC.parseFieldSpecs = parseFieldSpecs;
FC.compareByFieldSpecs = compareByFieldSpecs;
FC.compareByFieldSpec = compareByFieldSpec;
FC.flexibleCompare = flexibleCompare;


function parseFieldSpecs(input) {
	var specs = [];
	var tokens = [];
	var i, token;

	if (typeof input === 'string') {
		tokens = input.split(/\s*,\s*/);
	}
	else if (typeof input === 'function') {
		tokens = [ input ];
	}
	else if ($.isArray(input)) {
		tokens = input;
	}

	for (i = 0; i < tokens.length; i++) {
		token = tokens[i];

		if (typeof token === 'string') {
			specs.push(
				token.charAt(0) == '-' ?
					{ field: token.substring(1), order: -1 } :
					{ field: token, order: 1 }
			);
		}
		else if (typeof token === 'function') {
			specs.push({ func: token });
		}
	}

	return specs;
}


function compareByFieldSpecs(obj1, obj2, fieldSpecs) {
	var i;
	var cmp;

	for (i = 0; i < fieldSpecs.length; i++) {
		cmp = compareByFieldSpec(obj1, obj2, fieldSpecs[i]);
		if (cmp) {
			return cmp;
		}
	}

	return 0;
}


function compareByFieldSpec(obj1, obj2, fieldSpec) {
	if (fieldSpec.func) {
		return fieldSpec.func(obj1, obj2);
	}
	return flexibleCompare(obj1[fieldSpec.field], obj2[fieldSpec.field]) *
		(fieldSpec.order || 1);
}


function flexibleCompare(a, b) {
	if (!a && !b) {
		return 0;
	}
	if (b == null) {
		return -1;
	}
	if (a == null) {
		return 1;
	}
	if ($.type(a) === 'string' || $.type(b) === 'string') {
		return String(a).localeCompare(String(b));
	}
	return a - b;
}


/* FullCalendar-specific Misc Utilities
----------------------------------------------------------------------------------------------------------------------*/


// Computes the intersection of the two ranges. Returns undefined if no intersection.
// Expects all dates to be normalized to the same timezone beforehand.
// TODO: move to date section?
function intersectRanges(subjectRange, constraintRange) {
	var subjectStart = subjectRange.start;
	var subjectEnd = subjectRange.end;
	var constraintStart = constraintRange.start;
	var constraintEnd = constraintRange.end;
	var segStart, segEnd;
	var isStart, isEnd;

	if (subjectEnd > constraintStart && subjectStart < constraintEnd) { // in bounds at all?

		if (subjectStart >= constraintStart) {
			segStart = subjectStart.clone();
			isStart = true;
		}
		else {
			segStart = constraintStart.clone();
			isStart =  false;
		}

		if (subjectEnd <= constraintEnd) {
			segEnd = subjectEnd.clone();
			isEnd = true;
		}
		else {
			segEnd = constraintEnd.clone();
			isEnd = false;
		}

		return {
			start: segStart,
			end: segEnd,
			isStart: isStart,
			isEnd: isEnd
		};
	}
}


/* Date Utilities
----------------------------------------------------------------------------------------------------------------------*/

FC.computeIntervalUnit = computeIntervalUnit;
FC.divideRangeByDuration = divideRangeByDuration;
FC.divideDurationByDuration = divideDurationByDuration;
FC.multiplyDuration = multiplyDuration;
FC.durationHasTime = durationHasTime;

var dayIDs = [ 'sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat' ];
var intervalUnits = [ 'year', 'month', 'week', 'day', 'hour', 'minute', 'second', 'millisecond' ];


// Diffs the two moments into a Duration where full-days are recorded first, then the remaining time.
// Moments will have their timezones normalized.
function diffDayTime(a, b) {
	return confimoment.duration({
		days: a.clone().stripTime().diff(b.clone().stripTime(), 'days'),
		ms: a.time() - b.time() // time-of-day from day start. disregards timezone
	});
}


// Diffs the two moments via their start-of-day (regardless of timezone). Produces whole-day durations.
function diffDay(a, b) {
	return confimoment.duration({
		days: a.clone().stripTime().diff(b.clone().stripTime(), 'days')
	});
}


// Diffs two moments, producing a duration, made of a whole-unit-increment of the given unit. Uses rounding.
function diffByUnit(a, b, unit) {
	return confimoment.duration(
		Math.round(a.diff(b, unit, true)), // returnFloat=true
		unit
	);
}


// Computes the unit name of the largest whole-unit period of time.
// For example, 48 hours will be "days" whereas 49 hours will be "hours".
// Accepts start/end, a range object, or an original duration object.
function computeIntervalUnit(start, end) {
	var i, unit;
	var val;

	for (i = 0; i < intervalUnits.length; i++) {
		unit = intervalUnits[i];
		val = computeRangeAs(unit, start, end);

		if (val >= 1 && isInt(val)) {
			break;
		}
	}

	return unit; // will be "milliseconds" if nothing else matches
}


// Computes the number of units (like "hours") in the given range.
// Range can be a {start,end} object, separate start/end args, or a Duration.
// Results are based on Moment's .as() and .diff() methods, so results can depend on internal handling
// of month-diffing logic (which tends to vary from version to version).
function computeRangeAs(unit, start, end) {

	if (end != null) { // given start, end
		return end.diff(start, unit, true);
	}
	else if (confimoment.isDuration(start)) { // given duration
		return start.as(unit);
	}
	else { // given { start, end } range object
		return start.end.diff(start.start, unit, true);
	}
}


// Intelligently divides a range (specified by a start/end params) by a duration
function divideRangeByDuration(start, end, dur) {
	var months;

	if (durationHasTime(dur)) {
		return (end - start) / dur;
	}
	months = dur.asMonths();
	if (Math.abs(months) >= 1 && isInt(months)) {
		return end.diff(start, 'months', true) / months;
	}
	return end.diff(start, 'days', true) / dur.asDays();
}


// Intelligently divides one duration by another
function divideDurationByDuration(dur1, dur2) {
	var months1, months2;

	if (durationHasTime(dur1) || durationHasTime(dur2)) {
		return dur1 / dur2;
	}
	months1 = dur1.asMonths();
	months2 = dur2.asMonths();
	if (
		Math.abs(months1) >= 1 && isInt(months1) &&
		Math.abs(months2) >= 1 && isInt(months2)
	) {
		return months1 / months2;
	}
	return dur1.asDays() / dur2.asDays();
}


// Intelligently multiplies a duration by a number
function multiplyDuration(dur, n) {
	var months;

	if (durationHasTime(dur)) {
		return confimoment.duration(dur * n);
	}
	months = dur.asMonths();
	if (Math.abs(months) >= 1 && isInt(months)) {
		return confimoment.duration({ months: months * n });
	}
	return confimoment.duration({ days: dur.asDays() * n });
}


// Returns a boolean about whether the given duration has any time parts (hours/minutes/seconds/ms)
function durationHasTime(dur) {
	return Boolean(dur.hours() || dur.minutes() || dur.seconds() || dur.milliseconds());
}


function isNativeDate(input) {
	return  Object.prototype.toString.call(input) === '[object Date]' || input instanceof Date;
}


// Returns a boolean about whether the given input is a time string, like "06:40:00" or "06:00"
function isTimeString(str) {
	return /^\d+\:\d+(?:\:\d+\.?(?:\d{3})?)?$/.test(str);
}


/* Logging and Debug
----------------------------------------------------------------------------------------------------------------------*/

FC.log = function() {
	var console = window.console;

	if (console && console.log) {
		return console.log.apply(console, arguments);
	}
};

FC.warn = function() {
	var console = window.console;

	if (console && console.warn) {
		return console.warn.apply(console, arguments);
	}
	else {
		return FC.log.apply(FC, arguments);
	}
};


/* General Utilities
----------------------------------------------------------------------------------------------------------------------*/

var hasOwnPropMethod = {}.hasOwnProperty;


// Merges an array of objects into a single object.
// The second argument allows for an array of property names who's object values will be merged together.
function mergeProps(propObjs, complexProps) {
	var dest = {};
	var i, name;
	var complexObjs;
	var j, val;
	var props;

	if (complexProps) {
		for (i = 0; i < complexProps.length; i++) {
			name = complexProps[i];
			complexObjs = [];

			// collect the trailing object values, stopping when a non-object is discovered
			for (j = propObjs.length - 1; j >= 0; j--) {
				val = propObjs[j][name];

				if (typeof val === 'object') {
					complexObjs.unshift(val);
				}
				else if (val !== undefined) {
					dest[name] = val; // if there were no objects, this value will be used
					break;
				}
			}

			// if the trailing values were objects, use the merged value
			if (complexObjs.length) {
				dest[name] = mergeProps(complexObjs);
			}
		}
	}

	// copy values into the destination, going from last to first
	for (i = propObjs.length - 1; i >= 0; i--) {
		props = propObjs[i];

		for (name in props) {
			if (!(name in dest)) { // if already assigned by previous props or complex props, don't reassign
				dest[name] = props[name];
			}
		}
	}

	return dest;
}


// Create an object that has the given prototype. Just like Object.create
function createObject(proto) {
	var f = function() {};
	f.prototype = proto;
	return new f();
}


function copyOwnProps(src, dest) {
	for (var name in src) {
		if (hasOwnProp(src, name)) {
			dest[name] = src[name];
		}
	}
}


// Copies over certain methods with the same names as Object.prototype methods. Overcomes an IE<=8 bug:
// https://developer.mozilla.org/en-US/docs/ECMAScript_DontEnum_attribute#JScript_DontEnum_Bug
function copyNativeMethods(src, dest) {
	var names = [ 'constructor', 'toString', 'valueOf' ];
	var i, name;

	for (i = 0; i < names.length; i++) {
		name = names[i];

		if (src[name] !== Object.prototype[name]) {
			dest[name] = src[name];
		}
	}
}


function hasOwnProp(obj, name) {
	return hasOwnPropMethod.call(obj, name);
}


// Is the given value a non-object non-function value?
function isAtomic(val) {
	return /undefined|null|boolean|number|string/.test($.type(val));
}


function applyAll(functions, thisObj, args) {
	if ($.isFunction(functions)) {
		functions = [ functions ];
	}
	if (functions) {
		var i;
		var ret;
		for (i=0; i<functions.length; i++) {
			ret = functions[i].apply(thisObj, args) || ret;
		}
		return ret;
	}
}


function firstDefined() {
	for (var i=0; i<arguments.length; i++) {
		if (arguments[i] !== undefined) {
			return arguments[i];
		}
	}
}


function htmlEscape(s) {
	return (s + '').replace(/&/g, '&amp;')
		.replace(/</g, '&lt;')
		.replace(/>/g, '&gt;')
		.replace(/'/g, '&#039;')
		.replace(/"/g, '&quot;')
		.replace(/\n/g, '<br />');
}


function stripHtmlEntities(text) {
	return text.replace(/&.*?;/g, '');
}


// Given a hash of CSS properties, returns a string of CSS.
// Uses property names as-is (no camel-case conversion). Will not make statements for null/undefined values.
function cssToStr(cssProps) {
	var statements = [];

	$.each(cssProps, function(name, val) {
		if (val != null) {
			statements.push(name + ':' + val);
		}
	});

	return statements.join(';');
}


function capitaliseFirstLetter(str) {
	return str.charAt(0).toUpperCase() + str.slice(1);
}


function compareNumbers(a, b) { // for .sort()
	return a - b;
}


function isInt(n) {
	return n % 1 === 0;
}


// Returns a method bound to the given object context.
// Just like one of the jQuery.proxy signatures, but without the undesired behavior of treating the same method with
// different contexts as identical when binding/unbinding events.
function proxy(obj, methodName) {
	var method = obj[methodName];

	return function() {
		return method.apply(obj, arguments);
	};
}


// Returns a function, that, as long as it continues to be invoked, will not
// be triggered. The function will be called after it stops being called for
// N milliseconds.
// https://github.com/jashkenas/underscore/blob/1.6.0/underscore.js#L714
function debounce(func, wait) {
	var timeoutId;
	var args;
	var context;
	var timestamp; // of most recent call
	var later = function() {
		var last = +new Date() - timestamp;
		if (last < wait && last > 0) {
			timeoutId = setTimeout(later, wait - last);
		}
		else {
			timeoutId = null;
			func.apply(context, args);
			if (!timeoutId) {
				context = args = null;
			}
		}
	};

	return function() {
		context = this;
		args = arguments;
		timestamp = +new Date();
		if (!timeoutId) {
			timeoutId = setTimeout(later, wait);
		}
	};
}

;;

var ambigDateOfMonthRegex = /^\s*\d{4}-\d\d$/;
var ambigTimeOrZoneRegex =
	/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?)?$/;
var newMomentProto = confimoment.fn; // where we will attach our new methods
var oldMomentProto = $.extend({}, newMomentProto); // copy of original moment methods
var allowValueOptimization;
var setUTCValues; // function defined below
var setLocalValues; // function defined below


// Creating
// -------------------------------------------------------------------------------------------------

// Creates a new moment, similar to the vanilla moment(...) constructor, but with
// extra features (ambiguous time, enhanced formatting). When given an existing moment,
// it will function as a clone (and retain the zone of the moment). Anything else will
// result in a moment in the local zone.
FC.confimoment = function() {
	return makeMoment(arguments);
};

// Sames as FC.moment, but forces the resulting moment to be in the UTC timezone.
FC.confimoment.utc = function() {
	var mom = makeMoment(arguments, true);

	// Force it into UTC because makeMoment doesn't guarantee it
	// (if given a pre-existing moment for example)
	if (mom.hasTime()) { // don't give ambiguously-timed moments a UTC zone
		mom.utc();
	}

	return mom;
};

// Same as FC.moment, but when given an ISO8601 string, the timezone offset is preserved.
// ISO8601 strings with no timezone offset will become ambiguously zoned.
FC.confimoment.parseZone = function() {
	return makeMoment(arguments, true, true);
};

// Builds an enhanced moment from args. When given an existing moment, it clones. When given a
// native Date, or called with no arguments (the current time), the resulting moment will be local.
// Anything else needs to be "parsed" (a string or an array), and will be affected by:
//    parseAsUTC - if there is no zone information, should we parse the input in UTC?
//    parseZone - if there is zone information, should we force the zone of the moment?
function makeMoment(args, parseAsUTC, parseZone) {
	var input = args[0];
	var isSingleString = args.length == 1 && typeof input === 'string';
	var isAmbigTime;
	var isAmbigZone;
	var ambigMatch;
	var mom;

	if (confimoment.isMoment(input)) {
		mom = confimoment.apply(null, args); // clone it
		transferAmbigs(input, mom); // the ambig flags weren't transfered with the clone
	}
	else if (isNativeDate(input) || input === undefined) {
		mom = confimoment.apply(null, args); // will be local
	}
	else { // "parsing" is required
		isAmbigTime = false;
		isAmbigZone = false;

		if (isSingleString) {
			if (ambigDateOfMonthRegex.test(input)) {
				// accept strings like '2014-05', but convert to the first of the month
				input += '-01';
				args = [ input ]; // for when we pass it on to moment's constructor
				isAmbigTime = true;
				isAmbigZone = true;
			}
			else if ((ambigMatch = ambigTimeOrZoneRegex.exec(input))) {
				isAmbigTime = !ambigMatch[5]; // no time part?
				isAmbigZone = true;
			}
		}
		else if ($.isArray(input)) {
			// arrays have no timezone information, so assume ambiguous zone
			isAmbigZone = true;
		}
		// otherwise, probably a string with a format

		if (parseAsUTC || isAmbigTime) {
			mom = confimoment.utc.apply(confimoment, args);
		}
		else {
			mom = confimoment.apply(null, args);
		}

		if (isAmbigTime) {
			mom._ambigTime = true;
			mom._ambigZone = true; // ambiguous time always means ambiguous zone
		}
		else if (parseZone) { // let's record the inputted zone somehow
			if (isAmbigZone) {
				mom._ambigZone = true;
			}
			else if (isSingleString) {
				if (mom.utcOffset) {
					mom.utcOffset(input); // if not a valid zone, will assign UTC
				}
				else {
					mom.zone(input); // for moment-pre-2.9
				}
			}
		}
	}

	mom._fullCalendar = true; // flag for extended functionality

	return mom;
}


// A clone method that works with the flags related to our enhanced functionality.
// In the future, use moment.momentProperties
newMomentProto.clone = function() {
	var mom = oldMomentProto.clone.apply(this, arguments);

	// these flags weren't transfered with the clone
	transferAmbigs(this, mom);
	if (this._fullCalendar) {
		mom._fullCalendar = true;
	}

	return mom;
};


// Week Number
// -------------------------------------------------------------------------------------------------


// Returns the week number, considering the locale's custom week number calcuation
// `weeks` is an alias for `week`
newMomentProto.week = newMomentProto.weeks = function(input) {
	var weekCalc = (this._locale || this._lang) // works pre-moment-2.8
		._fullCalendar_weekCalc;

	if (input == null && typeof weekCalc === 'function') { // custom function only works for getter
		return weekCalc(this);
	}
	else if (weekCalc === 'ISO') {
		return oldMomentProto.isoWeek.apply(this, arguments); // ISO getter/setter
	}

	return oldMomentProto.week.apply(this, arguments); // local getter/setter
};


// Time-of-day
// -------------------------------------------------------------------------------------------------

// GETTER
// Returns a Duration with the hours/minutes/seconds/ms values of the moment.
// If the moment has an ambiguous time, a duration of 00:00 will be returned.
//
// SETTER
// You can supply a Duration, a Moment, or a Duration-like argument.
// When setting the time, and the moment has an ambiguous time, it then becomes unambiguous.
newMomentProto.time = function(time) {

	// Fallback to the original method (if there is one) if this moment wasn't created via FullCalendar.
	// `time` is a generic enough method name where this precaution is necessary to avoid collisions w/ other plugins.
	if (!this._fullCalendar) {
		return oldMomentProto.time.apply(this, arguments);
	}

	if (time == null) { // getter
		return confimoment.duration({
			hours: this.hours(),
			minutes: this.minutes(),
			seconds: this.seconds(),
			milliseconds: this.milliseconds()
		});
	}
	else { // setter

		this._ambigTime = false; // mark that the moment now has a time

		if (!confimoment.isDuration(time) && !confimoment.isMoment(time)) {
			time = confimoment.duration(time);
		}

		// The day value should cause overflow (so 24 hours becomes 00:00:00 of next day).
		// Only for Duration times, not Moment times.
		var dayHours = 0;
		if (confimoment.isDuration(time)) {
			dayHours = Math.floor(time.asDays()) * 24;
		}

		// We need to set the individual fields.
		// Can't use startOf('day') then add duration. In case of DST at start of day.
		return this.hours(dayHours + time.hours())
			.minutes(time.minutes())
			.seconds(time.seconds())
			.milliseconds(time.milliseconds());
	}
};

// Converts the moment to UTC, stripping out its time-of-day and timezone offset,
// but preserving its YMD. A moment with a stripped time will display no time
// nor timezone offset when .format() is called.
newMomentProto.stripTime = function() {
	var a;

	if (!this._ambigTime) {

		// get the values before any conversion happens
		a = this.toArray(); // array of y/m/d/h/m/s/ms

		// TODO: use keepLocalTime in the future
		this.utc(); // set the internal UTC flag (will clear the ambig flags)
		setUTCValues(this, a.slice(0, 3)); // set the year/month/date. time will be zero

		// Mark the time as ambiguous. This needs to happen after the .utc() call, which might call .utcOffset(),
		// which clears all ambig flags. Same with setUTCValues with moment-timezone.
		this._ambigTime = true;
		this._ambigZone = true; // if ambiguous time, also ambiguous timezone offset
	}

	return this; // for chaining
};

// Returns if the moment has a non-ambiguous time (boolean)
newMomentProto.hasTime = function() {
	return !this._ambigTime;
};


// Timezone
// -------------------------------------------------------------------------------------------------

// Converts the moment to UTC, stripping out its timezone offset, but preserving its
// YMD and time-of-day. A moment with a stripped timezone offset will display no
// timezone offset when .format() is called.
// TODO: look into Moment's keepLocalTime functionality
newMomentProto.stripZone = function() {
	var a, wasAmbigTime;

	if (!this._ambigZone) {

		// get the values before any conversion happens
		a = this.toArray(); // array of y/m/d/h/m/s/ms
		wasAmbigTime = this._ambigTime;

		this.utc(); // set the internal UTC flag (might clear the ambig flags, depending on Moment internals)
		setUTCValues(this, a); // will set the year/month/date/hours/minutes/seconds/ms

		// the above call to .utc()/.utcOffset() unfortunately might clear the ambig flags, so restore
		this._ambigTime = wasAmbigTime || false;

		// Mark the zone as ambiguous. This needs to happen after the .utc() call, which might call .utcOffset(),
		// which clears the ambig flags. Same with setUTCValues with moment-timezone.
		this._ambigZone = true;
	}

	return this; // for chaining
};

// Returns of the moment has a non-ambiguous timezone offset (boolean)
newMomentProto.hasZone = function() {
	return !this._ambigZone;
};


// this method implicitly marks a zone
newMomentProto.local = function() {
	var a = this.toArray(); // year,month,date,hours,minutes,seconds,ms as an array
	var wasAmbigZone = this._ambigZone;

	oldMomentProto.local.apply(this, arguments);

	// ensure non-ambiguous
	// this probably already happened via local() -> utcOffset(), but don't rely on Moment's internals
	this._ambigTime = false;
	this._ambigZone = false;

	if (wasAmbigZone) {
		// If the moment was ambiguously zoned, the date fields were stored as UTC.
		// We want to preserve these, but in local time.
		// TODO: look into Moment's keepLocalTime functionality
		setLocalValues(this, a);
	}

	return this; // for chaining
};


// implicitly marks a zone
newMomentProto.utc = function() {
	oldMomentProto.utc.apply(this, arguments);

	// ensure non-ambiguous
	// this probably already happened via utc() -> utcOffset(), but don't rely on Moment's internals
	this._ambigTime = false;
	this._ambigZone = false;

	return this;
};


// methods for arbitrarily manipulating timezone offset.
// should clear time/zone ambiguity when called.
$.each([
	'zone', // only in moment-pre-2.9. deprecated afterwards
	'utcOffset'
], function(i, name) {
	if (oldMomentProto[name]) { // original method exists?

		// this method implicitly marks a zone (will probably get called upon .utc() and .local())
		newMomentProto[name] = function(tzo) {

			if (tzo != null) { // setter
				// these assignments needs to happen before the original zone method is called.
				// I forget why, something to do with a browser crash.
				this._ambigTime = false;
				this._ambigZone = false;
			}

			return oldMomentProto[name].apply(this, arguments);
		};
	}
});


// Formatting
// -------------------------------------------------------------------------------------------------

newMomentProto.format = function() {
	if (this._fullCalendar && arguments[0]) { // an enhanced moment? and a format string provided?
		return formatDate(this, arguments[0]); // our extended formatting
	}
	if (this._ambigTime) {
		return oldMomentFormat(this, 'YYYY-MM-DD');
	}
	if (this._ambigZone) {
		return oldMomentFormat(this, 'YYYY-MM-DD[T]HH:mm:ss');
	}
	return oldMomentProto.format.apply(this, arguments);
};

newMomentProto.toISOString = function() {
	if (this._ambigTime) {
		return oldMomentFormat(this, 'YYYY-MM-DD');
	}
	if (this._ambigZone) {
		return oldMomentFormat(this, 'YYYY-MM-DD[T]HH:mm:ss');
	}
	return oldMomentProto.toISOString.apply(this, arguments);
};


// Querying
// -------------------------------------------------------------------------------------------------

// Is the moment within the specified range? `end` is exclusive.
// FYI, this method is not a standard Moment method, so always do our enhanced logic.
newMomentProto.isWithin = function(start, end) {
	var a = commonlyAmbiguate([ this, start, end ]);
	return a[0] >= a[1] && a[0] < a[2];
};

// When isSame is called with units, timezone ambiguity is normalized before the comparison happens.
// If no units specified, the two moments must be identically the same, with matching ambig flags.
newMomentProto.isSame = function(input, units) {
	var a;

	// only do custom logic if this is an enhanced moment
	if (!this._fullCalendar) {
		return oldMomentProto.isSame.apply(this, arguments);
	}

	if (units) {
		a = commonlyAmbiguate([ this, input ], true); // normalize timezones but don't erase times
		return oldMomentProto.isSame.call(a[0], a[1], units);
	}
	else {
		input = FC.confimoment.parseZone(input); // normalize input
		return oldMomentProto.isSame.call(this, input) &&
			Boolean(this._ambigTime) === Boolean(input._ambigTime) &&
			Boolean(this._ambigZone) === Boolean(input._ambigZone);
	}
};

// Make these query methods work with ambiguous moments
$.each([
	'isBefore',
	'isAfter'
], function(i, methodName) {
	newMomentProto[methodName] = function(input, units) {
		var a;

		// only do custom logic if this is an enhanced moment
		if (!this._fullCalendar) {
			return oldMomentProto[methodName].apply(this, arguments);
		}

		a = commonlyAmbiguate([ this, input ]);
		return oldMomentProto[methodName].call(a[0], a[1], units);
	};
});


// Misc Internals
// -------------------------------------------------------------------------------------------------

// given an array of moment-like inputs, return a parallel array w/ moments similarly ambiguated.
// for example, of one moment has ambig time, but not others, all moments will have their time stripped.
// set `preserveTime` to `true` to keep times, but only normalize zone ambiguity.
// returns the original moments if no modifications are necessary.
function commonlyAmbiguate(inputs, preserveTime) {
	var anyAmbigTime = false;
	var anyAmbigZone = false;
	var len = inputs.length;
	var moms = [];
	var i, mom;

	// parse inputs into real moments and query their ambig flags
	for (i = 0; i < len; i++) {
		mom = inputs[i];
		if (!confimoment.isMoment(mom)) {
			mom = FC.confimoment.parseZone(mom);
		}
		anyAmbigTime = anyAmbigTime || mom._ambigTime;
		anyAmbigZone = anyAmbigZone || mom._ambigZone;
		moms.push(mom);
	}

	// strip each moment down to lowest common ambiguity
	// use clones to avoid modifying the original moments
	for (i = 0; i < len; i++) {
		mom = moms[i];
		if (!preserveTime && anyAmbigTime && !mom._ambigTime) {
			moms[i] = mom.clone().stripTime();
		}
		else if (anyAmbigZone && !mom._ambigZone) {
			moms[i] = mom.clone().stripZone();
		}
	}

	return moms;
}

// Transfers all the flags related to ambiguous time/zone from the `src` moment to the `dest` moment
// TODO: look into moment.momentProperties for this.
function transferAmbigs(src, dest) {
	if (src._ambigTime) {
		dest._ambigTime = true;
	}
	else if (dest._ambigTime) {
		dest._ambigTime = false;
	}

	if (src._ambigZone) {
		dest._ambigZone = true;
	}
	else if (dest._ambigZone) {
		dest._ambigZone = false;
	}
}


// Sets the year/month/date/etc values of the moment from the given array.
// Inefficient because it calls each individual setter.
function setMomentValues(mom, a) {
	mom.year(a[0] || 0)
		.month(a[1] || 0)
		.date(a[2] || 0)
		.hours(a[3] || 0)
		.minutes(a[4] || 0)
		.seconds(a[5] || 0)
		.milliseconds(a[6] || 0);
}

// Can we set the moment's internal date directly?
allowValueOptimization = '_d' in confimoment() && 'updateOffset' in confimoment;

// Utility function. Accepts a moment and an array of the UTC year/month/date/etc values to set.
// Assumes the given moment is already in UTC mode.
setUTCValues = allowValueOptimization ? function(mom, a) {
	// simlate what moment's accessors do
	mom._d.setTime(Date.UTC.apply(Date, a));
	confimoment.updateOffset(mom, false); // keepTime=false
} : setMomentValues;

// Utility function. Accepts a moment and an array of the local year/month/date/etc values to set.
// Assumes the given moment is already in local mode.
setLocalValues = allowValueOptimization ? function(mom, a) {
	// simlate what moment's accessors do
	mom._d.setTime(+new Date( // FYI, there is now way to apply an array of args to a constructor
		a[0] || 0,
		a[1] || 0,
		a[2] || 0,
		a[3] || 0,
		a[4] || 0,
		a[5] || 0,
		a[6] || 0
	));
	confimoment.updateOffset(mom, false); // keepTime=false
} : setMomentValues;

;;

// Single Date Formatting
// -------------------------------------------------------------------------------------------------


// call this if you want Moment's original format method to be used
function oldMomentFormat(mom, formatStr) {
	return oldMomentProto.format.call(mom, formatStr); // oldMomentProto defined in moment-ext.js
}


// Formats `date` with a Moment formatting string, but allow our non-zero areas and
// additional token.
function formatDate(date, formatStr) {
	return formatDateWithChunks(date, getFormatStringChunks(formatStr));
}


function formatDateWithChunks(date, chunks) {
	var s = '';
	var i;

	for (i=0; i<chunks.length; i++) {
		s += formatDateWithChunk(date, chunks[i]);
	}

	return s;
}


// addition formatting tokens we want recognized
var tokenOverrides = {
	t: function(date) { // "a" or "p"
		return oldMomentFormat(date, 'a').charAt(0);
	},
	T: function(date) { // "A" or "P"
		return oldMomentFormat(date, 'A').charAt(0);
	}
};


function formatDateWithChunk(date, chunk) {
	var token;
	var maybeStr;

	if (typeof chunk === 'string') { // a literal string
		return chunk;
	}
	else if ((token = chunk.token)) { // a token, like "YYYY"
		if (tokenOverrides[token]) {
			return tokenOverrides[token](date); // use our custom token
		}
		return oldMomentFormat(date, token);
	}
	else if (chunk.maybe) { // a grouping of other chunks that must be non-zero
		maybeStr = formatDateWithChunks(date, chunk.maybe);
		if (maybeStr.match(/[1-9]/)) {
			return maybeStr;
		}
	}

	return '';
}


// Date Range Formatting
// -------------------------------------------------------------------------------------------------
// TODO: make it work with timezone offset

// Using a formatting string meant for a single date, generate a range string, like
// "Sep 2 - 9 2013", that intelligently inserts a separator where the dates differ.
// If the dates are the same as far as the format string is concerned, just return a single
// rendering of one date, without any separator.
function formatRange(date1, date2, formatStr, separator, isRTL) {
	var localeData;

	date1 = FC.confimoment.parseZone(date1);
	date2 = FC.confimoment.parseZone(date2);

	localeData = (date1.localeData || date1.lang).call(date1); // works with moment-pre-2.8

	// Expand localized format strings, like "LL" -> "MMMM D YYYY"
	formatStr = localeData.longDateFormat(formatStr) || formatStr;
	// BTW, this is not important for `formatDate` because it is impossible to put custom tokens
	// or non-zero areas in Moment's localized format strings.

	separator = separator || ' - ';

	return formatRangeWithChunks(
		date1,
		date2,
		getFormatStringChunks(formatStr),
		separator,
		isRTL
	);
}
FC.formatRange = formatRange; // expose


function formatRangeWithChunks(date1, date2, chunks, separator, isRTL) {
	var unzonedDate1 = date1.clone().stripZone(); // for formatSimilarChunk
	var unzonedDate2 = date2.clone().stripZone(); // "
	var chunkStr; // the rendering of the chunk
	var leftI;
	var leftStr = '';
	var rightI;
	var rightStr = '';
	var middleI;
	var middleStr1 = '';
	var middleStr2 = '';
	var middleStr = '';

	// Start at the leftmost side of the formatting string and continue until you hit a token
	// that is not the same between dates.
	for (leftI=0; leftI<chunks.length; leftI++) {
		chunkStr = formatSimilarChunk(date1, date2, unzonedDate1, unzonedDate2, chunks[leftI]);
		if (chunkStr === false) {
			break;
		}
		leftStr += chunkStr;
	}

	// Similarly, start at the rightmost side of the formatting string and move left
	for (rightI=chunks.length-1; rightI>leftI; rightI--) {
		chunkStr = formatSimilarChunk(date1, date2, unzonedDate1, unzonedDate2,  chunks[rightI]);
		if (chunkStr === false) {
			break;
		}
		rightStr = chunkStr + rightStr;
	}

	// The area in the middle is different for both of the dates.
	// Collect them distinctly so we can jam them together later.
	for (middleI=leftI; middleI<=rightI; middleI++) {
		middleStr1 += formatDateWithChunk(date1, chunks[middleI]);
		middleStr2 += formatDateWithChunk(date2, chunks[middleI]);
	}

	if (middleStr1 || middleStr2) {
		if (isRTL) {
			middleStr = middleStr2 + separator + middleStr1;
		}
		else {
			middleStr = middleStr1 + separator + middleStr2;
		}
	}

	return leftStr + middleStr + rightStr;
}


var similarUnitMap = {
	Y: 'year',
	M: 'month',
	D: 'day', // day of month
	d: 'day', // day of week
	// prevents a separator between anything time-related...
	A: 'second', // AM/PM
	a: 'second', // am/pm
	T: 'second', // A/P
	t: 'second', // a/p
	H: 'second', // hour (24)
	h: 'second', // hour (12)
	m: 'second', // minute
	s: 'second' // second
};
// TODO: week maybe?


// Given a formatting chunk, and given that both dates are similar in the regard the
// formatting chunk is concerned, format date1 against `chunk`. Otherwise, return `false`.
function formatSimilarChunk(date1, date2, unzonedDate1, unzonedDate2, chunk) {
	var token;
	var unit;

	if (typeof chunk === 'string') { // a literal string
		return chunk;
	}
	else if ((token = chunk.token)) {
		unit = similarUnitMap[token.charAt(0)];

		// are the dates the same for this unit of measurement?
		// use the unzoned dates for this calculation because unreliable when near DST (bug #2396)
		if (unit && unzonedDate1.isSame(unzonedDate2, unit)) {
			return oldMomentFormat(date1, token); // would be the same if we used `date2`
			// BTW, don't support custom tokens
		}
	}

	return false; // the chunk is NOT the same for the two dates
	// BTW, don't support splitting on non-zero areas
}


// Chunking Utils
// -------------------------------------------------------------------------------------------------


var formatStringChunkCache = {};


function getFormatStringChunks(formatStr) {
	if (formatStr in formatStringChunkCache) {
		return formatStringChunkCache[formatStr];
	}
	return (formatStringChunkCache[formatStr] = chunkFormatString(formatStr));
}


// Break the formatting string into an array of chunks
function chunkFormatString(formatStr) {
	var chunks = [];
	var chunker = /\[([^\]]*)\]|\(([^\)]*)\)|(LTS|LT|(\w)\4*o?)|([^\w\[\(]+)/g; // TODO: more descrimination
	var match;

	while ((match = chunker.exec(formatStr))) {
		if (match[1]) { // a literal string inside [ ... ]
			chunks.push(match[1]);
		}
		else if (match[2]) { // non-zero formatting inside ( ... )
			chunks.push({ maybe: chunkFormatString(match[2]) });
		}
		else if (match[3]) { // a formatting token
			chunks.push({ token: match[3] });
		}
		else if (match[5]) { // an unenclosed literal string
			chunks.push(match[5]);
		}
	}

	return chunks;
}

;;

FC.Class = Class; // export

// Class that all other classes will inherit from
function Class() { }


// Called on a class to create a subclass.
// Last argument contains instance methods. Any argument before the last are considered mixins.
Class.extend = function() {
	var len = arguments.length;
	var i;
	var members;

	for (i = 0; i < len; i++) {
		members = arguments[i];
		if (i < len - 1) { // not the last argument?
			mixIntoClass(this, members);
		}
	}

	return extendClass(this, members || {}); // members will be undefined if no arguments
};


// Adds new member variables/methods to the class's prototype.
// Can be called with another class, or a plain object hash containing new members.
Class.mixin = function(members) {
	mixIntoClass(this, members);
};


function extendClass(superClass, members) {
	var subClass;

	// ensure a constructor for the subclass, forwarding all arguments to the super-constructor if it doesn't exist
	if (hasOwnProp(members, 'constructor')) {
		subClass = members.constructor;
	}
	if (typeof subClass !== 'function') {
		subClass = members.constructor = function() {
			superClass.apply(this, arguments);
		};
	}

	// build the base prototype for the subclass, which is an new object chained to the superclass's prototype
	subClass.prototype = createObject(superClass.prototype);

	// copy each member variable/method onto the the subclass's prototype
	copyOwnProps(members, subClass.prototype);
	copyNativeMethods(members, subClass.prototype); // hack for IE8

	// copy over all class variables/methods to the subclass, such as `extend` and `mixin`
	copyOwnProps(superClass, subClass);

	return subClass;
}


function mixIntoClass(theClass, members) {
	copyOwnProps(members.prototype || members, theClass.prototype); // TODO: copyNativeMethods?
}
;;

var Emitter = FC.Emitter = Class.extend({

	callbackHash: null,


	on: function(name, callback) {
		this.getCallbacks(name).add(callback);
		return this; // for chaining
	},


	off: function(name, callback) {
		this.getCallbacks(name).remove(callback);
		return this; // for chaining
	},


	trigger: function(name) { // args...
		var args = Array.prototype.slice.call(arguments, 1);

		this.triggerWith(name, this, args);

		return this; // for chaining
	},


	triggerWith: function(name, context, args) {
		var callbacks = this.getCallbacks(name);

		callbacks.fireWith(context, args);

		return this; // for chaining
	},


	getCallbacks: function(name) {
		var callbacks;

		if (!this.callbackHash) {
			this.callbackHash = {};
		}

		callbacks = this.callbackHash[name];
		if (!callbacks) {
			callbacks = this.callbackHash[name] = $.Callbacks();
		}

		return callbacks;
	}

});
;;

/* A rectangular panel that is absolutely positioned over other content
------------------------------------------------------------------------------------------------------------------------
Options:
	- className (string)
	- content (HTML string or jQuery element set)
	- parentEl
	- top
	- left
	- right (the x coord of where the right edge should be. not a "CSS" right)
	- autoHide (boolean)
	- show (callback)
	- hide (callback)
*/

var Popover = Class.extend({

	isHidden: true,
	options: null,
	el: null, // the container element for the popover. generated by this object
	documentMousedownProxy: null, // document mousedown handler bound to `this`
	margin: 10, // the space required between the popover and the edges of the scroll container


	constructor: function(options) {
		this.options = options || {};
	},


	// Shows the popover on the specified position. Renders it if not already
	show: function() {
		if (this.isHidden) {
			if (!this.el) {
				this.render();
			}
			this.el.show();
			this.position();
			this.isHidden = false;
			this.trigger('show');
		}
	},


	// Hides the popover, through CSS, but does not remove it from the DOM
	hide: function() {
		if (!this.isHidden) {
			this.el.hide();
			this.isHidden = true;
			this.trigger('hide');
		}
	},


	// Creates `this.el` and renders content inside of it
	render: function() {
		var _this = this;
		var options = this.options;

		this.el = $('<div class="fc-popover"/>')
			.addClass(options.className || '')
			.css({
				// position initially to the top left to avoid creating scrollbars
				top: 0,
				left: 0
			})
			.append(options.content)
			.appendTo(options.parentEl);

		// when a click happens on anything inside with a 'fc-close' className, hide the popover
		this.el.on('click', '.fc-close', function() {
			_this.hide();
		});

		if (options.autoHide) {
			$(document).on('mousedown', this.documentMousedownProxy = proxy(this, 'documentMousedown'));
		}
	},


	// Triggered when the user clicks *anywhere* in the document, for the autoHide feature
	documentMousedown: function(ev) {
		// only hide the popover if the click happened outside the popover
		if (this.el && !$(ev.target).closest(this.el).length) {
			this.hide();
		}
	},


	// Hides and unregisters any handlers
	removeElement: function() {
		this.hide();

		if (this.el) {
			this.el.remove();
			this.el = null;
		}

		$(document).off('mousedown', this.documentMousedownProxy);
	},


	// Positions the popover optimally, using the top/left/right options
	position: function() {
		var options = this.options;
		var origin = this.el.offsetParent().offset();
		var width = this.el.outerWidth();
		var height = this.el.outerHeight();
		var windowEl = $(window);
		var viewportEl = getScrollParent(this.el);
		var viewportTop;
		var viewportLeft;
		var viewportOffset;
		var top; // the "position" (not "offset") values for the popover
		var left; //

		// compute top and left
		top = options.top || 0;
		if (options.left !== undefined) {
			left = options.left;
		}
		else if (options.right !== undefined) {
			left = options.right - width; // derive the left value from the right value
		}
		else {
			left = 0;
		}

		if (viewportEl.is(window) || viewportEl.is(document)) { // normalize getScrollParent's result
			viewportEl = windowEl;
			viewportTop = 0; // the window is always at the top left
			viewportLeft = 0; // (and .offset() won't work if called here)
		}
		else {
			viewportOffset = viewportEl.offset();
			viewportTop = viewportOffset.top;
			viewportLeft = viewportOffset.left;
		}

		// if the window is scrolled, it causes the visible area to be further down
		viewportTop += windowEl.scrollTop();
		viewportLeft += windowEl.scrollLeft();

		// constrain to the view port. if constrained by two edges, give precedence to top/left
		if (options.viewportConstrain !== false) {
			top = Math.min(top, viewportTop + viewportEl.outerHeight() - height - this.margin);
			top = Math.max(top, viewportTop + this.margin);
			left = Math.min(left, viewportLeft + viewportEl.outerWidth() - width - this.margin);
			left = Math.max(left, viewportLeft + this.margin);
		}

		this.el.css({
			top: top - origin.top,
			left: left - origin.left
		});
	},


	// Triggers a callback. Calls a function in the option hash of the same name.
	// Arguments beyond the first `name` are forwarded on.
	// TODO: better code reuse for this. Repeat code
	trigger: function(name) {
		if (this.options[name]) {
			this.options[name].apply(this, Array.prototype.slice.call(arguments, 1));
		}
	}

});

;;

/*
A cache for the left/right/top/bottom/width/height values for one or more elements.
Works with both offset (from topleft document) and position (from offsetParent).

options:
- els
- isHorizontal
- isVertical
*/
var CoordCache = FC.CoordCache = Class.extend({

	els: null, // jQuery set (assumed to be siblings)
	forcedOffsetParentEl: null, // options can override the natural offsetParent
	origin: null, // {left,top} position of offsetParent of els
	boundingRect: null, // constrain cordinates to this rectangle. {left,right,top,bottom} or null
	isHorizontal: false, // whether to query for left/right/width
	isVertical: false, // whether to query for top/bottom/height

	// arrays of coordinates (offsets from topleft of document)
	lefts: null,
	rights: null,
	tops: null,
	bottoms: null,


	constructor: function(options) {
		this.els = $(options.els);
		this.isHorizontal = options.isHorizontal;
		this.isVertical = options.isVertical;
		this.forcedOffsetParentEl = options.offsetParent ? $(options.offsetParent) : null;
	},


	// Queries the els for coordinates and stores them.
	// Call this method before using and of the get* methods below.
	build: function() {
		var offsetParentEl = this.forcedOffsetParentEl || this.els.eq(0).offsetParent();

		this.origin = offsetParentEl.offset();
		this.boundingRect = this.queryBoundingRect();

		if (this.isHorizontal) {
			this.buildElHorizontals();
		}
		if (this.isVertical) {
			this.buildElVerticals();
		}
	},


	// Destroys all internal data about coordinates, freeing memory
	clear: function() {
		this.origin = null;
		this.boundingRect = null;
		this.lefts = null;
		this.rights = null;
		this.tops = null;
		this.bottoms = null;
	},


	// Compute and return what the elements' bounding rectangle is, from the user's perspective.
	// Right now, only returns a rectangle if constrained by an overflow:scroll element.
	queryBoundingRect: function() {
		var scrollParentEl = getScrollParent(this.els.eq(0));

		if (!scrollParentEl.is(document)) {
			return getClientRect(scrollParentEl);
		}
	},


	// Populates the left/right internal coordinate arrays
	buildElHorizontals: function() {
		var lefts = [];
		var rights = [];

		this.els.each(function(i, node) {
			var el = $(node);
			var left = el.offset().left;
			var width = el.outerWidth();

			lefts.push(left);
			rights.push(left + width);
		});

		this.lefts = lefts;
		this.rights = rights;
	},


	// Populates the top/bottom internal coordinate arrays
	buildElVerticals: function() {
		var tops = [];
		var bottoms = [];

		this.els.each(function(i, node) {
			var el = $(node);
			var top = el.offset().top;
			var height = el.outerHeight();

			tops.push(top);
			bottoms.push(top + height);
		});

		this.tops = tops;
		this.bottoms = bottoms;
	},


	// Given a left offset (from document left), returns the index of the el that it horizontally intersects.
	// If no intersection is made, or outside of the boundingRect, returns undefined.
	getHorizontalIndex: function(leftOffset) {
		var boundingRect = this.boundingRect;
		var lefts = this.lefts;
		var rights = this.rights;
		var len = lefts.length;
		var i;

		if (!boundingRect || (leftOffset >= boundingRect.left && leftOffset < boundingRect.right)) {
			for (i = 0; i < len; i++) {
				if (leftOffset >= lefts[i] && leftOffset < rights[i]) {
					return i;
				}
			}
		}
	},


	// Given a top offset (from document top), returns the index of the el that it vertically intersects.
	// If no intersection is made, or outside of the boundingRect, returns undefined.
	getVerticalIndex: function(topOffset) {
		var boundingRect = this.boundingRect;
		var tops = this.tops;
		var bottoms = this.bottoms;
		var len = tops.length;
		var i;

		if (!boundingRect || (topOffset >= boundingRect.top && topOffset < boundingRect.bottom)) {
			for (i = 0; i < len; i++) {
				if (topOffset >= tops[i] && topOffset < bottoms[i]) {
					return i;
				}
			}
		}
	},


	// Gets the left offset (from document left) of the element at the given index
	getLeftOffset: function(leftIndex) {
		return this.lefts[leftIndex];
	},


	// Gets the left position (from offsetParent left) of the element at the given index
	getLeftPosition: function(leftIndex) {
		return this.lefts[leftIndex] - this.origin.left;
	},


	// Gets the right offset (from document left) of the element at the given index.
	// This value is NOT relative to the document's right edge, like the CSS concept of "right" would be.
	getRightOffset: function(leftIndex) {
		return this.rights[leftIndex];
	},


	// Gets the right position (from offsetParent left) of the element at the given index.
	// This value is NOT relative to the offsetParent's right edge, like the CSS concept of "right" would be.
	getRightPosition: function(leftIndex) {
		return this.rights[leftIndex] - this.origin.left;
	},


	// Gets the width of the element at the given index
	getWidth: function(leftIndex) {
		return this.rights[leftIndex] - this.lefts[leftIndex];
	},


	// Gets the top offset (from document top) of the element at the given index
	getTopOffset: function(topIndex) {
		return this.tops[topIndex];
	},


	// Gets the top position (from offsetParent top) of the element at the given position
	getTopPosition: function(topIndex) {
		return this.tops[topIndex] - this.origin.top;
	},

	// Gets the bottom offset (from the document top) of the element at the given index.
	// This value is NOT relative to the offsetParent's bottom edge, like the CSS concept of "bottom" would be.
	getBottomOffset: function(topIndex) {
		return this.bottoms[topIndex];
	},


	// Gets the bottom position (from the offsetParent top) of the element at the given index.
	// This value is NOT relative to the offsetParent's bottom edge, like the CSS concept of "bottom" would be.
	getBottomPosition: function(topIndex) {
		return this.bottoms[topIndex] - this.origin.top;
	},


	// Gets the height of the element at the given index
	getHeight: function(topIndex) {
		return this.bottoms[topIndex] - this.tops[topIndex];
	}

});

;;

/* Tracks a drag's mouse movement, firing various handlers
----------------------------------------------------------------------------------------------------------------------*/
// TODO: use Emitter

var DragListener = FC.DragListener = Class.extend({

	options: null,

	isListening: false,
	isDragging: false,

	// coordinates of the initial mousedown
	originX: null,
	originY: null,

	// handler attached to the document, bound to the DragListener's `this`
	mousemoveProxy: null,
	mouseupProxy: null,

	// for IE8 bug-fighting behavior, for now
	subjectEl: null, // the element being draged. optional
	subjectHref: null,

	scrollEl: null,
	scrollBounds: null, // { top, bottom, left, right }
	scrollTopVel: null, // pixels per second
	scrollLeftVel: null, // pixels per second
	scrollIntervalId: null, // ID of setTimeout for scrolling animation loop
	scrollHandlerProxy: null, // this-scoped function for handling when scrollEl is scrolled

	scrollSensitivity: 30, // pixels from edge for scrolling to start
	scrollSpeed: 200, // pixels per second, at maximum speed
	scrollIntervalMs: 50, // millisecond wait between scroll increment


	constructor: function(options) {
		options = options || {};
		this.options = options;
		this.subjectEl = options.subjectEl;
	},


	// Call this when the user does a mousedown. Will probably lead to startListening
	mousedown: function(ev) {
		if (isPrimaryMouseButton(ev)) {

			ev.preventDefault(); // prevents native selection in most browsers

			this.startListening(ev);

			// start the drag immediately if there is no minimum distance for a drag start
			if (!this.options.distance) {
				this.startDrag(ev);
			}
		}
	},


	// Call this to start tracking mouse movements
	startListening: function(ev) {
		var scrollParent;

		if (!this.isListening) {

			// grab scroll container and attach handler
			if (ev && this.options.scroll) {
				scrollParent = getScrollParent($(ev.target));
				if (!scrollParent.is(window) && !scrollParent.is(document)) {
					this.scrollEl = scrollParent;

					// scope to `this`, and use `debounce` to make sure rapid calls don't happen
					this.scrollHandlerProxy = debounce(proxy(this, 'scrollHandler'), 100);
					this.scrollEl.on('scroll', this.scrollHandlerProxy);
				}
			}

			$(document)
				.on('mousemove', this.mousemoveProxy = proxy(this, 'mousemove'))
				.on('mouseup', this.mouseupProxy = proxy(this, 'mouseup'))
				.on('selectstart', this.preventDefault); // prevents native selection in IE<=8

			if (ev) {
				this.originX = ev.pageX;
				this.originY = ev.pageY;
			}
			else {
				// if no starting information was given, origin will be the topleft corner of the screen.
				// if so, dx/dy in the future will be the absolute coordinates.
				this.originX = 0;
				this.originY = 0;
			}

			this.isListening = true;
			this.listenStart(ev);
		}
	},


	// Called when drag listening has started (but a real drag has not necessarily began)
	listenStart: function(ev) {
		this.trigger('listenStart', ev);
	},


	// Called when the user moves the mouse
	mousemove: function(ev) {
		var dx = ev.pageX - this.originX;
		var dy = ev.pageY - this.originY;
		var minDistance;
		var distanceSq; // current distance from the origin, squared

		if (!this.isDragging) { // if not already dragging...
			// then start the drag if the minimum distance criteria is met
			minDistance = this.options.distance || 1;
			distanceSq = dx * dx + dy * dy;
			if (distanceSq >= minDistance * minDistance) { // use pythagorean theorem
				this.startDrag(ev);
			}
		}

		if (this.isDragging) {
			this.drag(dx, dy, ev); // report a drag, even if this mousemove initiated the drag
		}
	},


	// Call this to initiate a legitimate drag.
	// This function is called internally from this class, but can also be called explicitly from outside
	startDrag: function(ev) {

		if (!this.isListening) { // startDrag must have manually initiated
			this.startListening();
		}

		if (!this.isDragging) {
			this.isDragging = true;
			this.dragStart(ev);
		}
	},


	// Called when the actual drag has started (went beyond minDistance)
	dragStart: function(ev) {
		var subjectEl = this.subjectEl;

		this.trigger('dragStart', ev);

		// remove a mousedown'd <a>'s href so it is not visited (IE8 bug)
		if ((this.subjectHref = subjectEl ? subjectEl.attr('href') : null)) {
			subjectEl.removeAttr('href');
		}
	},


	// Called while the mouse is being moved and when we know a legitimate drag is taking place
	drag: function(dx, dy, ev) {
		this.trigger('drag', dx, dy, ev);
		this.updateScroll(ev); // will possibly cause scrolling
	},


	// Called when the user does a mouseup
	mouseup: function(ev) {
		this.stopListening(ev);
	},


	// Called when the drag is over. Will not cause listening to stop however.
	// A concluding 'cellOut' event will NOT be triggered.
	stopDrag: function(ev) {
		if (this.isDragging) {
			this.stopScrolling();
			this.dragStop(ev);
			this.isDragging = false;
		}
	},


	// Called when dragging has been stopped
	dragStop: function(ev) {
		var _this = this;

		this.trigger('dragStop', ev);

		// restore a mousedown'd <a>'s href (for IE8 bug)
		setTimeout(function() { // must be outside of the click's execution
			if (_this.subjectHref) {
				_this.subjectEl.attr('href', _this.subjectHref);
			}
		}, 0);
	},


	// Call this to stop listening to the user's mouse events
	stopListening: function(ev) {
		this.stopDrag(ev); // if there's a current drag, kill it

		if (this.isListening) {

			// remove the scroll handler if there is a scrollEl
			if (this.scrollEl) {
				this.scrollEl.off('scroll', this.scrollHandlerProxy);
				this.scrollHandlerProxy = null;
			}

			$(document)
				.off('mousemove', this.mousemoveProxy)
				.off('mouseup', this.mouseupProxy)
				.off('selectstart', this.preventDefault);

			this.mousemoveProxy = null;
			this.mouseupProxy = null;

			this.isListening = false;
			this.listenStop(ev);
		}
	},


	// Called when drag listening has stopped
	listenStop: function(ev) {
		this.trigger('listenStop', ev);
	},


	// Triggers a callback. Calls a function in the option hash of the same name.
	// Arguments beyond the first `name` are forwarded on.
	trigger: function(name) {
		if (this.options[name]) {
			this.options[name].apply(this, Array.prototype.slice.call(arguments, 1));
		}
	},


	// Stops a given mouse event from doing it's native browser action. In our case, text selection.
	preventDefault: function(ev) {
		ev.preventDefault();
	},


	/* Scrolling
	------------------------------------------------------------------------------------------------------------------*/


	// Computes and stores the bounding rectangle of scrollEl
	computeScrollBounds: function() {
		var el = this.scrollEl;

		this.scrollBounds = el ? getOuterRect(el) : null;
			// TODO: use getClientRect in future. but prevents auto scrolling when on top of scrollbars
	},


	// Called when the dragging is in progress and scrolling should be updated
	updateScroll: function(ev) {
		var sensitivity = this.scrollSensitivity;
		var bounds = this.scrollBounds;
		var topCloseness, bottomCloseness;
		var leftCloseness, rightCloseness;
		var topVel = 0;
		var leftVel = 0;

		if (bounds) { // only scroll if scrollEl exists

			// compute closeness to edges. valid range is from 0.0 - 1.0
			topCloseness = (sensitivity - (ev.pageY - bounds.top)) / sensitivity;
			bottomCloseness = (sensitivity - (bounds.bottom - ev.pageY)) / sensitivity;
			leftCloseness = (sensitivity - (ev.pageX - bounds.left)) / sensitivity;
			rightCloseness = (sensitivity - (bounds.right - ev.pageX)) / sensitivity;

			// translate vertical closeness into velocity.
			// mouse must be completely in bounds for velocity to happen.
			if (topCloseness >= 0 && topCloseness <= 1) {
				topVel = topCloseness * this.scrollSpeed * -1; // negative. for scrolling up
			}
			else if (bottomCloseness >= 0 && bottomCloseness <= 1) {
				topVel = bottomCloseness * this.scrollSpeed;
			}

			// translate horizontal closeness into velocity
			if (leftCloseness >= 0 && leftCloseness <= 1) {
				leftVel = leftCloseness * this.scrollSpeed * -1; // negative. for scrolling left
			}
			else if (rightCloseness >= 0 && rightCloseness <= 1) {
				leftVel = rightCloseness * this.scrollSpeed;
			}
		}

		this.setScrollVel(topVel, leftVel);
	},


	// Sets the speed-of-scrolling for the scrollEl
	setScrollVel: function(topVel, leftVel) {

		this.scrollTopVel = topVel;
		this.scrollLeftVel = leftVel;

		this.constrainScrollVel(); // massages into realistic values

		// if there is non-zero velocity, and an animation loop hasn't already started, then START
		if ((this.scrollTopVel || this.scrollLeftVel) && !this.scrollIntervalId) {
			this.scrollIntervalId = setInterval(
				proxy(this, 'scrollIntervalFunc'), // scope to `this`
				this.scrollIntervalMs
			);
		}
	},


	// Forces scrollTopVel and scrollLeftVel to be zero if scrolling has already gone all the way
	constrainScrollVel: function() {
		var el = this.scrollEl;

		if (this.scrollTopVel < 0) { // scrolling up?
			if (el.scrollTop() <= 0) { // already scrolled all the way up?
				this.scrollTopVel = 0;
			}
		}
		else if (this.scrollTopVel > 0) { // scrolling down?
			if (el.scrollTop() + el[0].clientHeight >= el[0].scrollHeight) { // already scrolled all the way down?
				this.scrollTopVel = 0;
			}
		}

		if (this.scrollLeftVel < 0) { // scrolling left?
			if (el.scrollLeft() <= 0) { // already scrolled all the left?
				this.scrollLeftVel = 0;
			}
		}
		else if (this.scrollLeftVel > 0) { // scrolling right?
			if (el.scrollLeft() + el[0].clientWidth >= el[0].scrollWidth) { // already scrolled all the way right?
				this.scrollLeftVel = 0;
			}
		}
	},


	// This function gets called during every iteration of the scrolling animation loop
	scrollIntervalFunc: function() {
		var el = this.scrollEl;
		var frac = this.scrollIntervalMs / 1000; // considering animation frequency, what the vel should be mult'd by

		// change the value of scrollEl's scroll
		if (this.scrollTopVel) {
			el.scrollTop(el.scrollTop() + this.scrollTopVel * frac);
		}
		if (this.scrollLeftVel) {
			el.scrollLeft(el.scrollLeft() + this.scrollLeftVel * frac);
		}

		this.constrainScrollVel(); // since the scroll values changed, recompute the velocities

		// if scrolled all the way, which causes the vels to be zero, stop the animation loop
		if (!this.scrollTopVel && !this.scrollLeftVel) {
			this.stopScrolling();
		}
	},


	// Kills any existing scrolling animation loop
	stopScrolling: function() {
		if (this.scrollIntervalId) {
			clearInterval(this.scrollIntervalId);
			this.scrollIntervalId = null;

			// when all done with scrolling, recompute positions since they probably changed
			this.scrollStop();
		}
	},


	// Get called when the scrollEl is scrolled (NOTE: this is delayed via debounce)
	scrollHandler: function() {
		// recompute all coordinates, but *only* if this is *not* part of our scrolling animation
		if (!this.scrollIntervalId) {
			this.scrollStop();
		}
	},


	// Called when scrolling has stopped, whether through auto scroll, or the user scrolling
	scrollStop: function() {
	}

});

;;

/* Tracks mouse movements over a component and raises events about which hit the mouse is over.
------------------------------------------------------------------------------------------------------------------------
options:
- subjectEl
- subjectCenter
*/

var HitDragListener = DragListener.extend({

	component: null, // converts coordinates to hits
		// methods: prepareHits, releaseHits, queryHit

	origHit: null, // the hit the mouse was over when listening started
	hit: null, // the hit the mouse is over
	coordAdjust: null, // delta that will be added to the mouse coordinates when computing collisions


	constructor: function(component, options) {
		DragListener.call(this, options); // call the super-constructor

		this.component = component;
	},


	// Called when drag listening starts (but a real drag has not necessarily began).
	// ev might be undefined if dragging was started manually.
	listenStart: function(ev) {
		var subjectEl = this.subjectEl;
		var subjectRect;
		var origPoint;
		var point;

		DragListener.prototype.listenStart.apply(this, arguments); // call the super-method

		this.computeCoords();

		if (ev) {
			origPoint = { left: ev.pageX, top: ev.pageY };
			point = origPoint;

			// constrain the point to bounds of the element being dragged
			if (subjectEl) {
				subjectRect = getOuterRect(subjectEl); // used for centering as well
				point = constrainPoint(point, subjectRect);
			}

			this.origHit = this.queryHit(point.left, point.top);

			// treat the center of the subject as the collision point?
			if (subjectEl && this.options.subjectCenter) {

				// only consider the area the subject overlaps the hit. best for large subjects.
				// TODO: skip this if hit didn't supply left/right/top/bottom
				if (this.origHit) {
					subjectRect = intersectRects(this.origHit, subjectRect) ||
						subjectRect; // in case there is no intersection
				}

				point = getRectCenter(subjectRect);
			}

			this.coordAdjust = diffPoints(point, origPoint); // point - origPoint
		}
		else {
			this.origHit = null;
			this.coordAdjust = null;
		}
	},


	// Recomputes the drag-critical positions of elements
	computeCoords: function() {
		this.component.prepareHits();
		this.computeScrollBounds(); // why is this here???
	},


	// Called when the actual drag has started
	dragStart: function(ev) {
		var hit;

		DragListener.prototype.dragStart.apply(this, arguments); // call the super-method

		// might be different from this.origHit if the min-distance is large
		hit = this.queryHit(ev.pageX, ev.pageY);

		// report the initial hit the mouse is over
		// especially important if no min-distance and drag starts immediately
		if (hit) {
			this.hitOver(hit);
		}
	},


	// Called when the drag moves
	drag: function(dx, dy, ev) {
		var hit;

		DragListener.prototype.drag.apply(this, arguments); // call the super-method

		hit = this.queryHit(ev.pageX, ev.pageY);

		if (!isHitsEqual(hit, this.hit)) { // a different hit than before?
			if (this.hit) {
				this.hitOut();
			}
			if (hit) {
				this.hitOver(hit);
			}
		}
	},


	// Called when dragging has been stopped
	dragStop: function() {
		this.hitDone();
		DragListener.prototype.dragStop.apply(this, arguments); // call the super-method
	},


	// Called when a the mouse has just moved over a new hit
	hitOver: function(hit) {
		var isOrig = isHitsEqual(hit, this.origHit);

		this.hit = hit;

		this.trigger('hitOver', this.hit, isOrig, this.origHit);
	},


	// Called when the mouse has just moved out of a hit
	hitOut: function() {
		if (this.hit) {
			this.trigger('hitOut', this.hit);
			this.hitDone();
			this.hit = null;
		}
	},


	// Called after a hitOut. Also called before a dragStop
	hitDone: function() {
		if (this.hit) {
			this.trigger('hitDone', this.hit);
		}
	},


	// Called when drag listening has stopped
	listenStop: function() {
		DragListener.prototype.listenStop.apply(this, arguments); // call the super-method

		this.origHit = null;
		this.hit = null;

		this.component.releaseHits();
	},


	// Called when scrolling has stopped, whether through auto scroll, or the user scrolling
	scrollStop: function() {
		DragListener.prototype.scrollStop.apply(this, arguments); // call the super-method

		this.computeCoords(); // hits' absolute positions will be in new places. recompute
	},


	// Gets the hit underneath the coordinates for the given mouse event
	queryHit: function(left, top) {

		if (this.coordAdjust) {
			left += this.coordAdjust.left;
			top += this.coordAdjust.top;
		}

		return this.component.queryHit(left, top);
	}

});


// Returns `true` if the hits are identically equal. `false` otherwise. Must be from the same component.
// Two null values will be considered equal, as two "out of the component" states are the same.
function isHitsEqual(hit0, hit1) {

	if (!hit0 && !hit1) {
		return true;
	}

	if (hit0 && hit1) {
		return hit0.component === hit1.component &&
			isHitPropsWithin(hit0, hit1) &&
			isHitPropsWithin(hit1, hit0); // ensures all props are identical
	}

	return false;
}


// Returns true if all of subHit's non-standard properties are within superHit
function isHitPropsWithin(subHit, superHit) {
	for (var propName in subHit) {
		if (!/^(component|left|right|top|bottom)$/.test(propName)) {
			if (subHit[propName] !== superHit[propName]) {
				return false;
			}
		}
	}
	return true;
}

;;

/* Creates a clone of an element and lets it track the mouse as it moves
----------------------------------------------------------------------------------------------------------------------*/

var MouseFollower = Class.extend({

	options: null,

	sourceEl: null, // the element that will be cloned and made to look like it is dragging
	el: null, // the clone of `sourceEl` that will track the mouse
	parentEl: null, // the element that `el` (the clone) will be attached to

	// the initial position of el, relative to the offset parent. made to match the initial offset of sourceEl
	top0: null,
	left0: null,

	// the initial position of the mouse
	mouseY0: null,
	mouseX0: null,

	// the number of pixels the mouse has moved from its initial position
	topDelta: null,
	leftDelta: null,

	mousemoveProxy: null, // document mousemove handler, bound to the MouseFollower's `this`

	isFollowing: false,
	isHidden: false,
	isAnimating: false, // doing the revert animation?

	constructor: function(sourceEl, options) {
		this.options = options = options || {};
		this.sourceEl = sourceEl;
		this.parentEl = options.parentEl ? $(options.parentEl) : sourceEl.parent(); // default to sourceEl's parent
	},


	// Causes the element to start following the mouse
	start: function(ev) {
		if (!this.isFollowing) {
			this.isFollowing = true;

			this.mouseY0 = ev.pageY;
			this.mouseX0 = ev.pageX;
			this.topDelta = 0;
			this.leftDelta = 0;

			if (!this.isHidden) {
				this.updatePosition();
			}

			$(document).on('mousemove', this.mousemoveProxy = proxy(this, 'mousemove'));
		}
	},


	// Causes the element to stop following the mouse. If shouldRevert is true, will animate back to original position.
	// `callback` gets invoked when the animation is complete. If no animation, it is invoked immediately.
	stop: function(shouldRevert, callback) {
		var _this = this;
		var revertDuration = this.options.revertDuration;

		function complete() {
			this.isAnimating = false;
			_this.removeElement();

			this.top0 = this.left0 = null; // reset state for future updatePosition calls

			if (callback) {
				callback();
			}
		}

		if (this.isFollowing && !this.isAnimating) { // disallow more than one stop animation at a time
			this.isFollowing = false;

			$(document).off('mousemove', this.mousemoveProxy);

			if (shouldRevert && revertDuration && !this.isHidden) { // do a revert animation?
				this.isAnimating = true;
				this.el.animate({
					top: this.top0,
					left: this.left0
				}, {
					duration: revertDuration,
					complete: complete
				});
			}
			else {
				complete();
			}
		}
	},


	// Gets the tracking element. Create it if necessary
	getEl: function() {
		var el = this.el;

		if (!el) {
			this.sourceEl.width(); // hack to force IE8 to compute correct bounding box
			el = this.el = this.sourceEl.clone()
				.css({
					position: 'absolute',
					visibility: '', // in case original element was hidden (commonly through hideEvents())
					display: this.isHidden ? 'none' : '', // for when initially hidden
					margin: 0,
					right: 'auto', // erase and set width instead
					bottom: 'auto', // erase and set height instead
					width: this.sourceEl.width(), // explicit height in case there was a 'right' value
					height: this.sourceEl.height(), // explicit width in case there was a 'bottom' value
					opacity: this.options.opacity || '',
					zIndex: this.options.zIndex
				})
				.appendTo(this.parentEl);
		}

		return el;
	},


	// Removes the tracking element if it has already been created
	removeElement: function() {
		if (this.el) {
			this.el.remove();
			this.el = null;
		}
	},


	// Update the CSS position of the tracking element
	updatePosition: function() {
		var sourceOffset;
		var origin;

		this.getEl(); // ensure this.el

		// make sure origin info was computed
		if (this.top0 === null) {
			this.sourceEl.width(); // hack to force IE8 to compute correct bounding box
			sourceOffset = this.sourceEl.offset();
			origin = this.el.offsetParent().offset();
			this.top0 = sourceOffset.top - origin.top;
			this.left0 = sourceOffset.left - origin.left;
		}

		this.el.css({
			top: this.top0 + this.topDelta,
			left: this.left0 + this.leftDelta
		});
	},


	// Gets called when the user moves the mouse
	mousemove: function(ev) {
		this.topDelta = ev.pageY - this.mouseY0;
		this.leftDelta = ev.pageX - this.mouseX0;

		if (!this.isHidden) {
			this.updatePosition();
		}
	},


	// Temporarily makes the tracking element invisible. Can be called before following starts
	hide: function() {
		if (!this.isHidden) {
			this.isHidden = true;
			if (this.el) {
				this.el.hide();
			}
		}
	},


	// Show the tracking element after it has been temporarily hidden
	show: function() {
		if (this.isHidden) {
			this.isHidden = false;
			this.updatePosition();
			this.getEl().show();
		}
	}

});

;;

/* An abstract class comprised of a "grid" of areas that each represent a specific datetime
----------------------------------------------------------------------------------------------------------------------*/

var Grid = FC.Grid = Class.extend({

	view: null, // a View object
	isRTL: null, // shortcut to the view's isRTL option

	start: null,
	end: null,

	el: null, // the containing element
	elsByFill: null, // a hash of jQuery element sets used for rendering each fill. Keyed by fill name.

	externalDragStartProxy: null, // binds the Grid's scope to externalDragStart (in DayGrid.events)

	// derived from options
	eventTimeFormat: null,
	displayEventTime: null,
	displayEventEnd: null,

	minResizeDuration: null, // TODO: hack. set by subclasses. minumum event resize duration

	// if defined, holds the unit identified (ex: "year" or "month") that determines the level of granularity
	// of the date areas. if not defined, assumes to be day and time granularity.
	// TODO: port isTimeScale into same system?
	largeUnit: null,


	constructor: function(view) {
		this.view = view;
		this.isRTL = view.opt('isRTL');

		this.elsByFill = {};
		this.externalDragStartProxy = proxy(this, 'externalDragStart');
	},


	/* Options
	------------------------------------------------------------------------------------------------------------------*/


	// Generates the format string used for event time text, if not explicitly defined by 'timeFormat'
	computeEventTimeFormat: function() {
		return this.view.opt('smallTimeFormat');
	},


	// Determines whether events should have their end times displayed, if not explicitly defined by 'displayEventTime'.
	// Only applies to non-all-day events.
	computeDisplayEventTime: function() {
		return true;
	},


	// Determines whether events should have their end times displayed, if not explicitly defined by 'displayEventEnd'
	computeDisplayEventEnd: function() {
		return true;
	},


	/* Dates
	------------------------------------------------------------------------------------------------------------------*/


	// Tells the grid about what period of time to display.
	// Any date-related internal data should be generated.
	setRange: function(range) {
		this.start = range.start.clone();
		this.end = range.end.clone();

		this.rangeUpdated();
		this.processRangeOptions();
	},


	// Called when internal variables that rely on the range should be updated
	rangeUpdated: function() {
	},


	// Updates values that rely on options and also relate to range
	processRangeOptions: function() {
		var view = this.view;
		var displayEventTime;
		var displayEventEnd;

		this.eventTimeFormat =
			view.opt('eventTimeFormat') ||
			view.opt('timeFormat') || // deprecated
			this.computeEventTimeFormat();

		displayEventTime = view.opt('displayEventTime');
		if (displayEventTime == null) {
			displayEventTime = this.computeDisplayEventTime(); // might be based off of range
		}

		displayEventEnd = view.opt('displayEventEnd');
		if (displayEventEnd == null) {
			displayEventEnd = this.computeDisplayEventEnd(); // might be based off of range
		}

		this.displayEventTime = displayEventTime;
		this.displayEventEnd = displayEventEnd;
	},


	// Converts a span (has unzoned start/end and any other grid-specific location information)
	// into an array of segments (pieces of events whose format is decided by the grid).
	spanToSegs: function(span) {
		// subclasses must implement
	},


	// Diffs the two dates, returning a duration, based on granularity of the grid
	// TODO: port isTimeScale into this system?
	diffDates: function(a, b) {
		if (this.largeUnit) {
			return diffByUnit(a, b, this.largeUnit);
		}
		else {
			return diffDayTime(a, b);
		}
	},


	/* Hit Area
	------------------------------------------------------------------------------------------------------------------*/


	// Called before one or more queryHit calls might happen. Should prepare any cached coordinates for queryHit
	prepareHits: function() {
	},


	// Called when queryHit calls have subsided. Good place to clear any coordinate caches.
	releaseHits: function() {
	},


	// Given coordinates from the topleft of the document, return data about the date-related area underneath.
	// Can return an object with arbitrary properties (although top/right/left/bottom are encouraged).
	// Must have a `grid` property, a reference to this current grid. TODO: avoid this
	// The returned object will be processed by getHitSpan and getHitEl.
	queryHit: function(leftOffset, topOffset) {
	},


	// Given position-level information about a date-related area within the grid,
	// should return an object with at least a start/end date. Can provide other information as well.
	getHitSpan: function(hit) {
	},


	// Given position-level information about a date-related area within the grid,
	// should return a jQuery element that best represents it. passed to dayClick callback.
	getHitEl: function(hit) {
	},


	/* Rendering
	------------------------------------------------------------------------------------------------------------------*/


	// Sets the container element that the grid should render inside of.
	// Does other DOM-related initializations.
	setElement: function(el) {
		var _this = this;

		this.el = el;

		// attach a handler to the grid's root element.
		// jQuery will take care of unregistering them when removeElement gets called.
		el.on('mousedown', function(ev) {
			if (
				!$(ev.target).is('.fc-event-container *, .fc-more') && // not an an event element, or "more.." link
				!$(ev.target).closest('.fc-popover').length // not on a popover (like the "more.." events one)
			) {
				_this.dayMousedown(ev);
			}
		});

		// attach event-element-related handlers. in Grid.events
		// same garbage collection note as above.
		this.bindSegHandlers();

		this.bindGlobalHandlers();
	},


	// Removes the grid's container element from the DOM. Undoes any other DOM-related attachments.
	// DOES NOT remove any content beforehand (doesn't clear events or call unrenderDates), unlike View
	removeElement: function() {
		this.unbindGlobalHandlers();

		this.el.remove();

		// NOTE: we don't null-out this.el for the same reasons we don't do it within View::removeElement
	},


	// Renders the basic structure of grid view before any content is rendered
	renderSkeleton: function() {
		// subclasses should implement
	},


	// Renders the grid's date-related content (like areas that represent days/times).
	// Assumes setRange has already been called and the skeleton has already been rendered.
	renderDates: function() {
		// subclasses should implement
	},


	// Unrenders the grid's date-related content
	unrenderDates: function() {
		// subclasses should implement
	},


	/* Handlers
	------------------------------------------------------------------------------------------------------------------*/


	// Binds DOM handlers to elements that reside outside the grid, such as the document
	bindGlobalHandlers: function() {
		$(document).on('dragstart sortstart', this.externalDragStartProxy); // jqui
	},


	// Unbinds DOM handlers from elements that reside outside the grid
	unbindGlobalHandlers: function() {
		$(document).off('dragstart sortstart', this.externalDragStartProxy); // jqui
	},


	// Process a mousedown on an element that represents a day. For day clicking and selecting.
	dayMousedown: function(ev) {
		var _this = this;
		var view = this.view;
		var isSelectable = view.opt('selectable');
		var dayClickHit; // null if invalid dayClick
		var selectionSpan; // null if invalid selection

		// this listener tracks a mousedown on a day element, and a subsequent drag.
		// if the drag ends on the same day, it is a 'dayClick'.
		// if 'selectable' is enabled, this listener also detects selections.
		var dragListener = new HitDragListener(this, {
			//distance: 5, // needs more work if we want dayClick to fire correctly
			scroll: view.opt('dragScroll'),
			dragStart: function() {
				view.unselect(); // since we could be rendering a new selection, we want to clear any old one
			},
			hitOver: function(hit, isOrig, origHit) {
				if (origHit) { // click needs to have started on a hit
					dayClickHit = isOrig ? hit : null; // single-hit selection is a day click
					if (isSelectable) {
						selectionSpan = _this.computeSelection(
							_this.getHitSpan(origHit),
							_this.getHitSpan(hit)
						);
						if (selectionSpan) {
							_this.renderSelection(selectionSpan);
						}
						else if (selectionSpan === false) {
							disableCursor();
						}
					}
				}
			},
			hitOut: function() {
				dayClickHit = null;
				selectionSpan = null;
				_this.unrenderSelection();
				enableCursor();
			},
			listenStop: function(ev) {
				if (dayClickHit) {
					view.triggerDayClick(
						_this.getHitSpan(dayClickHit),
						_this.getHitEl(dayClickHit),
						ev
					);
				}
				if (selectionSpan) {
					// the selection will already have been rendered. just report it
					view.reportSelection(selectionSpan, ev);
				}
				enableCursor();
			}
		});

		dragListener.mousedown(ev); // start listening, which will eventually initiate a dragStart
	},


	/* Event Helper
	------------------------------------------------------------------------------------------------------------------*/
	// TODO: should probably move this to Grid.events, like we did event dragging / resizing


	// Renders a mock event at the given event location, which contains zoned start/end properties.
	renderEventLocationHelper: function(eventLocation, sourceSeg) {
		var fakeEvent = this.fabricateHelperEvent(eventLocation, sourceSeg);

		this.renderHelper(fakeEvent, sourceSeg); // do the actual rendering
	},


	// Builds a fake event given zoned event date properties and a segment is should be inspired from.
	// The range's end can be null, in which case the mock event that is rendered will have a null end time.
	// `sourceSeg` is the internal segment object involved in the drag. If null, something external is dragging.
	fabricateHelperEvent: function(eventLocation, sourceSeg) {
		var fakeEvent = sourceSeg ? createObject(sourceSeg.event) : {}; // mask the original event object if possible

		fakeEvent.start = eventLocation.start.clone();
		fakeEvent.end = eventLocation.end ? eventLocation.end.clone() : null;
		fakeEvent.allDay = null; // force it to be freshly computed by normalizeEventDates
		this.view.calendar.normalizeEventDates(fakeEvent);

		// this extra className will be useful for differentiating real events from mock events in CSS
		fakeEvent.className = (fakeEvent.className || []).concat('fc-helper');

		// if something external is being dragged in, don't render a resizer
		if (!sourceSeg) {
			fakeEvent.editable = false;
		}

		return fakeEvent;
	},


	// Renders a mock event. Given zoned event date properties.
	renderHelper: function(eventLocation, sourceSeg) {
		// subclasses must implement
	},


	// Unrenders a mock event
	unrenderHelper: function() {
		// subclasses must implement
	},


	/* Selection
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of a selection. Will highlight by default but can be overridden by subclasses.
	// Given a span (unzoned start/end and other misc data)
	renderSelection: function(span) {
		this.renderHighlight(span);
	},


	// Unrenders any visual indications of a selection. Will unrender a highlight by default.
	unrenderSelection: function() {
		this.unrenderHighlight();
	},


	// Given the first and last date-spans of a selection, returns another date-span object.
	// Subclasses can override and provide additional data in the span object. Will be passed to renderSelection().
	// Will return false if the selection is invalid and this should be indicated to the user.
	// Will return null/undefined if a selection invalid but no error should be reported.
	computeSelection: function(span0, span1) {
		var span = this.computeSelectionSpan(span0, span1);

		if (span && !this.view.calendar.isSelectionSpanAllowed(span)) {
			return false;
		}

		return span;
	},


	// Given two spans, must return the combination of the two.
	// TODO: do this separation of concerns (combining VS validation) for event dnd/resize too.
	computeSelectionSpan: function(span0, span1) {
		var dates = [ span0.start, span0.end, span1.start, span1.end ];

		dates.sort(compareNumbers); // sorts chronologically. works with Moments

		return { start: dates[0].clone(), end: dates[3].clone() };
	},


	/* Highlight
	------------------------------------------------------------------------------------------------------------------*/


	// Renders an emphasis on the given date range. Given a span (unzoned start/end and other misc data)
	renderHighlight: function(span) {
		this.renderFill('highlight', this.spanToSegs(span));
	},


	// Unrenders the emphasis on a date range
	unrenderHighlight: function() {
		this.unrenderFill('highlight');
	},


	// Generates an array of classNames for rendering the highlight. Used by the fill system.
	highlightSegClasses: function() {
		return [ 'fc-highlight' ];
	},


	/* Fill System (highlight, background events, business hours)
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a set of rectangles over the given segments of time.
	// MUST RETURN a subset of segs, the segs that were actually rendered.
	// Responsible for populating this.elsByFill. TODO: better API for expressing this requirement
	renderFill: function(type, segs) {
		// subclasses must implement
	},


	// Unrenders a specific type of fill that is currently rendered on the grid
	unrenderFill: function(type) {
		var el = this.elsByFill[type];

		if (el) {
			el.remove();
			delete this.elsByFill[type];
		}
	},


	// Renders and assigns an `el` property for each fill segment. Generic enough to work with different types.
	// Only returns segments that successfully rendered.
	// To be harnessed by renderFill (implemented by subclasses).
	// Analagous to renderFgSegEls.
	renderFillSegEls: function(type, segs) {
		var _this = this;
		var segElMethod = this[type + 'SegEl'];
		var html = '';
		var renderedSegs = [];
		var i;

		if (segs.length) {

			// build a large concatenation of segment HTML
			for (i = 0; i < segs.length; i++) {
				html += this.fillSegHtml(type, segs[i]);
			}

			// Grab individual elements from the combined HTML string. Use each as the default rendering.
			// Then, compute the 'el' for each segment.
			$(html).each(function(i, node) {
				var seg = segs[i];
				var el = $(node);

				// allow custom filter methods per-type
				if (segElMethod) {
					el = segElMethod.call(_this, seg, el);
				}

				if (el) { // custom filters did not cancel the render
					el = $(el); // allow custom filter to return raw DOM node

					// correct element type? (would be bad if a non-TD were inserted into a table for example)
					if (el.is(_this.fillSegTag)) {
						seg.el = el;
						renderedSegs.push(seg);
					}
				}
			});
		}

		return renderedSegs;
	},


	fillSegTag: 'div', // subclasses can override


	// Builds the HTML needed for one fill segment. Generic enought o work with different types.
	fillSegHtml: function(type, seg) {

		// custom hooks per-type
		var classesMethod = this[type + 'SegClasses'];
		var cssMethod = this[type + 'SegCss'];

		var classes = classesMethod ? classesMethod.call(this, seg) : [];
		var css = cssToStr(cssMethod ? cssMethod.call(this, seg) : {});

		return '<' + this.fillSegTag +
			(classes.length ? ' class="' + classes.join(' ') + '"' : '') +
			(css ? ' style="' + css + '"' : '') +
			' />';
	},



	/* Generic rendering utilities for subclasses
	------------------------------------------------------------------------------------------------------------------*/


	// Computes HTML classNames for a single-day element
	getDayClasses: function(date) {
		var view = this.view;
		var today = view.calendar.getNow().stripTime();
		var classes = [ 'fc-' + dayIDs[date.day()] ];

		if (
			view.intervalDuration.as('months') == 1 &&
			date.month() != view.intervalStart.month()
		) {
			classes.push('fc-other-month');
		}

		if (date.isSame(today, 'day')) {
			classes.push(
				'fc-today',
				view.highlightStateClass
			);
		}
		else if (date < today) {
			classes.push('fc-past');
		}
		else {
			classes.push('fc-future');
		}

		return classes;
	}

});

;;

/* Event-rendering and event-interaction methods for the abstract Grid class
----------------------------------------------------------------------------------------------------------------------*/

Grid.mixin({

	mousedOverSeg: null, // the segment object the user's mouse is over. null if over nothing
	isDraggingSeg: false, // is a segment being dragged? boolean
	isResizingSeg: false, // is a segment being resized? boolean
	isDraggingExternal: false, // jqui-dragging an external element? boolean
	segs: null, // the event segments currently rendered in the grid


	// Renders the given events onto the grid
	renderEvents: function(events) {
		var bgEvents = [];
		var fgEvents = [];
		var i;

		for (i = 0; i < events.length; i++) {
			(isBgEvent(events[i]) ? bgEvents : fgEvents).push(events[i]);
		}

		this.segs = [].concat( // record all segs
			this.renderBgEvents(bgEvents),
			this.renderFgEvents(fgEvents)
		);
	},


	renderBgEvents: function(events) {
		var segs = this.eventsToSegs(events);

		// renderBgSegs might return a subset of segs, segs that were actually rendered
		return this.renderBgSegs(segs) || segs;
	},


	renderFgEvents: function(events) {
		var segs = this.eventsToSegs(events);

		// renderFgSegs might return a subset of segs, segs that were actually rendered
		return this.renderFgSegs(segs) || segs;
	},


	// Unrenders all events currently rendered on the grid
	unrenderEvents: function() {
		this.triggerSegMouseout(); // trigger an eventMouseout if user's mouse is over an event

		this.unrenderFgSegs();
		this.unrenderBgSegs();

		this.segs = null;
	},


	// Retrieves all rendered segment objects currently rendered on the grid
	getEventSegs: function() {
		return this.segs || [];
	},


	/* Foreground Segment Rendering
	------------------------------------------------------------------------------------------------------------------*/


	// Renders foreground event segments onto the grid. May return a subset of segs that were rendered.
	renderFgSegs: function(segs) {
		// subclasses must implement
	},


	// Unrenders all currently rendered foreground segments
	unrenderFgSegs: function() {
		// subclasses must implement
	},


	// Renders and assigns an `el` property for each foreground event segment.
	// Only returns segments that successfully rendered.
	// A utility that subclasses may use.
	renderFgSegEls: function(segs, disableResizing) {
		var view = this.view;
		var html = '';
		var renderedSegs = [];
		var i;

		if (segs.length) { // don't build an empty html string

			// build a large concatenation of event segment HTML
			for (i = 0; i < segs.length; i++) {
				html += this.fgSegHtml(segs[i], disableResizing);
			}

			// Grab individual elements from the combined HTML string. Use each as the default rendering.
			// Then, compute the 'el' for each segment. An el might be null if the eventRender callback returned false.
			$(html).each(function(i, node) {
				var seg = segs[i];
				var el = view.resolveEventEl(seg.event, $(node));

				if (el) {
					el.data('fc-seg', seg); // used by handlers
					seg.el = el;
					renderedSegs.push(seg);
				}
			});
		}

		return renderedSegs;
	},


	// Generates the HTML for the default rendering of a foreground event segment. Used by renderFgSegEls()
	fgSegHtml: function(seg, disableResizing) {
		// subclasses should implement
	},


	/* Background Segment Rendering
	------------------------------------------------------------------------------------------------------------------*/


	// Renders the given background event segments onto the grid.
	// Returns a subset of the segs that were actually rendered.
	renderBgSegs: function(segs) {
		return this.renderFill('bgEvent', segs);
	},


	// Unrenders all the currently rendered background event segments
	unrenderBgSegs: function() {
		this.unrenderFill('bgEvent');
	},


	// Renders a background event element, given the default rendering. Called by the fill system.
	bgEventSegEl: function(seg, el) {
		return this.view.resolveEventEl(seg.event, el); // will filter through eventRender
	},


	// Generates an array of classNames to be used for the default rendering of a background event.
	// Called by the fill system.
	bgEventSegClasses: function(seg) {
		var event = seg.event;
		var source = event.source || {};

		return [ 'fc-bgevent' ].concat(
			event.className,
			source.className || []
		);
	},


	// Generates a semicolon-separated CSS string to be used for the default rendering of a background event.
	// Called by the fill system.
	// TODO: consolidate with getEventSkinCss?
	bgEventSegCss: function(seg) {
		var view = this.view;
		var event = seg.event;
		var source = event.source || {};

		return {
			'background-color':
				event.backgroundColor ||
				event.color ||
				source.backgroundColor ||
				source.color ||
				view.opt('eventBackgroundColor') ||
				view.opt('eventColor')
		};
	},


	// Generates an array of classNames to be used for the rendering business hours overlay. Called by the fill system.
	businessHoursSegClasses: function(seg) {
		return [ 'fc-nonbusiness', 'fc-bgevent' ];
	},


	/* Handlers
	------------------------------------------------------------------------------------------------------------------*/


	// Attaches event-element-related handlers to the container element and leverage bubbling
	bindSegHandlers: function() {
		var _this = this;
		var view = this.view;

		$.each(
			{
				mouseenter: function(seg, ev) {
					_this.triggerSegMouseover(seg, ev);
				},
				mouseleave: function(seg, ev) {
					_this.triggerSegMouseout(seg, ev);
				},
				click: function(seg, ev) {
					return view.trigger('eventClick', this, seg.event, ev); // can return `false` to cancel
				},
				//dblclick: function(seg, ev) {
				//	return view.trigger('eventDblClick', this, seg.event, ev); // can return `false` to cancel
				//},
				mousedown: function(seg, ev) {
					if ($(ev.target).is('.fc-resizer') && view.isEventResizable(seg.event)) {
						_this.segResizeMousedown(seg, ev, $(ev.target).is('.fc-start-resizer'));
					}
					else if (view.isEventDraggable(seg.event)) {
						_this.segDragMousedown(seg, ev);
					}
				}
			},
			function(name, func) {
				// attach the handler to the container element and only listen for real event elements via bubbling
				_this.el.on(name, '.fc-event-container > *', function(ev) {
					var seg = $(this).data('fc-seg'); // grab segment data. put there by View::renderEvents

					// only call the handlers if there is not a drag/resize in progress
					if (seg && !_this.isDraggingSeg && !_this.isResizingSeg) {
						return func.call(this, seg, ev); // `this` will be the event element
					}
				});
			}
		);
	},


	// Updates internal state and triggers handlers for when an event element is moused over
	triggerSegMouseover: function(seg, ev) {
		if (!this.mousedOverSeg) {
			this.mousedOverSeg = seg;
			this.view.trigger('eventMouseover', seg.el[0], seg.event, ev);
		}
	},


	// Updates internal state and triggers handlers for when an event element is moused out.
	// Can be given no arguments, in which case it will mouseout the segment that was previously moused over.
	triggerSegMouseout: function(seg, ev) {
		ev = ev || {}; // if given no args, make a mock mouse event

		if (this.mousedOverSeg) {
			seg = seg || this.mousedOverSeg; // if given no args, use the currently moused-over segment
			this.mousedOverSeg = null;
			this.view.trigger('eventMouseout', seg.el[0], seg.event, ev);
		}
	},


	/* Event Dragging
	------------------------------------------------------------------------------------------------------------------*/


	// Called when the user does a mousedown on an event, which might lead to dragging.
	// Generic enough to work with any type of Grid.
	segDragMousedown: function(seg, ev) {
		var _this = this;
		var view = this.view;
		var calendar = view.calendar;
		var el = seg.el;
		var event = seg.event;
		var dropLocation; // zoned event date properties

		// A clone of the original element that will move with the mouse
		var mouseFollower = new MouseFollower(seg.el, {
			parentEl: view.el,
			opacity: view.opt('dragOpacity'),
			revertDuration: view.opt('dragRevertDuration'),
			zIndex: 2 // one above the .fc-view
		});

		// Tracks mouse movement over the *view's* coordinate map. Allows dragging and dropping between subcomponents
		// of the view.
		var dragListener = new HitDragListener(view, {
			distance: 5,
			scroll: view.opt('dragScroll'),
			subjectEl: el,
			subjectCenter: true,
			listenStart: function(ev) {
				mouseFollower.hide(); // don't show until we know this is a real drag
				mouseFollower.start(ev);
			},
			dragStart: function(ev) {
				_this.triggerSegMouseout(seg, ev); // ensure a mouseout on the manipulated event has been reported
				_this.segDragStart(seg, ev);
				view.hideEvent(event); // hide all event segments. our mouseFollower will take over
			},
			hitOver: function(hit, isOrig, origHit) {

				// starting hit could be forced (DayGrid.limit)
				if (seg.hit) {
					origHit = seg.hit;
				}

				// since we are querying the parent view, might not belong to this grid
				dropLocation = _this.computeEventDrop(
					origHit.component.getHitSpan(origHit),
					hit.component.getHitSpan(hit),
					event
				);

				if (dropLocation &&!calendar.isEventSpanAllowed(_this.eventToSpan(dropLocation), event)) {
					disableCursor();
					dropLocation = null;
				}

				// if a valid drop location, have the subclass render a visual indication
				if (dropLocation && view.renderDrag(dropLocation, seg)) {
					mouseFollower.hide(); // if the subclass is already using a mock event "helper", hide our own
				}
				else {
					mouseFollower.show(); // otherwise, have the helper follow the mouse (no snapping)
				}

				if (isOrig) {
					dropLocation = null; // needs to have moved hits to be a valid drop
				}
			},
			hitOut: function() { // called before mouse moves to a different hit OR moved out of all hits
				view.unrenderDrag(); // unrender whatever was done in renderDrag
				mouseFollower.show(); // show in case we are moving out of all hits
				dropLocation = null;
			},
			hitDone: function() { // Called after a hitOut OR before a dragStop
				enableCursor();
			},
			dragStop: function(ev) {
				// do revert animation if hasn't changed. calls a callback when finished (whether animation or not)
				mouseFollower.stop(!dropLocation, function() {
					view.unrenderDrag();
					view.showEvent(event);
					_this.segDragStop(seg, ev);

					if (dropLocation) {
						view.reportEventDrop(event, dropLocation, this.largeUnit, el, ev);
					}
				});
			},
			listenStop: function() {
				mouseFollower.stop(); // put in listenStop in case there was a mousedown but the drag never started
			}
		});

		dragListener.mousedown(ev); // start listening, which will eventually lead to a dragStart
	},


	// Called before event segment dragging starts
	segDragStart: function(seg, ev) {
		this.isDraggingSeg = true;
		this.view.trigger('eventDragStart', seg.el[0], seg.event, ev, {}); // last argument is jqui dummy
	},


	// Called after event segment dragging stops
	segDragStop: function(seg, ev) {
		this.isDraggingSeg = false;
		this.view.trigger('eventDragStop', seg.el[0], seg.event, ev, {}); // last argument is jqui dummy
	},


	// Given the spans an event drag began, and the span event was dropped, calculates the new zoned start/end/allDay
	// values for the event. Subclasses may override and set additional properties to be used by renderDrag.
	// A falsy returned value indicates an invalid drop.
	computeEventDrop: function(startSpan, endSpan, event) {
		var calendar = this.view.calendar;
		var dragStart = startSpan.start;
		var dragEnd = endSpan.start;
		var delta;
		var dropLocation; // zoned event date properties

		if (dragStart.hasTime() === dragEnd.hasTime()) {
			delta = this.diffDates(dragEnd, dragStart);

			// if an all-day event was in a timed area and it was dragged to a different time,
			// guarantee an end and adjust start/end to have times
			if (event.allDay && durationHasTime(delta)) {
				dropLocation = {
					start: event.start.clone(),
					end: calendar.getEventEnd(event), // will be an ambig day
					allDay: false // for normalizeEventTimes
				};
				calendar.normalizeEventTimes(dropLocation);
			}
			// othewise, work off existing values
			else {
				dropLocation = {
					start: event.start.clone(),
					end: event.end ? event.end.clone() : null,
					allDay: event.allDay // keep it the same
				};
			}

			dropLocation.start.add(delta);
			if (dropLocation.end) {
				dropLocation.end.add(delta);
			}
		}
		else {
			// if switching from day <-> timed, start should be reset to the dropped date, and the end cleared
			dropLocation = {
				start: dragEnd.clone(),
				end: null, // end should be cleared
				allDay: !dragEnd.hasTime()
			};
		}

		return dropLocation;
	},


	// Utility for apply dragOpacity to a jQuery set
	applyDragOpacity: function(els) {
		var opacity = this.view.opt('dragOpacity');

		if (opacity != null) {
			els.each(function(i, node) {
				// Don't use jQuery (will set an IE filter), do it the old fashioned way.
				// In IE8, a helper element will disappears if there's a filter.
				node.style.opacity = opacity;
			});
		}
	},


	/* External Element Dragging
	------------------------------------------------------------------------------------------------------------------*/


	// Called when a jQuery UI drag is initiated anywhere in the DOM
	externalDragStart: function(ev, ui) {
		var view = this.view;
		var el;
		var accept;

		if (view.opt('droppable')) { // only listen if this setting is on
			el = $((ui ? ui.item : null) || ev.target);

			// Test that the dragged element passes the dropAccept selector or filter function.
			// FYI, the default is "*" (matches all)
			accept = view.opt('dropAccept');
			if ($.isFunction(accept) ? accept.call(el[0], el) : el.is(accept)) {
				if (!this.isDraggingExternal) { // prevent double-listening if fired twice
					this.listenToExternalDrag(el, ev, ui);
				}
			}
		}
	},


	// Called when a jQuery UI drag starts and it needs to be monitored for dropping
	listenToExternalDrag: function(el, ev, ui) {
		var _this = this;
		var meta = getDraggedElMeta(el); // extra data about event drop, including possible event to create
		var dropLocation; // a null value signals an unsuccessful drag

		// listener that tracks mouse movement over date-associated pixel regions
		var dragListener = new HitDragListener(this, {
			listenStart: function() {
				_this.isDraggingExternal = true;
			},
			hitOver: function(hit) {
				dropLocation = _this.computeExternalDrop(
					hit.component.getHitSpan(hit), // since we are querying the parent view, might not belong to this grid
					meta
				);
				if (dropLocation) {
					_this.renderDrag(dropLocation); // called without a seg parameter
				}
				else { // invalid hit
					disableCursor();
				}
			},
			hitOut: function() {
				dropLocation = null; // signal unsuccessful
				_this.unrenderDrag();
				enableCursor();
			},
			dragStop: function() {
				_this.unrenderDrag();
				enableCursor();

				if (dropLocation) { // element was dropped on a valid hit
					_this.view.reportExternalDrop(meta, dropLocation, el, ev, ui);
				}
			},
			listenStop: function() {
				_this.isDraggingExternal = false;
			}
		});

		dragListener.startDrag(ev); // start listening immediately
	},


	// Given a hit to be dropped upon, and misc data associated with the jqui drag (guaranteed to be a plain object),
	// returns the zoned start/end dates for the event that would result from the hypothetical drop. end might be null.
	// Returning a null value signals an invalid drop hit.
	computeExternalDrop: function(span, meta) {
		var calendar = this.view.calendar;
		var dropLocation = {
			start: calendar.applyTimezone(span.start), // simulate a zoned event start date
			end: null
		};

		// if dropped on an all-day span, and element's metadata specified a time, set it
		if (meta.startTime && !dropLocation.start.hasTime()) {
			dropLocation.start.time(meta.startTime);
		}

		if (meta.duration) {
			dropLocation.end = dropLocation.start.clone().add(meta.duration);
		}

		if (!calendar.isExternalSpanAllowed(this.eventToSpan(dropLocation), dropLocation, meta.eventProps)) {
			return null;
		}

		return dropLocation;
	},



	/* Drag Rendering (for both events and an external elements)
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of an event or external element being dragged.
	// `dropLocation` contains hypothetical start/end/allDay values the event would have if dropped. end can be null.
	// `seg` is the internal segment object that is being dragged. If dragging an external element, `seg` is null.
	// A truthy returned value indicates this method has rendered a helper element.
	renderDrag: function(dropLocation, seg) {
		// subclasses must implement
	},


	// Unrenders a visual indication of an event or external element being dragged
	unrenderDrag: function() {
		// subclasses must implement
	},


	/* Resizing
	------------------------------------------------------------------------------------------------------------------*/


	// Called when the user does a mousedown on an event's resizer, which might lead to resizing.
	// Generic enough to work with any type of Grid.
	segResizeMousedown: function(seg, ev, isStart) {
		var _this = this;
		var view = this.view;
		var calendar = view.calendar;
		var el = seg.el;
		var event = seg.event;
		var eventEnd = calendar.getEventEnd(event);
		var resizeLocation; // zoned event date properties. falsy if invalid resize

		// Tracks mouse movement over the *grid's* coordinate map
		var dragListener = new HitDragListener(this, {
			distance: 5,
			scroll: view.opt('dragScroll'),
			subjectEl: el,
			dragStart: function(ev) {
				_this.triggerSegMouseout(seg, ev); // ensure a mouseout on the manipulated event has been reported
				_this.segResizeStart(seg, ev);
			},
			hitOver: function(hit, isOrig, origHit) {
				var origHitSpan = _this.getHitSpan(origHit);
				var hitSpan = _this.getHitSpan(hit);

				resizeLocation = isStart ?
					_this.computeEventStartResize(origHitSpan, hitSpan, event) :
					_this.computeEventEndResize(origHitSpan, hitSpan, event);

				if (resizeLocation) {
					if (!calendar.isEventSpanAllowed(_this.eventToSpan(resizeLocation), event)) {
						disableCursor();
						resizeLocation = null;
					}
					// no change? (TODO: how does this work with timezones?)
					else if (resizeLocation.start.isSame(event.start) && resizeLocation.end.isSame(eventEnd)) {
						resizeLocation = null;
					}
				}

				if (resizeLocation) {
					view.hideEvent(event);
					_this.renderEventResize(resizeLocation, seg);
				}
			},
			hitOut: function() { // called before mouse moves to a different hit OR moved out of all hits
				resizeLocation = null;
			},
			hitDone: function() { // resets the rendering to show the original event
				_this.unrenderEventResize();
				view.showEvent(event);
				enableCursor();
			},
			dragStop: function(ev) {
				_this.segResizeStop(seg, ev);

				if (resizeLocation) { // valid date to resize to?
					view.reportEventResize(event, resizeLocation, this.largeUnit, el, ev);
				}
			}
		});

		dragListener.mousedown(ev); // start listening, which will eventually lead to a dragStart
	},


	// Called before event segment resizing starts
	segResizeStart: function(seg, ev) {
		this.isResizingSeg = true;
		this.view.trigger('eventResizeStart', seg.el[0], seg.event, ev, {}); // last argument is jqui dummy
	},


	// Called after event segment resizing stops
	segResizeStop: function(seg, ev) {
		this.isResizingSeg = false;
		this.view.trigger('eventResizeStop', seg.el[0], seg.event, ev, {}); // last argument is jqui dummy
	},


	// Returns new date-information for an event segment being resized from its start
	computeEventStartResize: function(startSpan, endSpan, event) {
		return this.computeEventResize('start', startSpan, endSpan, event);
	},


	// Returns new date-information for an event segment being resized from its end
	computeEventEndResize: function(startSpan, endSpan, event) {
		return this.computeEventResize('end', startSpan, endSpan, event);
	},


	// Returns new zoned date information for an event segment being resized from its start OR end
	// `type` is either 'start' or 'end'
	computeEventResize: function(type, startSpan, endSpan, event) {
		var calendar = this.view.calendar;
		var delta = this.diffDates(endSpan[type], startSpan[type]);
		var resizeLocation; // zoned event date properties
		var defaultDuration;

		// build original values to work from, guaranteeing a start and end
		resizeLocation = {
			start: event.start.clone(),
			end: calendar.getEventEnd(event),
			allDay: event.allDay
		};

		// if an all-day event was in a timed area and was resized to a time, adjust start/end to have times
		if (resizeLocation.allDay && durationHasTime(delta)) {
			resizeLocation.allDay = false;
			calendar.normalizeEventTimes(resizeLocation);
		}

		resizeLocation[type].add(delta); // apply delta to start or end

		// if the event was compressed too small, find a new reasonable duration for it
		if (!resizeLocation.start.isBefore(resizeLocation.end)) {

			defaultDuration =
				this.minResizeDuration || // TODO: hack
				(event.allDay ?
					calendar.defaultAllDayEventDuration :
					calendar.defaultTimedEventDuration);

			if (type == 'start') { // resizing the start?
				resizeLocation.start = resizeLocation.end.clone().subtract(defaultDuration);
			}
			else { // resizing the end?
				resizeLocation.end = resizeLocation.start.clone().add(defaultDuration);
			}
		}

		return resizeLocation;
	},


	// Renders a visual indication of an event being resized.
	// `range` has the updated dates of the event. `seg` is the original segment object involved in the drag.
	renderEventResize: function(range, seg) {
		// subclasses must implement
	},


	// Unrenders a visual indication of an event being resized.
	unrenderEventResize: function() {
		// subclasses must implement
	},


	/* Rendering Utils
	------------------------------------------------------------------------------------------------------------------*/


	// Compute the text that should be displayed on an event's element.
	// `range` can be the Event object itself, or something range-like, with at least a `start`.
	// If event times are disabled, or the event has no time, will return a blank string.
	// If not specified, formatStr will default to the eventTimeFormat setting,
	// and displayEnd will default to the displayEventEnd setting.
	getEventTimeText: function(range, formatStr, displayEnd) {

		if (formatStr == null) {
			formatStr = this.eventTimeFormat;
		}

		if (displayEnd == null) {
			displayEnd = this.displayEventEnd;
		}

		if (this.displayEventTime && range.start.hasTime()) {
			if (displayEnd && range.end) {
				return this.view.formatRange(range, formatStr);
			}
			else {
				return range.start.format(formatStr);
			}
		}

		return '';
	},


	// Generic utility for generating the HTML classNames for an event segment's element
	getSegClasses: function(seg, isDraggable, isResizable) {
		var event = seg.event;
		var classes = [
			'fc-event',
			seg.isStart ? 'fc-start' : 'fc-not-start',
			seg.isEnd ? 'fc-end' : 'fc-not-end'
		].concat(
			event.className,
			event.source ? event.source.className : []
		);

		if (isDraggable) {
			classes.push('fc-draggable');
		}
		if (isResizable) {
			classes.push('fc-resizable');
		}

		return classes;
	},


	// Utility for generating event skin-related CSS properties
	getEventSkinCss: function(event) {
		var view = this.view;
		var source = event.source || {};
		var eventColor = event.color;
		var sourceColor = source.color;
		var optionColor = view.opt('eventColor');

		return {
			'background-color':
				event.backgroundColor ||
				eventColor ||
				source.backgroundColor ||
				sourceColor ||
				view.opt('eventBackgroundColor') ||
				optionColor,
			'border-color':
				event.borderColor ||
				eventColor ||
				source.borderColor ||
				sourceColor ||
				view.opt('eventBorderColor') ||
				optionColor,
			color:
				event.textColor ||
				source.textColor ||
				view.opt('eventTextColor')
		};
	},


	/* Converting events -> eventRange -> eventSpan -> eventSegs
	------------------------------------------------------------------------------------------------------------------*/


	// Generates an array of segments for the given single event
	eventToSegs: function(event) {
		return this.eventsToSegs([ event ]);
	},


	// Generates a single span (always unzoned) by using the given event's dates.
	// Does not do any inverting for inverse-background events.
	eventToSpan: function(event) {
		var range = this.eventToRange(event);
		this.transformEventSpan(range, event); // convert it to a span, in-place
		return range;
	},


	// Converts an array of event objects into an array of event segment objects.
	// A custom `segSliceFunc` may be given for arbitrarily slicing up events.
	// Doesn't guarantee an order for the resulting array.
	eventsToSegs: function(allEvents, segSliceFunc) {
		var _this = this;
		var eventsById = groupEventsById(allEvents);
		var segs = [];

		$.each(eventsById, function(id, events) {
			var ranges = [];
			var i;

			for (i = 0; i < events.length; i++) {
				ranges.push(_this.eventToRange(events[i]));
			}

			// inverse-background events (utilize only the first event in calculations)
			if (isInverseBgEvent(events[0])) {
				ranges = _this.invertRanges(ranges);

				for (i = 0; i < ranges.length; i++) {
					_this.generateEventSegs(ranges[i], events[0], segSliceFunc, segs);
				}
			}
			// normal event ranges
			else {
				for (i = 0; i < ranges.length; i++) {
					_this.generateEventSegs(ranges[i], events[i], segSliceFunc, segs);
				}
			}
		});

		return segs;
	},


	// Generates the unzoned start/end dates an event appears to occupy
	eventToRange: function(event) {
		return {
			start: event.start.clone().stripZone(),
			end: this.view.calendar.getEventEnd(event).stripZone()
		};
	},


	// Given an event's span (unzoned start/end and other misc data), and the event itself,
	// slice into segments (using the segSliceFunc function if specified) and append to the `out` array.
	// SIDE EFFECT: will mutate the given `range`.
	generateEventSegs: function(range, event, segSliceFunc, out) {
		var segs;
		var i;

		this.transformEventSpan(range, event); // converts the range to a span

		segs = segSliceFunc ? segSliceFunc(range) : this.spanToSegs(range);

		for (i = 0; i < segs.length; i++) {
			this.transformEventSeg(segs[i], range, event);
			out.push(segs[i]);
		}
	},


	// Given a range (unzoned start/end) that is about to become a span,
	// attach any event-derived properties to it.
	transformEventSpan: function(range, event) {
		// subclasses can implement
	},


	// Given a segment object, attach any extra properties, based off of its source span and event.
	transformEventSeg: function(seg, span, event) {
		seg.event = event;
		seg.eventStartMS = +span.start; // TODO: not the best name after making spans unzoned
		seg.eventDurationMS = span.end - span.start;
	},


	// Produces a new array of range objects that will cover all the time NOT covered by the given ranges.
	// SIDE EFFECT: will mutate the given array and will use its date references.
	invertRanges: function(ranges) {
		var view = this.view;
		var viewStart = view.start.clone(); // need a copy
		var viewEnd = view.end.clone(); // need a copy
		var inverseRanges = [];
		var start = viewStart; // the end of the previous range. the start of the new range
		var i, range;

		// ranges need to be in order. required for our date-walking algorithm
		ranges.sort(compareRanges);

		for (i = 0; i < ranges.length; i++) {
			range = ranges[i];

			// add the span of time before the event (if there is any)
			if (range.start > start) { // compare millisecond time (skip any ambig logic)
				inverseRanges.push({
					start: start,
					end: range.start
				});
			}

			start = range.end;
		}

		// add the span of time after the last event (if there is any)
		if (start < viewEnd) { // compare millisecond time (skip any ambig logic)
			inverseRanges.push({
				start: start,
				end: viewEnd
			});
		}

		return inverseRanges;
	},


	sortEventSegs: function(segs) {
		segs.sort(proxy(this, 'compareEventSegs'));
	},


	// A cmp function for determining which segments should take visual priority
	compareEventSegs: function(seg1, seg2) {
		return seg1.eventStartMS - seg2.eventStartMS || // earlier events go first
			seg2.eventDurationMS - seg1.eventDurationMS || // tie? longer events go first
			seg2.event.allDay - seg1.event.allDay || // tie? put all-day events first (booleans cast to 0/1)
			compareByFieldSpecs(seg1.event, seg2.event, this.view.eventOrderSpecs);
	}

});


/* Utilities
----------------------------------------------------------------------------------------------------------------------*/


function isBgEvent(event) { // returns true if background OR inverse-background
	var rendering = getEventRendering(event);
	return rendering === 'background' || rendering === 'inverse-background';
}


function isInverseBgEvent(event) {
	return getEventRendering(event) === 'inverse-background';
}


function getEventRendering(event) {
	return firstDefined((event.source || {}).rendering, event.rendering);
}


function groupEventsById(events) {
	var eventsById = {};
	var i, event;

	for (i = 0; i < events.length; i++) {
		event = events[i];
		(eventsById[event._id] || (eventsById[event._id] = [])).push(event);
	}

	return eventsById;
}


// A cmp function for determining which non-inverted "ranges" (see above) happen earlier
function compareRanges(range1, range2) {
	return range1.start - range2.start; // earlier ranges go first
}


/* External-Dragging-Element Data
----------------------------------------------------------------------------------------------------------------------*/

// Require all HTML5 data-* attributes used by FullCalendar to have this prefix.
// A value of '' will query attributes like data-event. A value of 'fc' will query attributes like data-fc-event.
FC.dataAttrPrefix = '';

// Given a jQuery element that might represent a dragged FullCalendar event, returns an intermediate data structure
// to be used for Event Object creation.
// A defined `.eventProps`, even when empty, indicates that an event should be created.
function getDraggedElMeta(el) {
	var prefix = FC.dataAttrPrefix;
	var eventProps; // properties for creating the event, not related to date/time
	var startTime; // a Duration
	var duration;
	var stick;

	if (prefix) { prefix += '-'; }
	eventProps = el.data(prefix + 'event') || null;

	if (eventProps) {
		if (typeof eventProps === 'object') {
			eventProps = $.extend({}, eventProps); // make a copy
		}
		else { // something like 1 or true. still signal event creation
			eventProps = {};
		}

		// pluck special-cased date/time properties
		startTime = eventProps.start;
		if (startTime == null) { startTime = eventProps.time; } // accept 'time' as well
		duration = eventProps.duration;
		stick = eventProps.stick;
		delete eventProps.start;
		delete eventProps.time;
		delete eventProps.duration;
		delete eventProps.stick;
	}

	// fallback to standalone attribute values for each of the date/time properties
	if (startTime == null) { startTime = el.data(prefix + 'start'); }
	if (startTime == null) { startTime = el.data(prefix + 'time'); } // accept 'time' as well
	if (duration == null) { duration = el.data(prefix + 'duration'); }
	if (stick == null) { stick = el.data(prefix + 'stick'); }

	// massage into correct data types
	startTime = startTime != null ? confimoment.duration(startTime) : null;
	duration = duration != null ? confimoment.duration(duration) : null;
	stick = Boolean(stick);

	return { eventProps: eventProps, startTime: startTime, duration: duration, stick: stick };
}


;;

/*
A set of rendering and date-related methods for a visual component comprised of one or more rows of day columns.
Prerequisite: the object being mixed into needs to be a *Grid*
*/
var DayTableMixin = FC.DayTableMixin = {

	breakOnWeeks: false, // should create a new row for each week?
	dayDates: null, // whole-day dates for each column. left to right
	dayIndices: null, // for each day from start, the offset
	daysPerRow: null,
	rowCnt: null,
	colCnt: null,
	colHeadFormat: null,


	// Populates internal variables used for date calculation and rendering
	updateDayTable: function() {
		var view = this.view;
		var date = this.start.clone();
		var dayIndex = -1;
		var dayIndices = [];
		var dayDates = [];
		var daysPerRow;
		var firstDay;
		var rowCnt;

		while (date.isBefore(this.end)) { // loop each day from start to end
			if (view.isHiddenDay(date)) {
				dayIndices.push(dayIndex + 0.5); // mark that it's between indices
			}
			else {
				dayIndex++;
				dayIndices.push(dayIndex);
				dayDates.push(date.clone());
			}
			date.add(1, 'days');
		}

		if (this.breakOnWeeks) {
			// count columns until the day-of-week repeats
			firstDay = dayDates[0].day();
			for (daysPerRow = 1; daysPerRow < dayDates.length; daysPerRow++) {
				if (dayDates[daysPerRow].day() == firstDay) {
					break;
				}
			}
			rowCnt = Math.ceil(dayDates.length / daysPerRow);
		}
		else {
			rowCnt = 1;
			daysPerRow = dayDates.length;
		}

		this.dayDates = dayDates;
		this.dayIndices = dayIndices;
		this.daysPerRow = daysPerRow;
		this.rowCnt = rowCnt;

		this.updateDayTableCols();
	},


	// Computes and assigned the colCnt property and updates any options that may be computed from it
	updateDayTableCols: function() {
		this.colCnt = this.computeColCnt();
		this.colHeadFormat = this.view.opt('columnFormat') || this.computeColHeadFormat();
	},


	// Determines how many columns there should be in the table
	computeColCnt: function() {
		return this.daysPerRow;
	},


	// Computes the ambiguously-timed moment for the given cell
	getCellDate: function(row, col) {
		return this.dayDates[
				this.getCellDayIndex(row, col)
			].clone();
	},


	// Computes the ambiguously-timed date range for the given cell
	getCellRange: function(row, col) {
		var start = this.getCellDate(row, col);
		var end = start.clone().add(1, 'days');

		return { start: start, end: end };
	},


	// Returns the number of day cells, chronologically, from the first of the grid (0-based)
	getCellDayIndex: function(row, col) {
		return row * this.daysPerRow + this.getColDayIndex(col);
	},


	// Returns the numner of day cells, chronologically, from the first cell in *any given row*
	getColDayIndex: function(col) {
		if (this.isRTL) {
			return this.colCnt - 1 - col;
		}
		else {
			return col;
		}
	},


	// Given a date, returns its chronolocial cell-index from the first cell of the grid.
	// If the date lies between cells (because of hiddenDays), returns a floating-point value between offsets.
	// If before the first offset, returns a negative number.
	// If after the last offset, returns an offset past the last cell offset.
	// Only works for *start* dates of cells. Will not work for exclusive end dates for cells.
	getDateDayIndex: function(date) {
		var dayIndices = this.dayIndices;
		var dayOffset = date.diff(this.start, 'days');

		if (dayOffset < 0) {
			return dayIndices[0] - 1;
		}
		else if (dayOffset >= dayIndices.length) {
			return dayIndices[dayIndices.length - 1] + 1;
		}
		else {
			return dayIndices[dayOffset];
		}
	},


	/* Options
	------------------------------------------------------------------------------------------------------------------*/


	// Computes a default column header formatting string if `colFormat` is not explicitly defined
	computeColHeadFormat: function() {
		// if more than one week row, or if there are a lot of columns with not much space,
		// put just the day numbers will be in each cell
		if (this.rowCnt > 1 || this.colCnt > 10) {
			return 'ddd'; // "Sat"
		}
		// multiple days, so full single date string WON'T be in title text
		else if (this.colCnt > 1) {
			return this.view.opt('dayOfMonthFormat'); // "Sat 12/10"
		}
		// single day, so full single date string will probably be in title text
		else {
			return 'dddd'; // "Saturday"
		}
	},


	/* Slicing
	------------------------------------------------------------------------------------------------------------------*/


	// Slices up a date range into a segment for every week-row it intersects with
	sliceRangeByRow: function(range) {
		var daysPerRow = this.daysPerRow;
		var normalRange = this.view.computeDayRange(range); // make whole-day range, considering nextDayThreshold
		var rangeFirst = this.getDateDayIndex(normalRange.start); // inclusive first index
		var rangeLast = this.getDateDayIndex(normalRange.end.clone().subtract(1, 'days')); // inclusive last index
		var segs = [];
		var row;
		var rowFirst, rowLast; // inclusive day-index range for current row
		var segFirst, segLast; // inclusive day-index range for segment

		for (row = 0; row < this.rowCnt; row++) {
			rowFirst = row * daysPerRow;
			rowLast = rowFirst + daysPerRow - 1;

			// intersect segment's offset range with the row's
			segFirst = Math.max(rangeFirst, rowFirst);
			segLast = Math.min(rangeLast, rowLast);

			// deal with in-between indices
			segFirst = Math.ceil(segFirst); // in-between starts round to next cell
			segLast = Math.floor(segLast); // in-between ends round to prev cell

			if (segFirst <= segLast) { // was there any intersection with the current row?
				segs.push({
					row: row,

					// normalize to start of row
					firstRowDayIndex: segFirst - rowFirst,
					lastRowDayIndex: segLast - rowFirst,

					// must be matching integers to be the segment's start/end
					isStart: segFirst === rangeFirst,
					isEnd: segLast === rangeLast
				});
			}
		}

		return segs;
	},


	// Slices up a date range into a segment for every day-cell it intersects with.
	// TODO: make more DRY with sliceRangeByRow somehow.
	sliceRangeByDay: function(range) {
		var daysPerRow = this.daysPerRow;
		var normalRange = this.view.computeDayRange(range); // make whole-day range, considering nextDayThreshold
		var rangeFirst = this.getDateDayIndex(normalRange.start); // inclusive first index
		var rangeLast = this.getDateDayIndex(normalRange.end.clone().subtract(1, 'days')); // inclusive last index
		var segs = [];
		var row;
		var rowFirst, rowLast; // inclusive day-index range for current row
		var i;
		var segFirst, segLast; // inclusive day-index range for segment

		for (row = 0; row < this.rowCnt; row++) {
			rowFirst = row * daysPerRow;
			rowLast = rowFirst + daysPerRow - 1;

			for (i = rowFirst; i <= rowLast; i++) {

				// intersect segment's offset range with the row's
				segFirst = Math.max(rangeFirst, i);
				segLast = Math.min(rangeLast, i);

				// deal with in-between indices
				segFirst = Math.ceil(segFirst); // in-between starts round to next cell
				segLast = Math.floor(segLast); // in-between ends round to prev cell

				if (segFirst <= segLast) { // was there any intersection with the current row?
					segs.push({
						row: row,

						// normalize to start of row
						firstRowDayIndex: segFirst - rowFirst,
						lastRowDayIndex: segLast - rowFirst,

						// must be matching integers to be the segment's start/end
						isStart: segFirst === rangeFirst,
						isEnd: segLast === rangeLast
					});
				}
			}
		}

		return segs;
	},


	/* Header Rendering
	------------------------------------------------------------------------------------------------------------------*/


	renderHeadHtml: function() {
		var view = this.view;

		return '' +
			'<div class="fc-row ' + view.widgetHeaderClass + '">' +
				'<table>' +
					'<thead>' +
						this.renderHeadTrHtml() +
					'</thead>' +
				'</table>' +
			'</div>';
	},


	renderHeadIntroHtml: function() {
		return this.renderIntroHtml(); // fall back to generic
	},


	renderHeadTrHtml: function() {
		return '' +
			'<tr>' +
				(this.isRTL ? '' : this.renderHeadIntroHtml()) +
				this.renderHeadDateCellsHtml() +
				(this.isRTL ? this.renderHeadIntroHtml() : '') +
			'</tr>';
	},


	renderHeadDateCellsHtml: function() {
		var htmls = [];
		var col, date;

		for (col = 0; col < this.colCnt; col++) {
			date = this.getCellDate(0, col);
			htmls.push(this.renderHeadDateCellHtml(date));
		}

		return htmls.join('');
	},


	renderHeadDateCellHtml: function(date, colspan) {
		var view = this.view;

		return '' +
			'<th class="fc-day-header ' + view.widgetHeaderClass + ' fc-' + dayIDs[date.day()] + '"' +
				(colspan > 1 ? ' colspan="' + colspan + '"' : '') +
				'>' +
				htmlEscape(date.format(this.colHeadFormat)) +
			'</th>';
	},


	/* Background Rendering
	------------------------------------------------------------------------------------------------------------------*/


	renderBgTrHtml: function(row) {
		return '' +
			'<tr>' +
				(this.isRTL ? '' : this.renderBgIntroHtml(row)) +
				this.renderBgCellsHtml(row) +
				(this.isRTL ? this.renderBgIntroHtml(row) : '') +
			'</tr>';
	},


	renderBgIntroHtml: function(row) {
		return this.renderIntroHtml(); // fall back to generic
	},


	renderBgCellsHtml: function(row) {
		var htmls = [];
		var col, date;

		for (col = 0; col < this.colCnt; col++) {
			date = this.getCellDate(row, col);
			htmls.push(this.renderBgCellHtml(date));
		}

		return htmls.join('');
	},


	renderBgCellHtml: function(date) {
		var view = this.view;
		var classes = this.getDayClasses(date);

		classes.unshift('fc-day', view.widgetContentClass);

		return '<td class="' + classes.join(' ') + '"' +
			' data-date="' + date.format('YYYY-MM-DD') + '"' + // if date has a time, won't format it
			'></td>';
	},


	/* Generic
	------------------------------------------------------------------------------------------------------------------*/


	// Generates the default HTML intro for any row. User classes should override
	renderIntroHtml: function() {
	},


	/* Utils
	------------------------------------------------------------------------------------------------------------------*/


	// Applies the generic "intro" and "outro" HTML to the given cells.
	// Intro means the leftmost cell when the calendar is LTR and the rightmost cell when RTL. Vice-versa for outro.
	bookendCells: function(trEl) {
		var introHtml = this.renderIntroHtml();

		if (introHtml) {
			if (this.isRTL) {
				trEl.append(introHtml);
			}
			else {
				trEl.prepend(introHtml);
			}
		}
	}

};

;;

/* A component that renders a grid of whole-days that runs horizontally. There can be multiple rows, one per week.
----------------------------------------------------------------------------------------------------------------------*/

var DayGrid = FC.DayGrid = Grid.extend(DayTableMixin, {

	numbersVisible: false, // should render a row for day/week numbers? set by outside view. TODO: make internal
	bottomCoordPadding: 0, // hack for extending the hit area for the last row of the coordinate grid

	rowEls: null, // set of fake row elements
	cellEls: null, // set of whole-day elements comprising the row's background
	helperEls: null, // set of cell skeleton elements for rendering the mock event "helper"

	rowCoordCache: null,
	colCoordCache: null,


	// Renders the rows and columns into the component's `this.el`, which should already be assigned.
	// isRigid determins whether the individual rows should ignore the contents and be a constant height.
	// Relies on the view's colCnt and rowCnt. In the future, this component should probably be self-sufficient.
	renderDates: function(isRigid) {
		var view = this.view;
		var rowCnt = this.rowCnt;
		var colCnt = this.colCnt;
		var html = '';
		var row;
		var col;

		for (row = 0; row < rowCnt; row++) {
			html += this.renderDayRowHtml(row, isRigid);
		}
		this.el.html(html);

		this.rowEls = this.el.find('.fc-row');
		this.cellEls = this.el.find('.fc-day');

		this.rowCoordCache = new CoordCache({
			els: this.rowEls,
			isVertical: true
		});
		this.colCoordCache = new CoordCache({
			els: this.cellEls.slice(0, this.colCnt), // only the first row
			isHorizontal: true
		});

		// trigger dayRender with each cell's element
		for (row = 0; row < rowCnt; row++) {
			for (col = 0; col < colCnt; col++) {
				view.trigger(
					'dayRender',
					null,
					this.getCellDate(row, col),
					this.getCellEl(row, col)
				);
			}
		}
	},


	unrenderDates: function() {
		this.removeSegPopover();
	},


	renderBusinessHours: function() {
		var events = this.view.calendar.getBusinessHoursEvents(true); // wholeDay=true
		var segs = this.eventsToSegs(events);

		this.renderFill('businessHours', segs, 'bgevent');
	},


	// Generates the HTML for a single row, which is a div that wraps a table.
	// `row` is the row number.
	renderDayRowHtml: function(row, isRigid) {
		var view = this.view;
		var classes = [ 'fc-row', 'fc-week', view.widgetContentClass ];

		if (isRigid) {
			classes.push('fc-rigid');
		}

		return '' +
			'<div class="' + classes.join(' ') + '">' +
				'<div class="fc-bg">' +
					'<table>' +
						this.renderBgTrHtml(row) +
					'</table>' +
				'</div>' +
				'<div class="fc-content-skeleton">' +
					'<table>' +
						(this.numbersVisible ?
							'<thead>' +
								this.renderNumberTrHtml(row) +
							'</thead>' :
							''
							) +
					'</table>' +
				'</div>' +
			'</div>';
	},


	/* Grid Number Rendering
	------------------------------------------------------------------------------------------------------------------*/


	renderNumberTrHtml: function(row) {
		return '' +
			'<tr>' +
				(this.isRTL ? '' : this.renderNumberIntroHtml(row)) +
				this.renderNumberCellsHtml(row) +
				(this.isRTL ? this.renderNumberIntroHtml(row) : '') +
			'</tr>';
	},


	renderNumberIntroHtml: function(row) {
		return this.renderIntroHtml();
	},


	renderNumberCellsHtml: function(row) {
		var htmls = [];
		var col, date;

		for (col = 0; col < this.colCnt; col++) {
			date = this.getCellDate(row, col);
			htmls.push(this.renderNumberCellHtml(date));
		}

		return htmls.join('');
	},


	// Generates the HTML for the <td>s of the "number" row in the DayGrid's content skeleton.
	// The number row will only exist if either day numbers or week numbers are turned on.
	renderNumberCellHtml: function(date) {
		var classes;

		if (!this.view.dayNumbersVisible) { // if there are week numbers but not day numbers
			return '<td/>'; //  will create an empty space above events :(
		}

		classes = this.getDayClasses(date);
		classes.unshift('fc-day-number');

		return '' +
			'<td class="' + classes.join(' ') + '" data-date="' + date.format() + '">' +
				date.date() +
			'</td>';
	},


	/* Options
	------------------------------------------------------------------------------------------------------------------*/


	// Computes a default event time formatting string if `timeFormat` is not explicitly defined
	computeEventTimeFormat: function() {
		return this.view.opt('extraSmallTimeFormat'); // like "6p" or "6:30p"
	},


	// Computes a default `displayEventEnd` value if one is not expliclty defined
	computeDisplayEventEnd: function() {
		return this.colCnt == 1; // we'll likely have space if there's only one day
	},


	/* Dates
	------------------------------------------------------------------------------------------------------------------*/


	rangeUpdated: function() {
		this.updateDayTable();
	},


	// Slices up the given span (unzoned start/end with other misc data) into an array of segments
	spanToSegs: function(span) {
		var segs = this.sliceRangeByRow(span);
		var i, seg;

		for (i = 0; i < segs.length; i++) {
			seg = segs[i];
			if (this.isRTL) {
				seg.leftCol = this.daysPerRow - 1 - seg.lastRowDayIndex;
				seg.rightCol = this.daysPerRow - 1 - seg.firstRowDayIndex;
			}
			else {
				seg.leftCol = seg.firstRowDayIndex;
				seg.rightCol = seg.lastRowDayIndex;
			}
		}

		return segs;
	},


	/* Hit System
	------------------------------------------------------------------------------------------------------------------*/


	prepareHits: function() {
		this.colCoordCache.build();
		this.rowCoordCache.build();
		this.rowCoordCache.bottoms[this.rowCnt - 1] += this.bottomCoordPadding; // hack
	},


	releaseHits: function() {
		this.colCoordCache.clear();
		this.rowCoordCache.clear();
	},


	queryHit: function(leftOffset, topOffset) {
		var col = this.colCoordCache.getHorizontalIndex(leftOffset);
		var row = this.rowCoordCache.getVerticalIndex(topOffset);

		if (row != null && col != null) {
			return this.getCellHit(row, col);
		}
	},


	getHitSpan: function(hit) {
		return this.getCellRange(hit.row, hit.col);
	},


	getHitEl: function(hit) {
		return this.getCellEl(hit.row, hit.col);
	},


	/* Cell System
	------------------------------------------------------------------------------------------------------------------*/
	// FYI: the first column is the leftmost column, regardless of date


	getCellHit: function(row, col) {
		return {
			row: row,
			col: col,
			component: this, // needed unfortunately :(
			left: this.colCoordCache.getLeftOffset(col),
			right: this.colCoordCache.getRightOffset(col),
			top: this.rowCoordCache.getTopOffset(row),
			bottom: this.rowCoordCache.getBottomOffset(row)
		};
	},


	getCellEl: function(row, col) {
		return this.cellEls.eq(row * this.colCnt + col);
	},


	/* Event Drag Visualization
	------------------------------------------------------------------------------------------------------------------*/
	// TODO: move to DayGrid.event, similar to what we did with Grid's drag methods


	// Renders a visual indication of an event or external element being dragged.
	// `eventLocation` has zoned start and end (optional)
	renderDrag: function(eventLocation, seg) {

		// always render a highlight underneath
		this.renderHighlight(this.eventToSpan(eventLocation));

		// if a segment from the same calendar but another component is being dragged, render a helper event
		if (seg && !seg.el.closest(this.el).length) {

			this.renderEventLocationHelper(eventLocation, seg);
			this.applyDragOpacity(this.helperEls);

			return true; // a helper has been rendered
		}
	},


	// Unrenders any visual indication of a hovering event
	unrenderDrag: function() {
		this.unrenderHighlight();
		this.unrenderHelper();
	},


	/* Event Resize Visualization
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of an event being resized
	renderEventResize: function(eventLocation, seg) {
		this.renderHighlight(this.eventToSpan(eventLocation));
		this.renderEventLocationHelper(eventLocation, seg);
	},


	// Unrenders a visual indication of an event being resized
	unrenderEventResize: function() {
		this.unrenderHighlight();
		this.unrenderHelper();
	},


	/* Event Helper
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a mock "helper" event. `sourceSeg` is the associated internal segment object. It can be null.
	renderHelper: function(event, sourceSeg) {
		var helperNodes = [];
		var segs = this.eventToSegs(event);
		var rowStructs;

		segs = this.renderFgSegEls(segs); // assigns each seg's el and returns a subset of segs that were rendered
		rowStructs = this.renderSegRows(segs);

		// inject each new event skeleton into each associated row
		this.rowEls.each(function(row, rowNode) {
			var rowEl = $(rowNode); // the .fc-row
			var skeletonEl = $('<div class="fc-helper-skeleton"><table/></div>'); // will be absolutely positioned
			var skeletonTop;

			// If there is an original segment, match the top position. Otherwise, put it at the row's top level
			if (sourceSeg && sourceSeg.row === row) {
				skeletonTop = sourceSeg.el.position().top;
			}
			else {
				skeletonTop = rowEl.find('.fc-content-skeleton tbody').position().top;
			}

			skeletonEl.css('top', skeletonTop)
				.find('table')
					.append(rowStructs[row].tbodyEl);

			rowEl.append(skeletonEl);
			helperNodes.push(skeletonEl[0]);
		});

		this.helperEls = $(helperNodes); // array -> jQuery set
	},


	// Unrenders any visual indication of a mock helper event
	unrenderHelper: function() {
		if (this.helperEls) {
			this.helperEls.remove();
			this.helperEls = null;
		}
	},


	/* Fill System (highlight, background events, business hours)
	------------------------------------------------------------------------------------------------------------------*/


	fillSegTag: 'td', // override the default tag name


	// Renders a set of rectangles over the given segments of days.
	// Only returns segments that successfully rendered.
	renderFill: function(type, segs, className) {
		var nodes = [];
		var i, seg;
		var skeletonEl;

		segs = this.renderFillSegEls(type, segs); // assignes `.el` to each seg. returns successfully rendered segs

		for (i = 0; i < segs.length; i++) {
			seg = segs[i];
			skeletonEl = this.renderFillRow(type, seg, className);
			this.rowEls.eq(seg.row).append(skeletonEl);
			nodes.push(skeletonEl[0]);
		}

		this.elsByFill[type] = $(nodes);

		return segs;
	},


	// Generates the HTML needed for one row of a fill. Requires the seg's el to be rendered.
	renderFillRow: function(type, seg, className) {
		var colCnt = this.colCnt;
		var startCol = seg.leftCol;
		var endCol = seg.rightCol + 1;
		var skeletonEl;
		var trEl;

		className = className || type.toLowerCase();

		skeletonEl = $(
			'<div class="fc-' + className + '-skeleton">' +
				'<table><tr/></table>' +
			'</div>'
		);
		trEl = skeletonEl.find('tr');

		if (startCol > 0) {
			trEl.append('<td colspan="' + startCol + '"/>');
		}

		trEl.append(
			seg.el.attr('colspan', endCol - startCol)
		);

		if (endCol < colCnt) {
			trEl.append('<td colspan="' + (colCnt - endCol) + '"/>');
		}

		this.bookendCells(trEl);

		return skeletonEl;
	}

});

;;

/* Event-rendering methods for the DayGrid class
----------------------------------------------------------------------------------------------------------------------*/

DayGrid.mixin({

	rowStructs: null, // an array of objects, each holding information about a row's foreground event-rendering


	// Unrenders all events currently rendered on the grid
	unrenderEvents: function() {
		this.removeSegPopover(); // removes the "more.." events popover
		Grid.prototype.unrenderEvents.apply(this, arguments); // calls the super-method
	},


	// Retrieves all rendered segment objects currently rendered on the grid
	getEventSegs: function() {
		return Grid.prototype.getEventSegs.call(this) // get the segments from the super-method
			.concat(this.popoverSegs || []); // append the segments from the "more..." popover
	},


	// Renders the given background event segments onto the grid
	renderBgSegs: function(segs) {

		// don't render timed background events
		var allDaySegs = $.grep(segs, function(seg) {
			return seg.event.allDay;
		});

		return Grid.prototype.renderBgSegs.call(this, allDaySegs); // call the super-method
	},


	// Renders the given foreground event segments onto the grid
	renderFgSegs: function(segs) {
		var rowStructs;

		// render an `.el` on each seg
		// returns a subset of the segs. segs that were actually rendered
		segs = this.renderFgSegEls(segs);

		rowStructs = this.rowStructs = this.renderSegRows(segs);

		// append to each row's content skeleton
		this.rowEls.each(function(i, rowNode) {
			$(rowNode).find('.fc-content-skeleton > table').append(
				rowStructs[i].tbodyEl
			);
		});

		return segs; // return only the segs that were actually rendered
	},


	// Unrenders all currently rendered foreground event segments
	unrenderFgSegs: function() {
		var rowStructs = this.rowStructs || [];
		var rowStruct;

		while ((rowStruct = rowStructs.pop())) {
			rowStruct.tbodyEl.remove();
		}

		this.rowStructs = null;
	},


	// Uses the given events array to generate <tbody> elements that should be appended to each row's content skeleton.
	// Returns an array of rowStruct objects (see the bottom of `renderSegRow`).
	// PRECONDITION: each segment shoud already have a rendered and assigned `.el`
	renderSegRows: function(segs) {
		var rowStructs = [];
		var segRows;
		var row;

		segRows = this.groupSegRows(segs); // group into nested arrays

		// iterate each row of segment groupings
		for (row = 0; row < segRows.length; row++) {
			rowStructs.push(
				this.renderSegRow(row, segRows[row])
			);
		}

		return rowStructs;
	},


	// Builds the HTML to be used for the default element for an individual segment
	fgSegHtml: function(seg, disableResizing) {
		var view = this.view;
		var event = seg.event;
		var isDraggable = view.isEventDraggable(event);
		var isResizableFromStart = !disableResizing && event.allDay &&
			seg.isStart && view.isEventResizableFromStart(event);
		var isResizableFromEnd = !disableResizing && event.allDay &&
			seg.isEnd && view.isEventResizableFromEnd(event);
		var classes = this.getSegClasses(seg, isDraggable, isResizableFromStart || isResizableFromEnd);
		var skinCss = cssToStr(this.getEventSkinCss(event));
		var timeHtml = '';
		var timeText;
		var titleHtml;

		classes.unshift('fc-day-grid-event', 'fc-h-event');

		// Only display a timed events time if it is the starting segment
		if (seg.isStart) {
			timeText = this.getEventTimeText(event);
			if (timeText) {
				timeHtml = '<span class="fc-time">' + htmlEscape(timeText) + '</span>';
			}
		}

		titleHtml =
      '<span class="fc-title" title="' + htmlEscape(event.title || '') + '">' +
	      (htmlEscape(event.title || '') || '&nbsp;') + // we always want one line of height
      '</span>';

		return '<a class="' + classes.join(' ') + '"' +
				(event.url ?
					' href="' + htmlEscape(event.url) + '"' :
					''
					) +
				(skinCss ?
					' style="' + skinCss + '"' :
					''
					) +
			'>' +
				'<div class="fc-content">' +
					(this.isRTL ?
						titleHtml + ' ' + timeHtml : // put a natural space in between
						timeHtml + ' ' + titleHtml   //
						) +
				'</div>' +
				(isResizableFromStart ?
					'<div class="fc-resizer fc-start-resizer" />' :
					''
					) +
				(isResizableFromEnd ?
					'<div class="fc-resizer fc-end-resizer" />' :
					''
					) +
			'</a>';
	},


	// Given a row # and an array of segments all in the same row, render a <tbody> element, a skeleton that contains
	// the segments. Returns object with a bunch of internal data about how the render was calculated.
	// NOTE: modifies rowSegs
	renderSegRow: function(row, rowSegs) {
		var colCnt = this.colCnt;
		var segLevels = this.buildSegLevels(rowSegs); // group into sub-arrays of levels
		var levelCnt = Math.max(1, segLevels.length); // ensure at least one level
		var tbody = $('<tbody/>');
		var segMatrix = []; // lookup for which segments are rendered into which level+col cells
		var cellMatrix = []; // lookup for all <td> elements of the level+col matrix
		var loneCellMatrix = []; // lookup for <td> elements that only take up a single column
		var i, levelSegs;
		var col;
		var tr;
		var j, seg;
		var td;

		// populates empty cells from the current column (`col`) to `endCol`
		function emptyCellsUntil(endCol) {
			while (col < endCol) {
				// try to grab a cell from the level above and extend its rowspan. otherwise, create a fresh cell
				td = (loneCellMatrix[i - 1] || [])[col];
				if (td) {
					td.attr(
						'rowspan',
						parseInt(td.attr('rowspan') || 1, 10) + 1
					);
				}
				else {
					td = $('<td/>');
					tr.append(td);
				}
				cellMatrix[i][col] = td;
				loneCellMatrix[i][col] = td;
				col++;
			}
		}

		for (i = 0; i < levelCnt; i++) { // iterate through all levels
			levelSegs = segLevels[i];
			col = 0;
			tr = $('<tr/>');

			segMatrix.push([]);
			cellMatrix.push([]);
			loneCellMatrix.push([]);

			// levelCnt might be 1 even though there are no actual levels. protect against this.
			// this single empty row is useful for styling.
			if (levelSegs) {
				for (j = 0; j < levelSegs.length; j++) { // iterate through segments in level
					seg = levelSegs[j];

					emptyCellsUntil(seg.leftCol);

					// create a container that occupies or more columns. append the event element.
					td = $('<td class="fc-event-container"/>').append(seg.el);
					if (seg.leftCol != seg.rightCol) {
						td.attr('colspan', seg.rightCol - seg.leftCol + 1);
					}
					else { // a single-column segment
						loneCellMatrix[i][col] = td;
					}

					while (col <= seg.rightCol) {
						cellMatrix[i][col] = td;
						segMatrix[i][col] = seg;
						col++;
					}

					tr.append(td);
				}
			}

			emptyCellsUntil(colCnt); // finish off the row
			this.bookendCells(tr);
			tbody.append(tr);
		}

		return { // a "rowStruct"
			row: row, // the row number
			tbodyEl: tbody,
			cellMatrix: cellMatrix,
			segMatrix: segMatrix,
			segLevels: segLevels,
			segs: rowSegs
		};
	},


	// Stacks a flat array of segments, which are all assumed to be in the same row, into subarrays of vertical levels.
	// NOTE: modifies segs
	buildSegLevels: function(segs) {
		var levels = [];
		var i, seg;
		var j;

		// Give preference to elements with certain criteria, so they have
		// a chance to be closer to the top.
		this.sortEventSegs(segs);

		for (i = 0; i < segs.length; i++) {
			seg = segs[i];

			// loop through levels, starting with the topmost, until the segment doesn't collide with other segments
			for (j = 0; j < levels.length; j++) {
				if (!isDaySegCollision(seg, levels[j])) {
					break;
				}
			}
			// `j` now holds the desired subrow index
			seg.level = j;

			// create new level array if needed and append segment
			(levels[j] || (levels[j] = [])).push(seg);
		}

		// order segments left-to-right. very important if calendar is RTL
		for (j = 0; j < levels.length; j++) {
			levels[j].sort(compareDaySegCols);
		}

		return levels;
	},


	// Given a flat array of segments, return an array of sub-arrays, grouped by each segment's row
	groupSegRows: function(segs) {
		var segRows = [];
		var i;

		for (i = 0; i < this.rowCnt; i++) {
			segRows.push([]);
		}

		for (i = 0; i < segs.length; i++) {
			segRows[segs[i].row].push(segs[i]);
		}

		return segRows;
	}

});


// Computes whether two segments' columns collide. They are assumed to be in the same row.
function isDaySegCollision(seg, otherSegs) {
	var i, otherSeg;

	for (i = 0; i < otherSegs.length; i++) {
		otherSeg = otherSegs[i];

		if (
			otherSeg.leftCol <= seg.rightCol &&
			otherSeg.rightCol >= seg.leftCol
		) {
			return true;
		}
	}

	return false;
}


// A cmp function for determining the leftmost event
function compareDaySegCols(a, b) {
	return a.leftCol - b.leftCol;
}

;;

/* Methods relate to limiting the number events for a given day on a DayGrid
----------------------------------------------------------------------------------------------------------------------*/
// NOTE: all the segs being passed around in here are foreground segs

DayGrid.mixin({

	segPopover: null, // the Popover that holds events that can't fit in a cell. null when not visible
	popoverSegs: null, // an array of segment objects that the segPopover holds. null when not visible


	removeSegPopover: function() {
		if (this.segPopover) {
			this.segPopover.hide(); // in handler, will call segPopover's removeElement
		}
	},


	// Limits the number of "levels" (vertically stacking layers of events) for each row of the grid.
	// `levelLimit` can be false (don't limit), a number, or true (should be computed).
	limitRows: function(levelLimit) {
		var rowStructs = this.rowStructs || [];
		var row; // row #
		var rowLevelLimit;

		for (row = 0; row < rowStructs.length; row++) {
			this.unlimitRow(row);

			if (!levelLimit) {
				rowLevelLimit = false;
			}
			else if (typeof levelLimit === 'number') {
				rowLevelLimit = levelLimit;
			}
			else {
				rowLevelLimit = this.computeRowLevelLimit(row);
			}

			if (rowLevelLimit !== false) {
				this.limitRow(row, rowLevelLimit);
			}
		}
	},


	// Computes the number of levels a row will accomodate without going outside its bounds.
	// Assumes the row is "rigid" (maintains a constant height regardless of what is inside).
	// `row` is the row number.
	computeRowLevelLimit: function(row) {
		var rowEl = this.rowEls.eq(row); // the containing "fake" row div
		var rowHeight = rowEl.height(); // TODO: cache somehow?
		var trEls = this.rowStructs[row].tbodyEl.children();
		var i, trEl;
		var trHeight;

		function iterInnerHeights(i, childNode) {
			trHeight = Math.max(trHeight, $(childNode).outerHeight());
		}

		// Reveal one level <tr> at a time and stop when we find one out of bounds
		for (i = 0; i < trEls.length; i++) {
			trEl = trEls.eq(i).removeClass('fc-limited'); // reset to original state (reveal)

			// with rowspans>1 and IE8, trEl.outerHeight() would return the height of the largest cell,
			// so instead, find the tallest inner content element.
			trHeight = 0;
			trEl.find('> td > :first-child').each(iterInnerHeights);

			if (trEl.position().top + trHeight > rowHeight) {
				return i;
			}
		}

		return false; // should not limit at all
	},


	// Limits the given grid row to the maximum number of levels and injects "more" links if necessary.
	// `row` is the row number.
	// `levelLimit` is a number for the maximum (inclusive) number of levels allowed.
	limitRow: function(row, levelLimit) {
		var _this = this;
		var rowStruct = this.rowStructs[row];
		var moreNodes = []; // array of "more" <a> links and <td> DOM nodes
		var col = 0; // col #, left-to-right (not chronologically)
		var levelSegs; // array of segment objects in the last allowable level, ordered left-to-right
		var cellMatrix; // a matrix (by level, then column) of all <td> jQuery elements in the row
		var limitedNodes; // array of temporarily hidden level <tr> and segment <td> DOM nodes
		var i, seg;
		var segsBelow; // array of segment objects below `seg` in the current `col`
		var totalSegsBelow; // total number of segments below `seg` in any of the columns `seg` occupies
		var colSegsBelow; // array of segment arrays, below seg, one for each column (offset from segs's first column)
		var td, rowspan;
		var segMoreNodes; // array of "more" <td> cells that will stand-in for the current seg's cell
		var j;
		var moreTd, moreWrap, moreLink;

		// Iterates through empty level cells and places "more" links inside if need be
		function emptyCellsUntil(endCol) { // goes from current `col` to `endCol`
			while (col < endCol) {
				segsBelow = _this.getCellSegs(row, col, levelLimit);
				if (segsBelow.length) {
					td = cellMatrix[levelLimit - 1][col];
					moreLink = _this.renderMoreLink(row, col, segsBelow);
					moreWrap = $('<div/>').append(moreLink);
					td.append(moreWrap);
					moreNodes.push(moreWrap[0]);
				}
				col++;
			}
		}

		if (levelLimit && levelLimit < rowStruct.segLevels.length) { // is it actually over the limit?
			levelSegs = rowStruct.segLevels[levelLimit - 1];
			cellMatrix = rowStruct.cellMatrix;

			limitedNodes = rowStruct.tbodyEl.children().slice(levelLimit) // get level <tr> elements past the limit
				.addClass('fc-limited').get(); // hide elements and get a simple DOM-nodes array

			// iterate though segments in the last allowable level
			for (i = 0; i < levelSegs.length; i++) {
				seg = levelSegs[i];
				emptyCellsUntil(seg.leftCol); // process empty cells before the segment

				// determine *all* segments below `seg` that occupy the same columns
				colSegsBelow = [];
				totalSegsBelow = 0;
				while (col <= seg.rightCol) {
					segsBelow = this.getCellSegs(row, col, levelLimit);
					colSegsBelow.push(segsBelow);
					totalSegsBelow += segsBelow.length;
					col++;
				}

				if (totalSegsBelow) { // do we need to replace this segment with one or many "more" links?
					td = cellMatrix[levelLimit - 1][seg.leftCol]; // the segment's parent cell
					rowspan = td.attr('rowspan') || 1;
					segMoreNodes = [];

					// make a replacement <td> for each column the segment occupies. will be one for each colspan
					for (j = 0; j < colSegsBelow.length; j++) {
						moreTd = $('<td class="fc-more-cell"/>').attr('rowspan', rowspan);
						segsBelow = colSegsBelow[j];
						moreLink = this.renderMoreLink(
							row,
							seg.leftCol + j,
							[ seg ].concat(segsBelow) // count seg as hidden too
						);
						moreWrap = $('<div/>').append(moreLink);
						moreTd.append(moreWrap);
						segMoreNodes.push(moreTd[0]);
						moreNodes.push(moreTd[0]);
					}

					td.addClass('fc-limited').after($(segMoreNodes)); // hide original <td> and inject replacements
					limitedNodes.push(td[0]);
				}
			}

			emptyCellsUntil(this.colCnt); // finish off the level
			rowStruct.moreEls = $(moreNodes); // for easy undoing later
			rowStruct.limitedEls = $(limitedNodes); // for easy undoing later
		}
	},


	// Reveals all levels and removes all "more"-related elements for a grid's row.
	// `row` is a row number.
	unlimitRow: function(row) {
		var rowStruct = this.rowStructs[row];

		if (rowStruct.moreEls) {
			rowStruct.moreEls.remove();
			rowStruct.moreEls = null;
		}

		if (rowStruct.limitedEls) {
			rowStruct.limitedEls.removeClass('fc-limited');
			rowStruct.limitedEls = null;
		}
	},


	// Renders an <a> element that represents hidden event element for a cell.
	// Responsible for attaching click handler as well.
	renderMoreLink: function(row, col, hiddenSegs) {
		var _this = this;
		var view = this.view;

		return $('<a class="fc-more"/>')
			.text(
				this.getMoreLinkText(hiddenSegs.length)
			)
			.on('click', function(ev) {
				var clickOption = view.opt('eventLimitClick');
				var date = _this.getCellDate(row, col);
				var moreEl = $(this);
				var dayEl = _this.getCellEl(row, col);
				var allSegs = _this.getCellSegs(row, col);

				// rescope the segments to be within the cell's date
				var reslicedAllSegs = _this.resliceDaySegs(allSegs, date);
				var reslicedHiddenSegs = _this.resliceDaySegs(hiddenSegs, date);

				if (typeof clickOption === 'function') {
					// the returned value can be an atomic option
					clickOption = view.trigger('eventLimitClick', null, {
						date: date,
						dayEl: dayEl,
						moreEl: moreEl,
						segs: reslicedAllSegs,
						hiddenSegs: reslicedHiddenSegs
					}, ev);
				}

				if (clickOption === 'popover') {
					_this.showSegPopover(row, col, moreEl, reslicedAllSegs);
				}
				else if (typeof clickOption === 'string') { // a view name
					view.calendar.zoomTo(date, clickOption);
				}
			});
	},


	// Reveals the popover that displays all events within a cell
	showSegPopover: function(row, col, moreLink, segs) {
		var _this = this;
		var view = this.view;
		var moreWrap = moreLink.parent(); // the <div> wrapper around the <a>
		var topEl; // the element we want to match the top coordinate of
		var options;

		if (this.rowCnt == 1) {
			topEl = view.el; // will cause the popover to cover any sort of header
		}
		else {
			topEl = this.rowEls.eq(row); // will align with top of row
		}

		options = {
			className: 'fc-more-popover',
			content: this.renderSegPopoverContent(row, col, segs),
			parentEl: this.el,
			top: topEl.offset().top,
			autoHide: true, // when the user clicks elsewhere, hide the popover
			viewportConstrain: view.opt('popoverViewportConstrain'),
			hide: function() {
				// kill everything when the popover is hidden
				_this.segPopover.removeElement();
				_this.segPopover = null;
				_this.popoverSegs = null;
			}
		};

		// Determine horizontal coordinate.
		// We use the moreWrap instead of the <td> to avoid border confusion.
		if (this.isRTL) {
			options.right = moreWrap.offset().left + moreWrap.outerWidth() + 1; // +1 to be over cell border
		}
		else {
			options.left = moreWrap.offset().left - 1; // -1 to be over cell border
		}

		this.segPopover = new Popover(options);
		this.segPopover.show();
	},


	// Builds the inner DOM contents of the segment popover
	renderSegPopoverContent: function(row, col, segs) {
		var view = this.view;
		var isTheme = view.opt('theme');
		var title = this.getCellDate(row, col).format(view.opt('dayPopoverFormat'));
		var content = $(
			'<div class="fc-header ' + view.widgetHeaderClass + '">' +
				'<span class="fc-close ' +
					(isTheme ? 'ui-icon ui-icon-closethick' : 'fc-icon fc-icon-x') +
				'"></span>' +
				'<span class="fc-title" title="' + htmlEscape(title) + '">' +
				htmlEscape(title) +
				'</span>' +
				'<div class="fc-clear"/>' +
			'</div>' +
			'<div class="fc-body ' + view.widgetContentClass + '">' +
				'<div class="fc-event-container"></div>' +
			'</div>'
		);
		var segContainer = content.find('.fc-event-container');
		var i;

		// render each seg's `el` and only return the visible segs
		segs = this.renderFgSegEls(segs, true); // disableResizing=true
		this.popoverSegs = segs;

		for (i = 0; i < segs.length; i++) {

			// because segments in the popover are not part of a grid coordinate system, provide a hint to any
			// grids that want to do drag-n-drop about which cell it came from
			this.prepareHits();
			segs[i].hit = this.getCellHit(row, col);
			this.releaseHits();

			segContainer.append(segs[i].el);
		}

		return content;
	},


	// Given the events within an array of segment objects, reslice them to be in a single day
	resliceDaySegs: function(segs, dayDate) {

		// build an array of the original events
		var events = $.map(segs, function(seg) {
			return seg.event;
		});

		var dayStart = dayDate.clone();
		var dayEnd = dayStart.clone().add(1, 'days');
		var dayRange = { start: dayStart, end: dayEnd };

		// slice the events with a custom slicing function
		segs = this.eventsToSegs(
			events,
			function(range) {
				var seg = intersectRanges(range, dayRange); // undefind if no intersection
				return seg ? [ seg ] : []; // must return an array of segments
			}
		);

		// force an order because eventsToSegs doesn't guarantee one
		this.sortEventSegs(segs);

		return segs;
	},


	// Generates the text that should be inside a "more" link, given the number of events it represents
	getMoreLinkText: function(num) {
		var opt = this.view.opt('eventLimitText');

		if (typeof opt === 'function') {
			return opt(num);
		}
		else {
			return '+' + num + ' ' + opt;
		}
	},


	// Returns segments within a given cell.
	// If `startLevel` is specified, returns only events including and below that level. Otherwise returns all segs.
	getCellSegs: function(row, col, startLevel) {
		var segMatrix = this.rowStructs[row].segMatrix;
		var level = startLevel || 0;
		var segs = [];
		var seg;

		while (level < segMatrix.length) {
			seg = segMatrix[level][col];
			if (seg) {
				segs.push(seg);
			}
			level++;
		}

		return segs;
	}

});

;;

/* A component that renders one or more columns of vertical time slots
----------------------------------------------------------------------------------------------------------------------*/
// We mixin DayTable, even though there is only a single row of days

var TimeGrid = FC.TimeGrid = Grid.extend(DayTableMixin, {

	slotDuration: null, // duration of a "slot", a distinct time segment on given day, visualized by lines
	snapDuration: null, // granularity of time for dragging and selecting
	snapsPerSlot: null,
	minTime: null, // Duration object that denotes the first visible time of any given day
	maxTime: null, // Duration object that denotes the exclusive visible end time of any given day
	labelFormat: null, // formatting string for times running along vertical axis
	labelInterval: null, // duration of how often a label should be displayed for a slot

	colEls: null, // cells elements in the day-row background
	slatEls: null, // elements running horizontally across all columns
	helperEl: null, // cell skeleton element for rendering the mock event "helper"

	colCoordCache: null,
	slatCoordCache: null,

	businessHourSegs: null,


	constructor: function() {
		Grid.apply(this, arguments); // call the super-constructor

		this.processOptions();
	},


	// Renders the time grid into `this.el`, which should already be assigned.
	// Relies on the view's colCnt. In the future, this component should probably be self-sufficient.
	renderDates: function() {
		this.el.html(this.renderHtml());
		this.colEls = this.el.find('.fc-day');
		this.slatEls = this.el.find('.fc-slats tr');

		this.colCoordCache = new CoordCache({
			els: this.colEls,
			isHorizontal: true
		});
		this.slatCoordCache = new CoordCache({
			els: this.slatEls,
			isVertical: true
		});
	},


	renderBusinessHours: function() {
		var events = this.view.calendar.getBusinessHoursEvents();
		this.businessHourSegs = this.renderFill('businessHours', this.eventsToSegs(events), 'bgevent');
	},


	// Renders the basic HTML skeleton for the grid
	renderHtml: function() {
		return '' +
			'<div class="fc-bg">' +
				'<table>' +
					this.renderBgTrHtml(0) + // row=0
				'</table>' +
			'</div>' +
			'<div class="fc-slats">' +
				'<table>' +
					this.renderSlatRowHtml() +
				'</table>' +
			'</div>';
	},


	// Generates the HTML for the horizontal "slats" that run width-wise. Has a time axis on a side. Depends on RTL.
	renderSlatRowHtml: function() {
		var view = this.view;
		var isRTL = this.isRTL;
		var html = '';
		var slotTime = confimoment.duration(+this.minTime); // wish there was .clone() for durations
		var slotDate; // will be on the view's first day, but we only care about its time
		var isLabeled;
		var axisHtml;

		// Calculate the time for each slot
		while (slotTime < this.maxTime) {
			slotDate = this.start.clone().time(slotTime);
			isLabeled = isInt(divideDurationByDuration(slotTime, this.labelInterval));

			axisHtml =
				'<td class="fc-axis fc-time ' + view.widgetContentClass + '" ' + view.axisStyleAttr() + '>' +
					(isLabeled ?
						'<span>' + // for matchCellWidths
							htmlEscape(slotDate.format(this.labelFormat)) +
						'</span>' :
						''
						) +
				'</td>';

			html +=
				'<tr ' + (isLabeled ? '' : 'class="fc-minor"') + '>' +
					(!isRTL ? axisHtml : '') +
					'<td class="' + view.widgetContentClass + '"/>' +
					(isRTL ? axisHtml : '') +
				"</tr>";

			slotTime.add(this.slotDuration);
		}

		return html;
	},


	/* Options
	------------------------------------------------------------------------------------------------------------------*/


	// Parses various options into properties of this object
	processOptions: function() {
		var view = this.view;
		var slotDuration = view.opt('slotDuration');
		var snapDuration = view.opt('snapDuration');
		var input;

		slotDuration = confimoment.duration(slotDuration);
		snapDuration = snapDuration ? confimoment.duration(snapDuration) : slotDuration;

		this.slotDuration = slotDuration;
		this.snapDuration = snapDuration;
		this.snapsPerSlot = slotDuration / snapDuration; // TODO: ensure an integer multiple?

		this.minResizeDuration = snapDuration; // hack

		this.minTime = confimoment.duration(view.opt('minTime'));
		this.maxTime = confimoment.duration(view.opt('maxTime'));

		// might be an array value (for TimelineView).
		// if so, getting the most granular entry (the last one probably).
		input = view.opt('slotLabelFormat');
		if ($.isArray(input)) {
			input = input[input.length - 1];
		}

		this.labelFormat =
			input ||
			view.opt('axisFormat') || // deprecated
			view.opt('smallTimeFormat'); // the computed default

		input = view.opt('slotLabelInterval');
		this.labelInterval = input ?
			confimoment.duration(input) :
			this.computeLabelInterval(slotDuration);
	},


	// Computes an automatic value for slotLabelInterval
	computeLabelInterval: function(slotDuration) {
		var i;
		var labelInterval;
		var slotsPerLabel;

		// find the smallest stock label interval that results in more than one slots-per-label
		for (i = AGENDA_STOCK_SUB_DURATIONS.length - 1; i >= 0; i--) {
			labelInterval = confimoment.duration(AGENDA_STOCK_SUB_DURATIONS[i]);
			slotsPerLabel = divideDurationByDuration(labelInterval, slotDuration);
			if (isInt(slotsPerLabel) && slotsPerLabel > 1) {
				return labelInterval;
			}
		}

		return confimoment.duration(slotDuration); // fall back. clone
	},


	// Computes a default event time formatting string if `timeFormat` is not explicitly defined
	computeEventTimeFormat: function() {
		return this.view.opt('noMeridiemTimeFormat'); // like "6:30" (no AM/PM)
	},


	// Computes a default `displayEventEnd` value if one is not expliclty defined
	computeDisplayEventEnd: function() {
		return true;
	},


	/* Hit System
	------------------------------------------------------------------------------------------------------------------*/


	prepareHits: function() {
		this.colCoordCache.build();
		this.slatCoordCache.build();
	},


	releaseHits: function() {
		this.colCoordCache.clear();
		// NOTE: don't clear slatCoordCache because we rely on it for computeTimeTop
	},


	queryHit: function(leftOffset, topOffset) {
		var snapsPerSlot = this.snapsPerSlot;
		var colCoordCache = this.colCoordCache;
		var slatCoordCache = this.slatCoordCache;
		var colIndex = colCoordCache.getHorizontalIndex(leftOffset);
		var slatIndex = slatCoordCache.getVerticalIndex(topOffset);

		if (colIndex != null && slatIndex != null) {
			var slatTop = slatCoordCache.getTopOffset(slatIndex);
			var slatHeight = slatCoordCache.getHeight(slatIndex);
			var partial = (topOffset - slatTop) / slatHeight; // floating point number between 0 and 1
			var localSnapIndex = Math.floor(partial * snapsPerSlot); // the snap # relative to start of slat
			var snapIndex = slatIndex * snapsPerSlot + localSnapIndex;
			var snapTop = slatTop + (localSnapIndex / snapsPerSlot) * slatHeight;
			var snapBottom = slatTop + ((localSnapIndex + 1) / snapsPerSlot) * slatHeight;

			return {
				col: colIndex,
				snap: snapIndex,
				component: this, // needed unfortunately :(
				left: colCoordCache.getLeftOffset(colIndex),
				right: colCoordCache.getRightOffset(colIndex),
				top: snapTop,
				bottom: snapBottom
			};
		}
	},


	getHitSpan: function(hit) {
		var start = this.getCellDate(0, hit.col); // row=0
		var time = this.computeSnapTime(hit.snap); // pass in the snap-index
		var end;

		start.time(time);
		end = start.clone().add(this.snapDuration);

		return { start: start, end: end };
	},


	getHitEl: function(hit) {
		return this.colEls.eq(hit.col);
	},


	/* Dates
	------------------------------------------------------------------------------------------------------------------*/


	rangeUpdated: function() {
		this.updateDayTable();
	},


	// Given a row number of the grid, representing a "snap", returns a time (Duration) from its start-of-day
	computeSnapTime: function(snapIndex) {
		return confimoment.duration(this.minTime + this.snapDuration * snapIndex);
	},


	// Slices up the given span (unzoned start/end with other misc data) into an array of segments
	spanToSegs: function(span) {
		var segs = this.sliceRangeByTimes(span);
		var i;

		for (i = 0; i < segs.length; i++) {
			if (this.isRTL) {
				segs[i].col = this.daysPerRow - 1 - segs[i].dayIndex;
			}
			else {
				segs[i].col = segs[i].dayIndex;
			}
		}

		return segs;
	},


	sliceRangeByTimes: function(range) {
		var segs = [];
		var seg;
		var dayIndex;
		var dayDate;
		var dayRange;

		for (dayIndex = 0; dayIndex < this.daysPerRow; dayIndex++) {
			dayDate = this.dayDates[dayIndex].clone(); // TODO: better API for this?
			dayRange = {
				start: dayDate.clone().time(this.minTime),
				end: dayDate.clone().time(this.maxTime)
			};
			seg = intersectRanges(range, dayRange); // both will be ambig timezone
			if (seg) {
				seg.dayIndex = dayIndex;
				segs.push(seg);
			}
		}

		return segs;
	},


	/* Coordinates
	------------------------------------------------------------------------------------------------------------------*/


	updateSize: function(isResize) { // NOT a standard Grid method
		this.slatCoordCache.build();

		if (isResize) {
			this.updateSegVerticals();
		}
	},


	// Computes the top coordinate, relative to the bounds of the grid, of the given date.
	// A `startOfDayDate` must be given for avoiding ambiguity over how to treat midnight.
	computeDateTop: function(date, startOfDayDate) {
		return this.computeTimeTop(
			confimoment.duration(
				date - startOfDayDate.clone().stripTime()
			)
		);
	},


	// Computes the top coordinate, relative to the bounds of the grid, of the given time (a Duration).
	computeTimeTop: function(time) {
		var len = this.slatEls.length;
		var slatCoverage = (time - this.minTime) / this.slotDuration; // floating-point value of # of slots covered
		var slatIndex;
		var slatRemainder;

		// compute a floating-point number for how many slats should be progressed through.
		// from 0 to number of slats (inclusive)
		// constrained because minTime/maxTime might be customized.
		slatCoverage = Math.max(0, slatCoverage);
		slatCoverage = Math.min(len, slatCoverage);

		// an integer index of the furthest whole slat
		// from 0 to number slats (*exclusive*, so len-1)
		slatIndex = Math.floor(slatCoverage);
		slatIndex = Math.min(slatIndex, len - 1);

		// how much further through the slatIndex slat (from 0.0-1.0) must be covered in addition.
		// could be 1.0 if slatCoverage is covering *all* the slots
		slatRemainder = slatCoverage - slatIndex;

		return this.slatCoordCache.getTopPosition(slatIndex) +
			this.slatCoordCache.getHeight(slatIndex) * slatRemainder;
	},



	/* Event Drag Visualization
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of an event being dragged over the specified date(s).
	// A returned value of `true` signals that a mock "helper" event has been rendered.
	renderDrag: function(eventLocation, seg) {

		if (seg) { // if there is event information for this drag, render a helper event
			this.renderEventLocationHelper(eventLocation, seg);
			this.applyDragOpacity(this.helperEl);

			return true; // signal that a helper has been rendered
		}
		else {
			// otherwise, just render a highlight
			this.renderHighlight(this.eventToSpan(eventLocation));
		}
	},


	// Unrenders any visual indication of an event being dragged
	unrenderDrag: function() {
		this.unrenderHelper();
		this.unrenderHighlight();
	},


	/* Event Resize Visualization
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of an event being resized
	renderEventResize: function(eventLocation, seg) {
		this.renderEventLocationHelper(eventLocation, seg);
	},


	// Unrenders any visual indication of an event being resized
	unrenderEventResize: function() {
		this.unrenderHelper();
	},


	/* Event Helper
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a mock "helper" event. `sourceSeg` is the original segment object and might be null (an external drag)
	renderHelper: function(event, sourceSeg) {
		var segs = this.eventToSegs(event);
		var tableEl;
		var i, seg;
		var sourceEl;

		segs = this.renderFgSegEls(segs); // assigns each seg's el and returns a subset of segs that were rendered
		tableEl = this.renderSegTable(segs);

		// Try to make the segment that is in the same row as sourceSeg look the same
		for (i = 0; i < segs.length; i++) {
			seg = segs[i];
			if (sourceSeg && sourceSeg.col === seg.col) {
				sourceEl = sourceSeg.el;
				seg.el.css({
					left: sourceEl.css('left'),
					right: sourceEl.css('right'),
					'margin-left': sourceEl.css('margin-left'),
					'margin-right': sourceEl.css('margin-right')
				});
			}
		}

		this.helperEl = $('<div class="fc-helper-skeleton"/>')
			.append(tableEl)
				.appendTo(this.el);
	},


	// Unrenders any mock helper event
	unrenderHelper: function() {
		if (this.helperEl) {
			this.helperEl.remove();
			this.helperEl = null;
		}
	},


	/* Selection
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of a selection. Overrides the default, which was to simply render a highlight.
	renderSelection: function(span) {
		if (this.view.opt('selectHelper')) { // this setting signals that a mock helper event should be rendered

			// normally acceps an eventLocation, span has a start/end, which is good enough
			this.renderEventLocationHelper(span);
		}
		else {
			this.renderHighlight(span);
		}
	},


	// Unrenders any visual indication of a selection
	unrenderSelection: function() {
		this.unrenderHelper();
		this.unrenderHighlight();
	},


	/* Fill System (highlight, background events, business hours)
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a set of rectangles over the given time segments.
	// Only returns segments that successfully rendered.
	renderFill: function(type, segs, className) {
		var segCols;
		var skeletonEl;
		var trEl;
		var col, colSegs;
		var tdEl;
		var containerEl;
		var dayDate;
		var i, seg;

		if (segs.length) {

			segs = this.renderFillSegEls(type, segs); // assignes `.el` to each seg. returns successfully rendered segs
			segCols = this.groupSegCols(segs); // group into sub-arrays, and assigns 'col' to each seg

			className = className || type.toLowerCase();
			skeletonEl = $(
				'<div class="fc-' + className + '-skeleton">' +
					'<table><tr/></table>' +
				'</div>'
			);
			trEl = skeletonEl.find('tr');

			for (col = 0; col < segCols.length; col++) {
				colSegs = segCols[col];
				tdEl = $('<td/>').appendTo(trEl);

				if (colSegs.length) {
					containerEl = $('<div class="fc-' + className + '-container"/>').appendTo(tdEl);
					dayDate = this.getCellDate(0, col); // row=0

					for (i = 0; i < colSegs.length; i++) {
						seg = colSegs[i];
						containerEl.append(
							seg.el.css({
								top: this.computeDateTop(seg.start, dayDate),
								bottom: -this.computeDateTop(seg.end, dayDate) // the y position of the bottom edge
							})
						);
					}
				}
			}

			this.bookendCells(trEl);

			this.el.append(skeletonEl);
			this.elsByFill[type] = skeletonEl;
		}

		return segs;
	}

});

;;

/* Event-rendering methods for the TimeGrid class
----------------------------------------------------------------------------------------------------------------------*/

TimeGrid.mixin({

	eventSkeletonEl: null, // has cells with event-containers, which contain absolutely positioned event elements


	// Renders the given foreground event segments onto the grid
	renderFgSegs: function(segs) {
		segs = this.renderFgSegEls(segs); // returns a subset of the segs. segs that were actually rendered

		this.el.append(
			this.eventSkeletonEl = $('<div class="fc-content-skeleton"/>')
				.append(this.renderSegTable(segs))
		);

		return segs; // return only the segs that were actually rendered
	},


	// Unrenders all currently rendered foreground event segments
	unrenderFgSegs: function(segs) {
		if (this.eventSkeletonEl) {
			this.eventSkeletonEl.remove();
			this.eventSkeletonEl = null;
		}
	},


	// Renders and returns the <table> portion of the event-skeleton.
	// Returns an object with properties 'tbodyEl' and 'segs'.
	renderSegTable: function(segs) {
		var tableEl = $('<table><tr/></table>');
		var trEl = tableEl.find('tr');
		var segCols;
		var i, seg;
		var col, colSegs;
		var containerEl;

		segCols = this.groupSegCols(segs); // group into sub-arrays, and assigns 'col' to each seg

		this.computeSegVerticals(segs); // compute and assign top/bottom

		for (col = 0; col < segCols.length; col++) { // iterate each column grouping
			colSegs = segCols[col];
			this.placeSlotSegs(colSegs); // compute horizontal coordinates, z-index's, and reorder the array

			containerEl = $('<div class="fc-event-container"/>');

			// assign positioning CSS and insert into container
			for (i = 0; i < colSegs.length; i++) {
				seg = colSegs[i];
				seg.el.css(this.generateSegPositionCss(seg));

				// if the height is short, add a className for alternate styling
				if (seg.bottom - seg.top < 30) {
					seg.el.addClass('fc-short');
				}

				containerEl.append(seg.el);
			}

			trEl.append($('<td/>').append(containerEl));
		}

		this.bookendCells(trEl);

		return tableEl;
	},


	// Given an array of segments that are all in the same column, sets the backwardCoord and forwardCoord on each.
	// NOTE: Also reorders the given array by date!
	placeSlotSegs: function(segs) {
		var levels;
		var level0;
		var i;

		this.sortEventSegs(segs); // order by certain criteria
		levels = buildSlotSegLevels(segs);
		computeForwardSlotSegs(levels);

		if ((level0 = levels[0])) {

			for (i = 0; i < level0.length; i++) {
				computeSlotSegPressures(level0[i]);
			}

			for (i = 0; i < level0.length; i++) {
				this.computeSlotSegCoords(level0[i], 0, 0);
			}
		}
	},


	// Calculate seg.forwardCoord and seg.backwardCoord for the segment, where both values range
	// from 0 to 1. If the calendar is left-to-right, the seg.backwardCoord maps to "left" and
	// seg.forwardCoord maps to "right" (via percentage). Vice-versa if the calendar is right-to-left.
	//
	// The segment might be part of a "series", which means consecutive segments with the same pressure
	// who's width is unknown until an edge has been hit. `seriesBackwardPressure` is the number of
	// segments behind this one in the current series, and `seriesBackwardCoord` is the starting
	// coordinate of the first segment in the series.
	computeSlotSegCoords: function(seg, seriesBackwardPressure, seriesBackwardCoord) {
		var forwardSegs = seg.forwardSegs;
		var i;

		if (seg.forwardCoord === undefined) { // not already computed

			if (!forwardSegs.length) {

				// if there are no forward segments, this segment should butt up against the edge
				seg.forwardCoord = 1;
			}
			else {

				// sort highest pressure first
				this.sortForwardSlotSegs(forwardSegs);

				// this segment's forwardCoord will be calculated from the backwardCoord of the
				// highest-pressure forward segment.
				this.computeSlotSegCoords(forwardSegs[0], seriesBackwardPressure + 1, seriesBackwardCoord);
				seg.forwardCoord = forwardSegs[0].backwardCoord;
			}

			// calculate the backwardCoord from the forwardCoord. consider the series
			seg.backwardCoord = seg.forwardCoord -
				(seg.forwardCoord - seriesBackwardCoord) / // available width for series
				(seriesBackwardPressure + 1); // # of segments in the series

			// use this segment's coordinates to computed the coordinates of the less-pressurized
			// forward segments
			for (i=0; i<forwardSegs.length; i++) {
				this.computeSlotSegCoords(forwardSegs[i], 0, seg.forwardCoord);
			}
		}
	},


	// Refreshes the CSS top/bottom coordinates for each segment element. Probably after a window resize/zoom.
	// Repositions business hours segs too, so not just for events. Maybe shouldn't be here.
	updateSegVerticals: function() {
		var allSegs = (this.segs || []).concat(this.businessHourSegs || []);
		var i;

		this.computeSegVerticals(allSegs);

		for (i = 0; i < allSegs.length; i++) {
			allSegs[i].el.css(
				this.generateSegVerticalCss(allSegs[i])
			);
		}
	},


	// For each segment in an array, computes and assigns its top and bottom properties
	computeSegVerticals: function(segs) {
		var i, seg;

		for (i = 0; i < segs.length; i++) {
			seg = segs[i];
			seg.top = this.computeDateTop(seg.start, seg.start);
			seg.bottom = this.computeDateTop(seg.end, seg.start);
		}
	},


	// Renders the HTML for a single event segment's default rendering
	fgSegHtml: function(seg, disableResizing) {
		var view = this.view;
		var event = seg.event;
		var isDraggable = view.isEventDraggable(event);
		var isResizableFromStart = !disableResizing && seg.isStart && view.isEventResizableFromStart(event);
		var isResizableFromEnd = !disableResizing && seg.isEnd && view.isEventResizableFromEnd(event);
		var classes = this.getSegClasses(seg, isDraggable, isResizableFromStart || isResizableFromEnd);
		var skinCss = cssToStr(this.getEventSkinCss(event));
		var timeText;
		var fullTimeText; // more verbose time text. for the print stylesheet
		var startTimeText; // just the start time text

		classes.unshift('fc-time-grid-event', 'fc-v-event');

		if (view.isMultiDayEvent(event)) { // if the event appears to span more than one day...
			// Don't display time text on segments that run entirely through a day.
			// That would appear as midnight-midnight and would look dumb.
			// Otherwise, display the time text for the *segment's* times (like 6pm-midnight or midnight-10am)
			if (seg.isStart || seg.isEnd) {
				timeText = this.getEventTimeText(seg);
				fullTimeText = this.getEventTimeText(seg, 'LT');
				startTimeText = this.getEventTimeText(seg, null, false); // displayEnd=false
			}
		} else {
			// Display the normal time text for the *event's* times
			timeText = this.getEventTimeText(event);
			fullTimeText = this.getEventTimeText(event, 'LT');
			startTimeText = this.getEventTimeText(event, null, false); // displayEnd=false
		}

		return '<a class="' + classes.join(' ') + '"' +
			(event.url ?
				' href="' + htmlEscape(event.url) + '"' :
				''
				) +
			(skinCss ?
				' style="' + skinCss + '"' :
				''
				) +
			'>' +
				'<div class="fc-content">' +
					(timeText ?
						'<div class="fc-time"' +
						' data-start="' + htmlEscape(startTimeText) + '"' +
						' data-full="' + htmlEscape(fullTimeText) + '"' +
						'>' +
							'<span>' + htmlEscape(timeText) + '</span>' +
						'</div>' :
						''
						) +
					(event.title ?
            '<div class="fc-title" title="' + htmlEscape(event.title) + '">' +
	            htmlEscape(event.title) +
            '</div>' :
						''
						) +
				'</div>' +
				'<div class="fc-bg"/>' +
				/* TODO: write CSS for this
				(isResizableFromStart ?
					'<div class="fc-resizer fc-start-resizer" />' :
					''
					) +
				*/
				(isResizableFromEnd ?
					'<div class="fc-resizer fc-end-resizer" />' :
					''
					) +
			'</a>';
	},


	// Generates an object with CSS properties/values that should be applied to an event segment element.
	// Contains important positioning-related properties that should be applied to any event element, customized or not.
	generateSegPositionCss: function(seg) {
		var shouldOverlap = this.view.opt('slotEventOverlap');
		var backwardCoord = seg.backwardCoord; // the left side if LTR. the right side if RTL. floating-point
		var forwardCoord = seg.forwardCoord; // the right side if LTR. the left side if RTL. floating-point
		var props = this.generateSegVerticalCss(seg); // get top/bottom first
		var left; // amount of space from left edge, a fraction of the total width
		var right; // amount of space from right edge, a fraction of the total width

		if (shouldOverlap) {
			// double the width, but don't go beyond the maximum forward coordinate (1.0)
			forwardCoord = Math.min(1, backwardCoord + (forwardCoord - backwardCoord) * 2);
		}

		if (this.isRTL) {
			left = 1 - forwardCoord;
			right = backwardCoord;
		}
		else {
			left = backwardCoord;
			right = 1 - forwardCoord;
		}

		props.zIndex = seg.level + 1; // convert from 0-base to 1-based
		props.left = left * 100 + '%';
		props.right = right * 100 + '%';

		if (shouldOverlap && seg.forwardPressure) {
			// add padding to the edge so that forward stacked events don't cover the resizer's icon
			props[this.isRTL ? 'marginLeft' : 'marginRight'] = 10 * 2; // 10 is a guesstimate of the icon's width
		}

		return props;
	},


	// Generates an object with CSS properties for the top/bottom coordinates of a segment element
	generateSegVerticalCss: function(seg) {
		return {
			top: seg.top,
			bottom: -seg.bottom // flipped because needs to be space beyond bottom edge of event container
		};
	},


	// Given a flat array of segments, return an array of sub-arrays, grouped by each segment's col
	groupSegCols: function(segs) {
		var segCols = [];
		var i;

		for (i = 0; i < this.colCnt; i++) {
			segCols.push([]);
		}

		for (i = 0; i < segs.length; i++) {
			segCols[segs[i].col].push(segs[i]);
		}

		return segCols;
	},


	sortForwardSlotSegs: function(forwardSegs) {
		forwardSegs.sort(proxy(this, 'compareForwardSlotSegs'));
	},


	// A cmp function for determining which forward segment to rely on more when computing coordinates.
	compareForwardSlotSegs: function(seg1, seg2) {
		// put higher-pressure first
		return seg2.forwardPressure - seg1.forwardPressure ||
			// put segments that are closer to initial edge first (and favor ones with no coords yet)
			(seg1.backwardCoord || 0) - (seg2.backwardCoord || 0) ||
			// do normal sorting...
			this.compareEventSegs(seg1, seg2);
	}

});


// Builds an array of segments "levels". The first level will be the leftmost tier of segments if the calendar is
// left-to-right, or the rightmost if the calendar is right-to-left. Assumes the segments are already ordered by date.
function buildSlotSegLevels(segs) {
	var levels = [];
	var i, seg;
	var j;

	for (i=0; i<segs.length; i++) {
		seg = segs[i];

		// go through all the levels and stop on the first level where there are no collisions
		for (j=0; j<levels.length; j++) {
			if (!computeSlotSegCollisions(seg, levels[j]).length) {
				break;
			}
		}

		seg.level = j;

		(levels[j] || (levels[j] = [])).push(seg);
	}

	return levels;
}


// For every segment, figure out the other segments that are in subsequent
// levels that also occupy the same vertical space. Accumulate in seg.forwardSegs
function computeForwardSlotSegs(levels) {
	var i, level;
	var j, seg;
	var k;

	for (i=0; i<levels.length; i++) {
		level = levels[i];

		for (j=0; j<level.length; j++) {
			seg = level[j];

			seg.forwardSegs = [];
			for (k=i+1; k<levels.length; k++) {
				computeSlotSegCollisions(seg, levels[k], seg.forwardSegs);
			}
		}
	}
}


// Figure out which path forward (via seg.forwardSegs) results in the longest path until
// the furthest edge is reached. The number of segments in this path will be seg.forwardPressure
function computeSlotSegPressures(seg) {
	var forwardSegs = seg.forwardSegs;
	var forwardPressure = 0;
	var i, forwardSeg;

	if (seg.forwardPressure === undefined) { // not already computed

		for (i=0; i<forwardSegs.length; i++) {
			forwardSeg = forwardSegs[i];

			// figure out the child's maximum forward path
			computeSlotSegPressures(forwardSeg);

			// either use the existing maximum, or use the child's forward pressure
			// plus one (for the forwardSeg itself)
			forwardPressure = Math.max(
				forwardPressure,
				1 + forwardSeg.forwardPressure
			);
		}

		seg.forwardPressure = forwardPressure;
	}
}


// Find all the segments in `otherSegs` that vertically collide with `seg`.
// Append into an optionally-supplied `results` array and return.
function computeSlotSegCollisions(seg, otherSegs, results) {
	results = results || [];

	for (var i=0; i<otherSegs.length; i++) {
		if (isSlotSegCollision(seg, otherSegs[i])) {
			results.push(otherSegs[i]);
		}
	}

	return results;
}


// Do these segments occupy the same vertical space?
function isSlotSegCollision(seg1, seg2) {
	return seg1.bottom > seg2.top && seg1.top < seg2.bottom;
}

;;

/* An abstract class from which other views inherit from
----------------------------------------------------------------------------------------------------------------------*/

var View = FC.View = Class.extend({

	type: null, // subclass' view name (string)
	name: null, // deprecated. use `type` instead
	title: null, // the text that will be displayed in the header's title

	calendar: null, // owner Calendar object
	options: null, // hash containing all options. already merged with view-specific-options
	el: null, // the view's containing element. set by Calendar

	displaying: null, // a promise representing the state of rendering. null if no render requested
	isSkeletonRendered: false,
	isEventsRendered: false,

	// range the view is actually displaying (moments)
	start: null,
	end: null, // exclusive

	// range the view is formally responsible for (moments)
	// may be different from start/end. for example, a month view might have 1st-31st, excluding padded dates
	intervalStart: null,
	intervalEnd: null, // exclusive
	intervalDuration: null,
	intervalUnit: null, // name of largest unit being displayed, like "month" or "week"

	isRTL: false,
	isSelected: false, // boolean whether a range of time is user-selected or not

	eventOrderSpecs: null, // criteria for ordering events when they have same date/time

	// subclasses can optionally use a scroll container
	scrollerEl: null, // the element that will most likely scroll when content is too tall
	scrollTop: null, // cached vertical scroll value

	// classNames styled by jqui themes
	widgetHeaderClass: null,
	widgetContentClass: null,
	highlightStateClass: null,

	// for date utils, computed from options
	nextDayThreshold: null,
	isHiddenDayHash: null,

	// document handlers, bound to `this` object
	documentMousedownProxy: null, // TODO: doesn't work with touch


	constructor: function(calendar, type, options, intervalDuration) {

		this.calendar = calendar;
		this.type = this.name = type; // .name is deprecated
		this.options = options;
		this.intervalDuration = intervalDuration || confimoment.duration(1, 'day');

		this.nextDayThreshold = confimoment.duration(this.opt('nextDayThreshold'));
		this.initThemingProps();
		this.initHiddenDays();
		this.isRTL = this.opt('isRTL');

		this.eventOrderSpecs = parseFieldSpecs(this.opt('eventOrder'));

		this.documentMousedownProxy = proxy(this, 'documentMousedown');

		this.initialize();
	},


	// A good place for subclasses to initialize member variables
	initialize: function() {
		// subclasses can implement
	},


	// Retrieves an option with the given name
	opt: function(name) {
		return this.options[name];
	},


	// Triggers handlers that are view-related. Modifies args before passing to calendar.
	trigger: function(name, thisObj) { // arguments beyond thisObj are passed along
		var calendar = this.calendar;

		return calendar.trigger.apply(
			calendar,
			[name, thisObj || this].concat(
				Array.prototype.slice.call(arguments, 2), // arguments beyond thisObj
				[ this ] // always make the last argument a reference to the view. TODO: deprecate
			)
		);
	},


	/* Dates
	------------------------------------------------------------------------------------------------------------------*/


	// Updates all internal dates to center around the given current unzoned date.
	setDate: function(date) {
		this.setRange(this.computeRange(date));
	},


	// Updates all internal dates for displaying the given unzoned range.
	setRange: function(range) {
		$.extend(this, range); // assigns every property to this object's member variables
		this.updateTitle();
	},


	// Given a single current unzoned date, produce information about what range to display.
	// Subclasses can override. Must return all properties.
	computeRange: function(date) {
		var intervalUnit = computeIntervalUnit(this.intervalDuration);
		var intervalStart = date.clone().startOf(intervalUnit);
		var intervalEnd = intervalStart.clone().add(this.intervalDuration);
		var start, end;

		// normalize the range's time-ambiguity
		if (/year|month|week|day/.test(intervalUnit)) { // whole-days?
			intervalStart.stripTime();
			intervalEnd.stripTime();
		}
		else { // needs to have a time?
			if (!intervalStart.hasTime()) {
				intervalStart = this.calendar.time(0); // give 00:00 time
			}
			if (!intervalEnd.hasTime()) {
				intervalEnd = this.calendar.time(0); // give 00:00 time
			}
		}

		start = intervalStart.clone();
		start = this.skipHiddenDays(start);
		end = intervalEnd.clone();
		end = this.skipHiddenDays(end, -1, true); // exclusively move backwards

		return {
			intervalUnit: intervalUnit,
			intervalStart: intervalStart,
			intervalEnd: intervalEnd,
			start: start,
			end: end
		};
	},


	// Computes the new date when the user hits the prev button, given the current date
	computePrevDate: function(date) {
		return this.massageCurrentDate(
			date.clone().startOf(this.intervalUnit).subtract(this.intervalDuration), -1
		);
	},


	// Computes the new date when the user hits the next button, given the current date
	computeNextDate: function(date) {
		return this.massageCurrentDate(
			date.clone().startOf(this.intervalUnit).add(this.intervalDuration)
		);
	},


	// Given an arbitrarily calculated current date of the calendar, returns a date that is ensured to be completely
	// visible. `direction` is optional and indicates which direction the current date was being
	// incremented or decremented (1 or -1).
	massageCurrentDate: function(date, direction) {
		if (this.intervalDuration.as('days') <= 1) { // if the view displays a single day or smaller
			if (this.isHiddenDay(date)) {
				date = this.skipHiddenDays(date, direction);
				date.startOf('day');
			}
		}

		return date;
	},


	/* Title and Date Formatting
	------------------------------------------------------------------------------------------------------------------*/


	// Sets the view's title property to the most updated computed value
	updateTitle: function() {
		this.title = this.computeTitle();
	},


	// Computes what the title at the top of the calendar should be for this view
	computeTitle: function() {
		return this.formatRange(
			{
				// in case intervalStart/End has a time, make sure timezone is correct
				start: this.calendar.applyTimezone(this.intervalStart),
				end: this.calendar.applyTimezone(this.intervalEnd)
			},
			this.opt('titleFormat') || this.computeTitleFormat(),
			this.opt('titleRangeSeparator')
		);
	},


	// Generates the format string that should be used to generate the title for the current date range.
	// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.
	computeTitleFormat: function() {
		if (this.intervalUnit == 'year') {
			return 'YYYY';
		}
		else if (this.intervalUnit == 'month') {
			return this.opt('monthYearFormat'); // like "September 2014"
		}
		else if (this.intervalDuration.as('days') > 1) {
			return 'll'; // multi-day range. shorter, like "Sep 9 - 10 2014"
		}
		else {
			return 'LL'; // one day. longer, like "September 9 2014"
		}
	},


	// Utility for formatting a range. Accepts a range object, formatting string, and optional separator.
	// Displays all-day ranges naturally, with an inclusive end. Takes the current isRTL into account.
	// The timezones of the dates within `range` will be respected.
	formatRange: function(range, formatStr, separator) {
		var end = range.end;

		if (!end.hasTime()) { // all-day?
			end = end.clone().subtract(1); // convert to inclusive. last ms of previous day
		}

		return formatRange(range.start, end, formatStr, separator, this.opt('isRTL'));
	},


	/* Rendering
	------------------------------------------------------------------------------------------------------------------*/


	// Sets the container element that the view should render inside of.
	// Does other DOM-related initializations.
	setElement: function(el) {
		this.el = el;
		this.bindGlobalHandlers();
	},


	// Removes the view's container element from the DOM, clearing any content beforehand.
	// Undoes any other DOM-related attachments.
	removeElement: function() {
		this.clear(); // clears all content

		// clean up the skeleton
		if (this.isSkeletonRendered) {
			this.unrenderSkeleton();
			this.isSkeletonRendered = false;
		}

		this.unbindGlobalHandlers();

		this.el.remove();

		// NOTE: don't null-out this.el in case the View was destroyed within an API callback.
		// We don't null-out the View's other jQuery element references upon destroy,
		//  so we shouldn't kill this.el either.
	},


	// Does everything necessary to display the view centered around the given unzoned date.
	// Does every type of rendering EXCEPT rendering events.
	// Is asychronous and returns a promise.
	display: function(date) {
		var _this = this;
		var scrollState = null;

		if (this.displaying) {
			scrollState = this.queryScroll();
		}

		this.calendar.freezeContentHeight();

		return this.clear().then(function() { // clear the content first (async)
			return (
				_this.displaying =
					$.when(_this.displayView(date)) // displayView might return a promise
						.then(function() {
							_this.forceScroll(_this.computeInitialScroll(scrollState));
							_this.calendar.unfreezeContentHeight();
							_this.triggerRender();
						})
			);
		});
	},


	// Does everything necessary to clear the content of the view.
	// Clears dates and events. Does not clear the skeleton.
	// Is asychronous and returns a promise.
	clear: function() {
		var _this = this;
		var displaying = this.displaying;

		if (displaying) { // previously displayed, or in the process of being displayed?
			return displaying.then(function() { // wait for the display to finish
				_this.displaying = null;
				_this.clearEvents();
				return _this.clearView(); // might return a promise. chain it
			});
		}
		else {
			return $.when(); // an immediately-resolved promise
		}
	},


	// If the view has already been displayed, tears it down and displays it again.
	// Will re-render the events if necessary, which display/clear DO NOT do.
	// TODO: make behavior more consistent.
	redisplay: function() {
		if (this.isSkeletonRendered) {
			var wasEventsRendered = this.isEventsRendered;
			this.clearEvents(); // won't trigger handlers if events never rendered
			this.clearView();
			this.displayView();
			if (wasEventsRendered) { // only render and trigger handlers if events previously rendered
				this.displayEvents();
			}
		}
	},


	// Displays the view's non-event content, such as date-related content or anything required by events.
	// Renders the view's non-content skeleton if necessary.
	// Can be asynchronous and return a promise.
	displayView: function(date) {
		if (!this.isSkeletonRendered) {
			this.renderSkeleton();
			this.isSkeletonRendered = true;
		}
		if (date) {
			this.setDate(date);
		}
		if (this.render) {
			this.render(); // TODO: deprecate
		}
		this.renderDates();
		this.updateSize();
		this.renderBusinessHours(); // might need coordinates, so should go after updateSize()
	},


	// Unrenders the view content that was rendered in displayView.
	// Can be asynchronous and return a promise.
	clearView: function() {
		this.unselect();
		this.triggerUnrender();
		this.unrenderBusinessHours();
		this.unrenderDates();
		if (this.destroy) {
			this.destroy(); // TODO: deprecate
		}
	},


	// Renders the basic structure of the view before any content is rendered
	renderSkeleton: function() {
		// subclasses should implement
	},


	// Unrenders the basic structure of the view
	unrenderSkeleton: function() {
		// subclasses should implement
	},


	// Renders the view's date-related content.
	// Assumes setRange has already been called and the skeleton has already been rendered.
	renderDates: function() {
		// subclasses should implement
	},


	// Unrenders the view's date-related content
	unrenderDates: function() {
		// subclasses should override
	},


	// Renders business-hours onto the view. Assumes updateSize has already been called.
	renderBusinessHours: function() {
		// subclasses should implement
	},


	// Unrenders previously-rendered business-hours
	unrenderBusinessHours: function() {
		// subclasses should implement
	},


	// Signals that the view's content has been rendered
	triggerRender: function() {
		this.trigger('viewRender', this, this, this.el);
	},


	// Signals that the view's content is about to be unrendered
	triggerUnrender: function() {
		this.trigger('viewDestroy', this, this, this.el);
	},


	// Binds DOM handlers to elements that reside outside the view container, such as the document
	bindGlobalHandlers: function() {
		$(document).on('mousedown', this.documentMousedownProxy);
	},


	// Unbinds DOM handlers from elements that reside outside the view container
	unbindGlobalHandlers: function() {
		$(document).off('mousedown', this.documentMousedownProxy);
	},


	// Initializes internal variables related to theming
	initThemingProps: function() {
		var tm = this.opt('theme') ? 'ui' : 'fc';

		this.widgetHeaderClass = tm + '-widget-header';
		this.widgetContentClass = tm + '-widget-content';
		this.highlightStateClass = tm + '-state-highlight';
	},


	/* Dimensions
	------------------------------------------------------------------------------------------------------------------*/


	// Refreshes anything dependant upon sizing of the container element of the grid
	updateSize: function(isResize) {
		var scrollState;

		if (isResize) {
			scrollState = this.queryScroll();
		}

		this.updateHeight(isResize);
		this.updateWidth(isResize);

		if (isResize) {
			this.setScroll(scrollState);
		}
	},


	// Refreshes the horizontal dimensions of the calendar
	updateWidth: function(isResize) {
		// subclasses should implement
	},


	// Refreshes the vertical dimensions of the calendar
	updateHeight: function(isResize) {
		var calendar = this.calendar; // we poll the calendar for height information

		this.setHeight(
			calendar.getSuggestedViewHeight(),
			calendar.isHeightAuto()
		);
	},


	// Updates the vertical dimensions of the calendar to the specified height.
	// if `isAuto` is set to true, height becomes merely a suggestion and the view should use its "natural" height.
	setHeight: function(height, isAuto) {
		// subclasses should implement
	},


	/* Scroller
	------------------------------------------------------------------------------------------------------------------*/


	// Given the total height of the view, return the number of pixels that should be used for the scroller.
	// Utility for subclasses.
	computeScrollerHeight: function(totalHeight) {
		var scrollerEl = this.scrollerEl;
		var both;
		var otherHeight; // cumulative height of everything that is not the scrollerEl in the view (header+borders)

		both = this.el.add(scrollerEl);

		// fuckin IE8/9/10/11 sometimes returns 0 for dimensions. this weird hack was the only thing that worked
		both.css({
			position: 'relative', // cause a reflow, which will force fresh dimension recalculation
			left: -1 // ensure reflow in case the el was already relative. negative is less likely to cause new scroll
		});
		otherHeight = this.el.outerHeight() - scrollerEl.height(); // grab the dimensions
		both.css({ position: '', left: '' }); // undo hack

		return totalHeight - otherHeight;
	},


	// Computes the initial pre-configured scroll state prior to allowing the user to change it.
	// Given the scroll state from the previous rendering. If first time rendering, given null.
	computeInitialScroll: function(previousScrollState) {
		return 0;
	},


	// Retrieves the view's current natural scroll state. Can return an arbitrary format.
	queryScroll: function() {
		if (this.scrollerEl) {
			return this.scrollerEl.scrollTop(); // operates on scrollerEl by default
		}
	},


	// Sets the view's scroll state. Will accept the same format computeInitialScroll and queryScroll produce.
	setScroll: function(scrollState) {
		if (this.scrollerEl) {
			return this.scrollerEl.scrollTop(scrollState); // operates on scrollerEl by default
		}
	},


	// Sets the scroll state, making sure to overcome any predefined scroll value the browser has in mind
	forceScroll: function(scrollState) {
		var _this = this;

		this.setScroll(scrollState);
		setTimeout(function() {
			_this.setScroll(scrollState);
		}, 0);
	},


	/* Event Elements / Segments
	------------------------------------------------------------------------------------------------------------------*/


	// Does everything necessary to display the given events onto the current view
	displayEvents: function(events) {
		var scrollState = this.queryScroll();

		this.clearEvents();
		this.renderEvents(events);
		this.isEventsRendered = true;
		this.setScroll(scrollState);
		this.triggerEventRender();
	},


	// Does everything necessary to clear the view's currently-rendered events
	clearEvents: function() {
		if (this.isEventsRendered) {
			this.triggerEventUnrender();
			if (this.destroyEvents) {
				this.destroyEvents(); // TODO: deprecate
			}
			this.unrenderEvents();
			this.isEventsRendered = false;
		}
	},


	// Renders the events onto the view.
	renderEvents: function(events) {
		// subclasses should implement
	},


	// Removes event elements from the view.
	unrenderEvents: function() {
		// subclasses should implement
	},


	// Signals that all events have been rendered
	triggerEventRender: function() {
		this.renderedEventSegEach(function(seg) {
			this.trigger('eventAfterRender', seg.event, seg.event, seg.el);
		});
		this.trigger('eventAfterAllRender');
	},


	// Signals that all event elements are about to be removed
	triggerEventUnrender: function() {
		this.renderedEventSegEach(function(seg) {
			this.trigger('eventDestroy', seg.event, seg.event, seg.el);
		});
	},


	// Given an event and the default element used for rendering, returns the element that should actually be used.
	// Basically runs events and elements through the eventRender hook.
	resolveEventEl: function(event, el) {
		var custom = this.trigger('eventRender', event, event, el);

		if (custom === false) { // means don't render at all
			el = null;
		}
		else if (custom && custom !== true) {
			el = $(custom);
		}

		return el;
	},


	// Hides all rendered event segments linked to the given event
	showEvent: function(event) {
		this.renderedEventSegEach(function(seg) {
			seg.el.css('visibility', '');
		}, event);
	},


	// Shows all rendered event segments linked to the given event
	hideEvent: function(event) {
		this.renderedEventSegEach(function(seg) {
			seg.el.css('visibility', 'hidden');
		}, event);
	},


	// Iterates through event segments that have been rendered (have an el). Goes through all by default.
	// If the optional `event` argument is specified, only iterates through segments linked to that event.
	// The `this` value of the callback function will be the view.
	renderedEventSegEach: function(func, event) {
		var segs = this.getEventSegs();
		var i;

		for (i = 0; i < segs.length; i++) {
			if (!event || segs[i].event._id === event._id) {
				if (segs[i].el) {
					func.call(this, segs[i]);
				}
			}
		}
	},


	// Retrieves all the rendered segment objects for the view
	getEventSegs: function() {
		// subclasses must implement
		return [];
	},


	/* Event Drag-n-Drop
	------------------------------------------------------------------------------------------------------------------*/


	// Computes if the given event is allowed to be dragged by the user
	isEventDraggable: function(event) {
		var source = event.source || {};

		return firstDefined(
			event.startEditable,
			source.startEditable,
			this.opt('eventStartEditable'),
			event.editable,
			source.editable,
			this.opt('editable')
		);
	},


	// Must be called when an event in the view is dropped onto new location.
	// `dropLocation` is an object that contains the new zoned start/end/allDay values for the event.
	reportEventDrop: function(event, dropLocation, largeUnit, el, ev) {
		var calendar = this.calendar;
		var mutateResult = calendar.mutateEvent(event, dropLocation, largeUnit);
		var undoFunc = function() {
			mutateResult.undo();
			calendar.reportEventChange();
		};

		this.triggerEventDrop(event, mutateResult.dateDelta, undoFunc, el, ev);
		calendar.reportEventChange(); // will rerender events
	},


	// Triggers event-drop handlers that have subscribed via the API
	triggerEventDrop: function(event, dateDelta, undoFunc, el, ev) {
		this.trigger('eventDrop', el[0], event, dateDelta, undoFunc, ev, {}); // {} = jqui dummy
	},


	/* External Element Drag-n-Drop
	------------------------------------------------------------------------------------------------------------------*/


	// Must be called when an external element, via jQuery UI, has been dropped onto the calendar.
	// `meta` is the parsed data that has been embedded into the dragging event.
	// `dropLocation` is an object that contains the new zoned start/end/allDay values for the event.
	reportExternalDrop: function(meta, dropLocation, el, ev, ui) {
		var eventProps = meta.eventProps;
		var eventInput;
		var event;

		// Try to build an event object and render it. TODO: decouple the two
		if (eventProps) {
			eventInput = $.extend({}, eventProps, dropLocation);
			event = this.calendar.renderEvent(eventInput, meta.stick)[0]; // renderEvent returns an array
		}

		this.triggerExternalDrop(event, dropLocation, el, ev, ui);
	},


	// Triggers external-drop handlers that have subscribed via the API
	triggerExternalDrop: function(event, dropLocation, el, ev, ui) {

		// trigger 'drop' regardless of whether element represents an event
		this.trigger('drop', el[0], dropLocation.start, ev, ui);

		if (event) {
			this.trigger('eventReceive', null, event); // signal an external event landed
		}
	},


	/* Drag-n-Drop Rendering (for both events and external elements)
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of a event or external-element drag over the given drop zone.
	// If an external-element, seg will be `null`
	renderDrag: function(dropLocation, seg) {
		// subclasses must implement
	},


	// Unrenders a visual indication of an event or external-element being dragged.
	unrenderDrag: function() {
		// subclasses must implement
	},


	/* Event Resizing
	------------------------------------------------------------------------------------------------------------------*/


	// Computes if the given event is allowed to be resized from its starting edge
	isEventResizableFromStart: function(event) {
		return this.opt('eventResizableFromStart') && this.isEventResizable(event);
	},


	// Computes if the given event is allowed to be resized from its ending edge
	isEventResizableFromEnd: function(event) {
		return this.isEventResizable(event);
	},


	// Computes if the given event is allowed to be resized by the user at all
	isEventResizable: function(event) {
		var source = event.source || {};

		return firstDefined(
			event.durationEditable,
			source.durationEditable,
			this.opt('eventDurationEditable'),
			event.editable,
			source.editable,
			this.opt('editable')
		);
	},


	// Must be called when an event in the view has been resized to a new length
	reportEventResize: function(event, resizeLocation, largeUnit, el, ev) {
		var calendar = this.calendar;
		var mutateResult = calendar.mutateEvent(event, resizeLocation, largeUnit);
		var undoFunc = function() {
			mutateResult.undo();
			calendar.reportEventChange();
		};

		this.triggerEventResize(event, mutateResult.durationDelta, undoFunc, el, ev);
		calendar.reportEventChange(); // will rerender events
	},


	// Triggers event-resize handlers that have subscribed via the API
	triggerEventResize: function(event, durationDelta, undoFunc, el, ev) {
		this.trigger('eventResize', el[0], event, durationDelta, undoFunc, ev, {}); // {} = jqui dummy
	},


	/* Selection
	------------------------------------------------------------------------------------------------------------------*/


	// Selects a date span on the view. `start` and `end` are both Moments.
	// `ev` is the native mouse event that begin the interaction.
	select: function(span, ev) {
		this.unselect(ev);
		this.renderSelection(span);
		this.reportSelection(span, ev);
	},


	// Renders a visual indication of the selection
	renderSelection: function(span) {
		// subclasses should implement
	},


	// Called when a new selection is made. Updates internal state and triggers handlers.
	reportSelection: function(span, ev) {
		this.isSelected = true;
		this.triggerSelect(span, ev);
	},


	// Triggers handlers to 'select'
	triggerSelect: function(span, ev) {
		this.trigger(
			'select',
			null,
			this.calendar.applyTimezone(span.start), // convert to calendar's tz for external API
			this.calendar.applyTimezone(span.end), // "
			ev
		);
	},


	// Undoes a selection. updates in the internal state and triggers handlers.
	// `ev` is the native mouse event that began the interaction.
	unselect: function(ev) {
		if (this.isSelected) {
			this.isSelected = false;
			if (this.destroySelection) {
				this.destroySelection(); // TODO: deprecate
			}
			this.unrenderSelection();
			this.trigger('unselect', null, ev);
		}
	},


	// Unrenders a visual indication of selection
	unrenderSelection: function() {
		// subclasses should implement
	},


	// Handler for unselecting when the user clicks something and the 'unselectAuto' setting is on
	documentMousedown: function(ev) {
		var ignore;

		// is there a selection, and has the user made a proper left click?
		if (this.isSelected && this.opt('unselectAuto') && isPrimaryMouseButton(ev)) {

			// only unselect if the clicked element is not identical to or inside of an 'unselectCancel' element
			ignore = this.opt('unselectCancel');
			if (!ignore || !$(ev.target).closest(ignore).length) {
				this.unselect(ev);
			}
		}
	},


	/* Day Click
	------------------------------------------------------------------------------------------------------------------*/


	// Triggers handlers to 'dayClick'
	// Span has start/end of the clicked area. Only the start is useful.
	triggerDayClick: function(span, dayEl, ev) {
		this.trigger(
			'dayClick',
			dayEl,
			this.calendar.applyTimezone(span.start), // convert to calendar's timezone for external API
			ev
		);
	},


	/* Date Utils
	------------------------------------------------------------------------------------------------------------------*/


	// Initializes internal variables related to calculating hidden days-of-week
	initHiddenDays: function() {
		var hiddenDays = this.opt('hiddenDays') || []; // array of day-of-week indices that are hidden
		var isHiddenDayHash = []; // is the day-of-week hidden? (hash with day-of-week-index -> bool)
		var dayCnt = 0;
		var i;

		if (this.opt('weekends') === false) {
			hiddenDays.push(0, 6); // 0=sunday, 6=saturday
		}

		for (i = 0; i < 7; i++) {
			if (
				!(isHiddenDayHash[i] = $.inArray(i, hiddenDays) !== -1)
			) {
				dayCnt++;
			}
		}

		if (!dayCnt) {
			throw 'invalid hiddenDays'; // all days were hidden? bad.
		}

		this.isHiddenDayHash = isHiddenDayHash;
	},


	// Is the current day hidden?
	// `day` is a day-of-week index (0-6), or a Moment
	isHiddenDay: function(day) {
		if (confimoment.isMoment(day)) {
			day = day.day();
		}
		return this.isHiddenDayHash[day];
	},


	// Incrementing the current day until it is no longer a hidden day, returning a copy.
	// If the initial value of `date` is not a hidden day, don't do anything.
	// Pass `isExclusive` as `true` if you are dealing with an end date.
	// `inc` defaults to `1` (increment one day forward each time)
	skipHiddenDays: function(date, inc, isExclusive) {
		var out = date.clone();
		inc = inc || 1;
		while (
			this.isHiddenDayHash[(out.day() + (isExclusive ? inc : 0) + 7) % 7]
		) {
			out.add(inc, 'days');
		}
		return out;
	},


	// Returns the date range of the full days the given range visually appears to occupy.
	// Returns a new range object.
	computeDayRange: function(range) {
		var startDay = range.start.clone().stripTime(); // the beginning of the day the range starts
		var end = range.end;
		var endDay = null;
		var endTimeMS;

		if (end) {
			endDay = end.clone().stripTime(); // the beginning of the day the range exclusively ends
			endTimeMS = +end.time(); // # of milliseconds into `endDay`

			// If the end time is actually inclusively part of the next day and is equal to or
			// beyond the next day threshold, adjust the end to be the exclusive end of `endDay`.
			// Otherwise, leaving it as inclusive will cause it to exclude `endDay`.
			if (endTimeMS && endTimeMS >= this.nextDayThreshold) {
				endDay.add(1, 'days');
			}
		}

		// If no end was specified, or if it is within `startDay` but not past nextDayThreshold,
		// assign the default duration of one day.
		if (!end || endDay <= startDay) {
			endDay = startDay.clone().add(1, 'days');
		}

		return { start: startDay, end: endDay };
	},


	// Does the given event visually appear to occupy more than one day?
	isMultiDayEvent: function(event) {
		var range = this.computeDayRange(event); // event is range-ish

		return range.end.diff(range.start, 'days') > 1;
	}

});

;;

var Calendar = FC.Calendar = Class.extend({

	dirDefaults: null, // option defaults related to LTR or RTL
	langDefaults: null, // option defaults related to current locale
	overrides: null, // option overrides given to the fullCalendar constructor
	options: null, // all defaults combined with overrides
	viewSpecCache: null, // cache of view definitions
	view: null, // current View object
	header: null,
	loadingLevel: 0, // number of simultaneous loading tasks


	// a lot of this class' OOP logic is scoped within this constructor function,
	// but in the future, write individual methods on the prototype.
	constructor: Calendar_constructor,


	// Subclasses can override this for initialization logic after the constructor has been called
	initialize: function() {
	},


	// Initializes `this.options` and other important options-related objects
	initOptions: function(overrides) {
		var lang, langDefaults;
		var isRTL, dirDefaults;

		// converts legacy options into non-legacy ones.
		// in the future, when this is removed, don't use `overrides` reference. make a copy.
		overrides = massageOverrides(overrides);

		lang = overrides.lang;
		langDefaults = langOptionHash[lang];
		if (!langDefaults) {
			lang = Calendar.defaults.lang;
			langDefaults = langOptionHash[lang] || {};
		}

		isRTL = firstDefined(
			overrides.isRTL,
			langDefaults.isRTL,
			Calendar.defaults.isRTL
		);
		dirDefaults = isRTL ? Calendar.rtlDefaults : {};

		this.dirDefaults = dirDefaults;
		this.langDefaults = langDefaults;
		this.overrides = overrides;
		this.options = mergeOptions([ // merge defaults and overrides. lowest to highest precedence
			Calendar.defaults, // global defaults
			dirDefaults,
			langDefaults,
			overrides
		]);
		populateInstanceComputableOptions(this.options);

		this.viewSpecCache = {}; // somewhat unrelated
	},


	// Gets information about how to create a view. Will use a cache.
	getViewSpec: function(viewType) {
		var cache = this.viewSpecCache;

		return cache[viewType] || (cache[viewType] = this.buildViewSpec(viewType));
	},


	// Given a duration singular unit, like "week" or "day", finds a matching view spec.
	// Preference is given to views that have corresponding buttons.
	getUnitViewSpec: function(unit) {
		var viewTypes;
		var i;
		var spec;

		if ($.inArray(unit, intervalUnits) != -1) {

			// put views that have buttons first. there will be duplicates, but oh well
			viewTypes = this.header.getViewsWithButtons();
			$.each(FC.views, function(viewType) { // all views
				viewTypes.push(viewType);
			});

			for (i = 0; i < viewTypes.length; i++) {
				spec = this.getViewSpec(viewTypes[i]);
				if (spec) {
					if (spec.singleUnit == unit) {
						return spec;
					}
				}
			}
		}
	},


	// Builds an object with information on how to create a given view
	buildViewSpec: function(requestedViewType) {
		var viewOverrides = this.overrides.views || {};
		var specChain = []; // for the view. lowest to highest priority
		var defaultsChain = []; // for the view. lowest to highest priority
		var overridesChain = []; // for the view. lowest to highest priority
		var viewType = requestedViewType;
		var spec; // for the view
		var overrides; // for the view
		var duration;
		var unit;

		// iterate from the specific view definition to a more general one until we hit an actual View class
		while (viewType) {
			spec = fcViews[viewType];
			overrides = viewOverrides[viewType];
			viewType = null; // clear. might repopulate for another iteration

			if (typeof spec === 'function') { // TODO: deprecate
				spec = { 'class': spec };
			}

			if (spec) {
				specChain.unshift(spec);
				defaultsChain.unshift(spec.defaults || {});
				duration = duration || spec.duration;
				viewType = viewType || spec.type;
			}

			if (overrides) {
				overridesChain.unshift(overrides); // view-specific option hashes have options at zero-level
				duration = duration || overrides.duration;
				viewType = viewType || overrides.type;
			}
		}

		spec = mergeProps(specChain);
		spec.type = requestedViewType;
		if (!spec['class']) {
			return false;
		}

		if (duration) {
			duration = confimoment.duration(duration);
			if (duration.valueOf()) { // valid?
				spec.duration = duration;
				unit = computeIntervalUnit(duration);

				// view is a single-unit duration, like "week" or "day"
				// incorporate options for this. lowest priority
				if (duration.as(unit) === 1) {
					spec.singleUnit = unit;
					overridesChain.unshift(viewOverrides[unit] || {});
				}
			}
		}

		spec.defaults = mergeOptions(defaultsChain);
		spec.overrides = mergeOptions(overridesChain);

		this.buildViewSpecOptions(spec);
		this.buildViewSpecButtonText(spec, requestedViewType);

		return spec;
	},


	// Builds and assigns a view spec's options object from its already-assigned defaults and overrides
	buildViewSpecOptions: function(spec) {
		spec.options = mergeOptions([ // lowest to highest priority
			Calendar.defaults, // global defaults
			spec.defaults, // view's defaults (from ViewSubclass.defaults)
			this.dirDefaults,
			this.langDefaults, // locale and dir take precedence over view's defaults!
			this.overrides, // calendar's overrides (options given to constructor)
			spec.overrides // view's overrides (view-specific options)
		]);
		populateInstanceComputableOptions(spec.options);
	},


	// Computes and assigns a view spec's buttonText-related options
	buildViewSpecButtonText: function(spec, requestedViewType) {

		// given an options object with a possible `buttonText` hash, lookup the buttonText for the
		// requested view, falling back to a generic unit entry like "week" or "day"
		function queryButtonText(options) {
			var buttonText = options.buttonText || {};
			return buttonText[requestedViewType] ||
				(spec.singleUnit ? buttonText[spec.singleUnit] : null);
		}

		// highest to lowest priority
		spec.buttonTextOverride =
			queryButtonText(this.overrides) || // constructor-specified buttonText lookup hash takes precedence
			spec.overrides.buttonText; // `buttonText` for view-specific options is a string

		// highest to lowest priority. mirrors buildViewSpecOptions
		spec.buttonTextDefault =
			queryButtonText(this.langDefaults) ||
			queryButtonText(this.dirDefaults) ||
			spec.defaults.buttonText || // a single string. from ViewSubclass.defaults
			queryButtonText(Calendar.defaults) ||
			(spec.duration ? this.humanizeDuration(spec.duration) : null) || // like "3 days"
			requestedViewType; // fall back to given view name
	},


	// Given a view name for a custom view or a standard view, creates a ready-to-go View object
	instantiateView: function(viewType) {
		var spec = this.getViewSpec(viewType);

		return new spec['class'](this, viewType, spec.options, spec.duration);
	},


	// Returns a boolean about whether the view is okay to instantiate at some point
	isValidViewType: function(viewType) {
		return Boolean(this.getViewSpec(viewType));
	},


	// Should be called when any type of async data fetching begins
	pushLoading: function() {
		if (!(this.loadingLevel++)) {
			this.trigger('loading', null, true, this.view);
		}
	},


	// Should be called when any type of async data fetching completes
	popLoading: function() {
		if (!(--this.loadingLevel)) {
			this.trigger('loading', null, false, this.view);
		}
	},


	// Given arguments to the select method in the API, returns a span (unzoned start/end and other info)
	buildSelectSpan: function(zonedStartInput, zonedEndInput) {
		var start = this.confimoment(zonedStartInput).stripZone();
		var end;

		if (zonedEndInput) {
			end = this.confimoment(zonedEndInput).stripZone();
		}
		else if (start.hasTime()) {
			end = start.clone().add(this.defaultTimedEventDuration);
		}
		else {
			end = start.clone().add(this.defaultAllDayEventDuration);
		}

		return { start: start, end: end };
	}

});


Calendar.mixin(Emitter);


function Calendar_constructor(element, overrides) {
	var t = this;


	t.initOptions(overrides || {});
	var options = this.options;


	// Exports
	// -----------------------------------------------------------------------------------

	t.render = render;
	t.destroy = destroy;
	t.refetchEvents = refetchEvents;
	t.reportEvents = reportEvents;
	t.reportEventChange = reportEventChange;
	t.rerenderEvents = renderEvents; // `renderEvents` serves as a rerender. an API method
	t.changeView = renderView; // `renderView` will switch to another view
	t.select = select;
	t.unselect = unselect;
	t.prev = prev;
	t.next = next;
	t.prevYear = prevYear;
	t.nextYear = nextYear;
	t.today = today;
	t.gotoDate = gotoDate;
	t.incrementDate = incrementDate;
	t.zoomTo = zoomTo;
	t.getDate = getDate;
	t.getCalendar = getCalendar;
	t.getView = getView;
	t.option = option;
	t.trigger = trigger;



	// Language-data Internals
	// -----------------------------------------------------------------------------------
	// Apply overrides to the current language's data


	var localeData = createObject( // make a cheap copy
		getMomentLocaleData(options.lang) // will fall back to en
	);

	if (options.monthNames) {
		localeData._months = options.monthNames;
	}
	if (options.monthNamesShort) {
		localeData._monthsShort = options.monthNamesShort;
	}
	if (options.dayNames) {
		localeData._weekdays = options.dayNames;
	}
	if (options.dayNamesShort) {
		localeData._weekdaysShort = options.dayNamesShort;
	}
	if (options.firstDay != null) {
		var _week = createObject(localeData._week); // _week: { dow: # }
		_week.dow = options.firstDay;
		localeData._week = _week;
	}

	// assign a normalized value, to be used by our .week() moment extension
	localeData._fullCalendar_weekCalc = (function(weekCalc) {
		if (typeof weekCalc === 'function') {
			return weekCalc;
		}
		else if (weekCalc === 'local') {
			return weekCalc;
		}
		else if (weekCalc === 'iso' || weekCalc === 'ISO') {
			return 'ISO';
		}
	})(options.weekNumberCalculation);



	// Calendar-specific Date Utilities
	// -----------------------------------------------------------------------------------


	t.defaultAllDayEventDuration = confimoment.duration(options.defaultAllDayEventDuration);
	t.defaultTimedEventDuration = confimoment.duration(options.defaultTimedEventDuration);


	// Builds a moment using the settings of the current calendar: timezone and language.
	// Accepts anything the vanilla moment() constructor accepts.
	t.confimoment = function() {
		var mom;

		if (options.timezone === 'local') {
			mom = FC.confimoment.apply(null, arguments);

			// Force the moment to be local, because FC.moment doesn't guarantee it.
			if (mom.hasTime()) { // don't give ambiguously-timed moments a local zone
				mom.local();
			}
		}
		else if (options.timezone === 'UTC') {
			mom = FC.confimoment.utc.apply(null, arguments); // process as UTC
		}
		else {
			mom = FC.confimoment.parseZone.apply(null, arguments); // let the input decide the zone
		}

		if ('_locale' in mom) { // moment 2.8 and above
			mom._locale = localeData;
		}
		else { // pre-moment-2.8
			mom._lang = localeData;
		}

		return mom;
	};


	// Returns a boolean about whether or not the calendar knows how to calculate
	// the timezone offset of arbitrary dates in the current timezone.
	t.getIsAmbigTimezone = function() {
		return options.timezone !== 'local' && options.timezone !== 'UTC';
	};


	// Returns a copy of the given date in the current timezone. Has no effect on dates without times.
	t.applyTimezone = function(date) {
		if (!date.hasTime()) {
			return date.clone();
		}

		var zonedDate = t.confimoment(date.toArray());
		var timeAdjust = date.time() - zonedDate.time();
		var adjustedZonedDate;

		// Safari sometimes has problems with this coersion when near DST. Adjust if necessary. (bug #2396)
		if (timeAdjust) { // is the time result different than expected?
			adjustedZonedDate = zonedDate.clone().add(timeAdjust); // add milliseconds
			if (date.time() - adjustedZonedDate.time() === 0) { // does it match perfectly now?
				zonedDate = adjustedZonedDate;
			}
		}

		return zonedDate;
	};


	// Returns a moment for the current date, as defined by the client's computer or from the `now` option.
	// Will return an moment with an ambiguous timezone.
	t.getNow = function() {
		var now = options.now;
		if (typeof now === 'function') {
			now = now();
		}
		return t.confimoment(now).stripZone();
	};


	// Get an event's normalized end date. If not present, calculate it from the defaults.
	t.getEventEnd = function(event) {
		if (event.end) {
			return event.end.clone();
		}
		else {
			return t.getDefaultEventEnd(event.allDay, event.start);
		}
	};


	// Given an event's allDay status and start date, return what its fallback end date should be.
	// TODO: rename to computeDefaultEventEnd
	t.getDefaultEventEnd = function(allDay, zonedStart) {
		var end = zonedStart.clone();

		if (allDay) {
			end.stripTime().add(t.defaultAllDayEventDuration);
		}
		else {
			end.add(t.defaultTimedEventDuration);
		}

		if (t.getIsAmbigTimezone()) {
			end.stripZone(); // we don't know what the tzo should be
		}

		return end;
	};


	// Produces a human-readable string for the given duration.
	// Side-effect: changes the locale of the given duration.
	t.humanizeDuration = function(duration) {
		return (duration.locale || duration.lang).call(duration, options.lang) // works moment-pre-2.8
			.humanize();
	};



	// Imports
	// -----------------------------------------------------------------------------------


	EventManager.call(t, options);
	var isFetchNeeded = t.isFetchNeeded;
	var fetchEvents = t.fetchEvents;



	// Locals
	// -----------------------------------------------------------------------------------


	var _element = element[0];
	var header;
	var headerElement;
	var content;
	var tm; // for making theme classes
	var currentView; // NOTE: keep this in sync with this.view
	var viewsByType = {}; // holds all instantiated view instances, current or not
	var suggestedViewHeight;
	var windowResizeProxy; // wraps the windowResize function
	var ignoreWindowResize = 0;
	var events = [];
	var date; // unzoned



	// Main Rendering
	// -----------------------------------------------------------------------------------


	// compute the initial ambig-timezone date
	if (options.defaultDate != null) {
		date = t.confimoment(options.defaultDate).stripZone();
	}
	else {
		date = t.getNow(); // getNow already returns unzoned
	}


	function render() {
		if (!content) {
			initialRender();
		}
		else if (elementVisible()) {
			// mainly for the public API
			calcSize();
			renderView();
		}
	}


	function initialRender() {
		tm = options.theme ? 'ui' : 'fc';
		element.addClass('fc');

		if (options.isRTL) {
			element.addClass('fc-rtl');
		}
		else {
			element.addClass('fc-ltr');
		}

		if (options.theme) {
			element.addClass('ui-widget');
		}
		else {
			element.addClass('fc-unthemed');
		}

		content = $("<div class='fc-view-container'/>").prependTo(element);

		header = t.header = new Header(t, options);
		headerElement = header.render();
		if (headerElement) {
			element.prepend(headerElement);
		}

		renderView(options.defaultView);

		if (options.handleWindowResize) {
			windowResizeProxy = debounce(windowResize, options.windowResizeDelay); // prevents rapid calls
			$(window).resize(windowResizeProxy);
		}
	}


	function destroy() {

		if (currentView) {
			currentView.removeElement();

			// NOTE: don't null-out currentView/t.view in case API methods are called after destroy.
			// It is still the "current" view, just not rendered.
		}

		header.removeElement();
		content.remove();
		element.removeClass('fc fc-ltr fc-rtl fc-unthemed ui-widget');

		if (windowResizeProxy) {
			$(window).unbind('resize', windowResizeProxy);
		}
	}


	function elementVisible() {
		return element.is(':visible');
	}



	// View Rendering
	// -----------------------------------------------------------------------------------


	// Renders a view because of a date change, view-type change, or for the first time.
	// If not given a viewType, keep the current view but render different dates.
	function renderView(viewType) {
		ignoreWindowResize++;

		// if viewType is changing, remove the old view's rendering
		if (currentView && viewType && currentView.type !== viewType) {
			header.deactivateButton(currentView.type);
			freezeContentHeight(); // prevent a scroll jump when view element is removed
			currentView.removeElement();
			currentView = t.view = null;
		}

		// if viewType changed, or the view was never created, create a fresh view
		if (!currentView && viewType) {
			currentView = t.view =
				viewsByType[viewType] ||
				(viewsByType[viewType] = t.instantiateView(viewType));

			currentView.setElement(
				$("<div class='fc-view fc-" + viewType + "-view' />").appendTo(content)
			);
			header.activateButton(viewType);
		}

		if (currentView) {

			// in case the view should render a period of time that is completely hidden
			date = currentView.massageCurrentDate(date);

			// render or rerender the view
			if (
				!currentView.displaying ||
				!date.isWithin(currentView.intervalStart, currentView.intervalEnd) // implicit date window change
			) {
				if (elementVisible()) {

					currentView.display(date); // will call freezeContentHeight
					unfreezeContentHeight(); // immediately unfreeze regardless of whether display is async

					// need to do this after View::render, so dates are calculated
					updateHeaderTitle();
					updateTodayButton();

					getAndRenderEvents();
				}
			}
		}

		unfreezeContentHeight(); // undo any lone freezeContentHeight calls
		ignoreWindowResize--;
	}



	// Resizing
	// -----------------------------------------------------------------------------------


	t.getSuggestedViewHeight = function() {
		if (suggestedViewHeight === undefined) {
			calcSize();
		}
		return suggestedViewHeight;
	};


	t.isHeightAuto = function() {
		return options.contentHeight === 'auto' || options.height === 'auto';
	};


	function updateSize(shouldRecalc) {
		if (elementVisible()) {

			if (shouldRecalc) {
				_calcSize();
			}

			ignoreWindowResize++;
			currentView.updateSize(true); // isResize=true. will poll getSuggestedViewHeight() and isHeightAuto()
			ignoreWindowResize--;

			return true; // signal success
		}
	}


	function calcSize() {
		if (elementVisible()) {
			_calcSize();
		}
	}


	function _calcSize() { // assumes elementVisible
		if (typeof options.contentHeight === 'number') { // exists and not 'auto'
			suggestedViewHeight = options.contentHeight;
		}
		else if (typeof options.height === 'number') { // exists and not 'auto'
			suggestedViewHeight = options.height - (headerElement ? headerElement.outerHeight(true) : 0);
		}
		else {
			suggestedViewHeight = Math.round(content.width() / Math.max(options.aspectRatio, .5));
		}
	}


	function windowResize(ev) {
		if (
			!ignoreWindowResize &&
			ev.target === window && // so we don't process jqui "resize" events that have bubbled up
			currentView.start // view has already been rendered
		) {
			if (updateSize(true)) {
				currentView.trigger('windowResize', _element);
			}
		}
	}



	/* Event Fetching/Rendering
	-----------------------------------------------------------------------------*/
	// TODO: going forward, most of this stuff should be directly handled by the view


	function refetchEvents() { // can be called as an API method
		destroyEvents(); // so that events are cleared before user starts waiting for AJAX
		fetchAndRenderEvents();
	}


	function renderEvents() { // destroys old events if previously rendered
		if (elementVisible()) {
			freezeContentHeight();
			currentView.displayEvents(events);
			unfreezeContentHeight();
		}
	}


	function destroyEvents() {
		freezeContentHeight();
		currentView.clearEvents();
		unfreezeContentHeight();
	}


	function getAndRenderEvents() {
		if (!options.lazyFetching || isFetchNeeded(currentView.start, currentView.end)) {
			fetchAndRenderEvents();
		}
		else {
			renderEvents();
		}
	}


	function fetchAndRenderEvents() {
		fetchEvents(currentView.start, currentView.end);
			// ... will call reportEvents
			// ... which will call renderEvents
	}


	// called when event data arrives
	function reportEvents(_events) {
		events = _events;
		renderEvents();
	}


	// called when a single event's data has been changed
	function reportEventChange() {
		renderEvents();
	}



	/* Header Updating
	-----------------------------------------------------------------------------*/


	function updateHeaderTitle() {
		header.updateTitle(currentView.title);
	}


	function updateTodayButton() {
		var now = t.getNow();
		if (now.isWithin(currentView.intervalStart, currentView.intervalEnd)) {
			header.disableButton('today');
		}
		else {
			header.enableButton('today');
		}
	}



	/* Selection
	-----------------------------------------------------------------------------*/


	// this public method receives start/end dates in any format, with any timezone
	function select(zonedStartInput, zonedEndInput) {
		currentView.select(
			t.buildSelectSpan.apply(t, arguments)
		);
	}


	function unselect() { // safe to be called before renderView
		if (currentView) {
			currentView.unselect();
		}
	}



	/* Date
	-----------------------------------------------------------------------------*/


	function prev() {
		date = currentView.computePrevDate(date);
		renderView();
	}


	function next() {
		date = currentView.computeNextDate(date);
		renderView();
	}


	function prevYear() {
		date.add(-1, 'years');
		renderView();
	}


	function nextYear() {
		date.add(1, 'years');
		renderView();
	}


	function today() {
		date = t.getNow();
		renderView();
	}


	function gotoDate(zonedDateInput) {
		date = t.confimoment(zonedDateInput).stripZone();
		renderView();
	}


	function incrementDate(delta) {
		date.add(confimoment.duration(delta));
		renderView();
	}


	// Forces navigation to a view for the given date.
	// `viewType` can be a specific view name or a generic one like "week" or "day".
	function zoomTo(newDate, viewType) {
		var spec;

		viewType = viewType || 'day'; // day is default zoom
		spec = t.getViewSpec(viewType) || t.getUnitViewSpec(viewType);

		date = newDate.clone();
		renderView(spec ? spec.type : null);
	}


	// for external API
	function getDate() {
		return t.applyTimezone(date); // infuse the calendar's timezone
	}



	/* Height "Freezing"
	-----------------------------------------------------------------------------*/
	// TODO: move this into the view

	t.freezeContentHeight = freezeContentHeight;
	t.unfreezeContentHeight = unfreezeContentHeight;


	function freezeContentHeight() {
		content.css({
			width: '100%',
			height: content.height(),
			overflow: 'hidden'
		});
	}


	function unfreezeContentHeight() {
		content.css({
			width: '',
			height: '',
			overflow: ''
		});
	}



	/* Misc
	-----------------------------------------------------------------------------*/


	function getCalendar() {
		return t;
	}


	function getView() {
		return currentView;
	}


	function option(name, value) {
		if (value === undefined) {
			return options[name];
		}
		if (name == 'height' || name == 'contentHeight' || name == 'aspectRatio') {
			options[name] = value;
			updateSize(true); // true = allow recalculation of height
		}
	}


	function trigger(name, thisObj) { // overrides the Emitter's trigger method :(
		var args = Array.prototype.slice.call(arguments, 2);

		thisObj = thisObj || _element;
		this.triggerWith(name, thisObj, args); // Emitter's method

		if (options[name]) {
			return options[name].apply(thisObj, args);
		}
	}

	t.initialize();
}

;;

Calendar.defaults = {

	titleRangeSeparator: ' \u2014 ', // emphasized dash
	monthYearFormat: 'MMMM YYYY', // required for en. other languages rely on datepicker computable option

	defaultTimedEventDuration: '02:00:00',
	defaultAllDayEventDuration: { days: 1 },
	forceEventDuration: false,
	nextDayThreshold: '09:00:00', // 9am

	// display
	defaultView: 'month',
	aspectRatio: 1.35,
	header: {
		left: 'title',
		center: '',
		right: 'today prev,next'
	},
	weekends: true,
	weekNumbers: false,

	weekNumberTitle: 'W',
	weekNumberCalculation: 'local',

	//editable: false,

	scrollTime: '06:00:00',

	// event ajax
	lazyFetching: true,
	startParam: 'start',
	endParam: 'end',
	timezoneParam: 'timezone',

	timezone: false,

	//allDayDefault: undefined,

	// locale
	isRTL: false,
	buttonText: {
		prev: "prev",
		next: "next",
		prevYear: "prev year",
		nextYear: "next year",
		year: 'year', // TODO: locale files need to specify this
		today: 'today',
		month: 'month',
		week: 'week',
		day: 'day'
	},

	buttonIcons: {
		prev: 'left-single-arrow',
		next: 'right-single-arrow',
		prevYear: 'left-double-arrow',
		nextYear: 'right-double-arrow'
	},

	// jquery-ui theming
	theme: false,
	themeButtonIcons: {
		prev: 'circle-triangle-w',
		next: 'circle-triangle-e',
		prevYear: 'seek-prev',
		nextYear: 'seek-next'
	},

	//eventResizableFromStart: false,
	dragOpacity: .75,
	dragRevertDuration: 500,
	dragScroll: true,

	//selectable: false,
	unselectAuto: true,

	dropAccept: '*',

	eventOrder: 'title',

	eventLimit: false,
	eventLimitText: 'more',
	eventLimitClick: 'popover',
	dayPopoverFormat: 'LL',

	handleWindowResize: true,
	windowResizeDelay: 200 // milliseconds before an updateSize happens

};


Calendar.englishDefaults = { // used by lang.js
	dayPopoverFormat: 'dddd, MMMM D'
};


Calendar.rtlDefaults = { // right-to-left defaults
	header: { // TODO: smarter solution (first/center/last ?)
		left: 'next,prev today',
		center: '',
		right: 'title'
	},
	buttonIcons: {
		prev: 'right-single-arrow',
		next: 'left-single-arrow',
		prevYear: 'right-double-arrow',
		nextYear: 'left-double-arrow'
	},
	themeButtonIcons: {
		prev: 'circle-triangle-e',
		next: 'circle-triangle-w',
		nextYear: 'seek-prev',
		prevYear: 'seek-next'
	}
};

;;

var langOptionHash = FC.langs = {}; // initialize and expose


// TODO: document the structure and ordering of a FullCalendar lang file
// TODO: rename everything "lang" to "locale", like what the moment project did


// Initialize jQuery UI datepicker translations while using some of the translations
// Will set this as the default language for datepicker.
FC.datepickerLang = function(langCode, dpLangCode, dpOptions) {

	// get the FullCalendar internal option hash for this language. create if necessary
	var fcOptions = langOptionHash[langCode] || (langOptionHash[langCode] = {});

	// transfer some simple options from datepicker to fc
	fcOptions.isRTL = dpOptions.isRTL;
	fcOptions.weekNumberTitle = dpOptions.weekHeader;

	// compute some more complex options from datepicker
	$.each(dpComputableOptions, function(name, func) {
		fcOptions[name] = func(dpOptions);
	});

	// is jQuery UI Datepicker is on the page?
	if ($.datepicker) {

		// Register the language data.
		// FullCalendar and MomentJS use language codes like "pt-br" but Datepicker
		// does it like "pt-BR" or if it doesn't have the language, maybe just "pt".
		// Make an alias so the language can be referenced either way.
		$.datepicker.regional[dpLangCode] =
			$.datepicker.regional[langCode] = // alias
				dpOptions;

		// Alias 'en' to the default language data. Do this every time.
		$.datepicker.regional.en = $.datepicker.regional[''];

		// Set as Datepicker's global defaults.
		$.datepicker.setDefaults(dpOptions);
	}
};


// Sets FullCalendar-specific translations. Will set the language as the global default.
FC.lang = function(langCode, newFcOptions) {
	var fcOptions;
	var momOptions;

	// get the FullCalendar internal option hash for this language. create if necessary
	fcOptions = langOptionHash[langCode] || (langOptionHash[langCode] = {});

	// provided new options for this language? merge them in
	if (newFcOptions) {
		fcOptions = langOptionHash[langCode] = mergeOptions([ fcOptions, newFcOptions ]);
	}

	// compute language options that weren't defined.
	// always do this. newFcOptions can be undefined when initializing from i18n file,
	// so no way to tell if this is an initialization or a default-setting.
	momOptions = getMomentLocaleData(langCode); // will fall back to en
	$.each(momComputableOptions, function(name, func) {
		if (fcOptions[name] == null) {
			fcOptions[name] = func(momOptions, fcOptions);
		}
	});

	// set it as the default language for FullCalendar
	Calendar.defaults.lang = langCode;
};


// NOTE: can't guarantee any of these computations will run because not every language has datepicker
// configs, so make sure there are English fallbacks for these in the defaults file.
var dpComputableOptions = {

	buttonText: function(dpOptions) {
		return {
			// the translations sometimes wrongly contain HTML entities
			prev: stripHtmlEntities(dpOptions.prevText),
			next: stripHtmlEntities(dpOptions.nextText),
			today: stripHtmlEntities(dpOptions.currentText)
		};
	},

	// Produces format strings like "MMMM YYYY" -> "September 2014"
	monthYearFormat: function(dpOptions) {
		return dpOptions.showMonthAfterYear ?
			'YYYY[' + dpOptions.yearSuffix + '] MMMM' :
			'MMMM YYYY[' + dpOptions.yearSuffix + ']';
	}

};

var momComputableOptions = {

	// Produces format strings like "ddd M/D" -> "Fri 9/15"
	dayOfMonthFormat: function(momOptions, fcOptions) {
		var format = momOptions.longDateFormat('l'); // for the format like "M/D/YYYY"

		// strip the year off the edge, as well as other misc non-whitespace chars
		format = format.replace(/^Y+[^\w\s]*|[^\w\s]*Y+$/g, '');

		if (fcOptions.isRTL) {
			format += ' ddd'; // for RTL, add day-of-week to end
		}
		else {
			format = 'ddd ' + format; // for LTR, add day-of-week to beginning
		}
		return format;
	},

	// Produces format strings like "h:mma" -> "6:00pm"
	mediumTimeFormat: function(momOptions) { // can't be called `timeFormat` because collides with option
		return momOptions.longDateFormat('LT')
			.replace(/\s*a$/i, 'a'); // convert AM/PM/am/pm to lowercase. remove any spaces beforehand
	},

	// Produces format strings like "h(:mm)a" -> "6pm" / "6:30pm"
	smallTimeFormat: function(momOptions) {
		return momOptions.longDateFormat('LT')
			.replace(':mm', '(:mm)')
			.replace(/(\Wmm)$/, '($1)') // like above, but for foreign langs
			.replace(/\s*a$/i, 'a'); // convert AM/PM/am/pm to lowercase. remove any spaces beforehand
	},

	// Produces format strings like "h(:mm)t" -> "6p" / "6:30p"
	extraSmallTimeFormat: function(momOptions) {
		return momOptions.longDateFormat('LT')
			.replace(':mm', '(:mm)')
			.replace(/(\Wmm)$/, '($1)') // like above, but for foreign langs
			.replace(/\s*a$/i, 't'); // convert to AM/PM/am/pm to lowercase one-letter. remove any spaces beforehand
	},

	// Produces format strings like "ha" / "H" -> "6pm" / "18"
	hourFormat: function(momOptions) {
		return momOptions.longDateFormat('LT')
			.replace(':mm', '')
			.replace(/(\Wmm)$/, '') // like above, but for foreign langs
			.replace(/\s*a$/i, 'a'); // convert AM/PM/am/pm to lowercase. remove any spaces beforehand
	},

	// Produces format strings like "h:mm" -> "6:30" (with no AM/PM)
	noMeridiemTimeFormat: function(momOptions) {
		return momOptions.longDateFormat('LT')
			.replace(/\s*a$/i, ''); // remove trailing AM/PM
	}

};


// options that should be computed off live calendar options (considers override options)
// TODO: best place for this? related to lang?
// TODO: flipping text based on isRTL is a bad idea because the CSS `direction` might want to handle it
var instanceComputableOptions = {

	// Produces format strings for results like "Mo 16"
	smallDayDateFormat: function(options) {
		return options.isRTL ?
			'D dd' :
			'dd D';
	},

	// Produces format strings for results like "Wk 5"
	weekFormat: function(options) {
		return options.isRTL ?
			'w[ ' + options.weekNumberTitle + ']' :
			'[' + options.weekNumberTitle + ' ]w';
	},

	// Produces format strings for results like "Wk5"
	smallWeekFormat: function(options) {
		return options.isRTL ?
			'w[' + options.weekNumberTitle + ']' :
			'[' + options.weekNumberTitle + ']w';
	}

};

function populateInstanceComputableOptions(options) {
	$.each(instanceComputableOptions, function(name, func) {
		if (options[name] == null) {
			options[name] = func(options);
		}
	});
}


// Returns moment's internal locale data. If doesn't exist, returns English.
// Works with moment-pre-2.8
function getMomentLocaleData(langCode) {
	var func = confimoment.localeData || confimoment.langData;
	return func.call(confimoment, langCode) ||
		func.call(confimoment, 'en'); // the newer localData could return null, so fall back to en
}


// Initialize English by forcing computation of moment-derived options.
// Also, sets it as the default.
FC.lang('en', Calendar.englishDefaults);

;;

/* Top toolbar area with buttons and title
----------------------------------------------------------------------------------------------------------------------*/
// TODO: rename all header-related things to "toolbar"

function Header(calendar, options) {
	var t = this;

	// exports
	t.render = render;
	t.removeElement = removeElement;
	t.updateTitle = updateTitle;
	t.activateButton = activateButton;
	t.deactivateButton = deactivateButton;
	t.disableButton = disableButton;
	t.enableButton = enableButton;
	t.getViewsWithButtons = getViewsWithButtons;

	// locals
	var el = $();
	var viewsWithButtons = [];
	var tm;


	function render() {
		var sections = options.header;

		tm = options.theme ? 'ui' : 'fc';

		if (sections) {
			el = $("<div class='fc-toolbar'/>")
				.append(renderSection('left'))
				.append(renderSection('right'))
				.append(renderSection('center'))
				.append('<div class="fc-clear"/>');

			return el;
		}
	}


	function removeElement() {
		el.remove();
		el = $();
	}


	function renderSection(position) {
		var sectionEl = $('<div class="fc-' + position + '"/>');
		var buttonStr = options.header[position];

		if (buttonStr) {
			$.each(buttonStr.split(' '), function(i) {
				var groupChildren = $();
				var isOnlyButtons = true;
				var groupEl;

				$.each(this.split(','), function(j, buttonName) {
					var customButtonProps;
					var viewSpec;
					var buttonClick;
					var overrideText; // text explicitly set by calendar's constructor options. overcomes icons
					var defaultText;
					var themeIcon;
					var normalIcon;
					var innerHtml;
					var classes;
					var button; // the element

					if (buttonName == 'title') {
						groupChildren = groupChildren.add($('<h2>&nbsp;</h2>')); // we always want it to take up height
						isOnlyButtons = false;
					}
					else {
						if ((customButtonProps = (calendar.options.customButtons || {})[buttonName])) {
							buttonClick = function(ev) {
								if (customButtonProps.click) {
									customButtonProps.click.call(button[0], ev);
								}
							};
							overrideText = ''; // icons will override text
							defaultText = customButtonProps.text;
						}
						else if ((viewSpec = calendar.getViewSpec(buttonName))) {
							buttonClick = function() {
								calendar.changeView(buttonName);
							};
							viewsWithButtons.push(buttonName);
							overrideText = viewSpec.buttonTextOverride;
							defaultText = viewSpec.buttonTextDefault;
						}
						else if (calendar[buttonName]) { // a calendar method
							buttonClick = function() {
								calendar[buttonName]();
							};
							overrideText = (calendar.overrides.buttonText || {})[buttonName];
							defaultText = options.buttonText[buttonName]; // everything else is considered default
						}

						if (buttonClick) {

							themeIcon =
								customButtonProps ?
									customButtonProps.themeIcon :
									options.themeButtonIcons[buttonName];

							normalIcon =
								customButtonProps ?
									customButtonProps.icon :
									options.buttonIcons[buttonName];

							if (overrideText) {
								innerHtml = htmlEscape(overrideText);
							}
							else if (themeIcon && options.theme) {
								innerHtml = "<span class='ui-icon ui-icon-" + themeIcon + "'></span>";
							}
							else if (normalIcon && !options.theme) {
								innerHtml = "<span class='fc-icon fc-icon-" + normalIcon + "'></span>";
							}
							else {
								innerHtml = htmlEscape(defaultText);
							}

							classes = [
								'fc-' + buttonName + '-button',
								tm + '-button',
								tm + '-state-default'
							];

							button = $( // type="button" so that it doesn't submit a form
								'<button type="button" class="' + classes.join(' ') + '">' +
									innerHtml +
								'</button>'
								)
								.click(function(ev) {
									// don't process clicks for disabled buttons
									if (!button.hasClass(tm + '-state-disabled')) {

										buttonClick(ev);

										// after the click action, if the button becomes the "active" tab, or disabled,
										// it should never have a hover class, so remove it now.
										if (
											button.hasClass(tm + '-state-active') ||
											button.hasClass(tm + '-state-disabled')
										) {
											button.removeClass(tm + '-state-hover');
										}
									}
								})
								.mousedown(function() {
									// the *down* effect (mouse pressed in).
									// only on buttons that are not the "active" tab, or disabled
									button
										.not('.' + tm + '-state-active')
										.not('.' + tm + '-state-disabled')
										.addClass(tm + '-state-down');
								})
								.mouseup(function() {
									// undo the *down* effect
									button.removeClass(tm + '-state-down');
								})
								.hover(
									function() {
										// the *hover* effect.
										// only on buttons that are not the "active" tab, or disabled
										button
											.not('.' + tm + '-state-active')
											.not('.' + tm + '-state-disabled')
											.addClass(tm + '-state-hover');
									},
									function() {
										// undo the *hover* effect
										button
											.removeClass(tm + '-state-hover')
											.removeClass(tm + '-state-down'); // if mouseleave happens before mouseup
									}
								);

							groupChildren = groupChildren.add(button);
						}
					}
				});

				if (isOnlyButtons) {
					groupChildren
						.first().addClass(tm + '-corner-left').end()
						.last().addClass(tm + '-corner-right').end();
				}

				if (groupChildren.length > 1) {
					groupEl = $('<div/>');
					if (isOnlyButtons) {
						groupEl.addClass('fc-button-group');
					}
					groupEl.append(groupChildren);
					sectionEl.append(groupEl);
				}
				else {
					sectionEl.append(groupChildren); // 1 or 0 children
				}
			});
		}

		return sectionEl;
	}


	function updateTitle(text) {
		el.find('h2').text(text);
	}


	function activateButton(buttonName) {
		el.find('.fc-' + buttonName + '-button')
			.addClass(tm + '-state-active');
	}


	function deactivateButton(buttonName) {
		el.find('.fc-' + buttonName + '-button')
			.removeClass(tm + '-state-active');
	}


	function disableButton(buttonName) {
		el.find('.fc-' + buttonName + '-button')
			.attr('disabled', 'disabled')
			.addClass(tm + '-state-disabled');
	}


	function enableButton(buttonName) {
		el.find('.fc-' + buttonName + '-button')
			.removeAttr('disabled')
			.removeClass(tm + '-state-disabled');
	}


	function getViewsWithButtons() {
		return viewsWithButtons;
	}

}

;;

FC.sourceNormalizers = [];
FC.sourceFetchers = [];

var ajaxDefaults = {
	dataType: 'json',
	cache: false
};

var eventGUID = 1;


function EventManager(options) { // assumed to be a calendar
	var t = this;


	// exports
	t.isFetchNeeded = isFetchNeeded;
	t.fetchEvents = fetchEvents;
	t.addEventSource = addEventSource;
	t.removeEventSource = removeEventSource;
	t.updateEvent = updateEvent;
	t.renderEvent = renderEvent;
	t.removeEvents = removeEvents;
	t.clientEvents = clientEvents;
	t.mutateEvent = mutateEvent;
	t.normalizeEventDates = normalizeEventDates;
	t.normalizeEventTimes = normalizeEventTimes;


	// imports
	var reportEvents = t.reportEvents;


	// locals
	var stickySource = { events: [] };
	var sources = [ stickySource ];
	var rangeStart, rangeEnd;
	var currentFetchID = 0;
	var pendingSourceCnt = 0;
	var cache = []; // holds events that have already been expanded


	$.each(
		(options.events ? [ options.events ] : []).concat(options.eventSources || []),
		function(i, sourceInput) {
			var source = buildEventSource(sourceInput);
			if (source) {
				sources.push(source);
			}
		}
	);



	/* Fetching
	-----------------------------------------------------------------------------*/


	// start and end are assumed to be unzoned
	function isFetchNeeded(start, end) {
		return !rangeStart || // nothing has been fetched yet?
			start < rangeStart || end > rangeEnd; // is part of the new range outside of the old range?
	}


	function fetchEvents(start, end) {
		rangeStart = start;
		rangeEnd = end;
		cache = [];
		var fetchID = ++currentFetchID;
		var len = sources.length;
		pendingSourceCnt = len;
		for (var i=0; i<len; i++) {
			fetchEventSource(sources[i], fetchID);
		}
	}


	function fetchEventSource(source, fetchID) {
		_fetchEventSource(source, function(eventInputs) {
			var isArraySource = $.isArray(source.events);
			var i, eventInput;
			var abstractEvent;

			if (fetchID == currentFetchID) {

				if (eventInputs) {
					for (i = 0; i < eventInputs.length; i++) {
						eventInput = eventInputs[i];

						if (isArraySource) { // array sources have already been convert to Event Objects
							abstractEvent = eventInput;
						}
						else {
							abstractEvent = buildEventFromInput(eventInput, source);
						}

						if (abstractEvent) { // not false (an invalid event)
							cache.push.apply(
								cache,
								expandEvent(abstractEvent) // add individual expanded events to the cache
							);
						}
					}
				}

				pendingSourceCnt--;
				if (!pendingSourceCnt) {
					reportEvents(cache);
				}
			}
		});
	}


	function _fetchEventSource(source, callback) {
		var i;
		var fetchers = FC.sourceFetchers;
		var res;

		for (i=0; i<fetchers.length; i++) {
			res = fetchers[i].call(
				t, // this, the Calendar object
				source,
				rangeStart.clone(),
				rangeEnd.clone(),
				options.timezone,
				callback
			);

			if (res === true) {
				// the fetcher is in charge. made its own async request
				return;
			}
			else if (typeof res == 'object') {
				// the fetcher returned a new source. process it
				_fetchEventSource(res, callback);
				return;
			}
		}

		var events = source.events;
		if (events) {
			if ($.isFunction(events)) {
				t.pushLoading();
				events.call(
					t, // this, the Calendar object
					rangeStart.clone(),
					rangeEnd.clone(),
					options.timezone,
					function(events) {
						callback(events);
						t.popLoading();
					}
				);
			}
			else if ($.isArray(events)) {
				callback(events);
			}
			else {
				callback();
			}
		}else{
			var url = source.url;
			if (url) {
				var success = source.success;
				var error = source.error;
				var complete = source.complete;

				// retrieve any outbound GET/POST $.ajax data from the options
				var customData;
				if ($.isFunction(source.data)) {
					// supplied as a function that returns a key/value object
					customData = source.data();
				}
				else {
					// supplied as a straight key/value object
					customData = source.data;
				}

				// use a copy of the custom data so we can modify the parameters
				// and not affect the passed-in object.
				var data = $.extend({}, customData || {});

				var startParam = firstDefined(source.startParam, options.startParam);
				var endParam = firstDefined(source.endParam, options.endParam);
				var timezoneParam = firstDefined(source.timezoneParam, options.timezoneParam);

				if (startParam) {
					data[startParam] = rangeStart.format();
				}
				if (endParam) {
					data[endParam] = rangeEnd.format();
				}
				if (options.timezone && options.timezone != 'local') {
					data[timezoneParam] = options.timezone;
				}

				t.pushLoading();
				$.ajax($.extend({}, ajaxDefaults, source, {
					data: data,
					success: function(events) {
						events = events || [];
						var res = applyAll(success, this, arguments);
						if ($.isArray(res)) {
							events = res;
						}
						callback(events);
					},
					error: function() {
						applyAll(error, this, arguments);
						callback();
					},
					complete: function() {
						applyAll(complete, this, arguments);
						t.popLoading();
					}
				}));
			}else{
				callback();
			}
		}
	}



	/* Sources
	-----------------------------------------------------------------------------*/


	function addEventSource(sourceInput) {
		var source = buildEventSource(sourceInput);
		if (source) {
			sources.push(source);
			pendingSourceCnt++;
			fetchEventSource(source, currentFetchID); // will eventually call reportEvents
		}
	}


	function buildEventSource(sourceInput) { // will return undefined if invalid source
		var normalizers = FC.sourceNormalizers;
		var source;
		var i;

		if ($.isFunction(sourceInput) || $.isArray(sourceInput)) {
			source = { events: sourceInput };
		}
		else if (typeof sourceInput === 'string') {
			source = { url: sourceInput };
		}
		else if (typeof sourceInput === 'object') {
			source = $.extend({}, sourceInput); // shallow copy
		}

		if (source) {

			// TODO: repeat code, same code for event classNames
			if (source.className) {
				if (typeof source.className === 'string') {
					source.className = source.className.split(/\s+/);
				}
				// otherwise, assumed to be an array
			}
			else {
				source.className = [];
			}

			// for array sources, we convert to standard Event Objects up front
			if ($.isArray(source.events)) {
				source.origArray = source.events; // for removeEventSource
				source.events = $.map(source.events, function(eventInput) {
					return buildEventFromInput(eventInput, source);
				});
			}

			for (i=0; i<normalizers.length; i++) {
				normalizers[i].call(t, source);
			}

			return source;
		}
	}


	function removeEventSource(source) {
		sources = $.grep(sources, function(src) {
			return !isSourcesEqual(src, source);
		});
		// remove all client events from that source
		cache = $.grep(cache, function(e) {
			return !isSourcesEqual(e.source, source);
		});
		reportEvents(cache);
	}


	function isSourcesEqual(source1, source2) {
		return source1 && source2 && getSourcePrimitive(source1) == getSourcePrimitive(source2);
	}


	function getSourcePrimitive(source) {
		return (
			(typeof source === 'object') ? // a normalized event source?
				(source.origArray || source.googleCalendarId || source.url || source.events) : // get the primitive
				null
		) ||
		source; // the given argument *is* the primitive
	}



	/* Manipulation
	-----------------------------------------------------------------------------*/


	// Only ever called from the externally-facing API
	function updateEvent(event) {

		// massage start/end values, even if date string values
		event.start = t.confimoment(event.start);
		if (event.end) {
			event.end = t.confimoment(event.end);
		}
		else {
			event.end = null;
		}

		mutateEvent(event, getMiscEventProps(event)); // will handle start/end/allDay normalization
		reportEvents(cache); // reports event modifications (so we can redraw)
	}


	// Returns a hash of misc event properties that should be copied over to related events.
	function getMiscEventProps(event) {
		var props = {};

		$.each(event, function(name, val) {
			if (isMiscEventPropName(name)) {
				if (val !== undefined && isAtomic(val)) { // a defined non-object
					props[name] = val;
				}
			}
		});

		return props;
	}

	// non-date-related, non-id-related, non-secret
	function isMiscEventPropName(name) {
		return !/^_|^(id|allDay|start|end)$/.test(name);
	}


	// returns the expanded events that were created
	function renderEvent(eventInput, stick) {
		var abstractEvent = buildEventFromInput(eventInput);
		var events;
		var i, event;

		if (abstractEvent) { // not false (a valid input)
			events = expandEvent(abstractEvent);

			for (i = 0; i < events.length; i++) {
				event = events[i];

				if (!event.source) {
					if (stick) {
						stickySource.events.push(event);
						event.source = stickySource;
					}
					cache.push(event);
				}
			}

			reportEvents(cache);

			return events;
		}

		return [];
	}


	function removeEvents(filter) {
		var eventID;
		var i;

		if (filter == null) { // null or undefined. remove all events
			filter = function() { return true; }; // will always match
		}
		else if (!$.isFunction(filter)) { // an event ID
			eventID = filter + '';
			filter = function(event) {
				return event._id == eventID;
			};
		}

		// Purge event(s) from our local cache
		cache = $.grep(cache, filter, true); // inverse=true

		// Remove events from array sources.
		// This works because they have been converted to official Event Objects up front.
		// (and as a result, event._id has been calculated).
		for (i=0; i<sources.length; i++) {
			if ($.isArray(sources[i].events)) {
				sources[i].events = $.grep(sources[i].events, filter, true);
			}
		}

		reportEvents(cache);
	}


	function clientEvents(filter) {
		if ($.isFunction(filter)) {
			return $.grep(cache, filter);
		}
		else if (filter != null) { // not null, not undefined. an event ID
			filter += '';
			return $.grep(cache, function(e) {
				return e._id == filter;
			});
		}
		return cache; // else, return all
	}



	/* Event Normalization
	-----------------------------------------------------------------------------*/


	// Given a raw object with key/value properties, returns an "abstract" Event object.
	// An "abstract" event is an event that, if recurring, will not have been expanded yet.
	// Will return `false` when input is invalid.
	// `source` is optional
	function buildEventFromInput(input, source) {
		var out = {};
		var start, end;
		var allDay;

		if (options.eventDataTransform) {
			input = options.eventDataTransform(input);
		}
		if (source && source.eventDataTransform) {
			input = source.eventDataTransform(input);
		}

		// Copy all properties over to the resulting object.
		// The special-case properties will be copied over afterwards.
		$.extend(out, input);

		if (source) {
			out.source = source;
		}

		out._id = input._id || (input.id === undefined ? '_fc' + eventGUID++ : input.id + '');

		if (input.className) {
			if (typeof input.className == 'string') {
				out.className = input.className.split(/\s+/);
			}
			else { // assumed to be an array
				out.className = input.className;
			}
		}
		else {
			out.className = [];
		}

		start = input.start || input.date; // "date" is an alias for "start"
		end = input.end;

		// parse as a time (Duration) if applicable
		if (isTimeString(start)) {
			start = confimoment.duration(start);
		}
		if (isTimeString(end)) {
			end = confimoment.duration(end);
		}

		if (input.dow || confimoment.isDuration(start) || confimoment.isDuration(end)) {

			// the event is "abstract" (recurring) so don't calculate exact start/end dates just yet
			out.start = start ? confimoment.duration(start) : null; // will be a Duration or null
			out.end = end ? confimoment.duration(end) : null; // will be a Duration or null
			out._recurring = true; // our internal marker
		}
		else {

			if (start) {
				start = t.confimoment(start);
				if (!start.isValid()) {
					return false;
				}
			}

			if (end) {
				end = t.confimoment(end);
				if (!end.isValid()) {
					end = null; // let defaults take over
				}
			}

			allDay = input.allDay;
			if (allDay === undefined) { // still undefined? fallback to default
				allDay = firstDefined(
					source ? source.allDayDefault : undefined,
					options.allDayDefault
				);
				// still undefined? normalizeEventDates will calculate it
			}

			assignDatesToEvent(start, end, allDay, out);
		}

		return out;
	}


	// Normalizes and assigns the given dates to the given partially-formed event object.
	// NOTE: mutates the given start/end moments. does not make a copy.
	function assignDatesToEvent(start, end, allDay, event) {
		event.start = start;
		event.end = end;
		event.allDay = allDay;
		normalizeEventDates(event);
		backupEventDates(event);
	}


	// Ensures proper values for allDay/start/end. Accepts an Event object, or a plain object with event-ish properties.
	// NOTE: Will modify the given object.
	function normalizeEventDates(eventProps) {

		normalizeEventTimes(eventProps);

		if (eventProps.end && !eventProps.end.isAfter(eventProps.start)) {
			eventProps.end = null;
		}

		if (!eventProps.end) {
			if (options.forceEventDuration) {
				eventProps.end = t.getDefaultEventEnd(eventProps.allDay, eventProps.start);
			}
			else {
				eventProps.end = null;
			}
		}
	}


	// Ensures the allDay property exists and the timeliness of the start/end dates are consistent
	function normalizeEventTimes(eventProps) {
		if (eventProps.allDay == null) {
			eventProps.allDay = !(eventProps.start.hasTime() || (eventProps.end && eventProps.end.hasTime()));
		}

		if (eventProps.allDay) {
			eventProps.start.stripTime();
			if (eventProps.end) {
				// TODO: consider nextDayThreshold here? If so, will require a lot of testing and adjustment
				eventProps.end.stripTime();
			}
		}
		else {
			if (!eventProps.start.hasTime()) {
				eventProps.start = t.applyTimezone(eventProps.start.time(0)); // will assign a 00:00 time
			}
			if (eventProps.end && !eventProps.end.hasTime()) {
				eventProps.end = t.applyTimezone(eventProps.end.time(0)); // will assign a 00:00 time
			}
		}
	}


	// If the given event is a recurring event, break it down into an array of individual instances.
	// If not a recurring event, return an array with the single original event.
	// If given a falsy input (probably because of a failed buildEventFromInput call), returns an empty array.
	// HACK: can override the recurring window by providing custom rangeStart/rangeEnd (for businessHours).
	function expandEvent(abstractEvent, _rangeStart, _rangeEnd) {
		var events = [];
		var dowHash;
		var dow;
		var i;
		var date;
		var startTime, endTime;
		var start, end;
		var event;

		_rangeStart = _rangeStart || rangeStart;
		_rangeEnd = _rangeEnd || rangeEnd;

		if (abstractEvent) {
			if (abstractEvent._recurring) {

				// make a boolean hash as to whether the event occurs on each day-of-week
				if ((dow = abstractEvent.dow)) {
					dowHash = {};
					for (i = 0; i < dow.length; i++) {
						dowHash[dow[i]] = true;
					}
				}

				// iterate through every day in the current range
				date = _rangeStart.clone().stripTime(); // holds the date of the current day
				while (date.isBefore(_rangeEnd)) {

					if (!dowHash || dowHash[date.day()]) { // if everyday, or this particular day-of-week

						startTime = abstractEvent.start; // the stored start and end properties are times (Durations)
						endTime = abstractEvent.end; // "
						start = date.clone();
						end = null;

						if (startTime) {
							start = start.time(startTime);
						}
						if (endTime) {
							end = date.clone().time(endTime);
						}

						event = $.extend({}, abstractEvent); // make a copy of the original
						assignDatesToEvent(
							start, end,
							!startTime && !endTime, // allDay?
							event
						);
						events.push(event);
					}

					date.add(1, 'days');
				}
			}
			else {
				events.push(abstractEvent); // return the original event. will be a one-item array
			}
		}

		return events;
	}



	/* Event Modification Math
	-----------------------------------------------------------------------------------------*/


	// Modifies an event and all related events by applying the given properties.
	// Special date-diffing logic is used for manipulation of dates.
	// If `props` does not contain start/end dates, the updated values are assumed to be the event's current start/end.
	// All date comparisons are done against the event's pristine _start and _end dates.
	// Returns an object with delta information and a function to undo all operations.
	// For making computations in a granularity greater than day/time, specify largeUnit.
	// NOTE: The given `newProps` might be mutated for normalization purposes.
	function mutateEvent(event, newProps, largeUnit) {
		var miscProps = {};
		var oldProps;
		var clearEnd;
		var startDelta;
		var endDelta;
		var durationDelta;
		var undoFunc;

		// diffs the dates in the appropriate way, returning a duration
		function diffDates(date1, date0) { // date1 - date0
			if (largeUnit) {
				return diffByUnit(date1, date0, largeUnit);
			}
			else if (newProps.allDay) {
				return diffDay(date1, date0);
			}
			else {
				return diffDayTime(date1, date0);
			}
		}

		newProps = newProps || {};

		// normalize new date-related properties
		if (!newProps.start) {
			newProps.start = event.start.clone();
		}
		if (newProps.end === undefined) {
			newProps.end = event.end ? event.end.clone() : null;
		}
		if (newProps.allDay == null) { // is null or undefined?
			newProps.allDay = event.allDay;
		}
		normalizeEventDates(newProps);

		// create normalized versions of the original props to compare against
		// need a real end value, for diffing
		oldProps = {
			start: event._start.clone(),
			end: event._end ? event._end.clone() : t.getDefaultEventEnd(event._allDay, event._start),
			allDay: newProps.allDay // normalize the dates in the same regard as the new properties
		};
		normalizeEventDates(oldProps);

		// need to clear the end date if explicitly changed to null
		clearEnd = event._end !== null && newProps.end === null;

		// compute the delta for moving the start date
		startDelta = diffDates(newProps.start, oldProps.start);

		// compute the delta for moving the end date
		if (newProps.end) {
			endDelta = diffDates(newProps.end, oldProps.end);
			durationDelta = endDelta.subtract(startDelta);
		}
		else {
			durationDelta = null;
		}

		// gather all non-date-related properties
		$.each(newProps, function(name, val) {
			if (isMiscEventPropName(name)) {
				if (val !== undefined) {
					miscProps[name] = val;
				}
			}
		});

		// apply the operations to the event and all related events
		undoFunc = mutateEvents(
			clientEvents(event._id), // get events with this ID
			clearEnd,
			newProps.allDay,
			startDelta,
			durationDelta,
			miscProps
		);

		return {
			dateDelta: startDelta,
			durationDelta: durationDelta,
			undo: undoFunc
		};
	}


	// Modifies an array of events in the following ways (operations are in order):
	// - clear the event's `end`
	// - convert the event to allDay
	// - add `dateDelta` to the start and end
	// - add `durationDelta` to the event's duration
	// - assign `miscProps` to the event
	//
	// Returns a function that can be called to undo all the operations.
	//
	// TODO: don't use so many closures. possible memory issues when lots of events with same ID.
	//
	function mutateEvents(events, clearEnd, allDay, dateDelta, durationDelta, miscProps) {
		var isAmbigTimezone = t.getIsAmbigTimezone();
		var undoFunctions = [];

		// normalize zero-length deltas to be null
		if (dateDelta && !dateDelta.valueOf()) { dateDelta = null; }
		if (durationDelta && !durationDelta.valueOf()) { durationDelta = null; }

		$.each(events, function(i, event) {
			var oldProps;
			var newProps;

			// build an object holding all the old values, both date-related and misc.
			// for the undo function.
			oldProps = {
				start: event.start.clone(),
				end: event.end ? event.end.clone() : null,
				allDay: event.allDay
			};
			$.each(miscProps, function(name) {
				oldProps[name] = event[name];
			});

			// new date-related properties. work off the original date snapshot.
			// ok to use references because they will be thrown away when backupEventDates is called.
			newProps = {
				start: event._start,
				end: event._end,
				allDay: allDay // normalize the dates in the same regard as the new properties
			};
			normalizeEventDates(newProps); // massages start/end/allDay

			// strip or ensure the end date
			if (clearEnd) {
				newProps.end = null;
			}
			else if (durationDelta && !newProps.end) { // the duration translation requires an end date
				newProps.end = t.getDefaultEventEnd(newProps.allDay, newProps.start);
			}

			if (dateDelta) {
				newProps.start.add(dateDelta);
				if (newProps.end) {
					newProps.end.add(dateDelta);
				}
			}

			if (durationDelta) {
				newProps.end.add(durationDelta); // end already ensured above
			}

			// if the dates have changed, and we know it is impossible to recompute the
			// timezone offsets, strip the zone.
			if (
				isAmbigTimezone &&
				!newProps.allDay &&
				(dateDelta || durationDelta)
			) {
				newProps.start.stripZone();
				if (newProps.end) {
					newProps.end.stripZone();
				}
			}

			$.extend(event, miscProps, newProps); // copy over misc props, then date-related props
			backupEventDates(event); // regenerate internal _start/_end/_allDay

			undoFunctions.push(function() {
				$.extend(event, oldProps);
				backupEventDates(event); // regenerate internal _start/_end/_allDay
			});
		});

		return function() {
			for (var i = 0; i < undoFunctions.length; i++) {
				undoFunctions[i]();
			}
		};
	}


	/* Business Hours
	-----------------------------------------------------------------------------------------*/

	t.getBusinessHoursEvents = getBusinessHoursEvents;


	// Returns an array of events as to when the business hours occur in the given view.
	// Abuse of our event system :(
	function getBusinessHoursEvents(wholeDay) {
		var optionVal = options.businessHours;
		var defaultVal = {
			className: 'fc-nonbusiness',
			start: '09:00',
			end: '17:00',
			dow: [ 1, 2, 3, 4, 5 ], // monday - friday
			rendering: 'inverse-background'
		};
		var view = t.getView();
		var eventInput;

		if (optionVal) { // `true` (which means "use the defaults") or an override object
			eventInput = $.extend(
				{}, // copy to a new object in either case
				defaultVal,
				typeof optionVal === 'object' ? optionVal : {} // override the defaults
			);
		}

		if (eventInput) {

			// if a whole-day series is requested, clear the start/end times
			if (wholeDay) {
				eventInput.start = null;
				eventInput.end = null;
			}

			return expandEvent(
				buildEventFromInput(eventInput),
				view.start,
				view.end
			);
		}

		return [];
	}


	/* Overlapping / Constraining
	-----------------------------------------------------------------------------------------*/

	t.isEventSpanAllowed = isEventSpanAllowed;
	t.isExternalSpanAllowed = isExternalSpanAllowed;
	t.isSelectionSpanAllowed = isSelectionSpanAllowed;


	// Determines if the given event can be relocated to the given span (unzoned start/end with other misc data)
	function isEventSpanAllowed(span, event) {
		var source = event.source || {};
		var constraint = firstDefined(
			event.constraint,
			source.constraint,
			options.eventConstraint
		);
		var overlap = firstDefined(
			event.overlap,
			source.overlap,
			options.eventOverlap
		);
		return isSpanAllowed(span, constraint, overlap, event);
	}


	// Determines if an external event can be relocated to the given span (unzoned start/end with other misc data)
	function isExternalSpanAllowed(eventSpan, eventLocation, eventProps) {
		var eventInput;
		var event;

		// note: very similar logic is in View's reportExternalDrop
		if (eventProps) {
			eventInput = $.extend({}, eventProps, eventLocation);
			event = expandEvent(buildEventFromInput(eventInput))[0];
		}

		if (event) {
			return isEventSpanAllowed(eventSpan, event);
		}
		else { // treat it as a selection

			return isSelectionSpanAllowed(eventSpan);
		}
	}


	// Determines the given span (unzoned start/end with other misc data) can be selected.
	function isSelectionSpanAllowed(span) {
		return isSpanAllowed(span, options.selectConstraint, options.selectOverlap);
	}


	// Returns true if the given span (caused by an event drop/resize or a selection) is allowed to exist
	// according to the constraint/overlap settings.
	// `event` is not required if checking a selection.
	function isSpanAllowed(span, constraint, overlap, event) {
		var constraintEvents;
		var anyContainment;
		var peerEvents;
		var i, peerEvent;
		var peerOverlap;

		// the range must be fully contained by at least one of produced constraint events
		if (constraint != null) {

			// not treated as an event! intermediate data structure
			// TODO: use ranges in the future
			constraintEvents = constraintToEvents(constraint);

			anyContainment = false;
			for (i = 0; i < constraintEvents.length; i++) {
				if (eventContainsRange(constraintEvents[i], span)) {
					anyContainment = true;
					break;
				}
			}

			if (!anyContainment) {
				return false;
			}
		}

		peerEvents = t.getPeerEvents(span, event);

		for (i = 0; i < peerEvents.length; i++)  {
			peerEvent = peerEvents[i];

			// there needs to be an actual intersection before disallowing anything
			if (eventIntersectsRange(peerEvent, span)) {

				// evaluate overlap for the given range and short-circuit if necessary
				if (overlap === false) {
					return false;
				}
				// if the event's overlap is a test function, pass the peer event in question as the first param
				else if (typeof overlap === 'function' && !overlap(peerEvent, event)) {
					return false;
				}

				// if we are computing if the given range is allowable for an event, consider the other event's
				// EventObject-specific or Source-specific `overlap` property
				if (event) {
					peerOverlap = firstDefined(
						peerEvent.overlap,
						(peerEvent.source || {}).overlap
						// we already considered the global `eventOverlap`
					);
					if (peerOverlap === false) {
						return false;
					}
					// if the peer event's overlap is a test function, pass the subject event as the first param
					if (typeof peerOverlap === 'function' && !peerOverlap(event, peerEvent)) {
						return false;
					}
				}
			}
		}

		return true;
	}


	// Given an event input from the API, produces an array of event objects. Possible event inputs:
	// 'businessHours'
	// An event ID (number or string)
	// An object with specific start/end dates or a recurring event (like what businessHours accepts)
	function constraintToEvents(constraintInput) {

		if (constraintInput === 'businessHours') {
			return getBusinessHoursEvents();
		}

		if (typeof constraintInput === 'object') {
			return expandEvent(buildEventFromInput(constraintInput));
		}

		return clientEvents(constraintInput); // probably an ID
	}


	// Does the event's date range fully contain the given range?
	// start/end already assumed to have stripped zones :(
	function eventContainsRange(event, range) {
		var eventStart = event.start.clone().stripZone();
		var eventEnd = t.getEventEnd(event).stripZone();

		return range.start >= eventStart && range.end <= eventEnd;
	}


	// Does the event's date range intersect with the given range?
	// start/end already assumed to have stripped zones :(
	function eventIntersectsRange(event, range) {
		var eventStart = event.start.clone().stripZone();
		var eventEnd = t.getEventEnd(event).stripZone();

		return range.start < eventEnd && range.end > eventStart;
	}


	t.getEventCache = function() {
		return cache;
	};

}


// Returns a list of events that the given event should be compared against when being considered for a move to
// the specified span. Attached to the Calendar's prototype because EventManager is a mixin for a Calendar.
Calendar.prototype.getPeerEvents = function(span, event) {
	var cache = this.getEventCache();
	var peerEvents = [];
	var i, otherEvent;

	for (i = 0; i < cache.length; i++) {
		otherEvent = cache[i];
		if (
			!event ||
			event._id !== otherEvent._id // don't compare the event to itself or other related [repeating] events
		) {
			peerEvents.push(otherEvent);
		}
	}

	return peerEvents;
};


// updates the "backup" properties, which are preserved in order to compute diffs later on.
function backupEventDates(event) {
	event._allDay = event.allDay;
	event._start = event.start.clone();
	event._end = event.end ? event.end.clone() : null;
}

;;

/* An abstract class for the "basic" views, as well as month view. Renders one or more rows of day cells.
----------------------------------------------------------------------------------------------------------------------*/
// It is a manager for a DayGrid subcomponent, which does most of the heavy lifting.
// It is responsible for managing width/height.

var BasicView = FC.BasicView = View.extend({

	dayGridClass: DayGrid, // class the dayGrid will be instantiated from (overridable by subclasses)
	dayGrid: null, // the main subcomponent that does most of the heavy lifting

	dayNumbersVisible: false, // display day numbers on each day cell?
	weekNumbersVisible: false, // display week numbers along the side?

	weekNumberWidth: null, // width of all the week-number cells running down the side

	headContainerEl: null, // div that hold's the dayGrid's rendered date header
	headRowEl: null, // the fake row element of the day-of-week header


	initialize: function() {
		this.dayGrid = this.instantiateDayGrid();
	},


	// Generates the DayGrid object this view needs. Draws from this.dayGridClass
	instantiateDayGrid: function() {
		// generate a subclass on the fly with BasicView-specific behavior
		// TODO: cache this subclass
		var subclass = this.dayGridClass.extend(basicDayGridMethods);

		return new subclass(this);
	},


	// Sets the display range and computes all necessary dates
	setRange: function(range) {
		View.prototype.setRange.call(this, range); // call the super-method

		this.dayGrid.breakOnWeeks = /year|month|week/.test(this.intervalUnit); // do before setRange
		this.dayGrid.setRange(range);
	},


	// Compute the value to feed into setRange. Overrides superclass.
	computeRange: function(date) {
		var range = View.prototype.computeRange.call(this, date); // get value from the super-method

		// year and month views should be aligned with weeks. this is already done for week
		if (/year|month/.test(range.intervalUnit)) {
			range.start.startOf('week');
			range.start = this.skipHiddenDays(range.start);

			// make end-of-week if not already
			if (range.end.weekday()) {
				range.end.add(1, 'week').startOf('week');
				range.end = this.skipHiddenDays(range.end, -1, true); // exclusively move backwards
			}
		}

		return range;
	},


	// Renders the view into `this.el`, which should already be assigned
	renderDates: function() {

		this.dayNumbersVisible = this.dayGrid.rowCnt > 1; // TODO: make grid responsible
		this.weekNumbersVisible = this.opt('weekNumbers');
		this.dayGrid.numbersVisible = this.dayNumbersVisible || this.weekNumbersVisible;

		this.el.addClass('fc-basic-view').html(this.renderSkeletonHtml());
		this.renderHead();

		this.scrollerEl = this.el.find('.fc-day-grid-container');

		this.dayGrid.setElement(this.el.find('.fc-day-grid'));
		this.dayGrid.renderDates(this.hasRigidRows());
	},


	// render the day-of-week headers
	renderHead: function() {
		this.headContainerEl =
			this.el.find('.fc-head-container')
				.html(this.dayGrid.renderHeadHtml());
		this.headRowEl = this.headContainerEl.find('.fc-row');
	},


	// Unrenders the content of the view. Since we haven't separated skeleton rendering from date rendering,
	// always completely kill the dayGrid's rendering.
	unrenderDates: function() {
		this.dayGrid.unrenderDates();
		this.dayGrid.removeElement();
	},


	renderBusinessHours: function() {
		this.dayGrid.renderBusinessHours();
	},


	// Builds the HTML skeleton for the view.
	// The day-grid component will render inside of a container defined by this HTML.
	renderSkeletonHtml: function() {
		return '' +
			'<table>' +
				'<thead class="fc-head">' +
					'<tr>' +
						'<td class="fc-head-container ' + this.widgetHeaderClass + '"></td>' +
					'</tr>' +
				'</thead>' +
				'<tbody class="fc-body">' +
					'<tr>' +
						'<td class="' + this.widgetContentClass + '">' +
							'<div class="fc-day-grid-container">' +
								'<div class="fc-day-grid"/>' +
							'</div>' +
						'</td>' +
					'</tr>' +
				'</tbody>' +
			'</table>';
	},


	// Generates an HTML attribute string for setting the width of the week number column, if it is known
	weekNumberStyleAttr: function() {
		if (this.weekNumberWidth !== null) {
			return 'style="width:' + this.weekNumberWidth + 'px"';
		}
		return '';
	},


	// Determines whether each row should have a constant height
	hasRigidRows: function() {
		var eventLimit = this.opt('eventLimit');
		return eventLimit && typeof eventLimit !== 'number';
	},


	/* Dimensions
	------------------------------------------------------------------------------------------------------------------*/


	// Refreshes the horizontal dimensions of the view
	updateWidth: function() {
		if (this.weekNumbersVisible) {
			// Make sure all week number cells running down the side have the same width.
			// Record the width for cells created later.
			this.weekNumberWidth = matchCellWidths(
				this.el.find('.fc-week-number')
			);
		}
	},


	// Adjusts the vertical dimensions of the view to the specified values
	setHeight: function(totalHeight, isAuto) {
		var eventLimit = this.opt('eventLimit');
		var scrollerHeight;

		// reset all heights to be natural
		unsetScroller(this.scrollerEl);
		uncompensateScroll(this.headRowEl);

		this.dayGrid.removeSegPopover(); // kill the "more" popover if displayed

		// is the event limit a constant level number?
		if (eventLimit && typeof eventLimit === 'number') {
			this.dayGrid.limitRows(eventLimit); // limit the levels first so the height can redistribute after
		}

		scrollerHeight = this.computeScrollerHeight(totalHeight);
		this.setGridHeight(scrollerHeight, isAuto);

		// is the event limit dynamically calculated?
		if (eventLimit && typeof eventLimit !== 'number') {
			this.dayGrid.limitRows(eventLimit); // limit the levels after the grid's row heights have been set
		}

		if (!isAuto && setPotentialScroller(this.scrollerEl, scrollerHeight)) { // using scrollbars?

			compensateScroll(this.headRowEl, getScrollbarWidths(this.scrollerEl));

			// doing the scrollbar compensation might have created text overflow which created more height. redo
			scrollerHeight = this.computeScrollerHeight(totalHeight);
			this.scrollerEl.height(scrollerHeight);
		}
	},


	// Sets the height of just the DayGrid component in this view
	setGridHeight: function(height, isAuto) {
		if (isAuto) {
			undistributeHeight(this.dayGrid.rowEls); // let the rows be their natural height with no expanding
		}
		else {
			distributeHeight(this.dayGrid.rowEls, height, true); // true = compensate for height-hogging rows
		}
	},


	/* Hit Areas
	------------------------------------------------------------------------------------------------------------------*/
	// forward all hit-related method calls to dayGrid


	prepareHits: function() {
		this.dayGrid.prepareHits();
	},


	releaseHits: function() {
		this.dayGrid.releaseHits();
	},


	queryHit: function(left, top) {
		return this.dayGrid.queryHit(left, top);
	},


	getHitSpan: function(hit) {
		return this.dayGrid.getHitSpan(hit);
	},


	getHitEl: function(hit) {
		return this.dayGrid.getHitEl(hit);
	},


	/* Events
	------------------------------------------------------------------------------------------------------------------*/


	// Renders the given events onto the view and populates the segments array
	renderEvents: function(events) {
		this.dayGrid.renderEvents(events);

		this.updateHeight(); // must compensate for events that overflow the row
	},


	// Retrieves all segment objects that are rendered in the view
	getEventSegs: function() {
		return this.dayGrid.getEventSegs();
	},


	// Unrenders all event elements and clears internal segment data
	unrenderEvents: function() {
		this.dayGrid.unrenderEvents();

		// we DON'T need to call updateHeight() because:
		// A) a renderEvents() call always happens after this, which will eventually call updateHeight()
		// B) in IE8, this causes a flash whenever events are rerendered
	},


	/* Dragging (for both events and external elements)
	------------------------------------------------------------------------------------------------------------------*/


	// A returned value of `true` signals that a mock "helper" event has been rendered.
	renderDrag: function(dropLocation, seg) {
		return this.dayGrid.renderDrag(dropLocation, seg);
	},


	unrenderDrag: function() {
		this.dayGrid.unrenderDrag();
	},


	/* Selection
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of a selection
	renderSelection: function(span) {
		this.dayGrid.renderSelection(span);
	},


	// Unrenders a visual indications of a selection
	unrenderSelection: function() {
		this.dayGrid.unrenderSelection();
	}

});


// Methods that will customize the rendering behavior of the BasicView's dayGrid
var basicDayGridMethods = {


	// Generates the HTML that will go before the day-of week header cells
	renderHeadIntroHtml: function() {
		var view = this.view;

		if (view.weekNumbersVisible) {
			return '' +
				'<th class="fc-week-number ' + view.widgetHeaderClass + '" ' + view.weekNumberStyleAttr() + '>' +
					'<span>' + // needed for matchCellWidths
						htmlEscape(view.opt('weekNumberTitle')) +
					'</span>' +
				'</th>';
		}

		return '';
	},


	// Generates the HTML that will go before content-skeleton cells that display the day/week numbers
	renderNumberIntroHtml: function(row) {
		var view = this.view;

		if (view.weekNumbersVisible) {
			return '' +
				'<td class="fc-week-number" ' + view.weekNumberStyleAttr() + '>' +
					'<span>' + // needed for matchCellWidths
						this.getCellDate(row, 0).format('w') +
					'</span>' +
				'</td>';
		}

		return '';
	},


	// Generates the HTML that goes before the day bg cells for each day-row
	renderBgIntroHtml: function() {
		var view = this.view;

		if (view.weekNumbersVisible) {
			return '<td class="fc-week-number ' + view.widgetContentClass + '" ' +
				view.weekNumberStyleAttr() + '></td>';
		}

		return '';
	},


	// Generates the HTML that goes before every other type of row generated by DayGrid.
	// Affects helper-skeleton and highlight-skeleton rows.
	renderIntroHtml: function() {
		var view = this.view;

		if (view.weekNumbersVisible) {
			return '<td class="fc-week-number" ' + view.weekNumberStyleAttr() + '></td>';
		}

		return '';
	}

};

;;

/* A month view with day cells running in rows (one-per-week) and columns
----------------------------------------------------------------------------------------------------------------------*/

var MonthView = FC.MonthView = BasicView.extend({

	// Produces information about what range to display
	computeRange: function(date) {
		var range = BasicView.prototype.computeRange.call(this, date); // get value from super-method
		var rowCnt;

		// ensure 6 weeks
		if (this.isFixedWeeks()) {
			rowCnt = Math.ceil(range.end.diff(range.start, 'weeks', true)); // could be partial weeks due to hiddenDays
			range.end.add(6 - rowCnt, 'weeks');
		}

		return range;
	},


	// Overrides the default BasicView behavior to have special multi-week auto-height logic
	setGridHeight: function(height, isAuto) {

		isAuto = isAuto || this.opt('weekMode') === 'variable'; // LEGACY: weekMode is deprecated

		// if auto, make the height of each row the height that it would be if there were 6 weeks
		if (isAuto) {
			height *= this.rowCnt / 6;
		}

		distributeHeight(this.dayGrid.rowEls, height, !isAuto); // if auto, don't compensate for height-hogging rows
	},


	isFixedWeeks: function() {
		var weekMode = this.opt('weekMode'); // LEGACY: weekMode is deprecated
		if (weekMode) {
			return weekMode === 'fixed'; // if any other type of weekMode, assume NOT fixed
		}

		return this.opt('fixedWeekCount');
	}

});

;;

fcViews.basic = {
	'class': BasicView
};

fcViews.basicDay = {
	type: 'basic',
	duration: { days: 1 }
};

fcViews.basicWeek = {
	type: 'basic',
	duration: { weeks: 1 }
};

fcViews.month = {
	'class': MonthView,
	duration: { months: 1 }, // important for prev/next
	defaults: {
		fixedWeekCount: true
	}
};
;;

/* An abstract class for all agenda-related views. Displays one more columns with time slots running vertically.
----------------------------------------------------------------------------------------------------------------------*/
// Is a manager for the TimeGrid subcomponent and possibly the DayGrid subcomponent (if allDaySlot is on).
// Responsible for managing width/height.

var AgendaView = FC.AgendaView = View.extend({

	timeGridClass: TimeGrid, // class used to instantiate the timeGrid. subclasses can override
	timeGrid: null, // the main time-grid subcomponent of this view

	dayGridClass: DayGrid, // class used to instantiate the dayGrid. subclasses can override
	dayGrid: null, // the "all-day" subcomponent. if all-day is turned off, this will be null

	axisWidth: null, // the width of the time axis running down the side

	headContainerEl: null, // div that hold's the timeGrid's rendered date header
	noScrollRowEls: null, // set of fake row elements that must compensate when scrollerEl has scrollbars

	// when the time-grid isn't tall enough to occupy the given height, we render an <hr> underneath
	bottomRuleEl: null,
	bottomRuleHeight: null,


	initialize: function() {
		this.timeGrid = this.instantiateTimeGrid();

		if (this.opt('allDaySlot')) { // should we display the "all-day" area?
			this.dayGrid = this.instantiateDayGrid(); // the all-day subcomponent of this view
		}
	},


	// Instantiates the TimeGrid object this view needs. Draws from this.timeGridClass
	instantiateTimeGrid: function() {
		var subclass = this.timeGridClass.extend(agendaTimeGridMethods);

		return new subclass(this);
	},


	// Instantiates the DayGrid object this view might need. Draws from this.dayGridClass
	instantiateDayGrid: function() {
		var subclass = this.dayGridClass.extend(agendaDayGridMethods);

		return new subclass(this);
	},


	/* Rendering
	------------------------------------------------------------------------------------------------------------------*/


	// Sets the display range and computes all necessary dates
	setRange: function(range) {
		View.prototype.setRange.call(this, range); // call the super-method

		this.timeGrid.setRange(range);
		if (this.dayGrid) {
			this.dayGrid.setRange(range);
		}
	},


	// Renders the view into `this.el`, which has already been assigned
	renderDates: function() {

		this.el.addClass('fc-agenda-view').html(this.renderSkeletonHtml());
		this.renderHead();

		// the element that wraps the time-grid that will probably scroll
		this.scrollerEl = this.el.find('.fc-time-grid-container');

		this.timeGrid.setElement(this.el.find('.fc-time-grid'));
		this.timeGrid.renderDates();

		// the <hr> that sometimes displays under the time-grid
		this.bottomRuleEl = $('<hr class="fc-divider ' + this.widgetHeaderClass + '"/>')
			.appendTo(this.timeGrid.el); // inject it into the time-grid

		if (this.dayGrid) {
			this.dayGrid.setElement(this.el.find('.fc-day-grid'));
			this.dayGrid.renderDates();

			// have the day-grid extend it's coordinate area over the <hr> dividing the two grids
			this.dayGrid.bottomCoordPadding = this.dayGrid.el.next('hr').outerHeight();
		}

		this.noScrollRowEls = this.el.find('.fc-row:not(.fc-scroller *)'); // fake rows not within the scroller
	},


	// render the day-of-week headers
	renderHead: function() {
		this.headContainerEl =
			this.el.find('.fc-head-container')
				.html(this.timeGrid.renderHeadHtml());
	},


	// Unrenders the content of the view. Since we haven't separated skeleton rendering from date rendering,
	// always completely kill each grid's rendering.
	unrenderDates: function() {
		this.timeGrid.unrenderDates();
		this.timeGrid.removeElement();

		if (this.dayGrid) {
			this.dayGrid.unrenderDates();
			this.dayGrid.removeElement();
		}
	},


	renderBusinessHours: function() {
		this.timeGrid.renderBusinessHours();

		if (this.dayGrid) {
			this.dayGrid.renderBusinessHours();
		}
	},


	// Builds the HTML skeleton for the view.
	// The day-grid and time-grid components will render inside containers defined by this HTML.
	renderSkeletonHtml: function() {
		return '' +
			'<table>' +
				'<thead class="fc-head">' +
					'<tr>' +
						'<td class="fc-head-container ' + this.widgetHeaderClass + '"></td>' +
					'</tr>' +
				'</thead>' +
				'<tbody class="fc-body">' +
					'<tr>' +
						'<td class="' + this.widgetContentClass + '">' +
							(this.dayGrid ?
								'<div class="fc-day-grid"/>' +
								'<hr class="fc-divider ' + this.widgetHeaderClass + '"/>' :
								''
								) +
							'<div class="fc-time-grid-container">' +
								'<div class="fc-time-grid"/>' +
							'</div>' +
						'</td>' +
					'</tr>' +
				'</tbody>' +
			'</table>';
	},


	// Generates an HTML attribute string for setting the width of the axis, if it is known
	axisStyleAttr: function() {
		if (this.axisWidth !== null) {
			 return 'style="width:' + this.axisWidth + 'px"';
		}
		return '';
	},


	/* Dimensions
	------------------------------------------------------------------------------------------------------------------*/


	updateSize: function(isResize) {
		this.timeGrid.updateSize(isResize);

		View.prototype.updateSize.call(this, isResize); // call the super-method
	},


	// Refreshes the horizontal dimensions of the view
	updateWidth: function() {
		// make all axis cells line up, and record the width so newly created axis cells will have it
		this.axisWidth = matchCellWidths(this.el.find('.fc-axis'));
	},


	// Adjusts the vertical dimensions of the view to the specified values
	setHeight: function(totalHeight, isAuto) {
		var eventLimit;
		var scrollerHeight;

		if (this.bottomRuleHeight === null) {
			// calculate the height of the rule the very first time
			this.bottomRuleHeight = this.bottomRuleEl.outerHeight();
		}
		this.bottomRuleEl.hide(); // .show() will be called later if this <hr> is necessary

		// reset all dimensions back to the original state
		this.scrollerEl.css('overflow', '');
		unsetScroller(this.scrollerEl);
		uncompensateScroll(this.noScrollRowEls);

		// limit number of events in the all-day area
		if (this.dayGrid) {
			this.dayGrid.removeSegPopover(); // kill the "more" popover if displayed

			eventLimit = this.opt('eventLimit');
			if (eventLimit && typeof eventLimit !== 'number') {
				eventLimit = AGENDA_ALL_DAY_EVENT_LIMIT; // make sure "auto" goes to a real number
			}
			if (eventLimit) {
				this.dayGrid.limitRows(eventLimit);
			}
		}

		if (!isAuto) { // should we force dimensions of the scroll container, or let the contents be natural height?

			scrollerHeight = this.computeScrollerHeight(totalHeight);
			if (setPotentialScroller(this.scrollerEl, scrollerHeight)) { // using scrollbars?

				// make the all-day and header rows lines up
				compensateScroll(this.noScrollRowEls, getScrollbarWidths(this.scrollerEl));

				// the scrollbar compensation might have changed text flow, which might affect height, so recalculate
				// and reapply the desired height to the scroller.
				scrollerHeight = this.computeScrollerHeight(totalHeight);
				this.scrollerEl.height(scrollerHeight);
			}
			else { // no scrollbars
				// still, force a height and display the bottom rule (marks the end of day)
				this.scrollerEl.height(scrollerHeight).css('overflow', 'hidden'); // in case <hr> goes outside
				this.bottomRuleEl.show();
			}
		}
	},


	// Computes the initial pre-configured scroll state prior to allowing the user to change it
	computeInitialScroll: function() {
		var scrollTime = confimoment.duration(this.opt('scrollTime'));
		var top = this.timeGrid.computeTimeTop(scrollTime);

		// zoom can give weird floating-point values. rather scroll a little bit further
		top = Math.ceil(top);

		if (top) {
			top++; // to overcome top border that slots beyond the first have. looks better
		}

		return top;
	},


	/* Hit Areas
	------------------------------------------------------------------------------------------------------------------*/
	// forward all hit-related method calls to the grids (dayGrid might not be defined)


	prepareHits: function() {
		this.timeGrid.prepareHits();
		if (this.dayGrid) {
			this.dayGrid.prepareHits();
		}
	},


	releaseHits: function() {
		this.timeGrid.releaseHits();
		if (this.dayGrid) {
			this.dayGrid.releaseHits();
		}
	},


	queryHit: function(left, top) {
		var hit = this.timeGrid.queryHit(left, top);

		if (!hit && this.dayGrid) {
			hit = this.dayGrid.queryHit(left, top);
		}

		return hit;
	},


	getHitSpan: function(hit) {
		// TODO: hit.component is set as a hack to identify where the hit came from
		return hit.component.getHitSpan(hit);
	},


	getHitEl: function(hit) {
		// TODO: hit.component is set as a hack to identify where the hit came from
		return hit.component.getHitEl(hit);
	},


	/* Events
	------------------------------------------------------------------------------------------------------------------*/


	// Renders events onto the view and populates the View's segment array
	renderEvents: function(events) {
		var dayEvents = [];
		var timedEvents = [];
		var daySegs = [];
		var timedSegs;
		var i;

		// separate the events into all-day and timed
		for (i = 0; i < events.length; i++) {
			if (events[i].allDay) {
				dayEvents.push(events[i]);
			}
			else {
				timedEvents.push(events[i]);
			}
		}

		// render the events in the subcomponents
		timedSegs = this.timeGrid.renderEvents(timedEvents);
		if (this.dayGrid) {
			daySegs = this.dayGrid.renderEvents(dayEvents);
		}

		// the all-day area is flexible and might have a lot of events, so shift the height
		this.updateHeight();
	},


	// Retrieves all segment objects that are rendered in the view
	getEventSegs: function() {
		return this.timeGrid.getEventSegs().concat(
			this.dayGrid ? this.dayGrid.getEventSegs() : []
		);
	},


	// Unrenders all event elements and clears internal segment data
	unrenderEvents: function() {

		// unrender the events in the subcomponents
		this.timeGrid.unrenderEvents();
		if (this.dayGrid) {
			this.dayGrid.unrenderEvents();
		}

		// we DON'T need to call updateHeight() because:
		// A) a renderEvents() call always happens after this, which will eventually call updateHeight()
		// B) in IE8, this causes a flash whenever events are rerendered
	},


	/* Dragging (for events and external elements)
	------------------------------------------------------------------------------------------------------------------*/


	// A returned value of `true` signals that a mock "helper" event has been rendered.
	renderDrag: function(dropLocation, seg) {
		if (dropLocation.start.hasTime()) {
			return this.timeGrid.renderDrag(dropLocation, seg);
		}
		else if (this.dayGrid) {
			return this.dayGrid.renderDrag(dropLocation, seg);
		}
	},


	unrenderDrag: function() {
		this.timeGrid.unrenderDrag();
		if (this.dayGrid) {
			this.dayGrid.unrenderDrag();
		}
	},


	/* Selection
	------------------------------------------------------------------------------------------------------------------*/


	// Renders a visual indication of a selection
	renderSelection: function(span) {
		if (span.start.hasTime() || span.end.hasTime()) {
			this.timeGrid.renderSelection(span);
		}
		else if (this.dayGrid) {
			this.dayGrid.renderSelection(span);
		}
	},


	// Unrenders a visual indications of a selection
	unrenderSelection: function() {
		this.timeGrid.unrenderSelection();
		if (this.dayGrid) {
			this.dayGrid.unrenderSelection();
		}
	}

});


// Methods that will customize the rendering behavior of the AgendaView's timeGrid
var agendaTimeGridMethods = {


	// Generates the HTML that will go before the day-of week header cells
	renderHeadIntroHtml: function() {
		var view = this.view;
		var weekText;

		if (view.opt('weekNumbers')) {
			weekText = this.start.format(view.opt('smallWeekFormat'));

			return '' +
				'<th class="fc-axis fc-week-number ' + view.widgetHeaderClass + '" ' + view.axisStyleAttr() + '>' +
					'<span>' + // needed for matchCellWidths
						htmlEscape(weekText) +
					'</span>' +
				'</th>';
		}
		else {
			return '<th class="fc-axis ' + view.widgetHeaderClass + '" ' + view.axisStyleAttr() + '></th>';
		}
	},


	// Generates the HTML that goes before the bg of the TimeGrid slot area. Long vertical column.
	renderBgIntroHtml: function() {
		var view = this.view;

		return '<td class="fc-axis ' + view.widgetContentClass + '" ' + view.axisStyleAttr() + '></td>';
	},


	// Generates the HTML that goes before all other types of cells.
	// Affects content-skeleton, helper-skeleton, highlight-skeleton for both the time-grid and day-grid.
	renderIntroHtml: function() {
		var view = this.view;

		return '<td class="fc-axis" ' + view.axisStyleAttr() + '></td>';
	}

};


// Methods that will customize the rendering behavior of the AgendaView's dayGrid
var agendaDayGridMethods = {


	// Generates the HTML that goes before the all-day cells
	renderBgIntroHtml: function() {
		var view = this.view;

		return '' +
			'<td class="fc-axis ' + view.widgetContentClass + '" ' + view.axisStyleAttr() + '>' +
				'<span>' + // needed for matchCellWidths
					(view.opt('allDayHtml') || htmlEscape(view.opt('allDayText'))) +
				'</span>' +
			'</td>';
	},


	// Generates the HTML that goes before all other types of cells.
	// Affects content-skeleton, helper-skeleton, highlight-skeleton for both the time-grid and day-grid.
	renderIntroHtml: function() {
		var view = this.view;

		return '<td class="fc-axis" ' + view.axisStyleAttr() + '></td>';
	}

};

;;

var AGENDA_ALL_DAY_EVENT_LIMIT = 5;

// potential nice values for the slot-duration and interval-duration
// from largest to smallest
var AGENDA_STOCK_SUB_DURATIONS = [
	{ hours: 1 },
	{ minutes: 30 },
	{ minutes: 15 },
	{ seconds: 30 },
	{ seconds: 15 }
];

fcViews.agenda = {
	'class': AgendaView,
	defaults: {
		allDaySlot: true,
		allDayText: 'all-day',
		slotDuration: '00:30:00',
		minTime: '00:00:00',
		maxTime: '24:00:00',
		slotEventOverlap: true // a bad name. confused with overlap/constraint system
	}
};

fcViews.agendaDay = {
	type: 'agenda',
	duration: { days: 1 }
};

fcViews.agendaWeek = {
	type: 'agenda',
	duration: { weeks: 1 }
};
;;

return FC; // export for Node/CommonJS
});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/lang-all.js' */
!function (a) {
  "function" == typeof define && define.amd ? define(["jquery", "confimoment"], a) : a(jQuery, confimoment)
}(function (a, b) {
  !function () {
    (b.defineLocale || b.lang).call(b, "ar-ma", {
      months: "___________".split("_"),
      monthsShort: "___________".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[  ] LT",
        nextDay: "[  ] LT",
        nextWeek: "dddd [ ] LT",
        lastDay: "[  ] LT",
        lastWeek: "dddd [ ] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: " %s",
        s: "",
        m: "",
        mm: "%d ",
        h: "",
        hh: "%d ",
        d: "",
        dd: "%d ",
        M: "",
        MM: "%d ",
        y: "",
        yy: "%d "
      },
      week: {dow: 6, doy: 12}
    }), a.confiFormsCalendar.datepickerLang("ar-ma", "ar", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: [" ", "", "", "", "", "", "", "", "", " ", " ", " "],
      monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd/mm/yy",
      firstDay: 6,
      isRTL: !0,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ar-ma", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: " ",
      eventLimitText: ""
    })
  }(), function () {
    var c = {1: "", 2: "", 3: "", 4: "", 5: "", 6: "", 7: "", 8: "", 9: "", 0: ""}, d = {
      "": "1",
      "": "2",
      "": "3",
      "": "4",
      "": "5",
      "": "6",
      "": "7",
      "": "8",
      "": "9",
      "": "0"
    };
    (b.defineLocale || b.lang).call(b, "ar-sa", {
      months: "___________".split("_"),
      monthsShort: "___________".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "HH:mm:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      meridiemParse: /|/,
      isPM: function (a) {
        return "" === a
      },
      meridiem: function (a, b, c) {
        return 12 > a ? "" : ""
      },
      calendar: {
        sameDay: "[  ] LT",
        nextDay: "[  ] LT",
        nextWeek: "dddd [ ] LT",
        lastDay: "[  ] LT",
        lastWeek: "dddd [ ] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: " %s",
        s: "",
        m: "",
        mm: "%d ",
        h: "",
        hh: "%d ",
        d: "",
        dd: "%d ",
        M: "",
        MM: "%d ",
        y: "",
        yy: "%d "
      },
      preparse: function (a) {
        return a.replace(/[]/g, function (a) {
          return d[a]
        }).replace(//g, ",")
      },
      postformat: function (a) {
        return a.replace(/\d/g, function (a) {
          return c[a]
        }).replace(/,/g, "")
      },
      week: {dow: 6, doy: 12}
    }), a.confiFormsCalendar.datepickerLang("ar-sa", "ar", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: [" ", "", "", "", "", "", "", "", "", " ", " ", " "],
      monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd/mm/yy",
      firstDay: 6,
      isRTL: !0,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ar-sa", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: " ",
      eventLimitText: ""
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "ar-tn", {
      months: "___________".split("_"),
      monthsShort: "___________".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[  ] LT",
        nextDay: "[  ] LT",
        nextWeek: "dddd [ ] LT",
        lastDay: "[  ] LT",
        lastWeek: "dddd [ ] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: " %s",
        s: "",
        m: "",
        mm: "%d ",
        h: "",
        hh: "%d ",
        d: "",
        dd: "%d ",
        M: "",
        MM: "%d ",
        y: "",
        yy: "%d "
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("ar-tn", "ar", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: [" ", "", "", "", "", "", "", "", "", " ", " ", " "],
      monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd/mm/yy",
      firstDay: 6,
      isRTL: !0,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ar-tn", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: " ",
      eventLimitText: ""
    })
  }(), function () {
    var c = {1: "", 2: "", 3: "", 4: "", 5: "", 6: "", 7: "", 8: "", 9: "", 0: ""}, d = {
      "": "1",
      "": "2",
      "": "3",
      "": "4",
      "": "5",
      "": "6",
      "": "7",
      "": "8",
      "": "9",
      "": "0"
    }, e = function (a) {
      return 0 === a ? 0 : 1 === a ? 1 : 2 === a ? 2 : a % 100 >= 3 && 10 >= a % 100 ? 3 : a % 100 >= 11 ? 4 : 5
    }, f = {
      s: ["  ", " ", ["", ""], "%d ", "%d ", "%d "],
      m: ["  ", " ", ["", ""], "%d ", "%d ", "%d "],
      h: ["  ", " ", ["", ""], "%d ", "%d ", "%d "],
      d: ["  ", " ", ["", ""], "%d ", "%d ", "%d "],
      M: ["  ", " ", ["", ""], "%d ", "%d ", "%d "],
      y: ["  ", " ", ["", ""], "%d ", "%d ", "%d "]
    }, g = function (a) {
      return function (b, c, d, g) {
        var h = e(b), i = f[a][e(b)];
        return 2 === h && (i = i[c ? 0 : 1]), i.replace(/%d/i, b)
      }
    }, h = ["  ", " ", " ", " ", " ", " ", " ", " ", " ", "  ", "  ", "  "];
    (b.defineLocale || b.lang).call(b, "ar", {
      months: h,
      monthsShort: h,
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "HH:mm:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      meridiemParse: /|/,
      isPM: function (a) {
        return "" === a
      },
      meridiem: function (a, b, c) {
        return 12 > a ? "" : ""
      },
      calendar: {
        sameDay: "[  ] LT",
        nextDay: "[  ] LT",
        nextWeek: "dddd [ ] LT",
        lastDay: "[  ] LT",
        lastWeek: "dddd [ ] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: " %s",
        s: g("s"),
        m: g("m"),
        mm: g("m"),
        h: g("h"),
        hh: g("h"),
        d: g("d"),
        dd: g("d"),
        M: g("M"),
        MM: g("M"),
        y: g("y"),
        yy: g("y")
      },
      preparse: function (a) {
        return a.replace(/[]/g, function (a) {
          return d[a]
        }).replace(//g, ",")
      },
      postformat: function (a) {
        return a.replace(/\d/g, function (a) {
          return c[a]
        }).replace(/,/g, "")
      },
      week: {dow: 6, doy: 12}
    }), a.confiFormsCalendar.datepickerLang("ar", "ar", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: [" ", "", "", "", "", "", "", "", "", " ", " ", " "],
      monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd/mm/yy",
      firstDay: 6,
      isRTL: !0,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ar", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: " ",
      eventLimitText: ""
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "bg", {
      months: "___________".split("_"),
      monthsShort: "___________".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "D.MM.YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd, D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[ ] LT",
        nextDay: "[ ] LT",
        nextWeek: "dddd [] LT",
        lastDay: "[ ] LT",
        lastWeek: function () {
          switch (this.day()) {
            case 0:
            case 3:
            case 6:
              return "[ ] dddd [] LT";
            case 1:
            case 2:
            case 4:
            case 5:
              return "[ ] dddd [] LT"
          }
        },
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: " %s",
        s: " ",
        m: "",
        mm: "%d ",
        h: "",
        hh: "%d ",
        d: "",
        dd: "%d ",
        M: "",
        MM: "%d ",
        y: "",
        yy: "%d "
      },
      ordinalParse: /\d{1,2}-(|||||)/,
      ordinal: function (a) {
        var b = a % 10, c = a % 100;
        return 0 === a ? a + "-" : 0 === c ? a + "-" : c > 10 && 20 > c ? a + "-" : 1 === b ? a + "-" : 2 === b ? a + "-" : 7 === b || 8 === b ? a + "-" : a + "-"
      },
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("bg", "bg", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      nextBigText: "&#x3E;&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "Wk",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("bg", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: " ",
      eventLimitText: function (a) {
        return "+ " + a
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "ca", {
      months: "gener_febrer_mar_abril_maig_juny_juliol_agost_setembre_octubre_novembre_desembre".split("_"),
      monthsShort: "gen._febr._mar._abr._mai._jun._jul._ag._set._oct._nov._des.".split("_"),
      weekdays: "diumenge_dilluns_dimarts_dimecres_dijous_divendres_dissabte".split("_"),
      weekdaysShort: "dg._dl._dt._dc._dj._dv._ds.".split("_"),
      weekdaysMin: "Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      calendar: {
        sameDay: function () {
          return "[avui a " + (1 !== this.hours() ? "les" : "la") + "] LT"
        }, nextDay: function () {
          return "[dem a " + (1 !== this.hours() ? "les" : "la") + "] LT"
        }, nextWeek: function () {
          return "dddd [a " + (1 !== this.hours() ? "les" : "la") + "] LT"
        }, lastDay: function () {
          return "[ahir a " + (1 !== this.hours() ? "les" : "la") + "] LT"
        }, lastWeek: function () {
          return "[el] dddd [passat a " + (1 !== this.hours() ? "les" : "la") + "] LT"
        }, sameElse: "L"
      },
      relativeTime: {
        future: "en %s",
        past: "fa %s",
        s: "uns segons",
        m: "un minut",
        mm: "%d minuts",
        h: "una hora",
        hh: "%d hores",
        d: "un dia",
        dd: "%d dies",
        M: "un mes",
        MM: "%d mesos",
        y: "un any",
        yy: "%d anys"
      },
      ordinalParse: /\d{1,2}(r|n|t||a)/,
      ordinal: function (a, b) {
        var c = 1 === a ? "r" : 2 === a ? "n" : 3 === a ? "r" : 4 === a ? "t" : "";
        return ("w" === b || "W" === b) && (c = "a"), a + c
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("ca", "ca", {
      closeText: "Tanca",
      prevText: "Anterior",
      nextText: "Segent",
      currentText: "Avui",
      monthNames: ["gener", "febrer", "mar", "abril", "maig", "juny", "juliol", "agost", "setembre", "octubre", "novembre", "desembre"],
      monthNamesShort: ["gen", "feb", "mar", "abr", "maig", "juny", "jul", "ag", "set", "oct", "nov", "des"],
      dayNames: ["diumenge", "dilluns", "dimarts", "dimecres", "dijous", "divendres", "dissabte"],
      dayNamesShort: ["dg", "dl", "dt", "dc", "dj", "dv", "ds"],
      dayNamesMin: ["dg", "dl", "dt", "dc", "dj", "dv", "ds"],
      weekHeader: "Set",
      dateFormat: "dd/mm/yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ca", {
      buttonText: {month: "Mes", week: "Setmana", day: "Dia", list: "Agenda"},
      allDayText: "Tot el dia",
      eventLimitText: "ms"
    })
  }(), function () {
    function c(a) {
      return a > 1 && 5 > a && 1 !== ~~(a / 10)
    }

    function d(a, b, d, e) {
      var f = a + " ";
      switch (d) {
        case"s":
          return b || e ? "pr sekund" : "pr sekundami";
        case"m":
          return b ? "minuta" : e ? "minutu" : "minutou";
        case"mm":
          return b || e ? f + (c(a) ? "minuty" : "minut") : f + "minutami";
        case"h":
          return b ? "hodina" : e ? "hodinu" : "hodinou";
        case"hh":
          return b || e ? f + (c(a) ? "hodiny" : "hodin") : f + "hodinami";
        case"d":
          return b || e ? "den" : "dnem";
        case"dd":
          return b || e ? f + (c(a) ? "dny" : "dn") : f + "dny";
        case"M":
          return b || e ? "msc" : "mscem";
        case"MM":
          return b || e ? f + (c(a) ? "msce" : "msc") : f + "msci";
        case"y":
          return b || e ? "rok" : "rokem";
        case"yy":
          return b || e ? f + (c(a) ? "roky" : "let") : f + "lety"
      }
    }

    var e = "leden_nor_bezen_duben_kvten_erven_ervenec_srpen_z_jen_listopad_prosinec".split("_"), f = "led_no_be_dub_kv_vn_vc_srp_z_j_lis_pro".split("_");
    (b.defineLocale || b.lang).call(b, "cs", {
      months: e,
      monthsShort: f,
      monthsParse: function (a, b) {
        var c, d = [];
        for (c = 0; 12 > c; c++)d[c] = new RegExp("^" + a[c] + "$|^" + b[c] + "$", "i");
        return d
      }(e, f),
      weekdays: "nedle_pondl_ter_steda_tvrtek_ptek_sobota".split("_"),
      weekdaysShort: "ne_po_t_st_t_p_so".split("_"),
      weekdaysMin: "ne_po_t_st_t_p_so".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD.MM.YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[dnes v] LT", nextDay: "[ztra v] LT", nextWeek: function () {
          switch (this.day()) {
            case 0:
              return "[v nedli v] LT";
            case 1:
            case 2:
              return "[v] dddd [v] LT";
            case 3:
              return "[ve stedu v] LT";
            case 4:
              return "[ve tvrtek v] LT";
            case 5:
              return "[v ptek v] LT";
            case 6:
              return "[v sobotu v] LT"
          }
        }, lastDay: "[vera v] LT", lastWeek: function () {
          switch (this.day()) {
            case 0:
              return "[minulou nedli v] LT";
            case 1:
            case 2:
              return "[minul] dddd [v] LT";
            case 3:
              return "[minulou stedu v] LT";
            case 4:
            case 5:
              return "[minul] dddd [v] LT";
            case 6:
              return "[minulou sobotu v] LT"
          }
        }, sameElse: "L"
      },
      relativeTime: {
        future: "za %s",
        past: "ped %s",
        s: d,
        m: d,
        mm: d,
        h: d,
        hh: d,
        d: d,
        dd: d,
        M: d,
        MM: d,
        y: d,
        yy: d
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("cs", "cs", {
      closeText: "Zavt",
      prevText: "&#x3C;Dve",
      nextText: "Pozdji&#x3E;",
      currentText: "Nyn",
      monthNames: ["leden", "nor", "bezen", "duben", "kvten", "erven", "ervenec", "srpen", "z", "jen", "listopad", "prosinec"],
      monthNamesShort: ["led", "no", "be", "dub", "kv", "er", "vc", "srp", "z", "j", "lis", "pro"],
      dayNames: ["nedle", "pondl", "ter", "steda", "tvrtek", "ptek", "sobota"],
      dayNamesShort: ["ne", "po", "t", "st", "t", "p", "so"],
      dayNamesMin: ["ne", "po", "t", "st", "t", "p", "so"],
      weekHeader: "Td",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("cs", {
      buttonText: {month: "Msc", week: "Tden", day: "Den", list: "Agenda"},
      allDayText: "Cel den",
      eventLimitText: function (a) {
        return "+dal: " + a
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "da", {
      months: "januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),
      monthsShort: "jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),
      weekdays: "sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),
      weekdaysShort: "sn_man_tir_ons_tor_fre_lr".split("_"),
      weekdaysMin: "s_ma_ti_on_to_fr_l".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd [d.] D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[I dag kl.] LT",
        nextDay: "[I morgen kl.] LT",
        nextWeek: "dddd [kl.] LT",
        lastDay: "[I gr kl.] LT",
        lastWeek: "[sidste] dddd [kl] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "om %s",
        past: "%s siden",
        s: "f sekunder",
        m: "et minut",
        mm: "%d minutter",
        h: "en time",
        hh: "%d timer",
        d: "en dag",
        dd: "%d dage",
        M: "en mned",
        MM: "%d mneder",
        y: "et r",
        yy: "%d r"
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("da", "da", {
      closeText: "Luk",
      prevText: "&#x3C;Forrige",
      nextText: "Nste&#x3E;",
      currentText: "Idag",
      monthNames: ["Januar", "Februar", "Marts", "April", "Maj", "Juni", "Juli", "August", "September", "Oktober", "November", "December"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "Maj", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dec"],
      dayNames: ["Sndag", "Mandag", "Tirsdag", "Onsdag", "Torsdag", "Fredag", "Lrdag"],
      dayNamesShort: ["Sn", "Man", "Tir", "Ons", "Tor", "Fre", "Lr"],
      dayNamesMin: ["S", "Ma", "Ti", "On", "To", "Fr", "L"],
      weekHeader: "Uge",
      dateFormat: "dd-mm-yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("da", {
      buttonText: {month: "Mned", week: "Uge", day: "Dag", list: "Agenda"},
      allDayText: "Hele dagen",
      eventLimitText: "flere"
    })
  }(), function () {
    function c(a, b, c, d) {
      var e = {
        m: ["eine Minute", "einer Minute"],
        h: ["eine Stunde", "einer Stunde"],
        d: ["ein Tag", "einem Tag"],
        dd: [a + " Tage", a + " Tagen"],
        M: ["ein Monat", "einem Monat"],
        MM: [a + " Monate", a + " Monaten"],
        y: ["ein Jahr", "einem Jahr"],
        yy: [a + " Jahre", a + " Jahren"]
      };
      return b ? e[c][0] : e[c][1]
    }

    (b.defineLocale || b.lang).call(b, "de-at", {
      months: "Jnner_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),
      monthsShort: "Jn._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),
      weekdays: "Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),
      weekdaysShort: "So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),
      weekdaysMin: "So_Mo_Di_Mi_Do_Fr_Sa".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "HH:mm:ss",
        L: "DD.MM.YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd, D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Heute um] LT [Uhr]",
        sameElse: "L",
        nextDay: "[Morgen um] LT [Uhr]",
        nextWeek: "dddd [um] LT [Uhr]",
        lastDay: "[Gestern um] LT [Uhr]",
        lastWeek: "[letzten] dddd [um] LT [Uhr]"
      },
      relativeTime: {
        future: "in %s",
        past: "vor %s",
        s: "ein paar Sekunden",
        m: c,
        mm: "%d Minuten",
        h: c,
        hh: "%d Stunden",
        d: c,
        dd: c,
        M: c,
        MM: c,
        y: c,
        yy: c
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("de-at", "de", {
      closeText: "Schlieen",
      prevText: "&#x3C;Zurck",
      nextText: "Vor&#x3E;",
      currentText: "Heute",
      monthNames: ["Januar", "Februar", "Mrz", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"],
      monthNamesShort: ["Jan", "Feb", "Mr", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"],
      dayNames: ["Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"],
      dayNamesShort: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
      dayNamesMin: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
      weekHeader: "KW",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("de-at", {
      buttonText: {month: "Monat", week: "Woche", day: "Tag", list: "Terminbersicht"},
      allDayText: "Ganztgig",
      eventLimitText: function (a) {
        return "+ weitere " + a
      }
    })
  }(), function () {
    function c(a, b, c, d) {
      var e = {
        m: ["eine Minute", "einer Minute"],
        h: ["eine Stunde", "einer Stunde"],
        d: ["ein Tag", "einem Tag"],
        dd: [a + " Tage", a + " Tagen"],
        M: ["ein Monat", "einem Monat"],
        MM: [a + " Monate", a + " Monaten"],
        y: ["ein Jahr", "einem Jahr"],
        yy: [a + " Jahre", a + " Jahren"]
      };
      return b ? e[c][0] : e[c][1]
    }

    (b.defineLocale || b.lang).call(b, "de", {
      months: "Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),
      monthsShort: "Jan_Febr_Mrz_Apr_Mai_Jun_Jul_Aug_Sept_Okt_Nov_Dez".split("_"),
      weekdays: "Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),
      weekdaysShort: "So_Mo_Di_Mi_Do_Fr_Sa".split("_"),
      weekdaysMin: "So_Mo_Di_Mi_Do_Fr_Sa".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "HH:mm:ss",
        L: "DD.MM.YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd, D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Heute um] LT [Uhr]",
        sameElse: "L",
        nextDay: "[Morgen um] LT [Uhr]",
        nextWeek: "dddd [um] LT [Uhr]",
        lastDay: "[Gestern um] LT [Uhr]",
        lastWeek: "[letzten] dddd [um] LT [Uhr]"
      },
      relativeTime: {
        future: "in %s",
        past: "vor %s",
        s: "ein paar Sekunden",
        m: c,
        mm: "%d Minuten",
        h: c,
        hh: "%d Stunden",
        d: c,
        dd: c,
        M: c,
        MM: c,
        y: c,
        yy: c
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("de", "de", {
      closeText: "Schlieen",
      prevText: "&#x3C;Zurck",
      nextText: "Vor&#x3E;",
      currentText: "Heute",
      monthNames: ["Januar", "Februar", "Mrz", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"],
      monthNamesShort: ["Jan", "Feb", "Mr", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"],
      dayNames: ["Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"],
      dayNamesShort: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
      dayNamesMin: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
      weekHeader: "KW",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("de", {
      buttonText: {month: "Monat", week: "Woche", day: "Tag", list: "Terminbersicht"},
      allDayText: "Ganztgig",
      eventLimitText: function (a) {
        return "+ weitere " + a
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "el", {
      monthsNominativeEl: "___________".split("_"),
      monthsGenitiveEl: "___________".split("_"),
      months: function (a, b) {
        return /D/.test(b.substring(0, b.indexOf("MMMM"))) ? this._monthsGenitiveEl[a.month()] : this._monthsNominativeEl[a.month()]
      },
      monthsShort: "___________".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      meridiem: function (a, b, c) {
        return a > 11 ? c ? "" : "" : c ? "" : ""
      },
      isPM: function (a) {
        return "" === (a + "").toLowerCase()[0]
      },
      meridiemParse: /[]\.??\.?/i,
      longDateFormat: {
        LT: "h:mm A",
        LTS: "h:mm:ss A",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd, D MMMM YYYY LT"
      },
      calendarEl: {
        sameDay: "[ {}] LT",
        nextDay: "[ {}] LT",
        nextWeek: "dddd [{}] LT",
        lastDay: "[ {}] LT",
        lastWeek: function () {
          switch (this.day()) {
            case 6:
              return "[ ] dddd [{}] LT";
            default:
              return "[ ] dddd [{}] LT"
          }
        },
        sameElse: "L"
      },
      calendar: function (a, b) {
        var c = this._calendarEl[a], d = b && b.hours();
        return "function" == typeof c && (c = c.apply(b)), c.replace("{}", d % 12 === 1 ? "" : "")
      },
      relativeTime: {
        future: " %s",
        past: "%s ",
        s: " ",
        m: " ",
        mm: "%d ",
        h: " ",
        hh: "%d ",
        d: " ",
        dd: "%d ",
        M: " ",
        MM: "%d ",
        y: " ",
        yy: "%d "
      },
      ordinalParse: /\d{1,2}/,
      ordinal: "%d",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("el", "el", {
      closeText: "",
      prevText: "",
      nextText: "",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd/mm/yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("el", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: "",
      eventLimitText: ""
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "en-au", {
      months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"),
      monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),
      weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),
      weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),
      weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"),
      longDateFormat: {
        LT: "h:mm A",
        LTS: "h:mm:ss A",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd, D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Today at] LT",
        nextDay: "[Tomorrow at] LT",
        nextWeek: "dddd [at] LT",
        lastDay: "[Yesterday at] LT",
        lastWeek: "[Last] dddd [at] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "in %s",
        past: "%s ago",
        s: "a few seconds",
        m: "a minute",
        mm: "%d minutes",
        h: "an hour",
        hh: "%d hours",
        d: "a day",
        dd: "%d days",
        M: "a month",
        MM: "%d months",
        y: "a year",
        yy: "%d years"
      },
      ordinalParse: /\d{1,2}(st|nd|rd|th)/,
      ordinal: function (a) {
        var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th";
        return a + c
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("en-au", "en-AU", {
      closeText: "Done",
      prevText: "Prev",
      nextText: "Next",
      currentText: "Today",
      monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
      dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
      dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
      dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
      weekHeader: "Wk",
      dateFormat: "dd/mm/yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("en-au")
  }(), function () {
    (b.defineLocale || b.lang).call(b, "en-ca", {
      months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"),
      monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),
      weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),
      weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),
      weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"),
      longDateFormat: {
        LT: "h:mm A",
        LTS: "h:mm:ss A",
        L: "YYYY-MM-DD",
        LL: "D MMMM, YYYY",
        LLL: "D MMMM, YYYY LT",
        LLLL: "dddd, D MMMM, YYYY LT"
      },
      calendar: {
        sameDay: "[Today at] LT",
        nextDay: "[Tomorrow at] LT",
        nextWeek: "dddd [at] LT",
        lastDay: "[Yesterday at] LT",
        lastWeek: "[Last] dddd [at] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "in %s",
        past: "%s ago",
        s: "a few seconds",
        m: "a minute",
        mm: "%d minutes",
        h: "an hour",
        hh: "%d hours",
        d: "a day",
        dd: "%d days",
        M: "a month",
        MM: "%d months",
        y: "a year",
        yy: "%d years"
      },
      ordinalParse: /\d{1,2}(st|nd|rd|th)/,
      ordinal: function (a) {
        var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th";
        return a + c
      }
    }), a.confiFormsCalendar.lang("en-ca")
  }(), function () {
    (b.defineLocale || b.lang).call(b, "en-gb", {
      months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"),
      monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),
      weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),
      weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),
      weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "HH:mm:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd, D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Today at] LT",
        nextDay: "[Tomorrow at] LT",
        nextWeek: "dddd [at] LT",
        lastDay: "[Yesterday at] LT",
        lastWeek: "[Last] dddd [at] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "in %s",
        past: "%s ago",
        s: "a few seconds",
        m: "a minute",
        mm: "%d minutes",
        h: "an hour",
        hh: "%d hours",
        d: "a day",
        dd: "%d days",
        M: "a month",
        MM: "%d months",
        y: "a year",
        yy: "%d years"
      },
      ordinalParse: /\d{1,2}(st|nd|rd|th)/,
      ordinal: function (a) {
        var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "th" : 1 === b ? "st" : 2 === b ? "nd" : 3 === b ? "rd" : "th";
        return a + c
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("en-gb", "en-GB", {
      closeText: "Done",
      prevText: "Prev",
      nextText: "Next",
      currentText: "Today",
      monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
      dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
      dayNamesShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
      dayNamesMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
      weekHeader: "Wk",
      dateFormat: "dd/mm/yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("en-gb")
  }(), function () {
    var c = "ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"), d = "ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");
    (b.defineLocale || b.lang).call(b, "es", {
      months: "enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),
      monthsShort: function (a, b) {
        return /-MMM-/.test(b) ? d[a.month()] : c[a.month()]
      },
      weekdays: "domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),
      weekdaysShort: "dom._lun._mar._mi._jue._vie._sb.".split("_"),
      weekdaysMin: "Do_Lu_Ma_Mi_Ju_Vi_S".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D [de] MMMM [de] YYYY",
        LLL: "D [de] MMMM [de] YYYY LT",
        LLLL: "dddd, D [de] MMMM [de] YYYY LT"
      },
      calendar: {
        sameDay: function () {
          return "[hoy a la" + (1 !== this.hours() ? "s" : "") + "] LT"
        }, nextDay: function () {
          return "[maana a la" + (1 !== this.hours() ? "s" : "") + "] LT"
        }, nextWeek: function () {
          return "dddd [a la" + (1 !== this.hours() ? "s" : "") + "] LT"
        }, lastDay: function () {
          return "[ayer a la" + (1 !== this.hours() ? "s" : "") + "] LT"
        }, lastWeek: function () {
          return "[el] dddd [pasado a la" + (1 !== this.hours() ? "s" : "") + "] LT"
        }, sameElse: "L"
      },
      relativeTime: {
        future: "en %s",
        past: "hace %s",
        s: "unos segundos",
        m: "un minuto",
        mm: "%d minutos",
        h: "una hora",
        hh: "%d horas",
        d: "un da",
        dd: "%d das",
        M: "un mes",
        MM: "%d meses",
        y: "un ao",
        yy: "%d aos"
      },
      ordinalParse: /\d{1,2}/,
      ordinal: "%d",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("es", "es", {
      closeText: "Cerrar",
      prevText: "&#x3C;Ant",
      nextText: "Sig&#x3E;",
      currentText: "Hoy",
      monthNames: ["enero", "febrero", "marzo", "abril", "mayo", "junio", "julio", "agosto", "septiembre", "octubre", "noviembre", "diciembre"],
      monthNamesShort: ["ene", "feb", "mar", "abr", "may", "jun", "jul", "ago", "sep", "oct", "nov", "dic"],
      dayNames: ["domingo", "lunes", "martes", "mircoles", "jueves", "viernes", "sbado"],
      dayNamesShort: ["dom", "lun", "mar", "mi", "jue", "vie", "sb"],
      dayNamesMin: ["D", "L", "M", "X", "J", "V", "S"],
      weekHeader: "Sm",
      dateFormat: "dd/mm/yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("es", {
      buttonText: {month: "Mes", week: "Semana", day: "Da", list: "Agenda"},
      allDayHtml: "Todo<br/>el da",
      eventLimitText: "ms"
    })
  }(), function () {
    var c = {1: "", 2: "", 3: "", 4: "", 5: "", 6: "", 7: "", 8: "", 9: "", 0: ""}, d = {
      "": "1",
      "": "2",
      "": "3",
      "": "4",
      "": "5",
      "": "6",
      "": "7",
      "": "8",
      "": "9",
      "": "0"
    };
    (b.defineLocale || b.lang).call(b, "fa", {
      months: "___________".split("_"),
      monthsShort: "___________".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd, D MMMM YYYY LT"
      },
      meridiemParse: /  |  /,
      isPM: function (a) {
        return /  /.test(a)
      },
      meridiem: function (a, b, c) {
        return 12 > a ? "  " : "  "
      },
      calendar: {
        sameDay: "[ ] LT",
        nextDay: "[ ] LT",
        nextWeek: "dddd [] LT",
        lastDay: "[ ] LT",
        lastWeek: "dddd [] [] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: "%s ",
        s: " ",
        m: " ",
        mm: "%d ",
        h: " ",
        hh: "%d ",
        d: " ",
        dd: "%d ",
        M: " ",
        MM: "%d ",
        y: " ",
        yy: "%d "
      },
      preparse: function (a) {
        return a.replace(/[-]/g, function (a) {
          return d[a]
        }).replace(//g, ",")
      },
      postformat: function (a) {
        return a.replace(/\d/g, function (a) {
          return c[a]
        }).replace(/,/g, "")
      },
      ordinalParse: /\d{1,2}/,
      ordinal: "%d",
      week: {dow: 6, doy: 12}
    }), a.confiFormsCalendar.datepickerLang("fa", "fa", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "yy/mm/dd",
      firstDay: 6,
      isRTL: !0,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("fa", {
      buttonText: {
        month: "", week: "", day: "", list: ""
      }, allDayText: " ", eventLimitText: function (a) {
        return "  " + a
      }
    })
  }(), function () {
    function c(a, b, c, e) {
      var f = "";
      switch (c) {
        case"s":
          return e ? "muutaman sekunnin" : "muutama sekunti";
        case"m":
          return e ? "minuutin" : "minuutti";
        case"mm":
          f = e ? "minuutin" : "minuuttia";
          break;
        case"h":
          return e ? "tunnin" : "tunti";
        case"hh":
          f = e ? "tunnin" : "tuntia";
          break;
        case"d":
          return e ? "pivn" : "piv";
        case"dd":
          f = e ? "pivn" : "piv";
          break;
        case"M":
          return e ? "kuukauden" : "kuukausi";
        case"MM":
          f = e ? "kuukauden" : "kuukautta";
          break;
        case"y":
          return e ? "vuoden" : "vuosi";
        case"yy":
          f = e ? "vuoden" : "vuotta"
      }
      return f = d(a, e) + " " + f
    }

    function d(a, b) {
      return 10 > a ? b ? f[a] : e[a] : a
    }

    var e = "nolla yksi kaksi kolme nelj viisi kuusi seitsemn kahdeksan yhdeksn".split(" "), f = ["nolla", "yhden", "kahden", "kolmen", "neljn", "viiden", "kuuden", e[7], e[8], e[9]];
    (b.defineLocale || b.lang).call(b, "fi", {
      months: "tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_keskuu_heinkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),
      monthsShort: "tammi_helmi_maalis_huhti_touko_kes_hein_elo_syys_loka_marras_joulu".split("_"),
      weekdays: "sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),
      weekdaysShort: "su_ma_ti_ke_to_pe_la".split("_"),
      weekdaysMin: "su_ma_ti_ke_to_pe_la".split("_"),
      longDateFormat: {
        LT: "HH.mm",
        LTS: "HH.mm.ss",
        L: "DD.MM.YYYY",
        LL: "Do MMMM[ta] YYYY",
        LLL: "Do MMMM[ta] YYYY, [klo] LT",
        LLLL: "dddd, Do MMMM[ta] YYYY, [klo] LT",
        l: "D.M.YYYY",
        ll: "Do MMM YYYY",
        lll: "Do MMM YYYY, [klo] LT",
        llll: "ddd, Do MMM YYYY, [klo] LT"
      },
      calendar: {
        sameDay: "[tnn] [klo] LT",
        nextDay: "[huomenna] [klo] LT",
        nextWeek: "dddd [klo] LT",
        lastDay: "[eilen] [klo] LT",
        lastWeek: "[viime] dddd[na] [klo] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "%s pst",
        past: "%s sitten",
        s: c,
        m: c,
        mm: c,
        h: c,
        hh: c,
        d: c,
        dd: c,
        M: c,
        MM: c,
        y: c,
        yy: c
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("fi", "fi", {
      closeText: "Sulje",
      prevText: "&#xAB;Edellinen",
      nextText: "Seuraava&#xBB;",
      currentText: "Tnn",
      monthNames: ["Tammikuu", "Helmikuu", "Maaliskuu", "Huhtikuu", "Toukokuu", "Keskuu", "Heinkuu", "Elokuu", "Syyskuu", "Lokakuu", "Marraskuu", "Joulukuu"],
      monthNamesShort: ["Tammi", "Helmi", "Maalis", "Huhti", "Touko", "Kes", "Hein", "Elo", "Syys", "Loka", "Marras", "Joulu"],
      dayNamesShort: ["Su", "Ma", "Ti", "Ke", "To", "Pe", "La"],
      dayNames: ["Sunnuntai", "Maanantai", "Tiistai", "Keskiviikko", "Torstai", "Perjantai", "Lauantai"],
      dayNamesMin: ["Su", "Ma", "Ti", "Ke", "To", "Pe", "La"],
      weekHeader: "Vk",
      dateFormat: "d.m.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("fi", {
      buttonText: {month: "Kuukausi", week: "Viikko", day: "Piv", list: "Tapahtumat"},
      allDayText: "Koko piv",
      eventLimitText: "lis"
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "fr-ca", {
      months: "janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),
      monthsShort: "janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),
      weekdays: "dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),
      weekdaysShort: "dim._lun._mar._mer._jeu._ven._sam.".split("_"),
      weekdaysMin: "Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "YYYY-MM-DD",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Aujourd'hui ] LT",
        nextDay: "[Demain ] LT",
        nextWeek: "dddd [] LT",
        lastDay: "[Hier ] LT",
        lastWeek: "dddd [dernier ] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "dans %s",
        past: "il y a %s",
        s: "quelques secondes",
        m: "une minute",
        mm: "%d minutes",
        h: "une heure",
        hh: "%d heures",
        d: "un jour",
        dd: "%d jours",
        M: "un mois",
        MM: "%d mois",
        y: "un an",
        yy: "%d ans"
      },
      ordinalParse: /\d{1,2}(er|)/,
      ordinal: function (a) {
        return a + (1 === a ? "er" : "")
      }
    }), a.confiFormsCalendar.datepickerLang("fr-ca", "fr-CA", {
      closeText: "Fermer",
      prevText: "Prcdent",
      nextText: "Suivant",
      currentText: "Aujourd'hui",
      monthNames: ["janvier", "fvrier", "mars", "avril", "mai", "juin", "juillet", "aot", "septembre", "octobre", "novembre", "dcembre"],
      monthNamesShort: ["janv.", "fvr.", "mars", "avril", "mai", "juin", "juil.", "aot", "sept.", "oct.", "nov.", "dc."],
      dayNames: ["dimanche", "lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi"],
      dayNamesShort: ["dim.", "lun.", "mar.", "mer.", "jeu.", "ven.", "sam."],
      dayNamesMin: ["D", "L", "M", "M", "J", "V", "S"],
      weekHeader: "Sem.",
      dateFormat: "yy-mm-dd",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("fr-ca", {
      buttonText: {month: "Mois", week: "Semaine", day: "Jour", list: "Mon planning"},
      allDayHtml: "Toute la<br/>journe",
      eventLimitText: "en plus"
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "fr", {
      months: "janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),
      monthsShort: "janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),
      weekdays: "dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),
      weekdaysShort: "dim._lun._mar._mer._jeu._ven._sam.".split("_"),
      weekdaysMin: "Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Aujourd'hui ] LT",
        nextDay: "[Demain ] LT",
        nextWeek: "dddd [] LT",
        lastDay: "[Hier ] LT",
        lastWeek: "dddd [dernier ] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "dans %s",
        past: "il y a %s",
        s: "quelques secondes",
        m: "une minute",
        mm: "%d minutes",
        h: "une heure",
        hh: "%d heures",
        d: "un jour",
        dd: "%d jours",
        M: "un mois",
        MM: "%d mois",
        y: "un an",
        yy: "%d ans"
      },
      ordinalParse: /\d{1,2}(er|)/,
      ordinal: function (a) {
        return a + (1 === a ? "er" : "")
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("fr", "fr", {
      closeText: "Fermer",
      prevText: "Prcdent",
      nextText: "Suivant",
      currentText: "Aujourd'hui",
      monthNames: ["janvier", "fvrier", "mars", "avril", "mai", "juin", "juillet", "aot", "septembre", "octobre", "novembre", "dcembre"],
      monthNamesShort: ["janv.", "fvr.", "mars", "avr.", "mai", "juin", "juil.", "aot", "sept.", "oct.", "nov.", "dc."],
      dayNames: ["dimanche", "lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi"],
      dayNamesShort: ["dim.", "lun.", "mar.", "mer.", "jeu.", "ven.", "sam."],
      dayNamesMin: ["D", "L", "M", "M", "J", "V", "S"],
      weekHeader: "Sem.",
      dateFormat: "dd/mm/yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("fr", {
      buttonText: {month: "Mois", week: "Semaine", day: "Jour", list: "Mon planning"},
      allDayHtml: "Toute la<br/>journe",
      eventLimitText: "en plus"
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "he", {
      months: "___________".split("_"),
      monthsShort: "___________".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D []MMMM YYYY",
        LLL: "D []MMMM YYYY LT",
        LLLL: "dddd, D []MMMM YYYY LT",
        l: "D/M/YYYY",
        ll: "D MMM YYYY",
        lll: "D MMM YYYY LT",
        llll: "ddd, D MMM YYYY LT"
      },
      calendar: {
        sameDay: "[ ]LT",
        nextDay: "[ ]LT",
        nextWeek: "dddd [] LT",
        lastDay: "[ ]LT",
        lastWeek: "[] dddd [ ] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: " %s",
        s: " ",
        m: "",
        mm: "%d ",
        h: "",
        hh: function (a) {
          return 2 === a ? "" : a + " "
        },
        d: "",
        dd: function (a) {
          return 2 === a ? "" : a + " "
        },
        M: "",
        MM: function (a) {
          return 2 === a ? "" : a + " "
        },
        y: "",
        yy: function (a) {
          return 2 === a ? "" : a % 10 === 0 && 10 !== a ? a + " " : a + " "
        }
      }
    }), a.confiFormsCalendar.datepickerLang("he", "he", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["'", "'", "'", "'", "'", "'", ""],
      dayNamesMin: ["'", "'", "'", "'", "'", "'", ""],
      weekHeader: "Wk",
      dateFormat: "dd/mm/yy",
      firstDay: 0,
      isRTL: !0,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("he", {
      defaultButtonText: {month: "", week: "", day: "", list: " "},
      weekNumberTitle: "",
      allDayText: " ",
      eventLimitText: ""
    })
  }(), function () {
    var c = {1: "", 2: "", 3: "", 4: "", 5: "", 6: "", 7: "", 8: "", 9: "", 0: ""}, d = {
      "": "1",
      "": "2",
      "": "3",
      "": "4",
      "": "5",
      "": "6",
      "": "7",
      "": "8",
      "": "9",
      "": "0"
    };
    (b.defineLocale || b.lang).call(b, "hi", {
      months: "___________".split("_"),
      monthsShort: "._.__.___._._._._._.".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "A h:mm ",
        LTS: "A h:mm:ss ",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY, LT",
        LLLL: "dddd, D MMMM YYYY, LT"
      },
      calendar: {
        sameDay: "[] LT",
        nextDay: "[] LT",
        nextWeek: "dddd, LT",
        lastDay: "[] LT",
        lastWeek: "[] dddd, LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "%s ",
        past: "%s ",
        s: "  ",
        m: " ",
        mm: "%d ",
        h: " ",
        hh: "%d ",
        d: " ",
        dd: "%d ",
        M: " ",
        MM: "%d ",
        y: " ",
        yy: "%d "
      },
      preparse: function (a) {
        return a.replace(/[]/g, function (a) {
          return d[a]
        })
      },
      postformat: function (a) {
        return a.replace(/\d/g, function (a) {
          return c[a]
        })
      },
      meridiemParse: /|||/,
      meridiemHour: function (a, b) {
        return 12 === a && (a = 0), "" === b ? 4 > a ? a : a + 12 : "" === b ? a : "" === b ? a >= 10 ? a : a + 12 : "" === b ? a + 12 : void 0
      },
      meridiem: function (a, b, c) {
        return 4 > a ? "" : 10 > a ? "" : 17 > a ? "" : 20 > a ? "" : ""
      },
      week: {dow: 0, doy: 6}
    }), a.confiFormsCalendar.datepickerLang("hi", "hi", {
      closeText: "",
      prevText: "",
      nextText: "",
      currentText: "",
      monthNames: [" ", "", "", "", "", "", "", " ", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd/mm/yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("hi", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: " ",
      eventLimitText: function (a) {
        return "+ " + a
      }
    })
  }(), function () {
    function c(a, b, c) {
      var d = a + " ";
      switch (c) {
        case"m":
          return b ? "jedna minuta" : "jedne minute";
        case"mm":
          return d += 1 === a ? "minuta" : 2 === a || 3 === a || 4 === a ? "minute" : "minuta";
        case"h":
          return b ? "jedan sat" : "jednog sata";
        case"hh":
          return d += 1 === a ? "sat" : 2 === a || 3 === a || 4 === a ? "sata" : "sati";
        case"dd":
          return d += 1 === a ? "dan" : "dana";
        case"MM":
          return d += 1 === a ? "mjesec" : 2 === a || 3 === a || 4 === a ? "mjeseca" : "mjeseci";
        case"yy":
          return d += 1 === a ? "godina" : 2 === a || 3 === a || 4 === a ? "godine" : "godina"
      }
    }

    (b.defineLocale || b.lang).call(b, "hr", {
      months: "sjeanj_veljaa_oujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_"),
      monthsShort: "sje._vel._ou._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),
      weekdays: "nedjelja_ponedjeljak_utorak_srijeda_etvrtak_petak_subota".split("_"),
      weekdaysShort: "ned._pon._uto._sri._et._pet._sub.".split("_"),
      weekdaysMin: "ne_po_ut_sr_e_pe_su".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD. MM. YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd, D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[danas u] LT", nextDay: "[sutra u] LT", nextWeek: function () {
          switch (this.day()) {
            case 0:
              return "[u] [nedjelju] [u] LT";
            case 3:
              return "[u] [srijedu] [u] LT";
            case 6:
              return "[u] [subotu] [u] LT";
            case 1:
            case 2:
            case 4:
            case 5:
              return "[u] dddd [u] LT"
          }
        }, lastDay: "[juer u] LT", lastWeek: function () {
          switch (this.day()) {
            case 0:
            case 3:
              return "[prolu] dddd [u] LT";
            case 6:
              return "[prole] [subote] [u] LT";
            case 1:
            case 2:
            case 4:
            case 5:
              return "[proli] dddd [u] LT"
          }
        }, sameElse: "L"
      },
      relativeTime: {
        future: "za %s",
        past: "prije %s",
        s: "par sekundi",
        m: c,
        mm: c,
        h: c,
        hh: c,
        d: "dan",
        dd: c,
        M: "mjesec",
        MM: c,
        y: "godinu",
        yy: c
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("hr", "hr", {
      closeText: "Zatvori",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "Danas",
      monthNames: ["Sijeanj", "Veljaa", "Oujak", "Travanj", "Svibanj", "Lipanj", "Srpanj", "Kolovoz", "Rujan", "Listopad", "Studeni", "Prosinac"],
      monthNamesShort: ["Sij", "Velj", "Ou", "Tra", "Svi", "Lip", "Srp", "Kol", "Ruj", "Lis", "Stu", "Pro"],
      dayNames: ["Nedjelja", "Ponedjeljak", "Utorak", "Srijeda", "etvrtak", "Petak", "Subota"],
      dayNamesShort: ["Ned", "Pon", "Uto", "Sri", "et", "Pet", "Sub"],
      dayNamesMin: ["Ne", "Po", "Ut", "Sr", "e", "Pe", "Su"],
      weekHeader: "Tje",
      dateFormat: "dd.mm.yy.",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("hr", {
      buttonText: {month: "Mjesec", week: "Tjedan", day: "Dan", list: "Raspored"},
      allDayText: "Cijeli dan",
      eventLimitText: function (a) {
        return "+ jo " + a
      }
    })
  }(), function () {
    function c(a, b, c, d) {
      var e = a;
      switch (c) {
        case"s":
          return d || b ? "nhny msodperc" : "nhny msodperce";
        case"m":
          return "egy" + (d || b ? " perc" : " perce");
        case"mm":
          return e + (d || b ? " perc" : " perce");
        case"h":
          return "egy" + (d || b ? " ra" : " rja");
        case"hh":
          return e + (d || b ? " ra" : " rja");
        case"d":
          return "egy" + (d || b ? " nap" : " napja");
        case"dd":
          return e + (d || b ? " nap" : " napja");
        case"M":
          return "egy" + (d || b ? " hnap" : " hnapja");
        case"MM":
          return e + (d || b ? " hnap" : " hnapja");
        case"y":
          return "egy" + (d || b ? " v" : " ve");
        case"yy":
          return e + (d || b ? " v" : " ve")
      }
      return ""
    }

    function d(a) {
      return (a ? "" : "[mlt] ") + "[" + e[this.day()] + "] LT[-kor]"
    }

    var e = "vasrnap htfn kedden szerdn cstrtkn pnteken szombaton".split(" ");
    (b.defineLocale || b.lang).call(b, "hu", {
      months: "janur_februr_mrcius_prilis_mjus_jnius_jlius_augusztus_szeptember_oktber_november_december".split("_"),
      monthsShort: "jan_feb_mrc_pr_mj_jn_jl_aug_szept_okt_nov_dec".split("_"),
      weekdays: "vasrnap_htf_kedd_szerda_cstrtk_pntek_szombat".split("_"),
      weekdaysShort: "vas_ht_kedd_sze_cst_pn_szo".split("_"),
      weekdaysMin: "v_h_k_sze_cs_p_szo".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "YYYY.MM.DD.",
        LL: "YYYY. MMMM D.",
        LLL: "YYYY. MMMM D., LT",
        LLLL: "YYYY. MMMM D., dddd LT"
      },
      meridiemParse: /de|du/i,
      isPM: function (a) {
        return "u" === a.charAt(1).toLowerCase()
      },
      meridiem: function (a, b, c) {
        return 12 > a ? c === !0 ? "de" : "DE" : c === !0 ? "du" : "DU"
      },
      calendar: {
        sameDay: "[ma] LT[-kor]", nextDay: "[holnap] LT[-kor]", nextWeek: function () {
          return d.call(this, !0)
        }, lastDay: "[tegnap] LT[-kor]", lastWeek: function () {
          return d.call(this, !1)
        }, sameElse: "L"
      },
      relativeTime: {
        future: "%s mlva",
        past: "%s",
        s: c,
        m: c,
        mm: c,
        h: c,
        hh: c,
        d: c,
        dd: c,
        M: c,
        MM: c,
        y: c,
        yy: c
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("hu", "hu", {
      closeText: "bezr",
      prevText: "vissza",
      nextText: "elre",
      currentText: "ma",
      monthNames: ["Janur", "Februr", "Mrcius", "prilis", "Mjus", "Jnius", "Jlius", "Augusztus", "Szeptember", "Oktber", "November", "December"],
      monthNamesShort: ["Jan", "Feb", "Mr", "pr", "Mj", "Jn", "Jl", "Aug", "Szep", "Okt", "Nov", "Dec"],
      dayNames: ["Vasrnap", "Htf", "Kedd", "Szerda", "Cstrtk", "Pntek", "Szombat"],
      dayNamesShort: ["Vas", "Ht", "Ked", "Sze", "Cs", "Pn", "Szo"],
      dayNamesMin: ["V", "H", "K", "Sze", "Cs", "P", "Szo"],
      weekHeader: "Ht",
      dateFormat: "yy.mm.dd.",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !0,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("hu", {
      buttonText: {month: "Hnap", week: "Ht", day: "Nap", list: "Napl"},
      allDayText: "Egsz nap",
      eventLimitText: "tovbbi"
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "id", {
      months: "Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),
      monthsShort: "Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),
      weekdays: "Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),
      weekdaysShort: "Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),
      weekdaysMin: "Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),
      longDateFormat: {
        LT: "HH.mm",
        LTS: "LT.ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY [pukul] LT",
        LLLL: "dddd, D MMMM YYYY [pukul] LT"
      },
      meridiemParse: /pagi|siang|sore|malam/,
      meridiemHour: function (a, b) {
        return 12 === a && (a = 0), "pagi" === b ? a : "siang" === b ? a >= 11 ? a : a + 12 : "sore" === b || "malam" === b ? a + 12 : void 0
      },
      meridiem: function (a, b, c) {
        return 11 > a ? "pagi" : 15 > a ? "siang" : 19 > a ? "sore" : "malam"
      },
      calendar: {
        sameDay: "[Hari ini pukul] LT",
        nextDay: "[Besok pukul] LT",
        nextWeek: "dddd [pukul] LT",
        lastDay: "[Kemarin pukul] LT",
        lastWeek: "dddd [lalu pukul] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "dalam %s",
        past: "%s yang lalu",
        s: "beberapa detik",
        m: "semenit",
        mm: "%d menit",
        h: "sejam",
        hh: "%d jam",
        d: "sehari",
        dd: "%d hari",
        M: "sebulan",
        MM: "%d bulan",
        y: "setahun",
        yy: "%d tahun"
      },
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("id", "id", {
      closeText: "Tutup",
      prevText: "&#x3C;mundur",
      nextText: "maju&#x3E;",
      currentText: "hari ini",
      monthNames: ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "Nopember", "Desember"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun", "Jul", "Agus", "Sep", "Okt", "Nop", "Des"],
      dayNames: ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"],
      dayNamesShort: ["Min", "Sen", "Sel", "Rab", "kam", "Jum", "Sab"],
      dayNamesMin: ["Mg", "Sn", "Sl", "Rb", "Km", "jm", "Sb"],
      weekHeader: "Mg",
      dateFormat: "dd/mm/yy",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("id", {
      buttonText: {month: "Bulan", week: "Minggu", day: "Hari", list: "Agenda"},
      allDayHtml: "Sehari<br/>penuh",
      eventLimitText: "lebih"
    })
  }(), function () {
    function c(a) {
      return a % 100 === 11 ? !0 : a % 10 === 1 ? !1 : !0
    }

    function d(a, b, d, e) {
      var f = a + " ";
      switch (d) {
        case"s":
          return b || e ? "nokkrar sekndur" : "nokkrum sekndum";
        case"m":
          return b ? "mnta" : "mntu";
        case"mm":
          return c(a) ? f + (b || e ? "mntur" : "mntum") : b ? f + "mnta" : f + "mntu";
        case"hh":
          return c(a) ? f + (b || e ? "klukkustundir" : "klukkustundum") : f + "klukkustund";
        case"d":
          return b ? "dagur" : e ? "dag" : "degi";
        case"dd":
          return c(a) ? b ? f + "dagar" : f + (e ? "daga" : "dgum") : b ? f + "dagur" : f + (e ? "dag" : "degi");
        case"M":
          return b ? "mnuur" : e ? "mnu" : "mnui";
        case"MM":
          return c(a) ? b ? f + "mnuir" : f + (e ? "mnui" : "mnuum") : b ? f + "mnuur" : f + (e ? "mnu" : "mnui");
        case"y":
          return b || e ? "r" : "ri";
        case"yy":
          return c(a) ? f + (b || e ? "r" : "rum") : f + (b || e ? "r" : "ri")
      }
    }

    (b.defineLocale || b.lang).call(b, "is", {
      months: "janar_febrar_mars_aprl_ma_jn_jl_gst_september_oktber_nvember_desember".split("_"),
      monthsShort: "jan_feb_mar_apr_ma_jn_jl_g_sep_okt_nv_des".split("_"),
      weekdays: "sunnudagur_mnudagur_rijudagur_mivikudagur_fimmtudagur_fstudagur_laugardagur".split("_"),
      weekdaysShort: "sun_mn_ri_mi_fim_fs_lau".split("_"),
      weekdaysMin: "Su_M_r_Mi_Fi_F_La".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY [kl.] LT",
        LLLL: "dddd, D. MMMM YYYY [kl.] LT"
      },
      calendar: {
        sameDay: "[ dag kl.] LT",
        nextDay: "[ morgun kl.] LT",
        nextWeek: "dddd [kl.] LT",
        lastDay: "[ gr kl.] LT",
        lastWeek: "[sasta] dddd [kl.] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "eftir %s",
        past: "fyrir %s san",
        s: d,
        m: d,
        mm: d,
        h: "klukkustund",
        hh: d,
        d: d,
        dd: d,
        M: d,
        MM: d,
        y: d,
        yy: d
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("is", "is", {
      closeText: "Loka",
      prevText: "&#x3C; Fyrri",
      nextText: "Nsti &#x3E;",
      currentText: " dag",
      monthNames: ["Janar", "Febrar", "Mars", "Aprl", "Ma", "Jn", "Jl", "gst", "September", "Oktber", "Nvember", "Desember"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "Ma", "Jn", "Jl", "g", "Sep", "Okt", "Nv", "Des"],
      dayNames: ["Sunnudagur", "Mnudagur", "rijudagur", "Mivikudagur", "Fimmtudagur", "Fstudagur", "Laugardagur"],
      dayNamesShort: ["Sun", "Mn", "ri", "Mi", "Fim", "Fs", "Lau"],
      dayNamesMin: ["Su", "M", "r", "Mi", "Fi", "F", "La"],
      weekHeader: "Vika",
      dateFormat: "dd.mm.yy",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("is", {
      buttonText: {month: "Mnuur", week: "Vika", day: "Dagur", list: "Dagskr"},
      allDayHtml: "Allan<br/>daginn",
      eventLimitText: "meira"
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "it", {
      months: "gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),
      monthsShort: "gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),
      weekdays: "Domenica_Luned_Marted_Mercoled_Gioved_Venerd_Sabato".split("_"),
      weekdaysShort: "Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),
      weekdaysMin: "D_L_Ma_Me_G_V_S".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd, D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Oggi alle] LT",
        nextDay: "[Domani alle] LT",
        nextWeek: "dddd [alle] LT",
        lastDay: "[Ieri alle] LT",
        lastWeek: function () {
          switch (this.day()) {
            case 0:
              return "[la scorsa] dddd [alle] LT";
            default:
              return "[lo scorso] dddd [alle] LT"
          }
        },
        sameElse: "L"
      },
      relativeTime: {
        future: function (a) {
          return (/^[0-9].+$/.test(a) ? "tra" : "in") + " " + a
        },
        past: "%s fa",
        s: "alcuni secondi",
        m: "un minuto",
        mm: "%d minuti",
        h: "un'ora",
        hh: "%d ore",
        d: "un giorno",
        dd: "%d giorni",
        M: "un mese",
        MM: "%d mesi",
        y: "un anno",
        yy: "%d anni"
      },
      ordinalParse: /\d{1,2}/,
      ordinal: "%d",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("it", "it", {
      closeText: "Chiudi",
      prevText: "&#x3C;Prec",
      nextText: "Succ&#x3E;",
      currentText: "Oggi",
      monthNames: ["Gennaio", "Febbraio", "Marzo", "Aprile", "Maggio", "Giugno", "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre"],
      monthNamesShort: ["Gen", "Feb", "Mar", "Apr", "Mag", "Giu", "Lug", "Ago", "Set", "Ott", "Nov", "Dic"],
      dayNames: ["Domenica", "Luned", "Marted", "Mercoled", "Gioved", "Venerd", "Sabato"],
      dayNamesShort: ["Dom", "Lun", "Mar", "Mer", "Gio", "Ven", "Sab"],
      dayNamesMin: ["Do", "Lu", "Ma", "Me", "Gi", "Ve", "Sa"],
      weekHeader: "Sm",
      dateFormat: "dd/mm/yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("it", {
      buttonText: {month: "Mese", week: "Settimana", day: "Giorno", list: "Agenda"},
      allDayHtml: "Tutto il<br/>giorno",
      eventLimitText: function (a) {
        return "+altri " + a
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "ja", {
      months: "1_2_3_4_5_6_7_8_9_10_11_12".split("_"),
      monthsShort: "1_2_3_4_5_6_7_8_9_10_11_12".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "Ahm",
        LTS: "LTs",
        L: "YYYY/MM/DD",
        LL: "YYYYMD",
        LLL: "YYYYMDLT",
        LLLL: "YYYYMDLT dddd"
      },
      meridiemParse: /|/i,
      isPM: function (a) {
        return "" === a
      },
      meridiem: function (a, b, c) {
        return 12 > a ? "" : ""
      },
      calendar: {
        sameDay: "[] LT",
        nextDay: "[] LT",
        nextWeek: "[]dddd LT",
        lastDay: "[] LT",
        lastWeek: "[]dddd LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "%s",
        past: "%s",
        s: "",
        m: "1",
        mm: "%d",
        h: "1",
        hh: "%d",
        d: "1",
        dd: "%d",
        M: "1",
        MM: "%d",
        y: "1",
        yy: "%d"
      }
    }), a.confiFormsCalendar.datepickerLang("ja", "ja", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "yy/mm/dd",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !0,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ja", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: "",
      eventLimitText: function (a) {
        return " " + a + " "
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "ko", {
      months: "1_2_3_4_5_6_7_8_9_10_11_12".split("_"),
      monthsShort: "1_2_3_4_5_6_7_8_9_10_11_12".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "A h m",
        LTS: "A h m s",
        L: "YYYY.MM.DD",
        LL: "YYYY MMMM D",
        LLL: "YYYY MMMM D LT",
        LLLL: "YYYY MMMM D dddd LT"
      },
      calendar: {
        sameDay: " LT",
        nextDay: " LT",
        nextWeek: "dddd LT",
        lastDay: " LT",
        lastWeek: " dddd LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "%s ",
        past: "%s ",
        s: "",
        ss: "%d",
        m: "",
        mm: "%d",
        h: "",
        hh: "%d",
        d: "",
        dd: "%d",
        M: "",
        MM: "%d",
        y: "",
        yy: "%d"
      },
      ordinalParse: /\d{1,2}/,
      ordinal: "%d",
      meridiemParse: /|/,
      isPM: function (a) {
        return "" === a
      },
      meridiem: function (a, b, c) {
        return 12 > a ? "" : ""
      }
    }), a.confiFormsCalendar.datepickerLang("ko", "ko", {
      closeText: "",
      prevText: "",
      nextText: "",
      currentText: "",
      monthNames: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      monthNamesShort: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "Wk",
      dateFormat: "yy-mm-dd",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !0,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ko", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: "",
      eventLimitText: ""
    })
  }(), function () {
    function c(a, b, c, d) {
      return b ? "kelios sekunds" : d ? "keli sekundi" : "kelias sekundes"
    }

    function d(a, b, c, d) {
      return b ? f(c)[0] : d ? f(c)[1] : f(c)[2]
    }

    function e(a) {
      return a % 10 === 0 || a > 10 && 20 > a
    }

    function f(a) {
      return i[a].split("_")
    }

    function g(a, b, c, g) {
      var h = a + " ";
      return 1 === a ? h + d(a, b, c[0], g) : b ? h + (e(a) ? f(c)[1] : f(c)[0]) : g ? h + f(c)[1] : h + (e(a) ? f(c)[1] : f(c)[2])
    }

    function h(a, b) {
      var c = -1 === b.indexOf("dddd HH:mm"), d = j[a.day()];
      return c ? d : d.substring(0, d.length - 2) + ""
    }

    var i = {
      m: "minut_minuts_minut",
      mm: "minuts_minui_minutes",
      h: "valanda_valandos_valand",
      hh: "valandos_valand_valandas",
      d: "diena_dienos_dien",
      dd: "dienos_dien_dienas",
      M: "mnuo_mnesio_mnes",
      MM: "mnesiai_mnesi_mnesius",
      y: "metai_met_metus",
      yy: "metai_met_metus"
    }, j = "sekmadienis_pirmadienis_antradienis_treiadienis_ketvirtadienis_penktadienis_etadienis".split("_");
    (b.defineLocale || b.lang).call(b, "lt", {
      months: "sausio_vasario_kovo_balandio_gegus_birelio_liepos_rugpjio_rugsjo_spalio_lapkriio_gruodio".split("_"),
      monthsShort: "sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),
      weekdays: h,
      weekdaysShort: "Sek_Pir_Ant_Tre_Ket_Pen_e".split("_"),
      weekdaysMin: "S_P_A_T_K_Pn_".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "YYYY-MM-DD",
        LL: "YYYY [m.] MMMM D [d.]",
        LLL: "YYYY [m.] MMMM D [d.], LT [val.]",
        LLLL: "YYYY [m.] MMMM D [d.], dddd, LT [val.]",
        l: "YYYY-MM-DD",
        ll: "YYYY [m.] MMMM D [d.]",
        lll: "YYYY [m.] MMMM D [d.], LT [val.]",
        llll: "YYYY [m.] MMMM D [d.], ddd, LT [val.]"
      },
      calendar: {
        sameDay: "[iandien] LT",
        nextDay: "[Rytoj] LT",
        nextWeek: "dddd LT",
        lastDay: "[Vakar] LT",
        lastWeek: "[Prajus] dddd LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "po %s",
        past: "prie %s",
        s: c,
        m: d,
        mm: g,
        h: d,
        hh: g,
        d: d,
        dd: g,
        M: d,
        MM: g,
        y: d,
        yy: g
      },
      ordinalParse: /\d{1,2}-oji/,
      ordinal: function (a) {
        return a + "-oji"
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("lt", "lt", {
      closeText: "Udaryti",
      prevText: "&#x3C;Atgal",
      nextText: "Pirmyn&#x3E;",
      currentText: "iandien",
      monthNames: ["Sausis", "Vasaris", "Kovas", "Balandis", "Gegu", "Birelis", "Liepa", "Rugpjtis", "Rugsjis", "Spalis", "Lapkritis", "Gruodis"],
      monthNamesShort: ["Sau", "Vas", "Kov", "Bal", "Geg", "Bir", "Lie", "Rugp", "Rugs", "Spa", "Lap", "Gru"],
      dayNames: ["sekmadienis", "pirmadienis", "antradienis", "treiadienis", "ketvirtadienis", "penktadienis", "etadienis"],
      dayNamesShort: ["sek", "pir", "ant", "tre", "ket", "pen", "e"],
      dayNamesMin: ["Se", "Pr", "An", "Tr", "Ke", "Pe", "e"],
      weekHeader: "SAV",
      dateFormat: "yy-mm-dd",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !0,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("lt", {
      buttonText: {month: "Mnuo", week: "Savait", day: "Diena", list: "Darbotvark"},
      allDayText: "Vis dien",
      eventLimitText: "daugiau"
    })
  }(), function () {
    function c(a, b, c) {
      var d = a.split("_");
      return c ? b % 10 === 1 && 11 !== b ? d[2] : d[3] : b % 10 === 1 && 11 !== b ? d[0] : d[1]
    }

    function d(a, b, d) {
      return a + " " + c(e[d], a, b)
    }

    var e = {
      mm: "minti_mintes_minte_mintes",
      hh: "stundu_stundas_stunda_stundas",
      dd: "dienu_dienas_diena_dienas",
      MM: "mnesi_mneus_mnesis_mnei",
      yy: "gadu_gadus_gads_gadi"
    };
    (b.defineLocale || b.lang).call(b, "lv", {
      months: "janvris_februris_marts_aprlis_maijs_jnijs_jlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),
      monthsShort: "jan_feb_mar_apr_mai_jn_jl_aug_sep_okt_nov_dec".split("_"),
      weekdays: "svtdiena_pirmdiena_otrdiena_trediena_ceturtdiena_piektdiena_sestdiena".split("_"),
      weekdaysShort: "Sv_P_O_T_C_Pk_S".split("_"),
      weekdaysMin: "Sv_P_O_T_C_Pk_S".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD.MM.YYYY",
        LL: "YYYY. [gada] D. MMMM",
        LLL: "YYYY. [gada] D. MMMM, LT",
        LLLL: "YYYY. [gada] D. MMMM, dddd, LT"
      },
      calendar: {
        sameDay: "[odien pulksten] LT",
        nextDay: "[Rt pulksten] LT",
        nextWeek: "dddd [pulksten] LT",
        lastDay: "[Vakar pulksten] LT",
        lastWeek: "[Pagju] dddd [pulksten] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "%s vlk",
        past: "%s agrk",
        s: "daas sekundes",
        m: "minti",
        mm: d,
        h: "stundu",
        hh: d,
        d: "dienu",
        dd: d,
        M: "mnesi",
        MM: d,
        y: "gadu",
        yy: d
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("lv", "lv", {
      closeText: "Aizvrt",
      prevText: "Iepr.",
      nextText: "Nk.",
      currentText: "odien",
      monthNames: ["Janvris", "Februris", "Marts", "Aprlis", "Maijs", "Jnijs", "Jlijs", "Augusts", "Septembris", "Oktobris", "Novembris", "Decembris"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "Mai", "Jn", "Jl", "Aug", "Sep", "Okt", "Nov", "Dec"],
      dayNames: ["svtdiena", "pirmdiena", "otrdiena", "trediena", "ceturtdiena", "piektdiena", "sestdiena"],
      dayNamesShort: ["svt", "prm", "otr", "tre", "ctr", "pkt", "sst"],
      dayNamesMin: ["Sv", "Pr", "Ot", "Tr", "Ct", "Pk", "Ss"],
      weekHeader: "Ned.",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("lv", {
      buttonText: {month: "Mnesis", week: "Neda", day: "Diena", list: "Dienas krtba"},
      allDayText: "Visu dienu",
      eventLimitText: function (a) {
        return "+vl " + a
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "nb", {
      months: "januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),
      monthsShort: "jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),
      weekdays: "sndag_mandag_tirsdag_onsdag_torsdag_fredag_lrdag".split("_"),
      weekdaysShort: "sn_man_tirs_ons_tors_fre_lr".split("_"),
      weekdaysMin: "s_ma_ti_on_to_fr_l".split("_"),
      longDateFormat: {
        LT: "H.mm",
        LTS: "LT.ss",
        L: "DD.MM.YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY [kl.] LT",
        LLLL: "dddd D. MMMM YYYY [kl.] LT"
      },
      calendar: {
        sameDay: "[i dag kl.] LT",
        nextDay: "[i morgen kl.] LT",
        nextWeek: "dddd [kl.] LT",
        lastDay: "[i gr kl.] LT",
        lastWeek: "[forrige] dddd [kl.] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "om %s",
        past: "for %s siden",
        s: "noen sekunder",
        m: "ett minutt",
        mm: "%d minutter",
        h: "en time",
        hh: "%d timer",
        d: "en dag",
        dd: "%d dager",
        M: "en mned",
        MM: "%d mneder",
        y: "ett r",
        yy: "%d r"
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("nb", "nb", {
      closeText: "Lukk",
      prevText: "&#xAB;Forrige",
      nextText: "Neste&#xBB;",
      currentText: "I dag",
      monthNames: ["januar", "februar", "mars", "april", "mai", "juni", "juli", "august", "september", "oktober", "november", "desember"],
      monthNamesShort: ["jan", "feb", "mar", "apr", "mai", "jun", "jul", "aug", "sep", "okt", "nov", "des"],
      dayNamesShort: ["sn", "man", "tir", "ons", "tor", "fre", "lr"],
      dayNames: ["sndag", "mandag", "tirsdag", "onsdag", "torsdag", "fredag", "lrdag"],
      dayNamesMin: ["s", "ma", "ti", "on", "to", "fr", "l"],
      weekHeader: "Uke",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("nb", {
      buttonText: {month: "Mned", week: "Uke", day: "Dag", list: "Agenda"},
      allDayText: "Hele dagen",
      eventLimitText: "til"
    })
  }(), function () {
    var c = "jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"), d = "jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_");
    (b.defineLocale || b.lang).call(b, "nl", {
      months: "januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),
      monthsShort: function (a, b) {
        return /-MMM-/.test(b) ? d[a.month()] : c[a.month()]
      },
      weekdays: "zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),
      weekdaysShort: "zo._ma._di._wo._do._vr._za.".split("_"),
      weekdaysMin: "Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD-MM-YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[vandaag om] LT",
        nextDay: "[morgen om] LT",
        nextWeek: "dddd [om] LT",
        lastDay: "[gisteren om] LT",
        lastWeek: "[afgelopen] dddd [om] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "over %s",
        past: "%s geleden",
        s: "een paar seconden",
        m: "n minuut",
        mm: "%d minuten",
        h: "n uur",
        hh: "%d uur",
        d: "n dag",
        dd: "%d dagen",
        M: "n maand",
        MM: "%d maanden",
        y: "n jaar",
        yy: "%d jaar"
      },
      ordinalParse: /\d{1,2}(ste|de)/,
      ordinal: function (a) {
        return a + (1 === a || 8 === a || a >= 20 ? "ste" : "de")
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("nl", "nl", {
      closeText: "Sluiten",
      prevText: "",
      nextText: "",
      currentText: "Vandaag",
      monthNames: ["januari", "februari", "maart", "april", "mei", "juni", "juli", "augustus", "september", "oktober", "november", "december"],
      monthNamesShort: ["jan", "feb", "mrt", "apr", "mei", "jun", "jul", "aug", "sep", "okt", "nov", "dec"],
      dayNames: ["zondag", "maandag", "dinsdag", "woensdag", "donderdag", "vrijdag", "zaterdag"],
      dayNamesShort: ["zon", "maa", "din", "woe", "don", "vri", "zat"],
      dayNamesMin: ["zo", "ma", "di", "wo", "do", "vr", "za"],
      weekHeader: "Wk",
      dateFormat: "dd-mm-yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("nl", {
      buttonText: {month: "Maand", week: "Week", day: "Dag", list: "Agenda"},
      allDayText: "Hele dag",
      eventLimitText: "extra"
    })
  }(), function () {
    function c(a) {
      return 5 > a % 10 && a % 10 > 1 && ~~(a / 10) % 10 !== 1
    }

    function d(a, b, d) {
      var e = a + " ";
      switch (d) {
        case"m":
          return b ? "minuta" : "minut";
        case"mm":
          return e + (c(a) ? "minuty" : "minut");
        case"h":
          return b ? "godzina" : "godzin";
        case"hh":
          return e + (c(a) ? "godziny" : "godzin");
        case"MM":
          return e + (c(a) ? "miesice" : "miesicy");
        case"yy":
          return e + (c(a) ? "lata" : "lat")
      }
    }

    var e = "stycze_luty_marzec_kwiecie_maj_czerwiec_lipiec_sierpie_wrzesie_padziernik_listopad_grudzie".split("_"), f = "stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_wrzenia_padziernika_listopada_grudnia".split("_");
    (b.defineLocale || b.lang).call(b, "pl", {
      months: function (a, b) {
        return /D MMMM/.test(b) ? f[a.month()] : e[a.month()]
      },
      monthsShort: "sty_lut_mar_kwi_maj_cze_lip_sie_wrz_pa_lis_gru".split("_"),
      weekdays: "niedziela_poniedziaek_wtorek_roda_czwartek_pitek_sobota".split("_"),
      weekdaysShort: "nie_pon_wt_r_czw_pt_sb".split("_"),
      weekdaysMin: "N_Pn_Wt_r_Cz_Pt_So".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD.MM.YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd, D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Dzi o] LT",
        nextDay: "[Jutro o] LT",
        nextWeek: "[W] dddd [o] LT",
        lastDay: "[Wczoraj o] LT",
        lastWeek: function () {
          switch (this.day()) {
            case 0:
              return "[W zesz niedziel o] LT";
            case 3:
              return "[W zesz rod o] LT";
            case 6:
              return "[W zesz sobot o] LT";
            default:
              return "[W zeszy] dddd [o] LT"
          }
        },
        sameElse: "L"
      },
      relativeTime: {
        future: "za %s",
        past: "%s temu",
        s: "kilka sekund",
        m: d,
        mm: d,
        h: d,
        hh: d,
        d: "1 dzie",
        dd: "%d dni",
        M: "miesic",
        MM: d,
        y: "rok",
        yy: d
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("pl", "pl", {
      closeText: "Zamknij",
      prevText: "&#x3C;Poprzedni",
      nextText: "Nastpny&#x3E;",
      currentText: "Dzi",
      monthNames: ["Stycze", "Luty", "Marzec", "Kwiecie", "Maj", "Czerwiec", "Lipiec", "Sierpie", "Wrzesie", "Padziernik", "Listopad", "Grudzie"],
      monthNamesShort: ["Sty", "Lu", "Mar", "Kw", "Maj", "Cze", "Lip", "Sie", "Wrz", "Pa", "Lis", "Gru"],
      dayNames: ["Niedziela", "Poniedziaek", "Wtorek", "roda", "Czwartek", "Pitek", "Sobota"],
      dayNamesShort: ["Nie", "Pn", "Wt", "r", "Czw", "Pt", "So"],
      dayNamesMin: ["N", "Pn", "Wt", "r", "Cz", "Pt", "So"],
      weekHeader: "Tydz",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("pl", {
      buttonText: {month: "Miesic", week: "Tydzie", day: "Dzie", list: "Plan dnia"},
      allDayText: "Cay dzie",
      eventLimitText: "wicej"
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "pt-br", {
      months: "janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),
      monthsShort: "jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),
      weekdays: "domingo_segunda-feira_tera-feira_quarta-feira_quinta-feira_sexta-feira_sbado".split("_"),
      weekdaysShort: "dom_seg_ter_qua_qui_sex_sb".split("_"),
      weekdaysMin: "dom_2_3_4_5_6_sb".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D [de] MMMM [de] YYYY",
        LLL: "D [de] MMMM [de] YYYY [s] LT",
        LLLL: "dddd, D [de] MMMM [de] YYYY [s] LT"
      },
      calendar: {
        sameDay: "[Hoje s] LT",
        nextDay: "[Amanh s] LT",
        nextWeek: "dddd [s] LT",
        lastDay: "[Ontem s] LT",
        lastWeek: function () {
          return 0 === this.day() || 6 === this.day() ? "[ltimo] dddd [s] LT" : "[ltima] dddd [s] LT"
        },
        sameElse: "L"
      },
      relativeTime: {
        future: "em %s",
        past: "%s atrs",
        s: "segundos",
        m: "um minuto",
        mm: "%d minutos",
        h: "uma hora",
        hh: "%d horas",
        d: "um dia",
        dd: "%d dias",
        M: "um ms",
        MM: "%d meses",
        y: "um ano",
        yy: "%d anos"
      },
      ordinalParse: /\d{1,2}/,
      ordinal: "%d"
    }), a.confiFormsCalendar.datepickerLang("pt-br", "pt-BR", {
      closeText: "Fechar",
      prevText: "&#x3C;Anterior",
      nextText: "Prximo&#x3E;",
      currentText: "Hoje",
      monthNames: ["Janeiro", "Fevereiro", "Maro", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"],
      monthNamesShort: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"],
      dayNames: ["Domingo", "Segunda-feira", "Tera-feira", "Quarta-feira", "Quinta-feira", "Sexta-feira", "Sbado"],
      dayNamesShort: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sb"],
      dayNamesMin: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sb"],
      weekHeader: "Sm",
      dateFormat: "dd/mm/yy",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("pt-br", {
      buttonText: {month: "Ms", week: "Semana", day: "Dia", list: "Compromissos"},
      allDayText: "dia inteiro",
      eventLimitText: function (a) {
        return "mais +" + a
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "pt", {
      months: "janeiro_fevereiro_maro_abril_maio_junho_julho_agosto_setembro_outubro_novembro_dezembro".split("_"),
      monthsShort: "jan_fev_mar_abr_mai_jun_jul_ago_set_out_nov_dez".split("_"),
      weekdays: "domingo_segunda-feira_tera-feira_quarta-feira_quinta-feira_sexta-feira_sbado".split("_"),
      weekdaysShort: "dom_seg_ter_qua_qui_sex_sb".split("_"),
      weekdaysMin: "dom_2_3_4_5_6_sb".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D [de] MMMM [de] YYYY",
        LLL: "D [de] MMMM [de] YYYY LT",
        LLLL: "dddd, D [de] MMMM [de] YYYY LT"
      },
      calendar: {
        sameDay: "[Hoje s] LT",
        nextDay: "[Amanh s] LT",
        nextWeek: "dddd [s] LT",
        lastDay: "[Ontem s] LT",
        lastWeek: function () {
          return 0 === this.day() || 6 === this.day() ? "[ltimo] dddd [s] LT" : "[ltima] dddd [s] LT"
        },
        sameElse: "L"
      },
      relativeTime: {
        future: "em %s",
        past: "h %s",
        s: "segundos",
        m: "um minuto",
        mm: "%d minutos",
        h: "uma hora",
        hh: "%d horas",
        d: "um dia",
        dd: "%d dias",
        M: "um ms",
        MM: "%d meses",
        y: "um ano",
        yy: "%d anos"
      },
      ordinalParse: /\d{1,2}/,
      ordinal: "%d",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("pt", "pt", {
      closeText: "Fechar",
      prevText: "Anterior",
      nextText: "Seguinte",
      currentText: "Hoje",
      monthNames: ["Janeiro", "Fevereiro", "Maro", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"],
      monthNamesShort: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"],
      dayNames: ["Domingo", "Segunda-feira", "Tera-feira", "Quarta-feira", "Quinta-feira", "Sexta-feira", "Sbado"],
      dayNamesShort: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sb"],
      dayNamesMin: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sb"],
      weekHeader: "Sem",
      dateFormat: "dd/mm/yy",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("pt", {
      buttonText: {month: "Ms", week: "Semana", day: "Dia", list: "Agenda"},
      allDayText: "Todo o dia",
      eventLimitText: "mais"
    })
  }(), function () {
    function c(a, b, c) {
      var d = {mm: "minute", hh: "ore", dd: "zile", MM: "luni", yy: "ani"}, e = " ";
      return (a % 100 >= 20 || a >= 100 && a % 100 === 0) && (e = " de "), a + e + d[c]
    }

    (b.defineLocale || b.lang).call(b, "ro", {
      months: "ianuarie_februarie_martie_aprilie_mai_iunie_iulie_august_septembrie_octombrie_noiembrie_decembrie".split("_"),
      monthsShort: "ian._febr._mart._apr._mai_iun._iul._aug._sept._oct._nov._dec.".split("_"),
      weekdays: "duminic_luni_mari_miercuri_joi_vineri_smbt".split("_"),
      weekdaysShort: "Dum_Lun_Mar_Mie_Joi_Vin_Sm".split("_"),
      weekdaysMin: "Du_Lu_Ma_Mi_Jo_Vi_S".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD.MM.YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY H:mm",
        LLLL: "dddd, D MMMM YYYY H:mm"
      },
      calendar: {
        sameDay: "[azi la] LT",
        nextDay: "[mine la] LT",
        nextWeek: "dddd [la] LT",
        lastDay: "[ieri la] LT",
        lastWeek: "[fosta] dddd [la] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "peste %s",
        past: "%s n urm",
        s: "cteva secunde",
        m: "un minut",
        mm: c,
        h: "o or",
        hh: c,
        d: "o zi",
        dd: c,
        M: "o lun",
        MM: c,
        y: "un an",
        yy: c
      },
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("ro", "ro", {
      closeText: "nchide",
      prevText: "&#xAB; Luna precedent",
      nextText: "Luna urmtoare &#xBB;",
      currentText: "Azi",
      monthNames: ["Ianuarie", "Februarie", "Martie", "Aprilie", "Mai", "Iunie", "Iulie", "August", "Septembrie", "Octombrie", "Noiembrie", "Decembrie"],
      monthNamesShort: ["Ian", "Feb", "Mar", "Apr", "Mai", "Iun", "Iul", "Aug", "Sep", "Oct", "Nov", "Dec"],
      dayNames: ["Duminic", "Luni", "Mari", "Miercuri", "Joi", "Vineri", "Smbt"],
      dayNamesShort: ["Dum", "Lun", "Mar", "Mie", "Joi", "Vin", "Sm"],
      dayNamesMin: ["Du", "Lu", "Ma", "Mi", "Jo", "Vi", "S"],
      weekHeader: "Spt",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ro", {
      buttonText: {
        prev: "precedent",
        next: "urmtoare",
        month: "Lun",
        week: "Sptmn",
        day: "Zi",
        list: "Agend"
      }, allDayText: "Toat ziua", eventLimitText: function (a) {
        return "+alte " + a
      }
    })
  }(), function () {
    function c(a, b) {
      var c = a.split("_");
      return b % 10 === 1 && b % 100 !== 11 ? c[0] : b % 10 >= 2 && 4 >= b % 10 && (10 > b % 100 || b % 100 >= 20) ? c[1] : c[2]
    }

    function d(a, b, d) {
      var e = {
        mm: b ? "__" : "__",
        hh: "__",
        dd: "__",
        MM: "__",
        yy: "__"
      };
      return "m" === d ? b ? "" : "" : a + " " + c(e[d], +a)
    }

    function e(a, b) {
      var c = {
        nominative: "___________".split("_"),
        accusative: "___________".split("_")
      }, d = /D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b) ? "accusative" : "nominative";
      return c[d][a.month()]
    }

    function f(a, b) {
      var c = {
        nominative: "___________".split("_"),
        accusative: "___________".split("_")
      }, d = /D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b) ? "accusative" : "nominative";
      return c[d][a.month()]
    }

    function g(a, b) {
      var c = {
        nominative: "______".split("_"),
        accusative: "______".split("_")
      }, d = /\[ ?[] ?(?:||)? ?\] ?dddd/.test(b) ? "accusative" : "nominative";
      return c[d][a.day()]
    }

    (b.defineLocale || b.lang).call(b, "ru", {
      months: e,
      monthsShort: f,
      weekdays: g,
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      monthsParse: [/^/i, /^/i, /^/i, /^/i, /^[|]/i, /^/i, /^/i, /^/i, /^/i, /^/i, /^/i, /^/i],
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD.MM.YYYY",
        LL: "D MMMM YYYY .",
        LLL: "D MMMM YYYY ., LT",
        LLLL: "dddd, D MMMM YYYY ., LT"
      },
      calendar: {
        sameDay: "[ ] LT", nextDay: "[ ] LT", lastDay: "[ ] LT", nextWeek: function () {
          return 2 === this.day() ? "[] dddd [] LT" : "[] dddd [] LT"
        }, lastWeek: function (a) {
          if (a.week() === this.week())return 2 === this.day() ? "[] dddd [] LT" : "[] dddd [] LT";
          switch (this.day()) {
            case 0:
              return "[ ] dddd [] LT";
            case 1:
            case 2:
            case 4:
              return "[ ] dddd [] LT";
            case 3:
            case 5:
            case 6:
              return "[ ] dddd [] LT"
          }
        }, sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: "%s ",
        s: " ",
        m: d,
        mm: d,
        h: "",
        hh: d,
        d: "",
        dd: d,
        M: "",
        MM: d,
        y: "",
        yy: d
      },
      meridiemParse: /|||/i,
      isPM: function (a) {
        return /^(|)$/.test(a)
      },
      meridiem: function (a, b, c) {
        return 4 > a ? "" : 12 > a ? "" : 17 > a ? "" : ""
      },
      ordinalParse: /\d{1,2}-(||)/,
      ordinal: function (a, b) {
        switch (b) {
          case"M":
          case"d":
          case"DDD":
            return a + "-";
          case"D":
            return a + "-";
          case"w":
          case"W":
            return a + "-";
          default:
            return a
        }
      },
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("ru", "ru", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("ru", {
      buttonText: {month: "", week: "", day: "", list: " "},
      allDayText: " ",
      eventLimitText: function (a) {
        return "+  " + a
      }
    })
  }(), function () {
    function c(a) {
      return a > 1 && 5 > a
    }

    function d(a, b, d, e) {
      var f = a + " ";
      switch (d) {
        case"s":
          return b || e ? "pr seknd" : "pr sekundami";
        case"m":
          return b ? "minta" : e ? "mintu" : "mintou";
        case"mm":
          return b || e ? f + (c(a) ? "minty" : "mint") : f + "mintami";
        case"h":
          return b ? "hodina" : e ? "hodinu" : "hodinou";
        case"hh":
          return b || e ? f + (c(a) ? "hodiny" : "hodn") : f + "hodinami";
        case"d":
          return b || e ? "de" : "dom";
        case"dd":
          return b || e ? f + (c(a) ? "dni" : "dn") : f + "dami";
        case"M":
          return b || e ? "mesiac" : "mesiacom";
        case"MM":
          return b || e ? f + (c(a) ? "mesiace" : "mesiacov") : f + "mesiacmi";
        case"y":
          return b || e ? "rok" : "rokom";
        case"yy":
          return b || e ? f + (c(a) ? "roky" : "rokov") : f + "rokmi"
      }
    }

    var e = "janur_februr_marec_aprl_mj_jn_jl_august_september_oktber_november_december".split("_"), f = "jan_feb_mar_apr_mj_jn_jl_aug_sep_okt_nov_dec".split("_");
    (b.defineLocale || b.lang).call(b, "sk", {
      months: e,
      monthsShort: f,
      monthsParse: function (a, b) {
        var c, d = [];
        for (c = 0; 12 > c; c++)d[c] = new RegExp("^" + a[c] + "$|^" + b[c] + "$", "i");
        return d
      }(e, f),
      weekdays: "nedea_pondelok_utorok_streda_tvrtok_piatok_sobota".split("_"),
      weekdaysShort: "ne_po_ut_st_t_pi_so".split("_"),
      weekdaysMin: "ne_po_ut_st_t_pi_so".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD.MM.YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[dnes o] LT", nextDay: "[zajtra o] LT", nextWeek: function () {
          switch (this.day()) {
            case 0:
              return "[v nedeu o] LT";
            case 1:
            case 2:
              return "[v] dddd [o] LT";
            case 3:
              return "[v stredu o] LT";
            case 4:
              return "[vo tvrtok o] LT";
            case 5:
              return "[v piatok o] LT";
            case 6:
              return "[v sobotu o] LT"
          }
        }, lastDay: "[vera o] LT", lastWeek: function () {
          switch (this.day()) {
            case 0:
              return "[minul nedeu o] LT";
            case 1:
            case 2:
              return "[minul] dddd [o] LT";
            case 3:
              return "[minul stredu o] LT";
            case 4:
            case 5:
              return "[minul] dddd [o] LT";
            case 6:
              return "[minul sobotu o] LT"
          }
        }, sameElse: "L"
      },
      relativeTime: {
        future: "za %s",
        past: "pred %s",
        s: d,
        m: d,
        mm: d,
        h: d,
        hh: d,
        d: d,
        dd: d,
        M: d,
        MM: d,
        y: d,
        yy: d
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("sk", "sk", {
      closeText: "Zavrie",
      prevText: "&#x3C;Predchdzajci",
      nextText: "Nasledujci&#x3E;",
      currentText: "Dnes",
      monthNames: ["janur", "februr", "marec", "aprl", "mj", "jn", "jl", "august", "september", "oktber", "november", "december"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "Mj", "Jn", "Jl", "Aug", "Sep", "Okt", "Nov", "Dec"],
      dayNames: ["nedea", "pondelok", "utorok", "streda", "tvrtok", "piatok", "sobota"],
      dayNamesShort: ["Ned", "Pon", "Uto", "Str", "tv", "Pia", "Sob"],
      dayNamesMin: ["Ne", "Po", "Ut", "St", "t", "Pia", "So"],
      weekHeader: "Ty",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("sk", {
      buttonText: {month: "Mesiac", week: "Tde", day: "De", list: "Rozvrh"},
      allDayText: "Cel de",
      eventLimitText: function (a) {
        return "+alie: " + a
      }
    })
  }(), function () {
    function c(a, b, c) {
      var d = a + " ";
      switch (c) {
        case"m":
          return b ? "ena minuta" : "eno minuto";
        case"mm":
          return d += 1 === a ? "minuta" : 2 === a ? "minuti" : 3 === a || 4 === a ? "minute" : "minut";
        case"h":
          return b ? "ena ura" : "eno uro";
        case"hh":
          return d += 1 === a ? "ura" : 2 === a ? "uri" : 3 === a || 4 === a ? "ure" : "ur";
        case"dd":
          return d += 1 === a ? "dan" : "dni";
        case"MM":
          return d += 1 === a ? "mesec" : 2 === a ? "meseca" : 3 === a || 4 === a ? "mesece" : "mesecev";
        case"yy":
          return d += 1 === a ? "leto" : 2 === a ? "leti" : 3 === a || 4 === a ? "leta" : "let"
      }
    }

    (b.defineLocale || b.lang).call(b, "sl", {
      months: "januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),
      monthsShort: "jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),
      weekdays: "nedelja_ponedeljek_torek_sreda_etrtek_petek_sobota".split("_"),
      weekdaysShort: "ned._pon._tor._sre._et._pet._sob.".split("_"),
      weekdaysMin: "ne_po_to_sr_e_pe_so".split("_"),
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD. MM. YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd, D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[danes ob] LT", nextDay: "[jutri ob] LT", nextWeek: function () {
          switch (this.day()) {
            case 0:
              return "[v] [nedeljo] [ob] LT";
            case 3:
              return "[v] [sredo] [ob] LT";
            case 6:
              return "[v] [soboto] [ob] LT";
            case 1:
            case 2:
            case 4:
            case 5:
              return "[v] dddd [ob] LT"
          }
        }, lastDay: "[veraj ob] LT", lastWeek: function () {
          switch (this.day()) {
            case 0:
            case 3:
            case 6:
              return "[prejnja] dddd [ob] LT";
            case 1:
            case 2:
            case 4:
            case 5:
              return "[prejnji] dddd [ob] LT"
          }
        }, sameElse: "L"
      },
      relativeTime: {
        future: "ez %s",
        past: "%s nazaj",
        s: "nekaj sekund",
        m: c,
        mm: c,
        h: c,
        hh: c,
        d: "en dan",
        dd: c,
        M: "en mesec",
        MM: c,
        y: "eno leto",
        yy: c
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("sl", "sl", {
      closeText: "Zapri",
      prevText: "&#x3C;Prejnji",
      nextText: "Naslednji&#x3E;",
      currentText: "Trenutni",
      monthNames: ["Januar", "Februar", "Marec", "April", "Maj", "Junij", "Julij", "Avgust", "September", "Oktober", "November", "December"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "Maj", "Jun", "Jul", "Avg", "Sep", "Okt", "Nov", "Dec"],
      dayNames: ["Nedelja", "Ponedeljek", "Torek", "Sreda", "etrtek", "Petek", "Sobota"],
      dayNamesShort: ["Ned", "Pon", "Tor", "Sre", "et", "Pet", "Sob"],
      dayNamesMin: ["Ne", "Po", "To", "Sr", "e", "Pe", "So"],
      weekHeader: "Teden",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("sl", {
      buttonText: {month: "Mesec", week: "Teden", day: "Dan", list: "Dnevni red"},
      allDayText: "Ves dan",
      eventLimitText: "ve"
    })
  }(), function () {
    var c = {
      words: {
        m: [" ", " "],
        mm: ["", "", ""],
        h: [" ", " "],
        hh: ["", "", ""],
        dd: ["", "", ""],
        MM: ["", "", ""],
        yy: ["", "", ""]
      }, correctGrammaticalCase: function (a, b) {
        return 1 === a ? b[0] : a >= 2 && 4 >= a ? b[1] : b[2]
      }, translate: function (a, b, d) {
        var e = c.words[d];
        return 1 === d.length ? b ? e[0] : e[1] : a + " " + c.correctGrammaticalCase(a, e)
      }
    };
    (b.defineLocale || b.lang).call(b, "sr-cyrl", {
      months: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthsShort: [".", ".", ".", ".", "", "", "", ".", ".", ".", ".", "."],
      weekdays: ["", "", "", "", "", "", ""],
      weekdaysShort: [".", ".", ".", ".", ".", ".", "."],
      weekdaysMin: ["", "", "", "", "", "", ""],
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD. MM. YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd, D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[ ] LT", nextDay: "[ ] LT", nextWeek: function () {
          switch (this.day()) {
            case 0:
              return "[] [] [] LT";
            case 3:
              return "[] [] [] LT";
            case 6:
              return "[] [] [] LT";
            case 1:
            case 2:
            case 4:
            case 5:
              return "[] dddd [] LT"
          }
        }, lastDay: "[ ] LT", lastWeek: function () {
          var a = ["[] [] [] LT", "[] [] [] LT", "[] [] [] LT", "[] [] [] LT", "[] [] [] LT", "[] [] [] LT", "[] [] [] LT"];
          return a[this.day()]
        }, sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: " %s",
        s: " ",
        m: c.translate,
        mm: c.translate,
        h: c.translate,
        hh: c.translate,
        d: "",
        dd: c.translate,
        M: "",
        MM: c.translate,
        y: "",
        yy: c.translate
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("sr-cyrl", "sr", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("sr-cyrl", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: " ",
      eventLimitText: function (a) {
        return "+  " + a
      }
    })
  }(), function () {
    var c = {
      words: {
        m: ["jedan minut", "jedne minute"],
        mm: ["minut", "minute", "minuta"],
        h: ["jedan sat", "jednog sata"],
        hh: ["sat", "sata", "sati"],
        dd: ["dan", "dana", "dana"],
        MM: ["mesec", "meseca", "meseci"],
        yy: ["godina", "godine", "godina"]
      }, correctGrammaticalCase: function (a, b) {
        return 1 === a ? b[0] : a >= 2 && 4 >= a ? b[1] : b[2]
      }, translate: function (a, b, d) {
        var e = c.words[d];
        return 1 === d.length ? b ? e[0] : e[1] : a + " " + c.correctGrammaticalCase(a, e)
      }
    };
    (b.defineLocale || b.lang).call(b, "sr", {
      months: ["januar", "februar", "mart", "april", "maj", "jun", "jul", "avgust", "septembar", "oktobar", "novembar", "decembar"],
      monthsShort: ["jan.", "feb.", "mar.", "apr.", "maj", "jun", "jul", "avg.", "sep.", "okt.", "nov.", "dec."],
      weekdays: ["nedelja", "ponedeljak", "utorak", "sreda", "etvrtak", "petak", "subota"],
      weekdaysShort: ["ned.", "pon.", "uto.", "sre.", "et.", "pet.", "sub."],
      weekdaysMin: ["ne", "po", "ut", "sr", "e", "pe", "su"],
      longDateFormat: {
        LT: "H:mm",
        LTS: "LT:ss",
        L: "DD. MM. YYYY",
        LL: "D. MMMM YYYY",
        LLL: "D. MMMM YYYY LT",
        LLLL: "dddd, D. MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[danas u] LT", nextDay: "[sutra u] LT", nextWeek: function () {
          switch (this.day()) {
            case 0:
              return "[u] [nedelju] [u] LT";
            case 3:
              return "[u] [sredu] [u] LT";
            case 6:
              return "[u] [subotu] [u] LT";
            case 1:
            case 2:
            case 4:
            case 5:
              return "[u] dddd [u] LT"
          }
        }, lastDay: "[jue u] LT", lastWeek: function () {
          var a = ["[prole] [nedelje] [u] LT", "[prolog] [ponedeljka] [u] LT", "[prolog] [utorka] [u] LT", "[prole] [srede] [u] LT", "[prolog] [etvrtka] [u] LT", "[prolog] [petka] [u] LT", "[prole] [subote] [u] LT"];
          return a[this.day()]
        }, sameElse: "L"
      },
      relativeTime: {
        future: "za %s",
        past: "pre %s",
        s: "nekoliko sekundi",
        m: c.translate,
        mm: c.translate,
        h: c.translate,
        hh: c.translate,
        d: "dan",
        dd: c.translate,
        M: "mesec",
        MM: c.translate,
        y: "godinu",
        yy: c.translate
      },
      ordinalParse: /\d{1,2}\./,
      ordinal: "%d.",
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("sr", "sr", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("sr", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: " ",
      eventLimitText: function (a) {
        return "+  " + a
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "sv", {
      months: "januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),
      monthsShort: "jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),
      weekdays: "sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag".split("_"),
      weekdaysShort: "sn_mn_tis_ons_tor_fre_lr".split("_"),
      weekdaysMin: "s_m_ti_on_to_fr_l".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "YYYY-MM-DD",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[Idag] LT",
        nextDay: "[Imorgon] LT",
        lastDay: "[Igr] LT",
        nextWeek: "dddd LT",
        lastWeek: "[Frra] dddd[en] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "om %s",
        past: "fr %s sedan",
        s: "ngra sekunder",
        m: "en minut",
        mm: "%d minuter",
        h: "en timme",
        hh: "%d timmar",
        d: "en dag",
        dd: "%d dagar",
        M: "en mnad",
        MM: "%d mnader",
        y: "ett r",
        yy: "%d r"
      },
      ordinalParse: /\d{1,2}(e|a)/,
      ordinal: function (a) {
        var b = a % 10, c = 1 === ~~(a % 100 / 10) ? "e" : 1 === b ? "a" : 2 === b ? "a" : "e";
        return a + c
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("sv", "sv", {
      closeText: "Stng",
      prevText: "&#xAB;Frra",
      nextText: "Nsta&#xBB;",
      currentText: "Idag",
      monthNames: ["Januari", "Februari", "Mars", "April", "Maj", "Juni", "Juli", "Augusti", "September", "Oktober", "November", "December"],
      monthNamesShort: ["Jan", "Feb", "Mar", "Apr", "Maj", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dec"],
      dayNamesShort: ["Sn", "Mn", "Tis", "Ons", "Tor", "Fre", "Lr"],
      dayNames: ["Sndag", "Mndag", "Tisdag", "Onsdag", "Torsdag", "Fredag", "Lrdag"],
      dayNamesMin: ["S", "M", "Ti", "On", "To", "Fr", "L"],
      weekHeader: "Ve",
      dateFormat: "yy-mm-dd",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("sv", {
      buttonText: {month: "Mnad", week: "Vecka", day: "Dag", list: "Program"},
      allDayText: "Heldag",
      eventLimitText: "till"
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "th", {
      months: "___________".split("_"),
      monthsShort: "___________".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "._._._._._._.".split("_"),
      longDateFormat: {
        LT: "H  m ",
        LTS: "LT s ",
        L: "YYYY/MM/DD",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY  LT",
        LLLL: "dddd D MMMM YYYY  LT"
      },
      meridiemParse: /|/,
      isPM: function (a) {
        return "" === a
      },
      meridiem: function (a, b, c) {
        return 12 > a ? "" : ""
      },
      calendar: {
        sameDay: "[ ] LT",
        nextDay: "[ ] LT",
        nextWeek: "dddd[ ] LT",
        lastDay: "[ ] LT",
        lastWeek: "[]dddd[ ] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: "%s",
        s: "",
        m: "1 ",
        mm: "%d ",
        h: "1 ",
        hh: "%d ",
        d: "1 ",
        dd: "%d ",
        M: "1 ",
        MM: "%d ",
        y: "1 ",
        yy: "%d "
      }
    }), a.confiFormsCalendar.datepickerLang("th", "th", {
      closeText: "",
      prevText: "&#xAB;&#xA0;",
      nextText: "&#xA0;&#xBB;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", ".."],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: [".", ".", ".", ".", ".", ".", "."],
      dayNamesMin: [".", ".", ".", ".", ".", ".", "."],
      weekHeader: "Wk",
      dateFormat: "dd/mm/yy",
      firstDay: 0,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("th", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: "",
      eventLimitText: ""
    })
  }(), function () {
    var c = {
      1: "'inci",
      5: "'inci",
      8: "'inci",
      70: "'inci",
      80: "'inci",
      2: "'nci",
      7: "'nci",
      20: "'nci",
      50: "'nci",
      3: "'nc",
      4: "'nc",
      100: "'nc",
      6: "'nc",
      9: "'uncu",
      10: "'uncu",
      30: "'uncu",
      60: "'nc",
      90: "'nc"
    };
    (b.defineLocale || b.lang).call(b, "tr", {
      months: "Ocak_ubat_Mart_Nisan_Mays_Haziran_Temmuz_Austos_Eyll_Ekim_Kasm_Aralk".split("_"),
      monthsShort: "Oca_ub_Mar_Nis_May_Haz_Tem_Au_Eyl_Eki_Kas_Ara".split("_"),
      weekdays: "Pazar_Pazartesi_Sal_aramba_Perembe_Cuma_Cumartesi".split("_"),
      weekdaysShort: "Paz_Pts_Sal_ar_Per_Cum_Cts".split("_"),
      weekdaysMin: "Pz_Pt_Sa_a_Pe_Cu_Ct".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD.MM.YYYY",
        LL: "D MMMM YYYY",
        LLL: "D MMMM YYYY LT",
        LLLL: "dddd, D MMMM YYYY LT"
      },
      calendar: {
        sameDay: "[bugn saat] LT",
        nextDay: "[yarn saat] LT",
        nextWeek: "[haftaya] dddd [saat] LT",
        lastDay: "[dn] LT",
        lastWeek: "[geen hafta] dddd [saat] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "%s sonra",
        past: "%s nce",
        s: "birka saniye",
        m: "bir dakika",
        mm: "%d dakika",
        h: "bir saat",
        hh: "%d saat",
        d: "bir gn",
        dd: "%d gn",
        M: "bir ay",
        MM: "%d ay",
        y: "bir yl",
        yy: "%d yl"
      },
      ordinalParse: /\d{1,2}'(inci|nci|nc|nc|uncu|nc)/,
      ordinal: function (a) {
        if (0 === a)return a + "'nc";
        var b = a % 10, d = a % 100 - b, e = a >= 100 ? 100 : null;
        return a + (c[b] || c[d] || c[e])
      },
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("tr", "tr", {
      closeText: "kapat",
      prevText: "&#x3C;geri",
      nextText: "ileri&#x3e",
      currentText: "bugn",
      monthNames: ["Ocak", "ubat", "Mart", "Nisan", "Mays", "Haziran", "Temmuz", "Austos", "Eyll", "Ekim", "Kasm", "Aralk"],
      monthNamesShort: ["Oca", "ub", "Mar", "Nis", "May", "Haz", "Tem", "Au", "Eyl", "Eki", "Kas", "Ara"],
      dayNames: ["Pazar", "Pazartesi", "Sal", "aramba", "Perembe", "Cuma", "Cumartesi"],
      dayNamesShort: ["Pz", "Pt", "Sa", "a", "Pe", "Cu", "Ct"],
      dayNamesMin: ["Pz", "Pt", "Sa", "a", "Pe", "Cu", "Ct"],
      weekHeader: "Hf",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("tr", {
      buttonText: {next: "ileri", month: "Ay", week: "Hafta", day: "Gn", list: "Ajanda"},
      allDayText: "Tm gn",
      eventLimitText: "daha fazla"
    })
  }(), function () {
    function c(a, b) {
      var c = a.split("_");
      return b % 10 === 1 && b % 100 !== 11 ? c[0] : b % 10 >= 2 && 4 >= b % 10 && (10 > b % 100 || b % 100 >= 20) ? c[1] : c[2]
    }

    function d(a, b, d) {
      var e = {
        mm: "__",
        hh: "__",
        dd: "__",
        MM: "__",
        yy: "__"
      };
      return "m" === d ? b ? "" : "" : "h" === d ? b ? "" : "" : a + " " + c(e[d], +a)
    }

    function e(a, b) {
      var c = {
        nominative: "___________".split("_"),
        accusative: "___________".split("_")
      }, d = /D[oD]? *MMMM?/.test(b) ? "accusative" : "nominative";
      return c[d][a.month()]
    }

    function f(a, b) {
      var c = {
        nominative: "______".split("_"),
        accusative: "______".split("_"),
        genitive: "______".split("_")
      }, d = /(\[[]\]) ?dddd/.test(b) ? "accusative" : /\[?(?:|)? ?\] ?dddd/.test(b) ? "genitive" : "nominative";
      return c[d][a.day()]
    }

    function g(a) {
      return function () {
        return a + "" + (11 === this.hours() ? "" : "") + "] LT"
      }
    }

    (b.defineLocale || b.lang).call(b, "uk", {
      months: e,
      monthsShort: "___________".split("_"),
      weekdays: f,
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD.MM.YYYY",
        LL: "D MMMM YYYY .",
        LLL: "D MMMM YYYY ., LT",
        LLLL: "dddd, D MMMM YYYY ., LT"
      },
      calendar: {
        sameDay: g("[ "),
        nextDay: g("[ "),
        lastDay: g("[ "),
        nextWeek: g("[] dddd ["),
        lastWeek: function () {
          switch (this.day()) {
            case 0:
            case 3:
            case 5:
            case 6:
              return g("[] dddd [").call(this);
            case 1:
            case 2:
            case 4:
              return g("[] dddd [").call(this)
          }
        },
        sameElse: "L"
      },
      relativeTime: {
        future: " %s",
        past: "%s ",
        s: " ",
        m: d,
        mm: d,
        h: "",
        hh: d,
        d: "",
        dd: d,
        M: "",
        MM: d,
        y: "",
        yy: d
      },
      meridiemParse: /|||/,
      isPM: function (a) {
        return /^(|)$/.test(a)
      },
      meridiem: function (a, b, c) {
        return 4 > a ? "" : 12 > a ? "" : 17 > a ? "" : ""
      },
      ordinalParse: /\d{1,2}-(|)/,
      ordinal: function (a, b) {
        switch (b) {
          case"M":
          case"d":
          case"DDD":
          case"w":
          case"W":
            return a + "-";
          case"D":
            return a + "-";
          default:
            return a
        }
      },
      week: {dow: 1, doy: 7}
    }), a.confiFormsCalendar.datepickerLang("uk", "uk", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "dd.mm.yy",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !1,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("uk", {
      buttonText: {month: "", week: "", day: "", list: " "},
      allDayText: " ",
      eventLimitText: function (a) {
        return "+ " + a + "..."
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "vi", {
      months: "thng 1_thng 2_thng 3_thng 4_thng 5_thng 6_thng 7_thng 8_thng 9_thng 10_thng 11_thng 12".split("_"),
      monthsShort: "Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),
      weekdays: "ch nht_th hai_th ba_th t_th nm_th su_th by".split("_"),
      weekdaysShort: "CN_T2_T3_T4_T5_T6_T7".split("_"),
      weekdaysMin: "CN_T2_T3_T4_T5_T6_T7".split("_"),
      longDateFormat: {
        LT: "HH:mm",
        LTS: "LT:ss",
        L: "DD/MM/YYYY",
        LL: "D MMMM [nm] YYYY",
        LLL: "D MMMM [nm] YYYY LT",
        LLLL: "dddd, D MMMM [nm] YYYY LT",
        l: "DD/M/YYYY",
        ll: "D MMM YYYY",
        lll: "D MMM YYYY LT",
        llll: "ddd, D MMM YYYY LT"
      },
      calendar: {
        sameDay: "[Hm nay lc] LT",
        nextDay: "[Ngy mai lc] LT",
        nextWeek: "dddd [tun ti lc] LT",
        lastDay: "[Hm qua lc] LT",
        lastWeek: "dddd [tun ri lc] LT",
        sameElse: "L"
      },
      relativeTime: {
        future: "%s ti",
        past: "%s trc",
        s: "vi giy",
        m: "mt pht",
        mm: "%d pht",
        h: "mt gi",
        hh: "%d gi",
        d: "mt ngy",
        dd: "%d ngy",
        M: "mt thng",
        MM: "%d thng",
        y: "mt nm",
        yy: "%d nm"
      },
      ordinalParse: /\d{1,2}/,
      ordinal: function (a) {
        return a
      },
      week: {dow: 1, doy: 4}
    }),
      a.confiFormsCalendar.datepickerLang("vi", "vi", {
        closeText: "ng",
        prevText: "&#x3C;Trc",
        nextText: "Tip&#x3E;",
        currentText: "Hm nay",
        monthNames: ["Thng Mt", "Thng Hai", "Thng Ba", "Thng T", "Thng Nm", "Thng Su", "Thng By", "Thng Tm", "Thng Chn", "Thng Mi", "Thng Mi Mt", "Thng Mi Hai"],
        monthNamesShort: ["Thng 1", "Thng 2", "Thng 3", "Thng 4", "Thng 5", "Thng 6", "Thng 7", "Thng 8", "Thng 9", "Thng 10", "Thng 11", "Thng 12"],
        dayNames: ["Ch Nht", "Th Hai", "Th Ba", "Th T", "Th Nm", "Th Su", "Th By"],
        dayNamesShort: ["CN", "T2", "T3", "T4", "T5", "T6", "T7"],
        dayNamesMin: ["CN", "T2", "T3", "T4", "T5", "T6", "T7"],
        weekHeader: "Tu",
        dateFormat: "dd/mm/yy",
        firstDay: 0,
        isRTL: !1,
        showMonthAfterYear: !1,
        yearSuffix: ""
      }), a.confiFormsCalendar.lang("vi", {
      buttonText: {month: "Thng", week: "Tun", day: "Ngy", list: "Lch biu"},
      allDayText: "C ngy",
      eventLimitText: function (a) {
        return "+ thm " + a
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "zh-cn", {
      months: "___________".split("_"),
      monthsShort: "1_2_3_4_5_6_7_8_9_10_11_12".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "Ahmm",
        LTS: "Ahms",
        L: "YYYY-MM-DD",
        LL: "YYYYMMMD",
        LLL: "YYYYMMMDLT",
        LLLL: "YYYYMMMDddddLT",
        l: "YYYY-MM-DD",
        ll: "YYYYMMMD",
        lll: "YYYYMMMDLT",
        llll: "YYYYMMMDddddLT"
      },
      meridiemParse: /|||||/,
      meridiemHour: function (a, b) {
        return 12 === a && (a = 0), "" === b || "" === b || "" === b ? a : "" === b || "" === b ? a + 12 : a >= 11 ? a : a + 12
      },
      meridiem: function (a, b, c) {
        var d = 100 * a + b;
        return 600 > d ? "" : 900 > d ? "" : 1130 > d ? "" : 1230 > d ? "" : 1800 > d ? "" : ""
      },
      calendar: {
        sameDay: function () {
          return 0 === this.minutes() ? "[]Ah[]" : "[]LT"
        }, nextDay: function () {
          return 0 === this.minutes() ? "[]Ah[]" : "[]LT"
        }, lastDay: function () {
          return 0 === this.minutes() ? "[]Ah[]" : "[]LT"
        }, nextWeek: function () {
          var a, c;
          return a = b().startOf("week"), c = this.unix() - a.unix() >= 604800 ? "[]" : "[]", 0 === this.minutes() ? c + "dddAh" : c + "dddAhmm"
        }, lastWeek: function () {
          var a, c;
          return a = b().startOf("week"), c = this.unix() < a.unix() ? "[]" : "[]", 0 === this.minutes() ? c + "dddAh" : c + "dddAhmm"
        }, sameElse: "LL"
      },
      ordinalParse: /\d{1,2}(||)/,
      ordinal: function (a, b) {
        switch (b) {
          case"d":
          case"D":
          case"DDD":
            return a + "";
          case"M":
            return a + "";
          case"w":
          case"W":
            return a + "";
          default:
            return a
        }
      },
      relativeTime: {
        future: "%s",
        past: "%s",
        s: "",
        m: "1",
        mm: "%d",
        h: "1",
        hh: "%d",
        d: "1",
        dd: "%d",
        M: "1",
        MM: "%d",
        y: "1",
        yy: "%d"
      },
      week: {dow: 1, doy: 4}
    }), a.confiFormsCalendar.datepickerLang("zh-cn", "zh-CN", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "yy-mm-dd",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !0,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("zh-cn", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: "",
      eventLimitText: function (a) {
        return " " + a + " "
      }
    })
  }(), function () {
    (b.defineLocale || b.lang).call(b, "zh-tw", {
      months: "___________".split("_"),
      monthsShort: "1_2_3_4_5_6_7_8_9_10_11_12".split("_"),
      weekdays: "______".split("_"),
      weekdaysShort: "______".split("_"),
      weekdaysMin: "______".split("_"),
      longDateFormat: {
        LT: "Ahmm",
        LTS: "Ahms",
        L: "YYYYMMMD",
        LL: "YYYYMMMD",
        LLL: "YYYYMMMDLT",
        LLLL: "YYYYMMMDddddLT",
        l: "YYYYMMMD",
        ll: "YYYYMMMD",
        lll: "YYYYMMMDLT",
        llll: "YYYYMMMDddddLT"
      },
      meridiemParse: /||||/,
      meridiemHour: function (a, b) {
        return 12 === a && (a = 0), "" === b || "" === b ? a : "" === b ? a >= 11 ? a : a + 12 : "" === b || "" === b ? a + 12 : void 0
      },
      meridiem: function (a, b, c) {
        var d = 100 * a + b;
        return 900 > d ? "" : 1130 > d ? "" : 1230 > d ? "" : 1800 > d ? "" : ""
      },
      calendar: {
        sameDay: "[]LT",
        nextDay: "[]LT",
        nextWeek: "[]ddddLT",
        lastDay: "[]LT",
        lastWeek: "[]ddddLT",
        sameElse: "L"
      },
      ordinalParse: /\d{1,2}(||)/,
      ordinal: function (a, b) {
        switch (b) {
          case"d":
          case"D":
          case"DDD":
            return a + "";
          case"M":
            return a + "";
          case"w":
          case"W":
            return a + "";
          default:
            return a
        }
      },
      relativeTime: {
        future: "%s",
        past: "%s",
        s: "",
        m: "",
        mm: "%d",
        h: "",
        hh: "%d",
        d: "",
        dd: "%d",
        M: "",
        MM: "%d",
        y: "",
        yy: "%d"
      }
    }), a.confiFormsCalendar.datepickerLang("zh-tw", "zh-TW", {
      closeText: "",
      prevText: "&#x3C;",
      nextText: "&#x3E;",
      currentText: "",
      monthNames: ["", "", "", "", "", "", "", "", "", "", "", ""],
      monthNamesShort: ["", "", "", "", "", "", "", "", "", "", "", ""],
      dayNames: ["", "", "", "", "", "", ""],
      dayNamesShort: ["", "", "", "", "", "", ""],
      dayNamesMin: ["", "", "", "", "", "", ""],
      weekHeader: "",
      dateFormat: "yy/mm/dd",
      firstDay: 1,
      isRTL: !1,
      showMonthAfterYear: !0,
      yearSuffix: ""
    }), a.confiFormsCalendar.lang("zh-tw", {
      buttonText: {month: "", week: "", day: "", list: ""},
      allDayText: "",
      eventLimitText: ""
    })
  }(), (b.locale || b.lang).call(b, "en"), a.confiFormsCalendar.lang("en"), a.datepicker && a.datepicker.setDefaults(a.datepicker.regional[""])
});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/jquery.datetimepicker.js' */
/*!
 * @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2014 - 2015
 * @version 1.3.3
 *
 * Date formatter utility library that allows formatting date/time variables or Date objects using PHP DateTime format.
 * @see http://php.net/manual/en/function.date.php
 *
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */

function overrideMonthNamesInCFPicker() {
  // short months for de locale have a dot at the end which makes java simpledateformat parser nuts
  if (confimoment.lang() == 'de') {
    confimoment.lang('de', {
      monthsShort: "Jan_Feb_Mr_Apr_Mai_Jun_Jul_Aug_Sep_Okt_Nov_Dez".split("_")
    });
  }
  if (confimoment.lang() == 'es') {
    confimoment.lang('es', {
      monthsShort: function (a, b) {
        return "ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_")[a.month()];
      }
    });
  }
  if (confimoment.lang() == 'ja') {
    confimoment.lang('ja', {
      monthsShort: [
        "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"
      ]
    });
  }
}

var DateFormatter;
(function () {
  "use strict";

  var _compare, _lpad, _extend, defaultSettings, DAY, HOUR;
  DAY = 1000 * 60 * 60 * 24;
  HOUR = 3600;

  _compare = function (str1, str2) {
    return typeof(str1) === 'string' && typeof(str2) === 'string' && str1.toLowerCase() === str2.toLowerCase();
  };
  _lpad = function (value, length, char) {
    var chr = char || '0', val = value.toString();
    return val.length < length ? _lpad(chr + val, length) : val;
  };
  _extend = function (out) {
    var i, obj;
    out = out || {};
    for (i = 1; i < arguments.length; i++) {
      obj = arguments[i];
      if (!obj) {
        continue;
      }
      for (var key in obj) {
        if (obj.hasOwnProperty(key)) {
          if (typeof obj[key] === 'object') {
            _extend(out[key], obj[key]);
          } else {
            out[key] = obj[key];
          }
        }
      }
    }
    return out;
  };
  defaultSettings = {
    dateSettings: {
      days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
      daysShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
      months: [
        'January', 'February', 'March', 'April', 'May', 'June', 'July',
        'August', 'September', 'October', 'November', 'December'
      ],
      monthsShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
      meridiem: ['AM', 'PM'],
      ordinal: function (number) {
        var n = number % 10, suffixes = {1: 'st', 2: 'nd', 3: 'rd'};
        return Math.floor(number % 100 / 10) === 1 || !suffixes[n] ? 'th' : suffixes[n];
      }
    },
    separators: /[ \-+\/\.T:@]/g,
    validParts: /[dDjlNSwzWFmMntLoYyaABgGhHisueTIOPZcrU]/g,
    intParts: /[djwNzmnyYhHgGis]/g,
    tzParts: /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,
    tzClip: /[^-+\dA-Z]/g
  };

  DateFormatter = function (options) {
    var self = this, config = _extend(defaultSettings, options);
    self.dateSettings = config.dateSettings;
    self.separators = config.separators;
    self.validParts = config.validParts;
    self.intParts = config.intParts;
    self.tzParts = config.tzParts;
    self.tzClip = config.tzClip;
  };

  DateFormatter.prototype = {
    constructor: DateFormatter,
    parseDate: function (vDate, vFormat) {
      if (!vDate) {
        return undefined;
      }
      if (vDate instanceof Date) {
        return vDate;
      }
      if (typeof vDate === 'number') {
        return new Date(vDate);
      }

      overrideMonthNamesInCFPicker();
      return confimoment(vDate, toMomentFormatString(vFormat)).toDate();
    },
    formatDate: function (vDate, vFormat) {
      if (typeof vDate === 'string') {
        vDate = self.parseDate(vDate, vFormat);
        if (vDate === false) {
          return false;
        }
      }
      if (vDate instanceof Date) {
        overrideMonthNamesInCFPicker();

        return confimoment(vDate).format(toMomentFormatString(vFormat));
      }
      return '';
    }
  };
})();
/* global DateFormatter */
/**
 * @preserve jQuery DateTimePicker plugin v2.4.5
 * @homepage http://xdsoft.net/jqplugins/datetimepicker/
 * (c) 2014, Chupurnov Valeriy.
 */
/*global document,window,jQuery,setTimeout,clearTimeout,HighlightedDate,getCurrentValue*/
;(function (factory) {
  if (typeof define === 'function' && define.amd) {
    // AMD. Register as an anonymous module.
    define(['jquery', 'jquery-mousewheel', 'date-functions'], factory);
  } else if (typeof exports === 'object') {
    // Node/CommonJS style for Browserify
    module.exports = factory;
  } else {
    // Browser globals
    factory(jQuery);
  }
}(function ($) {
  'use strict';
  var default_options = {
    i18n: {
      ar: { // Arabic
        months: [
          " ", "", "", "", "", "", "", "", "", " ", " ", " "
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", "", ""]
      },
      ro: { // Romanian
        months: [
          "Ianuarie", "Februarie", "Martie", "Aprilie", "Mai", "Iunie", "Iulie", "August", "Septembrie", "Octombrie", "Noiembrie", "Decembrie"
        ],
        dayOfWeekShort: [
          "Du", "Lu", "Ma", "Mi", "Jo", "Vi", "S"
        ],
        dayOfWeek: ["Duminic", "Luni", "Mari", "Miercuri", "Joi", "Vineri", "Smbt"]
      },
      id: { // Indonesian
        months: [
          "Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"
        ],
        dayOfWeekShort: [
          "Min", "Sen", "Sel", "Rab", "Kam", "Jum", "Sab"
        ],
        dayOfWeek: ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"]
      },
      is: { // Icelandic
        months: [
          "Janar", "Febrar", "Mars", "Aprl", "Ma", "Jn", "Jl", "gst", "September", "Oktber", "Nvember", "Desember"
        ],
        dayOfWeekShort: [
          "Sun", "Mn", "ri", "Mi", "Fim", "Fs", "Lau"
        ],
        dayOfWeek: ["Sunnudagur", "Mnudagur", "rijudagur", "Mivikudagur", "Fimmtudagur", "Fstudagur", "Laugardagur"]
      },
      bg: { // Bulgarian
        months: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      fa: { // Persian/Farsi
        months: [
          '', '', '', '', '', '', '', '', '', '', '', ''
        ],
        dayOfWeekShort: [
          '', '', ' ', '', '', '', ''
        ],
        dayOfWeek: ["", "", "", "", "", "", "", ""]
      },
      ru: { // Russian
        months: [
          '', '', '', '', '', '', '', '', '', '', '', ''
        ],
        shortMonths: [
          '', '', '', '', '', '', '', '', '', '', '', ''
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      uk: { // Ukrainian
        months: [
          '', '', '', '', '', '', '', '', '', '', '', ''
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "'", ""]
      },
      en: { // English
        months: [
          "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
        ],
        dayOfWeekShort: [
          "Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"
        ],
        dayOfWeek: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]
      },
      el: { // 
        months: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      de: { // German
        months: [
          'Januar', 'Februar', 'Mrz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'
        ],
        dayOfWeekShort: [
          "So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"
        ],
        dayOfWeek: ["Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"]
      },
      nl: { // Dutch
        months: [
          "januari", "februari", "maart", "april", "mei", "juni", "juli", "augustus", "september", "oktober", "november", "december"
        ],
        dayOfWeekShort: [
          "zo", "ma", "di", "wo", "do", "vr", "za"
        ],
        dayOfWeek: ["zondag", "maandag", "dinsdag", "woensdag", "donderdag", "vrijdag", "zaterdag"]
      },
      tr: { // Turkish
        months: [
          "Ocak", "ubat", "Mart", "Nisan", "Mays", "Haziran", "Temmuz", "Austos", "Eyll", "Ekim", "Kasm", "Aralk"
        ],
        dayOfWeekShort: [
          "Paz", "Pts", "Sal", "ar", "Per", "Cum", "Cts"
        ],
        dayOfWeek: ["Pazar", "Pazartesi", "Sal", "aramba", "Perembe", "Cuma", "Cumartesi"]
      },
      fr: { //French
        months: [
          "Janvier", "Fvrier", "Mars", "Avril", "Mai", "Juin", "Juillet", "Aot", "Septembre", "Octobre", "Novembre", "Dcembre"
        ],
        shortMonths: [
          "janv.", "fvr.", "mars", "avr.", "mai", "juin", "juil.", "aot", "sept.", "oct.", "nov.", "dc."
        ],
        dayOfWeekShort: [
          "Dim", "Lun", "Mar", "Mer", "Jeu", "Ven", "Sam"
        ],
        dayOfWeek: ["dimanche", "lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi"]
      },
      es: { // Spanish
        months: [
          "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"
        ],
        shortMonths: [
          "ene", "feb", "mar", "abr", "may", "jun", "jul", "ago", "sep", "oct", "nov", "dic"
        ],
        dayOfWeekShort: [
          "Dom", "Lun", "Mar", "Mi", "Jue", "Vie", "Sb"
        ],
        dayOfWeek: ["Domingo", "Lunes", "Martes", "Mircoles", "Jueves", "Viernes", "Sbado"]
      },
      th: { // Thai
        months: [
          '', '', '', '', '', '', '', '', '', '', '', ''
        ],
        dayOfWeekShort: [
          '.', '.', '.', '.', '.', '.', '.'
        ],
        dayOfWeek: ["", "", "", "", "", "", "", ""]
      },
      pl: { // Polish
        months: [
          "stycze", "luty", "marzec", "kwiecie", "maj", "czerwiec", "lipiec", "sierpie", "wrzesie", "padziernik", "listopad", "grudzie"
        ],
        dayOfWeekShort: [
          "nd", "pn", "wt", "r", "cz", "pt", "sb"
        ],
        dayOfWeek: ["niedziela", "poniedziaek", "wtorek", "roda", "czwartek", "pitek", "sobota"]
      },
      pt: { // Portuguese
        months: [
          "Janeiro", "Fevereiro", "Maro", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
        ],
        dayOfWeekShort: [
          "Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sab"
        ],
        dayOfWeek: ["Domingo", "Segunda", "Tera", "Quarta", "Quinta", "Sexta", "Sbado"]
      },
      ch: { // Simplified Chinese
        months: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        shortMonths: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ]
      },
      se: { // Swedish
        months: [
          "Januari", "Februari", "Mars", "April", "Maj", "Juni", "Juli", "Augusti", "September", "Oktober", "November", "December"
        ],
        dayOfWeekShort: [
          "Sn", "Mn", "Tis", "Ons", "Tor", "Fre", "Lr"
        ]
      },
      kr: { // Korean
        months: [
          "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"
        ],
        shortMonths: [
          "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      it: { // Italian
        months: [
          "Gennaio", "Febbraio", "Marzo", "Aprile", "Maggio", "Giugno", "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre"
        ],
        shortMonths: [
          "gen", "feb", "mar", "apr", "mag", "giu", "lug", "ago", "set", "ott", "nov", "dic"
        ],
        dayOfWeekShort: [
          "Dom", "Lun", "Mar", "Mer", "Gio", "Ven", "Sab"
        ],
        dayOfWeek: ["Domenica", "Luned", "Marted", "Mercoled", "Gioved", "Venerd", "Sabato"]
      },
      da: { // Dansk
        months: [
          "January", "Februar", "Marts", "April", "Maj", "Juni", "July", "August", "September", "Oktober", "November", "December"
        ],
        shortMonths: [
          "jan", "feb", "mar", "apr", "maj", "jun", "jul", "aug", "sep", "okt", "nov", "dec"
        ],
        dayOfWeekShort: [
          "Sn", "Man", "Tir", "Ons", "Tor", "Fre", "Lr"
        ],
        dayOfWeek: ["sndag", "mandag", "tirsdag", "onsdag", "torsdag", "fredag", "lrdag"]
      },
      no: { // Norwegian
        months: [
          "Januar", "Februar", "Mars", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Desember"
        ],
        shortMonths: [
          "jan", "feb", "mar", "apr", "mai", "jun", "jul", "aug", "sep", "okt", "nov", "des"
        ],
        dayOfWeekShort: [
          "Sn", "Man", "Tir", "Ons", "Tor", "Fre", "Lr"
        ],
        dayOfWeek: ['Sndag', 'Mandag', 'Tirsdag', 'Onsdag', 'Torsdag', 'Fredag', 'Lrdag']
      },
      ja: { // Japanese
        months: [
          "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"
        ],
        shortMonths: [
          "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      vi: { // Vietnamese
        months: [
          "Thng 1", "Thng 2", "Thng 3", "Thng 4", "Thng 5", "Thng 6", "Thng 7", "Thng 8", "Thng 9", "Thng 10", "Thng 11", "Thng 12"
        ],
        dayOfWeekShort: [
          "CN", "T2", "T3", "T4", "T5", "T6", "T7"
        ],
        dayOfWeek: ["Ch nht", "Th hai", "Th ba", "Th t", "Th nm", "Th su", "Th by"]
      },
      sl: { // Slovenina
        months: [
          "Januar", "Februar", "Marec", "April", "Maj", "Junij", "Julij", "Avgust", "September", "Oktober", "November", "December"
        ],
        dayOfWeekShort: [
          "Ned", "Pon", "Tor", "Sre", "et", "Pet", "Sob"
        ],
        dayOfWeek: ["Nedelja", "Ponedeljek", "Torek", "Sreda", "etrtek", "Petek", "Sobota"]
      },
      cs: { // etina
        months: [
          "Leden", "nor", "Bezen", "Duben", "Kvten", "erven", "ervenec", "Srpen", "Z", "jen", "Listopad", "Prosinec"
        ],
        dayOfWeekShort: [
          "Ne", "Po", "t", "St", "t", "P", "So"
        ]
      },
      hu: { // Hungarian
        months: [
          "Janur", "Februr", "Mrcius", "prilis", "Mjus", "Jnius", "Jlius", "Augusztus", "Szeptember", "Oktber", "November", "December"
        ],
        dayOfWeekShort: [
          "Va", "H", "Ke", "Sze", "Cs", "P", "Szo"
        ],
        dayOfWeek: ["vasrnap", "htf", "kedd", "szerda", "cstrtk", "pntek", "szombat"]
      },
      az: { //Azerbaijanian (Azeri)
        months: [
          "Yanvar", "Fevral", "Mart", "Aprel", "May", "Iyun", "Iyul", "Avqust", "Sentyabr", "Oktyabr", "Noyabr", "Dekabr"
        ],
        dayOfWeekShort: [
          "B", "Be", "a", "", "Ca", "C", ""
        ],
        dayOfWeek: ["Bazar", "Bazar ertsi", "rnb axam", "rnb", "Cm axam", "Cm", "nb"]
      },
      bs: { //Bosanski
        months: [
          "Januar", "Februar", "Mart", "April", "Maj", "Jun", "Jul", "Avgust", "Septembar", "Oktobar", "Novembar", "Decembar"
        ],
        dayOfWeekShort: [
          "Ned", "Pon", "Uto", "Sri", "et", "Pet", "Sub"
        ],
        dayOfWeek: ["Nedjelja", "Ponedjeljak", "Utorak", "Srijeda", "etvrtak", "Petak", "Subota"]
      },
      ca: { //Catal
        months: [
          "Gener", "Febrer", "Mar", "Abril", "Maig", "Juny", "Juliol", "Agost", "Setembre", "Octubre", "Novembre", "Desembre"
        ],
        dayOfWeekShort: [
          "Dg", "Dl", "Dt", "Dc", "Dj", "Dv", "Ds"
        ],
        dayOfWeek: ["Diumenge", "Dilluns", "Dimarts", "Dimecres", "Dijous", "Divendres", "Dissabte"]
      },
      'en-GB': { //English (British)
        months: [
          "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
        ],
        dayOfWeekShort: [
          "Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"
        ],
        dayOfWeek: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]
      },
      et: { //"Eesti"
        months: [
          "jaanuar", "veebruar", "mrts", "aprill", "mai", "juuni", "juuli", "august", "september", "oktoober", "november", "detsember"
        ],
        shortMonths: [
          "jaan", "veeb", "mrts", "apr", "mai", "juuni", "juuli", "aug", "sept", "okt", "nov", "dets"
        ],
        dayOfWeekShort: [
          "P", "E", "T", "K", "N", "R", "L"
        ],
        dayOfWeek: ["Phapev", "Esmaspev", "Teisipev", "Kolmapev", "Neljapev", "Reede", "Laupev"]
      },
      eu: { //Euskara
        months: [
          "Urtarrila", "Otsaila", "Martxoa", "Apirila", "Maiatza", "Ekaina", "Uztaila", "Abuztua", "Iraila", "Urria", "Azaroa", "Abendua"
        ],
        dayOfWeekShort: [
          "Ig.", "Al.", "Ar.", "Az.", "Og.", "Or.", "La."
        ],
        dayOfWeek: ['Igandea', 'Astelehena', 'Asteartea', 'Asteazkena', 'Osteguna', 'Ostirala', 'Larunbata']
      },
      fi: { //Finnish (Suomi)
        months: [
          "Tammikuu", "Helmikuu", "Maaliskuu", "Huhtikuu", "Toukokuu", "Keskuu", "Heinkuu", "Elokuu", "Syyskuu", "Lokakuu", "Marraskuu", "Joulukuu"
        ],
        dayOfWeekShort: [
          "Su", "Ma", "Ti", "Ke", "To", "Pe", "La"
        ],
        dayOfWeek: ["sunnuntai", "maanantai", "tiistai", "keskiviikko", "torstai", "perjantai", "lauantai"]
      },
      gl: { //Galego
        months: [
          "Xan", "Feb", "Maz", "Abr", "Mai", "Xun", "Xul", "Ago", "Set", "Out", "Nov", "Dec"
        ],
        dayOfWeekShort: [
          "Dom", "Lun", "Mar", "Mer", "Xov", "Ven", "Sab"
        ],
        dayOfWeek: ["Domingo", "Luns", "Martes", "Mrcores", "Xoves", "Venres", "Sbado"]
      },
      hr: { //Hrvatski
        months: [
          "Sijeanj", "Veljaa", "Oujak", "Travanj", "Svibanj", "Lipanj", "Srpanj", "Kolovoz", "Rujan", "Listopad", "Studeni", "Prosinac"
        ],
        dayOfWeekShort: [
          "Ned", "Pon", "Uto", "Sri", "et", "Pet", "Sub"
        ],
        dayOfWeek: ["Nedjelja", "Ponedjeljak", "Utorak", "Srijeda", "etvrtak", "Petak", "Subota"]
      },
      ko: { //Korean ()
        months: [
          "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      lt: { //Lithuanian (lietuvi)
        months: [
          "Sausio", "Vasario", "Kovo", "Balandio", "Gegus", "Birelio", "Liepos", "Rugpjio", "Rugsjo", "Spalio", "Lapkriio", "Gruodio"
        ],
        dayOfWeekShort: [
          "Sek", "Pir", "Ant", "Tre", "Ket", "Pen", "e"
        ],
        dayOfWeek: ["Sekmadienis", "Pirmadienis", "Antradienis", "Treiadienis", "Ketvirtadienis", "Penktadienis", "etadienis"]
      },
      lv: { //Latvian (Latvieu)
        months: [
          "Janvris", "Februris", "Marts", "Aprlis ", "Maijs", "Jnijs", "Jlijs", "Augusts", "Septembris", "Oktobris", "Novembris", "Decembris"
        ],
        dayOfWeekShort: [
          "Sv", "Pr", "Ot", "Tr", "Ct", "Pk", "St"
        ],
        dayOfWeek: ["Svtdiena", "Pirmdiena", "Otrdiena", "Trediena", "Ceturtdiena", "Piektdiena", "Sestdiena"]
      },
      mk: { //Macedonian ()
        months: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      mn: { //Mongolian ()
        months: [
          "1- ", "2- ", "3- ", "4- ", "5- ", "6- ", "7- ", "8- ", "9- ", "10- ", "11- ", "12- "
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      'pt-BR': { //Portugus(Brasil)
        months: [
          "Janeiro", "Fevereiro", "Maro", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
        ],
        dayOfWeekShort: [
          "Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sb"
        ],
        dayOfWeek: ["Domingo", "Segunda", "Tera", "Quarta", "Quinta", "Sexta", "Sbado"]
      },
      sk: { //Slovenina
        months: [
          "Janur", "Februr", "Marec", "Aprl", "Mj", "Jn", "Jl", "August", "September", "Oktber", "November", "December"
        ],
        dayOfWeekShort: [
          "Ne", "Po", "Ut", "St", "t", "Pi", "So"
        ],
        dayOfWeek: ["Nedea", "Pondelok", "Utorok", "Streda", "tvrtok", "Piatok", "Sobota"]
      },
      sq: { //Albanian (Shqip)
        months: [
          "Janar", "Shkurt", "Mars", "Prill", "Maj", "Qershor", "Korrik", "Gusht", "Shtator", "Tetor", "Nntor", "Dhjetor"
        ],
        dayOfWeekShort: [
          "Die", "Hn", "Mar", "Mr", "Enj", "Pre", "Shtu"
        ],
        dayOfWeek: ["E Diel", "E Hn", "E Mart", "E Mrkur", "E Enjte", "E Premte", "E Shtun"]
      },
      'sr-YU': { //Serbian (Srpski)
        months: [
          "Januar", "Februar", "Mart", "April", "Maj", "Jun", "Jul", "Avgust", "Septembar", "Oktobar", "Novembar", "Decembar"
        ],
        dayOfWeekShort: [
          "Ned", "Pon", "Uto", "Sre", "et", "Pet", "Sub"
        ],
        dayOfWeek: ["Nedelja", "Ponedeljak", "Utorak", "Sreda", "etvrtak", "Petak", "Subota"]
      },
      sr: { //Serbian Cyrillic ()
        months: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      sv: { //Svenska
        months: [
          "Januari", "Februari", "Mars", "April", "Maj", "Juni", "Juli", "Augusti", "September", "Oktober", "November", "December"
        ],
        dayOfWeekShort: [
          "Sn", "Mn", "Tis", "Ons", "Tor", "Fre", "Lr"
        ],
        dayOfWeek: ["Sndag", "Mndag", "Tisdag", "Onsdag", "Torsdag", "Fredag", "Lrdag"]
      },
      'zh-TW': { //Traditional Chinese ()
        months: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      zh: { //Simplified Chinese ()
        months: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      he: { //Hebrew ()
        months: [
          '', '', '', '', '', '', '', '', '', '', '', ''
        ],
        dayOfWeekShort: [
          '\'', '\'', '\'', '\'', '\'', '\'', ''
        ],
        dayOfWeek: ["", "", "", "", "", "", "", ""]
      },
      hy: { // Armenian
        months: [
          "", "", "", "", "", "", "", "", "", "", "", ""
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: ["", "", "", "", "", "", ""]
      },
      kg: { // Kyrgyz
        months: [
          ' ', ' ', ' ', ' ', '', '', '', ' ', ' ', ' ', ' ', ' '
        ],
        dayOfWeekShort: [
          "", "", "", "", "", "", ""
        ],
        dayOfWeek: [
          "", "", "", "", "", "", ""
        ]
      },
      rm: { // Romansh
        months: [
          "Schaner", "Favrer", "Mars", "Avrigl", "Matg", "Zercladur", "Fanadur", "Avust", "Settember", "October", "November", "December"
        ],
        dayOfWeekShort: [
          "Du", "Gli", "Ma", "Me", "Gie", "Ve", "So"
        ],
        dayOfWeek: [
          "Dumengia", "Glindesdi", "Mardi", "Mesemna", "Gievgia", "Venderdi", "Sonda"
        ]
      },
    },
    value: '',
    rtl: false,

    format: 'Y/m/d H:i',
    formatTime: 'H:i',
    formatDate: 'Y/m/d',

    startDate: false, // new Date(), '1986/12/08', '-1970/01/05','-1970/01/05',
    step: 60,
    monthChangeSpinner: true,

    closeOnDateSelect: false,
    closeOnTimeSelect: true,
    closeOnWithoutClick: true,
    closeOnInputClick: true,

    timepicker: true,
    datepicker: true,
    weeks: false,

    defaultTime: false,	// use formatTime format (ex. '10:00' for formatTime:	'H:i')
    defaultDate: false,	// use formatDate format (ex new Date() or '1986/12/08' or '-1970/01/05' or '-1970/01/05')

    minDate: false,
    maxDate: false,
    minTime: false,
    maxTime: false,
    disabledMinTime: false,
    disabledMaxTime: false,

    allowTimes: [],
    opened: false,
    initTime: true,
    inline: false,
    theme: '',

    onSelectDate: function () {
    },
    onSelectTime: function () {
    },
    onChangeMonth: function () {
    },
    onChangeYear: function () {
    },
    onChangeDateTime: function () {
    },
    onShow: function () {
    },
    onClose: function () {
    },
    onGenerate: function () {
    },

    withoutCopyright: true,
    inverseButton: false,
    hours12: false,
    next: 'xdsoft_next',
    prev: 'xdsoft_prev',
    dayOfWeekStart: 0,
    parentID: 'body',
    timeHeightInTimePicker: 25,
    timepickerScrollbar: true,
    todayButton: true,
    prevButton: true,
    nextButton: true,
    defaultSelect: true,

    scrollMonth: true,
    scrollTime: true,
    scrollInput: true,

    lazyInit: false,
    mask: false,
    validateOnBlur: true,
    allowBlank: true,
    yearStart: 1950,
    yearEnd: 2050,
    monthStart: 0,
    monthEnd: 11,
    style: '',
    id: '',
    fixed: false,
    roundTime: 'round', // ceil, floor
    className: '',
    weekends: [],
    highlightedDates: [],
    highlightedPeriods: [],
    disabledDates: [],
    disabledWeekDays: [],
    yearOffset: 0,
    beforeShowDay: null,

    enterLikeTab: true,
    showApplyButton: false
  };

  var dateHelper = null,
    globalLocaleDefault = 'en',
    globalLocale = 'en';

  var dateFormatterOptionsDefault = {
    meridiem: ['AM', 'PM']
  };

  var initDateFormatter = function () {
    var locale = default_options.i18n[globalLocale],
      opts = {
        days: locale.dayOfWeek,
        daysShort: locale.dayOfWeekShort,
        months: locale.months,
        monthsShort: locale.shortMonths != null ? locale.shortMonths : $.map(locale.months, function (n) {
          return n.substring(0, 3)
        }),
      };

    dateHelper = new DateFormatter({
      dateSettings: $.extend({}, dateFormatterOptionsDefault, opts)
    });
  };

  // for locale settings
  $.confidatetimepicker = {
    setLocale: function (locale) {
      var newLocale = default_options.i18n[locale] ? locale : globalLocaleDefault;
      if (globalLocale != newLocale) {
        globalLocale = newLocale;

        if (confimoment != null) {
          confimoment.lang(globalLocale);
        }

        // reinit date formatter
        initDateFormatter();
      }
    },
    RFC_2822: 'D, d M Y H:i:s O',
    ATOM: 'Y-m-d\TH:i:sP',
    ISO_8601: 'Y-m-d\TH:i:sO',
    RFC_822: 'D, d M y H:i:s O',
    RFC_850: 'l, d-M-y H:i:s T',
    RFC_1036: 'D, d M y H:i:s O',
    RFC_1123: 'D, d M Y H:i:s O',
    RSS: 'D, d M Y H:i:s O',
    W3C: 'Y-m-d\TH:i:sP'
  };

  // first init date formatter
  initDateFormatter();

  // fix for ie8
  if (!window.getComputedStyle) {
    window.getComputedStyle = function (el, pseudo) {
      this.el = el;
      this.getPropertyValue = function (prop) {
        var re = /(\-([a-z]){1})/g;
        if (prop === 'float') {
          prop = 'styleFloat';
        }
        if (re.test(prop)) {
          prop = prop.replace(re, function (a, b, c) {
            return c.toUpperCase();
          });
        }
        return el.currentStyle[prop] || null;
      };
      return this;
    };
  }
  if (!Array.prototype.indexOf) {
    Array.prototype.indexOf = function (obj, start) {
      var i, j;
      for (i = (start || 0), j = this.length; i < j; i += 1) {
        if (this[i] === obj) {
          return i;
        }
      }
      return -1;
    };
  }
  Date.prototype.countDaysInMonth = function () {
    return new Date(this.getFullYear(), this.getMonth() + 1, 0).getDate();
  };
  $.fn.xdsoftScroller = function (percent) {
    return this.each(function () {
      var timeboxparent = $(this),
        pointerEventToXY = function (e) {
          var out = {x: 0, y: 0},
            touch;
          if (e.type === 'touchstart' || e.type === 'touchmove' || e.type === 'touchend' || e.type === 'touchcancel') {
            touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];
            out.x = touch.clientX;
            out.y = touch.clientY;
          } else if (e.type === 'mousedown' || e.type === 'mouseup' || e.type === 'mousemove' || e.type === 'mouseover' || e.type === 'mouseout' || e.type === 'mouseenter' || e.type === 'mouseleave') {
            out.x = e.clientX;
            out.y = e.clientY;
          }
          return out;
        },
        move = 0,
        timebox,
        parentHeight,
        height,
        scrollbar,
        scroller,
        maximumOffset = 100,
        start = false,
        startY = 0,
        startTop = 0,
        h1 = 0,
        touchStart = false,
        startTopScroll = 0,
        calcOffset = function () {
        };
      if (percent === 'hide') {
        timeboxparent.find('.xdsoft_scrollbar').hide();
        return;
      }
      if (!$(this).hasClass('xdsoft_scroller_box')) {
        timebox = timeboxparent.children().eq(0);
        parentHeight = timeboxparent[0].clientHeight;
        height = timebox[0].offsetHeight;
        scrollbar = $('<div class="xdsoft_scrollbar"></div>');
        scroller = $('<div class="xdsoft_scroller"></div>');
        scrollbar.append(scroller);

        timeboxparent.addClass('xdsoft_scroller_box').append(scrollbar);
        calcOffset = function calcOffset(event) {
          var offset = pointerEventToXY(event).y - startY + startTopScroll;
          if (offset < 0) {
            offset = 0;
          }
          if (offset + scroller[0].offsetHeight > h1) {
            offset = h1 - scroller[0].offsetHeight;
          }
          timeboxparent.trigger('scroll_element.xdsoft_scroller', [maximumOffset ? offset / maximumOffset : 0]);
        };

        scroller
          .on('touchstart.xdsoft_scroller mousedown.xdsoft_scroller', function (event) {
            if (!parentHeight) {
              timeboxparent.trigger('resize_scroll.xdsoft_scroller', [percent]);
            }

            startY = pointerEventToXY(event).y;
            startTopScroll = parseInt(scroller.css('margin-top'), 10);
            h1 = scrollbar[0].offsetHeight;

            if (event.type === 'mousedown' || event.type === 'touchstart') {
              if (document) {
                $(document.body).addClass('xdsoft_noselect');
              }
              $([document.body, window]).on('touchend mouseup.xdsoft_scroller', function arguments_callee() {
                $([document.body, window]).off('touchend mouseup.xdsoft_scroller', arguments_callee)
                  .off('mousemove.xdsoft_scroller', calcOffset)
                  .removeClass('xdsoft_noselect');
              });
              $(document.body).on('mousemove.xdsoft_scroller', calcOffset);
            } else {
              touchStart = true;
              event.stopPropagation();
              event.preventDefault();
            }
          })
          .on('touchmove', function (event) {
            if (touchStart) {
              event.preventDefault();
              calcOffset(event);
            }
          })
          .on('touchend touchcancel', function (event) {
            touchStart = false;
            startTopScroll = 0;
          });

        timeboxparent
          .on('scroll_element.xdsoft_scroller', function (event, percentage) {
            if (!parentHeight) {
              timeboxparent.trigger('resize_scroll.xdsoft_scroller', [percentage, true]);
            }
            percentage = percentage > 1 ? 1 : (percentage < 0 || isNaN(percentage)) ? 0 : percentage;

            scroller.css('margin-top', maximumOffset * percentage);

            setTimeout(function () {
              timebox.css('marginTop', -parseInt((timebox[0].offsetHeight - parentHeight) * percentage, 10));
            }, 10);
          })
          .on('resize_scroll.xdsoft_scroller', function (event, percentage, noTriggerScroll) {
            var percent, sh;
            parentHeight = timeboxparent[0].clientHeight;
            height = timebox[0].offsetHeight;
            percent = parentHeight / height;
            sh = percent * scrollbar[0].offsetHeight;
            if (percent > 1) {
              scroller.hide();
            } else {
              scroller.show();
              scroller.css('height', parseInt(sh > 10 ? sh : 10, 10));
              maximumOffset = scrollbar[0].offsetHeight - scroller[0].offsetHeight;
              if (noTriggerScroll !== true) {
                timeboxparent.trigger('scroll_element.xdsoft_scroller', [percentage || Math.abs(parseInt(timebox.css('marginTop'), 10)) / (height - parentHeight)]);
              }
            }
          });

        timeboxparent.on('mousewheel', function (event) {
          var top = Math.abs(parseInt(timebox.css('marginTop'), 10));

          top = top - (event.deltaY * 20);
          if (top < 0) {
            top = 0;
          }

          timeboxparent.trigger('scroll_element.xdsoft_scroller', [top / (height - parentHeight)]);
          event.stopPropagation();
          return false;
        });

        timeboxparent.on('touchstart', function (event) {
          start = pointerEventToXY(event);
          startTop = Math.abs(parseInt(timebox.css('marginTop'), 10));
        });

        timeboxparent.on('touchmove', function (event) {
          if (start) {
            event.preventDefault();
            var coord = pointerEventToXY(event);
            timeboxparent.trigger('scroll_element.xdsoft_scroller', [(startTop - (coord.y - start.y)) / (height - parentHeight)]);
          }
        });

        timeboxparent.on('touchend touchcancel', function (event) {
          start = false;
          startTop = 0;
        });
      }
      timeboxparent.trigger('resize_scroll.xdsoft_scroller', [percent]);
    });
  };

  $.fn.confidatetimepicker = function (opt) {
    var KEY0 = 48,
      KEY9 = 57,
      _KEY0 = 96,
      _KEY9 = 105,
      CTRLKEY = 17,
      DEL = 46,
      ENTER = 13,
      ESC = 27,
      BACKSPACE = 8,
      ARROWLEFT = 37,
      ARROWUP = 38,
      ARROWRIGHT = 39,
      ARROWDOWN = 40,
      TAB = 9,
      F5 = 116,
      AKEY = 65,
      CKEY = 67,
      VKEY = 86,
      ZKEY = 90,
      YKEY = 89,
      ctrlDown = false,
      options = ($.isPlainObject(opt) || !opt) ? $.extend(true, {}, default_options, opt) : $.extend(true, {}, default_options),

      lazyInitTimer = 0,
      createDateTimePicker,
      destroyDateTimePicker,

      lazyInit = function (input) {
        input
          .on('open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart', function initOnActionCallback(event) {
            if (input.is(':disabled') || input.data('xdsoft_datetimepicker')) {
              return;
            }
            clearTimeout(lazyInitTimer);
            lazyInitTimer = setTimeout(function () {

              if (!input.data('xdsoft_datetimepicker')) {
                createDateTimePicker(input);
              }
              input
                .off('open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart', initOnActionCallback)
                .trigger('open.xdsoft');
            }, 100);
          });
      };

    createDateTimePicker = function (input) {
      var datetimepicker = $('<div class="xdsoft_datetimepicker xdsoft_noselect"></div>'),
        xdsoft_copyright = $('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),
        datepicker = $('<div class="xdsoft_datepicker active"></div>'),
        mounth_picker = $('<div class="xdsoft_mounthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button>' +
          '<div class="xdsoft_label xdsoft_month"><span></span><i></i></div>' +
          '<div class="xdsoft_label xdsoft_year"><span></span><i></i></div>' +
          '<button type="button" class="xdsoft_next"></button></div>'),
        calendar = $('<div class="xdsoft_calendar"></div>'),
        timepicker = $('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),
        timeboxparent = timepicker.find('.xdsoft_time_box').eq(0),
        timebox = $('<div class="xdsoft_time_variant"></div>'),
        applyButton = $('<button type="button" class="xdsoft_save_selected blue-gradient-button">Save Selected</button>'),
      /*scrollbar = $('<div class="xdsoft_scrollbar"></div>'),
       scroller = $('<div class="xdsoft_scroller"></div>'),*/
        monthselect = $('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>'),
        yearselect = $('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>'),
        triggerAfterOpen = false,
        XDSoft_datetime,
      //scroll_element,
        xchangeTimer,
        timerclick,
        current_time_index,
        setPos,
        timer = 0,
        timer1 = 0,
        _xdsoft_datetime;

      if (options.id) {
        datetimepicker.attr('id', options.id);
      }
      if (options.style) {
        datetimepicker.attr('style', options.style);
      }
      if (options.weeks) {
        datetimepicker.addClass('xdsoft_showweeks');
      }
      if (options.rtl) {
        datetimepicker.addClass('xdsoft_rtl');
      }

      datetimepicker.addClass('xdsoft_' + options.theme);
      datetimepicker.addClass(options.className);

      mounth_picker
        .find('.xdsoft_month span')
        .after(monthselect);
      mounth_picker
        .find('.xdsoft_year span')
        .after(yearselect);

      mounth_picker
        .find('.xdsoft_month,.xdsoft_year')
        .on('touchstart mousedown.xdsoft', function (event) {
          var select = $(this).find('.xdsoft_select').eq(0),
            val = 0,
            top = 0,
            visible = select.is(':visible'),
            items,
            i;

          mounth_picker
            .find('.xdsoft_select')
            .hide();
          if (_xdsoft_datetime.currentTime) {
            val = _xdsoft_datetime.currentTime[$(this).hasClass('xdsoft_month') ? 'getMonth' : 'getFullYear']();
          }

          select[visible ? 'hide' : 'show']();
          for (items = select.find('div.xdsoft_option'), i = 0; i < items.length; i += 1) {
            if (items.eq(i).data('value') === val) {
              break;
            } else {
              top += items[0].offsetHeight;
            }
          }

          select.xdsoftScroller(top / (select.children()[0].offsetHeight - (select[0].clientHeight)));
          event.stopPropagation();
          return false;
        });

      mounth_picker
        .find('.xdsoft_select')
        .xdsoftScroller()
        .on('touchstart mousedown.xdsoft', function (event) {
          event.stopPropagation();
          event.preventDefault();
        })
        .on('touchstart mousedown.xdsoft', '.xdsoft_option', function (event) {
          if (_xdsoft_datetime.currentTime === undefined || _xdsoft_datetime.currentTime === null) {
            _xdsoft_datetime.currentTime = _xdsoft_datetime.now();
          }

          var year = _xdsoft_datetime.currentTime.getFullYear();
          if (_xdsoft_datetime && _xdsoft_datetime.currentTime) {
            _xdsoft_datetime.currentTime[$(this).parent().parent().hasClass('xdsoft_monthselect') ? 'setMonth' : 'setFullYear']($(this).data('value'));
          }

          $(this).parent().parent().hide();

          datetimepicker.trigger('xchange.xdsoft');
          if (options.onChangeMonth && $.isFunction(options.onChangeMonth)) {
            options.onChangeMonth.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'));
          }

          if (year !== _xdsoft_datetime.currentTime.getFullYear() && $.isFunction(options.onChangeYear)) {
            options.onChangeYear.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'));
          }
        });

      datetimepicker.setOptions = function (_options) {
        var highlightedDates = {},
          getCaretPos = function (input) {
            try {
              if (document.selection && document.selection.createRange) {
                var range = document.selection.createRange();
                return range.getBookmark().charCodeAt(2) - 2;
              }
              if (input.setSelectionRange) {
                return input.selectionStart;
              }
            } catch (e) {
              return 0;
            }
          },
          setCaretPos = function (node, pos) {
            node = (typeof node === "string" || node instanceof String) ? document.getElementById(node) : node;
            if (!node) {
              return false;
            }
            if (node.createTextRange) {
              var textRange = node.createTextRange();
              textRange.collapse(true);
              textRange.moveEnd('character', pos);
              textRange.moveStart('character', pos);
              textRange.select();
              return true;
            }
            if (node.setSelectionRange) {
              node.setSelectionRange(pos, pos);
              return true;
            }
            return false;
          },
          isValidValue = function (mask, value) {
            var reg = mask
              .replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g, '\\$1')
              .replace(/_/g, '{digit+}')
              .replace(/([0-9]{1})/g, '{digit$1}')
              .replace(/\{digit([0-9]{1})\}/g, '[0-$1_]{1}')
              .replace(/\{digit[\+]\}/g, '[0-9_]{1}');
            return (new RegExp(reg)).test(value);
          };
        options = $.extend(true, {}, options, _options);

        if (_options.allowTimes && $.isArray(_options.allowTimes) && _options.allowTimes.length) {
          options.allowTimes = $.extend(true, [], _options.allowTimes);
        }

        if (_options.weekends && $.isArray(_options.weekends) && _options.weekends.length) {
          options.weekends = $.extend(true, [], _options.weekends);
        }

        if (_options.highlightedDates && $.isArray(_options.highlightedDates) && _options.highlightedDates.length) {
          $.each(_options.highlightedDates, function (index, value) {
            var splitData = $.map(value.split(','), $.trim),
              exDesc,
              hDate = new HighlightedDate(dateHelper.parseDate(splitData[0], options.formatDate), splitData[1], splitData[2]), // date, desc, style
              keyDate = dateHelper.formatDate(hDate.date, options.formatDate);
            if (highlightedDates[keyDate] !== undefined) {
              exDesc = highlightedDates[keyDate].desc;
              if (exDesc && exDesc.length && hDate.desc && hDate.desc.length) {
                highlightedDates[keyDate].desc = exDesc + "\n" + hDate.desc;
              }
            } else {
              highlightedDates[keyDate] = hDate;
            }
          });

          options.highlightedDates = $.extend(true, [], highlightedDates);
        }

        if (_options.highlightedPeriods && $.isArray(_options.highlightedPeriods) && _options.highlightedPeriods.length) {
          highlightedDates = $.extend(true, [], options.highlightedDates);
          $.each(_options.highlightedPeriods, function (index, value) {
            var dateTest, // start date
              dateEnd,
              desc,
              hDate,
              keyDate,
              exDesc,
              style;
            if ($.isArray(value)) {
              dateTest = value[0];
              dateEnd = value[1];
              desc = value[2];
              style = value[3];
            }
            else {
              var splitData = $.map(value.split(','), $.trim);
              dateTest = dateHelper.parseDate(splitData[0], options.formatDate);
              dateEnd = dateHelper.parseDate(splitData[1], options.formatDate);
              desc = splitData[2];
              style = splitData[3];
            }

            while (dateTest <= dateEnd) {
              hDate = new HighlightedDate(dateTest, desc, style);
              keyDate = dateHelper.formatDate(dateTest, options.formatDate);
              dateTest.setDate(dateTest.getDate() + 1);
              if (highlightedDates[keyDate] !== undefined) {
                exDesc = highlightedDates[keyDate].desc;
                if (exDesc && exDesc.length && hDate.desc && hDate.desc.length) {
                  highlightedDates[keyDate].desc = exDesc + "\n" + hDate.desc;
                }
              } else {
                highlightedDates[keyDate] = hDate;
              }
            }
          });

          options.highlightedDates = $.extend(true, [], highlightedDates);
        }

        if (_options.disabledDates && $.isArray(_options.disabledDates) && _options.disabledDates.length) {
          options.disabledDates = $.extend(true, [], _options.disabledDates);
        }

        if (_options.disabledWeekDays && $.isArray(_options.disabledWeekDays) && _options.disabledWeekDays.length) {
          options.disabledWeekDays = $.extend(true, [], _options.disabledWeekDays);
        }

        if ((options.open || options.opened) && (!options.inline)) {
          input.trigger('open.xdsoft');
        }

        if (options.inline) {
          triggerAfterOpen = true;
          datetimepicker.addClass('xdsoft_inline');
          input.after(datetimepicker).hide();
        }

        if (options.inverseButton) {
          options.next = 'xdsoft_prev';
          options.prev = 'xdsoft_next';
        }

        if (options.datepicker) {
          datepicker.addClass('active');
        } else {
          datepicker.removeClass('active');
        }

        if (options.timepicker) {
          timepicker.addClass('active');
        } else {
          timepicker.removeClass('active');
        }

        if (options.value) {
          _xdsoft_datetime.setCurrentTime(options.value);
          if (input && input.val) {
            input.val(_xdsoft_datetime.str);
          }
        }

        if (isNaN(options.dayOfWeekStart)) {
          options.dayOfWeekStart = 0;
        } else {
          options.dayOfWeekStart = parseInt(options.dayOfWeekStart, 10) % 7;
        }

        if (!options.timepickerScrollbar) {
          timeboxparent.xdsoftScroller('hide');
        }

        if (options.minDate && /^[\+\-](.*)$/.test(options.minDate)) {
          options.minDate = dateHelper.formatDate(_xdsoft_datetime.strToDateTime(options.minDate), options.formatDate);
        }

        if (options.maxDate && /^[\+\-](.*)$/.test(options.maxDate)) {
          options.maxDate = dateHelper.formatDate(_xdsoft_datetime.strToDateTime(options.maxDate), options.formatDate);
        }

        applyButton.toggle(options.showApplyButton);

        mounth_picker
          .find('.xdsoft_today_button')
          .css('visibility', !options.todayButton ? 'hidden' : 'visible');

        mounth_picker
          .find('.' + options.prev)
          .css('visibility', !options.prevButton ? 'hidden' : 'visible');

        mounth_picker
          .find('.' + options.next)
          .css('visibility', !options.nextButton ? 'hidden' : 'visible');

        if (options.mask) {
          input.off('keydown.xdsoft');

          if (options.mask === true) {
            options.mask = options.format
              .replace(/Y/g, '9999')
              .replace(/F/g, '9999')
              .replace(/m/g, '19')
              .replace(/d/g, '39')
              .replace(/H/g, '29')
              .replace(/i/g, '59')
              .replace(/s/g, '59');
          }

          if ($.type(options.mask) === 'string') {
            if (!isValidValue(options.mask, input.val())) {
              input.val(options.mask.replace(/[0-9]/g, '_'));
              setCaretPos(input[0], 0);
            }

            input.on('keydown.xdsoft', function (event) {
              var val = this.value,
                key = event.which,
                pos,
                digit;

              if (((key >= KEY0 && key <= KEY9) || (key >= _KEY0 && key <= _KEY9)) || (key === BACKSPACE || key === DEL)) {
                pos = getCaretPos(this);
                digit = (key !== BACKSPACE && key !== DEL) ? String.fromCharCode((_KEY0 <= key && key <= _KEY9) ? key - KEY0 : key) : '_';

                if ((key === BACKSPACE || key === DEL) && pos) {
                  pos -= 1;
                  digit = '_';
                }

                while (/[^0-9_]/.test(options.mask.substr(pos, 1)) && pos < options.mask.length && pos > 0) {
                  pos += (key === BACKSPACE || key === DEL) ? -1 : 1;
                }

                val = val.substr(0, pos) + digit + val.substr(pos + 1);
                if ($.trim(val) === '') {
                  val = options.mask.replace(/[0-9]/g, '_');
                } else {
                  if (pos === options.mask.length) {
                    event.preventDefault();
                    return false;
                  }
                }

                pos += (key === BACKSPACE || key === DEL) ? 0 : 1;
                while (/[^0-9_]/.test(options.mask.substr(pos, 1)) && pos < options.mask.length && pos > 0) {
                  pos += (key === BACKSPACE || key === DEL) ? -1 : 1;
                }

                if (isValidValue(options.mask, val)) {
                  this.value = val;
                  setCaretPos(this, pos);
                } else if ($.trim(val) === '') {
                  this.value = options.mask.replace(/[0-9]/g, '_');
                } else {
                  input.trigger('error_input.xdsoft');
                }
              } else {
                if (([AKEY, CKEY, VKEY, ZKEY, YKEY].indexOf(key) !== -1 && ctrlDown) || [ESC, ARROWUP, ARROWDOWN, ARROWLEFT, ARROWRIGHT, F5, CTRLKEY, TAB, ENTER].indexOf(key) !== -1) {
                  return true;
                }
              }

              event.preventDefault();
              return false;
            });
          }
        }
        if (options.validateOnBlur) {
          input
            .off('blur.xdsoft')
            .on('blur.xdsoft', function () {
              if (options.allowBlank && !$.trim($(this).val()).length) {
                $(this).val(null);
                datetimepicker.data('xdsoft_datetime').empty();
              } else if (!dateHelper.parseDate($(this).val(), options.format)) {
                var splittedHours = +([$(this).val()[0], $(this).val()[1]].join('')),
                  splittedMinutes = +([$(this).val()[2], $(this).val()[3]].join(''));

                // parse the numbers as 0312 => 03:12
                if (!options.datepicker && options.timepicker && splittedHours >= 0 && splittedHours < 24 && splittedMinutes >= 0 && splittedMinutes < 60) {
                  $(this).val([splittedHours, splittedMinutes].map(function (item) {
                    return item > 9 ? item : '0' + item;
                  }).join(':'));
                } else {
                  $(this).val(dateHelper.formatDate(_xdsoft_datetime.now(), options.format));
                }

                datetimepicker.data('xdsoft_datetime').setCurrentTime($(this).val());
              } else {
                datetimepicker.data('xdsoft_datetime').setCurrentTime($(this).val());
              }

              datetimepicker.trigger('changedatetime.xdsoft');
            });
        }
        options.dayOfWeekStartPrev = (options.dayOfWeekStart === 0) ? 6 : options.dayOfWeekStart - 1;

        datetimepicker
          .trigger('xchange.xdsoft')
          .trigger('afterOpen.xdsoft');
      };

      datetimepicker
        .data('options', options)
        .on('touchstart mousedown.xdsoft', function (event) {
          event.stopPropagation();
          event.preventDefault();
          yearselect.hide();
          monthselect.hide();
          return false;
        });

      //scroll_element = timepicker.find('.xdsoft_time_box');
      timeboxparent.append(timebox);
      timeboxparent.xdsoftScroller();

      datetimepicker.on('afterOpen.xdsoft', function () {
        timeboxparent.xdsoftScroller();
      });

      datetimepicker
        .append(datepicker)
        .append(timepicker);

      if (options.withoutCopyright !== true) {
        datetimepicker
          .append(xdsoft_copyright);
      }

      datepicker
        .append(mounth_picker)
        .append(calendar)
        .append(applyButton);

      $(options.parentID)
        .append(datetimepicker);

      XDSoft_datetime = function () {
        var _this = this;
        _this.now = function (norecursion) {
          var d = new Date(),
            date,
            time;

          if (!norecursion && options.defaultDate) {
            date = _this.strToDateTime(options.defaultDate);
            d.setFullYear(date.getFullYear());
            d.setMonth(date.getMonth());
            d.setDate(date.getDate());
          }

          if (options.yearOffset) {
            d.setFullYear(d.getFullYear() + options.yearOffset);
          }

          if (!norecursion && options.defaultTime) {
            time = _this.strtotime(options.defaultTime);
            d.setHours(time.getHours());
            d.setMinutes(time.getMinutes());
          }
          return d;
        };

        _this.isValidDate = function (d) {
          if (Object.prototype.toString.call(d) !== "[object Date]") {
            return false;
          }
          return !isNaN(d.getTime());
        };

        _this.setCurrentTime = function (dTime) {
          _this.currentTime = (typeof dTime === 'string') ? _this.strToDateTime(dTime) : _this.isValidDate(dTime) ? dTime : _this.now();
          datetimepicker.trigger('xchange.xdsoft');
        };

        _this.empty = function () {
          _this.currentTime = null;
        };

        _this.getCurrentTime = function (dTime) {
          return _this.currentTime;
        };

        _this.nextMonth = function () {

          if (_this.currentTime === undefined || _this.currentTime === null) {
            _this.currentTime = _this.now();
          }

          var month = _this.currentTime.getMonth() + 1,
            year;
          if (month === 12) {
            _this.currentTime.setFullYear(_this.currentTime.getFullYear() + 1);
            month = 0;
          }

          year = _this.currentTime.getFullYear();

          _this.currentTime.setDate(
            Math.min(
              new Date(_this.currentTime.getFullYear(), month + 1, 0).getDate(),
              _this.currentTime.getDate()
            )
          );
          _this.currentTime.setMonth(month);

          if (options.onChangeMonth && $.isFunction(options.onChangeMonth)) {
            options.onChangeMonth.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'));
          }

          if (year !== _this.currentTime.getFullYear() && $.isFunction(options.onChangeYear)) {
            options.onChangeYear.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'));
          }

          datetimepicker.trigger('xchange.xdsoft');
          return month;
        };

        _this.prevMonth = function () {

          if (_this.currentTime === undefined || _this.currentTime === null) {
            _this.currentTime = _this.now();
          }

          var month = _this.currentTime.getMonth() - 1;
          if (month === -1) {
            _this.currentTime.setFullYear(_this.currentTime.getFullYear() - 1);
            month = 11;
          }
          _this.currentTime.setDate(
            Math.min(
              new Date(_this.currentTime.getFullYear(), month + 1, 0).getDate(),
              _this.currentTime.getDate()
            )
          );
          _this.currentTime.setMonth(month);
          if (options.onChangeMonth && $.isFunction(options.onChangeMonth)) {
            options.onChangeMonth.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'));
          }
          datetimepicker.trigger('xchange.xdsoft');
          return month;
        };

        _this.getWeekOfYear = function (datetime) {
          var onejan = new Date(datetime.getFullYear(), 0, 1);
          return Math.ceil((((datetime - onejan) / 86400000) + onejan.getDay() + 1) / 7);
        };

        _this.strToDateTime = function (sDateTime) {
          var tmpDate = [], timeOffset, currentTime;

          if (sDateTime && sDateTime instanceof Date && _this.isValidDate(sDateTime)) {
            return sDateTime;
          }

          tmpDate = /^(\+|\-)(.*)$/.exec(sDateTime);
          if (tmpDate) {
            tmpDate[2] = dateHelper.parseDate(tmpDate[2], options.formatDate);
          }
          if (tmpDate && tmpDate[2]) {
            timeOffset = tmpDate[2].getTime() - (tmpDate[2].getTimezoneOffset()) * 60000;
            currentTime = new Date((_this.now(true)).getTime() + parseInt(tmpDate[1] + '1', 10) * timeOffset);
          } else {
            currentTime = sDateTime ? dateHelper.parseDate(sDateTime, options.format) : _this.now();
          }

          if (!_this.isValidDate(currentTime)) {
            currentTime = _this.now();
          }

          return currentTime;
        };

        _this.strToDate = function (sDate) {
          if (sDate && sDate instanceof Date && _this.isValidDate(sDate)) {
            return sDate;
          }

          var currentTime = sDate ? dateHelper.parseDate(sDate, options.formatDate) : _this.now(true);
          if (!_this.isValidDate(currentTime)) {
            currentTime = _this.now(true);
          }
          return currentTime;
        };

        _this.strtotime = function (sTime) {
          if (sTime && sTime instanceof Date && _this.isValidDate(sTime)) {
            return sTime;
          }
          var currentTime = sTime ? dateHelper.parseDate(sTime, options.formatTime) : _this.now(true);
          if (!_this.isValidDate(currentTime)) {
            currentTime = _this.now(true);
          }
          return currentTime;
        };

        _this.str = function () {
          return dateHelper.formatDate(_this.currentTime, options.format);
        };
        _this.currentTime = this.now();
      };

      _xdsoft_datetime = new XDSoft_datetime();

      applyButton.on('touchend click', function (e) {//pathbrite
        e.preventDefault();
        datetimepicker.data('changed', true);
        _xdsoft_datetime.setCurrentTime(getCurrentValue());
        input.val(_xdsoft_datetime.str());
        datetimepicker.trigger('close.xdsoft');
      });
      mounth_picker
        .find('.xdsoft_today_button')
        .on('touchend mousedown.xdsoft', function () {
          datetimepicker.data('changed', true);
          _xdsoft_datetime.setCurrentTime(0);
          datetimepicker.trigger('afterOpen.xdsoft');
        }).on('dblclick.xdsoft', function () {
        var currentDate = _xdsoft_datetime.getCurrentTime(), minDate, maxDate;
        currentDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());
        minDate = _xdsoft_datetime.strToDate(options.minDate);
        minDate = new Date(minDate.getFullYear(), minDate.getMonth(), minDate.getDate());
        if (currentDate < minDate) {
          return;
        }
        maxDate = _xdsoft_datetime.strToDate(options.maxDate);
        maxDate = new Date(maxDate.getFullYear(), maxDate.getMonth(), maxDate.getDate());
        if (currentDate > maxDate) {
          return;
        }
        input.val(_xdsoft_datetime.str());
        input.trigger('change');
        datetimepicker.trigger('close.xdsoft');
      });
      mounth_picker
        .find('.xdsoft_prev,.xdsoft_next')
        .on('touchend mousedown.xdsoft', function () {
          var $this = $(this),
            timer = 0,
            stop = false;

          (function arguments_callee1(v) {
            if ($this.hasClass(options.next)) {
              _xdsoft_datetime.nextMonth();
            } else if ($this.hasClass(options.prev)) {
              _xdsoft_datetime.prevMonth();
            }
            if (options.monthChangeSpinner) {
              if (!stop) {
                timer = setTimeout(arguments_callee1, v || 100);
              }
            }
          }(500));

          $([document.body, window]).on('touchend mouseup.xdsoft', function arguments_callee2() {
            clearTimeout(timer);
            stop = true;
            $([document.body, window]).off('touchend mouseup.xdsoft', arguments_callee2);
          });
        });

      timepicker
        .find('.xdsoft_prev,.xdsoft_next')
        .on('touchend mousedown.xdsoft', function () {
          var $this = $(this),
            timer = 0,
            stop = false,
            period = 110;
          (function arguments_callee4(v) {
            var pheight = timeboxparent[0].clientHeight,
              height = timebox[0].offsetHeight,
              top = Math.abs(parseInt(timebox.css('marginTop'), 10));
            if ($this.hasClass(options.next) && (height - pheight) - options.timeHeightInTimePicker >= top) {
              timebox.css('marginTop', '-' + (top + options.timeHeightInTimePicker) + 'px');
            } else if ($this.hasClass(options.prev) && top - options.timeHeightInTimePicker >= 0) {
              timebox.css('marginTop', '-' + (top - options.timeHeightInTimePicker) + 'px');
            }
            timeboxparent.trigger('scroll_element.xdsoft_scroller', [Math.abs(parseInt(timebox.css('marginTop'), 10) / (height - pheight))]);
            period = (period > 10) ? 10 : period - 10;
            if (!stop) {
              timer = setTimeout(arguments_callee4, v || period);
            }
          }(500));
          $([document.body, window]).on('touchend mouseup.xdsoft', function arguments_callee5() {
            clearTimeout(timer);
            stop = true;
            $([document.body, window])
              .off('touchend mouseup.xdsoft', arguments_callee5);
          });
        });

      xchangeTimer = 0;
      // base handler - generating a calendar and timepicker
      datetimepicker
        .on('xchange.xdsoft', function (event) {
          clearTimeout(xchangeTimer);
          xchangeTimer = setTimeout(function () {

            if (_xdsoft_datetime.currentTime === undefined || _xdsoft_datetime.currentTime === null) {
              _xdsoft_datetime.currentTime = _xdsoft_datetime.now();
            }

            var table = '',
              start = new Date(_xdsoft_datetime.currentTime.getFullYear(), _xdsoft_datetime.currentTime.getMonth(), 1, 12, 0, 0),
              i = 0,
              j,
              today = _xdsoft_datetime.now(),
              maxDate = false,
              minDate = false,
              hDate,
              day,
              d,
              y,
              m,
              w,
              classes = [],
              customDateSettings,
              newRow = true,
              time = '',
              h = '',
              line_time,
              description;

            while (start.getDay() !== options.dayOfWeekStart) {
              start.setDate(start.getDate() - 1);
            }

            table += '<table><thead><tr>';

            if (options.weeks) {
              table += '<th></th>';
            }

            for (j = 0; j < 7; j += 1) {
              table += '<th>' + options.i18n[globalLocale].dayOfWeekShort[(j + options.dayOfWeekStart) % 7] + '</th>';
            }

            table += '</tr></thead>';
            table += '<tbody>';

            if (options.maxDate !== false) {
              maxDate = _xdsoft_datetime.strToDate(options.maxDate);
              maxDate = new Date(maxDate.getFullYear(), maxDate.getMonth(), maxDate.getDate(), 23, 59, 59, 999);
            }

            if (options.minDate !== false) {
              minDate = _xdsoft_datetime.strToDate(options.minDate);
              minDate = new Date(minDate.getFullYear(), minDate.getMonth(), minDate.getDate());
            }

            while (i < _xdsoft_datetime.currentTime.countDaysInMonth() || start.getDay() !== options.dayOfWeekStart || _xdsoft_datetime.currentTime.getMonth() === start.getMonth()) {
              classes = [];
              i += 1;

              day = start.getDay();
              d = start.getDate();
              y = start.getFullYear();
              m = start.getMonth();
              w = _xdsoft_datetime.getWeekOfYear(start);
              description = '';

              classes.push('xdsoft_date');

              if (options.beforeShowDay && $.isFunction(options.beforeShowDay.call)) {
                customDateSettings = options.beforeShowDay.call(datetimepicker, start);
              } else {
                customDateSettings = null;
              }

              if ((maxDate !== false && start > maxDate) || (minDate !== false && start < minDate) || (customDateSettings && customDateSettings[0] === false)) {
                classes.push('xdsoft_disabled');
              } else if (options.disabledDates.indexOf(dateHelper.formatDate(start, options.formatDate)) !== -1) {
                classes.push('xdsoft_disabled');
              } else if (options.disabledWeekDays.indexOf(day) !== -1) {
                classes.push('xdsoft_disabled');
              }

              if (customDateSettings && customDateSettings[1] !== "") {
                classes.push(customDateSettings[1]);
              }

              if (_xdsoft_datetime.currentTime.getMonth() !== m) {
                classes.push('xdsoft_other_month');
              }

              if ((options.defaultSelect || datetimepicker.data('changed')) && dateHelper.formatDate(_xdsoft_datetime.currentTime, options.formatDate) === dateHelper.formatDate(start, options.formatDate)) {
                classes.push('xdsoft_current');
              }

              if (dateHelper.formatDate(today, options.formatDate) === dateHelper.formatDate(start, options.formatDate)) {
                classes.push('xdsoft_today');
              }

              if (start.getDay() === 0 || start.getDay() === 6 || options.weekends.indexOf(dateHelper.formatDate(start, options.formatDate)) !== -1) {
                classes.push('xdsoft_weekend');
              }

              if (options.highlightedDates[dateHelper.formatDate(start, options.formatDate)] !== undefined) {
                hDate = options.highlightedDates[dateHelper.formatDate(start, options.formatDate)];
                classes.push(hDate.style === undefined ? 'xdsoft_highlighted_default' : hDate.style);
                description = hDate.desc === undefined ? '' : hDate.desc;
              }

              if (options.beforeShowDay && $.isFunction(options.beforeShowDay)) {
                classes.push(options.beforeShowDay(start));
              }

              if (newRow) {
                table += '<tr>';
                newRow = false;
                if (options.weeks) {
                  table += '<th>' + w + '</th>';
                }
              }

              table += '<td data-date="' + d + '" data-month="' + m + '" data-year="' + y + '"' + ' class="xdsoft_date xdsoft_day_of_week' + start.getDay() + ' ' + classes.join(' ') + '" title="' + description + '">' +
                '<div>' + d + '</div>' +
                '</td>';

              if (start.getDay() === options.dayOfWeekStartPrev) {
                table += '</tr>';
                newRow = true;
              }

              start.setDate(d + 1);
            }
            table += '</tbody></table>';

            calendar.html(table);

            mounth_picker.find('.xdsoft_label span').eq(0).text(options.i18n[globalLocale].months[_xdsoft_datetime.currentTime.getMonth()]);
            mounth_picker.find('.xdsoft_label span').eq(1).text(_xdsoft_datetime.currentTime.getFullYear());

            // generate timebox
            time = '';
            h = '';
            m = '';

            line_time = function line_time(h, m) {
              var now = _xdsoft_datetime.now(), optionDateTime, current_time,
                isALlowTimesInit = options.allowTimes && $.isArray(options.allowTimes) && options.allowTimes.length;
              now.setHours(h);
              h = parseInt(now.getHours(), 10);
              now.setMinutes(m);
              m = parseInt(now.getMinutes(), 10);
              optionDateTime = new Date(_xdsoft_datetime.currentTime);
              optionDateTime.setHours(h);
              optionDateTime.setMinutes(m);
              classes = [];
              if ((options.minDateTime !== false && options.minDateTime > optionDateTime) || (options.maxTime !== false && _xdsoft_datetime.strtotime(options.maxTime).getTime() < now.getTime()) || (options.minTime !== false && _xdsoft_datetime.strtotime(options.minTime).getTime() > now.getTime())) {
                classes.push('xdsoft_disabled');
              }
              if ((options.minDateTime !== false && options.minDateTime > optionDateTime) || ((options.disabledMinTime !== false && now.getTime() > _xdsoft_datetime.strtotime(options.disabledMinTime).getTime()) && (options.disabledMaxTime !== false && now.getTime() < _xdsoft_datetime.strtotime(options.disabledMaxTime).getTime()))) {
                classes.push('xdsoft_disabled');
              }

              current_time = new Date(_xdsoft_datetime.currentTime);
              current_time.setHours(parseInt(_xdsoft_datetime.currentTime.getHours(), 10));

              if (!isALlowTimesInit) {
                current_time.setMinutes(Math[options.roundTime](_xdsoft_datetime.currentTime.getMinutes() / options.step) * options.step);
              }

              if ((options.initTime || options.defaultSelect || datetimepicker.data('changed')) && current_time.getHours() === parseInt(h, 10) && ((!isALlowTimesInit && options.step > 59) || current_time.getMinutes() === parseInt(m, 10))) {
                if (options.defaultSelect || datetimepicker.data('changed')) {
                  classes.push('xdsoft_current');
                } else if (options.initTime) {
                  classes.push('xdsoft_init_time');
                }
              }
              if (parseInt(today.getHours(), 10) === parseInt(h, 10) && parseInt(today.getMinutes(), 10) === parseInt(m, 10)) {
                classes.push('xdsoft_today');
              }
              time += '<div class="xdsoft_time ' + classes.join(' ') + '" data-hour="' + h + '" data-minute="' + m + '">' + dateHelper.formatDate(now, options.formatTime) + '</div>';
            };

            if (!options.allowTimes || !$.isArray(options.allowTimes) || !options.allowTimes.length) {
              for (i = 0, j = 0; i < (options.hours12 ? 12 : 24); i += 1) {
                for (j = 0; j < 60; j += options.step) {
                  h = (i < 10 ? '0' : '') + i;
                  m = (j < 10 ? '0' : '') + j;
                  line_time(h, m);
                }
              }
            } else {
              for (i = 0; i < options.allowTimes.length; i += 1) {
                h = _xdsoft_datetime.strtotime(options.allowTimes[i]).getHours();
                m = _xdsoft_datetime.strtotime(options.allowTimes[i]).getMinutes();
                line_time(h, m);
              }
            }

            timebox.html(time);

            opt = '';
            i = 0;

            for (i = parseInt(options.yearStart, 10) + options.yearOffset; i <= parseInt(options.yearEnd, 10) + options.yearOffset; i += 1) {
              opt += '<div class="xdsoft_option ' + (_xdsoft_datetime.currentTime.getFullYear() === i ? 'xdsoft_current' : '') + '" data-value="' + i + '">' + i + '</div>';
            }
            yearselect.children().eq(0)
              .html(opt);

            for (i = parseInt(options.monthStart, 10), opt = ''; i <= parseInt(options.monthEnd, 10); i += 1) {
              opt += '<div class="xdsoft_option ' + (_xdsoft_datetime.currentTime.getMonth() === i ? 'xdsoft_current' : '') + '" data-value="' + i + '">' + options.i18n[globalLocale].months[i] + '</div>';
            }
            monthselect.children().eq(0).html(opt);
            $(datetimepicker)
              .trigger('generate.xdsoft');
          }, 10);
          event.stopPropagation();
        })
        .on('afterOpen.xdsoft', function () {
          if (options.timepicker) {
            var classType, pheight, height, top;
            if (timebox.find('.xdsoft_current').length) {
              classType = '.xdsoft_current';
            } else if (timebox.find('.xdsoft_init_time').length) {
              classType = '.xdsoft_init_time';
            }
            if (classType) {
              pheight = timeboxparent[0].clientHeight;
              height = timebox[0].offsetHeight;
              top = timebox.find(classType).index() * options.timeHeightInTimePicker + 1;
              if ((height - pheight) < top) {
                top = height - pheight;
              }
              timeboxparent.trigger('scroll_element.xdsoft_scroller', [parseInt(top, 10) / (height - pheight)]);
            } else {
              timeboxparent.trigger('scroll_element.xdsoft_scroller', [0]);
            }
          }
        });

      timerclick = 0;
      calendar
        .on('touchend click.xdsoft', 'td', function (xdevent) {
          xdevent.stopPropagation();  // Prevents closing of Pop-ups, Modals and Flyouts in Bootstrap
          timerclick += 1;
          var $this = $(this),
            currentTime = _xdsoft_datetime.currentTime;

          if (currentTime === undefined || currentTime === null) {
            _xdsoft_datetime.currentTime = _xdsoft_datetime.now();
            currentTime = _xdsoft_datetime.currentTime;
          }

          if ($this.hasClass('xdsoft_disabled')) {
            return false;
          }

          currentTime.setDate(1);
          currentTime.setFullYear($this.data('year'));
          currentTime.setMonth($this.data('month'));
          currentTime.setDate($this.data('date'));

          datetimepicker.trigger('select.xdsoft', [currentTime]);

          input.val(_xdsoft_datetime.str());

          if (options.onSelectDate && $.isFunction(options.onSelectDate)) {
            options.onSelectDate.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'), xdevent);
          }

          datetimepicker.data('changed', true);
          datetimepicker.trigger('xchange.xdsoft');
          datetimepicker.trigger('changedatetime.xdsoft');
          if ((timerclick > 1 || (options.closeOnDateSelect === true || (options.closeOnDateSelect === false && !options.timepicker))) && !options.inline) {
            datetimepicker.trigger('close.xdsoft');
          }
          setTimeout(function () {
            timerclick = 0;
          }, 200);
        });

      timebox
        .on('touchend click.xdsoft', 'div', function (xdevent) {
          xdevent.stopPropagation();
          var $this = $(this),
            currentTime = _xdsoft_datetime.currentTime;

          if (currentTime === undefined || currentTime === null) {
            _xdsoft_datetime.currentTime = _xdsoft_datetime.now();
            currentTime = _xdsoft_datetime.currentTime;
          }

          if ($this.hasClass('xdsoft_disabled')) {
            return false;
          }
          currentTime.setHours($this.data('hour'));
          currentTime.setMinutes($this.data('minute'));
          datetimepicker.trigger('select.xdsoft', [currentTime]);

          datetimepicker.data('input').val(_xdsoft_datetime.str());

          if (options.onSelectTime && $.isFunction(options.onSelectTime)) {
            options.onSelectTime.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'), xdevent);
          }
          datetimepicker.data('changed', true);
          datetimepicker.trigger('xchange.xdsoft');
          datetimepicker.trigger('changedatetime.xdsoft');
          if (options.inline !== true && options.closeOnTimeSelect === true) {
            datetimepicker.trigger('close.xdsoft');
          }
        });


      datepicker
        .on('mousewheel.xdsoft', function (event) {
          if (!options.scrollMonth) {
            return true;
          }
          if (event.deltaY < 0) {
            _xdsoft_datetime.nextMonth();
          } else {
            _xdsoft_datetime.prevMonth();
          }
          return false;
        });

      input
        .on('mousewheel.xdsoft', function (event) {
          if (!options.scrollInput) {
            return true;
          }
          if (!options.datepicker && options.timepicker) {
            current_time_index = timebox.find('.xdsoft_current').length ? timebox.find('.xdsoft_current').eq(0).index() : 0;
            if (current_time_index + event.deltaY >= 0 && current_time_index + event.deltaY < timebox.children().length) {
              current_time_index += event.deltaY;
            }
            if (timebox.children().eq(current_time_index).length) {
              timebox.children().eq(current_time_index).trigger('mousedown');
            }
            return false;
          }
          if (options.datepicker && !options.timepicker) {
            datepicker.trigger(event, [event.deltaY, event.deltaX, event.deltaY]);
            if (input.val) {
              input.val(_xdsoft_datetime.str());
            }
            datetimepicker.trigger('changedatetime.xdsoft');
            return false;
          }
        });

      datetimepicker
        .on('changedatetime.xdsoft', function (event) {
          if (options.onChangeDateTime && $.isFunction(options.onChangeDateTime)) {
            var $input = datetimepicker.data('input');
            options.onChangeDateTime.call(datetimepicker, _xdsoft_datetime.currentTime, $input, event);
            delete options.value;
            $input.trigger('change');
          }
        })
        .on('generate.xdsoft', function () {
          if (options.onGenerate && $.isFunction(options.onGenerate)) {
            options.onGenerate.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'));
          }
          if (triggerAfterOpen) {
            datetimepicker.trigger('afterOpen.xdsoft');
            triggerAfterOpen = false;
          }
        })
        .on('click.xdsoft', function (xdevent) {
          xdevent.stopPropagation();
        });

      current_time_index = 0;

      setPos = function () {
        var offset = datetimepicker.data('input').offset(), datetimepickerelement = datetimepicker.data('input')[0], top = offset.top + datetimepickerelement.offsetHeight - 1, left = offset.left, position = "absolute", node;
        if (datetimepicker.data('input').parent().css('direction') == 'rtl')
          left -= (datetimepicker.outerWidth() - datetimepicker.data('input').outerWidth());
        if (options.fixed) {
          top -= $(window).scrollTop();
          left -= $(window).scrollLeft();
          position = "fixed";
        } else {
          if (top + datetimepickerelement.offsetHeight > $(window).height() + $(window).scrollTop()) {
            top = offset.top - datetimepickerelement.offsetHeight + 1;
          }
          if (top < 0) {
            top = 0;
          }
          if (left + datetimepickerelement.offsetWidth > $(window).width()) {
            left = $(window).width() - datetimepickerelement.offsetWidth;
          }
        }

        node = datetimepicker[0];
        do {
          node = node.parentNode;
          if (window.getComputedStyle(node).getPropertyValue('position') === 'relative' && $(window).width() >= node.offsetWidth) {
            left = left - (($(window).width() - node.offsetWidth) / 2);
            break;
          }
        } while (node.nodeName !== 'HTML');
        datetimepicker.css({
          left: left,
          top: top,
          position: position
        });
      };
      datetimepicker
        .on('open.xdsoft', function (event) {
          var onShow = true;
          if (options.onShow && $.isFunction(options.onShow)) {
            onShow = options.onShow.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'), event);
          }
          if (onShow !== false) {
            datetimepicker.show();
            setPos();
            $(window)
              .off('resize.xdsoft', setPos)
              .on('resize.xdsoft', setPos);

            if (options.closeOnWithoutClick) {
              $([document.body, window]).on('touchstart mousedown.xdsoft', function arguments_callee6() {
                datetimepicker.trigger('close.xdsoft');
                $([document.body, window]).off('touchstart mousedown.xdsoft', arguments_callee6);
              });
            }
          }
        })
        .on('close.xdsoft', function (event) {
          var onClose = true;
          mounth_picker
            .find('.xdsoft_month,.xdsoft_year')
            .find('.xdsoft_select')
            .hide();
          if (options.onClose && $.isFunction(options.onClose)) {
            onClose = options.onClose.call(datetimepicker, _xdsoft_datetime.currentTime, datetimepicker.data('input'), event);
          }
          if (onClose !== false && !options.opened && !options.inline) {
            datetimepicker.hide();
          }
          event.stopPropagation();
        })
        .on('toggle.xdsoft', function (event) {
          if (datetimepicker.is(':visible')) {
            datetimepicker.trigger('close.xdsoft');
          } else {
            datetimepicker.trigger('open.xdsoft');
          }
        })
        .data('input', input);

      timer = 0;
      timer1 = 0;

      datetimepicker.data('xdsoft_datetime', _xdsoft_datetime);
      datetimepicker.setOptions(options);

      function getCurrentValue() {
        var ct = false, time;

        if (options.startDate) {
          ct = _xdsoft_datetime.strToDate(options.startDate);
        } else {
          ct = options.value || ((input && input.val && input.val()) ? input.val() : '');
          if (ct) {
            ct = _xdsoft_datetime.strToDateTime(ct);
          } else if (options.defaultDate) {
            ct = _xdsoft_datetime.strToDateTime(options.defaultDate);
            if (options.defaultTime) {
              time = _xdsoft_datetime.strtotime(options.defaultTime);
              ct.setHours(time.getHours());
              ct.setMinutes(time.getMinutes());
            }
          }
        }

        if (ct && _xdsoft_datetime.isValidDate(ct)) {
          datetimepicker.data('changed', true);
        } else {
          ct = '';
        }

        return ct || 0;
      }

      _xdsoft_datetime.setCurrentTime(getCurrentValue());

      input
        .data('xdsoft_datetimepicker', datetimepicker)
        .on('open.xdsoft focusin.xdsoft mousedown.xdsoft touchstart', function (event) {
          if (input.is(':disabled') || (input.data('xdsoft_datetimepicker').is(':visible') && options.closeOnInputClick)) {
            return;
          }
          clearTimeout(timer);
          timer = setTimeout(function () {
            if (input.is(':disabled')) {
              return;
            }

            triggerAfterOpen = true;
            _xdsoft_datetime.setCurrentTime(getCurrentValue());

            datetimepicker.trigger('open.xdsoft');
          }, 100);
        })
        .on('keydown.xdsoft', function (event) {
          var val = this.value, elementSelector,
            key = event.which;
          if ([ENTER].indexOf(key) !== -1 && options.enterLikeTab) {
            elementSelector = $("input:visible,textarea:visible,button:visible,a:visible");
            datetimepicker.trigger('close.xdsoft');
            elementSelector.eq(elementSelector.index(this) + 1).focus();
            return false;
          }
          if ([TAB].indexOf(key) !== -1) {
            datetimepicker.trigger('close.xdsoft');
            return true;
          }
        });
    };
    destroyDateTimePicker = function (input) {
      var datetimepicker = input.data('xdsoft_datetimepicker');
      if (datetimepicker) {
        datetimepicker.data('xdsoft_datetime', null);
        datetimepicker.remove();
        input
          .data('xdsoft_datetimepicker', null)
          .off('.xdsoft');
        $(window).off('resize.xdsoft');
        $([window, document.body]).off('mousedown.xdsoft touchstart');
        if (input.unmousewheel) {
          input.unmousewheel();
        }
      }
    };
    $(document)
      .off('keydown.xdsoftctrl keyup.xdsoftctrl')
      .on('keydown.xdsoftctrl', function (e) {
        if (e.keyCode === CTRLKEY) {
          ctrlDown = true;
        }
      })
      .on('keyup.xdsoftctrl', function (e) {
        if (e.keyCode === CTRLKEY) {
          ctrlDown = false;
        }
      });
    return this.each(function () {
      var datetimepicker = $(this).data('xdsoft_datetimepicker'), $input;
      if (datetimepicker) {
        if ($.type(opt) === 'string') {
          switch (opt) {
            case 'show':
              $(this).select().focus();
              datetimepicker.trigger('open.xdsoft');
              break;
            case 'hide':
              datetimepicker.trigger('close.xdsoft');
              break;
            case 'toggle':
              datetimepicker.trigger('toggle.xdsoft');
              break;
            case 'destroy':
              destroyDateTimePicker($(this));
              break;
            case 'reset':
              this.value = this.defaultValue;
              if (!this.value || !datetimepicker.data('xdsoft_datetime').isValidDate(dateHelper.parseDate(this.value, options.format))) {
                datetimepicker.data('changed', false);
              }
              datetimepicker.data('xdsoft_datetime').setCurrentTime(this.value);
              break;
            case 'validate':
              $input = datetimepicker.data('input');
              $input.trigger('blur.xdsoft');
              break;
          }
        } else {
          datetimepicker
            .setOptions(opt);
        }
        return 0;
      }
      if ($.type(opt) !== 'string') {
        if (!options.lazyInit || options.open || options.inline) {
          createDateTimePicker($(this));
        } else {
          lazyInit($(this));
        }
      }
    });
  };
  $.fn.confidatetimepicker.defaults = default_options;

  function HighlightedDate(date, desc, style) {
    "use strict";
    this.date = date;
    this.desc = desc;
    this.style = style;
  }

}));
/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */

(function (factory) {
  if (typeof define === 'function' && define.amd) {
    // AMD. Register as an anonymous module.
    define(['jquery'], factory);
  } else if (typeof exports === 'object') {
    // Node/CommonJS style for Browserify
    module.exports = factory;
  } else {
    // Browser globals
    factory(jQuery);
  }
}(function ($) {

  var toFix = ['wheel', 'mousewheel', 'DOMMouseScroll', 'MozMousePixelScroll'],
    toBind = ( 'onwheel' in document || document.documentMode >= 9 ) ?
      ['wheel'] : ['mousewheel', 'DomMouseScroll', 'MozMousePixelScroll'],
    slice = Array.prototype.slice,
    nullLowestDeltaTimeout, lowestDelta;

  if ($.event.fixHooks) {
    for (var i = toFix.length; i;) {
      $.event.fixHooks[toFix[--i]] = $.event.mouseHooks;
    }
  }

  var special = $.event.special.mousewheel = {
    version: '3.1.12',

    setup: function () {
      if (this.addEventListener) {
        for (var i = toBind.length; i;) {
          this.addEventListener(toBind[--i], handler, false);
        }
      } else {
        this.onmousewheel = handler;
      }
      // Store the line height and page height for this particular element
      $.data(this, 'mousewheel-line-height', special.getLineHeight(this));
      $.data(this, 'mousewheel-page-height', special.getPageHeight(this));
    },

    teardown: function () {
      if (this.removeEventListener) {
        for (var i = toBind.length; i;) {
          this.removeEventListener(toBind[--i], handler, false);
        }
      } else {
        this.onmousewheel = null;
      }
      // Clean up the data we added to the element
      $.removeData(this, 'mousewheel-line-height');
      $.removeData(this, 'mousewheel-page-height');
    },

    getLineHeight: function (elem) {
      var $elem = $(elem),
        $parent = $elem['offsetParent' in $.fn ? 'offsetParent' : 'parent']();
      if (!$parent.length) {
        $parent = $('body');
      }
      return parseInt($parent.css('fontSize'), 10) || parseInt($elem.css('fontSize'), 10) || 16;
    },

    getPageHeight: function (elem) {
      return $(elem).height();
    },

    settings: {
      adjustOldDeltas: true, // see shouldAdjustOldDeltas() below
      normalizeOffset: true  // calls getBoundingClientRect for each event
    }
  };

  $.fn.extend({
    mousewheel: function (fn) {
      return fn ? this.bind('mousewheel', fn) : this.trigger('mousewheel');
    },

    unmousewheel: function (fn) {
      return this.unbind('mousewheel', fn);
    }
  });


  function handler(event) {
    var orgEvent = event || window.event,
      args = slice.call(arguments, 1),
      delta = 0,
      deltaX = 0,
      deltaY = 0,
      absDelta = 0,
      offsetX = 0,
      offsetY = 0;
    event = $.event.fix(orgEvent);
    event.type = 'mousewheel';

    // Old school scrollwheel delta
    if ('detail' in orgEvent) {
      deltaY = orgEvent.detail * -1;
    }
    if ('wheelDelta' in orgEvent) {
      deltaY = orgEvent.wheelDelta;
    }
    if ('wheelDeltaY' in orgEvent) {
      deltaY = orgEvent.wheelDeltaY;
    }
    if ('wheelDeltaX' in orgEvent) {
      deltaX = orgEvent.wheelDeltaX * -1;
    }

    // Firefox < 17 horizontal scrolling related to DOMMouseScroll event
    if ('axis' in orgEvent && orgEvent.axis === orgEvent.HORIZONTAL_AXIS) {
      deltaX = deltaY * -1;
      deltaY = 0;
    }

    // Set delta to be deltaY or deltaX if deltaY is 0 for backwards compatabilitiy
    delta = deltaY === 0 ? deltaX : deltaY;

    // New school wheel delta (wheel event)
    if ('deltaY' in orgEvent) {
      deltaY = orgEvent.deltaY * -1;
      delta = deltaY;
    }
    if ('deltaX' in orgEvent) {
      deltaX = orgEvent.deltaX;
      if (deltaY === 0) {
        delta = deltaX * -1;
      }
    }

    // No change actually happened, no reason to go any further
    if (deltaY === 0 && deltaX === 0) {
      return;
    }

    // Need to convert lines and pages to pixels if we aren't already in pixels
    // There are three delta modes:
    //   * deltaMode 0 is by pixels, nothing to do
    //   * deltaMode 1 is by lines
    //   * deltaMode 2 is by pages
    if (orgEvent.deltaMode === 1) {
      var lineHeight = $.data(this, 'mousewheel-line-height');
      delta *= lineHeight;
      deltaY *= lineHeight;
      deltaX *= lineHeight;
    } else if (orgEvent.deltaMode === 2) {
      var pageHeight = $.data(this, 'mousewheel-page-height');
      delta *= pageHeight;
      deltaY *= pageHeight;
      deltaX *= pageHeight;
    }

    // Store lowest absolute delta to normalize the delta values
    absDelta = Math.max(Math.abs(deltaY), Math.abs(deltaX));

    if (!lowestDelta || absDelta < lowestDelta) {
      lowestDelta = absDelta;

      // Adjust older deltas if necessary
      if (shouldAdjustOldDeltas(orgEvent, absDelta)) {
        lowestDelta /= 40;
      }
    }

    // Adjust older deltas if necessary
    if (shouldAdjustOldDeltas(orgEvent, absDelta)) {
      // Divide all the things by 40!
      delta /= 40;
      deltaX /= 40;
      deltaY /= 40;
    }

    // Get a whole, normalized value for the deltas
    delta = Math[delta >= 1 ? 'floor' : 'ceil'](delta / lowestDelta);
    deltaX = Math[deltaX >= 1 ? 'floor' : 'ceil'](deltaX / lowestDelta);
    deltaY = Math[deltaY >= 1 ? 'floor' : 'ceil'](deltaY / lowestDelta);

    // Normalise offsetX and offsetY properties
    if (special.settings.normalizeOffset && this.getBoundingClientRect) {
      var boundingRect = this.getBoundingClientRect();
      offsetX = event.clientX - boundingRect.left;
      offsetY = event.clientY - boundingRect.top;
    }

    // Add information to the event object
    event.deltaX = deltaX;
    event.deltaY = deltaY;
    event.deltaFactor = lowestDelta;
    event.offsetX = offsetX;
    event.offsetY = offsetY;
    // Go ahead and set deltaMode to 0 since we converted to pixels
    // Although this is a little odd since we overwrite the deltaX/Y
    // properties with normalized deltas.
    event.deltaMode = 0;

    // Add event and delta to the front of the arguments
    args.unshift(event, delta, deltaX, deltaY);

    // Clearout lowestDelta after sometime to better
    // handle multiple device types that give different
    // a different lowestDelta
    // Ex: trackpad = 3 and mouse wheel = 120
    if (nullLowestDeltaTimeout) {
      clearTimeout(nullLowestDeltaTimeout);
    }
    nullLowestDeltaTimeout = setTimeout(nullLowestDelta, 200);

    return ($.event.dispatch || $.event.handle).apply(this, args);
  }

  function nullLowestDelta() {
    lowestDelta = null;
  }

  function shouldAdjustOldDeltas(orgEvent, absDelta) {
    // If this is an older event and the delta is divisable by 120,
    // then we are assuming that the browser is treating this as an
    // older mouse wheel event and that we should divide the deltas
    // by 40 to try and get a more usable deltaFactor.
    // Side note, this actually impacts the reported scroll distance
    // in older browsers and can cause scrolling to be slower than native.
    // Turn this off by setting $.event.special.mousewheel.settings.adjustOldDeltas to false.
    return special.settings.adjustOldDeltas && orgEvent.type === 'mousewheel' && absDelta % 120 === 0;
  }

}));

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.vertuna.confluence.plugins.confiforms:confiformResources', location = '/com/vertuna/confluence/plugins/confiforms/js/jquery.datetimepicker-with-moment.js' */
function toJDFString(formatString) {
  var momentFormatMapping = {
    D: 'd',
    DD: 'dd',
    YY: 'yy',
    YYY: 'yyyy',
    YYYY: 'yyyy',
    a: 'a',
    A: 'A',
    M: 'M',
    MM: 'MM',
    MMM: 'MMM',
    MMMM: 'MMMM',
    h: 'h',
    hh: 'hh',
    H: 'H',
    HH: 'HH',
    m: 'm',
    mm: 'mm',
    s: 's',
    ss: 'ss',
    S: 'S',
    SS: 'S',
    SSS: 'S',
    ddd: 'E',
    dddd: 'EEEE',
    DDD: 'D',
    W: 'w',
    WW: 'ww',
    ZZ: 'z',
    Z: 'XXX',
    E: 'u'
  };

  return translateFormat(formatString, momentFormatMapping);
}

function toMomentFormatString(formatString) {
  var javaFormatMapping = {
    d: 'D',
    dd: 'DD',
    y: 'YYYY',
    yy: 'YY',
    yyy: 'YYYY',
    yyyy: 'YYYY',
    a: 'a',
    A: 'A',
    M: 'M',
    MM: 'MM',
    MMM: 'MMM',
    MMMM: 'MMMM',
    h: 'h',
    hh: 'hh',
    H: 'H',
    HH: 'HH',
    m: 'm',
    mm: 'mm',
    s: 's',
    ss: 'ss',
    S: 'SSS',
    SS: 'SSS',
    SSS: 'SSS',
    E: 'ddd',
    EE: 'ddd',
    EEE: 'ddd',
    EEEE: 'dddd',
    EEEEE: 'dddd',
    EEEEEE: 'dddd',
    D: 'DDD',
    w: 'W',
    ww: 'WW',
    z: 'ZZ',
    zzzz: 'Z',
    Z: 'ZZ',
    X: 'ZZ',
    XX: 'ZZ',
    XXX: 'Z',
    u: 'E'
  };

  return translateFormat(formatString, javaFormatMapping);
}

function translateFormat(formatString, mapping) {
  var len = formatString.length,
    i = 0,
    beginIndex = -1,
    lastChar = null,
    currentChar = "",
    resultString = "";

  for (; i < len; i++) {
    currentChar = formatString.charAt(i);

    if (lastChar === null || lastChar !== currentChar) {
      // change detected
      resultString = _appendMappedString(formatString, mapping, beginIndex, i, resultString);

      beginIndex = i;
    }

    lastChar = currentChar;
  }

  return _appendMappedString(formatString, mapping, beginIndex, i, resultString);
}

/**
 * Checks if the substring is a mapped date format pattern and adds it to the result format String.
 *
 * @function _appendMappedString
 * @param {String}  formatString    The unmodified format String.
 * @param {Object}  mapping         The date format mapping Object.
 * @param {Number}  beginIndex      The begin index of the continuous format characters.
 * @param {Number}  currentIndex    The last index of the continuous format characters.
 * @param {String}  resultString    The result format String.
 * @returns {String}
 * @private
 */
function _appendMappedString(formatString, mapping, beginIndex, currentIndex, resultString) {
  var tempString;

  if (beginIndex !== -1) {
    tempString = formatString.substring(beginIndex, currentIndex);
    // check if the temporary string has a known mapping
    if (mapping[tempString]) {
      tempString = mapping[tempString];
    }
    resultString = resultString.concat(tempString);
  }
  return resultString;
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-feature-discovery-plugin:confluence-feature-discovery-plugin-resources', location = '/js/confluence-feature-discovery-plugin.js' */
(function(f){Confluence.FeatureDiscovery={};var c,e=false,i=3;var d="com.atlassian.confluence.plugins.confluence-feature-discovery-plugin";var g=d+":confluence-feature-discovery-plugin-resources.test-mode";var a=WRM.data.claim(g);function j(k){if(c===undefined){c=JSON.parse(AJS.Meta.get("discovered-plugin-features")||"{}")}if(k){return c[k]||[]}return c}function b(m,o){var n=j(m);for(var l=0,k=n.length;l<k;l++){if(n[l]==o){return true}}return false}function h(n,p){var l="com.atlassian.webdriver.discovery="+n+":"+p;var k=document.cookie.split(";");for(var m=0;m<k.length;m++){var o=k[m];while(o.charAt(0)==" "){o=o.substring(1)}if(o.indexOf(l)!=-1){return true}}return false}Confluence.FeatureDiscovery.forPlugin=function(m,l){var p=Confluence.storageManager("feature-discovery."+m);l=l||i;function o(r){var q=parseInt(p.getItem(r),10);return isNaN(q)?0:q}function n(r,q){return p.setItem(r,q)}function k(q){return p.removeItem(q)}return{addDiscoveryView:function(q){n(q,o(q)+1)},shouldShow:function(r,q){if(q===true&&a&&!h(m,r)){return false}if(e||b(m,r)){return false}if(o(r)>=l){this.markDiscovered(r);return false}e=true;return true},markDiscovered:function(r,q){if(b(m,r)){return}AJS.safeAjax({url:AJS.contextPath()+"/rest/feature-discovery/1.0/discovered/"+m+"/"+r,type:"POST",data:{},success:function(){j(m).unshift(r);k(r);AJS.trigger("feature-discovered",{pluginKey:m,featureKey:r});if(q&&f.isFunction(q)){q()}}})},listDiscovered:function(){return j(m).slice(0)}}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-onboarding:init-session-flow-resources', location = 'flow/controller/session-progress-tracker.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-onboarding:init-session-flow-resources', location = 'flow/main/init-session-flow.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-almond', location = 'gliffy/amd/AlmondNoConflictPrefix.js' */
window.__require=window.require;window.__requirejs=window.requirejs;window.__define=window.define;
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-almond', location = 'thirdparty/almond.js' */
var requirejs,require,define;(function(e){var h,a,l,m,d={},c={},s={},p={},k=Object.prototype.hasOwnProperty,i=[].slice,j=/\.js$/;function t(u,v){return k.call(u,v)}function n(x,v){var F,B,z,C,G,y,I,J,E,D,A,H=v&&v.split("/"),w=s.map,u=(w&&w["*"])||{};if(x&&x.charAt(0)==="."){if(v){x=x.split("/");G=x.length-1;if(s.nodeIdCompat&&j.test(x[G])){x[G]=x[G].replace(j,"")}x=H.slice(0,H.length-1).concat(x);for(E=0;E<x.length;E+=1){A=x[E];if(A==="."){x.splice(E,1);E-=1}else{if(A===".."){if(E===1&&(x[2]===".."||x[0]==="..")){break}else{if(E>0){x.splice(E-1,2);E-=2}}}}}x=x.join("/")}else{if(x.indexOf("./")===0){x=x.substring(2)}}}if((H||u)&&w){F=x.split("/");for(E=F.length;E>0;E-=1){B=F.slice(0,E).join("/");if(H){for(D=H.length;D>0;D-=1){z=w[H.slice(0,D).join("/")];if(z){z=z[B];if(z){C=z;y=E;break}}}}if(C){break}if(!I&&u&&u[B]){I=u[B];J=E}}if(!C&&I){C=I;y=J}if(C){F.splice(0,y,C);x=F.join("/")}}return x}function r(u,v){return function(){var w=i.call(arguments,0);if(typeof w[0]!=="string"&&w.length===1){w.push(null)}return a.apply(e,w.concat([u,v]))}}function o(u){return function(v){return n(v,u)}}function f(u){return function(v){d[u]=v}}function g(v){if(t(c,v)){var u=c[v];delete c[v];p[v]=true;h.apply(e,u)}if(!t(d,v)&&!t(p,v)){throw new Error("No "+v)}return d[v]}function q(v){var w,u=v?v.indexOf("!"):-1;if(u>-1){w=v.substring(0,u);v=v.substring(u+1,v.length)}return[w,v]}l=function(v,u){var w,y=q(v),x=y[0];v=y[1];if(x){x=n(x,u);w=g(x)}if(x){if(w&&w.normalize){v=w.normalize(v,o(u))}else{v=n(v,u)}}else{v=n(v,u);y=q(v);x=y[0];v=y[1];if(x){w=g(x)}}return{f:x?x+"!"+v:v,n:v,pr:x,p:w}};function b(u){return function(){return(s&&s.config&&s.config[u])||{}}}m={require:function(u){return r(u)},exports:function(u){var v=d[u];if(typeof v!=="undefined"){return v}else{return(d[u]={})}},module:function(u){return{id:u,uri:"",exports:d[u],config:b(u)}}};h=function(v,F,E,D){var y,C,z,u,x,A=[],w=typeof E,B;D=D||v;if(w==="undefined"||w==="function"){F=!F.length&&E.length?["require","exports","module"]:F;for(x=0;x<F.length;x+=1){u=l(F[x],D);C=u.f;if(C==="require"){A[x]=m.require(v)}else{if(C==="exports"){A[x]=m.exports(v);B=true}else{if(C==="module"){y=A[x]=m.module(v)}else{if(t(d,C)||t(c,C)||t(p,C)){A[x]=g(C)}else{if(u.p){u.p.load(u.n,r(D,true),f(C),{});A[x]=d[C]}else{throw new Error(v+" missing "+C)}}}}}}z=E?E.apply(d[v],A):undefined;if(v){if(y&&y.exports!==e&&y.exports!==d[v]){d[v]=y.exports}else{if(z!==e||!B){d[v]=z}}}}else{if(v){d[v]=E}}};requirejs=require=a=function(x,y,u,v,w){if(typeof x==="string"){if(m[x]){return m[x](y)}return g(l(x,y).f)}else{if(!x.splice){s=x;if(s.deps){a(s.deps,s.callback)}if(!y){return}if(y.splice){x=y;y=u;u=null}else{x=e}}}y=y||function(){};if(typeof u==="function"){u=v;v=w}if(v){h(e,x,y,u)}else{setTimeout(function(){h(e,x,y,u)},4)}return a};a.config=function(u){return a(u)};requirejs._defined=d;define=function(u,v,w){if(typeof u!=="string"){throw new Error("See almond README: incorrect module build, no module name")}if(!v.splice){w=v;v=[]}if(!t(d,u)&&!t(c,u)){c[u]=[u,v,w]}};define.amd={jQuery:true}}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-almond', location = 'gliffy/amd/AlmondNoConflictPostfix.js' */
if(window.__require){window.require=window.__require;window.requirejs=window.__requirejs;window.define=window.__define}else{delete window.define.amd};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-almond', location = 'gliffy/amd/ApexModuleManager.js' */
define("gliffy/amd/apexModuleManager",function(){var a=[];return{reset:function(){a=[]},define:function(){a.push(arguments[0]);window.define.apply(window,arguments)},instantiateAll:function(){a.forEach(function(b){require(b)})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-almond', location = 'gliffy/confluence/AlmondRegistrations.js' */
delete define.amd;define("jquery",[],function(){return jQuery});define("underscore",[],function(){return _});define("selectize",[],function(){return Selectize});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-basics', location = 'gliffy/Util.js' */
define("gliffy/util",[],function(){return{format:function(b){var a=Array.prototype.slice.call(arguments,1);return b.replace(/{(\d+)}/g,function(c,d){return(typeof a[d]!="undefined")?a[d]:"undefined"})},htmlDecode:function(a){var b=document.createElement("div");b.innerHTML=a;return b.childNodes.length===0?"":b.childNodes[0].nodeValue}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-basics', location = 'gliffy/Url.js' */
define("gliffy/url",{buildPath:function(a){return a.reduce(function(b,c){if(c==null){return b}else{if(b){return b+"/"+encodeURIComponent(c)}}return encodeURIComponent(c)},"")},buildQuery:function(a){return _.reduce(a,function(b,d,c){if(d==null){return b}else{if(b){return b+"&"+encodeURIComponent(c)+"="+encodeURIComponent(d)}}return encodeURIComponent(c)+"="+encodeURIComponent(d)},"")},buildPathAndQuery:function(a,c){var b=[this.buildPath(a)];if((typeof c!=="undefined")&&Object.keys(c).length>0){b.push(this.buildQuery(c))}return b.join("?")},buildRootedPathAndQuery:function(b,a,c){return b+"/"+this.buildPathAndQuery(a,c)},parse:function(b){var f=/^(?:([a-z]*):)?(?:\/\/)?(?:([^:@]*)(?::([^@]*))?@)?([0-9a-z-._]+)?(?::([0-9]*))?(\/[^?#]*)?(?:\?([^#]*))?(?:#(.*))?$/i;var g=b.match(f)||[];var e={url:b,scheme:g[1],user:g[2],pass:g[3],host:g[4],port:g[5]&&+g[5],path:g[6],query:g[7],hash:g[8]};e.queryParams={};var c=e.query.split("&");for(var a=0;a<c.length;a++){var d=c[a].split("=");e.queryParams[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return e}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-basics', location = 'gliffy/controls/alert/Alert.soy' */
// This file was automatically generated from Alert.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.controls.alert.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.controls == 'undefined') { gliffySoy.controls = {}; }
if (typeof gliffySoy.controls.alert == 'undefined') { gliffySoy.controls.alert = {}; }


gliffySoy.controls.alert.CompleteAlert = function(opt_data, opt_ignored) {
  return '<div id="gliffy-alert-save-as-complete" class="alert alert-success gliffy-alert"><a href="#" class="close" data-dismiss="alert">&times;</a><strong>' + soy.$$escapeHtml(opt_data.diagramName) + '</strong>&nbsp;' + soy.$$escapeHtml("successfully saved to page") + '&nbsp;<a class="gliffy-alert-link" href="' + soy.$$escapeHtml(opt_data.linkUrl) + '" target="_blank"><img class="page-icon"/><strong>&nbsp;' + soy.$$escapeHtml(opt_data.pageName) + '</strong></a><br/>' + soy.$$escapeHtml("in space") + '&nbsp;<strong>' + soy.$$escapeHtml(opt_data.spaceName) + '</strong></div>';
};
if (goog.DEBUG) {
  gliffySoy.controls.alert.CompleteAlert.soyTemplateName = 'gliffySoy.controls.alert.CompleteAlert';
}


gliffySoy.controls.alert.ErrorAlert = function(opt_data, opt_ignored) {
  return '<div id="gliffy-alert-save-as-error" class="alert alert-error gliffy-alert"><a href="#" class="close" data-dismiss="alert">&times;</a>' + soy.$$filterNoAutoescape(opt_data.errorDetail) + '</div>';
};
if (goog.DEBUG) {
  gliffySoy.controls.alert.ErrorAlert.soyTemplateName = 'gliffySoy.controls.alert.ErrorAlert';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-basics', location = 'gliffy/ObjectValidatorFactory.js' */
define("gliffy/objectValidatorFactory",["jquery","underscore","gliffy/util"],function(d,b,a){var c=function(f){var e=function(g,i,h){throw new Error(a.format("{0} {1} value ({2}) failed predicate: {3}",f.description,g,d.isFunction(i)?"[function]":i,h))};if(!b.isString(f.description)){f.description="ObjectValidator construction parameters";e("description",f.description,"Expected value to be a string.")}if(typeof f.keyToPredicateMap==="undefined"){f.description="ObjectValidator construction parameters";e("keyToPredicateMap",f.keyToPredicateMap,"Expected value to be defined.")}d.each(f.keyToPredicateMap,function(h,g){if(!b.isFunction(g.func)){e("keyToPredicateMap "+h+".func",g.func,"Expected value to be a function.")}if(!b.isString(g.failureMessage)){e("keyToPredicateMap "+h+".failureMessage",g.failureMessage,"Expected value to be a string.")}});this._={keyToPredicateMap:f.keyToPredicateMap,fail:e}};c.prototype.validate=function(f){var e=this;if(f==null){throw new Error("ObjectValidator.validate() requires non-null input.")}d.each(e._.keyToPredicateMap,function(h,g){if(!g.func(f[h])){e._.fail(h,f[h],g.description)}})};return{create:function(e){return new c(e)},predicates:{isString:{func:b.isString,failureMessage:"Expected value to be a string."},isNumber:{func:b.isNumber,failureMessage:"Expected value to be a number."},isFunction:{func:b.isFunction,failureMessage:"Expected value to be a function."},isArray:{func:b.isArray,failureMessage:"Expected value to be an array."},isTruthy:{func:function(e){return e==true},failureMessage:"Expected value to be truthy."},isFalsey:{func:function(e){return e==false},failureMessage:"Expected value to be falsey."},isDefinedAndNotNull:{func:function(e){return e!=null},failureMessage:"Expected value to be defined and not null."},containsAnyKey:{func:function(e){return Object.keys(e).length>0},failureMessage:"Expected value to contain at least one key."}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-basics', location = 'gliffy/confluence/PageFacade.js' */
define("gliffy/confluence/pageFacade",["jquery","gliffy/confluence/rest/webRequestPromiseFactory"],function(g,h){var i=function(m){var o=h.buildGetPageContentPromise(AJS.params.pageId);var p=function(u){var t=u.body.storage.value;var v=g("<div/>").append(t);var r=v.find("ac\\:parameter[ac\\:name='']");r.remove();var s=v.find("p:has(ac\\:parameter[ac\\:name='version'])p:has(ac\\:parameter[ac\\:name='name'])").filter(function(){var y=g(this).find("ac\\:parameter[ac\\:name='version']").text()===m.version.toString();var x=g(this).find("ac\\:parameter[ac\\:name='name']").text()===m.name;var w=g(this).find("ac\\:parameter[ac\\:name='pageid']");var z=((w.length===0)&&(AJS.params.pageId===m.ownerPageId))||(w.text()===m.ownerPageId.toString());return y&&x&&z});var q=s.find("ac\\:parameter[ac\\:name='version']");q.remove();u.body.storage.value=v.html();u.version.number=u.version.number+1;if(u.ancestors){if(u.ancestors.length===0){delete u.ancestors}else{if(u.ancestors.length>1){u.ancestors=[u.ancestors.pop()]}}}return h.buildPutPageContentPromise(AJS.params.pageId,u)};var n=function(){window.location.reload()};g.when(o).then(p).then(n)};var c=function(m){var o=AJS.format("{0}/rpc/json-rpc/confluenceservice-v2",AJS.Confluence.getContextPath());var p=o+"/getPage";var n=[AJS.params.pageId];g.ajax({type:"POST",url:p,contentType:"application/json",data:JSON.stringify(n),success:function(r){var u=r.content;var w=g("<div/>").append(u);var t=w.find("ac\\:parameter[ac\\:name='']");t.remove();var v=w.find("p:has(ac\\:parameter[ac\\:name='version'])p:has(ac\\:parameter[ac\\:name='name'])").filter(function(){var z=g(this).find("ac\\:parameter[ac\\:name='version']").text()===String(m.version);var y=g(this).find("ac\\:parameter[ac\\:name='name']").text()===m.name;var x=g(this).find("ac\\:parameter[ac\\:name='pageid']");var A=((x.length===0)&&(AJS.params.pageId===m.ownerPageId))||(x.text()===m.ownerPageId.toString());return z&&y&&A});var s=v.find("ac\\:parameter[ac\\:name='version']");s.remove();var q={jsonrpc:"2.0",method:"updatePage",params:[{id:r.id,space:r.space,title:r.title,parentId:r.parentId,version:r.version,content:w.html()},{versionComment:"Unpinned macro version",minorEdit:false}],id:AJS.params.pageId};g.ajax({type:"POST",contentType:"application/json",url:o,data:JSON.stringify(q),success:function(){window.location.reload()}})}})};var d=function(m){if(AJS.Rte&&typeof AJS.Rte.getEditor==="function"&&AJS.Rte.getEditor()){var n;if(m.ownerPageId===AJS.params.pageId){n=AJS.format('.editor-inline-macro[data-macro-parameters="name={0}|version={1}"]',m.name,m.version)}else{n=AJS.format('.editor-inline-macro[data-macro-parameters="name={0}|pageid={2}|version={1}"]',m.name,m.version,m.ownerPageId)}var o=AJS.Rte.getEditor().dom.select(n);AJS.$.each(o,function(r,p){var q=k(g(p));q.version=undefined;a(q,p)})}};var f=function(m){var n=g.extend(true,{},m);if(n.ownerPageId!==AJS.params.pageId){n.pageid=n.ownerPageId}delete n.ownerPageId;if(n.version===0){delete n.version}if(n.size==="O"||n.size==="L"){delete n.size}if(!n.border){delete n.border}if(n.chrome==="full"){delete n.chrome}if(!!n.html5){delete n.html5}return n};var b=function(m){return{ownerPageId:m.pageid||AJS.params.pageId,name:m.name,version:m.version,size:m.size,border:m.border,chrome:m.chrome,html5:m.html5}};var e=function(m){return{ownerPageId:m.data("ceoid")||AJS.params.pageId,name:m.data("filename"),version:m.data("version"),size:m.data("size"),border:m.data("border"),chrome:m.data("chrome"),html5:m.data("html5")}};var a=function(n,o){if(AJS.Rte&&typeof AJS.Rte.getEditor==="function"&&AJS.Rte.getEditor()){var m,p={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:f(n),defaultParameterValue:"",body:""}};AJS.Rte.BookmarkManager.restoreBookmark();m=tinymce.confluence.MacroUtils.insertMacro(p,o);if(m&&m.then){m.then(function(){if(g.browser.msie){tinymce.confluence.NodeUtils.replaceNode=j}},function(){if(g.browser.msie){tinymce.confluence.NodeUtils.replaceNode=j}})}l();return m}else{throw"addDiagramReference not yet implemented for non-RTE"}};var k=function(o){if(AJS.Rte&&typeof AJS.Rte.getEditor==="function"&&AJS.Rte.getEditor()){var n={};var m=o.data&&o.data("macro-parameters");m=m||(o.dataset&&o.dataset.macroParameters);if(m){g.each(m.split("|"),function(p,q){var r=q.split("=");n[r[0]]=r[1]})}return b(n)}else{return e(o)}};var l=function(){if(AJS.Rte&&typeof AJS.Rte.getEditorFrame==="function"&&AJS.Rte.getEditorFrame()){g(AJS.Rte.getEditorFrame()).focus()}var m=g("#gliffy-editor")[0];if(m){m.contentWindow.focus()}};var j=(AJS.Rte&&typeof AJS.Rte.getEditor==="function"&&AJS.Rte.getEditor())?tinymce.confluence.NodeUtils.replaceNode:null;return{unpinDiagramReferenceVersion:function(m){if(AJS.Rte&&typeof AJS.Rte.getEditor==="function"&&AJS.Rte.getEditor()){d(m)}else{var o=AJS.version.split(".");var n=!(parseInt(o[0])>=5&&parseInt(o[1])>=4);if(n){c(m)}else{i(m)}}},addDiagramReference:a,getDiagramReference:k,getDiagramReferences:function(){var m=[];var n;if(AJS.Rte&&typeof AJS.Rte.getEditor==="function"&&AJS.Rte.getEditor()){n=g("iframe").contents().find(".editor-inline-macro[data-macro-name='gliffy']")}else{n=g(".gliffy-container")}n.each(function(o,p){m.push(k(g(p)))});return m}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-basics', location = 'gliffy/confluence/rest/UrlFactory.js' */
define("gliffy/confluence/rest/urlFactory",["gliffy/url"],function(a){var c;if(typeof GLIFFY!=="undefined"&&GLIFFY.baseConfluenceUrl!==undefined&&GLIFFY.baseConfluenceUrl!==null){c=GLIFFY.baseConfluenceUrl}else{c=AJS.params.baseUrl}var b=c+"/rest/gliffy/1.0";return{buildPrependDiagramToPageUrl:function(d){return a.buildRootedPathAndQuery(b,["diagrams","saveas",d.sourcePageId,d.sourceDiagramName],{sourceDiagramVersion:d.sourceDiagramVersion,targetPageId:d.targetPageId,space:d.targetSpaceKey,targetDiagramName:d.targetDiagramName,targetPageTitle:d.targetPageTitle,includeAlertLinkUrlParams:d.includeAlertLinkUrlParams})},buildGetSpacesUrl:function(e,d){return a.buildRootedPathAndQuery(b,["spaces"],{start:e,limit:d})},buildSpaceSearchUrl:function(e,f,d){return a.buildRootedPathAndQuery(b,["spaces"],{searchTerm:e,start:f,limit:d});return b+"/"+pathAndQuery},buildPageSearchUrl:function(e,f,g,d){return a.buildRootedPathAndQuery(b,["page","search"],{searchTerm:e||"",start:g,limit:d,expand:"space",spaceKeys:f&&f.join(",")})},buildPageEditPermissionUrl:function(e,d){return AJS.format("{0}/ceo/{1}/permission",e,d)},buildGetDiagramsInPageUrl:function(d){return a.buildRootedPathAndQuery(b,["page",d,"diagrams"])},buildPageWithTitleExistsInSpaceUrl:function(e,d){return a.buildRootedPathAndQuery(b,["spaces",d,"pageExists"],{title:e})},buildUnlinkDiagramUrl:function(d){return a.buildRootedPathAndQuery(b,["diagrams","unlink",d.sourcePageId,d.sourceDiagramName],{sourceDiagramVersion:d.sourceDiagramVersion,targetPageId:d.targetPageId,targetDiagramName:d.targetDiagramName})},buildPageContentUrl:function(d){return AJS.format("{0}/rest/api/content/{1}?expand=body.storage,version,space,ancestors",c,d)},buildEditDiagramPermissionUrl:function(d,e){return a.buildRootedPathAndQuery(b,["ceo",d,"diagrams",e,"permission"])},buildCreateAttachmentPermissionUrl:function(d){return a.buildRootedPathAndQuery(b,["ceo",d,"permission"])},buildPropertyUrl:function(d){return a.buildRootedPathAndQuery(b,["properties",d])},buildDiagramPreviewImageUrl:function(e,f,d){return a.buildRootedPathAndQuery(b,["diagrams","preview"],{name:f,pageId:e,version:d})},buildDiagramThumbnailImageUrl:function(e,f,d){return a.buildRootedPathAndQuery(b,["diagrams","thumbnail"],{name:f,pageId:e,version:d})},buildGetDiagramVersionsUrl:function(d,e){return a.buildRootedPathAndQuery(b,["diagrams","allVersionInformation"],{pageId:d,name:e})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-basics', location = 'gliffy/confluence/rest/WebRequestPromiseFactory.js' */
define("gliffy/confluence/rest/webRequestPromiseFactory",["jquery","gliffy/confluence/rest/urlFactory"],function(a,b){return{buildPrependDiagramToPagePromise:function(e){var g=b.buildPrependDiagramToPageUrl(e);if(window.GLIFFY&&window.GLIFFY.Mouse&&window.GLIFFY.Mouse.editor){var f=window.GLIFFY.Mouse.editor;var c=f.getDocumentManager().getActiveDocument().toObject();var d=f.getDocumentManager().getActiveStage();if(window.GLIFFY.Spinner){window.GLIFFY.Spinner.show(a("body"))}return f.getDocumentManager().getImageData(d,"image/png",function(h,i){c.image=h;i.resolve(c)},false,1).then(function(){return f.getDocumentManager().getHTMLData(d)}).then(function(h){c.html=h;return a.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(c),url:g})})}else{return a.post(g)}},buildGetSpacesPromise:function(d,c){return a.get(b.buildGetSpacesUrl(d,c))},buildSpaceSearchPromise:function(d,e,c){return a.get(b.buildSpaceSearchUrl(d,e,c))},buildPageSearchPromise:function(d,e,f,c){return a.get(b.buildPageSearchUrl(d,e,f,c))},buildGetDiagramsInPagePromise:function(c){return a.get(b.buildGetDiagramsInPageUrl(c))},buildPageWithTitleExistsInSpacePromise:function(d,c){return a.get(b.buildPageWithTitleExistsInSpaceUrl(d,c))},buildUnlinkDiagramPromise:function(c){return a.post(b.buildUnlinkDiagramUrl(c))},buildGetPageContentPromise:function(c){return a.ajax(b.buildPageContentUrl(c))},buildPutPageContentPromise:function(c,d){return a.ajax({type:"PUT",contentType:"application/json; charset=utf-8",url:b.buildPageContentUrl(c),data:JSON.stringify(d),dataType:"text",processData:false})},buildGetEditPagePermissionPromise:function(d,c){return a.ajax({type:"GET",url:b.buildPageEditPermissionUrl(d,c),dataType:"json",cache:false})},buildGetEditDiagramPermissionPromise:function(c,d){return a.ajax({type:"GET",url:b.buildEditDiagramPermissionUrl(c,d),dataType:"json",cache:false})},buildGetCreateAttachmentPermissionPromise:function(c){return a.ajax({type:"GET",url:b.buildCreateAttachmentPermissionUrl(c),dataType:"json",cache:false})},buildGetPropertyValuePromise:function(d){var c=new a.Deferred();a.get(b.buildPropertyUrl(d)).then(function(e){c.resolve(e[d])});return c},buildGetDiagramVersionsPromise:function(c,d){return a.get(b.buildGetDiagramVersionsUrl(c,d))}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-editor-launcher', location = 'gliffy/controls/imageselection/ImageSelectionControl.soy' */
// This file was automatically generated from ImageSelectionControl.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.widget.image.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.widget == 'undefined') { gliffySoy.widget = {}; }
if (typeof gliffySoy.widget.image == 'undefined') { gliffySoy.widget.image = {}; }


gliffySoy.widget.image.gliffyImageSelectionWidget = function(opt_data, opt_ignored) {
  return '<div class="gliffy-image-selection"><div class="gliffy-image-selection-inner-panel" title="' + soy.$$escapeHtml(opt_data.labelText) + '"><div class="gliffy-image-selection-spinner"/><div><img class="gliffy-image-selection-image" src="' + soy.$$escapeHtml(opt_data.imageUrl) + '"/><div class="gliffy-image-selection-icon gliffy-image-selection-zoom"><img/></div></div></div><div class="gliffy-image-selection-label">' + soy.$$escapeHtml(opt_data.labelText) + '</div></div>';
};
if (goog.DEBUG) {
  gliffySoy.widget.image.gliffyImageSelectionWidget.soyTemplateName = 'gliffySoy.widget.image.gliffyImageSelectionWidget';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-editor-launcher', location = 'gliffy/controls/imageselection/ImageSelectionControlFactory.js' */
define("gliffy/controls/imageselection/imageSelectionControlFactory",["jquery","gliffy/objectValidatorFactory"],function(c,b){var a=function(h){var e=this;b.create({description:"ListTable constructor parameters",keyToPredicateMap:{parent:b.predicates.isDefinedAndNotNull,labelText:b.predicates.isString,imageUrl:b.predicates.isString}}).validate(h);var h=c.extend({isSelected:false},h);var f=gliffySoy.widget.image.gliffyImageSelectionWidget(h);var d=c(f).appendTo(h.parent);d.on("click",function(j){e.setIsSelected(true)});var i=d.find(".gliffy-image-selection-image");var g=d.find(".gliffy-image-selection-zoom");if(i.previewer){g.previewer({src:i.attr("src"),type:"image/png",zindex:10000})}else{g.on("click",function(k){var j=i.clone();j.removeClass("gliffy-image-selection-image");j.addClass("gliffy-image-selection-fancybox-image");c.fancybox({orig:i,content:j,showCloseButton:true,hideOnOverlayClick:true,hideOnContentClick:true})})}this._={domRoot:d,labelText:h.labelText,imageUrl:h.imageUrl,isSelected:!h.isSelected,selectionChangedListeners:[],};this.setIsSelected(h.isSelected)};a.prototype.getIsSelected=function(){return this._.isSelected};a.prototype.setIsSelected=function(e){if(this._.isSelected===e){return}this._.isSelected=e;if(e){this._.domRoot.addClass("gliffy-image-selected")}else{this._.domRoot.removeClass("gliffy-image-selected")}var d=this;this._.selectionChangedListeners.forEach(function(f){f({source:d,isSelected:e})})};a.prototype.getDomRoot=function(){return this._.domRoot};a.prototype.addSelectionChangedListener=function(d){this._.selectionChangedListeners.push(d)};return{create:function(d){return new a(d)}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-editor-launcher', location = 'gliffy/confluence/versionselection/VersionSelectionDialog.soy' */
// This file was automatically generated from VersionSelectionDialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace gliffySoy.dialog.version.
 */

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.dialog == 'undefined') { gliffySoy.dialog = {}; }
if (typeof gliffySoy.dialog.version == 'undefined') { gliffySoy.dialog.version = {}; }


gliffySoy.dialog.version.versionSelectionDialogBody = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui top-label"><div class="gliffy-version-dialog-panel"><div class="gliffy-version-dialog-description">' + soy.$$escapeHtml(opt_data.promptText) + '</div><div class="gliffy-image-selection-widget-area"/></div></form>';
};
if (goog.DEBUG) {
  gliffySoy.dialog.version.versionSelectionDialogBody.soyTemplateName = 'gliffySoy.dialog.version.versionSelectionDialogBody';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-editor-launcher', location = 'gliffy/confluence/versionselection/VersionSelectionDialogFactory.js' */
define("gliffy/confluence/versionselection/versionSelectionDialogFactory",["jquery","gliffy/controls/imageselection/imageSelectionControlFactory","gliffy/objectValidatorFactory"],function(c,d,b){var a=function(f){var e=this;var f=c.extend({onCancel:function(){}},f);b.create({description:"VersionSelectionDialog constructor parameters",keyToPredicateMap:{headerText:b.predicates.isString,promptText:b.predicates.isString,attachmentVersion:b.predicates.isNumber,diagramName:b.predicates.isString,ownerPageId:b.predicates.isDefinedAndNotNull,referencePageId:b.predicates.isDefinedAndNotNull,pinnedIsDefault:b.predicates.isDefinedAndNotNull,onComplete:b.predicates.isFunction}}).validate(f);this._={hasBeenShown:false,parameters:f,pinnedVersionIsSelected:f.pinnedIsDefault,buildDom:function(){var h=gliffySoy.dialog.version.versionSelectionDialogBody({promptText:f.promptText});var k=c(h);var j=k.find(".gliffy-image-selection-widget-area");var i=d.create({parent:j,labelText:AJS.format("Version {0}",f.attachmentVersion),imageUrl:AJS.format("{0}/download/attachments/{1}/{2}.png?api=v2&version={3}&modificationDate=0",e._.parameters.contextPath,e._.parameters.ownerPageId,encodeURIComponent(e._.parameters.diagramName),e._.parameters.attachmentVersion),isSelected:f.pinnedIsDefault});var g=d.create({parent:j,labelText:"Latest",imageUrl:AJS.format("{0}/download/attachments/{1}/{2}.png?api=v2&timestamp={3}",e._.parameters.contextPath,e._.parameters.ownerPageId,encodeURIComponent(e._.parameters.diagramName),new Date().getTime()),isSelected:!f.pinnedIsDefault});i.getDomRoot().addClass("left");g.getDomRoot().addClass("right");i.addSelectionChangedListener(function(l){if(l.isSelected){g.setIsSelected(false);e._.pinnedVersionIsSelected=true}});g.addSelectionChangedListener(function(l){if(l.isSelected){i.setIsSelected(false);e._.pinnedVersionIsSelected=false}});return k}}};a.prototype.show=function(){var e=this;if(e._.hasBeenShown){throw new Error("versionSelectionDialogFactory can be shown only once per instance lifetime.")}var f=new AJS.Dialog({width:600,height:380,closeOnOutsideClick:false});f.addHeader(e._.parameters.headerText);f.addPanel("",e._.buildDom(),"panel-body");f.addLink("Cancel",function(g){g.remove()},"aui-button gliffy-dialog-cancel");f.addButton("Select",function(g){g.remove();e._.parameters.onComplete(e._.pinnedVersionIsSelected)});f.show();e._.hasBeenShown=true};return{create:function(e){return new a(e)}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-editor-launcher', location = 'gliffy/confluence/versionselection/VersionSelectionDialogController.js' */
define("gliffy/confluence/versionselection/versionSelectionDialogController",["jquery","gliffy/objectValidatorFactory","gliffy/confluence/versionselection/versionSelectionDialogFactory"],function(b,a,c){return{showUnpinMacroDiagramVersionDialog:function(d){c.create(b.extend({headerText:"Select Diagram Version to Display",promptText:AJS.format("Version {0} is currently pinned to this page. Which version would you like to display?",d.attachmentVersion),pinnedIsDefault:false},d)).show()},showSelectVersionToEditDialog:function(d){c.create(b.extend({headerText:"Select Diagram Version to Edit",promptText:AJS.format("Version {0} is currently pinned to this page. Which version you would like to edit?",d.attachmentVersion),pinnedIsDefault:true},d)).show()}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-editor-launcher', location = 'gliffy/confluence/versionselection/VersionSelectionController.js' */
require("gliffy/amd/apexModuleManager").define("gliffy/confluence/versionselection/versionSelectionController",["jquery","gliffy/url","gliffy/confluence/pageFacade","gliffy/confluence/versionselection/versionSelectionDialogController"],function(d,c,b,a){var e=function(){var h=window.localStorage.getItem("com.gliffy.confluence.diagram.edited");if(h){window.localStorage.removeItem("com.gliffy.confluence.diagram.edited");var j=JSON.parse(h);if(j){var g=c.parse(j.url).queryParams;var k=0;if(g.originalAttachmentVersion){k=parseInt(g.originalAttachmentVersion)}else{if(g.attachmentVersion){k=parseInt(g.attachmentVersion)}}var i=b.getDiagramReferences().filter(function(l){return(l.name===g.name)});if(k>0&&(g.inline==="true"||i.length>0)){var f={ownerPageId:g.ceoid,name:g.name,version:k};a.showUnpinMacroDiagramVersionDialog({ownerPageId:f.ownerPageId,diagramName:f.name,attachmentVersion:f.version,referencePageId:AJS.params.pageId,contextPath:AJS.Confluence.getContextPath(),onComplete:function(l){if(!l){b.unpinDiagramReferenceVersion(f)}}})}}}};AJS.bind("gliffy.confluence.inlineEditorClosed",function(){e()});d(function(){e()})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-confluence-editor-launcher', location = 'gliffy/confluence/editor/EditorLauncher.js' */
define("gliffy/confluence/editor/editorLauncher",["jquery","gliffy/objectValidatorFactory","gliffy/confluence/versionselection/versionSelectionDialogController"],function(d,c,a){var b=function(e,g,f,i,h){if(i&&i>0){d.ajax({url:e+"/rest/gliffy/1.0/diagrams/allVersionInformation",type:"GET",data:{name:g,pageId:f},success:function(j){h(j.numRevisions!==parseInt(i))},error:function(j){h(false)}})}else{h(false)}};return{launchEditorFromViewPage:function(e){var e=d.extend({contextPath:AJS.Confluence.getContextPath()},e);b(e.contextPath,e.diagramName,e.ownerPageId,e.attachmentVersion,function(f){if(f){a.showSelectVersionToEditDialog(d.extend({onComplete:function(g){var h;if(g){h=e.url}else{h=e.url.replace("attachmentVersion=","originalAttachmentVersion=")}window.open(h,"_self")}},e))}else{window.open(e.url,"_self")}})},launchEditorFromEditPage:function(e){var e=d.extend({contextPath:AJS.Confluence.getContextPath()},e);b(e.contextPath,e.diagramName,e.ownerPageId,e.attachmentVersion,function(f){if(f){a.showSelectVersionToEditDialog(d.extend({onComplete:function(g){if(!g){e.originalAttachmentVersion=e.attachmentVersion;e.attachmentVersion=0}AJS.trigger("gliffy.confluence.launchInlineEditor",[e])}},e))}else{AJS.trigger("gliffy.confluence.launchInlineEditor",[e])}})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-spinner', location = 'gliffy/GliffySpinner.js' */
define("GliffySpinner",["thirdparty/spinjs"],function(a){var c=function(e){var f;var d=0;do{f=$(e).css("z-index");e=$(e).parent()[0];d++}while(isNaN(f)&&e.tagName);if(isNaN(f)){f=0}return f};var b=function(e,d){d=d||{};d.radius=d.radius||20;d.color=d.color||"#000";$(e).prepend("<span></span>");this.container=$(e).find("span").get(0);$(this.container).addClass("gliffy-spinner-container");if(d.inline){$(this.container).css("position","relative");this.inline=true}else{var i=c(e);$(this.container).css("position","absolute").css("z-index",i+1)}var f=d.radius;d.length=0.5*f;d.radius=0.5*f;d.lines=12;d.corners=1;d.width=0.4*d.length;var h=a();var g=new h.Spinner(d).spin();this.container.appendChild(g.el);if(!d.inline){$(this.container).css("left",$(e).width()/2-$(this.container).width()/2).css("top",$(e).height()/2-$(this.container).height()/2)}$(this.container).hide();this.start=function(){if($(this.container).parent().css("position")==="static"){if(!this.inline){$(this.container).parent().css("position","relative");this.positioned=true}}$(this.container).show()};this.stop=function(){if(this.positioned){$(e).parent().css("position","static");this.positioned=false}$(this.container).hide()}};return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-spinner', location = 'thirdparty/spin.js' */
define("thirdparty/spinjs",[],function(){return function(){var a=new Object();(function(b,c){if(typeof exports=="object"){module.exports=c()}else{if(typeof define=="function"&&define.amd){define(c)}else{b.Spinner=c()}}}(a,function(){var f=["webkit","Moz","ms","O"],p={},o,j;function h(q,t){var r=document.createElement(q||"div"),s;for(s in t){r[s]=t[s]}return r}function i(r){for(var q=1,s=arguments.length;q<s;q++){r.appendChild(arguments[q])}return r}function d(u,q,v,y){var r=["opacity",q,~~(u*100),v,y].join("-"),s=0.01+v/y*100,x=Math.max(1-(1-u)/q*(100-s),u),w=o.substring(0,o.indexOf("Animation")).toLowerCase(),t=w&&"-"+w+"-"||"";if(!p[r]){j.insertRule("@"+t+"keyframes "+r+"{0%{opacity:"+x+"}"+s+"%{opacity:"+u+"}"+(s+0.01)+"%{opacity:1}"+(s+q)%100+"%{opacity:"+u+"}100%{opacity:"+x+"}}",j.cssRules.length);p[r]=1}return r}function m(u,v){var t=u.style,q,r;v=v.charAt(0).toUpperCase()+v.slice(1);if(t[v]!==undefined){return v}for(r=0;r<f.length;r++){q=f[r]+v;if(t[q]!==undefined){return q}}}function g(q,s){for(var r in s){q.style[m(q,r)||r]=s[r]}return q}function k(s){for(var q=1;q<arguments.length;q++){var r=arguments[q];for(var t in r){if(s[t]===undefined){s[t]=r[t]}}}return s}function n(r,q){return typeof r=="string"?r:r[q%r.length]}var e={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:1/4,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2000000000,className:"spinner",top:"50%",left:"50%",shadow:false,hwaccel:false,position:"absolute"};function c(q){this.opts=k(q||{},c.defaults,e)}c.defaults={};k(c.prototype,{spin:function(z){this.stop();var B=this,r=B.opts,s=B.el=h(null,{className:r.className});g(s,{position:r.position,width:0,zIndex:r.zIndex,left:r.left,top:r.top});if(z){z.insertBefore(s,z.firstChild||null)}s.setAttribute("role","progressbar");B.lines(s,B.opts);if(!o){var w=0,q=(r.lines-1)*(1-r.direction)/2,v,t=r.fps,y=t/r.speed,x=(1-r.opacity)/(y*r.trail/100),A=y/r.lines;(function u(){w++;for(var C=0;C<r.lines;C++){v=Math.max(1-(w+(r.lines-C)*A)%y*x,r.opacity);B.opacity(s,C*r.direction+q,v,r)}B.timeout=B.el&&setTimeout(u,~~(1000/t))})()}return B},stop:function(){var q=this.el;if(q){clearTimeout(this.timeout);if(q.parentNode){q.parentNode.removeChild(q)}this.el=undefined}return this},lines:function(s,u){var r=0,v=(u.lines-1)*(1-u.direction)/2,q;function t(w,x){return g(h(),{position:"absolute",width:u.scale*(u.length+u.width)+"px",height:u.scale*u.width+"px",background:w,boxShadow:x,transformOrigin:"left",transform:"rotate("+~~(360/u.lines*r+u.rotate)+"deg) translate("+u.scale*u.radius+"px,0)",borderRadius:(u.corners*u.scale*u.width>>1)+"px"})}for(;r<u.lines;r++){q=g(h(),{position:"absolute",top:1+~(u.scale*u.width/2)+"px",transform:u.hwaccel?"translate3d(0,0,0)":"",opacity:u.opacity,animation:o&&d(u.opacity,u.trail,v+r*u.direction,u.lines)+" "+1/u.speed+"s linear infinite"});if(u.shadow){i(q,g(t("#000","0 0 4px #000"),{top:"2px"}))}i(s,i(q,t(n(u.color,r),"0 0 1px rgba(0,0,0,.1)")))}return s},opacity:function(r,q,s){if(q<r.childNodes.length){r.childNodes[q].style.opacity=s}}});function l(){function q(s,r){return h("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',r)}j.addRule(".spin-vml","behavior:url(#default#VML)");c.prototype.lines=function(v,u){var t=u.scale*(u.length+u.width),B=u.scale*2*t;function A(){return g(q("group",{coordsize:B+" "+B,coordorigin:-t+" "+-t}),{width:B,height:B})}var w=-(u.width+u.length)*u.scale*2+"px",z=g(A(),{position:"absolute",top:w,left:w}),y;function x(s,r,C){i(z,i(g(A(),{rotation:360/u.lines*s+"deg",left:~~r}),i(g(q("roundrect",{arcsize:u.corners}),{width:t,height:u.scale*u.width,left:u.scale*u.radius,top:-u.scale*u.width>>1,filter:C}),q("fill",{color:n(u.color,s),opacity:u.opacity}),q("stroke",{opacity:0}))))}if(u.shadow){for(y=1;y<=u.lines;y++){x(y,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(y=1;y<=u.lines;y++){x(y)}return i(v,z)};c.prototype.opacity=function(s,r,u,t){var v=s.firstChild;t=t.shadow&&t.lines||0;if(v&&r+t<v.childNodes.length){v=v.childNodes[r+t];v=v&&v.firstChild;v=v&&v.firstChild;if(v){v.opacity=u}}}}if(typeof document!=="undefined"){j=(function(){var q=h("style",{type:"text/css"});i(document.getElementsByTagName("head")[0],q);return q.sheet||q.styleSheet}());var b=g(h("group"),{behavior:"url(#default#VML)"});if(!m(b,"transform")&&b.adj){l()}else{o=m(b,"animation")}}return c}));return a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-global-resources', location = 'js/gliffy-on-confluence-init.js' */
AJS.toInit(function(){AJS.$("table.attachments tr").each(function(a,b){AJS.$(b).find("td.attachment-actions a").each(function(c,d){if(AJS.$(d).attr("href").indexOf("/plugins/gliffy/view")!=-1){AJS.$(b).find("td.filename-column span").removeClass("icon-file-xml icon-file-unknown").addClass("gliffy-document-icon").attr("title","Gliffy File").text("Gliffy File")}})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-global-resources', location = 'js/gliffy-blueprint-registration.js' */
AJS.toInit(function(){if(Confluence&&Confluence.Blueprint&&Confluence.Blueprint.register){Confluence.Blueprint.register("com.gliffy.integration.confluence:gliffy-blueprint-item-main",function(e,f,d){window.location=Confluence.getContextPath()+"/pages/createpage.action?showGliffyMacro=true&fromCreateDialog=true&spaceKey="+encodeURIComponent(f)+"&newSpaceKey="+encodeURIComponent(f)+(e.getParentPageId()?"&fromPageId="+e.getParentPageId():"")});var c=function(d){Confluence.Blueprint.register("com.gliffy.integration.confluence:gliffy-blueprint-item-"+d,function(f,g,e){window.location=Confluence.getContextPath()+"/pages/createpage.action?showGliffyMacro=true&createDiagramType="+d+"&spaceKey="+encodeURIComponent(g)+"&newSpaceKey="+encodeURIComponent(g)+(f.getParentPageId()?"&fromPageId="+f.getParentPageId():"")})};var b=["org","network","software"];for(var a=0;a<b.length;a++){c(b[a])}Confluence.Blueprint.register("com.gliffy.integration.confluence:gliffy-blueprint-item-pack",function(e,h,d){var i=e.addPage("myplugin-step-2"),g=function(){var k=$("#my-title").val();var j=$("#my-text-field").val();d(k,{myName:j})};var f='<div class="template-select-container-body"><ol class="templates" tabindex="100"><li class="template selected"data-item-module-complete-key="com.gliffy.integration.confluence:gliffy-blueprint-item-main"><imgclass="template-preview"src="/confluence/s/en_GB-1988229788/4103/31cc10c48352e244f00edd8fa27d95566a28e0c5.1/0.0-SNAPSHOT/_/download/resources/com.gliffy.integration.confluence:gliffy-blueprint-item-main/icon"><div class="template-meta"><div class="template-name" title="Gliffy Diagram">Corporate Org Chart</div><div class="template-description" title="Add a blank page with a Gliffy Diagram.">Add a page with a Corporate Org Chart</div></div></li><li class="template"data-item-module-complete-key="com.gliffy.integration.confluence:gliffy-blueprint-item-pack"><imgclass="template-preview"src="/confluence/s/en_GB-1988229788/4103/31cc10c48352e244f00edd8fa27d95566a28e0c5.1/0.0-SNAPSHOT/_/download/resources/com.gliffy.integration.confluence:gliffy-blueprint-item-pack/icon"><div class="template-meta"><div class="template-name" title="Gliffy Human Resources Pack">Reimbursement Process</div><div class="template-description" title="Choose from a list of diagrams relating to Human Resources.">Add a page with that shows a Reimbursement Process in your organization</div></div></li><li class="template"data-item-module-complete-key="com.gliffy.integration.confluence:gliffy-blueprint-item-pack"><imgclass="template-preview"src="/confluence/s/en_GB-1988229788/4103/31cc10c48352e244f00edd8fa27d95566a28e0c5.1/0.0-SNAPSHOT/_/download/resources/com.gliffy.integration.confluence:gliffy-blueprint-item-pack/icon"><div class="template-meta"><div class="template-name" title="Gliffy Human Resources Pack">Termination Process</div><div class="template-description" title="Choose from a list of diagrams relating to Human Resources.">Shows you how to fire the guy who had ten too many tequila shots at the last company party.</div></div></li></ol></div>';i.addHeader("Gliffy Human Resources Pack").addPanel("SinglePanel",f,"singlePanel").addButton("Previous",function(j){j.prevPage();j.page.pop()},"").addButton("Create",g,"aui-button-primary create-dialog-create-button").addLink("Close",function(j){j.remove()},"");i.getPanel(0).setPadding(0);$("#my-title").focus();$("#myplugin-form").submit(function(){g(e);return false});return false})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-global-resources', location = 'js/gliffy-footer.js' */
AJS.toInit(function(){if(AJS.version>="3.0"){var a=AJS.$("#poweredby:visible");if(a.length>0){a.before(AJS.template.load("gliffy-webpanel-footer"))}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-global-resources', location = 'gliffy/confluence/ContextFinalizer.js' */
(function(b,a){b(function(){a.instantiateAll();a.reset()})})(require("jquery"),require("gliffy/amd/apexModuleManager"));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jirachart-resources', location = '/jirachart/jirachart.js' */
AJS.toInit(function(){AJS.$(".jira-chart-macro-img").load(function(a){AJS.log("Jira Chart Macro - chart image loaded");AJS.$(".insert-jira-chart-macro-button",window.parent.document).enable()}).error(function(d){AJS.log("Jira Chart Macro - chart image loaded error");AJS.$(".insert-jira-chart-macro-button",window.parent.document).disable();var e=AJS.$(d.target);var c=e.parent();var b=c.parent();c.remove();var a="Unable to render JIRA chart macro due to an execution error.";AJS.messages.error(b,{body:a})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jirachart-resources', location = '/jirachart/twodimensionalchart-showlink.js' */
var TwoDimensionalShowLink=(function(e){var d=function(i){var h=e("#two-dimensional-chart-"+i);var g=h.position();e("<div />",{id:"twodimensional-dark-layout-"+i,"class":"jim-sortable-dark-layout",css:{top:g.top+"px",left:g.left+"px",width:h.width()+"px",height:h.height()+"px"}}).appendTo(h.parent())};var a=function(g){e("#twodimensional-dark-layout-"+g).remove()};var b=function(){var h=e(this).attr("data-chart-id");d(h);var g={pageId:e("#chart-page-id-"+h).val(),wikiMarkup:e("#chart-wiki-"+h).val(),isShowMore:e(this).attr("data-is-show-more")};AJS.$.ajax({type:"POST",dataType:"html",url:Confluence.getContextPath()+"/plugins/servlet/twoDimensionalShowMoreRenderer",data:g,success:function(i){if(e(i).find(".aui-message.error").length){var j=e(i).find(".message").text();e("#two-dimensional-chart-"+h).find(".show-error").html(j)}else{var k=e(i).find(".show-link-container a").attr("data-chart-id");e("#two-dimensional-chart-"+h).replaceWith(i);c(k)}a(h)},error:function(){e("#two-dimensional-chart-"+h).find(".show-error").html("Unable to render JIRA chart macro. Execution has timed out.");a(h)}})};var c=function(g){e("#show-link-"+g).on("click",b)};var f=function(){e(".show-link-container a").each(function(){c(e(this).attr("data-chart-id"))})};return{init:f}})(AJS.$);AJS.$(function(){TwoDimensionalShowLink.init()});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/flowboard-capture.js' */
window.FlowBoard={};FlowBoard.__ojq=$;FlowBoard.__o$=$;FlowBoard.__ou=_;FlowBoard.__obb=Backbone;
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/vendor/jquery.all.js' */
/*!
 * jQuery JavaScript Library v1.10.1
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-30T21:49Z
 */
!function(t,e){function i(t){var e=t.length,i=ce.type(t);return ce.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||"function"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t)}function n(t){var e=Te[t]={};return ce.each(t.match(de)||[],function(t,i){e[i]=!0}),e}function s(t,i,n,s){if(ce.acceptData(t)){var o,r,a=ce.expando,l=t.nodeType,h=l?ce.cache:t,c=l?t[a]:t[a]&&a;if(c&&h[c]&&(s||h[c].data)||n!==e||"string"!=typeof i){return c||(c=l?t[a]=ee.pop()||ce.guid++:a),h[c]||(h[c]=l?{}:{toJSON:ce.noop}),("object"==typeof i||"function"==typeof i)&&(s?h[c]=ce.extend(h[c],i):h[c].data=ce.extend(h[c].data,i)),r=h[c],s||(r.data||(r.data={}),r=r.data),n!==e&&(r[ce.camelCase(i)]=n),"string"==typeof i?(o=r[i],null==o&&(o=r[ce.camelCase(i)])):o=r,o}}}function o(t,e,i){if(ce.acceptData(t)){var n,s,o=t.nodeType,r=o?ce.cache:t,l=o?t[ce.expando]:ce.expando;if(r[l]){if(e&&(n=i?r[l]:r[l].data)){ce.isArray(e)?e=e.concat(ce.map(e,ce.camelCase)):e in n?e=[e]:(e=ce.camelCase(e),e=e in n?[e]:e.split(" ")),s=e.length;for(;s--;){delete n[e[s]]}if(i?!a(n):!ce.isEmptyObject(n)){return}}(i||(delete r[l].data,a(r[l])))&&(o?ce.cleanData([t],!0):ce.support.deleteExpando||r!=r.window?delete r[l]:r[l]=null)}}}function r(t,i,n){if(n===e&&1===t.nodeType){var s="data-"+i.replace(Me,"-$1").toLowerCase();if(n=t.getAttribute(s),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:De.test(n)?ce.parseJSON(n):n}catch(o){}ce.data(t,i,n)}else{n=e}}return n}function a(t){var e;for(e in t){if(("data"!==e||!ce.isEmptyObject(t[e]))&&"toJSON"!==e){return !1}}return !0}function l(){return !0}function h(){return !1}function c(){try{return Q.activeElement}catch(t){}}function u(t,e){do{t=t[e]}while(t&&1!==t.nodeType);return t}function d(t,e,i){if(ce.isFunction(e)){return ce.grep(t,function(t,n){return !!e.call(t,n,t)!==i})}if(e.nodeType){return ce.grep(t,function(t){return t===e!==i})}if("string"==typeof e){if($e.test(e)){return ce.filter(e,t,i)}e=ce.filter(e,t)}return ce.grep(t,function(t){return ce.inArray(t,e)>=0!==i})}function p(t){var e=Ue.split("|"),i=t.createDocumentFragment();if(i.createElement){for(;e.length;){i.createElement(e.pop())}}return i}function f(t,e){return ce.nodeName(t,"table")&&ce.nodeName(1===e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function m(t){return t.type=(null!==ce.find.attr(t,"type"))+"/"+t.type,t}function g(t){var e=si.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function v(t,e){for(var i,n=0;null!=(i=t[n]);n++){ce._data(i,"globalEval",!e||ce._data(e[n],"globalEval"))}}function y(t,e){if(1===e.nodeType&&ce.hasData(t)){var i,n,s,o=ce._data(t),r=ce._data(e,o),a=o.events;if(a){delete r.handle,r.events={};for(i in a){for(n=0,s=a[i].length;s>n;n++){ce.event.add(e,i,a[i][n])}}}r.data&&(r.data=ce.extend({},r.data))}}function b(t,e){var i,n,s;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!ce.support.noCloneEvent&&e[ce.expando]){s=ce._data(e);for(n in s.events){ce.removeEvent(e,n,s.handle)}e.removeAttribute(ce.expando)}"script"===i&&e.text!==t.text?(m(e).text=t.text,g(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),ce.support.html5Clone&&t.innerHTML&&!ce.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&ei.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function _(t,i){var n,s,o=0,r=typeof t.getElementsByTagName!==V?t.getElementsByTagName(i||"*"):typeof t.querySelectorAll!==V?t.querySelectorAll(i||"*"):e;if(!r){for(r=[],n=t.childNodes||t;null!=(s=n[o]);o++){!i||ce.nodeName(s,i)?r.push(s):ce.merge(r,_(s,i))}}return i===e||i&&ce.nodeName(t,i)?ce.merge([t],r):r}function w(t){ei.test(t.type)&&(t.defaultChecked=t.checked)}function x(t,e){if(e in t){return e}for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,s=Ci.length;s--;){if(e=Ci[s]+i,e in t){return e}}return n}function k(t,e){return t=e||t,"none"===ce.css(t,"display")||!ce.contains(t.ownerDocument,t)}function C(t,e){for(var i,n,s,o=[],r=0,a=t.length;a>r;r++){n=t[r],n.style&&(o[r]=ce._data(n,"olddisplay"),i=n.style.display,e?(o[r]||"none"!==i||(n.style.display=""),""===n.style.display&&k(n)&&(o[r]=ce._data(n,"olddisplay",S(n.nodeName)))):o[r]||(s=k(n),(i&&"none"!==i||!s)&&ce._data(n,"olddisplay",s?i:ce.css(n,"display"))))}for(r=0;a>r;r++){n=t[r],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?o[r]||"":"none"))}return t}function T(t,e,i){var n=vi.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function D(t,e,i,n,s){for(var o=i===(n?"border":"content")?4:"width"===e?1:0,r=0;4>o;o+=2){"margin"===i&&(r+=ce.css(t,i+ki[o],!0,s)),n?("content"===i&&(r-=ce.css(t,"padding"+ki[o],!0,s)),"margin"!==i&&(r-=ce.css(t,"border"+ki[o]+"Width",!0,s))):(r+=ce.css(t,"padding"+ki[o],!0,s),"padding"!==i&&(r+=ce.css(t,"border"+ki[o]+"Width",!0,s)))}return r}function M(t,e,i){var n=!0,s="width"===e?t.offsetWidth:t.offsetHeight,o=ci(t),r=ce.support.boxSizing&&"border-box"===ce.css(t,"boxSizing",!1,o);if(0>=s||null==s){if(s=ui(t,e,o),(0>s||null==s)&&(s=t.style[e]),yi.test(s)){return s}n=r&&(ce.support.boxSizingReliable||s===t.style[e]),s=parseFloat(s)||0}return s+D(t,e,i||(r?"border":"content"),n,o)+"px"}function S(t){var e=Q,i=_i[t];return i||(i=I(t,e),"none"!==i&&i||(hi=(hi||ce("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(hi[0].contentWindow||hi[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),i=I(t,e),hi.detach()),_i[t]=i),i}function I(t,e){var i=ce(e.createElement(t)).appendTo(e.body),n=ce.css(i[0],"display");return i.remove(),n}function E(t,e,i,n){var s;if(ce.isArray(e)){ce.each(e,function(e,s){i||Di.test(t)?n(t,s):E(t+"["+("object"==typeof s?e:"")+"]",s,i,n)})}else{if(i||"object"!==ce.type(e)){n(t,e)}else{for(s in e){E(t+"["+s+"]",e[s],i,n)}}}}function N(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,s=0,o=e.toLowerCase().match(de)||[];if(ce.isFunction(i)){for(;n=o[s++];){"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}}}function A(t,e,i,n){function s(a){var l;return o[a]=!0,ce.each(t[a]||[],function(t,a){var h=a(e,i,n);return"string"!=typeof h||r||o[h]?r?!(l=h):void 0:(e.dataTypes.unshift(h),s(h),!1)}),l}var o={},r=t===Bi;return s(e.dataTypes[0])||!o["*"]&&s("*")}function P(t,i){var n,s,o=ce.ajaxSettings.flatOptions||{};for(s in i){i[s]!==e&&((o[s]?t:n||(n={}))[s]=i[s])}return n&&ce.extend(!0,t,n),t}function R(t,i,n){for(var s,o,r,a,l=t.contents,h=t.dataTypes;"*"===h[0];){h.shift(),o===e&&(o=t.mimeType||i.getResponseHeader("Content-Type"))}if(o){for(a in l){if(l[a]&&l[a].test(o)){h.unshift(a);break}}}if(h[0] in n){r=h[0]}else{for(a in n){if(!h[0]||t.converters[a+" "+h[0]]){r=a;break}s||(s=a)}r=r||s}return r?(r!==h[0]&&h.unshift(r),n[r]):void 0}function H(t,e,i,n){var s,o,r,a,l,h={},c=t.dataTypes.slice();if(c[1]){for(r in t.converters){h[r.toLowerCase()]=t.converters[r]}}for(o=c.shift();o;){if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=c.shift()){if("*"===o){o=l}else{if("*"!==l&&l!==o){if(r=h[l+" "+o]||h["* "+o],!r){for(s in h){if(a=s.split(" "),a[1]===o&&(r=h[l+" "+a[0]]||h["* "+a[0]])){r===!0?r=h[s]:h[s]!==!0&&(o=a[0],c.unshift(a[1]));break}}}if(r!==!0){if(r&&t["throws"]){e=r(e)}else{try{e=r(e)}catch(u){return{state:"parsererror",error:r?u:"No conversion from "+l+" to "+o}}}}}}}}return{state:"success",data:e}}function O(){try{return new t.XMLHttpRequest}catch(e){}}function j(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function z(){return setTimeout(function(){Gi=e}),Gi=ce.now()}function F(t,e,i){for(var n,s=(on[e]||[]).concat(on["*"]),o=0,r=s.length;r>o;o++){if(n=s[o].call(i,e,t)){return n}}}function W(t,e,i){var n,s,o=0,r=sn.length,a=ce.Deferred().always(function(){delete l.elem}),l=function(){if(s){return !1}for(var e=Gi||z(),i=Math.max(0,h.startTime+h.duration-e),n=i/h.duration||0,o=1-n,r=0,l=h.tweens.length;l>r;r++){h.tweens[r].run(o)}return a.notifyWith(t,[h,o,i]),1>o&&l?i:(a.resolveWith(t,[h]),!1)},h=a.promise({elem:t,props:ce.extend({},e),opts:ce.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Gi||z(),duration:i.duration,tweens:[],createTween:function(e,i){var n=ce.Tween(t,h.opts,e,i,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(n),n},stop:function(e){var i=0,n=e?h.tweens.length:0;if(s){return this}for(s=!0;n>i;i++){h.tweens[i].run(1)}return e?a.resolveWith(t,[h,e]):a.rejectWith(t,[h,e]),this}}),c=h.props;for(L(c,h.opts.specialEasing);r>o;o++){if(n=sn[o].call(h,t,c,h.opts)){return n}}return ce.map(c,F,h),ce.isFunction(h.opts.start)&&h.opts.start.call(t,h),ce.fx.timer(ce.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function L(t,e){var i,n,s,o,r;for(i in t){if(n=ce.camelCase(i),s=e[n],o=t[i],ce.isArray(o)&&(s=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),r=ce.cssHooks[n],r&&"expand" in r){o=r.expand(o),delete t[n];for(i in o){i in t||(t[i]=o[i],e[i]=s)}}else{e[n]=s}}}function $(t,e,i){var n,s,o,r,a,l,h=this,c={},u=t.style,d=t.nodeType&&k(t),p=ce._data(t,"fxshow");i.queue||(a=ce._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,ce.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height" in e||"width" in e)&&(i.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===ce.css(t,"display")&&"none"===ce.css(t,"float")&&(ce.support.inlineBlockNeedsLayout&&"inline"!==S(t.nodeName)?u.zoom=1:u.display="inline-block")),i.overflow&&(u.overflow="hidden",ce.support.shrinkWrapBlocks||h.always(function(){u.overflow=i.overflow[0],u.overflowX=i.overflow[1],u.overflowY=i.overflow[2]}));for(n in e){if(s=e[n],tn.exec(s)){if(delete e[n],o=o||"toggle"===s,s===(d?"hide":"show")){continue}c[n]=p&&p[n]||ce.style(t,n)}}if(!ce.isEmptyObject(c)){p?"hidden" in p&&(d=p.hidden):p=ce._data(t,"fxshow",{}),o&&(p.hidden=!d),d?ce(t).show():h.done(function(){ce(t).hide()}),h.done(function(){var e;ce._removeData(t,"fxshow");for(e in c){ce.style(t,e,c[e])}});for(n in c){r=F(d?p[n]:0,n,h),n in p||(p[n]=r.start,d&&(r.end=r.start,r.start="width"===n||"height"===n?1:0))}}}function B(t,e,i,n,s){return new B.prototype.init(t,e,i,n,s)}function q(t,e){var i,n={height:t},s=0;for(e=e?1:0;4>s;s+=2-e){i=ki[s],n["margin"+i]=n["padding"+i]=t}return e&&(n.opacity=n.width=t),n}function K(t){return ce.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var U,Y,V=typeof e,X=t.location,Q=t.document,J=Q.documentElement,G=t.$,Z=t.$,te={},ee=[],ie="1.10.1",ne=ee.concat,se=ee.push,oe=ee.slice,re=ee.indexOf,ae=te.toString,le=te.hasOwnProperty,he=ie.trim,ce=function(t,e){return new ce.fn.init(t,e,Y)},ue=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,de=/\S+/g,pe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,fe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,me=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ge=/^[\],:{}\s]*$/,ve=/(?:^|:|,)(?:\s*\[)+/g,ye=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,be=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,_e=/^-ms-/,we=/-([\da-z])/gi,xe=function(t,e){return e.toUpperCase()},ke=function(t){(Q.addEventListener||"load"===t.type||"complete"===Q.readyState)&&(Ce(),ce.ready())},Ce=function(){Q.addEventListener?(Q.removeEventListener("DOMContentLoaded",ke,!1),t.removeEventListener("load",ke,!1)):(Q.detachEvent("onreadystatechange",ke),t.detachEvent("onload",ke))};ce.fn=ce.prototype={jquery:ie,constructor:ce,init:function(t,i,n){var s,o;if(!t){return this}if("string"==typeof t){if(s="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:fe.exec(t),!s||!s[1]&&i){return !i||i.jquery?(i||n).find(t):this.constructor(i).find(t)}if(s[1]){if(i=i instanceof ce?i[0]:i,ce.merge(this,ce.parseHTML(s[1],i&&i.nodeType?i.ownerDocument||i:Q,!0)),me.test(s[1])&&ce.isPlainObject(i)){for(s in i){ce.isFunction(this[s])?this[s](i[s]):this.attr(s,i[s])}}return this}if(o=Q.getElementById(s[2]),o&&o.parentNode){if(o.id!==s[2]){return n.find(t)}this.length=1,this[0]=o}return this.context=Q,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):ce.isFunction(t)?n.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),ce.makeArray(t,this))},selector:"",length:0,toArray:function(){return oe.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=ce.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return ce.each(this,t,e)},ready:function(t){return ce.ready.promise().done(t),this},slice:function(){return this.pushStack(oe.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},map:function(t){return this.pushStack(ce.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:se,sort:[].sort,splice:[].splice},ce.fn.init.prototype=ce.fn,ce.extend=ce.fn.extend=function(){var t,i,n,s,o,r,a=arguments[0]||{},l=1,h=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[1]||{},l=2),"object"==typeof a||ce.isFunction(a)||(a={}),h===l&&(a=this,--l);h>l;l++){if(null!=(o=arguments[l])){for(s in o){t=a[s],n=o[s],a!==n&&(c&&n&&(ce.isPlainObject(n)||(i=ce.isArray(n)))?(i?(i=!1,r=t&&ce.isArray(t)?t:[]):r=t&&ce.isPlainObject(t)?t:{},a[s]=ce.extend(c,r,n)):n!==e&&(a[s]=n))}}}return a},ce.extend({expando:"jQuery"+(ie+Math.random()).replace(/\D/g,""),noConflict:function(e){return t.$===ce&&(t.$=Z),e&&t.$===ce&&(t.$=G),ce},isReady:!1,readyWait:1,holdReady:function(t){t?ce.readyWait++:ce.ready(!0)},ready:function(t){if(t===!0?!--ce.readyWait:!ce.isReady){if(!Q.body){return setTimeout(ce.ready)}ce.isReady=!0,t!==!0&&--ce.readyWait>0||(U.resolveWith(Q,[ce]),ce.fn.trigger&&ce(Q).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===ce.type(t)},isArray:Array.isArray||function(t){return"array"===ce.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return !isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?te[ae.call(t)]||"object":typeof t},isPlainObject:function(t){var i;if(!t||"object"!==ce.type(t)||t.nodeType||ce.isWindow(t)){return !1}try{if(t.constructor&&!le.call(t,"constructor")&&!le.call(t.constructor.prototype,"isPrototypeOf")){return !1}}catch(n){return !1}if(ce.support.ownLast){for(i in t){return le.call(t,i)}}for(i in t){}return i===e||le.call(t,i)},isEmptyObject:function(t){var e;for(e in t){return !1}return !0},error:function(t){throw new Error(t)},parseHTML:function(t,e,i){if(!t||"string"!=typeof t){return null}"boolean"==typeof e&&(i=e,e=!1),e=e||Q;var n=me.exec(t),s=!i&&[];return n?[e.createElement(n[1])]:(n=ce.buildFragment([t],e,s),s&&ce(s).remove(),ce.merge([],n.childNodes))},parseJSON:function(e){return t.JSON&&t.JSON.parse?t.JSON.parse(e):null===e?e:"string"==typeof e&&(e=ce.trim(e),e&&ge.test(e.replace(ye,"@").replace(be,"]").replace(ve,"")))?new Function("return "+e)():(ce.error("Invalid JSON: "+e),void 0)},parseXML:function(i){var n,s;if(!i||"string"!=typeof i){return null}try{t.DOMParser?(s=new DOMParser,n=s.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(o){n=e}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||ce.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(e){e&&ce.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(_e,"ms-").replace(we,xe)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var s,o=0,r=t.length,a=i(t);if(n){if(a){for(;r>o&&(s=e.apply(t[o],n),s!==!1);o++){}}else{for(o in t){if(s=e.apply(t[o],n),s===!1){break}}}}else{if(a){for(;r>o&&(s=e.call(t[o],o,t[o]),s!==!1);o++){}}else{for(o in t){if(s=e.call(t[o],o,t[o]),s===!1){break}}}}return t},trim:he&&!he.call(" ")?function(t){return null==t?"":he.call(t)}:function(t){return null==t?"":(t+"").replace(pe,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?ce.merge(n,"string"==typeof t?[t]:t):se.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(re){return re.call(e,t,i)}for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++){if(i in e&&e[i]===t){return i}}}return -1},merge:function(t,i){var n=i.length,s=t.length,o=0;if("number"==typeof n){for(;n>o;o++){t[s++]=i[o]}}else{for(;i[o]!==e;){t[s++]=i[o++]}}return t.length=s,t},grep:function(t,e,i){var n,s=[],o=0,r=t.length;for(i=!!i;r>o;o++){n=!!e(t[o],o),i!==n&&s.push(t[o])}return s},map:function(t,e,n){var s,o=0,r=t.length,a=i(t),l=[];if(a){for(;r>o;o++){s=e(t[o],o,n),null!=s&&(l[l.length]=s)}}else{for(o in t){s=e(t[o],o,n),null!=s&&(l[l.length]=s)}}return ne.apply([],l)},guid:1,proxy:function(t,i){var n,s,o;return"string"==typeof i&&(o=t[i],i=t,t=o),ce.isFunction(t)?(n=oe.call(arguments,2),s=function(){return t.apply(i||this,n.concat(oe.call(arguments)))},s.guid=t.guid=t.guid||ce.guid++,s):e},access:function(t,i,n,s,o,r,a){var l=0,h=t.length,c=null==n;if("object"===ce.type(n)){o=!0;for(l in n){ce.access(t,i,l,n[l],!0,r,a)}}else{if(s!==e&&(o=!0,ce.isFunction(s)||(a=!0),c&&(a?(i.call(t,s),i=null):(c=i,i=function(t,e,i){return c.call(ce(t),i)})),i)){for(;h>l;l++){i(t[l],n,a?s:s.call(t[l],l,i(t[l],n)))}}}return o?t:c?i.call(t):h?i(t[0],n):r},now:function(){return(new Date).getTime()},swap:function(t,e,i,n){var s,o,r={};for(o in e){r[o]=t.style[o],t.style[o]=e[o]}s=i.apply(t,n||[]);for(o in e){t.style[o]=r[o]}return s}}),ce.ready.promise=function(e){if(!U){if(U=ce.Deferred(),"complete"===Q.readyState){setTimeout(ce.ready)}else{if(Q.addEventListener){Q.addEventListener("DOMContentLoaded",ke,!1),t.addEventListener("load",ke,!1)}else{Q.attachEvent("onreadystatechange",ke),t.attachEvent("onload",ke);var i=!1;try{i=null==t.frameElement&&Q.documentElement}catch(n){}i&&i.doScroll&&function s(){if(!ce.isReady){try{i.doScroll("left")}catch(t){return setTimeout(s,50)}Ce(),ce.ready()}}()}}}return U.promise(e)},ce.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){te["[object "+e+"]"]=e.toLowerCase()}),Y=ce(Q),
/*!
 * Sizzle CSS Selector Engine v1.9.4-pre
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-05-27
 */
function(t,e){function i(t,e,i,n){var s,o,r,a,l,h,c,u,d,p;if((e?e.ownerDocument||e:q)!==O&&H(e),e=e||O,i=i||[],!t||"string"!=typeof t){return i}if(1!==(a=e.nodeType)&&9!==a){return[]}if(z&&!n){if(s=ke.exec(t)){if(r=s[1]){if(9===a){if(o=e.getElementById(r),!o||!o.parentNode){return i}if(o.id===r){return i.push(o),i}}else{if(e.ownerDocument&&(o=e.ownerDocument.getElementById(r))&&$(e,o)&&o.id===r){return i.push(o),i}}}else{if(s[2]){return se.apply(i,e.getElementsByTagName(t)),i}if((r=s[3])&&M.getElementsByClassName&&e.getElementsByClassName){return se.apply(i,e.getElementsByClassName(r)),i}}}if(M.qsa&&(!F||!F.test(t))){if(u=c=B,d=e,p=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(h=m(t),(c=e.getAttribute("id"))?u=c.replace(De,"\\$&"):e.setAttribute("id",u),u="[id='"+u+"'] ",l=h.length;l--;){h[l]=u+g(h[l])}d=ve.test(t)&&e.parentNode||e,p=h.join(",")}if(p){try{return se.apply(i,d.querySelectorAll(p)),i}catch(f){}finally{c||e.removeAttribute("id")}}}}return C(t.replace(fe,"$1"),e,i,n)}function n(t){return xe.test(t+"")}function s(){function t(i,n){return e.push(i+=" ")>I.cacheLength&&delete t[e.shift()],t[i]=n}var e=[];return t}function o(t){return t[B]=!0,t}function r(t){var e=O.createElement("div");try{return !!t(e)}catch(i){return !1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function a(t,e,i){t=t.split("|");for(var n,s=t.length,o=i?null:e;s--;){(n=I.attrHandle[t[s]])&&n!==e||(I.attrHandle[t[s]]=o)}}function l(t,e){var i=t.getAttributeNode(e);return i&&i.specified?i.value:t[e]===!0?e.toLowerCase():null}function h(t,e){return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}function c(t){return"input"===t.nodeName.toLowerCase()?t.defaultValue:void 0}function u(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||Z)-(~t.sourceIndex||Z);if(n){return n}if(i){for(;i=i.nextSibling;){if(i===e){return -1}}}return t?1:-1}function d(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function p(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function f(t){return o(function(e){return e=+e,o(function(i,n){for(var s,o=t([],i.length,e),r=o.length;r--;){i[s=o[r]]&&(i[s]=!(n[s]=i[s]))}})})}function m(t,e){var n,s,o,r,a,l,h,c=V[t+" "];if(c){return e?0:c.slice(0)}for(a=t,l=[],h=I.preFilter;a;){(!n||(s=me.exec(a)))&&(s&&(a=a.slice(s[0].length)||a),l.push(o=[])),n=!1,(s=ge.exec(a))&&(n=s.shift(),o.push({value:n,type:s[0].replace(fe," ")}),a=a.slice(n.length));for(r in I.filter){!(s=we[r].exec(a))||h[r]&&!(s=h[r](s))||(n=s.shift(),o.push({value:n,type:r,matches:s}),a=a.slice(n.length))}if(!n){break}}return e?a.length:a?i.error(t):V(t,l).slice(0)}function g(t){for(var e=0,i=t.length,n="";i>e;e++){n+=t[e].value}return n}function v(t,e,i){var n=e.dir,s=i&&"parentNode"===n,o=U++;return e.first?function(e,i,o){for(;e=e[n];){if(1===e.nodeType||s){return t(e,i,o)}}}:function(e,i,r){var a,l,h,c=K+" "+o;if(r){for(;e=e[n];){if((1===e.nodeType||s)&&t(e,i,r)){return !0}}}else{for(;e=e[n];){if(1===e.nodeType||s){if(h=e[B]||(e[B]={}),(l=h[n])&&l[0]===c){if((a=l[1])===!0||a===S){return a===!0}}else{if(l=h[n]=[c],l[1]=t(e,i,r)||S,l[1]===!0){return !0}}}}}}}function y(t){return t.length>1?function(e,i,n){for(var s=t.length;s--;){if(!t[s](e,i,n)){return !1}}return !0}:t[0]}function b(t,e,i,n,s){for(var o,r=[],a=0,l=t.length,h=null!=e;l>a;a++){(o=t[a])&&(!i||i(o,n,s))&&(r.push(o),h&&e.push(a))}return r}function _(t,e,i,n,s,r){return n&&!n[B]&&(n=_(n)),s&&!s[B]&&(s=_(s,r)),o(function(o,r,a,l){var h,c,u,d=[],p=[],f=r.length,m=o||k(e||"*",a.nodeType?[a]:a,[]),g=!t||!o&&e?m:b(m,d,t,a,l),v=i?s||(o?t:f||n)?[]:r:g;if(i&&i(g,v,a,l),n){for(h=b(v,p),n(h,[],a,l),c=h.length;c--;){(u=h[c])&&(v[p[c]]=!(g[p[c]]=u))}}if(o){if(s||t){if(s){for(h=[],c=v.length;c--;){(u=v[c])&&h.push(g[c]=u)}s(null,v=[],h,l)}for(c=v.length;c--;){(u=v[c])&&(h=s?re.call(o,u):d[c])>-1&&(o[h]=!(r[h]=u))}}}else{v=b(v===r?v.splice(f,v.length):v),s?s(null,r,v,l):se.apply(r,v)}})}function w(t){for(var e,i,n,s=t.length,o=I.relative[t[0].type],r=o||I.relative[" "],a=o?1:0,l=v(function(t){return t===e},r,!0),h=v(function(t){return re.call(e,t)>-1},r,!0),c=[function(t,i,n){return !o&&(n||i!==P)||((e=i).nodeType?l(t,i,n):h(t,i,n))}];s>a;a++){if(i=I.relative[t[a].type]){c=[v(y(c),i)]}else{if(i=I.filter[t[a].type].apply(null,t[a].matches),i[B]){for(n=++a;s>n&&!I.relative[t[n].type];n++){}return _(a>1&&y(c),a>1&&g(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(fe,"$1"),i,n>a&&w(t.slice(a,n)),s>n&&w(t=t.slice(n)),s>n&&g(t))}c.push(i)}}return y(c)}function x(t,e){var n=0,s=e.length>0,r=t.length>0,a=function(o,a,l,h,c){var u,d,p,f=[],m=0,g="0",v=o&&[],y=null!=c,_=P,w=o||r&&I.find.TAG("*",c&&a.parentNode||a),x=K+=null==_?1:Math.random()||0.1;for(y&&(P=a!==O&&a,S=n);null!=(u=w[g]);g++){if(r&&u){for(d=0;p=t[d++];){if(p(u,a,l)){h.push(u);break}}y&&(K=x,S=++n)}s&&((u=!p&&u)&&m--,o&&v.push(u))}if(m+=g,s&&g!==m){for(d=0;p=e[d++];){p(v,f,a,l)}if(o){if(m>0){for(;g--;){v[g]||f[g]||(f[g]=ie.call(h))}}f=b(f)}se.apply(h,f),y&&!o&&f.length>0&&m+e.length>1&&i.uniqueSort(h)}return y&&(K=x,P=_),v};return s?o(a):a}function k(t,e,n){for(var s=0,o=e.length;o>s;s++){i(t,e[s],n)}return n}function C(t,e,i,n){var s,o,r,a,l,h=m(t);if(!n&&1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(r=o[0]).type&&M.getById&&9===e.nodeType&&z&&I.relative[o[1].type]){if(e=(I.find.ID(r.matches[0].replace(Me,Se),e)||[])[0],!e){return i}t=t.slice(o.shift().value.length)}for(s=we.needsContext.test(t)?0:o.length;s--&&(r=o[s],!I.relative[a=r.type]);){if((l=I.find[a])&&(n=l(r.matches[0].replace(Me,Se),ve.test(o[0].type)&&e.parentNode||e))){if(o.splice(s,1),t=n.length&&g(o),!t){return se.apply(i,n),i}break}}}return A(t,h)(n,e,!z,i,ve.test(t)),i}function T(){}var D,M,S,I,E,N,A,P,R,H,O,j,z,F,W,L,$,B="sizzle"+-new Date,q=t.document,K=0,U=0,Y=s(),V=s(),X=s(),Q=!1,J=function(){return 0},G=typeof e,Z=1<<31,te={}.hasOwnProperty,ee=[],ie=ee.pop,ne=ee.push,se=ee.push,oe=ee.slice,re=ee.indexOf||function(t){for(var e=0,i=this.length;i>e;e++){if(this[e]===t){return e}}return -1},ae="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",le="[\\x20\\t\\r\\n\\f]",he="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ue=he.replace("w","w#"),de="\\["+le+"*("+he+")"+le+"*(?:([*^$|!~]?=)"+le+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ue+")|)|)"+le+"*\\]",pe=":("+he+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+de.replace(3,8)+")*)|.*)\\)|)",fe=new RegExp("^"+le+"+|((?:^|[^\\\\])(?:\\\\.)*)"+le+"+$","g"),me=new RegExp("^"+le+"*,"+le+"*"),ge=new RegExp("^"+le+"*([>+~]|"+le+")"+le+"*"),ve=new RegExp(le+"*[+~]"),ye=new RegExp("="+le+"*([^\\]'\"]*)"+le+"*\\]","g"),be=new RegExp(pe),_e=new RegExp("^"+ue+"$"),we={ID:new RegExp("^#("+he+")"),CLASS:new RegExp("^\\.("+he+")"),TAG:new RegExp("^("+he.replace("w","w*")+")"),ATTR:new RegExp("^"+de),PSEUDO:new RegExp("^"+pe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+le+"*(even|odd|(([+-]|)(\\d*)n|)"+le+"*(?:([+-]|)"+le+"*(\\d+)|))"+le+"*\\)|)","i"),bool:new RegExp("^(?:"+ae+")$","i"),needsContext:new RegExp("^"+le+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+le+"*((?:-\\d)?\\d*)"+le+"*\\)|)(?=[^-]|$)","i")},xe=/^[^{]+\{\s*\[native \w/,ke=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ce=/^(?:input|select|textarea|button)$/i,Te=/^h\d$/i,De=/'|\\/g,Me=new RegExp("\\\\([\\da-f]{1,6}"+le+"?|("+le+")|.)","ig"),Se=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(55296|n>>10,56320|1023&n)};try{se.apply(ee=oe.call(q.childNodes),q.childNodes),ee[q.childNodes.length].nodeType}catch(Ie){se={apply:ee.length?function(t,e){ne.apply(t,oe.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];){}t.length=i-1}}}N=i.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},M=i.support={},H=i.setDocument=function(t){var e=t?t.ownerDocument||t:q,i=e.parentWindow;return e!==O&&9===e.nodeType&&e.documentElement?(O=e,j=e.documentElement,z=!N(e),i&&i.frameElement&&i.attachEvent("onbeforeunload",function(){H()}),M.attributes=r(function(t){return t.innerHTML="<a href='#'></a>",a("type|href|height|width",h,"#"===t.firstChild.getAttribute("href")),a(ae,l,null==t.getAttribute("disabled")),t.className="i",!t.getAttribute("className")}),M.input=r(function(t){return t.innerHTML="<input>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}),a("value",c,M.attributes&&M.input),M.getElementsByTagName=r(function(t){return t.appendChild(e.createComment("")),!t.getElementsByTagName("*").length}),M.getElementsByClassName=r(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),M.getById=r(function(t){return j.appendChild(t).id=B,!e.getElementsByName||!e.getElementsByName(B).length}),M.getById?(I.find.ID=function(t,e){if(typeof e.getElementById!==G&&z){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},I.filter.ID=function(t){var e=t.replace(Me,Se);return function(t){return t.getAttribute("id")===e}}):(delete I.find.ID,I.filter.ID=function(t){var e=t.replace(Me,Se);return function(t){var i=typeof t.getAttributeNode!==G&&t.getAttributeNode("id");return i&&i.value===e}}),I.find.TAG=M.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==G?e.getElementsByTagName(t):void 0}:function(t,e){var i,n=[],s=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[s++];){1===i.nodeType&&n.push(i)}return n}return o},I.find.CLASS=M.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==G&&z?e.getElementsByClassName(t):void 0},W=[],F=[],(M.qsa=n(e.querySelectorAll))&&(r(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||F.push("\\["+le+"*(?:value|"+ae+")"),t.querySelectorAll(":checked").length||F.push(":checked")}),r(function(t){var i=e.createElement("input");i.setAttribute("type","hidden"),t.appendChild(i).setAttribute("t",""),t.querySelectorAll("[t^='']").length&&F.push("[*^$]="+le+"*(?:''|\"\")"),t.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),F.push(",.*:")})),(M.matchesSelector=n(L=j.webkitMatchesSelector||j.mozMatchesSelector||j.oMatchesSelector||j.msMatchesSelector))&&r(function(t){M.disconnectedMatch=L.call(t,"div"),L.call(t,"[s!='']:x"),W.push("!=",pe)}),F=F.length&&new RegExp(F.join("|")),W=W.length&&new RegExp(W.join("|")),$=n(j.contains)||j.compareDocumentPosition?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e){for(;e=e.parentNode;){if(e===t){return !0}}}return !1},M.sortDetached=r(function(t){return 1&t.compareDocumentPosition(e.createElement("div"))}),J=j.compareDocumentPosition?function(t,i){if(t===i){return Q=!0,0}var n=i.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(i);return n?1&n||!M.sortDetached&&i.compareDocumentPosition(t)===n?t===e||$(q,t)?-1:i===e||$(q,i)?1:R?re.call(R,t)-re.call(R,i):0:4&n?-1:1:t.compareDocumentPosition?-1:1}:function(t,i){var n,s=0,o=t.parentNode,r=i.parentNode,a=[t],l=[i];if(t===i){return Q=!0,0}if(!o||!r){return t===e?-1:i===e?1:o?-1:r?1:R?re.call(R,t)-re.call(R,i):0}if(o===r){return u(t,i)}for(n=t;n=n.parentNode;){a.unshift(n)}for(n=i;n=n.parentNode;){l.unshift(n)}for(;a[s]===l[s];){s++}return s?u(a[s],l[s]):a[s]===q?-1:l[s]===q?1:0},e):O},i.matches=function(t,e){return i(t,null,null,e)},i.matchesSelector=function(t,e){if((t.ownerDocument||t)!==O&&H(t),e=e.replace(ye,"='$1']"),!(!M.matchesSelector||!z||W&&W.test(e)||F&&F.test(e))){try{var n=L.call(t,e);if(n||M.disconnectedMatch||t.document&&11!==t.document.nodeType){return n}}catch(s){}}return i(e,O,null,[t]).length>0},i.contains=function(t,e){return(t.ownerDocument||t)!==O&&H(t),$(t,e)},i.attr=function(t,i){(t.ownerDocument||t)!==O&&H(t);var n=I.attrHandle[i.toLowerCase()],s=n&&te.call(I.attrHandle,i.toLowerCase())?n(t,i,!z):e;return s===e?M.attributes||!z?t.getAttribute(i):(s=t.getAttributeNode(i))&&s.specified?s.value:null:s},i.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},i.uniqueSort=function(t){var e,i=[],n=0,s=0;if(Q=!M.detectDuplicates,R=!M.sortStable&&t.slice(0),t.sort(J),Q){for(;e=t[s++];){e===t[s]&&(n=i.push(s))}for(;n--;){t.splice(i[n],1)}}return t},E=i.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent){return t.textContent}for(t=t.firstChild;t;t=t.nextSibling){i+=E(t)}}else{if(3===s||4===s){return t.nodeValue}}}else{for(;e=t[n];n++){i+=E(e)}}return i},I=i.selectors={cacheLength:50,createPseudo:o,match:we,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(Me,Se),t[3]=(t[4]||t[5]||"").replace(Me,Se),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||i.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&i.error(t[0]),t},PSEUDO:function(t){var i,n=!t[5]&&t[2];return we.CHILD.test(t[0])?null:(t[3]&&t[4]!==e?t[2]=t[4]:n&&be.test(n)&&(i=m(n,!0))&&(i=n.indexOf(")",n.length-i)-n.length)&&(t[0]=t[0].slice(0,i),t[2]=n.slice(0,i)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(Me,Se).toLowerCase();return"*"===t?function(){return !0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=Y[t+" "];return e||(e=new RegExp("(^|"+le+")"+t+"("+le+"|$)"))&&Y(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==G&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(s){var o=i.attr(s,t);return null==o?"!="===e:e?(o+="","="===e?o===n:"!="===e?o!==n:"^="===e?n&&0===o.indexOf(n):"*="===e?n&&o.indexOf(n)>-1:"$="===e?n&&o.slice(-n.length)===n:"~="===e?(" "+o+" ").indexOf(n)>-1:"|="===e?o===n||o.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,i,n,s){var o="nth"!==t.slice(0,3),r="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===s?function(t){return !!t.parentNode}:function(e,i,l){var h,c,u,d,p,f,m=o!==r?"nextSibling":"previousSibling",g=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a;if(g){if(o){for(;m;){for(u=e;u=u[m];){if(a?u.nodeName.toLowerCase()===v:1===u.nodeType){return !1}}f=m="only"===t&&!f&&"nextSibling"}return !0}if(f=[r?g.firstChild:g.lastChild],r&&y){for(c=g[B]||(g[B]={}),h=c[t]||[],p=h[0]===K&&h[1],d=h[0]===K&&h[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(d=p=0)||f.pop();){if(1===u.nodeType&&++d&&u===e){c[t]=[K,p,d];break}}}else{if(y&&(h=(e[B]||(e[B]={}))[t])&&h[0]===K){d=h[1]}else{for(;(u=++p&&u&&u[m]||(d=p=0)||f.pop())&&((a?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++d||(y&&((u[B]||(u[B]={}))[t]=[K,d]),u!==e));){}}}return d-=s,d===n||0===d%n&&d/n>=0}}},PSEUDO:function(t,e){var n,s=I.pseudos[t]||I.setFilters[t.toLowerCase()]||i.error("unsupported pseudo: "+t);return s[B]?s(e):s.length>1?(n=[t,t,"",e],I.setFilters.hasOwnProperty(t.toLowerCase())?o(function(t,i){for(var n,o=s(t,e),r=o.length;r--;){n=re.call(t,o[r]),t[n]=!(i[n]=o[r])}}):function(t){return s(t,0,n)}):s}},pseudos:{not:o(function(t){var e=[],i=[],n=A(t.replace(fe,"$1"));return n[B]?o(function(t,e,i,s){for(var o,r=n(t,null,s,[]),a=t.length;a--;){(o=r[a])&&(t[a]=!(e[a]=o))}}):function(t,s,o){return e[0]=t,n(e,null,o,i),!i.pop()}}),has:o(function(t){return function(e){return i(t,e).length>0}}),contains:o(function(t){return function(e){return(e.textContent||e.innerText||E(e)).indexOf(t)>-1}}),lang:o(function(t){return _e.test(t||"")||i.error("unsupported lang: "+t),t=t.replace(Me,Se).toLowerCase(),function(e){var i;do{if(i=z?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang")){return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-")}}while((e=e.parentNode)&&1===e.nodeType);return !1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===j},focus:function(t){return t===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling){if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType){return !1}}return !0},parent:function(t){return !I.pseudos.empty(t)},header:function(t){return Te.test(t.nodeName)},input:function(t){return Ce.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:f(function(){return[0]}),last:f(function(t,e){return[e-1]}),eq:f(function(t,e,i){return[0>i?i+e:i]}),even:f(function(t,e){for(var i=0;e>i;i+=2){t.push(i)}return t}),odd:f(function(t,e){for(var i=1;e>i;i+=2){t.push(i)}return t}),lt:f(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;){t.push(n)}return t}),gt:f(function(t,e,i){for(var n=0>i?i+e:i;++n<e;){t.push(n)}return t})}};for(D in {radio:!0,checkbox:!0,file:!0,password:!0,image:!0}){I.pseudos[D]=d(D)}for(D in {submit:!0,reset:!0}){I.pseudos[D]=p(D)}A=i.compile=function(t,e){var i,n=[],s=[],o=X[t+" "];if(!o){for(e||(e=m(t)),i=e.length;i--;){o=w(e[i]),o[B]?n.push(o):s.push(o)}o=X(t,x(s,n))}return o},I.pseudos.nth=I.pseudos.eq,T.prototype=I.filters=I.pseudos,I.setFilters=new T,M.sortStable=B.split("").sort(J).join("")===B,H(),[0,0].sort(J),M.detectDuplicates=Q,ce.find=i,ce.expr=i.selectors,ce.expr[":"]=ce.expr.pseudos,ce.unique=i.uniqueSort,ce.text=i.getText,ce.isXMLDoc=i.isXML,ce.contains=i.contains}(t);var Te={};ce.Callbacks=function(t){t="string"==typeof t?Te[t]||n(t):ce.extend({},t);var i,s,o,r,a,l,h=[],c=!t.once&&[],u=function(e){for(s=t.memory&&e,o=!0,a=l||0,l=0,r=h.length,i=!0;h&&r>a;a++){if(h[a].apply(e[0],e[1])===!1&&t.stopOnFalse){s=!1;break}}i=!1,h&&(c?c.length&&u(c.shift()):s?h=[]:d.disable())},d={add:function(){if(h){var e=h.length;!function n(e){ce.each(e,function(e,i){var s=ce.type(i);"function"===s?t.unique&&d.has(i)||h.push(i):i&&i.length&&"string"!==s&&n(i)})}(arguments),i?r=h.length:s&&(l=e,u(s))}return this},remove:function(){return h&&ce.each(arguments,function(t,e){for(var n;(n=ce.inArray(e,h,n))>-1;){h.splice(n,1),i&&(r>=n&&r--,a>=n&&a--)}}),this},has:function(t){return t?ce.inArray(t,h)>-1:!(!h||!h.length)},empty:function(){return h=[],r=0,this},disable:function(){return h=c=s=e,this},disabled:function(){return !h},lock:function(){return c=e,s||d.disable(),this},locked:function(){return !c},fireWith:function(t,e){return e=e||[],e=[t,e.slice?e.slice():e],!h||o&&!c||(i?c.push(e):u(e)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return !!o}};return d},ce.extend({Deferred:function(t){var e=[["resolve","done",ce.Callbacks("once memory"),"resolved"],["reject","fail",ce.Callbacks("once memory"),"rejected"],["notify","progress",ce.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ce.Deferred(function(i){ce.each(e,function(e,o){var r=o[0],a=ce.isFunction(t[e])&&t[e];s[o[1]](function(){var t=a&&a.apply(this,arguments);t&&ce.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?ce.extend(t,n):n}},s={};return n.pipe=n.then,ce.each(e,function(t,o){var r=o[2],a=o[3];n[o[1]]=r.add,a&&r.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),s[o[0]]=function(){return s[o[0]+"With"](this===s?n:this,arguments),this},s[o[0]+"With"]=r.fireWith}),n.promise(s),t&&t.call(s,s),s},when:function(t){var e,i,n,s=0,o=oe.call(arguments),r=o.length,a=1!==r||t&&ce.isFunction(t.promise)?r:0,l=1===a?t:ce.Deferred(),h=function(t,i,n){return function(s){i[t]=this,n[t]=arguments.length>1?oe.call(arguments):s,n===e?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(r>1){for(e=new Array(r),i=new Array(r),n=new Array(r);r>s;s++){o[s]&&ce.isFunction(o[s].promise)?o[s].promise().done(h(s,n,o)).fail(l.reject).progress(h(s,i,e)):--a}}return a||l.resolveWith(n,o),l.promise()}}),ce.support=function(e){var i,n,s,o,r,a,l,h,c,u=Q.createElement("div");if(u.setAttribute("className","t"),u.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=u.getElementsByTagName("*")||[],n=u.getElementsByTagName("a")[0],!n||!n.style||!i.length){return e}o=Q.createElement("select"),a=o.appendChild(Q.createElement("option")),s=u.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",e.getSetAttribute="t"!==u.className,e.leadingWhitespace=3===u.firstChild.nodeType,e.tbody=!u.getElementsByTagName("tbody").length,e.htmlSerialize=!!u.getElementsByTagName("link").length,e.style=/top/.test(n.getAttribute("style")),e.hrefNormalized="/a"===n.getAttribute("href"),e.opacity=/^0.5/.test(n.style.opacity),e.cssFloat=!!n.style.cssFloat,e.checkOn=!!s.value,e.optSelected=a.selected,e.enctype=!!Q.createElement("form").enctype,e.html5Clone="<:nav></:nav>"!==Q.createElement("nav").cloneNode(!0).outerHTML,e.inlineBlockNeedsLayout=!1,e.shrinkWrapBlocks=!1,e.pixelPosition=!1,e.deleteExpando=!0,e.noCloneEvent=!0,e.reliableMarginRight=!0,e.boxSizingReliable=!0,s.checked=!0,e.noCloneChecked=s.cloneNode(!0).checked,o.disabled=!0,e.optDisabled=!a.disabled;try{delete u.test}catch(d){e.deleteExpando=!1}s=Q.createElement("input"),s.setAttribute("value",""),e.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),e.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),r=Q.createDocumentFragment(),r.appendChild(s),e.appendChecked=s.checked,e.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,u.attachEvent&&(u.attachEvent("onclick",function(){e.noCloneEvent=!1}),u.cloneNode(!0).click());for(c in {submit:!0,change:!0,focusin:!0}){u.setAttribute(l="on"+c,"t"),e[c+"Bubbles"]=l in t||u.attributes[l].expando===!1}u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===u.style.backgroundClip;for(c in ce(e)){break}return e.ownLast="0"!==c,ce(function(){var i,n,s,o="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",r=Q.getElementsByTagName("body")[0];r&&(i=Q.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",r.appendChild(i).appendChild(u),u.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=u.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",e.reliableHiddenOffsets=h&&0===s[0].offsetHeight,u.innerHTML="",u.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",ce.swap(r,null!=r.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===u.offsetWidth}),t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(u,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(u,null)||{width:"4px"}).width,n=u.appendChild(Q.createElement("div")),n.style.cssText=u.style.cssText=o,n.style.marginRight=n.style.width="0",u.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(n,null)||{}).marginRight)),typeof u.style.zoom!==V&&(u.innerHTML="",u.style.cssText=o+"width:1px;padding:1px;display:inline;zoom:1",e.inlineBlockNeedsLayout=3===u.offsetWidth,u.style.display="block",u.innerHTML="<div></div>",u.firstChild.style.width="5px",e.shrinkWrapBlocks=3!==u.offsetWidth,e.inlineBlockNeedsLayout&&(r.style.zoom=1)),r.removeChild(i),i=u=s=n=null)}),i=o=r=a=n=s=null,e}({});var De=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Me=/([A-Z])/g;ce.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?ce.cache[t[ce.expando]]:t[ce.expando],!!t&&!a(t)},data:function(t,e,i){return s(t,e,i)},removeData:function(t,e){return o(t,e)},_data:function(t,e,i){return s(t,e,i,!0)},_removeData:function(t,e){return o(t,e,!0)},acceptData:function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType){return !1}var e=t.nodeName&&ce.noData[t.nodeName.toLowerCase()];return !e||e!==!0&&t.getAttribute("classid")===e}}),ce.fn.extend({data:function(t,i){var n,s,o=null,a=0,l=this[0];if(t===e){if(this.length&&(o=ce.data(l),1===l.nodeType&&!ce._data(l,"parsedAttrs"))){for(n=l.attributes;a<n.length;a++){s=n[a].name,0===s.indexOf("data-")&&(s=ce.camelCase(s.slice(5)),r(l,s,o[s]))}ce._data(l,"parsedAttrs",!0)}return o}return"object"==typeof t?this.each(function(){ce.data(this,t)}):arguments.length>1?this.each(function(){ce.data(this,t,i)}):l?r(l,t,ce.data(l,t)):null},removeData:function(t){return this.each(function(){ce.removeData(this,t)})}}),ce.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=ce._data(t,e),i&&(!n||ce.isArray(i)?n=ce._data(t,e,ce.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=ce.queue(t,e),n=i.length,s=i.shift(),o=ce._queueHooks(t,e),r=function(){ce.dequeue(t,e)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===e&&i.unshift("inprogress"),delete o.stop,s.call(t,r,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return ce._data(t,i)||ce._data(t,i,{empty:ce.Callbacks("once memory").add(function(){ce._removeData(t,e+"queue"),ce._removeData(t,i)})})}}),ce.fn.extend({queue:function(t,i){var n=2;return"string"!=typeof t&&(i=t,t="fx",n--),arguments.length<n?ce.queue(this[0],t):i===e?this:this.each(function(){var e=ce.queue(this,t,i);ce._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ce.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ce.dequeue(this,t)})},delay:function(t,e){return t=ce.fx?ce.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,i){var n,s=1,o=ce.Deferred(),r=this,a=this.length,l=function(){--s||o.resolveWith(r,[r])};for("string"!=typeof t&&(i=t,t=e),t=t||"fx";a--;){n=ce._data(r[a],t+"queueHooks"),n&&n.empty&&(s++,n.empty.add(l))}return l(),o.promise(i)}});var Se,Ie,Ee=/[\t\r\n\f]/g,Ne=/\r/g,Ae=/^(?:input|select|textarea|button|object)$/i,Pe=/^(?:a|area)$/i,Re=/^(?:checked|selected)$/i,He=ce.support.getSetAttribute,Oe=ce.support.input;ce.fn.extend({attr:function(t,e){return ce.access(this,ce.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ce.removeAttr(this,t)})},prop:function(t,e){return ce.access(this,ce.prop,t,e,arguments.length>1)},removeProp:function(t){return t=ce.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(i){}})},addClass:function(t){var e,i,n,s,o,r=0,a=this.length,l="string"==typeof t&&t;if(ce.isFunction(t)){return this.each(function(e){ce(this).addClass(t.call(this,e,this.className))})}if(l){for(e=(t||"").match(de)||[];a>r;r++){if(i=this[r],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ee," "):" ")){for(o=0;s=e[o++];){n.indexOf(" "+s+" ")<0&&(n+=s+" ")}i.className=ce.trim(n)}}}return this},removeClass:function(t){var e,i,n,s,o,r=0,a=this.length,l=0===arguments.length||"string"==typeof t&&t;if(ce.isFunction(t)){return this.each(function(e){ce(this).removeClass(t.call(this,e,this.className))})}if(l){for(e=(t||"").match(de)||[];a>r;r++){if(i=this[r],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ee," "):"")){for(o=0;s=e[o++];){for(;n.indexOf(" "+s+" ")>=0;){n=n.replace(" "+s+" "," ")}}i.className=t?ce.trim(n):""}}}return this},toggleClass:function(t,e){var i=typeof t,n="boolean"==typeof e;return ce.isFunction(t)?this.each(function(i){ce(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i){for(var s,o=0,r=ce(this),a=e,l=t.match(de)||[];s=l[o++];){a=n?a:!r.hasClass(s),r[a?"addClass":"removeClass"](s)}}else{(i===V||"boolean"===i)&&(this.className&&ce._data(this,"__className__",this.className),this.className=this.className||t===!1?"":ce._data(this,"__className__")||"")}})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++){if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Ee," ").indexOf(e)>=0){return !0}}return !1},val:function(t){var i,n,s,o=this[0];if(arguments.length){return s=ce.isFunction(t),this.each(function(i){var o;1===this.nodeType&&(o=s?t.call(this,i,ce(this).val()):t,null==o?o="":"number"==typeof o?o+="":ce.isArray(o)&&(o=ce.map(o,function(t){return null==t?"":t+""})),n=ce.valHooks[this.type]||ce.valHooks[this.nodeName.toLowerCase()],n&&"set" in n&&n.set(this,o,"value")!==e||(this.value=o))})}if(o){return n=ce.valHooks[o.type]||ce.valHooks[o.nodeName.toLowerCase()],n&&"get" in n&&(i=n.get(o,"value"))!==e?i:(i=o.value,"string"==typeof i?i.replace(Ne,""):null==i?"":i)}}}),ce.extend({valHooks:{option:{get:function(t){var e=ce.find.attr(t,"value");return null!=e?e:t.text}},select:{get:function(t){for(var e,i,n=t.options,s=t.selectedIndex,o="select-one"===t.type||0>s,r=o?null:[],a=o?s+1:n.length,l=0>s?a:o?s:0;a>l;l++){if(i=n[l],!(!i.selected&&l!==s||(ce.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ce.nodeName(i.parentNode,"optgroup"))){if(e=ce(i).val(),o){return e}r.push(e)}}return r},set:function(t,e){for(var i,n,s=t.options,o=ce.makeArray(e),r=s.length;r--;){n=s[r],(n.selected=ce.inArray(ce(n).val(),o)>=0)&&(i=!0)}return i||(t.selectedIndex=-1),o}}},attr:function(t,i,n){var s,o,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r){return typeof t.getAttribute===V?ce.prop(t,i,n):(1===r&&ce.isXMLDoc(t)||(i=i.toLowerCase(),s=ce.attrHooks[i]||(ce.expr.match.bool.test(i)?Ie:Se)),n===e?s&&"get" in s&&null!==(o=s.get(t,i))?o:(o=ce.find.attr(t,i),null==o?e:o):null!==n?s&&"set" in s&&(o=s.set(t,n,i))!==e?o:(t.setAttribute(i,n+""),n):(ce.removeAttr(t,i),void 0))}},removeAttr:function(t,e){var i,n,s=0,o=e&&e.match(de);if(o&&1===t.nodeType){for(;i=o[s++];){n=ce.propFix[i]||i,ce.expr.match.bool.test(i)?Oe&&He||!Re.test(i)?t[n]=!1:t[ce.camelCase("default-"+i)]=t[n]=!1:ce.attr(t,i,""),t.removeAttribute(He?i:n)}}},attrHooks:{type:{set:function(t,e){if(!ce.support.radioValue&&"radio"===e&&ce.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(t,i,n){var s,o,r,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a){return r=1!==a||!ce.isXMLDoc(t),r&&(i=ce.propFix[i]||i,o=ce.propHooks[i]),n!==e?o&&"set" in o&&(s=o.set(t,n,i))!==e?s:t[i]=n:o&&"get" in o&&null!==(s=o.get(t,i))?s:t[i]}},propHooks:{tabIndex:{get:function(t){var e=ce.find.attr(t,"tabindex");return e?parseInt(e,10):Ae.test(t.nodeName)||Pe.test(t.nodeName)&&t.href?0:-1}}}}),Ie={set:function(t,e,i){return e===!1?ce.removeAttr(t,i):Oe&&He||!Re.test(i)?t.setAttribute(!He&&ce.propFix[i]||i,i):t[ce.camelCase("default-"+i)]=t[i]=!0,i}},ce.each(ce.expr.match.bool.source.match(/\w+/g),function(t,i){var n=ce.expr.attrHandle[i]||ce.find.attr;ce.expr.attrHandle[i]=Oe&&He||!Re.test(i)?function(t,i,s){var o=ce.expr.attrHandle[i],r=s?e:(ce.expr.attrHandle[i]=e)!=n(t,i,s)?i.toLowerCase():null;return ce.expr.attrHandle[i]=o,r}:function(t,i,n){return n?e:t[ce.camelCase("default-"+i)]?i.toLowerCase():null}}),Oe&&He||(ce.attrHooks.value={set:function(t,e,i){return ce.nodeName(t,"input")?(t.defaultValue=e,void 0):Se&&Se.set(t,e,i)}}),He||(Se={set:function(t,i,n){var s=t.getAttributeNode(n);return s||t.setAttributeNode(s=t.ownerDocument.createAttribute(n)),s.value=i+="","value"===n||i===t.getAttribute(n)?i:e}},ce.expr.attrHandle.id=ce.expr.attrHandle.name=ce.expr.attrHandle.coords=function(t,i,n){var s;return n?e:(s=t.getAttributeNode(i))&&""!==s.value?s.value:null},ce.valHooks.button={get:function(t,i){var n=t.getAttributeNode(i);return n&&n.specified?n.value:e},set:Se.set},ce.attrHooks.contenteditable={set:function(t,e,i){Se.set(t,""===e?!1:e,i)}},ce.each(["width","height"],function(t,e){ce.attrHooks[e]={set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}}})),ce.support.hrefNormalized||ce.each(["href","src"],function(t,e){ce.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),ce.support.style||(ce.attrHooks.style={get:function(t){return t.style.cssText||e},set:function(t,e){return t.style.cssText=e+""}}),ce.support.optSelected||(ce.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),ce.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ce.propFix[this.toLowerCase()]=this}),ce.support.enctype||(ce.propFix.enctype="encoding"),ce.each(["radio","checkbox"],function(){ce.valHooks[this]={set:function(t,e){return ce.isArray(e)?t.checked=ce.inArray(ce(t).val(),e)>=0:void 0}},ce.support.checkOn||(ce.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var je=/^(?:input|select|textarea)$/i,ze=/^key/,Fe=/^(?:mouse|contextmenu)|click/,We=/^(?:focusinfocus|focusoutblur)$/,Le=/^([^.]*)(?:\.(.+)|)$/;ce.event={global:{},add:function(t,i,n,s,o){var r,a,l,h,c,u,d,p,f,m,g,v=ce._data(t);if(v){for(n.handler&&(h=n,n=h.handler,o=h.selector),n.guid||(n.guid=ce.guid++),(a=v.events)||(a=v.events={}),(u=v.handle)||(u=v.handle=function(t){return typeof ce===V||t&&ce.event.triggered===t.type?e:ce.event.dispatch.apply(u.elem,arguments)},u.elem=t),i=(i||"").match(de)||[""],l=i.length;l--;){r=Le.exec(i[l])||[],f=g=r[1],m=(r[2]||"").split(".").sort(),f&&(c=ce.event.special[f]||{},f=(o?c.delegateType:c.bindType)||f,c=ce.event.special[f]||{},d=ce.extend({type:f,origType:g,data:s,handler:n,guid:n.guid,selector:o,needsContext:o&&ce.expr.match.needsContext.test(o),namespace:m.join(".")},h),(p=a[f])||(p=a[f]=[],p.delegateCount=0,c.setup&&c.setup.call(t,s,m,u)!==!1||(t.addEventListener?t.addEventListener(f,u,!1):t.attachEvent&&t.attachEvent("on"+f,u))),c.add&&(c.add.call(t,d),d.handler.guid||(d.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,d):p.push(d),ce.event.global[f]=!0)}t=null}},remove:function(t,e,i,n,s){var o,r,a,l,h,c,u,d,p,f,m,g=ce.hasData(t)&&ce._data(t);if(g&&(c=g.events)){for(e=(e||"").match(de)||[""],h=e.length;h--;){if(a=Le.exec(e[h])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p){for(u=ce.event.special[p]||{},p=(n?u.delegateType:u.bindType)||p,d=c[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=d.length;o--;){r=d[o],!s&&m!==r.origType||i&&i.guid!==r.guid||a&&!a.test(r.namespace)||n&&n!==r.selector&&("**"!==n||!r.selector)||(d.splice(o,1),r.selector&&d.delegateCount--,u.remove&&u.remove.call(t,r))}l&&!d.length&&(u.teardown&&u.teardown.call(t,f,g.handle)!==!1||ce.removeEvent(t,p,g.handle),delete c[p])}else{for(p in c){ce.event.remove(t,p+e[h],i,n,!0)}}}ce.isEmptyObject(c)&&(delete g.handle,ce._removeData(t,"events"))}},trigger:function(i,n,s,o){var r,a,l,h,c,u,d,p=[s||Q],f=le.call(i,"type")?i.type:i,m=le.call(i,"namespace")?i.namespace.split("."):[];if(l=u=s=s||Q,3!==s.nodeType&&8!==s.nodeType&&!We.test(f+ce.event.triggered)&&(f.indexOf(".")>=0&&(m=f.split("."),f=m.shift(),m.sort()),a=f.indexOf(":")<0&&"on"+f,i=i[ce.expando]?i:new ce.Event(f,"object"==typeof i&&i),i.isTrigger=o?2:3,i.namespace=m.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=e,i.target||(i.target=s),n=null==n?[i]:ce.makeArray(n,[i]),c=ce.event.special[f]||{},o||!c.trigger||c.trigger.apply(s,n)!==!1)){if(!o&&!c.noBubble&&!ce.isWindow(s)){for(h=c.delegateType||f,We.test(h+f)||(l=l.parentNode);l;l=l.parentNode){p.push(l),u=l}u===(s.ownerDocument||Q)&&p.push(u.defaultView||u.parentWindow||t)}for(d=0;(l=p[d++])&&!i.isPropagationStopped();){i.type=d>1?h:c.bindType||f,r=(ce._data(l,"events")||{})[i.type]&&ce._data(l,"handle"),r&&r.apply(l,n),r=a&&l[a],r&&ce.acceptData(l)&&r.apply&&r.apply(l,n)===!1&&i.preventDefault()}if(i.type=f,!o&&!i.isDefaultPrevented()&&(!c._default||c._default.apply(p.pop(),n)===!1)&&ce.acceptData(s)&&a&&s[f]&&!ce.isWindow(s)){u=s[a],u&&(s[a]=null),ce.event.triggered=f;try{s[f]()}catch(g){}ce.event.triggered=e,u&&(s[a]=u)}return i.result}},dispatch:function(t){t=ce.event.fix(t);var i,n,s,o,r,a=[],l=oe.call(arguments),h=(ce._data(this,"events")||{})[t.type]||[],c=ce.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,t)!==!1){for(a=ce.event.handlers.call(this,t,h),i=0;(o=a[i++])&&!t.isPropagationStopped();){for(t.currentTarget=o.elem,r=0;(s=o.handlers[r++])&&!t.isImmediatePropagationStopped();){(!t.namespace_re||t.namespace_re.test(s.namespace))&&(t.handleObj=s,t.data=s.data,n=((ce.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,l),n!==e&&(t.result=n)===!1&&(t.preventDefault(),t.stopPropagation()))}}return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,i){var n,s,o,r,a=[],l=i.delegateCount,h=t.target;if(l&&h.nodeType&&(!t.button||"click"!==t.type)){for(;h!=this;h=h.parentNode||this){if(1===h.nodeType&&(h.disabled!==!0||"click"!==t.type)){for(o=[],r=0;l>r;r++){s=i[r],n=s.selector+" ",o[n]===e&&(o[n]=s.needsContext?ce(n,this).index(h)>=0:ce.find(n,this,null,[h]).length),o[n]&&o.push(s)}o.length&&a.push({elem:h,handlers:o})}}}return l<i.length&&a.push({elem:this,handlers:i.slice(l)}),a},fix:function(t){if(t[ce.expando]){return t}var e,i,n,s=t.type,o=t,r=this.fixHooks[s];for(r||(this.fixHooks[s]=r=Fe.test(s)?this.mouseHooks:ze.test(s)?this.keyHooks:{}),n=r.props?this.props.concat(r.props):this.props,t=new ce.Event(o),e=n.length;e--;){i=n[e],t[i]=o[i]}return t.target||(t.target=o.srcElement||Q),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,r.filter?r.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,i){var n,s,o,r=i.button,a=i.fromElement;return null==t.pageX&&null!=i.clientX&&(s=t.target.ownerDocument||Q,o=s.documentElement,n=s.body,t.pageX=i.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||n&&n.clientLeft||0),t.pageY=i.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?i.toElement:a),t.which||r===e||(t.which=1&r?1:2&r?3:4&r?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==c()&&this.focus){try{return this.focus(),!1}catch(t){}}},delegateType:"focusin"},blur:{trigger:function(){return this===c()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return ce.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return ce.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var s=ce.extend(new ce.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?ce.event.trigger(s,null,e):ce.event.dispatch.call(e,s),s.isDefaultPrevented()&&i.preventDefault()}},ce.removeEvent=Q.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===V&&(t[n]=null),t.detachEvent(n,i))},ce.Event=function(t,e){return this instanceof ce.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?l:h):this.type=t,e&&ce.extend(this,e),this.timeStamp=t&&t.timeStamp||ce.now(),this[ce.expando]=!0,void 0):new ce.Event(t,e)},ce.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=l,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=l,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ce.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){ce.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,s=t.relatedTarget,o=t.handleObj;return(!s||s!==n&&!ce.contains(n,s))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),ce.support.submitBubbles||(ce.event.special.submit={setup:function(){return ce.nodeName(this,"form")?!1:(ce.event.add(this,"click._submit keypress._submit",function(t){var i=t.target,n=ce.nodeName(i,"input")||ce.nodeName(i,"button")?i.form:e;n&&!ce._data(n,"submitBubbles")&&(ce.event.add(n,"submit._submit",function(t){t._submit_bubble=!0}),ce._data(n,"submitBubbles",!0))}),void 0)},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&ce.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return ce.nodeName(this,"form")?!1:(ce.event.remove(this,"._submit"),void 0)}}),ce.support.changeBubbles||(ce.event.special.change={setup:function(){return je.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ce.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),ce.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),ce.event.simulate("change",this,t,!0)})),!1):(ce.event.add(this,"beforeactivate._change",function(t){var e=t.target;je.test(e.nodeName)&&!ce._data(e,"changeBubbles")&&(ce.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||ce.event.simulate("change",this.parentNode,t,!0)}),ce._data(e,"changeBubbles",!0))}),void 0)},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ce.event.remove(this,"._change"),!je.test(this.nodeName)}}),ce.support.focusinBubbles||ce.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,n=function(t){ce.event.simulate(e,t.target,ce.event.fix(t),!0)};ce.event.special[e]={setup:function(){0===i++&&Q.addEventListener(t,n,!0)},teardown:function(){0===--i&&Q.removeEventListener(t,n,!0)}}}),ce.fn.extend({on:function(t,i,n,s,o){var r,a;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=e);for(r in t){this.on(r,i,n,t[r],o)}return this}if(null==n&&null==s?(s=i,n=i=e):null==s&&("string"==typeof i?(s=n,n=e):(s=n,n=i,i=e)),s===!1){s=h}else{if(!s){return this}}return 1===o&&(a=s,s=function(t){return ce().off(t),a.apply(this,arguments)},s.guid=a.guid||(a.guid=ce.guid++)),this.each(function(){ce.event.add(this,t,s,n,i)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,i,n){var s,o;if(t&&t.preventDefault&&t.handleObj){return s=t.handleObj,ce(t.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this}if("object"==typeof t){for(o in t){this.off(o,i,t[o])}return this}return(i===!1||"function"==typeof i)&&(n=i,i=e),n===!1&&(n=h),this.each(function(){ce.event.remove(this,t,n,i)})},trigger:function(t,e){return this.each(function(){ce.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?ce.event.trigger(t,e,i,!0):void 0}});var $e=/^.[^:#\[\.,]*$/,Be=/^(?:parents|prev(?:Until|All))/,qe=ce.expr.match.needsContext,Ke={children:!0,contents:!0,next:!0,prev:!0};ce.fn.extend({find:function(t){var e,i=[],n=this,s=n.length;if("string"!=typeof t){return this.pushStack(ce(t).filter(function(){for(e=0;s>e;e++){if(ce.contains(n[e],this)){return !0}}}))}for(e=0;s>e;e++){ce.find(t,n[e],i)}return i=this.pushStack(s>1?ce.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},has:function(t){var e,i=ce(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++){if(ce.contains(this,i[e])){return !0}}})},not:function(t){return this.pushStack(d(this,t||[],!0))},filter:function(t){return this.pushStack(d(this,t||[],!1))},is:function(t){return !!d(this,"string"==typeof t&&qe.test(t)?ce(t):t||[],!1).length},closest:function(t,e){for(var i,n=0,s=this.length,o=[],r=qe.test(t)||"string"!=typeof t?ce(t,e||this.context):0;s>n;n++){for(i=this[n];i&&i!==e;i=i.parentNode){if(i.nodeType<11&&(r?r.index(i)>-1:1===i.nodeType&&ce.find.matchesSelector(i,t))){i=o.push(i);break}}}return this.pushStack(o.length>1?ce.unique(o):o)},index:function(t){return t?"string"==typeof t?ce.inArray(this[0],ce(t)):ce.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var i="string"==typeof t?ce(t,e):ce.makeArray(t&&t.nodeType?[t]:t),n=ce.merge(this.get(),i);return this.pushStack(ce.unique(n))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ce.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return ce.dir(t,"parentNode")},parentsUntil:function(t,e,i){return ce.dir(t,"parentNode",i)},next:function(t){return u(t,"nextSibling")},prev:function(t){return u(t,"previousSibling")},nextAll:function(t){return ce.dir(t,"nextSibling")},prevAll:function(t){return ce.dir(t,"previousSibling")},nextUntil:function(t,e,i){return ce.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return ce.dir(t,"previousSibling",i)},siblings:function(t){return ce.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return ce.sibling(t.firstChild)},contents:function(t){return ce.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:ce.merge([],t.childNodes)}},function(t,e){ce.fn[t]=function(i,n){var s=ce.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=ce.filter(n,s)),this.length>1&&(Ke[t]||(s=ce.unique(s)),Be.test(t)&&(s=s.reverse())),this.pushStack(s)}}),ce.extend({filter:function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?ce.find.matchesSelector(n,t)?[n]:[]:ce.find.matches(t,ce.grep(e,function(t){return 1===t.nodeType}))},dir:function(t,i,n){for(var s=[],o=t[i];o&&9!==o.nodeType&&(n===e||1!==o.nodeType||!ce(o).is(n));){1===o.nodeType&&s.push(o),o=o[i]}return s},sibling:function(t,e){for(var i=[];t;t=t.nextSibling){1===t.nodeType&&t!==e&&i.push(t)}return i}});var Ue="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ye=/ jQuery\d+="(?:null|\d+)"/g,Ve=new RegExp("<(?:"+Ue+")[\\s/>]","i"),Xe=/^\s+/,Qe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Je=/<([\w:]+)/,Ge=/<tbody/i,Ze=/<|&#?\w+;/,ti=/<(?:script|style|link)/i,ei=/^(?:checkbox|radio)$/i,ii=/checked\s*(?:[^=]|=\s*.checked.)/i,ni=/^$|\/(?:java|ecma)script/i,si=/^true\/(.*)/,oi=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ri={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ce.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ai=p(Q),li=ai.appendChild(Q.createElement("div"));ri.optgroup=ri.option,ri.tbody=ri.tfoot=ri.colgroup=ri.caption=ri.thead,ri.th=ri.td,ce.fn.extend({text:function(t){return ce.access(this,function(t){return t===e?ce.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Q).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=f(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=f(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?ce.filter(t,this):this,s=0;null!=(i=n[s]);s++){e||1!==i.nodeType||ce.cleanData(_(i)),i.parentNode&&(e&&ce.contains(i.ownerDocument,i)&&v(_(i,"script")),i.parentNode.removeChild(i))}return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&ce.cleanData(_(t,!1));t.firstChild;){t.removeChild(t.firstChild)}t.options&&ce.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return ce.clone(this,t,e)})},html:function(t){return ce.access(this,function(t){var i=this[0]||{},n=0,s=this.length;if(t===e){return 1===i.nodeType?i.innerHTML.replace(Ye,""):e}if(!("string"!=typeof t||ti.test(t)||!ce.support.htmlSerialize&&Ve.test(t)||!ce.support.leadingWhitespace&&Xe.test(t)||ri[(Je.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Qe,"<$1></$2>");try{for(;s>n;n++){i=this[n]||{},1===i.nodeType&&(ce.cleanData(_(i,!1)),i.innerHTML=t)}i=0}catch(o){}}i&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=ce.map(this,function(t){return[t.nextSibling,t.parentNode]}),e=0;return this.domManip(arguments,function(i){var n=t[e++],s=t[e++];s&&(n&&n.parentNode!==s&&(n=this.nextSibling),ce(this).remove(),s.insertBefore(i,n))},!0),e?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,i){t=ne.apply([],t);var n,s,o,r,a,l,h=0,c=this.length,u=this,d=c-1,p=t[0],f=ce.isFunction(p);if(f||!(1>=c||"string"!=typeof p||ce.support.checkClone)&&ii.test(p)){return this.each(function(n){var s=u.eq(n);f&&(t[0]=p.call(this,n,s.html())),s.domManip(t,e,i)})}if(c&&(l=ce.buildFragment(t,this[0].ownerDocument,!1,!i&&this),n=l.firstChild,1===l.childNodes.length&&(l=n),n)){for(r=ce.map(_(l,"script"),m),o=r.length;c>h;h++){s=l,h!==d&&(s=ce.clone(s,!0,!0),o&&ce.merge(r,_(s,"script"))),e.call(this[h],s,h)}if(o){for(a=r[r.length-1].ownerDocument,ce.map(r,g),h=0;o>h;h++){s=r[h],ni.test(s.type||"")&&!ce._data(s,"globalEval")&&ce.contains(a,s)&&(s.src?ce._evalUrl(s.src):ce.globalEval((s.text||s.textContent||s.innerHTML||"").replace(oi,"")))}}l=n=null}return this}}),ce.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ce.fn[t]=function(t){for(var i,n=0,s=[],o=ce(t),r=o.length-1;r>=n;n++){i=n===r?this:this.clone(!0),ce(o[n])[e](i),se.apply(s,i.get())}return this.pushStack(s)}}),ce.extend({clone:function(t,e,i){var n,s,o,r,a,l=ce.contains(t.ownerDocument,t);if(ce.support.html5Clone||ce.isXMLDoc(t)||!Ve.test("<"+t.nodeName+">")?o=t.cloneNode(!0):(li.innerHTML=t.outerHTML,li.removeChild(o=li.firstChild)),!(ce.support.noCloneEvent&&ce.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ce.isXMLDoc(t))){for(n=_(o),a=_(t),r=0;null!=(s=a[r]);++r){n[r]&&b(s,n[r])}}if(e){if(i){for(a=a||_(t),n=n||_(o),r=0;null!=(s=a[r]);r++){y(s,n[r])}}else{y(t,o)}}return n=_(o,"script"),n.length>0&&v(n,!l&&_(t,"script")),n=a=s=null,o},buildFragment:function(t,e,i,n){for(var s,o,r,a,l,h,c,u=t.length,d=p(e),f=[],m=0;u>m;m++){if(o=t[m],o||0===o){if("object"===ce.type(o)){ce.merge(f,o.nodeType?[o]:o)}else{if(Ze.test(o)){for(a=a||d.appendChild(e.createElement("div")),l=(Je.exec(o)||["",""])[1].toLowerCase(),c=ri[l]||ri._default,a.innerHTML=c[1]+o.replace(Qe,"<$1></$2>")+c[2],s=c[0];s--;){a=a.lastChild}if(!ce.support.leadingWhitespace&&Xe.test(o)&&f.push(e.createTextNode(Xe.exec(o)[0])),!ce.support.tbody){for(o="table"!==l||Ge.test(o)?"<table>"!==c[1]||Ge.test(o)?0:a:a.firstChild,s=o&&o.childNodes.length;s--;){ce.nodeName(h=o.childNodes[s],"tbody")&&!h.childNodes.length&&o.removeChild(h)}}for(ce.merge(f,a.childNodes),a.textContent="";a.firstChild;){a.removeChild(a.firstChild)}a=d.lastChild}else{f.push(e.createTextNode(o))}}}}for(a&&d.removeChild(a),ce.support.appendChecked||ce.grep(_(f,"input"),w),m=0;o=f[m++];){if((!n||-1===ce.inArray(o,n))&&(r=ce.contains(o.ownerDocument,o),a=_(d.appendChild(o),"script"),r&&v(a),i)){for(s=0;o=a[s++];){ni.test(o.type||"")&&i.push(o)}}}return a=null,d},cleanData:function(t,e){for(var i,n,s,o,r=0,a=ce.expando,l=ce.cache,h=ce.support.deleteExpando,c=ce.event.special;null!=(i=t[r]);r++){if((e||ce.acceptData(i))&&(s=i[a],o=s&&l[s])){if(o.events){for(n in o.events){c[n]?ce.event.remove(i,n):ce.removeEvent(i,n,o.handle)}}l[s]&&(delete l[s],h?delete i[a]:typeof i.removeAttribute!==V?i.removeAttribute(a):i[a]=null,ee.push(s))}}},_evalUrl:function(t){return ce.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ce.fn.extend({wrapAll:function(t){if(ce.isFunction(t)){return this.each(function(e){ce(this).wrapAll(t.call(this,e))})}if(this[0]){var e=ce(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;){t=t.firstChild}return t}).append(this)}return this},wrapInner:function(t){return ce.isFunction(t)?this.each(function(e){ce(this).wrapInner(t.call(this,e))}):this.each(function(){var e=ce(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=ce.isFunction(t);return this.each(function(i){ce(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){ce.nodeName(this,"body")||ce(this).replaceWith(this.childNodes)}).end()}});var hi,ci,ui,di=/alpha\([^)]*\)/i,pi=/opacity\s*=\s*([^)]*)/,fi=/^(top|right|bottom|left)$/,mi=/^(none|table(?!-c[ea]).+)/,gi=/^margin/,vi=new RegExp("^("+ue+")(.*)$","i"),yi=new RegExp("^("+ue+")(?!px)[a-z%]+$","i"),bi=new RegExp("^([+-])=("+ue+")","i"),_i={BODY:"block"},wi={position:"absolute",visibility:"hidden",display:"block"},xi={letterSpacing:0,fontWeight:400},ki=["Top","Right","Bottom","Left"],Ci=["Webkit","O","Moz","ms"];ce.fn.extend({css:function(t,i){return ce.access(this,function(t,i,n){var s,o,r={},a=0;if(ce.isArray(i)){for(o=ci(t),s=i.length;s>a;a++){r[i[a]]=ce.css(t,i[a],!1,o)}return r}return n!==e?ce.style(t,i,n):ce.css(t,i)},t,i,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(t){var e="boolean"==typeof t;return this.each(function(){(e?t:k(this))?ce(this).show():ce(this).hide()})}}),ce.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=ui(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ce.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,i,n,s){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,a,l=ce.camelCase(i),h=t.style;if(i=ce.cssProps[l]||(ce.cssProps[l]=x(h,l)),a=ce.cssHooks[i]||ce.cssHooks[l],n===e){return a&&"get" in a&&(o=a.get(t,!1,s))!==e?o:h[i]}if(r=typeof n,"string"===r&&(o=bi.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(ce.css(t,i)),r="number"),!(null==n||"number"===r&&isNaN(n)||("number"!==r||ce.cssNumber[l]||(n+="px"),ce.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(h[i]="inherit"),a&&"set" in a&&(n=a.set(t,n,s))===e))){try{h[i]=n}catch(c){}}}},css:function(t,i,n,s){var o,r,a,l=ce.camelCase(i);return i=ce.cssProps[l]||(ce.cssProps[l]=x(t.style,l)),a=ce.cssHooks[i]||ce.cssHooks[l],a&&"get" in a&&(r=a.get(t,!0,n)),r===e&&(r=ui(t,i,s)),"normal"===r&&i in xi&&(r=xi[i]),""===n||n?(o=parseFloat(r),n===!0||ce.isNumeric(o)?o||0:r):r}}),t.getComputedStyle?(ci=function(e){return t.getComputedStyle(e,null)},ui=function(t,i,n){var s,o,r,a=n||ci(t),l=a?a.getPropertyValue(i)||a[i]:e,h=t.style;return a&&(""!==l||ce.contains(t.ownerDocument,t)||(l=ce.style(t,i)),yi.test(l)&&gi.test(i)&&(s=h.width,o=h.minWidth,r=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=a.width,h.width=s,h.minWidth=o,h.maxWidth=r)),l}):Q.documentElement.currentStyle&&(ci=function(t){return t.currentStyle},ui=function(t,i,n){var s,o,r,a=n||ci(t),l=a?a[i]:e,h=t.style;return null==l&&h&&h[i]&&(l=h[i]),yi.test(l)&&!fi.test(i)&&(s=h.left,o=t.runtimeStyle,r=o&&o.left,r&&(o.left=t.currentStyle.left),h.left="fontSize"===i?"1em":l,l=h.pixelLeft+"px",h.left=s,r&&(o.left=r)),""===l?"auto":l}),ce.each(["height","width"],function(t,e){ce.cssHooks[e]={get:function(t,i,n){return i?0===t.offsetWidth&&mi.test(ce.css(t,"display"))?ce.swap(t,wi,function(){return M(t,e,n)}):M(t,e,n):void 0},set:function(t,i,n){var s=n&&ci(t);return T(t,i,n?D(t,e,n,ce.support.boxSizing&&"border-box"===ce.css(t,"boxSizing",!1,s),s):0)}}}),ce.support.opacity||(ce.cssHooks.opacity={get:function(t,e){return pi.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,s=ce.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===ce.trim(o.replace(di,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=di.test(o)?o.replace(di,s):o+" "+s)}}),ce(function(){ce.support.reliableMarginRight||(ce.cssHooks.marginRight={get:function(t,e){return e?ce.swap(t,{display:"inline-block"},ui,[t,"marginRight"]):void 0}}),!ce.support.pixelPosition&&ce.fn.position&&ce.each(["top","left"],function(t,e){ce.cssHooks[e]={get:function(t,i){return i?(i=ui(t,e),yi.test(i)?ce(t).position()[e]+"px":i):void 0}}})}),ce.expr&&ce.expr.filters&&(ce.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!ce.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||ce.css(t,"display"))},ce.expr.filters.visible=function(t){return !ce.expr.filters.hidden(t)}),ce.each({margin:"",padding:"",border:"Width"},function(t,e){ce.cssHooks[t+e]={expand:function(i){for(var n=0,s={},o="string"==typeof i?i.split(" "):[i];4>n;n++){s[t+ki[n]+e]=o[n]||o[n-2]||o[0]}return s}},gi.test(t)||(ce.cssHooks[t+e].set=T)});var Ti=/%20/g,Di=/\[\]$/,Mi=/\r?\n/g,Si=/^(?:submit|button|image|reset|file)$/i,Ii=/^(?:input|select|textarea|keygen)/i;ce.fn.extend({serialize:function(){return ce.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ce.prop(this,"elements");return t?ce.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ce(this).is(":disabled")&&Ii.test(this.nodeName)&&!Si.test(t)&&(this.checked||!ei.test(t))}).map(function(t,e){var i=ce(this).val();return null==i?null:ce.isArray(i)?ce.map(i,function(t){return{name:e.name,value:t.replace(Mi,"\r\n")}}):{name:e.name,value:i.replace(Mi,"\r\n")}}).get()}}),ce.param=function(t,i){var n,s=[],o=function(t,e){e=ce.isFunction(e)?e():null==e?"":e,s[s.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(i===e&&(i=ce.ajaxSettings&&ce.ajaxSettings.traditional),ce.isArray(t)||t.jquery&&!ce.isPlainObject(t)){ce.each(t,function(){o(this.name,this.value)})}else{for(n in t){E(n,t[n],i,o)}}return s.join("&").replace(Ti,"+")},ce.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){ce.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),ce.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var Ei,Ni,Ai=ce.now(),Pi=/\?/,Ri=/#.*$/,Hi=/([?&])_=[^&]*/,Oi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,ji=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,zi=/^(?:GET|HEAD)$/,Fi=/^\/\//,Wi=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Li=ce.fn.load,$i={},Bi={},qi="*/".concat("*");try{Ni=X.href}catch(Ki){Ni=Q.createElement("a"),Ni.href="",Ni=Ni.href}Ei=Wi.exec(Ni.toLowerCase())||[],ce.fn.load=function(t,i,n){if("string"!=typeof t&&Li){return Li.apply(this,arguments)}var s,o,r,a=this,l=t.indexOf(" ");return l>=0&&(s=t.slice(l,t.length),t=t.slice(0,l)),ce.isFunction(i)?(n=i,i=e):i&&"object"==typeof i&&(r="POST"),a.length>0&&ce.ajax({url:t,type:r,dataType:"html",data:i}).done(function(t){o=arguments,a.html(s?ce("<div>").append(ce.parseHTML(t)).find(s):t)}).complete(n&&function(t,e){a.each(n,o||[t.responseText,e,t])}),this},ce.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ce.fn[e]=function(t){return this.on(e,t)}}),ce.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ni,type:"GET",isLocal:ji.test(Ei[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":qi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ce.parseJSON,"text xml":ce.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?P(P(t,ce.ajaxSettings),e):P(ce.ajaxSettings,t)},ajaxPrefilter:N($i),ajaxTransport:N(Bi),ajax:function(t,i){function n(t,i,n,s){var o,u,y,b,w,k=i;2!==_&&(_=2,l&&clearTimeout(l),c=e,a=s||"",x.readyState=t>0?4:0,o=t>=200&&300>t||304===t,n&&(b=R(d,x,n)),b=H(d,b,x,o),o?(d.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(ce.lastModified[r]=w),w=x.getResponseHeader("etag"),w&&(ce.etag[r]=w)),204===t||"HEAD"===d.type?k="nocontent":304===t?k="notmodified":(k=b.state,u=b.data,y=b.error,o=!y)):(y=k,(t||!k)&&(k="error",0>t&&(t=0))),x.status=t,x.statusText=(i||k)+"",o?m.resolveWith(p,[u,k,x]):m.rejectWith(p,[x,k,y]),x.statusCode(v),v=e,h&&f.trigger(o?"ajaxSuccess":"ajaxError",[x,d,o?u:y]),g.fireWith(p,[x,k]),h&&(f.trigger("ajaxComplete",[x,d]),--ce.active||ce.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=e),i=i||{};var s,o,r,a,l,h,c,u,d=ce.ajaxSetup({},i),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?ce(p):ce.event,m=ce.Deferred(),g=ce.Callbacks("once memory"),v=d.statusCode||{},y={},b={},_=0,w="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!u){for(u={};e=Oi.exec(a);){u[e[1].toLowerCase()]=e[2]}}e=u[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return _||(t=b[i]=b[i]||t,y[t]=e),this},overrideMimeType:function(t){return _||(d.mimeType=t),this},statusCode:function(t){var e;if(t){if(2>_){for(e in t){v[e]=[v[e],t[e]]}}else{x.always(t[x.status])}}return this},abort:function(t){var e=t||w;return c&&c.abort(e),n(0,e),this}};if(m.promise(x).complete=g.add,x.success=x.done,x.error=x.fail,d.url=((t||d.url||Ni)+"").replace(Ri,"").replace(Fi,Ei[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=ce.trim(d.dataType||"*").toLowerCase().match(de)||[""],null==d.crossDomain&&(s=Wi.exec(d.url.toLowerCase()),d.crossDomain=!(!s||s[1]===Ei[1]&&s[2]===Ei[2]&&(s[3]||("http:"===s[1]?"80":"443"))===(Ei[3]||("http:"===Ei[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=ce.param(d.data,d.traditional)),A($i,d,i,x),2===_){return x}h=d.global,h&&0===ce.active++&&ce.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!zi.test(d.type),r=d.url,d.hasContent||(d.data&&(r=d.url+=(Pi.test(r)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Hi.test(r)?r.replace(Hi,"$1_="+Ai++):r+(Pi.test(r)?"&":"?")+"_="+Ai++)),d.ifModified&&(ce.lastModified[r]&&x.setRequestHeader("If-Modified-Since",ce.lastModified[r]),ce.etag[r]&&x.setRequestHeader("If-None-Match",ce.etag[r])),(d.data&&d.hasContent&&d.contentType!==!1||i.contentType)&&x.setRequestHeader("Content-Type",d.contentType),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+qi+"; q=0.01":""):d.accepts["*"]);for(o in d.headers){x.setRequestHeader(o,d.headers[o])}if(d.beforeSend&&(d.beforeSend.call(p,x,d)===!1||2===_)){return x.abort()}w="abort";for(o in {success:1,error:1,complete:1}){x[o](d[o])}if(c=A(Bi,d,i,x)){x.readyState=1,h&&f.trigger("ajaxSend",[x,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){x.abort("timeout")},d.timeout));try{_=1,c.send(y,n)}catch(k){if(!(2>_)){throw k}n(-1,k)}}else{n(-1,"No Transport")}return x},getJSON:function(t,e,i){return ce.get(t,e,i,"json")},getScript:function(t,i){return ce.get(t,e,i,"script")}}),ce.each(["get","post"],function(t,i){ce[i]=function(t,n,s,o){return ce.isFunction(n)&&(o=o||s,s=n,n=e),ce.ajax({url:t,type:i,dataType:o,data:n,success:s})}}),ce.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return ce.globalEval(t),t}}}),ce.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),ce.ajaxTransport("script",function(t){if(t.crossDomain){var i,n=Q.head||ce("head")[0]||Q.documentElement;return{send:function(e,s){i=Q.createElement("script"),i.async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(t,e){(e||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,e||s(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(e,!0)}}}});var Ui=[],Yi=/(=)\?(?=&|$)|\?\?/;ce.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ui.pop()||ce.expando+"_"+Ai++;return this[t]=!0,t}}),ce.ajaxPrefilter("json jsonp",function(i,n,s){var o,r,a,l=i.jsonp!==!1&&(Yi.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Yi.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(o=i.jsonpCallback=ce.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Yi,"$1"+o):i.jsonp!==!1&&(i.url+=(Pi.test(i.url)?"&":"?")+i.jsonp+"="+o),i.converters["script json"]=function(){return a||ce.error(o+" was not called"),a[0]},i.dataTypes[0]="json",r=t[o],t[o]=function(){a=arguments},s.always(function(){t[o]=r,i[o]&&(i.jsonpCallback=n.jsonpCallback,Ui.push(o)),a&&ce.isFunction(r)&&r(a[0]),a=r=e}),"script"):void 0});var Vi,Xi,Qi=0,Ji=t.ActiveXObject&&function(){var t;for(t in Vi){Vi[t](e,!0)}};ce.ajaxSettings.xhr=t.ActiveXObject?function(){return !this.isLocal&&O()||j()}:O,Xi=ce.ajaxSettings.xhr(),ce.support.cors=!!Xi&&"withCredentials" in Xi,Xi=ce.support.ajax=!!Xi,Xi&&ce.ajaxTransport(function(i){if(!i.crossDomain||ce.support.cors){var n;return{send:function(s,o){var r,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields){for(a in i.xhrFields){l[a]=i.xhrFields[a]}}i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest");try{for(a in s){l.setRequestHeader(a,s[a])}}catch(h){}l.send(i.hasContent&&i.data||null),n=function(t,s){var a,h,c,u;try{if(n&&(s||4===l.readyState)){if(n=e,r&&(l.onreadystatechange=ce.noop,Ji&&delete Vi[r]),s){4!==l.readyState&&l.abort()}else{u={},a=l.status,h=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(u.text=l.responseText);try{c=l.statusText}catch(d){c=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=u.text?200:404}}}catch(p){s||o(-1,p)}u&&o(a,c,u,h)},i.async?4===l.readyState?setTimeout(n):(r=++Qi,Ji&&(Vi||(Vi={},ce(t).unload(Ji)),Vi[r]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(e,!0)}}}});var Gi,Zi,tn=/^(?:toggle|show|hide)$/,en=new RegExp("^(?:([+-])=|)("+ue+")([a-z%]*)$","i"),nn=/queueHooks$/,sn=[$],on={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),s=en.exec(e),o=s&&s[3]||(ce.cssNumber[t]?"":"px"),r=(ce.cssNumber[t]||"px"!==o&&+n)&&en.exec(ce.css(i.elem,t)),a=1,l=20;if(r&&r[3]!==o){o=o||r[3],s=s||[],r=+n||1;do{a=a||".5",r/=a,ce.style(i.elem,t,r+o)}while(a!==(a=i.cur()/n)&&1!==a&&--l)}return s&&(r=i.start=+r||+n||0,i.unit=o,i.end=s[1]?r+(s[1]+1)*s[2]:+s[2]),i}]};ce.Animation=ce.extend(W,{tweener:function(t,e){ce.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,s=t.length;s>n;n++){i=t[n],on[i]=on[i]||[],on[i].unshift(e)}},prefilter:function(t,e){e?sn.unshift(t):sn.push(t)}}),ce.Tween=B,B.prototype={constructor:B,init:function(t,e,i,n,s,o){this.elem=t,this.prop=i,this.easing=s||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(ce.cssNumber[i]?"":"px")},cur:function(){var t=B.propHooks[this.prop];return t&&t.get?t.get(this):B.propHooks._default.get(this)},run:function(t){var e,i=B.propHooks[this.prop];return this.pos=e=this.options.duration?ce.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):B.propHooks._default.set(this),this}},B.prototype.init.prototype=B.prototype,B.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=ce.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){ce.fx.step[t.prop]?ce.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[ce.cssProps[t.prop]]||ce.cssHooks[t.prop])?ce.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},B.propHooks.scrollTop=B.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ce.each(["toggle","show","hide"],function(t,e){var i=ce.fn[e];ce.fn[e]=function(t,n,s){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(q(e,!0),t,n,s)}}),ce.fn.extend({fadeTo:function(t,e,i,n){return this.filter(k).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var s=ce.isEmptyObject(t),o=ce.speed(e,i,n),r=function(){var e=W(this,ce.extend({},t),o);(s||ce._data(this,"finish"))&&e.stop(!0)};return r.finish=r,s||o.queue===!1?this.each(r):this.queue(o.queue,r)},stop:function(t,i,n){var s=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=i,i=t,t=e),i&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",o=ce.timers,r=ce._data(this);if(i){r[i]&&r[i].stop&&s(r[i])}else{for(i in r){r[i]&&r[i].stop&&nn.test(i)&&s(r[i])}}for(i=o.length;i--;){o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1))}(e||!n)&&ce.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=ce._data(this),n=i[t+"queue"],s=i[t+"queueHooks"],o=ce.timers,r=n?n.length:0;for(i.finish=!0,ce.queue(this,t,[]),s&&s.stop&&s.stop.call(this,!0),e=o.length;e--;){o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1))}for(e=0;r>e;e++){n[e]&&n[e].finish&&n[e].finish.call(this)}delete i.finish})}}),ce.each({slideDown:q("show"),slideUp:q("hide"),slideToggle:q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ce.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),ce.speed=function(t,e,i){var n=t&&"object"==typeof t?ce.extend({},t):{complete:i||!i&&e||ce.isFunction(t)&&t,duration:t,easing:i&&e||e&&!ce.isFunction(e)&&e};return n.duration=ce.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ce.fx.speeds?ce.fx.speeds[n.duration]:ce.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){ce.isFunction(n.old)&&n.old.call(this),n.queue&&ce.dequeue(this,n.queue)},n},ce.easing={linear:function(t){return t},swing:function(t){return 0.5-Math.cos(t*Math.PI)/2}},ce.timers=[],ce.fx=B.prototype.init,ce.fx.tick=function(){var t,i=ce.timers,n=0;for(Gi=ce.now();n<i.length;n++){t=i[n],t()||i[n]!==t||i.splice(n--,1)}i.length||ce.fx.stop(),Gi=e},ce.fx.timer=function(t){t()&&ce.timers.push(t)&&ce.fx.start()},ce.fx.interval=13,ce.fx.start=function(){Zi||(Zi=setInterval(ce.fx.tick,ce.fx.interval))},ce.fx.stop=function(){clearInterval(Zi),Zi=null},ce.fx.speeds={slow:600,fast:200,_default:400},ce.fx.step={},ce.expr&&ce.expr.filters&&(ce.expr.filters.animated=function(t){return ce.grep(ce.timers,function(e){return t===e.elem}).length}),ce.fn.offset=function(t){if(arguments.length){return t===e?this:this.each(function(e){ce.offset.setOffset(this,t,e)})}var i,n,s={top:0,left:0},o=this[0],r=o&&o.ownerDocument;if(r){return i=r.documentElement,ce.contains(i,o)?(typeof o.getBoundingClientRect!==V&&(s=o.getBoundingClientRect()),n=K(r),{top:s.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:s.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):s}},ce.offset={setOffset:function(t,e,i){var n=ce.css(t,"position");"static"===n&&(t.style.position="relative");var s,o,r=ce(t),a=r.offset(),l=ce.css(t,"top"),h=ce.css(t,"left"),c=("absolute"===n||"fixed"===n)&&ce.inArray("auto",[l,h])>-1,u={},d={};c?(d=r.position(),s=d.top,o=d.left):(s=parseFloat(l)||0,o=parseFloat(h)||0),ce.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(u.top=e.top-a.top+s),null!=e.left&&(u.left=e.left-a.left+o),"using" in e?e.using.call(t,u):r.css(u)}},ce.fn.extend({position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===ce.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),ce.nodeName(t[0],"html")||(i=t.offset()),i.top+=ce.css(t[0],"borderTopWidth",!0),i.left+=ce.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-ce.css(n,"marginTop",!0),left:e.left-i.left-ce.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||J;t&&!ce.nodeName(t,"html")&&"static"===ce.css(t,"position");){t=t.offsetParent}return t||J})}}),ce.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n=/Y/.test(i);ce.fn[t]=function(s){return ce.access(this,function(t,s,o){var r=K(t);return o===e?r?i in r?r[i]:r.document.documentElement[s]:t[s]:(r?r.scrollTo(n?ce(r).scrollLeft():o,n?o:ce(r).scrollTop()):t[s]=o,void 0)},t,s,arguments.length,null)}}),ce.each({Height:"height",Width:"width"},function(t,i){ce.each({padding:"inner"+t,content:i,"":"outer"+t},function(n,s){ce.fn[s]=function(s,o){var r=arguments.length&&(n||"boolean"!=typeof s),a=n||(s===!0||o===!0?"margin":"border");return ce.access(this,function(i,n,s){var o;return ce.isWindow(i)?i.document.documentElement["client"+t]:9===i.nodeType?(o=i.documentElement,Math.max(i.body["scroll"+t],o["scroll"+t],i.body["offset"+t],o["offset"+t],o["client"+t])):s===e?ce.css(i,n,a):ce.style(i,n,s,a)},i,r?s:e,r,null)}})}),ce.fn.size=function(){return this.length},ce.fn.andSelf=ce.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ce:(t.$=t.$=ce,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ce}))}(window),function(b,c){b.rails!==c&&b.error("jquery-ujs has already been loaded!");var a,d=b(document);b.rails=a={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(g){var f=b('meta[name="csrf-token"]').attr("content");f&&g.setRequestHeader("X-CSRF-Token",f)},fire:function(h,f,j){var g=b.Event(f);return h.trigger(g,j),g.result!==!1},confirm:function(e){return confirm(e)},ajax:function(f){return b.ajax(f)},href:function(e){return e.attr("href")},handleRemote:function(i){var w,g,e,t,j,k,q,v;if(a.fire(i,"ajax:before")){if(t=i.data("cross-domain"),j=t===c?null:t,k=i.data("with-credentials")||null,q=i.data("type")||b.ajaxSettings&&b.ajaxSettings.dataType,i.is("form")){w=i.attr("method"),g=i.attr("action"),e=i.serializeArray();var m=i.data("ujs:submit-button");m&&(e.push(m),i.data("ujs:submit-button",null))}else{i.is(a.inputChangeSelector)?(w=i.data("method"),g=i.data("url"),e=i.serialize(),i.data("params")&&(e=e+"&"+i.data("params"))):i.is(a.buttonClickSelector)?(w=i.data("method")||"get",g=i.data("url"),e=i.serialize(),i.data("params")&&(e=e+"&"+i.data("params"))):(w=i.data("method"),g=a.href(i),e=i.data("params")||null)}v={type:w||"GET",data:e,dataType:q,beforeSend:function(h,l){return l.dataType===c&&h.setRequestHeader("accept","*/*;q=0.5, "+l.accepts.script),a.fire(i,"ajax:beforeSend",[h,l])},success:function(l,n,h){i.trigger("ajax:success",[l,n,h])},complete:function(h,l){i.trigger("ajax:complete",[h,l])},error:function(l,n,h){i.trigger("ajax:error",[l,n,h])},crossDomain:j},k&&(v.xhrFields={withCredentials:k}),g&&(v.url=g);var f=a.ajax(v);return i.trigger("ajax:send",f),f}return !1},handleMethod:function(p){var i=a.href(p),k=p.data("method"),j=p.attr("target"),f=b("meta[name=csrf-token]").attr("content"),e=b("meta[name=csrf-param]").attr("content"),g=b('<form method="post" action="'+i+'"></form>'),m='<input name="_method" value="'+k+'" type="hidden" />';e!==c&&f!==c&&(m+='<input name="'+e+'" value="'+f+'" type="hidden" />'),j&&g.attr("target",j),g.hide().append(m).appendTo("body"),g.submit()},disableFormElements:function(f){f.find(a.disableSelector).each(function(){var h=b(this),g=h.is("button")?"html":"val";h.data("ujs:enable-with",h[g]()),h[g](h.data("disable-with")),h.prop("disabled",!0)})},enableFormElements:function(f){f.find(a.enableSelector).each(function(){var h=b(this),g=h.is("button")?"html":"val";h.data("ujs:enable-with")&&h[g](h.data("ujs:enable-with")),h.prop("disabled",!1)})},allowAction:function(f){var h,i=f.data("confirm"),g=!1;return i?(a.fire(f,"confirm")&&(g=a.confirm(i),h=a.fire(f,"confirm:complete",[g])),g&&h):!0},blankInputs:function(m,h,q){var j,p,k=b(),g=h||"input,textarea",f=m.find(g);return f.each(function(){if(j=b(this),p=j.is("input[type=checkbox],input[type=radio]")?j.is(":checked"):j.val(),!p==!q){if(j.is("input[type=radio]")&&f.filter('input[type=radio]:checked[name="'+j.attr("name")+'"]').length){return !0}k=k.add(j)}}),k.length?k:!1},nonBlankInputs:function(f,g){return a.blankInputs(f,g,!0)},stopEverything:function(f){return b(f.target).trigger("ujs:everythingStopped"),f.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(f){return a.stopEverything(f)})},enableElement:function(e){e.data("ujs:enable-with")!==c&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},a.fire(d,"rails:attachBindings")&&(b.ajaxPrefilter(function(f,g,h){f.crossDomain||a.CSRFProtection(h)}),d.delegate(a.linkDisableSelector,"ajax:complete",function(){a.enableElement(b(this))}),d.delegate(a.linkClickSelector,"click.rails",function(i){var f=b(this),h=f.data("method"),g=f.data("params");if(!a.allowAction(f)){return a.stopEverything(i)}if(f.is(a.linkDisableSelector)&&a.disableElement(f),f.data("remote")!==c){if(!(!i.metaKey&&!i.ctrlKey||h&&"GET"!==h||g)){return !0}var e=a.handleRemote(f);return e===!1?a.enableElement(f):e.error(function(){a.enableElement(f)}),!1}return f.data("method")?(a.handleMethod(f),!1):void 0}),d.delegate(a.buttonClickSelector,"click.rails",function(f){var g=b(this);return a.allowAction(g)?(a.handleRemote(g),!1):a.stopEverything(f)}),d.delegate(a.inputChangeSelector,"change.rails",function(f){var g=b(this);return a.allowAction(g)?(a.handleRemote(g),!1):a.stopEverything(f)}),d.delegate(a.formSubmitSelector,"submit.rails",function(j){var g=b(this),i=g.data("remote")!==c,h=a.blankInputs(g,a.requiredInputSelector),f=a.nonBlankInputs(g,a.fileInputSelector);if(!a.allowAction(g)){return a.stopEverything(j)}if(h&&g.attr("novalidate")==c&&a.fire(g,"ajax:aborted:required",[h])){return a.stopEverything(j)}if(i){if(f){setTimeout(function(){a.disableFormElements(g)},13);var e=a.fire(g,"ajax:aborted:file",[f]);return e||setTimeout(function(){a.enableFormElements(g)},13),e}return a.handleRemote(g),!1}setTimeout(function(){a.disableFormElements(g)},13)}),d.delegate(a.formInputClickSelector,"click.rails",function(g){var i=b(this);if(!a.allowAction(i)){return a.stopEverything(g)}var f=i.attr("name"),h=f?{name:f,value:i.val()}:null;i.closest("form").data("ujs:submit-button",h)}),d.delegate(a.formSubmitSelector,"ajax:beforeSend.rails",function(f){this==f.target&&a.disableFormElements(b(this))}),d.delegate(a.formSubmitSelector,"ajax:complete.rails",function(f){this==f.target&&a.enableFormElements(b(this))}),b(function(){var g=b("meta[name=csrf-token]").attr("content"),f=b("meta[name=csrf-param]").attr("content");b('form input[name="'+f+'"]').val(g)}))}($),
/*!
 * jQuery UI Core 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
function(b,d){function a(m,j){var k,n,l,h=m.nodeName.toLowerCase();return"area"===h?(k=m.parentNode,n=k.name,m.href&&n&&"map"===k.nodeName.toLowerCase()?(l=b("img[usemap=#"+n+"]")[0],!!l&&g(l)):!1):(/input|select|textarea|button|object/.test(h)?!m.disabled:"a"===h?m.href||j:j)&&g(m)}function g(h){return b.expr.filters.visible(h)&&!b(h).parents().addBack().filter(function(){return"hidden"===b.css(this,"visibility")}).length}var c=0,f=/^ui-id-\d+$/;b.ui=b.ui||{},b.extend(b.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),b.fn.extend({focus:function(h){return function(e,j){return"number"==typeof e?this.each(function(){var i=this;setTimeout(function(){b(i).focus(),j&&j.call(i)},e)}):h.apply(this,arguments)}}(b.fn.focus),scrollParent:function(){var h;return h=b.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(b.css(this,"position"))&&/(auto|scroll)/.test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!h.length?b(document):h},zIndex:function(e){if(e!==d){return this.css("zIndex",e)}if(this.length){for(var k,h,j=b(this[0]);j.length&&j[0]!==document;){if(k=j.css("position"),("absolute"===k||"relative"===k||"fixed"===k)&&(h=parseInt(j.css("zIndex"),10),!isNaN(h)&&0!==h)){return h}j=j.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++c)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&b(this).removeAttr("id")})}}),b.extend(b.expr[":"],{data:b.expr.createPseudo?b.expr.createPseudo(function(h){return function(e){return !!b.data(e,h)}}):function(j,h,k){return !!b.data(j,k[3])},focusable:function(h){return a(h,!isNaN(b.attr(h,"tabindex")))},tabbable:function(i){var j=b.attr(i,"tabindex"),h=isNaN(j);return(h||j>=0)&&a(i,!h)}}),b("<a>").outerWidth(1).jquery||b.each(["Width","Height"],function(h,m){function j(q,o,r,p){return b.each(l,function(){o-=parseFloat(b.css(q,"padding"+this))||0,r&&(o-=parseFloat(b.css(q,"border"+this+"Width"))||0),p&&(o-=parseFloat(b.css(q,"margin"+this))||0)}),o}var l="Width"===m?["Left","Right"]:["Top","Bottom"],k=m.toLowerCase(),e={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,outerWidth:b.fn.outerWidth,outerHeight:b.fn.outerHeight};b.fn["inner"+m]=function(n){return n===d?e["inner"+m].call(this):this.each(function(){b(this).css(k,j(this,n)+"px")})},b.fn["outer"+m]=function(o,n){return"number"!=typeof o?e["outer"+m].call(this,o):this.each(function(){b(this).css(k,j(this,o,!0,n)+"px")})}}),b.fn.addBack||(b.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),b("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(b.fn.removeData=function(h){return function(e){return arguments.length?h.call(this,b.camelCase(e)):h.call(this)}}(b.fn.removeData)),b.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),b.support.selectstart="onselectstart" in document.createElement("div"),b.fn.extend({disableSelection:function(){return this.bind((b.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),b.extend(b.ui,{plugin:{add:function(k,h,m){var j,l=b.ui[k].prototype;for(j in m){l.plugins[j]=l.plugins[j]||[],l.plugins[j].push([h,m[j]])}},call:function(j,l,h){var m,k=j.plugins[l];if(k&&j.element[0].parentNode&&11!==j.element[0].parentNode.nodeType){for(m=0;m<k.length;m++){j.options[k[m][0]]&&k[m][1].apply(j.element,h)}}}},hasScroll:function(k,h){if("hidden"===b(k).css("overflow")){return !1}var l=h&&"left"===h?"scrollLeft":"scrollTop",j=!1;return k[l]>0?!0:(k[l]=1,j=k[l]>0,k[l]=0,j)}})}($),
/*!
 * jQuery UI Widget 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
function(b,d){var a=0,f=Array.prototype.slice,c=b.cleanData;b.cleanData=function(h){for(var g,k=0;null!=(g=h[k]);k++){try{b(g).triggerHandler("remove")}catch(j){}}c(h)},b.widget=function(t,p,k){var v,j,g,u,m={},q=t.split(".")[0];t=t.split(".")[1],v=q+"-"+t,k||(k=p,p=b.Widget),b.expr[":"][v.toLowerCase()]=function(h){return !!b.data(h,v)},b[q]=b[q]||{},j=b[q][t],g=b[q][t]=function(h,i){return this._createWidget?(arguments.length&&this._createWidget(h,i),void 0):new g(h,i)},b.extend(g,j,{version:k.version,_proto:b.extend({},k),_childConstructors:[]}),u=new p,u.options=b.widget.extend({},u.options),b.each(k,function(h,i){return b.isFunction(i)?(m[h]=function(){var e=function(){return p.prototype[h].apply(this,arguments)},l=function(n){return p.prototype[h].apply(this,n)};return function(){var r,n=this._super,s=this._superApply;return this._super=e,this._superApply=l,r=i.apply(this,arguments),this._super=n,this._superApply=s,r}}(),void 0):(m[h]=i,void 0)}),g.prototype=b.widget.extend(u,{widgetEventPrefix:j?u.widgetEventPrefix:t},m,{constructor:g,namespace:q,widgetName:t,widgetFullName:v}),j?(b.each(j._childConstructors,function(l,h){var o=h.prototype;b.widget(o.namespace+"."+o.widgetName,g,h._proto)}),delete j._childConstructors):p._childConstructors.push(g),b.widget.bridge(t,g)},b.widget.extend=function(h){for(var j,m,k=f.call(arguments,1),g=0,e=k.length;e>g;g++){for(j in k[g]){m=k[g][j],k[g].hasOwnProperty(j)&&m!==d&&(h[j]=b.isPlainObject(m)?b.isPlainObject(h[j])?b.widget.extend({},h[j],m):b.widget.extend({},m):m)}}return h},b.widget.bridge=function(e,g){var h=g.prototype.widgetFullName||e;b.fn[e]=function(m){var j="string"==typeof m,i=f.call(arguments,1),k=this;return m=!j&&i.length?b.widget.extend.apply(null,[m].concat(i)):m,j?this.each(function(){var o,l=b.data(this,h);return l?b.isFunction(l[m])&&"_"!==m.charAt(0)?(o=l[m].apply(l,i),o!==l&&o!==d?(k=o&&o.jquery?k.pushStack(o.get()):o,!1):void 0):b.error("no such method '"+m+"' for "+e+" widget instance"):b.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+m+"'")}):this.each(function(){var l=b.data(this,h);l?l.option(m||{})._init():b.data(this,h,new g(m,this))}),k}},b.Widget=function(){},b.Widget._childConstructors=[],b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(g,h){h=b(h||this.defaultElement||this)[0],this.element=b(h),this.uuid=a++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=b.widget.extend({},this.options,this._getCreateOptions(),g),this.bindings=b(),this.hoverable=b(),this.focusable=b(),h!==this&&(b.data(h,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===h&&this.destroy()}}),this.document=b(h.style?h.ownerDocument:h.document||h),this.window=b(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(g,l){var h,k,j,e=g;if(0===arguments.length){return b.widget.extend({},this.options)}if("string"==typeof g){if(e={},h=g.split("."),g=h.shift(),h.length){for(k=e[g]=b.widget.extend({},this.options[g]),j=0;j<h.length-1;j++){k[h[j]]=k[h[j]]||{},k=k[h[j]]}if(g=h.pop(),l===d){return k[g]===d?null:k[g]}k[g]=l}else{if(l===d){return this.options[g]===d?null:this.options[g]}e[g]=l}}return this._setOptions(e),this},_setOptions:function(g){var h;for(h in g){this._setOption(h,g[h])}return this},_setOption:function(g,h){return this.options[g]=h,"disabled"===g&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!h).attr("aria-disabled",h),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(j,g,l){var h,k=this;"boolean"!=typeof j&&(l=g,g=j,j=!1),l?(g=h=b(g),this.bindings=this.bindings.add(g)):(l=g,g=this.element,h=this.widget()),b.each(l,function(q,o){function i(){return j||k.options.disabled!==!0&&!b(this).hasClass("ui-state-disabled")?("string"==typeof o?k[o]:o).apply(k,arguments):void 0}"string"!=typeof o&&(i.guid=o.guid=o.guid||i.guid||b.guid++);var e=q.match(/^(\w+)\s*(.*)$/),m=e[1]+k.eventNamespace,p=e[2];p?h.delegate(p,m,i):g.bind(m,i)})},_off:function(g,h){h=(h||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,g.unbind(h).undelegate(h)},_delay:function(h,j){function g(){return("string"==typeof h?k[h]:h).apply(k,arguments)}var k=this;return setTimeout(g,j||0)},_hoverable:function(g){this.hoverable=this.hoverable.add(g),this._on(g,{mouseenter:function(h){b(h.currentTarget).addClass("ui-state-hover")},mouseleave:function(h){b(h.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(g){this.focusable=this.focusable.add(g),this._on(g,{focusin:function(h){b(h.currentTarget).addClass("ui-state-focus")},focusout:function(h){b(h.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(k,g,m){var h,l,j=this.options[k];if(m=m||{},g=b.Event(g),g.type=(k===this.widgetEventPrefix?k:this.widgetEventPrefix+k).toLowerCase(),g.target=this.element[0],l=g.originalEvent){for(h in l){h in g||(g[h]=l[h])}}return this.element.trigger(g,m),!(b.isFunction(j)&&j.apply(this.element[0],[g].concat(m))===!1||g.isDefaultPrevented())}},b.each({show:"fadeIn",hide:"fadeOut"},function(h,g){b.Widget.prototype["_"+h]=function(l,i,k){"string"==typeof i&&(i={effect:i});var j,e=i?i===!0||"number"==typeof i?g:i.effect||g:h;i=i||{},"number"==typeof i&&(i={duration:i}),j=!b.isEmptyObject(i),i.complete=k,i.delay&&l.delay(i.delay),j&&b.effects&&b.effects.effect[e]?l[h](i):e!==h&&l[e]?l[e](i.duration,i.easing,k):l.queue(function(m){b(this)[h](),k&&k.call(l[0]),m()})}})}($),
/*!
 * jQuery UI Accordion 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/accordion/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
function(b){var c=0,a={},d={};a.height=a.paddingTop=a.paddingBottom=a.borderTopWidth=a.borderBottomWidth="hide",d.height=d.paddingTop=d.paddingBottom=d.borderTopWidth=d.borderBottomWidth="show",b.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var f=this.options;this.prevShow=this.prevHide=b(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),f.collapsible||f.active!==!1&&null!=f.active||(f.active=0),this._processPanels(),f.active<0&&(f.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():b(),content:this.active.length?this.active.next():b()}},_createIcons:function(){var f=this.options.icons;f&&(b("<span>").addClass("ui-accordion-header-icon ui-icon "+f.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(f.header).addClass(f.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(f,g){return"active"===f?(this._activate(g),void 0):("event"===f&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(g)),this._super(f,g),"collapsible"!==f||g||this.options.active!==!1||this._activate(0),"icons"===f&&(this._destroyIcons(),g&&this._createIcons()),"disabled"===f&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!g),void 0)},_keydown:function(h){if(!h.altKey&&!h.ctrlKey){var f=b.ui.keyCode,k=this.headers.length,g=this.headers.index(h.target),j=!1;switch(h.keyCode){case f.RIGHT:case f.DOWN:j=this.headers[(g+1)%k];break;case f.LEFT:case f.UP:j=this.headers[(g-1+k)%k];break;case f.SPACE:case f.ENTER:this._eventHandler(h);break;case f.HOME:j=this.headers[0];break;case f.END:j=this.headers[k-1]}j&&(b(h.target).attr("tabIndex",-1),b(j).attr("tabIndex",0),j.focus(),h.preventDefault())}},_panelKeyDown:function(f){f.keyCode===b.ui.keyCode.UP&&f.ctrlKey&&b(f.currentTarget).prev().focus()},refresh:function(){var f=this.options;this._processPanels(),f.active===!1&&f.collapsible===!0||!this.headers.length?(f.active=!1,this.active=b()):f.active===!1?this._activate(0):this.active.length&&!b.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(f.active=!1,this.active=b()):this._activate(Math.max(0,f.active-1)):f.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var e,j=this.options,f=j.heightStyle,h=this.element.parent(),g=this.accordionId="ui-accordion-"+(this.element.attr("id")||++c);this.active=this._findActive(j.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(m){var k=b(this),q=k.attr("id"),l=k.next(),p=l.attr("id");q||(q=g+"-header-"+m,k.attr("id",q)),p||(p=g+"-panel-"+m,l.attr("id",p)),k.attr("aria-controls",p),l.attr("aria-labelledby",q)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(j.event),"fill"===f?(e=h.height(),this.element.siblings(":visible").each(function(){var i=b(this),k=i.css("position");"absolute"!==k&&"fixed"!==k&&(e-=i.outerHeight(!0))}),this.headers.each(function(){e-=b(this).outerHeight(!0)}),this.headers.next().each(function(){b(this).height(Math.max(0,e-b(this).innerHeight()+b(this).height()))}).css("overflow","auto")):"auto"===f&&(e=0,this.headers.next().each(function(){e=Math.max(e,b(this).css("height","").height())}).height(e))},_activate:function(g){var f=this._findActive(g)[0];f!==this.active[0]&&(f=f||this.active[0],this._eventHandler({target:f,currentTarget:f,preventDefault:b.noop}))},_findActive:function(f){return"number"==typeof f?this.headers.eq(f):b()},_setupEvents:function(g){var f={keydown:"_keydown"};g&&b.each(g.split(" "),function(h,i){f[i]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,f),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(q){var m=this.options,j=this.active,u=b(q.currentTarget),g=u[0]===j[0],f=g&&m.collapsible,t=f?b():u.next(),k=j.next(),p={oldHeader:j,oldPanel:k,newHeader:f?b():u,newPanel:t};q.preventDefault(),g&&!m.collapsible||this._trigger("beforeActivate",q,p)===!1||(m.active=f?!1:this.headers.index(u),this.active=g?b():u,this._toggle(p),j.removeClass("ui-accordion-header-active ui-state-active"),m.icons&&j.children(".ui-accordion-header-icon").removeClass(m.icons.activeHeader).addClass(m.icons.header),g||(u.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),m.icons&&u.children(".ui-accordion-header-icon").removeClass(m.icons.header).addClass(m.icons.activeHeader),u.next().addClass("ui-accordion-content-active")))},_toggle:function(g){var f=g.newPanel,h=this.prevShow.length?this.prevShow:g.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=f,this.prevHide=h,this.options.animate?this._animate(f,h,g):(h.hide(),f.show(),this._toggleComplete(g)),h.attr({"aria-expanded":"false","aria-hidden":"true"}),h.prev().attr("aria-selected","false"),f.length&&h.length?h.prev().attr("tabIndex",-1):f.length&&this.headers.filter(function(){return 0===b(this).attr("tabIndex")}).attr("tabIndex",-1),f.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(x,m,y){var i,f,v,j=this,k=0,q=x.length&&(!m.length||x.index()<m.index()),w=this.options.animate||{},n=q&&w.down||w,g=function(){j._toggleComplete(y)};return"number"==typeof n&&(v=n),"string"==typeof n&&(f=n),f=f||n.easing||w.easing,v=v||n.duration||w.duration,m.length?x.length?(i=x.show().outerHeight(),m.animate(a,{duration:v,easing:f,step:function(h,l){l.now=Math.round(h)}}),x.hide().animate(d,{duration:v,easing:f,complete:g,step:function(h,e){e.now=Math.round(h),"height"!==e.prop?k+=e.now:"content"!==j.options.heightStyle&&(e.now=Math.round(i-m.outerHeight()-k),k=0)}}),void 0):m.animate(a,v,f,g):x.animate(d,v,f,g)},_toggleComplete:function(f){var g=f.oldPanel;g.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),g.length&&(g.parent()[0].className=g.parent()[0].className),this._trigger("activate",null,f)}})}($),
/*!
 * jQuery UI Position 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */
function(C,x){function q(c,d,a){return[parseFloat(c[0])*(g.test(c[0])?d/100:1),parseFloat(c[1])*(g.test(c[1])?a/100:1)]}function k(c,a){return parseInt(C.css(c,a),10)||0}function D(c){var a=c[0];return 9===a.nodeType?{width:c.width(),height:c.height(),offset:{top:0,left:0}}:C.isWindow(a)?{width:c.width(),height:c.height(),offset:{top:c.scrollTop(),left:c.scrollLeft()}}:a.preventDefault?{width:0,height:0,offset:{top:a.pageY,left:a.pageX}}:{width:c.outerWidth(),height:c.outerHeight(),offset:c.offset()}}C.ui=C.ui||{};var j,b=Math.max,A=Math.abs,m=Math.round,v=/left|center|right/,z=/top|center|bottom/,B=/[\+\-]\d+(\.[\d]+)?%?/,y=/^\w+/,g=/%$/,w=C.fn.position;C.position={scrollbarWidth:function(){if(j!==x){return j}var a,e,c=C("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),d=c.children()[0];return C("body").append(c),a=d.offsetWidth,c.css("overflow","scroll"),e=d.offsetWidth,a===e&&(e=c[0].clientWidth),c.remove(),j=a-e},getScrollInfo:function(d){var a=d.isWindow?"":d.element.css("overflow-x"),h=d.isWindow?"":d.element.css("overflow-y"),c="scroll"===a||"auto"===a&&d.width<d.element[0].scrollWidth,f="scroll"===h||"auto"===h&&d.height<d.element[0].scrollHeight;return{width:f?C.position.scrollbarWidth():0,height:c?C.position.scrollbarWidth():0}},getWithinInfo:function(c){var a=C(c||window),d=C.isWindow(a[0]);return{element:a,isWindow:d,offset:a.offset()||{left:0,top:0},scrollLeft:a.scrollLeft(),scrollTop:a.scrollTop(),width:d?a.width():a.outerWidth(),height:d?a.height():a.outerHeight()}}},C.fn.position=function(i){if(!i||!i.of){return w.apply(this,arguments)}i=C.extend({},i);var c,a,d,h,u,l,n=C(i.of),t=C.position.getWithinInfo(i.within),s=C.position.getScrollInfo(t),r=(i.collision||"flip").split(" "),f={};return l=D(n),n[0].preventDefault&&(i.at="left top"),a=l.width,d=l.height,h=l.offset,u=C.extend({},h),C.each(["my","at"],function(){var o,e,p=(i[this]||"").split(" ");1===p.length&&(p=v.test(p[0])?p.concat(["center"]):z.test(p[0])?["center"].concat(p):["center","center"]),p[0]=v.test(p[0])?p[0]:"center",p[1]=z.test(p[1])?p[1]:"center",o=B.exec(p[0]),e=B.exec(p[1]),f[this]=[o?o[0]:0,e?e[0]:0],i[this]=[y.exec(p[0])[0],y.exec(p[1])[0]]}),1===r.length&&(r[1]=r[0]),"right"===i.at[0]?u.left+=a:"center"===i.at[0]&&(u.left+=a/2),"bottom"===i.at[1]?u.top+=d:"center"===i.at[1]&&(u.top+=d/2),c=q(f.at,a,d),u.left+=c[0],u.top+=c[1],this.each(function(){var L,E,I=C(this),K=I.outerWidth(),H=I.outerHeight(),F=k(this,"marginLeft"),J=k(this,"marginTop"),o=K+F+k(this,"marginRight")+s.width,p=H+J+k(this,"marginBottom")+s.height,e=C.extend({},u),G=q(f.my,I.outerWidth(),I.outerHeight());"right"===i.my[0]?e.left-=K:"center"===i.my[0]&&(e.left-=K/2),"bottom"===i.my[1]?e.top-=H:"center"===i.my[1]&&(e.top-=H/2),e.left+=G[0],e.top+=G[1],C.support.offsetFractions||(e.left=m(e.left),e.top=m(e.top)),L={marginLeft:F,marginTop:J},C.each(["left","top"],function(M,N){C.ui.position[r[M]]&&C.ui.position[r[M]][N](e,{targetWidth:a,targetHeight:d,elemWidth:K,elemHeight:H,collisionPosition:L,collisionWidth:o,collisionHeight:p,offset:[c[0]+G[0],c[1]+G[1]],my:i.my,at:i.at,within:t,elem:I})}),i.using&&(E=function(O){var N=h.left-e.left,R=N+a-K,P=h.top-e.top,Q=P+d-H,M={target:{element:n,left:h.left,top:h.top,width:a,height:d},element:{element:I,left:e.left,top:e.top,width:K,height:H},horizontal:0>R?"left":N>0?"right":"center",vertical:0>Q?"top":P>0?"bottom":"middle"};K>a&&A(N+R)<a&&(M.horizontal="center"),H>d&&A(P+Q)<d&&(M.vertical="middle"),M.important=b(A(N),A(R))>b(A(P),A(Q))?"horizontal":"vertical",i.using.call(this,O,M)}),I.offset(C.extend(e,{using:E}))})},C.ui.position={fit:{left:function(F,u){var p,d=u.within,G=d.isWindow?d.scrollLeft:d.offset.left,c=d.width,E=F.left-u.collisionPosition.marginLeft,f=G-E,r=E+u.collisionWidth-c-G;u.collisionWidth>c?f>0&&0>=r?(p=F.left+f+u.collisionWidth-c-G,F.left+=f-p):F.left=r>0&&0>=f?G:f>r?G+c-u.collisionWidth:G:f>0?F.left+=f:r>0?F.left-=r:F.left=b(F.left-E,F.left)},top:function(F,u){var p,d=u.within,G=d.isWindow?d.scrollTop:d.offset.top,c=u.within.height,E=F.top-u.collisionPosition.marginTop,f=G-E,r=E+u.collisionHeight-c-G;u.collisionHeight>c?f>0&&0>=r?(p=F.top+f+u.collisionHeight-c-G,F.top+=f-p):F.top=r>0&&0>=f?G:f>r?G+c-u.collisionHeight:G:f>0?F.top+=f:r>0?F.top-=r:F.top=b(F.top-E,F.top)}},flip:{left:function(P,L){var I,G,Q=L.within,F=Q.offset.left+Q.scrollLeft,a=Q.width,H=Q.isWindow?Q.scrollLeft:Q.offset.left,J=P.left-L.collisionPosition.marginLeft,N=J-H,O=J+L.collisionWidth-a-H,M="left"===L.my[0]?-L.elemWidth:"right"===L.my[0]?L.elemWidth:0,E="left"===L.at[0]?L.targetWidth:"right"===L.at[0]?-L.targetWidth:0,K=-2*L.offset[0];0>N?(I=P.left+M+E+K+L.collisionWidth-a-F,(0>I||I<A(N))&&(P.left+=M+E+K)):O>0&&(G=P.left-L.collisionPosition.marginLeft+M+E+K-H,(G>0||A(G)<O)&&(P.left+=M+E+K))},top:function(Q,M){var J,G,R=M.within,F=R.offset.top+R.scrollTop,a=R.height,I=R.isWindow?R.scrollTop:R.offset.top,K=Q.top-M.collisionPosition.marginTop,O=K-I,P=K+M.collisionHeight-a-I,N="top"===M.my[1],E=N?-M.elemHeight:"bottom"===M.my[1]?M.elemHeight:0,L="top"===M.at[1]?M.targetHeight:"bottom"===M.at[1]?-M.targetHeight:0,H=-2*M.offset[1];0>O?(G=Q.top+E+L+H+M.collisionHeight-a-F,Q.top+E+L+H>O&&(0>G||G<A(O))&&(Q.top+=E+L+H)):P>0&&(J=Q.top-M.collisionPosition.marginTop+E+L+H-I,Q.top+E+L+H>P&&(J>0||A(J)<P)&&(Q.top+=E+L+H))}},flipfit:{left:function(){C.ui.position.flip.left.apply(this,arguments),C.ui.position.fit.left.apply(this,arguments)},top:function(){C.ui.position.flip.top.apply(this,arguments),C.ui.position.fit.top.apply(this,arguments)}}},function(){var l,d,t,f,p,h=document.getElementsByTagName("body")[0],c=document.createElement("div");l=document.createElement(h?"div":"body"),t={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},h&&C.extend(t,{position:"absolute",left:"-1000px",top:"-1000px"});for(p in t){l.style[p]=t[p]}l.appendChild(c),d=h||document.documentElement,d.insertBefore(l,d.firstChild),c.style.cssText="position: absolute; left: 10.7432222px;",f=C(c).offset().left,C.support.offsetFractions=f>10&&11>f,l.innerHTML="",d.removeChild(l)}()}($),
/*!
 * jQuery UI Menu 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/menu/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */
function(a){a.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,a.proxy(function(b){this.options.disabled&&b.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(b){b.preventDefault()},"click .ui-state-disabled > a":function(b){b.preventDefault()},"click .ui-menu-item:has(a)":function(c){var b=a(c.target).closest(".ui-menu-item");!this.mouseHandled&&b.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(c),b.has(".ui-menu").length?this.expand(c):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(c){var b=a(c.currentTarget);b.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(c,b)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(c,d){var b=this.active||this.element.children(".ui-menu-item").eq(0);d||this.focus(c,b)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(h){function d(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var k,f,j,g,c,b=!0;switch(h.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(h);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(h);break;case a.ui.keyCode.HOME:this._move("first","first",h);break;case a.ui.keyCode.END:this._move("last","last",h);break;case a.ui.keyCode.UP:this.previous(h);break;case a.ui.keyCode.DOWN:this.next(h);break;case a.ui.keyCode.LEFT:this.collapse(h);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(h);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(h);break;case a.ui.keyCode.ESCAPE:this.collapse(h);break;default:b=!1,f=this.previousFilter||"",j=String.fromCharCode(h.keyCode),g=!1,clearTimeout(this.filterTimer),j===f?g=!0:j=f+j,c=new RegExp("^"+d(j),"i"),k=this.activeMenu.children(".ui-menu-item").filter(function(){return c.test(a(this).children("a").text())}),k=g&&-1!==k.index(this.active.next())?this.active.nextAll(".ui-menu-item"):k,k.length||(j=String.fromCharCode(h.keyCode),c=new RegExp("^"+d(j),"i"),k=this.activeMenu.children(".ui-menu-item").filter(function(){return c.test(a(this).children("a").text())})),k.length?(this.focus(h,k),k.length>1?(this.previousFilter=j,this.filterTimer=this._delay(function(){delete this.previousFilter},1000)):delete this.previousFilter):delete this.previousFilter}b&&h.preventDefault()},_activate:function(b){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(b):this.select(b))},refresh:function(){var c,b=this.options.icons.submenu,d=this.element.find(this.options.menus);d.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var g=a(this),h=g.prev("a"),f=a("<span>").addClass("ui-menu-icon ui-icon "+b).data("ui-menu-submenu-carat",!0);h.attr("aria-haspopup","true").prepend(f),g.attr("aria-labelledby",h.attr("id"))}),c=d.add(this.element),c.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),c.children(":not(.ui-menu-item)").each(function(){var f=a(this);/[^\-\u2014\u2013\s]/.test(f.text())||f.addClass("ui-widget-content ui-menu-divider")}),c.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(b,c){"icons"===b&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(c.submenu),this._super(b,c)},focus:function(c,d){var b,f;this.blur(c,c&&"focus"===c.type),this._scrollIntoView(d),this.active=d.first(),f=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",f.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),c&&"keydown"===c.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),b=d.children(".ui-menu"),b.length&&/^mouse/.test(c.type)&&this._startOpening(b),this.activeMenu=d.parent(),this._trigger("focus",c,{item:d})},_scrollIntoView:function(g){var c,j,d,h,f,b;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,j=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,d=g.offset().top-this.activeMenu.offset().top-c-j,h=this.activeMenu.scrollTop(),f=this.activeMenu.height(),b=g.height(),0>d?this.activeMenu.scrollTop(h+d):d+b>f&&this.activeMenu.scrollTop(h+d-f+b))},blur:function(b,c){c||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",b,{item:this.active}))},_startOpening:function(b){clearTimeout(this.timer),"true"===b.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(b)},this.delay))},_open:function(c){var b=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(c.parents(".ui-menu")).hide().attr("aria-hidden","true"),c.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(b)},collapseAll:function(c,b){clearTimeout(this.timer),this.timer=this._delay(function(){var d=b?this.element:a(c&&c.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(c),this.activeMenu=d},this.delay)},_close:function(b){b||(b=this.active?this.active.parent():this.element),b.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(b){var c=this.active&&this.active.parent().closest(".ui-menu-item",this.element);c&&c.length&&(this._close(),this.focus(b,c))},expand:function(b){var c=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();c&&c.length&&(this._open(c.parent()),this._delay(function(){this.focus(b,c)}))},next:function(b){this._move("next","first",b)},previous:function(b){this._move("prev","last",b)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(c,d,b){var f;this.active&&(f="first"===c||"last"===c?this.active["first"===c?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[c+"All"](".ui-menu-item").eq(0)),f&&f.length&&this.active||(f=this.activeMenu.children(".ui-menu-item")[d]()),this.focus(b,f)},nextPage:function(d){var b,f,c;return this.active?(this.isLastItem()||(this._hasScroll()?(f=this.active.offset().top,c=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return b=a(this),b.offset().top-f-c<0}),this.focus(d,b)):this.focus(d,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())),void 0):(this.next(d),void 0)},previousPage:function(d){var b,f,c;return this.active?(this.isFirstItem()||(this._hasScroll()?(f=this.active.offset().top,c=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return b=a(this),b.offset().top-f+c>0}),this.focus(d,b)):this.focus(d,this.activeMenu.children(".ui-menu-item").first())),void 0):(this.next(d),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(c){this.active=this.active||a(c.target).closest(".ui-menu-item");var b={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(c,!0),this._trigger("select",c,b)}})}($),
/*!
 * jQuery UI Autocomplete 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/autocomplete/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 *	jquery.ui.menu.js
 */
function(a){var b=0;a.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var g,c,j,d=this.element[0].nodeName.toLowerCase(),h="textarea"===d,f="input"===d;this.isMultiLine=h?!0:f?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[h||f?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly")){return g=!0,j=!0,c=!0,void 0}g=!1,j=!1,c=!1;var i=a.ui.keyCode;switch(e.keyCode){case i.PAGE_UP:g=!0,this._move("previousPage",e);break;case i.PAGE_DOWN:g=!0,this._move("nextPage",e);break;case i.UP:g=!0,this._keyEvent("previous",e);break;case i.DOWN:g=!0,this._keyEvent("next",e);break;case i.ENTER:case i.NUMPAD_ENTER:this.menu.active&&(g=!0,e.preventDefault(),this.menu.select(e));break;case i.TAB:this.menu.active&&this.menu.select(e);break;case i.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}},keypress:function(i){if(g){return g=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&i.preventDefault(),void 0}if(!c){var e=a.ui.keyCode;switch(i.keyCode){case e.PAGE_UP:this._move("previousPage",i);break;case e.PAGE_DOWN:this._move("nextPage",i);break;case e.UP:this._keyEvent("previous",i);break;case e.DOWN:this._keyEvent("next",i)}}},input:function(e){return j?(j=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=a("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(l){l.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var k=this.menu.element[0];a(l.target).closest(".ui-menu-item").length||this._delay(function(){var i=this;this.document.one("mousedown",function(e){e.target===i.element[0]||e.target===k||a.contains(k,e.target)||i.close()})})},menufocus:function(l,k){if(this.isNewMenu&&(this.isNewMenu=!1,l.originalEvent&&/^mouse/.test(l.originalEvent.type))){return this.menu.blur(),this.document.one("mousemove",function(){a(l.target).trigger(l.originalEvent)}),void 0}var m=k.item.data("ui-autocomplete-item");!1!==this._trigger("focus",l,{item:m})?l.originalEvent&&/^key/.test(l.originalEvent.type)&&this._value(m.value):this.liveRegion.text(m.value)},menuselect:function(l,m){var k=m.item.data("ui-autocomplete-item"),o=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=o,this._delay(function(){this.previous=o,this.selectedItem=k})),!1!==this._trigger("select",l,{item:k})&&this._value(k.value),this.term=this._value(),this.close(l),this.selectedItem=k}}),this.liveRegion=a("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(c,d){this._super(c,d),"source"===c&&this._initSource(),"appendTo"===c&&this.menu.element.appendTo(this._appendTo()),"disabled"===c&&d&&this.xhr&&this.xhr.abort()},_appendTo:function(){var c=this.options.appendTo;return c&&(c=c.jquery||c.nodeType?a(c):this.document.find(c).eq(0)),c||(c=this.element.closest(".ui-front")),c.length||(c=this.document[0].body),c},_initSource:function(){var d,c,f=this;a.isArray(this.options.source)?(d=this.options.source,this.source=function(e,g){g(a.ui.autocomplete.filter(d,e.term))}):"string"==typeof this.options.source?(c=this.options.source,this.source=function(h,g){f.xhr&&f.xhr.abort(),f.xhr=a.ajax({url:c,data:h,dataType:"json",success:function(e){g(e)},error:function(){g([])}})}):this.source=this.options.source},_searchTimeout:function(c){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,c))},this.options.delay)},search:function(c,d){return c=null!=c?c:this._value(),this.term=this._value(),c.length<this.options.minLength?this.close(d):this._trigger("search",d)!==!1?this._search(c):void 0},_search:function(c){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:c},this._response())},_response:function(){var d=this,c=++b;return function(e){c===b&&d.__response(e),d.pending--,d.pending||d.element.removeClass("ui-autocomplete-loading")}},__response:function(c){c&&(c=this._normalize(c)),this._trigger("response",null,{content:c}),!this.options.disabled&&c&&c.length&&!this.cancelSearch?(this._suggest(c),this._trigger("open")):this._close()},close:function(c){this.cancelSearch=!0,this._close(c)},_close:function(c){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",c))},_change:function(c){this.previous!==this._value()&&this._trigger("change",c,{item:this.selectedItem})},_normalize:function(c){return c.length&&c[0].label&&c[0].value?c:a.map(c,function(d){return"string"==typeof d?{label:d,value:d}:a.extend({label:d.label||d.value,value:d.value||d.label},d)})},_suggest:function(d){var c=this.menu.element.empty();this._renderMenu(c,d),this.isNewMenu=!0,this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var c=this.menu.element;c.outerWidth(Math.max(c.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(d,c){var f=this;a.each(c,function(g,e){f._renderItemData(d,e)})},_renderItemData:function(c,d){return this._renderItem(c,d).data("ui-autocomplete-item",d)},_renderItem:function(d,c){return a("<li>").append(a("<a>").text(c.label)).appendTo(d)},_move:function(c,d){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(c)||this.menu.isLastItem()&&/^next/.test(c)?(this._value(this.term),this.menu.blur(),void 0):(this.menu[c](d),void 0):(this.search(null,d),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(c,d){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(c,d),d.preventDefault())}}),a.extend(a.ui.autocomplete,{escapeRegex:function(c){return c.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(d,c){var f=new RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(d,function(e){return f.test(e.label||e.value||e)})}}),a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(c){return c+(c>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(c){var d;this._superApply(arguments),this.options.disabled||this.cancelSearch||(d=c&&c.length?this.options.messages.results(c.length):this.options.messages.noResults,this.liveRegion.text(d))}})}($),
/*!
 * jQuery UI Button 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/button/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
function(p){var k,g,d,q,c="ui-button ui-widget ui-state-default ui-corner-all",b="ui-state-hover ui-state-active ",m="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var a=p(this);setTimeout(function(){a.find(":ui-button").button("refresh")},1)},j=function(l){var a=l.name,o=l.form,h=p([]);return a&&(a=a.replace(/'/g,"\\'"),h=o?p(o).find("[name='"+a+"']"):p("[name='"+a+"']",l.ownerDocument).filter(function(){return !this.form})),h};p.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var i=this,e=this.options,n="checkbox"===this.type||"radio"===this.type,h=n?"":"ui-state-active",l="ui-state-focus";null===e.label&&(e.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(c).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){e.disabled||this===k&&p(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){e.disabled||p(this).removeClass(h)}).bind("click"+this.eventNamespace,function(a){e.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){i.buttonElement.addClass(l)}).bind("blur"+this.eventNamespace,function(){i.buttonElement.removeClass(l)}),n&&(this.element.bind("change"+this.eventNamespace,function(){q||i.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(a){e.disabled||(q=!1,g=a.pageX,d=a.pageY)}).bind("mouseup"+this.eventNamespace,function(a){e.disabled||(g!==a.pageX||d!==a.pageY)&&(q=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return e.disabled||q?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(e.disabled||q){return !1}p(this).addClass("ui-state-active"),i.buttonElement.attr("aria-pressed","true");var a=i.element[0];j(a).not(a).map(function(){return p(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return e.disabled?!1:(p(this).addClass("ui-state-active"),k=this,i.document.one("mouseup",function(){k=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return e.disabled?!1:(p(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(a){return e.disabled?!1:((a.keyCode===p.ui.keyCode.SPACE||a.keyCode===p.ui.keyCode.ENTER)&&p(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){p(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(a){a.keyCode===p.ui.keyCode.SPACE&&p(this).click()})),this._setOption("disabled",e.disabled),this._resetButton()},_determineButtonType:function(){var h,l,a;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(h=this.element.parents().last(),l="label[for='"+this.element.attr("id")+"']",this.buttonElement=h.find(l),this.buttonElement.length||(h=h.length?h.siblings():this.element.siblings(),this.buttonElement=h.filter(l),this.buttonElement.length||(this.buttonElement=h.find(l))),this.element.addClass("ui-helper-hidden-accessible"),a=this.element.is(":checked"),a&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",a)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(c+" "+b+" "+m).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,h){return this._super(a,h),"disabled"===a?(h?this.element.prop("disabled",!0):this.element.prop("disabled",!1),void 0):(this._resetButton(),void 0)},refresh:function(){var a=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");a!==this.options.disabled&&this._setOption("disabled",a),"radio"===this.type?j(this.element[0]).each(function(){p(this).is(":checked")?p(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):p(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type){return this.options.label&&this.element.val(this.options.label),void 0}var l=this.buttonElement.removeClass(m),a=p("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(l.empty()).text(),t=this.options.icons,h=t.primary&&t.secondary,r=[];t.primary||t.secondary?(this.options.text&&r.push("ui-button-text-icon"+(h?"s":t.primary?"-primary":"-secondary")),t.primary&&l.prepend("<span class='ui-button-icon-primary ui-icon "+t.primary+"'></span>"),t.secondary&&l.append("<span class='ui-button-icon-secondary ui-icon "+t.secondary+"'></span>"),this.options.text||(r.push(h?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||l.attr("title",p.trim(a)))):r.push("ui-button-text-only"),l.addClass(r.join(" "))}}),p.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,h){"disabled"===a&&this.buttons.button("option",a,h),this._super(a,h)},refresh:function(){var a="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return p(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(a?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(a?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return p(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}($),
/*!
 * jQuery UI Datepicker 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/datepicker/
 *
 * Depends:
 *	jquery.ui.core.js
 */
function(b,f){function a(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},b.extend(this._defaults,this.regional[""]),this.dpDiv=h(b("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function h(k){var j="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return k.delegate(j,"mouseout",function(){b(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&b(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&b(this).removeClass("ui-datepicker-next-hover")}).delegate(j,"mouseover",function(){b.datepicker._isDisabledDatepicker(g.inline?k.parent()[0]:g.input[0])||(b(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),b(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&b(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&b(this).addClass("ui-datepicker-next-hover"))})}function c(k,j){b.extend(k,j);for(var l in j){null==j[l]&&(k[l]=j[l])}return k}b.extend(b.ui,{datepicker:{version:"1.10.3"}});var g,d="datepicker";b.extend(a.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return c(this._defaults,e||{}),this},_attachDatepicker:function(l,j){var p,k,m;p=l.nodeName.toLowerCase(),k="div"===p||"span"===p,l.id||(this.uuid+=1,l.id="dp"+this.uuid),m=this._newInst(b(l),k),m.settings=b.extend({},j||{}),"input"===p?this._connectDatepicker(l,m):k&&this._inlineDatepicker(l,m)},_newInst:function(l,j){var k=l[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:k,input:l,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:j,dpDiv:j?h(b("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(k,j){var l=b(k);j.append=b([]),j.trigger=b([]),l.hasClass(this.markerClassName)||(this._attachments(l,j),l.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(j),b.data(k,d,j),j.settings.disabled&&this._disableDatepicker(k))},_attachments:function(p,k){var t,l,q,m=this._get(k,"appendText"),j=this._get(k,"isRTL");k.append&&k.append.remove(),m&&(k.append=b("<span class='"+this._appendClass+"'>"+m+"</span>"),p[j?"before":"after"](k.append)),p.unbind("focus",this._showDatepicker),k.trigger&&k.trigger.remove(),t=this._get(k,"showOn"),("focus"===t||"both"===t)&&p.focus(this._showDatepicker),("button"===t||"both"===t)&&(l=this._get(k,"buttonText"),q=this._get(k,"buttonImage"),k.trigger=b(this._get(k,"buttonImageOnly")?b("<img/>").addClass(this._triggerClass).attr({src:q,alt:l,title:l}):b("<button type='button'></button>").addClass(this._triggerClass).html(q?b("<img/>").attr({src:q,alt:l,title:l}):l)),p[j?"before":"after"](k.trigger),k.trigger.click(function(){return b.datepicker._datepickerShowing&&b.datepicker._lastInput===p[0]?b.datepicker._hideDatepicker():b.datepicker._datepickerShowing&&b.datepicker._lastInput!==p[0]?(b.datepicker._hideDatepicker(),b.datepicker._showDatepicker(p[0])):b.datepicker._showDatepicker(p[0]),!1}))},_autoSize:function(k){if(this._get(k,"autoSize")&&!k.inline){var p,j,u,l,q=new Date(2009,11,20),m=this._get(k,"dateFormat");m.match(/[DM]/)&&(p=function(e){for(j=0,u=0,l=0;l<e.length;l++){e[l].length>j&&(j=e[l].length,u=l)}return u},q.setMonth(p(this._get(k,m.match(/MM/)?"monthNames":"monthNamesShort"))),q.setDate(p(this._get(k,m.match(/DD/)?"dayNames":"dayNamesShort"))+20-q.getDay())),k.input.attr("size",this._formatDate(k,q).length)}},_inlineDatepicker:function(k,j){var l=b(k);l.hasClass(this.markerClassName)||(l.addClass(this.markerClassName).append(j.dpDiv),b.data(k,d,j),this._setDate(j,this._getDefaultDate(j),!0),this._updateDatepicker(j),this._updateAlternate(j),j.settings.disabled&&this._disableDatepicker(k),j.dpDiv.css("display","block"))},_dialogDatepicker:function(t,r,m,k,x){var q,s,w,y,v,j=this._dialogInst;return j||(this.uuid+=1,q="dp"+this.uuid,this._dialogInput=b("<input type='text' id='"+q+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),b("body").append(this._dialogInput),j=this._dialogInst=this._newInst(this._dialogInput,!1),j.settings={},b.data(this._dialogInput[0],d,j)),c(j.settings,k||{}),r=r&&r.constructor===Date?this._formatDate(j,r):r,this._dialogInput.val(r),this._pos=x?x.length?x:[x.pageX,x.pageY]:null,this._pos||(s=document.documentElement.clientWidth,w=document.documentElement.clientHeight,y=document.documentElement.scrollLeft||document.body.scrollLeft,v=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[s/2-100+y,w/2-150+v]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),j.settings.onSelect=m,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),b.blockUI&&b.blockUI(this.dpDiv),b.data(this._dialogInput[0],d,j),this},_destroyDatepicker:function(l){var j,m=b(l),k=b.data(l,d);m.hasClass(this.markerClassName)&&(j=l.nodeName.toLowerCase(),b.removeData(l,d),"input"===j?(k.append.remove(),k.trigger.remove(),m.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===j||"span"===j)&&m.removeClass(this.markerClassName).empty())},_enableDatepicker:function(l){var j,p,k=b(l),m=b.data(l,d);k.hasClass(this.markerClassName)&&(j=l.nodeName.toLowerCase(),"input"===j?(l.disabled=!1,m.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===j||"span"===j)&&(p=k.children("."+this._inlineClass),p.children().removeClass("ui-state-disabled"),p.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=b.map(this._disabledInputs,function(e){return e===l?null:e}))},_disableDatepicker:function(l){var j,p,k=b(l),m=b.data(l,d);k.hasClass(this.markerClassName)&&(j=l.nodeName.toLowerCase(),"input"===j?(l.disabled=!0,m.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===j||"span"===j)&&(p=k.children("."+this._inlineClass),p.children().addClass("ui-state-disabled"),p.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=b.map(this._disabledInputs,function(e){return e===l?null:e}),this._disabledInputs[this._disabledInputs.length]=l)},_isDisabledDatepicker:function(i){if(!i){return !1}for(var j=0;j<this._disabledInputs.length;j++){if(this._disabledInputs[j]===i){return !0}}return !1},_getInst:function(k){try{return b.data(k,d)}catch(j){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(k,t,q){var p,j,e,m,s=this._getInst(k);return 2===arguments.length&&"string"==typeof t?"defaults"===t?b.extend({},b.datepicker._defaults):s?"all"===t?b.extend({},s.settings):this._get(s,t):null:(p=t||{},"string"==typeof t&&(p={},p[t]=q),s&&(this._curInst===s&&this._hideDatepicker(),j=this._getDateDatepicker(k,!0),e=this._getMinMaxDate(s,"min"),m=this._getMinMaxDate(s,"max"),c(s.settings,p),null!==e&&p.dateFormat!==f&&p.minDate===f&&(s.settings.minDate=this._formatDate(s,e)),null!==m&&p.dateFormat!==f&&p.maxDate===f&&(s.settings.maxDate=this._formatDate(s,m)),"disabled" in p&&(p.disabled?this._disableDatepicker(k):this._enableDatepicker(k)),this._attachments(b(k),s),this._autoSize(s),this._setDate(s,j),this._updateAlternate(s),this._updateDatepicker(s)),void 0)},_changeDatepicker:function(k,l,j){this._optionDatepicker(k,l,j)},_refreshDatepicker:function(i){var j=this._getInst(i);j&&this._updateDatepicker(j)},_setDateDatepicker:function(k,l){var j=this._getInst(k);j&&(this._setDate(j,l),this._updateDatepicker(j),this._updateAlternate(j))},_getDateDatepicker:function(k,l){var j=this._getInst(k);return j&&!j.inline&&this._setDateFromField(j,l),j?this._getDate(j):null},_doKeyDown:function(p){var k,t,l,q=b.datepicker._getInst(p.target),m=!0,j=q.dpDiv.is(".ui-datepicker-rtl");if(q._keyEvent=!0,b.datepicker._datepickerShowing){switch(p.keyCode){case 9:b.datepicker._hideDatepicker(),m=!1;break;case 13:return l=b("td."+b.datepicker._dayOverClass+":not(."+b.datepicker._currentClass+")",q.dpDiv),l[0]&&b.datepicker._selectDay(p.target,q.selectedMonth,q.selectedYear,l[0]),k=b.datepicker._get(q,"onSelect"),k?(t=b.datepicker._formatDate(q),k.apply(q.input?q.input[0]:null,[t,q])):b.datepicker._hideDatepicker(),!1;case 27:b.datepicker._hideDatepicker();break;case 33:b.datepicker._adjustDate(p.target,p.ctrlKey?-b.datepicker._get(q,"stepBigMonths"):-b.datepicker._get(q,"stepMonths"),"M");break;case 34:b.datepicker._adjustDate(p.target,p.ctrlKey?+b.datepicker._get(q,"stepBigMonths"):+b.datepicker._get(q,"stepMonths"),"M");break;case 35:(p.ctrlKey||p.metaKey)&&b.datepicker._clearDate(p.target),m=p.ctrlKey||p.metaKey;break;case 36:(p.ctrlKey||p.metaKey)&&b.datepicker._gotoToday(p.target),m=p.ctrlKey||p.metaKey;break;case 37:(p.ctrlKey||p.metaKey)&&b.datepicker._adjustDate(p.target,j?1:-1,"D"),m=p.ctrlKey||p.metaKey,p.originalEvent.altKey&&b.datepicker._adjustDate(p.target,p.ctrlKey?-b.datepicker._get(q,"stepBigMonths"):-b.datepicker._get(q,"stepMonths"),"M");break;case 38:(p.ctrlKey||p.metaKey)&&b.datepicker._adjustDate(p.target,-7,"D"),m=p.ctrlKey||p.metaKey;break;case 39:(p.ctrlKey||p.metaKey)&&b.datepicker._adjustDate(p.target,j?-1:1,"D"),m=p.ctrlKey||p.metaKey,p.originalEvent.altKey&&b.datepicker._adjustDate(p.target,p.ctrlKey?+b.datepicker._get(q,"stepBigMonths"):+b.datepicker._get(q,"stepMonths"),"M");break;case 40:(p.ctrlKey||p.metaKey)&&b.datepicker._adjustDate(p.target,7,"D"),m=p.ctrlKey||p.metaKey;break;default:m=!1}}else{36===p.keyCode&&p.ctrlKey?b.datepicker._showDatepicker(this):m=!1}m&&(p.preventDefault(),p.stopPropagation())},_doKeyPress:function(l){var j,m,k=b.datepicker._getInst(l.target);return b.datepicker._get(k,"constrainInput")?(j=b.datepicker._possibleChars(b.datepicker._get(k,"dateFormat")),m=String.fromCharCode(null==l.charCode?l.keyCode:l.charCode),l.ctrlKey||l.metaKey||" ">m||!j||j.indexOf(m)>-1):void 0},_doKeyUp:function(l){var j,m=b.datepicker._getInst(l.target);if(m.input.val()!==m.lastVal){try{j=b.datepicker.parseDate(b.datepicker._get(m,"dateFormat"),m.input?m.input.val():null,b.datepicker._getFormatConfig(m)),j&&(b.datepicker._setDateFromField(m),b.datepicker._updateAlternate(m),b.datepicker._updateDatepicker(m))}catch(k){}}return !0},_showDatepicker:function(s){if(s=s.target||s,"input"!==s.nodeName.toLowerCase()&&(s=b("input",s.parentNode)[0]),!b.datepicker._isDisabledDatepicker(s)&&b.datepicker._lastInput!==s){var m,u,t,q,k,j,p;m=b.datepicker._getInst(s),b.datepicker._curInst&&b.datepicker._curInst!==m&&(b.datepicker._curInst.dpDiv.stop(!0,!0),m&&b.datepicker._datepickerShowing&&b.datepicker._hideDatepicker(b.datepicker._curInst.input[0])),u=b.datepicker._get(m,"beforeShow"),t=u?u.apply(s,[s,m]):{},t!==!1&&(c(m.settings,t),m.lastVal=null,b.datepicker._lastInput=s,b.datepicker._setDateFromField(m),b.datepicker._inDialog&&(s.value=""),b.datepicker._pos||(b.datepicker._pos=b.datepicker._findPos(s),b.datepicker._pos[1]+=s.offsetHeight),q=!1,b(s).parents().each(function(){return q|="fixed"===b(this).css("position"),!q}),k={left:b.datepicker._pos[0],top:b.datepicker._pos[1]},b.datepicker._pos=null,m.dpDiv.empty(),m.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),b.datepicker._updateDatepicker(m),k=b.datepicker._checkOffset(m,k,q),m.dpDiv.css({position:b.datepicker._inDialog&&b.blockUI?"static":q?"fixed":"absolute",display:"none",left:k.left+"px",top:k.top+"px"}),m.inline||(j=b.datepicker._get(m,"showAnim"),p=b.datepicker._get(m,"duration"),m.dpDiv.zIndex(b(s).zIndex()+1),b.datepicker._datepickerShowing=!0,b.effects&&b.effects.effect[j]?m.dpDiv.show(j,b.datepicker._get(m,"showOptions"),p):m.dpDiv[j||"show"](j?p:null),b.datepicker._shouldFocusInput(m)&&m.input.focus(),b.datepicker._curInst=m))}},_updateDatepicker:function(m){this.maxRows=4,g=m,m.dpDiv.empty().append(this._generateHTML(m)),this._attachHandlers(m),m.dpDiv.find("."+this._dayOverClass+" a").mouseover();var j,o=this._getNumberOfMonths(m),k=o[1],l=17;m.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),k>1&&m.dpDiv.addClass("ui-datepicker-multi-"+k).css("width",l*k+"em"),m.dpDiv[(1!==o[0]||1!==o[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),m.dpDiv[(this._get(m,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),m===b.datepicker._curInst&&b.datepicker._datepickerShowing&&b.datepicker._shouldFocusInput(m)&&m.input.focus(),m.yearshtml&&(j=m.yearshtml,setTimeout(function(){j===m.yearshtml&&m.yearshtml&&m.dpDiv.find("select.ui-datepicker-year:first").replaceWith(m.yearshtml),j=m.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(u,q,m){var w=u.dpDiv.outerWidth(),k=u.dpDiv.outerHeight(),j=u.input?u.input.outerWidth():0,v=u.input?u.input.outerHeight():0,p=document.documentElement.clientWidth+(m?0:b(document).scrollLeft()),t=document.documentElement.clientHeight+(m?0:b(document).scrollTop());return q.left-=this._get(u,"isRTL")?w-j:0,q.left-=m&&q.left===u.input.offset().left?b(document).scrollLeft():0,q.top-=m&&q.top===u.input.offset().top+v?b(document).scrollTop():0,q.left-=Math.min(q.left,q.left+w>p&&p>w?Math.abs(q.left+w-p):0),q.top-=Math.min(q.top,q.top+k>t&&t>k?Math.abs(k+v):0),q},_findPos:function(l){for(var j,m=this._getInst(l),k=this._get(m,"isRTL");l&&("hidden"===l.type||1!==l.nodeType||b.expr.filters.hidden(l));){l=l[k?"previousSibling":"nextSibling"]}return j=b(l).offset(),[j.left,j.top]},_hideDatepicker:function(m){var k,q,l,p,j=this._curInst;!j||m&&j!==b.data(m,d)||this._datepickerShowing&&(k=this._get(j,"showAnim"),q=this._get(j,"duration"),l=function(){b.datepicker._tidyDialog(j)},b.effects&&(b.effects.effect[k]||b.effects[k])?j.dpDiv.hide(k,b.datepicker._get(j,"showOptions"),q,l):j.dpDiv["slideDown"===k?"slideUp":"fadeIn"===k?"fadeOut":"hide"](k?q:null,l),k||l(),this._datepickerShowing=!1,p=this._get(j,"onClose"),p&&p.apply(j.input?j.input[0]:null,[j.input?j.input.val():"",j]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),b.blockUI&&(b.unblockUI(),b("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(k){if(b.datepicker._curInst){var j=b(k.target),l=b.datepicker._getInst(j[0]);(j[0].id!==b.datepicker._mainDivId&&0===j.parents("#"+b.datepicker._mainDivId).length&&!j.hasClass(b.datepicker.markerClassName)&&!j.closest("."+b.datepicker._triggerClass).length&&b.datepicker._datepickerShowing&&(!b.datepicker._inDialog||!b.blockUI)||j.hasClass(b.datepicker.markerClassName)&&b.datepicker._curInst!==l)&&b.datepicker._hideDatepicker()}},_adjustDate:function(l,j,p){var k=b(l),m=this._getInst(k[0]);this._isDisabledDatepicker(k[0])||(this._adjustInstDate(m,j+("M"===p?this._get(m,"showCurrentAtPos"):0),p),this._updateDatepicker(m))},_gotoToday:function(l){var j,m=b(l),k=this._getInst(m[0]);this._get(k,"gotoCurrent")&&k.currentDay?(k.selectedDay=k.currentDay,k.drawMonth=k.selectedMonth=k.currentMonth,k.drawYear=k.selectedYear=k.currentYear):(j=new Date,k.selectedDay=j.getDate(),k.drawMonth=k.selectedMonth=j.getMonth(),k.drawYear=k.selectedYear=j.getFullYear()),this._notifyChange(k),this._adjustDate(m)},_selectMonthYear:function(l,j,p){var k=b(l),m=this._getInst(k[0]);m["selected"+("M"===p?"Month":"Year")]=m["draw"+("M"===p?"Month":"Year")]=parseInt(j.options[j.selectedIndex].value,10),this._notifyChange(m),this._adjustDate(k)},_selectDay:function(m,j,q,k){var p,l=b(m);b(k).hasClass(this._unselectableClass)||this._isDisabledDatepicker(l[0])||(p=this._getInst(l[0]),p.selectedDay=p.currentDay=b("a",k).html(),p.selectedMonth=p.currentMonth=j,p.selectedYear=p.currentYear=q,this._selectDate(m,this._formatDate(p,p.currentDay,p.currentMonth,p.currentYear)))},_clearDate:function(k){var j=b(k);this._selectDate(j,"")},_selectDate:function(l,j){var p,k=b(l),m=this._getInst(k[0]);j=null!=j?j:this._formatDate(m),m.input&&m.input.val(j),this._updateAlternate(m),p=this._get(m,"onSelect"),p?p.apply(m.input?m.input[0]:null,[j,m]):m.input&&m.input.trigger("change"),m.inline?this._updateDatepicker(m):(this._hideDatepicker(),this._lastInput=m.input[0],"object"!=typeof m.input[0]&&m.input.focus(),this._lastInput=null)},_updateAlternate:function(l){var j,p,k,m=this._get(l,"altField");m&&(j=this._get(l,"altFormat")||this._get(l,"dateFormat"),p=this._getDate(l),k=this.formatDate(j,p,this._getFormatConfig(l)),b(m).each(function(){b(this).val(k)}))},noWeekends:function(i){var j=i.getDay();return[j>0&&6>j,""]},iso8601Week:function(k){var l,j=new Date(k.getTime());return j.setDate(j.getDate()+4-(j.getDay()||7)),l=j.getTime(),j.setMonth(0),j.setDate(1),Math.floor(Math.round((l-j)/86400000)/7)+1},parseDate:function(N,J,F){if(null==N||null==J){throw"Invalid arguments"}if(J="object"==typeof J?J.toString():J+"",""===J){return null}var B,E,C,R,H=0,K=(F?F.shortYearCutoff:null)||this._defaults.shortYearCutoff,P="string"!=typeof K?K:(new Date).getFullYear()%100+parseInt(K,10),A=(F?F.dayNamesShort:null)||this._defaults.dayNamesShort,O=(F?F.dayNames:null)||this._defaults.dayNames,D=(F?F.monthNamesShort:null)||this._defaults.monthNamesShort,M=(F?F.monthNames:null)||this._defaults.monthNames,G=-1,L=-1,z=-1,j=-1,Q=!1,S=function(k){var e=B+1<N.length&&N.charAt(B+1)===k;return e&&B++,e},t=function(i){var l=S(i),p="@"===i?14:"!"===i?20:"y"===i&&l?4:"o"===i?3:2,k=new RegExp("^\\d{1,"+p+"}"),m=J.substring(H).match(k);if(!m){throw"Missing number at position "+H}return H+=m[0].length,parseInt(m[0],10)},q=function(l,p,i){var m=-1,k=b.map(S(l)?i:p,function(n,o){return[[o,n]]}).sort(function(n,o){return -(n[1].length-o[1].length)});if(b.each(k,function(o,r){var s=r[1];return J.substr(H,s.length).toLowerCase()===s.toLowerCase()?(m=r[0],H+=s.length,!1):void 0}),-1!==m){return m+1}throw"Unknown name at position "+H},I=function(){if(J.charAt(H)!==N.charAt(B)){throw"Unexpected literal at position "+H}H++};for(B=0;B<N.length;B++){if(Q){"'"!==N.charAt(B)||S("'")?I():Q=!1}else{switch(N.charAt(B)){case"d":z=t("d");break;case"D":q("D",A,O);break;case"o":j=t("o");break;case"m":L=t("m");break;case"M":L=q("M",D,M);break;case"y":G=t("y");break;case"@":R=new Date(t("@")),G=R.getFullYear(),L=R.getMonth()+1,z=R.getDate();break;case"!":R=new Date((t("!")-this._ticksTo1970)/10000),G=R.getFullYear(),L=R.getMonth()+1,z=R.getDate();break;case"'":S("'")?I():Q=!0;break;default:I()}}}if(H<J.length&&(C=J.substr(H),!/^\s+/.test(C))){throw"Extra/unparsed characters found in date: "+C}if(-1===G?G=(new Date).getFullYear():100>G&&(G+=(new Date).getFullYear()-(new Date).getFullYear()%100+(P>=G?0:-100)),j>-1){for(L=1,z=j;;){if(E=this._getDaysInMonth(G,L-1),E>=z){break}L++,z-=E}}if(R=this._daylightSavingAdjust(new Date(G,L-1,z)),R.getFullYear()!==G||R.getMonth()+1!==L||R.getDate()!==z){throw"Invalid date"}return R},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:10000000*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(B,w,q){if(!w){return""}var m,C=(q?q.dayNamesShort:null)||this._defaults.dayNamesShort,k=(q?q.dayNames:null)||this._defaults.dayNames,j=(q?q.monthNamesShort:null)||this._defaults.monthNamesShort,z=(q?q.monthNames:null)||this._defaults.monthNames,p=function(n){var l=m+1<B.length&&B.charAt(m+1)===n;return l&&m++,l},v=function(o,r,l){var s=""+r;if(p(o)){for(;s.length<l;){s="0"+s}}return s},y=function(o,r,l,s){return p(o)?s[r]:l[r]},A="",x=!1;if(w){for(m=0;m<B.length;m++){if(x){"'"!==B.charAt(m)||p("'")?A+=B.charAt(m):x=!1}else{switch(B.charAt(m)){case"d":A+=v("d",w.getDate(),2);break;case"D":A+=y("D",w.getDay(),C,k);break;case"o":A+=v("o",Math.round((new Date(w.getFullYear(),w.getMonth(),w.getDate()).getTime()-new Date(w.getFullYear(),0,0).getTime())/86400000),3);break;case"m":A+=v("m",w.getMonth()+1,2);break;case"M":A+=y("M",w.getMonth(),j,z);break;case"y":A+=p("y")?w.getFullYear():(w.getYear()%100<10?"0":"")+w.getYear()%100;break;case"@":A+=w.getTime();break;case"!":A+=10000*w.getTime()+this._ticksTo1970;break;case"'":p("'")?A+="'":x=!0;break;default:A+=B.charAt(m)}}}}return A},_possibleChars:function(k){var m,j="",o=!1,l=function(e){var p=m+1<k.length&&k.charAt(m+1)===e;return p&&m++,p};for(m=0;m<k.length;m++){if(o){"'"!==k.charAt(m)||l("'")?j+=k.charAt(m):o=!1}else{switch(k.charAt(m)){case"d":case"m":case"y":case"@":j+="0123456789";break;case"D":case"M":return null;case"'":l("'")?j+="'":o=!0;break;default:j+=k.charAt(m)}}}return j},_get:function(j,e){return j.settings[e]!==f?j.settings[e]:this._defaults[e]},_setDateFromField:function(l,q){if(l.input.val()!==l.lastVal){var k=this._get(l,"dateFormat"),v=l.lastVal=l.input?l.input.val():null,m=this._getDefaultDate(l),u=m,p=this._getFormatConfig(l);try{u=this.parseDate(k,v,p)||m}catch(j){v=q?"":v}l.selectedDay=u.getDate(),l.drawMonth=l.selectedMonth=u.getMonth(),l.drawYear=l.selectedYear=u.getFullYear(),l.currentDay=v?u.getDate():0,l.currentMonth=v?u.getMonth():0,l.currentYear=v?u.getFullYear():0,this._adjustInstDate(l)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(m,j,q){var k=function(i){var n=new Date;return n.setDate(n.getDate()+i),n},p=function(u){try{return b.datepicker.parseDate(b.datepicker._get(m,"dateFormat"),u,b.datepicker._getFormatConfig(m))}catch(z){}for(var w=(u.toLowerCase().match(/^c/)?b.datepicker._getDate(m):null)||new Date,y=w.getFullYear(),x=w.getMonth(),t=w.getDate(),e=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,v=e.exec(u);v;){switch(v[2]||"d"){case"d":case"D":t+=parseInt(v[1],10);break;case"w":case"W":t+=7*parseInt(v[1],10);break;case"m":case"M":x+=parseInt(v[1],10),t=Math.min(t,b.datepicker._getDaysInMonth(y,x));break;case"y":case"Y":y+=parseInt(v[1],10),t=Math.min(t,b.datepicker._getDaysInMonth(y,x))}v=e.exec(u)}return new Date(y,x,t)},l=null==j||""===j?q:"string"==typeof j?p(j):"number"==typeof j?isNaN(j)?q:k(j):new Date(j.getTime());return l=l&&"Invalid Date"===l.toString()?q:l,l&&(l.setHours(0),l.setMinutes(0),l.setSeconds(0),l.setMilliseconds(0)),this._daylightSavingAdjust(l)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(k,p,j){var u=!p,l=k.selectedMonth,q=k.selectedYear,m=this._restrictMinMax(k,this._determineDate(k,p,new Date));k.selectedDay=k.currentDay=m.getDate(),k.drawMonth=k.selectedMonth=k.currentMonth=m.getMonth(),k.drawYear=k.selectedYear=k.currentYear=m.getFullYear(),l===k.selectedMonth&&q===k.selectedYear||j||this._notifyChange(k),this._adjustInstDate(k),k.input&&k.input.val(u?"":this._formatDate(k))},_getDate:function(i){var j=!i.currentYear||i.input&&""===i.input.val()?null:this._daylightSavingAdjust(new Date(i.currentYear,i.currentMonth,i.currentDay));return j},_attachHandlers:function(k){var j=this._get(k,"stepMonths"),l="#"+k.id.replace(/\\\\/g,"\\");k.dpDiv.find("[data-handler]").map(function(){var i={prev:function(){b.datepicker._adjustDate(l,-j,"M")},next:function(){b.datepicker._adjustDate(l,+j,"M")},hide:function(){b.datepicker._hideDatepicker()},today:function(){b.datepicker._gotoToday(l)},selectDay:function(){return b.datepicker._selectDay(l,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return b.datepicker._selectMonthYear(l,this,"M"),!1},selectYear:function(){return b.datepicker._selectMonthYear(l,this,"Y"),!1}};b(this).bind(this.getAttribute("data-event"),i[this.getAttribute("data-handler")])})},_generateHTML:function(aJ){var aY,aU,aP,aK,aO,aL,a2,aR,aV,a0,aI,aZ,aN,aX,aQ,aW,aH,aE,a1,a3,aG,aF,aS,az,ah,ay,ao,ai,at,ax,an,aB,al,aj,au,am,aT,aD,aw,ae=new Date,ap=this._daylightSavingAdjust(new Date(ae.getFullYear(),ae.getMonth(),ae.getDate())),aC=this._get(aJ,"isRTL"),aA=this._get(aJ,"showButtonPanel"),aM=this._get(aJ,"hideIfNoPrevNext"),aq=this._get(aJ,"navigationAsDateFormat"),ag=this._getNumberOfMonths(aJ),ab=this._get(aJ,"showCurrentAtPos"),af=this._get(aJ,"stepMonths"),ac=1!==ag[0]||1!==ag[1],ak=this._daylightSavingAdjust(aJ.currentDay?new Date(aJ.currentYear,aJ.currentMonth,aJ.currentDay):new Date(9999,9,9)),ar=this._getMinMaxDate(aJ,"min"),av=this._getMinMaxDate(aJ,"max"),aa=aJ.drawMonth-ab,ad=aJ.drawYear;if(0>aa&&(aa+=12,ad--),av){for(aY=this._daylightSavingAdjust(new Date(av.getFullYear(),av.getMonth()-ag[0]*ag[1]+1,av.getDate())),aY=ar&&ar>aY?ar:aY;this._daylightSavingAdjust(new Date(ad,aa,1))>aY;){aa--,0>aa&&(aa=11,ad--)}}for(aJ.drawMonth=aa,aJ.drawYear=ad,aU=this._get(aJ,"prevText"),aU=aq?this.formatDate(aU,this._daylightSavingAdjust(new Date(ad,aa-af,1)),this._getFormatConfig(aJ)):aU,aP=this._canAdjustMonth(aJ,-1,ad,aa)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+aU+"'><span class='ui-icon ui-icon-circle-triangle-"+(aC?"e":"w")+"'>"+aU+"</span></a>":aM?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+aU+"'><span class='ui-icon ui-icon-circle-triangle-"+(aC?"e":"w")+"'>"+aU+"</span></a>",aK=this._get(aJ,"nextText"),aK=aq?this.formatDate(aK,this._daylightSavingAdjust(new Date(ad,aa+af,1)),this._getFormatConfig(aJ)):aK,aO=this._canAdjustMonth(aJ,1,ad,aa)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+aK+"'><span class='ui-icon ui-icon-circle-triangle-"+(aC?"w":"e")+"'>"+aK+"</span></a>":aM?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+aK+"'><span class='ui-icon ui-icon-circle-triangle-"+(aC?"w":"e")+"'>"+aK+"</span></a>",aL=this._get(aJ,"currentText"),a2=this._get(aJ,"gotoCurrent")&&aJ.currentDay?ak:ap,aL=aq?this.formatDate(aL,a2,this._getFormatConfig(aJ)):aL,aR=aJ.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(aJ,"closeText")+"</button>",aV=aA?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(aC?aR:"")+(this._isInRange(aJ,a2)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+aL+"</button>":"")+(aC?"":aR)+"</div>":"",a0=parseInt(this._get(aJ,"firstDay"),10),a0=isNaN(a0)?0:a0,aI=this._get(aJ,"showWeek"),aZ=this._get(aJ,"dayNames"),aN=this._get(aJ,"dayNamesMin"),aX=this._get(aJ,"monthNames"),aQ=this._get(aJ,"monthNamesShort"),aW=this._get(aJ,"beforeShowDay"),aH=this._get(aJ,"showOtherMonths"),aE=this._get(aJ,"selectOtherMonths"),a1=this._getDefaultDate(aJ),a3="",aF=0;aF<ag[0];aF++){for(aS="",this.maxRows=4,az=0;az<ag[1];az++){if(ah=this._daylightSavingAdjust(new Date(ad,aa,aJ.selectedDay)),ay=" ui-corner-all",ao="",ac){if(ao+="<div class='ui-datepicker-group",ag[1]>1){switch(az){case 0:ao+=" ui-datepicker-group-first",ay=" ui-corner-"+(aC?"right":"left");break;case ag[1]-1:ao+=" ui-datepicker-group-last",ay=" ui-corner-"+(aC?"left":"right");break;default:ao+=" ui-datepicker-group-middle",ay=""}}ao+="'>"}for(ao+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+ay+"'>"+(/all|left/.test(ay)&&0===aF?aC?aO:aP:"")+(/all|right/.test(ay)&&0===aF?aC?aP:aO:"")+this._generateMonthYearHeader(aJ,aa,ad,ar,av,aF>0||az>0,aX,aQ)+"</div><table class='ui-datepicker-calendar'><thead><tr>",ai=aI?"<th class='ui-datepicker-week-col'>"+this._get(aJ,"weekHeader")+"</th>":"",aG=0;7>aG;aG++){at=(aG+a0)%7,ai+="<th"+((aG+a0+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+aZ[at]+"'>"+aN[at]+"</span></th>"}for(ao+=ai+"</tr></thead><tbody>",ax=this._getDaysInMonth(ad,aa),ad===aJ.selectedYear&&aa===aJ.selectedMonth&&(aJ.selectedDay=Math.min(aJ.selectedDay,ax)),an=(this._getFirstDayOfMonth(ad,aa)-a0+7)%7,aB=Math.ceil((an+ax)/7),al=ac?this.maxRows>aB?this.maxRows:aB:aB,this.maxRows=al,aj=this._daylightSavingAdjust(new Date(ad,aa,1-an)),au=0;al>au;au++){for(ao+="<tr>",am=aI?"<td class='ui-datepicker-week-col'>"+this._get(aJ,"calculateWeek")(aj)+"</td>":"",aG=0;7>aG;aG++){aT=aW?aW.apply(aJ.input?aJ.input[0]:null,[aj]):[!0,""],aD=aj.getMonth()!==aa,aw=aD&&!aE||!aT[0]||ar&&ar>aj||av&&aj>av,am+="<td class='"+((aG+a0+6)%7>=5?" ui-datepicker-week-end":"")+(aD?" ui-datepicker-other-month":"")+(aj.getTime()===ah.getTime()&&aa===aJ.selectedMonth&&aJ._keyEvent||a1.getTime()===aj.getTime()&&a1.getTime()===ah.getTime()?" "+this._dayOverClass:"")+(aw?" "+this._unselectableClass+" ui-state-disabled":"")+(aD&&!aH?"":" "+aT[1]+(aj.getTime()===ak.getTime()?" "+this._currentClass:"")+(aj.getTime()===ap.getTime()?" ui-datepicker-today":""))+"'"+(aD&&!aH||!aT[2]?"":" title='"+aT[2].replace(/'/g,"&#39;")+"'")+(aw?"":" data-handler='selectDay' data-event='click' data-month='"+aj.getMonth()+"' data-year='"+aj.getFullYear()+"'")+">"+(aD&&!aH?"&#xa0;":aw?"<span class='ui-state-default'>"+aj.getDate()+"</span>":"<a class='ui-state-default"+(aj.getTime()===ap.getTime()?" ui-state-highlight":"")+(aj.getTime()===ak.getTime()?" ui-state-active":"")+(aD?" ui-priority-secondary":"")+"' href='#'>"+aj.getDate()+"</a>")+"</td>",aj.setDate(aj.getDate()+1),aj=this._daylightSavingAdjust(aj)}ao+=am+"</tr>"}aa++,aa>11&&(aa=0,ad++),ao+="</tbody></table>"+(ac?"</div>"+(ag[0]>0&&az===ag[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),aS+=ao}a3+=aS}return a3+=aV,aJ._keyEvent=!1,a3},_generateMonthYearHeader:function(w,J,F,C,x,B,z,N){var E,G,L,q,K,A,I,D,H=this._get(w,"changeMonth"),k=this._get(w,"changeYear"),j=this._get(w,"showMonthAfterYear"),M="<div class='ui-datepicker-title'>",O="";if(B||!H){O+="<span class='ui-datepicker-month'>"+z[J]+"</span>"}else{for(E=C&&C.getFullYear()===F,G=x&&x.getFullYear()===F,O+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",L=0;12>L;L++){(!E||L>=C.getMonth())&&(!G||L<=x.getMonth())&&(O+="<option value='"+L+"'"+(L===J?" selected='selected'":"")+">"+N[L]+"</option>")}O+="</select>"}if(j||(M+=O+(!B&&H&&k?"":"&#xa0;")),!w.yearshtml){if(w.yearshtml="",B||!k){M+="<span class='ui-datepicker-year'>"+F+"</span>"}else{for(q=this._get(w,"yearRange").split(":"),K=(new Date).getFullYear(),A=function(i){var l=i.match(/c[+\-].*/)?F+parseInt(i.substring(1),10):i.match(/[+\-].*/)?K+parseInt(i,10):parseInt(i,10);return isNaN(l)?K:l},I=A(q[0]),D=Math.max(I,A(q[1]||"")),I=C?Math.max(I,C.getFullYear()):I,D=x?Math.min(D,x.getFullYear()):D,w.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";D>=I;I++){w.yearshtml+="<option value='"+I+"'"+(I===F?" selected='selected'":"")+">"+I+"</option>"}w.yearshtml+="</select>",M+=w.yearshtml,w.yearshtml=null}}return M+=this._get(w,"yearSuffix"),j&&(M+=(!B&&H&&k?"":"&#xa0;")+O),M+="</div>"},_adjustInstDate:function(k,p,j){var u=k.drawYear+("Y"===j?p:0),l=k.drawMonth+("M"===j?p:0),q=Math.min(k.selectedDay,this._getDaysInMonth(u,l))+("D"===j?p:0),m=this._restrictMinMax(k,this._daylightSavingAdjust(new Date(u,l,q)));k.selectedDay=m.getDate(),k.drawMonth=k.selectedMonth=m.getMonth(),k.drawYear=k.selectedYear=m.getFullYear(),("M"===j||"Y"===j)&&this._notifyChange(k)},_restrictMinMax:function(k,m){var j=this._getMinMaxDate(k,"min"),o=this._getMinMaxDate(k,"max"),l=j&&j>m?j:m;return o&&l>o?o:l},_notifyChange:function(i){var j=this._get(i,"onChangeMonthYear");j&&j.apply(i.input?i.input[0]:null,[i.selectedYear,i.selectedMonth+1,i])},_getNumberOfMonths:function(i){var j=this._get(i,"numberOfMonths");return null==j?[1,1]:"number"==typeof j?[1,j]:j},_getMinMaxDate:function(i,j){return this._determineDate(i,this._get(i,j+"Date"),null)},_getDaysInMonth:function(i,j){return 32-this._daylightSavingAdjust(new Date(i,j,32)).getDate()},_getFirstDayOfMonth:function(i,j){return new Date(i,j,1).getDay()},_canAdjustMonth:function(k,m,j,q){var l=this._getNumberOfMonths(k),p=this._daylightSavingAdjust(new Date(j,q+(0>m?m:l[0]*l[1]),1));return 0>m&&p.setDate(this._getDaysInMonth(p.getFullYear(),p.getMonth())),this._isInRange(k,p)},_isInRange:function(w,u){var q,m,x=this._getMinMaxDate(w,"min"),k=this._getMinMaxDate(w,"max"),j=null,v=null,p=this._get(w,"yearRange");return p&&(q=p.split(":"),m=(new Date).getFullYear(),j=parseInt(q[0],10),v=parseInt(q[1],10),q[0].match(/[+\-].*/)&&(j+=m),q[1].match(/[+\-].*/)&&(v+=m)),(!x||u.getTime()>=x.getTime())&&(!k||u.getTime()<=k.getTime())&&(!j||u.getFullYear()>=j)&&(!v||u.getFullYear()<=v)},_getFormatConfig:function(i){var j=this._get(i,"shortYearCutoff");return j="string"!=typeof j?j:(new Date).getFullYear()%100+parseInt(j,10),{shortYearCutoff:j,dayNamesShort:this._get(i,"dayNamesShort"),dayNames:this._get(i,"dayNames"),monthNamesShort:this._get(i,"monthNamesShort"),monthNames:this._get(i,"monthNames")}},_formatDate:function(k,m,j,o){m||(k.currentDay=k.selectedDay,k.currentMonth=k.selectedMonth,k.currentYear=k.selectedYear);var l=m?"object"==typeof m?m:this._daylightSavingAdjust(new Date(o,j,m)):this._daylightSavingAdjust(new Date(k.currentYear,k.currentMonth,k.currentDay));return this.formatDate(this._get(k,"dateFormat"),l,this._getFormatConfig(k))}}),b.fn.datepicker=function(k){if(!this.length){return this}b.datepicker.initialized||(b(document).mousedown(b.datepicker._checkExternalClick),b.datepicker.initialized=!0),0===b("#"+b.datepicker._mainDivId).length&&b("body").append(b.datepicker.dpDiv);var j=Array.prototype.slice.call(arguments,1);return"string"!=typeof k||"isDisabled"!==k&&"getDate"!==k&&"widget"!==k?"option"===k&&2===arguments.length&&"string"==typeof arguments[1]?b.datepicker["_"+k+"Datepicker"].apply(b.datepicker,[this[0]].concat(j)):this.each(function(){"string"==typeof k?b.datepicker["_"+k+"Datepicker"].apply(b.datepicker,[this].concat(j)):b.datepicker._attachDatepicker(this,k)}):b.datepicker["_"+k+"Datepicker"].apply(b.datepicker,[this[0]].concat(j))},b.datepicker=new a,b.datepicker.initialized=!1,b.datepicker.uuid=(new Date).getTime(),b.datepicker.version="1.10.3"}($),
/*!
 * jQuery UI Mouse 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 *
 * Depends:
 *	jquery.ui.widget.js
 */
function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var c=this;this.element.bind("mousedown."+this.widgetName,function(d){return c._mouseDown(d)}).bind("click."+this.widgetName,function(d){return !0===a.data(d.target,c.widgetName+".preventClickEvent")?(a.removeData(d.target,c.widgetName+".preventClickEvent"),d.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var f=this,d=1===c.which,e="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return d&&!e&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){f.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(g){return f._mouseMove(g)},this._mouseUpDelegate=function(g){return f._mouseUp(g)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(c){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!c.button?this._mouseUp(c):this._mouseStarted?(this._mouseDrag(c),c.preventDefault()):(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,c)!==!1,this._mouseStarted?this._mouseDrag(c):this._mouseUp(c)),!this._mouseStarted)},_mouseUp:function(c){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,c.target===this._mouseDownEvent.target&&a.data(c.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(c)),!1},_mouseDistanceMet:function(c){return Math.max(Math.abs(this._mouseDownEvent.pageX-c.pageX),Math.abs(this._mouseDownEvent.pageY-c.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return !0}})}($),
/*!
 * jQuery UI Draggable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(c){var b=this.options;return this.helper||b.disabled||a(c.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(c),this.handle?(a(b.iframeFix===!0?"iframe":b.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(c){var b=this.options;return this.helper=this._createHelper(c),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:c.pageX-this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(c),this.originalPageX=c.pageX,this.originalPageY=c.pageY,b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt),this._setContainment(),this._trigger("start",c)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!b.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,c),this._mouseDrag(c,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,c),!0)},_mouseDrag:function(c,b){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(c),this.positionAbs=this._convertPositionTo("absolute"),!b){var d=this._uiHash();if(this._trigger("drag",c,d)===!1){return this._mouseUp({}),!1}this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,c),!1},_mouseStop:function(c){var b=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,c)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){b._trigger("stop",c)!==!1&&b._clear()}):this._trigger("stop",c)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(c){var b=this.options,d=a.isFunction(b.helper)?a(b.helper.apply(this.element[0],[c])):"clone"===b.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===b.appendTo?this.element[0].parentNode:b.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left" in b&&(this.offset.click.left=b.left+this.margins.left),"right" in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top" in b&&(this.offset.click.top=b.top+this.margins.top),"bottom" in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var b=this.element.position();return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d,b,f,c=this.options;return c.containment?"window"===c.containment?(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===c.containment?(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):c.containment.constructor===Array?(this.containment=c.containment,void 0):("parent"===c.containment&&(c.containment=this.helper[0].parentNode),b=a(c.containment),f=b[0],f&&(d="hidden"!==b.css("overflow"),this.containment=[(parseInt(b.css("borderLeftWidth"),10)||0)+(parseInt(b.css("paddingLeft"),10)||0),(parseInt(b.css("borderTopWidth"),10)||0)+(parseInt(b.css("paddingTop"),10)||0),(d?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(b.css("borderRightWidth"),10)||0)-(parseInt(b.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(b.css("borderBottomWidth"),10)||0)-(parseInt(b.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=b),void 0):(this.containment=null,void 0)},_convertPositionTo:function(d,b){b||(b=this.position);var f="absolute"===d?1:-1,c="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:c.scrollTop(),left:c.scrollLeft()}),{top:b.top+this.offset.relative.top*f+this.offset.parent.top*f-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*f,left:b.left+this.offset.relative.left*f+this.offset.parent.left*f-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*f}},_generatePosition:function(k){var g,d,p,c,b=this.options,m="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=k.pageX,j=k.pageY;return this.offset.scroll||(this.offset.scroll={top:m.scrollTop(),left:m.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),g=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):g=this.containment,k.pageX-this.offset.click.left<g[0]&&(f=g[0]+this.offset.click.left),k.pageY-this.offset.click.top<g[1]&&(j=g[1]+this.offset.click.top),k.pageX-this.offset.click.left>g[2]&&(f=g[2]+this.offset.click.left),k.pageY-this.offset.click.top>g[3]&&(j=g[3]+this.offset.click.top)),b.grid&&(p=b.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/b.grid[1])*b.grid[1]:this.originalPageY,j=g?p-this.offset.click.top>=g[1]||p-this.offset.click.top>g[3]?p:p-this.offset.click.top>=g[1]?p-b.grid[1]:p+b.grid[1]:p,c=b.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/b.grid[0])*b.grid[0]:this.originalPageX,f=g?c-this.offset.click.left>=g[0]||c-this.offset.click.left>g[2]?c:c-this.offset.click.left>=g[0]?c-b.grid[0]:c+b.grid[0]:c)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(c,b,d){return d=d||this._uiHash(),a.ui.plugin.call(this,c,[b,d]),"drag"===c&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,c,b,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(d,b){var g=a(this).data("ui-draggable"),c=g.options,f=a.extend({},b,{item:g.element});g.sortables=[],a(c.connectToSortable).each(function(){var e=a.data(this,"ui-sortable");e&&!e.options.disabled&&(g.sortables.push({instance:e,shouldRevert:e.options.revert}),e.refreshPositions(),e._trigger("activate",d,f))})},stop:function(d,b){var f=a(this).data("ui-draggable"),c=a.extend({},b,{item:f.element});a.each(f.sortables,function(){this.instance.isOver?(this.instance.isOver=0,f.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(d),this.instance.options.helper=this.instance.options._helper,"original"===f.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",d,c))})},drag:function(d,b){var f=a(this).data("ui-draggable"),c=this;a.each(f.sortables,function(){var g=!1,e=this;this.instance.positionAbs=f.positionAbs,this.instance.helperProportions=f.helperProportions,this.instance.offset.click=f.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(g=!0,a.each(f.sortables,function(){return this.instance.positionAbs=f.positionAbs,this.instance.helperProportions=f.helperProportions,this.instance.offset.click=f.offset.click,this!==e&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(e.instance.element[0],this.instance.element[0])&&(g=!1),g})),g?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(c).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return b.helper[0]},d.target=this.instance.currentItem[0],this.instance._mouseCapture(d,!0),this.instance._mouseStart(d,!0,!0),this.instance.offset.click.top=f.offset.click.top,this.instance.offset.click.left=f.offset.click.left,this.instance.offset.parent.left-=f.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=f.offset.parent.top-this.instance.offset.parent.top,f._trigger("toSortable",d),f.dropped=this.instance.element,f.currentItem=f.element,this.instance.fromOutside=f),this.instance.currentItem&&this.instance._mouseDrag(d)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",d,this.instance._uiHash(this.instance)),this.instance._mouseStop(d,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),f._trigger("fromSortable",d),f.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var c=a("body"),b=a(this).data("ui-draggable").options;c.css("cursor")&&(b._cursor=c.css("cursor")),c.css("cursor",b.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(d,b){var f=a(b.helper),c=a(this).data("ui-draggable").options;f.css("opacity")&&(c._opacity=f.css("opacity")),f.css("opacity",c.opacity)},stop:function(c,b){var d=a(this).data("ui-draggable").options;d._opacity&&a(b.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(d){var b=a(this).data("ui-draggable"),f=b.options,c=!1;b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName?(f.axis&&"x"===f.axis||(b.overflowOffset.top+b.scrollParent[0].offsetHeight-d.pageY<f.scrollSensitivity?b.scrollParent[0].scrollTop=c=b.scrollParent[0].scrollTop+f.scrollSpeed:d.pageY-b.overflowOffset.top<f.scrollSensitivity&&(b.scrollParent[0].scrollTop=c=b.scrollParent[0].scrollTop-f.scrollSpeed)),f.axis&&"y"===f.axis||(b.overflowOffset.left+b.scrollParent[0].offsetWidth-d.pageX<f.scrollSensitivity?b.scrollParent[0].scrollLeft=c=b.scrollParent[0].scrollLeft+f.scrollSpeed:d.pageX-b.overflowOffset.left<f.scrollSensitivity&&(b.scrollParent[0].scrollLeft=c=b.scrollParent[0].scrollLeft-f.scrollSpeed))):(f.axis&&"x"===f.axis||(d.pageY-a(document).scrollTop()<f.scrollSensitivity?c=a(document).scrollTop(a(document).scrollTop()-f.scrollSpeed):a(window).height()-(d.pageY-a(document).scrollTop())<f.scrollSensitivity&&(c=a(document).scrollTop(a(document).scrollTop()+f.scrollSpeed))),f.axis&&"y"===f.axis||(d.pageX-a(document).scrollLeft()<f.scrollSensitivity?c=a(document).scrollLeft(a(document).scrollLeft()-f.scrollSpeed):a(window).width()-(d.pageX-a(document).scrollLeft())<f.scrollSensitivity&&(c=a(document).scrollLeft(a(document).scrollLeft()+f.scrollSpeed)))),c!==!1&&a.ui.ddmanager&&!f.dropBehaviour&&a.ui.ddmanager.prepareOffsets(b,d)}}),a.ui.plugin.add("draggable","snap",{start:function(){var c=a(this).data("ui-draggable"),b=c.options;c.snapElements=[],a(b.snap.constructor!==String?b.snap.items||":data(ui-draggable)":b.snap).each(function(){var d=a(this),e=d.offset();this!==c.element[0]&&c.snapElements.push({item:this,width:d.outerWidth(),height:d.outerHeight(),top:e.top,left:e.left})})},drag:function(H,D){var A,t,z,w,L,C,E,J,q,I,x=a(this).data("ui-draggable"),G=x.options,B=G.snapTolerance,F=D.offset.left,k=F+x.helperProportions.width,j=D.offset.top,K=j+x.helperProportions.height;for(q=x.snapElements.length-1;q>=0;q--){L=x.snapElements[q].left,C=L+x.snapElements[q].width,E=x.snapElements[q].top,J=E+x.snapElements[q].height,L-B>k||F>C+B||E-B>K||j>J+B||!a.contains(x.snapElements[q].item.ownerDocument,x.snapElements[q].item)?(x.snapElements[q].snapping&&x.options.snap.release&&x.options.snap.release.call(x.element,H,a.extend(x._uiHash(),{snapItem:x.snapElements[q].item})),x.snapElements[q].snapping=!1):("inner"!==G.snapMode&&(A=Math.abs(E-K)<=B,t=Math.abs(J-j)<=B,z=Math.abs(L-k)<=B,w=Math.abs(C-F)<=B,A&&(D.position.top=x._convertPositionTo("relative",{top:E-x.helperProportions.height,left:0}).top-x.margins.top),t&&(D.position.top=x._convertPositionTo("relative",{top:J,left:0}).top-x.margins.top),z&&(D.position.left=x._convertPositionTo("relative",{top:0,left:L-x.helperProportions.width}).left-x.margins.left),w&&(D.position.left=x._convertPositionTo("relative",{top:0,left:C}).left-x.margins.left)),I=A||t||z||w,"outer"!==G.snapMode&&(A=Math.abs(E-j)<=B,t=Math.abs(J-K)<=B,z=Math.abs(L-F)<=B,w=Math.abs(C-k)<=B,A&&(D.position.top=x._convertPositionTo("relative",{top:E,left:0}).top-x.margins.top),t&&(D.position.top=x._convertPositionTo("relative",{top:J-x.helperProportions.height,left:0}).top-x.margins.top),z&&(D.position.left=x._convertPositionTo("relative",{top:0,left:L}).left-x.margins.left),w&&(D.position.left=x._convertPositionTo("relative",{top:0,left:C-x.helperProportions.width}).left-x.margins.left)),!x.snapElements[q].snapping&&(A||t||z||w||I)&&x.options.snap.snap&&x.options.snap.snap.call(x.element,H,a.extend(x._uiHash(),{snapItem:x.snapElements[q].item})),x.snapElements[q].snapping=A||t||z||w||I)}}}),a.ui.plugin.add("draggable","stack",{start:function(){var c,b=this.data("ui-draggable").options,d=a.makeArray(a(b.stack)).sort(function(g,f){return(parseInt(a(g).css("zIndex"),10)||0)-(parseInt(a(f).css("zIndex"),10)||0)});d.length&&(c=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(e){a(this).css("zIndex",c+e)}),this.css("zIndex",c+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(d,b){var f=a(b.helper),c=a(this).data("ui-draggable").options;f.css("zIndex")&&(c._zIndex=f.css("zIndex")),f.css("zIndex",c.zIndex)},stop:function(c,b){var d=a(this).data("ui-draggable").options;d._zIndex&&a(b.helper).css("zIndex",d._zIndex)}})}($),
/*!
 * jQuery UI Resizable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/resizable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function(b){function c(d){return parseInt(d,10)||0}function a(d){return !isNaN(parseInt(d,10))}b.widget("ui.resizable",b.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var j,f,l,g,k,h=this,d=this.options;if(this.element.addClass("ui-resizable"),b.extend(this,{_aspectRatio:!!d.aspectRatio,aspectRatio:d.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:d.helper||d.ghost||d.animate?d.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(b("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=d.handles||(b(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String){for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),j=this.handles.split(","),this.handles={},f=0;f<j.length;f++){l=b.trim(j[f]),k="ui-resizable-"+l,g=b("<div class='ui-resizable-handle "+k+"'></div>"),g.css({zIndex:d.zIndex}),"se"===l&&g.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[l]=".ui-resizable-"+l,this.element.append(g)}}this._renderAxis=function(q){var m,t,p,r;q=q||this.element;for(m in this.handles){this.handles[m].constructor===String&&(this.handles[m]=b(this.handles[m],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(t=b(this.handles[m],this.element),r=/sw|ne|nw|se|n|s/.test(m)?t.outerHeight():t.outerWidth(),p=["padding",/ne|nw|n/.test(m)?"Top":/se|sw|s/.test(m)?"Bottom":/^e$/.test(m)?"Right":"Left"].join(""),q.css(p,r),this._proportionallyResize()),b(this.handles[m]).length}},this._renderAxis(this.element),this._handles=b(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){h.resizing||(this.className&&(g=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),h.axis=g&&g[1]?g[1]:"se")}),d.autoHide&&(this._handles.hide(),b(this.element).addClass("ui-resizable-autohide").mouseenter(function(){d.disabled||(b(this).removeClass("ui-resizable-autohide"),h._handles.show())}).mouseleave(function(){d.disabled||h.resizing||(b(this).addClass("ui-resizable-autohide"),h._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var f,d=function(g){b(g).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(d(this.element),f=this.element,this.originalElement.css({position:f.css("position"),width:f.outerWidth(),height:f.outerHeight(),top:f.css("top"),left:f.css("left")}).insertAfter(f),f.remove()),this.originalElement.css("resize",this.originalResizeStyle),d(this.originalElement),this},_mouseCapture:function(g){var d,h,f=!1;for(d in this.handles){h=b(this.handles[d])[0],(h===g.target||b.contains(h,g.target))&&(f=!0)}return !this.options.disabled&&f},_mouseStart:function(f){var k,g,j,h=this.options,e=this.element.position(),d=this.element;return this.resizing=!0,/absolute/.test(d.css("position"))?d.css({position:"absolute",top:d.css("top"),left:d.css("left")}):d.is(".ui-draggable")&&d.css({position:"absolute",top:e.top,left:e.left}),this._renderProxy(),k=c(this.helper.css("left")),g=c(this.helper.css("top")),h.containment&&(k+=b(h.containment).scrollLeft()||0,g+=b(h.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:k,top:g},this.size=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()},this.originalSize=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()},this.originalPosition={left:k,top:g},this.sizeDiff={width:d.outerWidth()-d.width(),height:d.outerHeight()-d.height()},this.originalMousePosition={left:f.pageX,top:f.pageY},this.aspectRatio="number"==typeof h.aspectRatio?h.aspectRatio:this.originalSize.width/this.originalSize.height||1,j=b(".ui-resizable-"+this.axis).css("cursor"),b("body").css("cursor","auto"===j?this.axis+"-resize":j),d.addClass("ui-resizable-resizing"),this._propagate("start",f),!0},_mouseDrag:function(v){var q,k=this.helper,A={},j=this.originalMousePosition,f=this.axis,y=this.position.top,m=this.position.left,t=this.size.width,x=this.size.height,z=v.pageX-j.left||0,w=v.pageY-j.top||0,g=this._change[f];return g?(q=g.apply(this,[v,z,w]),this._updateVirtualBoundaries(v.shiftKey),(this._aspectRatio||v.shiftKey)&&(q=this._updateRatio(q,v)),q=this._respectSize(q,v),this._updateCache(q),this._propagate("resize",v),this.position.top!==y&&(A.top=this.position.top+"px"),this.position.left!==m&&(A.left=this.position.left+"px"),this.size.width!==t&&(A.width=this.size.width+"px"),this.size.height!==x&&(A.height=this.size.height+"px"),k.css(A),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),b.isEmptyObject(A)||this._trigger("resize",v,this.ui()),!1):!1},_mouseStop:function(p){this.resizing=!1;var k,g,u,f,d,t,j,m=this.options,q=this;return this._helper&&(k=this._proportionallyResizeElements,g=k.length&&/textarea/i.test(k[0].nodeName),u=g&&b.ui.hasScroll(k[0],"left")?0:q.sizeDiff.height,f=g?0:q.sizeDiff.width,d={width:q.helper.width()-f,height:q.helper.height()-u},t=parseInt(q.element.css("left"),10)+(q.position.left-q.originalPosition.left)||null,j=parseInt(q.element.css("top"),10)+(q.position.top-q.originalPosition.top)||null,m.animate||this.element.css(b.extend(d,{top:j,left:t})),q.helper.height(q.size.height),q.helper.width(q.size.width),this._helper&&!m.animate&&this._proportionallyResize()),b("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",p),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(f){var i,k,g,j,h,d=this.options;h={minWidth:a(d.minWidth)?d.minWidth:0,maxWidth:a(d.maxWidth)?d.maxWidth:1/0,minHeight:a(d.minHeight)?d.minHeight:0,maxHeight:a(d.maxHeight)?d.maxHeight:1/0},(this._aspectRatio||f)&&(i=h.minHeight*this.aspectRatio,g=h.minWidth/this.aspectRatio,k=h.maxHeight*this.aspectRatio,j=h.maxWidth/this.aspectRatio,i>h.minWidth&&(h.minWidth=i),g>h.minHeight&&(h.minHeight=g),k<h.maxWidth&&(h.maxWidth=k),j<h.maxHeight&&(h.maxHeight=j)),this._vBoundaries=h},_updateCache:function(d){this.offset=this.helper.offset(),a(d.left)&&(this.position.left=d.left),a(d.top)&&(this.position.top=d.top),a(d.height)&&(this.size.height=d.height),a(d.width)&&(this.size.width=d.width)},_updateRatio:function(d){var g=this.position,h=this.size,f=this.axis;return a(d.height)?d.width=d.height*this.aspectRatio:a(d.width)&&(d.height=d.width/this.aspectRatio),"sw"===f&&(d.left=g.left+(h.width-d.width),d.top=null),"nw"===f&&(d.top=g.top+(h.height-d.height),d.left=g.left+(h.width-d.width)),d},_respectSize:function(v){var k=this._vBoundaries,g=this.axis,w=a(v.width)&&k.maxWidth&&k.maxWidth<v.width,f=a(v.height)&&k.maxHeight&&k.maxHeight<v.height,d=a(v.width)&&k.minWidth&&k.minWidth>v.width,p=a(v.height)&&k.minHeight&&k.minHeight>v.height,i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,m=/sw|nw|w/.test(g),q=/nw|ne|n/.test(g);return d&&(v.width=k.minWidth),p&&(v.height=k.minHeight),w&&(v.width=k.maxWidth),f&&(v.height=k.maxHeight),d&&m&&(v.left=i-k.minWidth),w&&m&&(v.left=i-k.maxWidth),p&&q&&(v.top=j-k.minHeight),f&&q&&(v.top=j-k.maxHeight),v.width||v.height||v.left||!v.top?v.width||v.height||v.top||!v.left||(v.left=null):v.top=null,v},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var f,h,d,k,g,j=this.helper||this.element;for(f=0;f<this._proportionallyResizeElements.length;f++){if(g=this._proportionallyResizeElements[f],!this.borderDif){for(this.borderDif=[],d=[g.css("borderTopWidth"),g.css("borderRightWidth"),g.css("borderBottomWidth"),g.css("borderLeftWidth")],k=[g.css("paddingTop"),g.css("paddingRight"),g.css("paddingBottom"),g.css("paddingLeft")],h=0;h<d.length;h++){this.borderDif[h]=(parseInt(d[h],10)||0)+(parseInt(k[h],10)||0)}}g.css({height:j.height()-this.borderDif[0]-this.borderDif[2]||0,width:j.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var f=this.element,d=this.options;this.elementOffset=f.offset(),this._helper?(this.helper=this.helper||b("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++d.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(d,f){return{width:this.originalSize.width+f}},w:function(f,g){var d=this.originalSize,h=this.originalPosition;return{left:h.left+g,width:d.width-g}},n:function(f,h,d){var j=this.originalSize,g=this.originalPosition;return{top:g.top+d,height:j.height-d}},s:function(f,g,d){return{height:this.originalSize.height+d}},se:function(f,d,g){return b.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[f,d,g]))},sw:function(f,d,g){return b.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[f,d,g]))},ne:function(f,d,g){return b.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[f,d,g]))},nw:function(f,d,g){return b.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[f,d,g]))}},_propagate:function(f,d){b.ui.plugin.call(this,f,[d,this.ui()]),"resize"!==f&&this._trigger(f,d,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),b.ui.plugin.add("resizable","animate",{stop:function(p){var k=b(this).data("ui-resizable"),g=k.options,u=k._proportionallyResizeElements,f=u.length&&/textarea/i.test(u[0].nodeName),d=f&&b.ui.hasScroll(u[0],"left")?0:k.sizeDiff.height,t=f?0:k.sizeDiff.width,j={width:k.size.width-t,height:k.size.height-d},m=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,q=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null;k.element.animate(b.extend(j,q&&m?{top:q,left:m}:{}),{duration:g.animateDuration,easing:g.animateEasing,step:function(){var e={width:parseInt(k.element.css("width"),10),height:parseInt(k.element.css("height"),10),top:parseInt(k.element.css("top"),10),left:parseInt(k.element.css("left"),10)};u&&u.length&&b(u[0]).css({width:e.width,height:e.height}),k._updateCache(e),k._propagate("resize",p)}})}}),b.ui.plugin.add("resizable","containment",{start:function(){var m,j,y,g,e,w,k,q=b(this).data("ui-resizable"),v=q.options,x=q.element,t=v.containment,f=t instanceof b?t.get(0):/parent/.test(t)?x.parent().get(0):t;f&&(q.containerElement=b(f),/document/.test(t)||t===document?(q.containerOffset={left:0,top:0},q.containerPosition={left:0,top:0},q.parentData={element:b(document),left:0,top:0,width:b(document).width(),height:b(document).height()||document.body.parentNode.scrollHeight}):(m=b(f),j=[],b(["Top","Right","Left","Bottom"]).each(function(d,h){j[d]=c(m.css("padding"+h))}),q.containerOffset=m.offset(),q.containerPosition=m.position(),q.containerSize={height:m.innerHeight()-j[3],width:m.innerWidth()-j[1]},y=q.containerOffset,g=q.containerSize.height,e=q.containerSize.width,w=b.ui.hasScroll(f,"left")?f.scrollWidth:e,k=b.ui.hasScroll(f)?f.scrollHeight:g,q.parentData={element:f,left:y.left,top:y.top,width:w,height:k}))},resize:function(q){var m,j,y,g,f=b(this).data("ui-resizable"),w=f.options,k=f.containerOffset,p=f.position,v=f._aspectRatio||q.shiftKey,x={top:0,left:0},t=f.containerElement;t[0]!==document&&/static/.test(t.css("position"))&&(x=k),p.left<(f._helper?k.left:0)&&(f.size.width=f.size.width+(f._helper?f.position.left-k.left:f.position.left-x.left),v&&(f.size.height=f.size.width/f.aspectRatio),f.position.left=w.helper?k.left:0),p.top<(f._helper?k.top:0)&&(f.size.height=f.size.height+(f._helper?f.position.top-k.top:f.position.top),v&&(f.size.width=f.size.height*f.aspectRatio),f.position.top=f._helper?k.top:0),f.offset.left=f.parentData.left+f.position.left,f.offset.top=f.parentData.top+f.position.top,m=Math.abs((f._helper?f.offset.left-x.left:f.offset.left-x.left)+f.sizeDiff.width),j=Math.abs((f._helper?f.offset.top-x.top:f.offset.top-k.top)+f.sizeDiff.height),y=f.containerElement.get(0)===f.element.parent().get(0),g=/relative|absolute/.test(f.containerElement.css("position")),y&&g&&(m-=f.parentData.left),m+f.size.width>=f.parentData.width&&(f.size.width=f.parentData.width-m,v&&(f.size.height=f.size.width/f.aspectRatio)),j+f.size.height>=f.parentData.height&&(f.size.height=f.parentData.height-j,v&&(f.size.width=f.size.height*f.aspectRatio))},stop:function(){var p=b(this).data("ui-resizable"),k=p.options,g=p.containerOffset,t=p.containerPosition,f=p.containerElement,d=b(p.helper),q=d.offset(),j=d.outerWidth()-p.sizeDiff.width,m=d.outerHeight()-p.sizeDiff.height;p._helper&&!k.animate&&/relative/.test(f.css("position"))&&b(this).css({left:q.left-t.left-g.left,width:j,height:m}),p._helper&&!k.animate&&/static/.test(f.css("position"))&&b(this).css({left:q.left-t.left-g.left,width:j,height:m})}}),b.ui.plugin.add("resizable","alsoResize",{start:function(){var f=b(this).data("ui-resizable"),d=f.options,g=function(h){b(h).each(function(){var i=b(this);i.data("ui-resizable-alsoresize",{width:parseInt(i.width(),10),height:parseInt(i.height(),10),left:parseInt(i.css("left"),10),top:parseInt(i.css("top"),10)})})};"object"!=typeof d.alsoResize||d.alsoResize.parentNode?g(d.alsoResize):d.alsoResize.length?(d.alsoResize=d.alsoResize[0],g(d.alsoResize)):b.each(d.alsoResize,function(e){g(e)})},resize:function(k,g){var p=b(this).data("ui-resizable"),h=p.options,m=p.originalSize,j=p.originalPosition,f={height:p.size.height-m.height||0,width:p.size.width-m.width||0,top:p.position.top-j.top||0,left:p.position.left-j.left||0},d=function(i,l){b(i).each(function(){var t=b(this),n=b(this).data("ui-resizable-alsoresize"),u={},q=l&&l.length?l:t.parents(g.originalElement[0]).length?["width","height"]:["width","height","top","left"];b.each(q,function(r,s){var o=(n[s]||0)+(f[s]||0);o&&o>=0&&(u[s]=o||null)}),t.css(u)})};"object"!=typeof h.alsoResize||h.alsoResize.nodeType?d(h.alsoResize):b.each(h.alsoResize,function(i,l){d(i,l)})},stop:function(){b(this).removeData("resizable-alsoresize")}}),b.ui.plugin.add("resizable","ghost",{start:function(){var f=b(this).data("ui-resizable"),d=f.options,g=f.size;f.ghost=f.originalElement.clone(),f.ghost.css({opacity:0.25,display:"block",position:"relative",height:g.height,width:g.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof d.ghost?d.ghost:""),f.ghost.appendTo(f.helper)},resize:function(){var d=b(this).data("ui-resizable");d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(){var d=b(this).data("ui-resizable");d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}}),b.ui.plugin.add("resizable","grid",{resize:function(){var C=b(this).data("ui-resizable"),y=C.options,t=C.size,I=C.originalSize,q=C.originalPosition,j=C.axis,F="number"==typeof y.grid?[y.grid,y.grid]:y.grid,x=F[0]||1,z=F[1]||1,E=Math.round((t.width-I.width)/x)*x,H=Math.round((t.height-I.height)/z)*z,D=I.width+E,k=I.height+H,B=y.maxWidth&&y.maxWidth<D,w=y.maxHeight&&y.maxHeight<k,A=y.minWidth&&y.minWidth>D,G=y.minHeight&&y.minHeight>k;y.grid=F,A&&(D+=x),G&&(k+=z),B&&(D-=x),w&&(k-=z),/^(se|s|e)$/.test(j)?(C.size.width=D,C.size.height=k):/^(ne)$/.test(j)?(C.size.width=D,C.size.height=k,C.position.top=q.top-H):/^(sw)$/.test(j)?(C.size.width=D,C.size.height=k,C.position.left=q.left-E):(C.size.width=D,C.size.height=k,C.position.top=q.top-H,C.position.left=q.left-E)}})}($),
/*!
 * jQuery UI Dialog 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/dialog/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */
function(b){var c={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},a={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};b.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(f){var d=b(this).css(f).offset().top;0>d&&b(this).css("top",f.top-d)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&b.fn.draggable&&this._makeDraggable(),this.options.resizable&&b.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var d=this.options.appendTo;return d&&(d.jquery||d.nodeType)?b(d):this.document.find(d||"body").eq(0)},_destroy:function(){var d,f=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),d=f.parent.children().eq(f.index),d.length&&d[0]!==this.element[0]?d.before(this.element):f.parent.append(this.element)},widget:function(){return this.uiDialog},disable:b.noop,enable:b.noop,close:function(f){var d=this;this._isOpen&&this._trigger("beforeClose",f)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||b(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){d._trigger("close",f)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(f,g){var d=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return d&&!g&&this._trigger("focus",f),d},open:function(){var d=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=b(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){d._focusTabbable(),d._trigger("focus")}),this._trigger("open"),void 0)},_focusTabbable:function(){var d=this.element.find("[autofocus]");d.length||(d=this.element.find(":tabbable")),d.length||(d=this.uiDialogButtonPane.find(":tabbable")),d.length||(d=this.uiDialogTitlebarClose.filter(":tabbable")),d.length||(d=this.uiDialog),d.eq(0).focus()},_keepFocus:function(f){function d(){var h=this.document[0].activeElement,g=this.uiDialog[0]===h||b.contains(this.uiDialog[0],h);g||this._focusTabbable()}f.preventDefault(),d.call(this),this._delay(d)},_createWrapper:function(){this.uiDialog=b("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(g){if(this.options.closeOnEscape&&!g.isDefaultPrevented()&&g.keyCode&&g.keyCode===b.ui.keyCode.ESCAPE){return g.preventDefault(),this.close(g),void 0}if(g.keyCode===b.ui.keyCode.TAB){var d=this.uiDialog.find(":tabbable"),h=d.filter(":first"),f=d.filter(":last");g.target!==f[0]&&g.target!==this.uiDialog[0]||g.shiftKey?g.target!==h[0]&&g.target!==this.uiDialog[0]||!g.shiftKey||(f.focus(1),g.preventDefault()):(h.focus(1),g.preventDefault())}},mousedown:function(d){this._moveToTop(d)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var d;this.uiDialogTitlebar=b("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(f){b(f.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=b("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),d=b("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(d),this.uiDialog.attr({"aria-labelledby":d.attr("id")})},_title:function(d){this.options.title||d.html("&#160;"),d.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=b("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=b("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var f=this,d=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),b.isEmptyObject(d)||b.isArray(d)&&!d.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(b.each(d,function(e,j){var g,h;j=b.isFunction(j)?{click:j,text:e}:j,j=b.extend({type:"button"},j),g=j.click,j.click=function(){g.apply(f.element[0],arguments)},h={icons:j.icons,text:j.showText},delete j.icons,delete j.showText,b("<button></button>",j).button(h).appendTo(f.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function f(e){return{position:e.position,offset:e.offset}}var d=this,g=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(h,e){b(this).addClass("ui-dialog-dragging"),d._blockFrames(),d._trigger("dragStart",h,f(e))},drag:function(e,h){d._trigger("drag",e,f(h))},stop:function(e,h){g.position=[h.position.left-d.document.scrollLeft(),h.position.top-d.document.scrollTop()],b(this).removeClass("ui-dialog-dragging"),d._unblockFrames(),d._trigger("dragStop",e,f(h))}})},_makeResizable:function(){function h(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var d=this,k=this.options,f=k.resizable,j=this.uiDialog.css("position"),g="string"==typeof f?f:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:k.maxWidth,maxHeight:k.maxHeight,minWidth:k.minWidth,minHeight:this._minHeight(),handles:g,start:function(i,e){b(this).addClass("ui-dialog-resizing"),d._blockFrames(),d._trigger("resizeStart",i,h(e))},resize:function(e,i){d._trigger("resize",e,h(i))},stop:function(e,i){k.height=b(this).height(),k.width=b(this).width(),b(this).removeClass("ui-dialog-resizing"),d._unblockFrames(),d._trigger("resizeStop",e,h(i))}}).css("position",j)},_minHeight:function(){var d=this.options;return"auto"===d.height?d.minHeight:Math.min(d.minHeight,d.height)},_position:function(){var d=this.uiDialog.is(":visible");d||this.uiDialog.show(),this.uiDialog.position(this.options.position),d||this.uiDialog.hide()},_setOptions:function(g){var d=this,f=!1,e={};b.each(g,function(h,i){d._setOption(h,i),h in c&&(f=!0),h in a&&(e[h]=i)}),f&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",e)},_setOption:function(f,h){var d,j,g=this.uiDialog;"dialogClass"===f&&g.removeClass(this.options.dialogClass).addClass(h),"disabled"!==f&&(this._super(f,h),"appendTo"===f&&this.uiDialog.appendTo(this._appendTo()),"buttons"===f&&this._createButtons(),"closeText"===f&&this.uiDialogTitlebarClose.button({label:""+h}),"draggable"===f&&(d=g.is(":data(ui-draggable)"),d&&!h&&g.draggable("destroy"),!d&&h&&this._makeDraggable()),"position"===f&&this._position(),"resizable"===f&&(j=g.is(":data(ui-resizable)"),j&&!h&&g.resizable("destroy"),j&&"string"==typeof h&&g.resizable("option","handles",h),j||h===!1||this._makeResizable()),"title"===f&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var f,g,d,h=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),h.minWidth>h.width&&(h.width=h.minWidth),f=this.uiDialog.css({height:"auto",width:h.width}).outerHeight(),g=Math.max(0,h.minHeight-f),d="number"==typeof h.maxHeight?Math.max(0,h.maxHeight-f):"none","auto"===h.height?this.element.css({minHeight:g,maxHeight:d,height:"auto"}):this.element.height(Math.max(0,h.height-f)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var d=b(this);return b("<div>").css({position:"absolute",width:d.outerWidth(),height:d.outerHeight()}).appendTo(d.parent()).offset(d.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(d){return b(d.target).closest(".ui-dialog").length?!0:!!b(d.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var f=this,d=this.widgetFullName;b.ui.dialog.overlayInstances||this._delay(function(){b.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(e){f._allowInteraction(e)||(e.preventDefault(),b(".ui-dialog:visible:last .ui-dialog-content").data(d)._focusTabbable())})}),this.overlay=b("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),b.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(b.ui.dialog.overlayInstances--,b.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),b.ui.dialog.overlayInstances=0,b.uiBackCompat!==!1&&b.widget("ui.dialog",b.ui.dialog,{_position:function(){var g,d=this.options.position,h=[],f=[0,0];d?(("string"==typeof d||"object"==typeof d&&"0" in d)&&(h=d.split?d.split(" "):[d[0],d[1]],1===h.length&&(h[1]=h[0]),b.each(["left","top"],function(i,j){+h[i]===h[i]&&(f[i]=h[i],h[i]=j)}),d={my:h[0]+(f[0]<0?f[0]:"+"+f[0])+" "+h[1]+(f[1]<0?f[1]:"+"+f[1]),at:h.join(" ")}),d=b.extend({},b.ui.dialog.prototype.options.position,d)):d=b.ui.dialog.prototype.options.position,g=this.uiDialog.is(":visible"),g||this.uiDialog.show(),this.uiDialog.position(d),g||this.uiDialog.hide()}})}($),
/*!
 * jQuery UI Droppable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
function(a){function b(d,f,c){return d>f&&f+c>d}a.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var d=this.options,c=d.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(c)?c:function(e){return e.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[d.scope]=a.ui.ddmanager.droppables[d.scope]||[],a.ui.ddmanager.droppables[d.scope].push(this),d.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var d=0,c=a.ui.ddmanager.droppables[this.options.scope];d<c.length;d++){c[d]===this&&c.splice(d,1)}this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(d,c){"accept"===d&&(this.accept=a.isFunction(c)?c:function(e){return e.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(d){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",d,this.ui(c))},_deactivate:function(d){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",d,this.ui(c))},_over:function(d){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",d,this.ui(c)))},_out:function(d){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",d,this.ui(c)))},_drop:function(f,c){var g=c||a.ui.ddmanager.current,d=!1;return g&&(g.currentItem||g.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var h=a.data(this,"ui-droppable");return h.options.greedy&&!h.options.disabled&&h.options.scope===g.options.scope&&h.accept.call(h.element[0],g.currentItem||g.element)&&a.ui.intersect(g,a.extend(h,{offset:h.element.offset()}),h.options.tolerance)?(d=!0,!1):void 0}),d?!1:this.accept.call(this.element[0],g.currentItem||g.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",f,this.ui(g)),this.element):!1):!1},ui:function(c){return{draggable:c.currentItem||c.element,helper:c.helper,position:c.position,offset:c.positionAbs}}}),a.ui.intersect=function(z,m,j){if(!m.offset){return !1}var A,g,e=(z.positionAbs||z.position.absolute).left,x=e+z.helperProportions.width,k=(z.positionAbs||z.position.absolute).top,q=k+z.helperProportions.height,w=m.offset.left,y=w+m.proportions.width,v=m.offset.top,f=v+m.proportions.height;switch(j){case"fit":return e>=w&&y>=x&&k>=v&&f>=q;case"intersect":return w<e+z.helperProportions.width/2&&x-z.helperProportions.width/2<y&&v<k+z.helperProportions.height/2&&q-z.helperProportions.height/2<f;case"pointer":return A=(z.positionAbs||z.position.absolute).left+(z.clickOffset||z.offset.click).left,g=(z.positionAbs||z.position.absolute).top+(z.clickOffset||z.offset.click).top,b(g,v,m.proportions.height)&&b(A,w,m.proportions.width);case"touch":return(k>=v&&f>=k||q>=v&&f>=q||v>k&&q>f)&&(e>=w&&y>=e||x>=w&&y>=x||w>e&&x>y);default:return !1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(h,d){var k,f,j=a.ui.ddmanager.droppables[h.options.scope]||[],g=d?d.type:null,c=(h.currentItem||h.element).find(":data(ui-droppable)").addBack();a:for(k=0;k<j.length;k++){if(!(j[k].options.disabled||h&&!j[k].accept.call(j[k].element[0],h.currentItem||h.element))){for(f=0;f<c.length;f++){if(c[f]===j[k].element[0]){j[k].proportions.height=0;continue a}}j[k].visible="none"!==j[k].element.css("display"),j[k].visible&&("mousedown"===g&&j[k]._activate.call(j[k],d),j[k].offset=j[k].element.offset(),j[k].proportions={width:j[k].element[0].offsetWidth,height:j[k].element[0].offsetHeight})}}},drop:function(d,c){var f=!1;return a.each((a.ui.ddmanager.droppables[d.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(d,this,this.options.tolerance)&&(f=this._drop.call(this,c)||f),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),f},dragStart:function(d,c){d.element.parentsUntil("body").bind("scroll.droppable",function(){d.options.refreshPositions||a.ui.ddmanager.prepareOffsets(d,c)})},drag:function(d,c){d.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(d,c),a.each(a.ui.ddmanager.droppables[d.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var i,f,h,g=a.ui.intersect(d,this,this.options.tolerance),e=!g&&this.isover?"isout":g&&!this.isover?"isover":null;e&&(this.options.greedy&&(f=this.options.scope,h=this.element.parents(":data(ui-droppable)").filter(function(){return a.data(this,"ui-droppable").options.scope===f}),h.length&&(i=a.data(h[0],"ui-droppable"),i.greedyChild="isover"===e)),i&&"isover"===e&&(i.isover=!1,i.isout=!0,i._out.call(i,c)),this[e]=!0,this["isout"===e?"isover":"isout"]=!1,this["isover"===e?"_over":"_out"].call(this,c),i&&"isout"===e&&(i.isout=!1,i.isover=!0,i._over.call(i,c)))}})},dragStop:function(d,c){d.element.parentsUntil("body").unbind("scroll.droppable"),d.options.refreshPositions||a.ui.ddmanager.prepareOffsets(d,c)}}}($),
/*!
 * jQuery UI Effects 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/effects-core/
 */
function(b,c){var a="ui-effects-";b.effects={effect:{}},
/*!
   * jQuery Color Animations v2.1.2
   * https://github.com/jquery/jquery-color
   *
   * Copyright 2013 jQuery Foundation and other contributors
   * Released under the MIT license.
   * http://jquery.org/license
   *
   * Date: Wed Jan 16 08:47:09 2013 -0600
   */
function(D,y){function v(f,h,d){var l=C[h.type]||{};return null==f?d||!h.def?null:h.def:(f=l.floor?~~f:parseFloat(f),isNaN(f)?h.def:l.mod?(f+l.mod)%l.mod:0>f?0:l.max<f?l.max:f)}function m(f){var d=w(),h=d._rgba=[];return f=f.toLowerCase(),x(q,function(n,p){var F,u=p.re.exec(f),i=u&&p.parse(u),e=p.space||"rgba";return i?(F=d[e](i),d[A[e].cache]=F[A[e].cache],h=d._rgba=F._rgba,!1):void 0}),h.length?("0,0,0,0"===h.join()&&D.extend(h,k.transparent),d):k[f]}function E(f,h,d){return d=(d+1)%1,1>6*d?f+6*(h-f)*d:1>2*d?h:2>3*d?f+6*(h-f)*(2/3-d):f}var k,g="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",B=/^([\-+])=\s*(\d+\.?\d*)/,q=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(d){return[d[1],d[2],d[3],d[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(d){return[2.55*d[1],2.55*d[2],2.55*d[3],d[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(d){return[d[1],d[2]/100,d[3]/100,d[4]]}}],w=D.Color=function(h,d,l,f){return new D.Color.fn.parse(h,d,l,f)},A={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},C={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},z=w.support={},j=D("<p>")[0],x=D.each;j.style.cssText="background-color:rgba(1,1,1,.5)",z.rgba=j.style.backgroundColor.indexOf("rgba")>-1,x(A,function(d,f){f.cache="_"+d,f.props.alpha={idx:3,type:"percent",def:1}}),w.fn=D.extend(w.prototype,{parse:function(i,n,f,e){if(i===y){return this._rgba=[null,null,null,null],this}(i.jquery||i.nodeType)&&(i=D(i).css(n),n=y);var h=this,t=D.type(i),o=this._rgba=[];return n!==y&&(i=[i,n,f,e],t="array"),"string"===t?this.parse(m(i)||k._default):"array"===t?(x(A.rgba.props,function(d,l){o[l.idx]=v(i[l.idx],l)}),this):"object"===t?(i instanceof w?x(A,function(d,l){i[l.cache]&&(h[l.cache]=i[l.cache].slice())}):x(A,function(d,p){var l=p.cache;x(p.props,function(r,s){if(!h[l]&&p.to){if("alpha"===r||null==i[r]){return}h[l]=p.to(h._rgba)}h[l][s.idx]=v(i[r],s,!0)}),h[l]&&D.inArray(null,h[l].slice(0,3))<0&&(h[l][3]=1,p.from&&(h._rgba=p.from(h[l])))}),this):void 0},is:function(f){var h=w(f),d=!0,l=this;return x(A,function(e,i){var p,n=h[i.cache];return n&&(p=l[i.cache]||i.to&&i.to(l._rgba)||[],x(i.props,function(o,r){return null!=n[r.idx]?d=n[r.idx]===p[r.idx]:void 0})),d}),d},_space:function(){var d=[],f=this;return x(A,function(e,h){f[h.cache]&&d.push(e)}),d.pop()},transition:function(h,u){var G=w(h),i=G._space(),F=A[i],p=0===this.alpha()?w("transparent"):this,f=p[F.cache]||F.to(p._rgba),d=f.slice();return G=G[F.cache],x(F.props,function(e,n){var I=n.idx,H=f[I],l=G[I],J=C[n.type]||{};null!==l&&(null===H?d[I]=l:(J.mod&&(l-H>J.mod/2?H+=J.mod:H-l>J.mod/2&&(H-=J.mod)),d[I]=v((l-H)*u+H,n)))}),this[i](d)},blend:function(h){if(1===this._rgba[3]){return this}var d=this._rgba.slice(),l=d.pop(),f=w(h)._rgba;return w(D.map(d,function(i,n){return(1-l)*f[n]+l*i}))},toRgbaString:function(){var f="rgba(",d=D.map(this._rgba,function(h,i){return null==h?i>2?1:0:h});return 1===d[3]&&(d.pop(),f="rgb("),f+d.join()+")"},toHslaString:function(){var f="hsla(",d=D.map(this.hsla(),function(h,i){return null==h&&(h=i>2?1:0),i&&3>i&&(h=Math.round(100*h)+"%"),h});return 1===d[3]&&(d.pop(),f="hsl("),f+d.join()+")"},toHexString:function(f){var d=this._rgba.slice(),h=d.pop();return f&&d.push(~~(255*h)),"#"+D.map(d,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),w.fn.parse.prototype=w.fn,A.hsla.to=function(M){if(null==M[0]||null==M[1]||null==M[2]){return[null,null,null,M[3]]}var I,G,p=M[0]/255,N=M[1]/255,f=M[2]/255,d=M[3],K=Math.max(p,N,f),F=Math.min(p,N,f),H=K-F,J=K+F,L=0.5*J;return I=F===K?0:p===K?60*(N-f)/H+360:N===K?60*(f-p)/H+120:60*(p-N)/H+240,G=0===H?0:0.5>=L?H/J:H/(2-J),[Math.round(I)%360,G,L,null==d?1:d]},A.hsla.from=function(h){if(null==h[0]||null==h[1]||null==h[2]){return[null,null,null,h[3]]}var p=h[0]/360,f=h[1],u=h[2],s=h[3],l=0.5>=u?u*(1+f):u+f-u*f,d=2*u-l;return[Math.round(255*E(d,l,p+1/3)),Math.round(255*E(d,l,p)),Math.round(255*E(d,l,p-1/3)),s]},x(A,function(p,e){var h=e.props,f=e.cache,d=e.to,i=e.from;w.fn[p]=function(F){if(d&&!this[f]&&(this[f]=d(this._rgba)),F===y){return this[f].slice()}var r,l=D.type(F),o="array"===l||"object"===l?F:arguments,t=this[f].slice();return x(h,function(s,u){var G=o["object"===l?s:u.idx];null==G&&(G=t[u.idx]),t[u.idx]=v(G,u)}),i?(r=w(i(t)),r[f]=t,r):w(t)},x(h,function(n,l){w.fn[n]||(w.fn[n]=function(F){var H,G=D.type(F),t="alpha"===n?this._hsla?"hsla":"rgba":p,u=this[t](),I=u[l.idx];return"undefined"===G?I:("function"===G&&(F=F.call(this,I),G=D.type(F)),null==F&&l.empty?this:("string"===G&&(H=B.exec(F),H&&(F=I+parseFloat(H[2])*("+"===H[1]?1:-1))),u[l.idx]=F,this[t](u)))})})}),w.hook=function(f){var d=f.split(" ");x(d,function(l,h){D.cssHooks[h]={set:function(u,p){var F,t,n="";if("transparent"!==p&&("string"!==D.type(p)||(F=m(p)))){if(p=w(F||p),!z.rgba&&1!==p._rgba[3]){for(t="backgroundColor"===h?u.parentNode:u;(""===n||"transparent"===n)&&t&&t.style;){try{n=D.css(t,"backgroundColor"),t=t.parentNode}catch(i){}}p=p.blend(n&&"transparent"!==n?n:"_default")}p=p.toRgbaString()}try{u.style[h]=p}catch(i){}}},D.fx.step[h]=function(i){i.colorInit||(i.start=w(i.elem,h),i.end=w(i.end),i.colorInit=!0),D.cssHooks[h].set(i.elem,i.start.transition(i.end,i.pos))}})},w.hook(g),D.cssHooks.borderColor={expand:function(d){var f={};return x(["Top","Right","Bottom","Left"],function(e,h){f["border"+h+"Color"]=d}),f}},k=D.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}($),function(){function d(k){var h,m,j=k.ownerDocument.defaultView?k.ownerDocument.defaultView.getComputedStyle(k,null):k.currentStyle,l={};if(j&&j.length&&j[0]&&j[j[0]]){for(m=j.length;m--;){h=j[m],"string"==typeof j[h]&&(l[b.camelCase(h)]=j[h])}}else{for(h in j){"string"==typeof j[h]&&(l[h]=j[h])}}return l}function g(l,h){var m,j,k={};for(m in h){j=h[m],l[m]!==j&&(f[m]||(b.fx.step[m]||!isNaN(parseFloat(j)))&&(k[m]=j))}return k}var e=["add","remove","toggle"],f={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};b.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(j,h){b.fx.step[h]=function(i){("none"!==i.end&&!i.setAttr||1===i.pos&&!i.setAttr)&&($.style(i.elem,h,i.end),i.setAttr=!0)}}),b.fn.addBack||(b.fn.addBack=function(h){return this.add(null==h?this.prevObject:this.prevObject.filter(h))}),b.effects.animateClass=function(k,m,j,i){var h=b.speed(m,j,i);return this.queue(function(){var q,p=b(this),l=p.attr("class")||"",n=h.children?p.find("*").addBack():p;n=n.map(function(){var o=b(this);return{el:o,start:d(this)}}),q=function(){b.each(e,function(r,o){k[o]&&p[o+"Class"](k[o])})},q(),n=n.map(function(){return this.end=d(this.el[0]),this.diff=g(this.start,this.end),this}),p.attr("class",l),n=n.map(function(){var r=this,o=b.Deferred(),s=b.extend({},h,{queue:!1,complete:function(){o.resolve(r)}});return this.el.animate(this.diff,s),o.promise()}),b.when.apply(b,n.get()).done(function(){q(),b.each(arguments,function(){var o=this.el;b.each(this.diff,function(r){o.css(r,"")})}),h.complete.call(p[0])})})},b.fn.extend({addClass:function(h){return function(j,m,k,l){return m?b.effects.animateClass.call(this,{add:j},m,k,l):h.apply(this,arguments)}}(b.fn.addClass),removeClass:function(h){return function(j,m,k,l){return arguments.length>1?b.effects.animateClass.call(this,{remove:j},m,k,l):h.apply(this,arguments)}}(b.fn.removeClass),toggleClass:function(h){return function(m,j,l,k,i){return"boolean"==typeof j||j===c?l?b.effects.animateClass.call(this,j?{add:m}:{remove:m},l,k,i):h.apply(this,arguments):b.effects.animateClass.call(this,{toggle:m},j,l,k)}}(b.fn.toggleClass),switchClass:function(k,h,m,j,l){return b.effects.animateClass.call(this,{add:h,remove:k},m,j,l)}})}(),function(){function e(h,f,j,g){return b.isPlainObject(h)&&(f=h,h=h.effect),h={effect:h},null==f&&(f={}),b.isFunction(f)&&(g=f,j=null,f={}),("number"==typeof f||b.fx.speeds[f])&&(g=j,j=f,f={}),b.isFunction(j)&&(g=j,j=null),f&&b.extend(h,f),j=j||f.duration,h.duration=b.fx.off?0:"number"==typeof j?j:j in b.fx.speeds?b.fx.speeds[j]:b.fx.speeds._default,h.complete=g||f.complete,h}function d(f){return !f||"number"==typeof f||b.fx.speeds[f]?!0:"string"!=typeof f||b.effects.effect[f]?b.isFunction(f)?!0:"object"!=typeof f||f.effect?!1:!0:!0}b.extend(b.effects,{version:"1.10.3",save:function(f,g){for(var h=0;h<g.length;h++){null!==g[h]&&f.data(a+g[h],f[0].style[g[h]])}},restore:function(f,i){var g,h;for(h=0;h<i.length;h++){null!==i[h]&&(g=f.data(a+i[h]),g===c&&(g=""),f.css(i[h],g))}},setMode:function(f,g){return"toggle"===g&&(g=f.is(":hidden")?"show":"hide"),g},getBaseline:function(g,h){var f,j;switch(g[0]){case"top":f=0;break;case"middle":f=0.5;break;case"bottom":f=1;break;default:f=g[0]/h.height}switch(g[1]){case"left":j=0;break;case"center":j=0.5;break;case"right":j=1;break;default:j=g[1]/h.width}return{x:j,y:f}},createWrapper:function(j){if(j.parent().is(".ui-effects-wrapper")){return j.parent()}var f={width:j.outerWidth(!0),height:j.outerHeight(!0),"float":j.css("float")},l=b("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),g={width:j.width(),height:j.height()},k=document.activeElement;try{k.id}catch(h){k=document.body}return j.wrap(l),(j[0]===k||b.contains(j[0],k))&&b(k).focus(),l=j.parent(),"static"===j.css("position")?(l.css({position:"relative"}),j.css({position:"relative"})):(b.extend(f,{position:j.css("position"),zIndex:j.css("z-index")}),b.each(["top","left","bottom","right"],function(i,m){f[m]=j.css(m),isNaN(parseInt(f[m],10))&&(f[m]="auto")}),j.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),j.css(g),l.css(f).show()},removeWrapper:function(g){var f=document.activeElement;return g.parent().is(".ui-effects-wrapper")&&(g.parent().replaceWith(g),(g[0]===f||b.contains(g[0],f))&&b(f).focus()),g},setTransition:function(h,f,j,g){return g=g||{},b.each(f,function(l,k){var m=h.cssUnit(k);m[0]>0&&(g[k]=m[0]*j+m[1])}),g}}),b.fn.extend({effect:function(){function j(m){function q(){b.isFunction(p)&&p.call(l[0]),b.isFunction(m)&&m()}var l=b(this),p=f.complete,i=f.mode;(l.is(":hidden")?"hide"===i:"show"===i)?(l[i](),q()):h.call(l[0],f,q)}var f=e.apply(this,arguments),g=f.mode,k=f.queue,h=b.effects.effect[f.effect];return b.fx.off||!h?g?this[g](f.duration,f.complete):this.each(function(){f.complete&&f.complete.call(this)}):k===!1?this.each(j):this.queue(k||"fx",j)},show:function(f){return function(h){if(d(h)){return f.apply(this,arguments)}var g=e.apply(this,arguments);return g.mode="show",this.effect.call(this,g)}}(b.fn.show),hide:function(f){return function(h){if(d(h)){return f.apply(this,arguments)}var g=e.apply(this,arguments);return g.mode="hide",this.effect.call(this,g)}}(b.fn.hide),toggle:function(f){return function(h){if(d(h)||"boolean"==typeof h){return f.apply(this,arguments)}var g=e.apply(this,arguments);return g.mode="toggle",this.effect.call(this,g)}}(b.fn.toggle),cssUnit:function(g){var f=this.css(g),h=[];return b.each(["em","px","%","pt"],function(i,j){f.indexOf(j)>0&&(h=[parseFloat(f),j])}),h}})}(),function(){var d={};b.each(["Quad","Cubic","Quart","Quint","Expo"],function(f,e){d[e]=function(g){return Math.pow(g,f+2)}}),b.extend(d,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(g){for(var h,f=4;g<((h=Math.pow(2,--f))-1)/11;){}return 1/Math.pow(4,3-f)-7.5625*Math.pow((3*h-2)/22-g,2)}}),b.each(d,function(g,f){b.easing["easeIn"+g]=f,b.easing["easeOut"+g]=function(e){return 1-f(1-e)},b.easing["easeInOut"+g]=function(e){return 0.5>e?f(2*e)/2:1-f(-2*e+2)/2}})}()}($),
/*!
 * jQuery UI Effects Blind 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/blind-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(b){var c=/up|down|vertical/,a=/up|left|vertical|horizontal/;b.effects.effect.blind=function(k,E){var j,e,B,t=b(this),w=["position","top","bottom","left","right","height","width"],A=b.effects.setMode(t,k.mode||"hide"),D=k.direction||"up",z=c.test(D),i=z?"height":"width",y=z?"top":"left",q=a.test(D),x={},C="show"===A;t.parent().is(".ui-effects-wrapper")?b.effects.save(t.parent(),w):b.effects.save(t,w),t.show(),j=b.effects.createWrapper(t).css({overflow:"hidden"}),e=j[i](),B=parseFloat(j.css(y))||0,x[i]=C?e:0,q||(t.css(z?"bottom":"right",0).css(z?"top":"left","auto").css({position:"absolute"}),x[y]=C?B:e+B),C&&(j.css(i,0),q||j.css(y,B+e)),j.animate(x,{duration:k.duration,easing:k.easing,queue:!1,complete:function(){"hide"===A&&t.hide(),b.effects.restore(t,w),b.effects.removeWrapper(t),E()}})}}($),
/*!
 * jQuery UI Effects Bounce 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/bounce-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.bounce=function(H,D){var A,t,z,w=a(this),L=["position","top","bottom","left","right","height","width"],C=a.effects.setMode(w,H.mode||"effect"),E="hide"===C,J="show"===C,q=H.direction||"up",I=H.distance,x=H.times||5,G=2*x+(J||E?1:0),B=H.duration/G,F=H.easing,k="up"===q||"down"===q?"top":"left",j="up"===q||"left"===q,K=w.queue(),M=K.length;for((J||E)&&L.push("opacity"),a.effects.save(w,L),w.show(),a.effects.createWrapper(w),I||(I=w["top"===k?"outerHeight":"outerWidth"]()/3),J&&(z={opacity:1},z[k]=0,w.css("opacity",0).css(k,j?2*-I:2*I).animate(z,B,F)),E&&(I/=Math.pow(2,x-1)),z={},z[k]=0,A=0;x>A;A++){t={},t[k]=(j?"-=":"+=")+I,w.animate(t,B,F).animate(z,B,F),I=E?2*I:I/2}E&&(t={opacity:0},t[k]=(j?"-=":"+=")+I,w.animate(t,B,F)),w.queue(function(){E&&w.hide(),a.effects.restore(w,L),a.effects.removeWrapper(w),D()}),M>1&&K.splice.apply(K,[1,0].concat(K.splice(M,G+1))),w.dequeue()}}($),
/*!
 * jQuery UI Effects Clip 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/clip-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.clip=function(w,q){var k,B,j,b=a(this),z=["position","top","bottom","left","right","height","width"],m=a.effects.setMode(b,w.mode||"hide"),t="show"===m,y=w.direction||"vertical",A="vertical"===y,x=A?"height":"width",g=A?"top":"left",v={};a.effects.save(b,z),b.show(),k=a.effects.createWrapper(b).css({overflow:"hidden"}),B="IMG"===b[0].tagName?k:b,j=B[x](),t&&(B.css(x,0),B.css(g,j/2)),v[x]=t?j:0,v[g]=t?0:j/2,B.animate(v,{queue:!1,duration:w.duration,easing:w.easing,complete:function(){t||b.hide(),a.effects.restore(b,z),a.effects.removeWrapper(b),q()}})}}($),
/*!
 * jQuery UI Effects Drop 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/drop-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.drop=function(m,j){var f,v=a(this),d=["position","top","bottom","left","right","opacity","height","width"],b=a.effects.setMode(v,m.mode||"hide"),q="show"===b,g=m.direction||"left",k="up"===g||"down"===g?"top":"left",p="up"===g||"left"===g?"pos":"neg",t={opacity:q?1:0};a.effects.save(v,d),v.show(),a.effects.createWrapper(v),f=m.distance||v["top"===k?"outerHeight":"outerWidth"](!0)/2,q&&v.css("opacity",0).css(k,"pos"===p?-f:f),t[k]=(q?"pos"===p?"+=":"-=":"pos"===p?"-=":"+=")+f,v.animate(t,{queue:!1,duration:m.duration,easing:m.easing,complete:function(){"hide"===b&&v.hide(),a.effects.restore(v,d),a.effects.removeWrapper(v),j()}})}}($),
/*!
 * jQuery UI Effects Explode 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/explode-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.explode=function(H,D){function A(){K.push(this),K.length===q*I&&t()}function t(){x.css({visibility:"visible"}),a(K).remove(),B||x.hide(),D()}var z,w,L,C,E,J,q=H.pieces?Math.round(Math.sqrt(H.pieces)):3,I=q,x=a(this),G=a.effects.setMode(x,H.mode||"hide"),B="show"===G,F=x.show().css("visibility","hidden").offset(),k=Math.ceil(x.outerWidth()/I),j=Math.ceil(x.outerHeight()/q),K=[];for(z=0;q>z;z++){for(C=F.top+z*j,J=z-(q-1)/2,w=0;I>w;w++){L=F.left+w*k,E=w-(I-1)/2,x.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-w*k,top:-z*j}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:k,height:j,left:L+(B?E*k:0),top:C+(B?J*j:0),opacity:B?0:1}).animate({left:L+(B?0:E*k),top:C+(B?0:J*j),opacity:B?1:0},H.duration||500,H.easing,A)}}}}($),
/*!
 * jQuery UI Effects Fade 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/fade-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.fade=function(d,b){var f=a(this),c=a.effects.setMode(f,d.mode||"toggle");f.animate({opacity:c},{queue:!1,duration:d.duration,easing:d.easing,complete:b})}}($),
/*!
 * jQuery UI Effects Fold 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/fold-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.fold=function(B,x){var q,H,k=a(this),b=["position","top","bottom","left","right","height","width"],E=a.effects.setMode(k,B.mode||"hide"),w="show"===E,y="hide"===E,D=B.size||15,G=/([0-9]+)%/.exec(D),C=!!B.horizFirst,j=w!==C,A=j?["width","height"]:["height","width"],t=B.duration/2,z={},F={};a.effects.save(k,b),k.show(),q=a.effects.createWrapper(k).css({overflow:"hidden"}),H=j?[q.width(),q.height()]:[q.height(),q.width()],G&&(D=parseInt(G[1],10)/100*H[y?0:1]),w&&q.css(C?{height:0,width:D}:{height:D,width:0}),z[A[0]]=w?H[0]:D,F[A[1]]=w?H[1]:0,q.animate(z,t,B.easing).animate(F,t,B.easing,function(){y&&k.hide(),a.effects.restore(k,b),a.effects.removeWrapper(k),x()})}}($),
/*!
 * jQuery UI Effects Highlight 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/highlight-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.highlight=function(f,b){var h=a(this),c=["backgroundImage","backgroundColor","opacity"],g=a.effects.setMode(h,f.mode||"show"),d={backgroundColor:h.css("backgroundColor")};"hide"===g&&(d.opacity=0),a.effects.save(h,c),h.show().css({backgroundImage:"none",backgroundColor:f.color||"#ffff99"}).animate(d,{queue:!1,duration:f.duration,easing:f.easing,complete:function(){"hide"===g&&h.hide(),a.effects.restore(h,c),b()}})}}($),
/*!
 * jQuery UI Effects Pulsate 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/pulsate-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.pulsate=function(t,m){var j,z=a(this),g=a.effects.setMode(z,t.mode||"show"),b="show"===g,x="hide"===g,k=b||"hide"===g,q=2*(t.times||5)+(k?1:0),w=t.duration/q,y=0,v=z.queue(),f=v.length;for((b||!z.is(":visible"))&&(z.css("opacity",0).show(),y=1),j=1;q>j;j++){z.animate({opacity:y},w,t.easing),y=1-y}z.animate({opacity:y},w,t.easing),z.queue(function(){x&&z.hide(),m()}),f>1&&v.splice.apply(v,[1,0].concat(v.splice(f,q+1))),z.dequeue()}}($),
/*!
 * jQuery UI Effects Scale 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/scale-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.puff=function(h,d){var k=a(this),f=a.effects.setMode(k,h.mode||"hide"),j="hide"===f,g=parseInt(h.percent,10)||150,c=g/100,b={height:k.height(),width:k.width(),outerHeight:k.outerHeight(),outerWidth:k.outerWidth()};a.extend(h,{effect:"scale",queue:!1,fade:!0,mode:f,complete:d,percent:j?g:100,from:j?b:{height:b.height*c,width:b.width*c,outerHeight:b.outerHeight*c,outerWidth:b.outerWidth*c}}),k.effect(h)},a.effects.effect.scale=function(m,j){var f=a(this),t=a.extend(!0,{},m),d=a.effects.setMode(f,m.mode||"effect"),b=parseInt(m.percent,10)||(0===parseInt(m.percent,10)?0:"hide"===d?0:100),q=m.direction||"both",g=m.origin,k={height:f.height(),width:f.width(),outerHeight:f.outerHeight(),outerWidth:f.outerWidth()},p={y:"horizontal"!==q?b/100:1,x:"vertical"!==q?b/100:1};t.effect="size",t.queue=!1,t.complete=j,"effect"!==d&&(t.origin=g||["middle","center"],t.restore=!0),t.from=m.from||("show"===d?{height:0,width:0,outerHeight:0,outerWidth:0}:k),t.to={height:k.height*p.y,width:k.width*p.x,outerHeight:k.outerHeight*p.y,outerWidth:k.outerWidth*p.x},t.fade&&("show"===d&&(t.from.opacity=0,t.to.opacity=1),"hide"===d&&(t.from.opacity=1,t.to.opacity=0)),f.effect(t)},a.effects.effect.size=function(H,D){var A,t,z,w=a(this),L=["position","top","bottom","left","right","width","height","overflow","opacity"],C=["position","top","bottom","left","right","overflow","opacity"],E=["width","height","overflow"],J=["fontSize"],q=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],I=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],x=a.effects.setMode(w,H.mode||"effect"),G=H.restore||"effect"!==x,B=H.scale||"both",F=H.origin||["middle","center"],k=w.css("position"),j=G?L:C,K={height:0,width:0,outerHeight:0,outerWidth:0};"show"===x&&w.show(),A={height:w.height(),width:w.width(),outerHeight:w.outerHeight(),outerWidth:w.outerWidth()},"toggle"===H.mode&&"show"===x?(w.from=H.to||K,w.to=H.from||A):(w.from=H.from||("show"===x?K:A),w.to=H.to||("hide"===x?K:A)),z={from:{y:w.from.height/A.height,x:w.from.width/A.width},to:{y:w.to.height/A.height,x:w.to.width/A.width}},("box"===B||"both"===B)&&(z.from.y!==z.to.y&&(j=j.concat(q),w.from=a.effects.setTransition(w,q,z.from.y,w.from),w.to=a.effects.setTransition(w,q,z.to.y,w.to)),z.from.x!==z.to.x&&(j=j.concat(I),w.from=a.effects.setTransition(w,I,z.from.x,w.from),w.to=a.effects.setTransition(w,I,z.to.x,w.to))),("content"===B||"both"===B)&&z.from.y!==z.to.y&&(j=j.concat(J).concat(E),w.from=a.effects.setTransition(w,J,z.from.y,w.from),w.to=a.effects.setTransition(w,J,z.to.y,w.to)),a.effects.save(w,j),w.show(),a.effects.createWrapper(w),w.css("overflow","hidden").css(w.from),F&&(t=a.effects.getBaseline(F,A),w.from.top=(A.outerHeight-w.outerHeight())*t.y,w.from.left=(A.outerWidth-w.outerWidth())*t.x,w.to.top=(A.outerHeight-w.to.outerHeight)*t.y,w.to.left=(A.outerWidth-w.to.outerWidth)*t.x),w.css(w.from),("content"===B||"both"===B)&&(q=q.concat(["marginTop","marginBottom"]).concat(J),I=I.concat(["marginLeft","marginRight"]),E=L.concat(q).concat(I),w.find("*[width]").each(function(){var b=a(this),c={height:b.height(),width:b.width(),outerHeight:b.outerHeight(),outerWidth:b.outerWidth()};G&&a.effects.save(b,E),b.from={height:c.height*z.from.y,width:c.width*z.from.x,outerHeight:c.outerHeight*z.from.y,outerWidth:c.outerWidth*z.from.x},b.to={height:c.height*z.to.y,width:c.width*z.to.x,outerHeight:c.height*z.to.y,outerWidth:c.width*z.to.x},z.from.y!==z.to.y&&(b.from=a.effects.setTransition(b,q,z.from.y,b.from),b.to=a.effects.setTransition(b,q,z.to.y,b.to)),z.from.x!==z.to.x&&(b.from=a.effects.setTransition(b,I,z.from.x,b.from),b.to=a.effects.setTransition(b,I,z.to.x,b.to)),b.css(b.from),b.animate(b.to,H.duration,H.easing,function(){G&&a.effects.restore(b,E)})})),w.animate(w.to,{queue:!1,duration:H.duration,easing:H.easing,complete:function(){0===w.to.opacity&&w.css("opacity",w.from.opacity),"hide"===x&&w.hide(),a.effects.restore(w,j),G||("static"===k?w.css({position:"relative",top:w.to.top,left:w.to.left}):a.each(["top","left"],function(b,c){w.css(c,function(g,d){var h=parseInt(d,10),f=b?w.to.left:w.to.top;return"auto"===d?f+"px":h+f+"px"})})),a.effects.removeWrapper(w),D()}})}}($),
/*!
 * jQuery UI Effects Shake 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/shake-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.shake=function(G,C){var z,q=a(this),x=["position","top","bottom","left","right","height","width"],t=a.effects.setMode(q,G.mode||"effect"),J=G.direction||"left",B=G.distance||20,D=G.times||3,I=2*D+1,k=Math.round(G.duration/I),H="up"===J||"down"===J?"top":"left",w="up"===J||"left"===J,F={},A={},E={},j=q.queue(),b=j.length;for(a.effects.save(q,x),q.show(),a.effects.createWrapper(q),F[H]=(w?"-=":"+=")+B,A[H]=(w?"+=":"-=")+2*B,E[H]=(w?"-=":"+=")+2*B,q.animate(F,k,G.easing),z=1;D>z;z++){q.animate(A,k,G.easing).animate(E,k,G.easing)}q.animate(A,k,G.easing).animate(F,k/2,G.easing).queue(function(){"hide"===t&&q.hide(),a.effects.restore(q,x),a.effects.removeWrapper(q),C()}),b>1&&j.splice.apply(j,[1,0].concat(j.splice(b,I+1))),q.dequeue()}}($),
/*!
 * jQuery UI Effects Slide 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slide-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.slide=function(m,j){var f,v=a(this),d=["position","top","bottom","left","right","width","height"],b=a.effects.setMode(v,m.mode||"show"),q="show"===b,g=m.direction||"left",k="up"===g||"down"===g?"top":"left",p="up"===g||"left"===g,t={};a.effects.save(v,d),v.show(),f=m.distance||v["top"===k?"outerHeight":"outerWidth"](!0),a.effects.createWrapper(v).css({overflow:"hidden"}),q&&v.css(k,p?isNaN(f)?"-"+f:-f:f),t[k]=(q?p?"+=":"-=":p?"-=":"+=")+f,v.animate(t,{queue:!1,duration:m.duration,easing:m.easing,complete:function(){"hide"===b&&v.hide(),a.effects.restore(v,d),a.effects.removeWrapper(v),j()}})}}($),
/*!
 * jQuery UI Effects Transfer 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/transfer-effect/
 *
 * Depends:
 *	jquery.ui.effect.js
 */
function(a){a.effects.effect.transfer=function(p,k){var g=a(this),x=a(p.to),f="fixed"===x.css("position"),b=a("body"),v=f?b.scrollTop():0,j=f?b.scrollLeft():0,m=x.offset(),t={top:m.top-v,left:m.left-j,height:x.innerHeight(),width:x.innerWidth()},w=g.offset(),q=a("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(p.className).css({top:w.top-v,left:w.left-j,height:g.innerHeight(),width:g.innerWidth(),position:f?"fixed":"absolute"}).animate(t,p.duration,p.easing,function(){q.remove(),k()})}}($),
/*!
 * jQuery UI Progressbar 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/progressbar/
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 */
function(a,b){a.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(c){return c===b?this.options.value:(this.options.value=this._constrainedValue(c),this._refreshValue(),void 0)},_constrainedValue:function(c){return c===b&&(c=this.options.value),this.indeterminate=c===!1,"number"!=typeof c&&(c=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,c))},_setOptions:function(c){var d=c.value;delete c.value,this._super(c),this.options.value=this._constrainedValue(d),this._refreshValue()},_setOption:function(c,d){"max"===c&&(d=Math.max(this.min,d)),this._super(c,d)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var d=this.options.value,c=this._percentage();this.valueDiv.toggle(this.indeterminate||d>this.min).toggleClass("ui-corner-right",d===this.options.max).width(c.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=a("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":d}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==d&&(this.oldValue=d,this._trigger("change")),d===this.options.max&&this._trigger("complete")}})}($),
/*!
 * jQuery UI Selectable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/selectable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function(a){a.widget("ui.selectable",a.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var c,b=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){c=a(b.options.filter,b.element[0]),c.addClass("ui-selectee"),c.each(function(){var f=a(this),d=f.offset();a.data(this,"selectable-item",{element:this,$element:f,left:d.left,top:d.top,right:d.left+f.outerWidth(),bottom:d.top+f.outerHeight(),startselected:!1,selected:f.hasClass("ui-selected"),selecting:f.hasClass("ui-selecting"),unselecting:f.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=c.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(c){var b=this,d=this.options;this.opos=[c.pageX,c.pageY],this.options.disabled||(this.selectees=a(d.filter,this.element[0]),this._trigger("start",c),a(d.appendTo).append(this.helper),this.helper.css({left:c.pageX,top:c.pageY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var e=a.data(this,"selectable-item");e.startselected=!0,c.metaKey||c.ctrlKey||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,b._trigger("unselecting",c,{unselecting:e.element}))}),a(c.target).parents().addBack().each(function(){var f,e=a.data(this,"selectable-item");return e?(f=!c.metaKey&&!c.ctrlKey||!e.$element.hasClass("ui-selected"),e.$element.removeClass(f?"ui-unselecting":"ui-selected").addClass(f?"ui-selecting":"ui-unselecting"),e.unselecting=!f,e.selecting=f,e.selected=f,f?b._trigger("selecting",c,{selecting:e.element}):b._trigger("unselecting",c,{unselecting:e.element}),!1):void 0}))},_mouseDrag:function(h){if(this.dragged=!0,!this.options.disabled){var d,k=this,f=this.options,j=this.opos[0],g=this.opos[1],c=h.pageX,b=h.pageY;return j>c&&(d=c,c=j,j=d),g>b&&(d=b,b=g,g=d),this.helper.css({left:j,top:g,width:c-j,height:b-g}),this.selectees.each(function(){var e=a.data(this,"selectable-item"),l=!1;e&&e.element!==k.element[0]&&("touch"===f.tolerance?l=!(e.left>c||e.right<j||e.top>b||e.bottom<g):"fit"===f.tolerance&&(l=e.left>j&&e.right<c&&e.top>g&&e.bottom<b),l?(e.selected&&(e.$element.removeClass("ui-selected"),e.selected=!1),e.unselecting&&(e.$element.removeClass("ui-unselecting"),e.unselecting=!1),e.selecting||(e.$element.addClass("ui-selecting"),e.selecting=!0,k._trigger("selecting",h,{selecting:e.element}))):(e.selecting&&((h.metaKey||h.ctrlKey)&&e.startselected?(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.$element.addClass("ui-selected"),e.selected=!0):(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.startselected&&(e.$element.addClass("ui-unselecting"),e.unselecting=!0),k._trigger("unselecting",h,{unselecting:e.element}))),e.selected&&(h.metaKey||h.ctrlKey||e.startselected||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,k._trigger("unselecting",h,{unselecting:e.element})))))}),!1}},_mouseStop:function(c){var b=this;return this.dragged=!1,a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,b._trigger("unselected",c,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,b._trigger("selected",c,{selected:d.element})}),this._trigger("stop",c),this.helper.remove(),!1}})}($),
/*!
 * jQuery UI Slider 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slider/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function(a){var b=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var g,c,j=this.options,d=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),h="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",f=[];for(c=j.values&&j.values.length||1,d.length>c&&(d.slice(c).remove(),d=d.slice(0,c)),g=d.length;c>g;g++){f.push(h)}this.handles=d.add(a(f.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(i){a(this).data("ui-slider-handle-index",i)})},_createRange:function(){var d=this.options,c="";d.range?(d.range===!0&&(d.values?d.values.length&&2!==d.values.length?d.values=[d.values[0],d.values[0]]:a.isArray(d.values)&&(d.values=d.values.slice(0)):d.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===d.range||"max"===d.range?" ui-slider-range-"+d.range:""))):this.range=a([])},_setupEvents:function(){var c=this.handles.add(this.range).filter("a");this._off(c),this._on(c,this._handleEvents),this._hoverable(c),this._focusable(c)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(p){var k,g,w,f,d,t,j,m,q=this,v=this.options;return v.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),k={x:p.pageX,y:p.pageY},g=this._normValueFromMouse(k),w=this._valueMax()-this._valueMin()+1,this.handles.each(function(h){var c=Math.abs(g-q.values(h));(w>c||w===c&&(h===q._lastChangedValue||q.values(h)===v.min))&&(w=c,f=a(this),d=h)}),t=this._start(p,d),t===!1?!1:(this._mouseSliding=!0,this._handleIndex=d,f.addClass("ui-state-active").focus(),j=f.offset(),m=!a(p.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=m?{left:0,top:0}:{left:p.pageX-j.left-f.width()/2,top:p.pageY-j.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(p,d,g),this._animateOff=!0,!0))},_mouseStart:function(){return !0},_mouseDrag:function(d){var f={x:d.pageX,y:d.pageY},c=this._normValueFromMouse(f);return this._slide(d,this._handleIndex,c),!1},_mouseStop:function(c){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(c,this._handleIndex),this._change(c,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(d){var g,c,j,f,h;return"horizontal"===this.orientation?(g=this.elementSize.width,c=d.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(g=this.elementSize.height,c=d.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),j=c/g,j>1&&(j=1),0>j&&(j=0),"vertical"===this.orientation&&(j=1-j),f=this._valueMax()-this._valueMin(),h=this._valueMin()+j*f,this._trimAlignValue(h)},_start:function(d,f){var c={handle:this.handles[f],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(f),c.values=this.values()),this._trigger("start",d,c)},_slide:function(d,g,c){var j,f,h;this.options.values&&this.options.values.length?(j=this.values(g?0:1),2===this.options.values.length&&this.options.range===!0&&(0===g&&c>j||1===g&&j>c)&&(c=j),c!==this.values(g)&&(f=this.values(),f[g]=c,h=this._trigger("slide",d,{handle:this.handles[g],value:c,values:f}),j=this.values(g?0:1),h!==!1&&this.values(g,c,!0))):c!==this.value()&&(h=this._trigger("slide",d,{handle:this.handles[g],value:c}),h!==!1&&this.value(c))},_stop:function(d,f){var c={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(f),c.values=this.values()),this._trigger("stop",d,c)},_change:function(d,f){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(f),c.values=this.values()),this._lastChangedValue=f,this._trigger("change",d,c)}},value:function(c){return arguments.length?(this.options.value=this._trimAlignValue(c),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(f,c){var h,d,g;if(arguments.length>1){return this.options.values[f]=this._trimAlignValue(c),this._refreshValue(),this._change(null,f),void 0}if(!arguments.length){return this._values()}if(!a.isArray(arguments[0])){return this.options.values&&this.options.values.length?this._values(f):this.value()}for(h=this.options.values,d=arguments[0],g=0;g<h.length;g+=1){h[g]=this._trimAlignValue(d[g]),this._change(null,g)}this._refreshValue()},_setOption:function(f,c){var g,d=0;switch("range"===f&&this.options.range===!0&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(d=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),f){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),g=0;d>g;g+=1){this._change(null,g)}this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var c=this.options.value;return c=this._trimAlignValue(c)},_values:function(d){var f,c,g;if(arguments.length){return f=this.options.values[d],f=this._trimAlignValue(f)}if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),g=0;g<c.length;g+=1){c[g]=this._trimAlignValue(c[g])}return c}return[]},_trimAlignValue:function(d){if(d<=this._valueMin()){return this._valueMin()}if(d>=this._valueMax()){return this._valueMax()}var f=this.options.step>0?this.options.step:1,c=(d-this._valueMin())%f,g=d-c;return 2*Math.abs(c)>=f&&(g+=c>0?f:-f),parseFloat(g.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var p,k,g,u,f,d=this.options.range,t=this.options,j=this,m=this._animateOff?!1:t.animate,q={};this.options.values&&this.options.values.length?this.handles.each(function(c){k=100*((j.values(c)-j._valueMin())/(j._valueMax()-j._valueMin())),q["horizontal"===j.orientation?"left":"bottom"]=k+"%",a(this).stop(1,1)[m?"animate":"css"](q,t.animate),j.options.range===!0&&("horizontal"===j.orientation?(0===c&&j.range.stop(1,1)[m?"animate":"css"]({left:k+"%"},t.animate),1===c&&j.range[m?"animate":"css"]({width:k-p+"%"},{queue:!1,duration:t.animate})):(0===c&&j.range.stop(1,1)[m?"animate":"css"]({bottom:k+"%"},t.animate),1===c&&j.range[m?"animate":"css"]({height:k-p+"%"},{queue:!1,duration:t.animate}))),p=k}):(g=this.value(),u=this._valueMin(),f=this._valueMax(),k=f!==u?100*((g-u)/(f-u)):0,q["horizontal"===this.orientation?"left":"bottom"]=k+"%",this.handle.stop(1,1)[m?"animate":"css"](q,t.animate),"min"===d&&"horizontal"===this.orientation&&this.range.stop(1,1)[m?"animate":"css"]({width:k+"%"},t.animate),"max"===d&&"horizontal"===this.orientation&&this.range[m?"animate":"css"]({width:100-k+"%"},{queue:!1,duration:t.animate}),"min"===d&&"vertical"===this.orientation&&this.range.stop(1,1)[m?"animate":"css"]({height:k+"%"},t.animate),"max"===d&&"vertical"===this.orientation&&this.range[m?"animate":"css"]({height:100-k+"%"},{queue:!1,duration:t.animate}))},_handleEvents:{keydown:function(d){var h,e,g,f,c=a(d.target).data("ui-slider-handle-index");switch(d.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(d.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(d.target).addClass("ui-state-active"),h=this._start(d,c),h===!1)){return}}switch(f=this.options.step,e=g=this.options.values&&this.options.values.length?this.values(c):this.value(),d.keyCode){case a.ui.keyCode.HOME:g=this._valueMin();break;case a.ui.keyCode.END:g=this._valueMax();break;case a.ui.keyCode.PAGE_UP:g=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.PAGE_DOWN:g=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===this._valueMax()){return}g=this._trimAlignValue(e+f);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin()){return}g=this._trimAlignValue(e-f)}this._slide(d,c,g)},click:function(c){c.preventDefault()},keyup:function(d){var c=a(d.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(d,c),this._change(d,c),a(d.target).removeClass("ui-state-active"))}}})}($),
/*!
 * jQuery UI Sortable 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function(b){function c(f,g,d){return f>g&&g+d>f}function a(d){return/left|right/.test(d.css("float"))||/inline|table-cell/.test(d.css("display"))}b.widget("ui.sortable",b.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var d=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===d.axis||a(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var d=this.items.length-1;d>=0;d--){this.items[d].item.removeData(this.widgetName+"-item")}return this},_setOption:function(f,d){"disabled"===f?(this.options[f]=d,this.widget().toggleClass("ui-sortable-disabled",!!d)):b.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(g,d){var j=null,f=!1,h=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(g),b(g.target).parents().each(function(){return b.data(this,h.widgetName+"-item")===h?(j=b(this),!1):void 0}),b.data(g.target,h.widgetName+"-item")===h&&(j=b(g.target)),j?!this.options.handle||d||(b(this.options.handle,j).find("*").addBack().each(function(){this===g.target&&(f=!0)}),f)?(this.currentItem=j,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(h,d,k){var f,j,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(h),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},b.extend(this.offset,{click:{left:h.pageX-this.offset.left,top:h.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(h),this.originalPageX=h.pageX,this.originalPageY=h.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(j=this.document.find("body"),this.storedCursor=j.css("cursor"),j.css("cursor",g.cursor),this.storedStylesheet=b("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(j)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",h,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!k){for(f=this.containers.length-1;f>=0;f--){this.containers[f]._trigger("activate",h,this._uiHash(this))}}return b.ui.ddmanager&&(b.ui.ddmanager.current=this),b.ui.ddmanager&&!g.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,h),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(h),!0},_mouseDrag:function(j){var f,l,g,k,h=this.options,d=!1;for(this.position=this._generatePosition(j),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-j.pageY<h.scrollSensitivity?this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+h.scrollSpeed:j.pageY-this.overflowOffset.top<h.scrollSensitivity&&(this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-h.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-j.pageX<h.scrollSensitivity?this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft+h.scrollSpeed:j.pageX-this.overflowOffset.left<h.scrollSensitivity&&(this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-h.scrollSpeed)):(j.pageY-b(document).scrollTop()<h.scrollSensitivity?d=b(document).scrollTop(b(document).scrollTop()-h.scrollSpeed):b(window).height()-(j.pageY-b(document).scrollTop())<h.scrollSensitivity&&(d=b(document).scrollTop(b(document).scrollTop()+h.scrollSpeed)),j.pageX-b(document).scrollLeft()<h.scrollSensitivity?d=b(document).scrollLeft(b(document).scrollLeft()-h.scrollSpeed):b(window).width()-(j.pageX-b(document).scrollLeft())<h.scrollSensitivity&&(d=b(document).scrollLeft(b(document).scrollLeft()+h.scrollSpeed))),d!==!1&&b.ui.ddmanager&&!h.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,j)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),f=this.items.length-1;f>=0;f--){if(l=this.items[f],g=l.item[0],k=this._intersectsWithPointer(l),k&&l.instance===this.currentContainer&&g!==this.currentItem[0]&&this.placeholder[1===k?"next":"prev"]()[0]!==g&&!b.contains(this.placeholder[0],g)&&("semi-dynamic"===this.options.type?!b.contains(this.element[0],g):!0)){if(this.direction=1===k?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(l)){break}this._rearrange(j,l),this._trigger("change",j,this._uiHash());break}}return this._contactContainers(j),b.ui.ddmanager&&b.ui.ddmanager.drag(this,j),this._trigger("sort",j,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(h,d){if(h){if(b.ui.ddmanager&&!this.options.dropBehaviour&&b.ui.ddmanager.drop(this,h),this.options.revert){var k=this,f=this.placeholder.offset(),j=this.options.axis,g={};j&&"x"!==j||(g.left=f.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),j&&"y"!==j||(g.top=f.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,b(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){k._clear(h)})}else{this._clear(h,d)}return !1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var d=this.containers.length-1;d>=0;d--){this.containers[d]._trigger("deactivate",null,this._uiHash(this)),this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",null,this._uiHash(this)),this.containers[d].containerCache.over=0)}}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),b.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?b(this.domPosition.prev).after(this.currentItem):b(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(f){var d=this._getItemsAsjQuery(f&&f.connected),g=[];return f=f||{},b(d).each(function(){var e=(b(f.item||this).attr(f.attribute||"id")||"").match(f.expression||/(.+)[\-=_](.+)/);e&&g.push((f.key||e[1]+"[]")+"="+(f.key&&f.expression?e[1]:e[2]))}),!g.length&&f.key&&g.push(f.key+"="),g.join("&")},toArray:function(f){var d=this._getItemsAsjQuery(f&&f.connected),g=[];return f=f||{},d.each(function(){g.push(b(f.item||this).attr(f.attribute||"id")||"")}),g},_intersectsWith:function(B){var w=this.positionAbs.left,q=w+this.helperProportions.width,k=this.positionAbs.top,C=k+this.helperProportions.height,j=B.left,f=j+B.width,z=B.top,m=z+B.height,v=this.offset.click.top,y=this.offset.click.left,A="x"===this.options.axis||k+v>z&&m>k+v,x="y"===this.options.axis||w+y>j&&f>w+y,g=A&&x;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>B[this.floating?"width":"height"]?g:j<w+this.helperProportions.width/2&&q-this.helperProportions.width/2<f&&z<k+this.helperProportions.height/2&&C-this.helperProportions.height/2<m},_intersectsWithPointer:function(e){var d="x"===this.options.axis||c(this.positionAbs.top+this.offset.click.top,e.top,e.height),j="y"===this.options.axis||c(this.positionAbs.left+this.offset.click.left,e.left,e.width),f=d&&j,h=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return f?this.floating?g&&"right"===g||"down"===h?2:1:h&&("down"===h?2:1):!1},_intersectsWithSides:function(e){var d=c(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),h=c(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return this.floating&&g?"right"===g&&h||"left"===g&&!h:f&&("down"===f&&d||"up"===f&&!d)},_getDragVerticalDirection:function(){var d=this.positionAbs.top-this.lastPositionAbs.top;return 0!==d&&(d>0?"down":"up")},_getDragHorizontalDirection:function(){var d=this.positionAbs.left-this.lastPositionAbs.left;return 0!==d&&(d>0?"right":"left")},refresh:function(d){return this._refreshItems(d),this.refreshPositions(),this},_connectWith:function(){var d=this.options;return d.connectWith.constructor===String?[d.connectWith]:d.connectWith},_getItemsAsjQuery:function(k){var g,p,h,m,j=[],f=[],d=this._connectWith();if(d&&k){for(g=d.length-1;g>=0;g--){for(h=b(d[g]),p=h.length-1;p>=0;p--){m=b.data(h[p],this.widgetFullName),m&&m!==this&&!m.options.disabled&&f.push([b.isFunction(m.options.items)?m.options.items.call(m.element):b(m.options.items,m.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),m])}}}for(f.push([b.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):b(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),g=f.length-1;g>=0;g--){f[g][0].each(function(){j.push(this)})}return b(j)},_removeCurrentsFromItems:function(){var d=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=b.grep(this.items,function(f){for(var e=0;e<d.length;e++){if(d[e]===f.item[0]){return !1}}return !0})},_refreshItems:function(q){this.items=[],this.containers=[this];var m,j,y,g,f,w,k,p,v=this.items,x=[[b.isFunction(this.options.items)?this.options.items.call(this.element[0],q,{item:this.currentItem}):b(this.options.items,this.element),this]],t=this._connectWith();if(t&&this.ready){for(m=t.length-1;m>=0;m--){for(y=b(t[m]),j=y.length-1;j>=0;j--){g=b.data(y[j],this.widgetFullName),g&&g!==this&&!g.options.disabled&&(x.push([b.isFunction(g.options.items)?g.options.items.call(g.element[0],q,{item:this.currentItem}):b(g.options.items,g.element),g]),this.containers.push(g))}}}for(m=x.length-1;m>=0;m--){for(f=x[m][1],w=x[m][0],j=0,p=w.length;p>j;j++){k=b(w[j]),k.data(this.widgetName+"-item",f),v.push({item:k,instance:f,width:0,height:0,left:0,top:0})}}},refreshPositions:function(g){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var d,j,f,h;for(d=this.items.length-1;d>=0;d--){j=this.items[d],j.instance!==this.currentContainer&&this.currentContainer&&j.item[0]!==this.currentItem[0]||(f=this.options.toleranceElement?b(this.options.toleranceElement,j.item):j.item,g||(j.width=f.outerWidth(),j.height=f.outerHeight()),h=f.offset(),j.left=h.left,j.top=h.top)}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(d=this.containers.length-1;d>=0;d--){h=this.containers[d].element.offset(),this.containers[d].containerCache.left=h.left,this.containers[d].containerCache.top=h.top,this.containers[d].containerCache.width=this.containers[d].element.outerWidth(),this.containers[d].containerCache.height=this.containers[d].element.outerHeight()}}return this},_createPlaceholder:function(f){f=f||this;var d,g=f.options;g.placeholder&&g.placeholder.constructor!==String||(d=g.placeholder,g.placeholder={element:function(){var h=f.currentItem[0].nodeName.toLowerCase(),e=b("<"+h+">",f.document[0]).addClass(d||f.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===h?f.currentItem.children().each(function(){b("<td>&#160;</td>",f.document[0]).attr("colspan",b(this).attr("colspan")||1).appendTo(e)}):"img"===h&&e.attr("src",f.currentItem.attr("src")),d||e.css("visibility","hidden"),e},update:function(e,h){(!d||g.forcePlaceholderSize)&&(h.height()||h.height(f.currentItem.innerHeight()-parseInt(f.currentItem.css("paddingTop")||0,10)-parseInt(f.currentItem.css("paddingBottom")||0,10)),h.width()||h.width(f.currentItem.innerWidth()-parseInt(f.currentItem.css("paddingLeft")||0,10)-parseInt(f.currentItem.css("paddingRight")||0,10)))}}),f.placeholder=b(g.placeholder.element.call(f.element,f.currentItem)),f.currentItem.after(f.placeholder),g.placeholder.update(f,f.placeholder)},_contactContainers:function(j){var A,i,e,y,q,t,x,z,w,g,v=null,k=null;for(A=this.containers.length-1;A>=0;A--){if(!b.contains(this.currentItem[0],this.containers[A].element[0])){if(this._intersectsWith(this.containers[A].containerCache)){if(v&&b.contains(this.containers[A].element[0],v.element[0])){continue}v=this.containers[A],k=A}else{this.containers[A].containerCache.over&&(this.containers[A]._trigger("out",j,this._uiHash(this)),this.containers[A].containerCache.over=0)}}}if(v){if(1===this.containers.length){this.containers[k].containerCache.over||(this.containers[k]._trigger("over",j,this._uiHash(this)),this.containers[k].containerCache.over=1)}else{for(e=10000,y=null,g=v.floating||a(this.currentItem),q=g?"left":"top",t=g?"width":"height",x=this.positionAbs[q]+this.offset.click[q],i=this.items.length-1;i>=0;i--){b.contains(this.containers[k].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(!g||c(this.positionAbs.top+this.offset.click.top,this.items[i].top,this.items[i].height))&&(z=this.items[i].item.offset()[q],w=!1,Math.abs(z-x)>Math.abs(z+this.items[i][t]-x)&&(w=!0,z+=this.items[i][t]),Math.abs(z-x)<e&&(e=Math.abs(z-x),y=this.items[i],this.direction=w?"up":"down"))}if(!y&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[k]){return}y?this._rearrange(j,y,null,!0):this._rearrange(j,null,this.containers[k].element,!0),this._trigger("change",j,this._uiHash()),this.containers[k]._trigger("change",j,this._uiHash(this)),this.currentContainer=this.containers[k],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[k]._trigger("over",j,this._uiHash(this)),this.containers[k].containerCache.over=1}}},_createHelper:function(f){var d=this.options,g=b.isFunction(d.helper)?b(d.helper.apply(this.element[0],[f,this.currentItem])):"clone"===d.helper?this.currentItem.clone():this.currentItem;return g.parents("body").length||b("parent"!==d.appendTo?d.appendTo:this.currentItem[0].parentNode)[0].appendChild(g[0]),g[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!g[0].style.width||d.forceHelperSize)&&g.width(this.currentItem.width()),(!g[0].style.height||d.forceHelperSize)&&g.height(this.currentItem.height()),g},_adjustOffsetFromHelper:function(d){"string"==typeof d&&(d=d.split(" ")),b.isArray(d)&&(d={left:+d[0],top:+d[1]||0}),"left" in d&&(this.offset.click.left=d.left+this.margins.left),"right" in d&&(this.offset.click.left=this.helperProportions.width-d.right+this.margins.left),"top" in d&&(this.offset.click.top=d.top+this.margins.top),"bottom" in d&&(this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var d=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&b.ui.ie)&&(d={top:0,left:0}),{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var d=this.currentItem.position();return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var g,d,h,f=this.options;"parent"===f.containment&&(f.containment=this.helper[0].parentNode),("document"===f.containment||"window"===f.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,b("document"===f.containment?document:window).width()-this.helperProportions.width-this.margins.left,(b("document"===f.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(f.containment)||(g=b(f.containment)[0],d=b(f.containment).offset(),h="hidden"!==b(g).css("overflow"),this.containment=[d.left+(parseInt(b(g).css("borderLeftWidth"),10)||0)+(parseInt(b(g).css("paddingLeft"),10)||0)-this.margins.left,d.top+(parseInt(b(g).css("borderTopWidth"),10)||0)+(parseInt(b(g).css("paddingTop"),10)||0)-this.margins.top,d.left+(h?Math.max(g.scrollWidth,g.offsetWidth):g.offsetWidth)-(parseInt(b(g).css("borderLeftWidth"),10)||0)-(parseInt(b(g).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,d.top+(h?Math.max(g.scrollHeight,g.offsetHeight):g.offsetHeight)-(parseInt(b(g).css("borderTopWidth"),10)||0)-(parseInt(b(g).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(g,d){d||(d=this.position);var j="absolute"===g?1:-1,f="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(f[0].tagName);return{top:d.top+this.offset.relative.top*j+this.offset.parent.top*j-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:f.scrollTop())*j,left:d.left+this.offset.relative.left*j+this.offset.parent.left*j-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:f.scrollLeft())*j}},_generatePosition:function(k){var g,p,h=this.options,m=k.pageX,j=k.pageY,f="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,d=/(html|body)/i.test(f[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(k.pageX-this.offset.click.left<this.containment[0]&&(m=this.containment[0]+this.offset.click.left),k.pageY-this.offset.click.top<this.containment[1]&&(j=this.containment[1]+this.offset.click.top),k.pageX-this.offset.click.left>this.containment[2]&&(m=this.containment[2]+this.offset.click.left),k.pageY-this.offset.click.top>this.containment[3]&&(j=this.containment[3]+this.offset.click.top)),h.grid&&(g=this.originalPageY+Math.round((j-this.originalPageY)/h.grid[1])*h.grid[1],j=this.containment?g-this.offset.click.top>=this.containment[1]&&g-this.offset.click.top<=this.containment[3]?g:g-this.offset.click.top>=this.containment[1]?g-h.grid[1]:g+h.grid[1]:g,p=this.originalPageX+Math.round((m-this.originalPageX)/h.grid[0])*h.grid[0],m=this.containment?p-this.offset.click.left>=this.containment[0]&&p-this.offset.click.left<=this.containment[2]?p:p-this.offset.click.left>=this.containment[0]?p-h.grid[0]:p+h.grid[0]:p)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():d?0:f.scrollTop()),left:m-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():d?0:f.scrollLeft())}},_rearrange:function(f,h,d,j){d?d[0].appendChild(this.placeholder[0]):h.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?h.item[0]:h.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var g=this.counter;this._delay(function(){g===this.counter&&this.refreshPositions(!j)})},_clear:function(f,g){this.reverting=!1;var d,h=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS){("auto"===this._storedCSS[d]||"static"===this._storedCSS[d])&&(this._storedCSS[d]="")}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(this.fromOutside&&!g&&h.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||g||h.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(g||(h.push(function(e){this._trigger("remove",e,this._uiHash())}),h.push(function(e){return function(i){e._trigger("receive",i,this._uiHash(this))}}.call(this,this.currentContainer)),h.push(function(e){return function(i){e._trigger("update",i,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--){g||h.push(function(e){return function(i){e._trigger("deactivate",i,this._uiHash(this))}}.call(this,this.containers[d])),this.containers[d].containerCache.over&&(h.push(function(e){return function(i){e._trigger("out",i,this._uiHash(this))}}.call(this,this.containers[d])),this.containers[d].containerCache.over=0)}if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!g){for(this._trigger("beforeStop",f,this._uiHash()),d=0;d<h.length;d++){h[d].call(this,f)}this._trigger("stop",f,this._uiHash())}return this.fromOutside=!1,!1}if(g||this._trigger("beforeStop",f,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!g){for(d=0;d<h.length;d++){h[d].call(this,f)}this._trigger("stop",f,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){b.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(f){var d=f||this;return{helper:d.helper,placeholder:d.placeholder||b([]),position:d.position,originalPosition:d.originalPosition,offset:d.positionAbs,item:d.currentItem,sender:f?f.element:null}}})}($),
/*!
 * jQuery UI Spinner 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/spinner/
 *
 * Depends:
 *  jquery.ui.core.js
 *  jquery.ui.widget.js
 *  jquery.ui.button.js
 */
function(a){function b(c){return function(){var d=this.element.val();c.apply(this,arguments),this._refresh(),d!==this.element.val()&&this._trigger("change")}}a.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var d={},c=this.element;return a.each(["min","max","step"],function(e,g){var f=c.attr(g);void 0!==f&&f.length&&(d[g]=f)}),d},_events:{keydown:function(c){this._start(c)&&this._keydown(c)&&c.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(c){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",c),void 0)},mousewheel:function(c,d){if(d){if(!this.spinning&&!this._start(c)){return !1}this._spin((d>0?1:-1)*this.options.step,c),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(c)},100),c.preventDefault()}},"mousedown .ui-spinner-button":function(d){function c(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=f,this._delay(function(){this.previous=f}))}var f;f=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),d.preventDefault(),c.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,c.call(this)}),this._start(d)!==!1&&this._repeat(null,a(d.currentTarget).hasClass("ui-spinner-up")?1:-1,d)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(c){return a(c.currentTarget).hasClass("ui-state-active")?this._start(c)===!1?!1:(this._repeat(null,a(c.currentTarget).hasClass("ui-spinner-up")?1:-1,c),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var c=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=c.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(0.5*c.height())&&c.height()>0&&c.height(c.height()),this.options.disabled&&this.disable()},_keydown:function(d){var c=this.options,f=a.ui.keyCode;switch(d.keyCode){case f.UP:return this._repeat(null,1,d),!0;case f.DOWN:return this._repeat(null,-1,d),!0;case f.PAGE_UP:return this._repeat(null,c.page,d),!0;case f.PAGE_DOWN:return this._repeat(null,-c.page,d),!0}return !1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(c){return this.spinning||this._trigger("start",c)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(d,f,c){d=d||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,f,c)},d),this._spin(f*this.options.step,c)},_spin:function(d,f){var c=this.value()||0;this.counter||(this.counter=1),c=this._adjustValue(c+d*this._increment(this.counter)),this.spinning&&this._trigger("spin",f,{value:c})===!1||(this._value(c),this.counter++)},_increment:function(d){var c=this.options.incremental;return c?a.isFunction(c)?c(d):Math.floor(d*d*d/50000-d*d/500+17*d/200+1):1},_precision:function(){var c=this._precisionOf(this.options.step);return null!==this.options.min&&(c=Math.max(c,this._precisionOf(this.options.min))),c},_precisionOf:function(d){var f=d.toString(),c=f.indexOf(".");return -1===c?0:f.length-c-1},_adjustValue:function(d){var f,c,g=this.options;return f=null!==g.min?g.min:0,c=d-f,c=Math.round(c/g.step)*g.step,d=f+c,d=parseFloat(d.toFixed(this._precision())),null!==g.max&&d>g.max?g.max:null!==g.min&&d<g.min?g.min:d},_stop:function(c){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",c))},_setOption:function(d,f){if("culture"===d||"numberFormat"===d){var c=this._parse(this.element.val());return this.options[d]=f,this.element.val(this._format(c)),void 0}("max"===d||"min"===d||"step"===d)&&"string"==typeof f&&(f=this._parse(f)),"icons"===d&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(f.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(f.down)),this._super(d,f),"disabled"===d&&(f?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:b(function(c){this._super(c),this._value(this.element.val())}),_parse:function(c){return"string"==typeof c&&""!==c&&(c=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(c,10,this.options.culture):+c),""===c||isNaN(c)?null:c},_format:function(c){return""===c?"":window.Globalize&&this.options.numberFormat?Globalize.format(c,this.options.numberFormat,this.options.culture):c},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(d,f){var c;""!==d&&(c=this._parse(d),null!==c&&(f||(c=this._adjustValue(c)),d=this._format(c))),this.element.val(d),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:b(function(c){this._stepUp(c)}),_stepUp:function(c){this._start()&&(this._spin((c||1)*this.options.step),this._stop())},stepDown:b(function(c){this._stepDown(c)}),_stepDown:function(c){this._start()&&(this._spin((c||1)*-this.options.step),this._stop())},pageUp:b(function(c){this._stepUp((c||1)*this.options.page)}),pageDown:b(function(c){this._stepDown((c||1)*this.options.page)}),value:function(c){return arguments.length?(b(this._value).call(this,c),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}($),
/*!
 * jQuery UI Tabs 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/tabs/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
function(b,d){function a(){return ++c}function g(e){return e.hash.length>1&&decodeURIComponent(e.href.replace(f,""))===decodeURIComponent(location.href.replace(f,""))}var c=0,f=/#.*$/;b.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var j=this,h=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",h.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(i){b(this).is(".ui-state-disabled")&&i.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){b(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),h.active=this._initialActive(),b.isArray(h.disabled)&&(h.disabled=b.unique(h.disabled.concat(b.map(this.tabs.filter(".ui-state-disabled"),function(e){return j.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(h.active):b(),this._refresh(),this.active.length&&this.load(h.active)},_initialActive:function(){var j=this.options.active,h=this.options.collapsible,k=location.hash.substring(1);return null===j&&(k&&this.tabs.each(function(e,l){return b(l).attr("aria-controls")===k?(j=e,!1):void 0}),null===j&&(j=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===j||-1===j)&&(j=this.tabs.length?0:!1)),j!==!1&&(j=this.tabs.index(this.tabs.eq(j)),-1===j&&(j=h?!1:0)),!h&&j===!1&&this.anchors.length&&(j=0),j},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):b()}},_tabKeydown:function(k){var h=b(this.document[0].activeElement).closest("li"),l=this.tabs.index(h),j=!0;if(!this._handlePageNav(k)){switch(k.keyCode){case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:l++;break;case b.ui.keyCode.UP:case b.ui.keyCode.LEFT:j=!1,l--;break;case b.ui.keyCode.END:l=this.anchors.length-1;break;case b.ui.keyCode.HOME:l=0;break;case b.ui.keyCode.SPACE:return k.preventDefault(),clearTimeout(this.activating),this._activate(l),void 0;case b.ui.keyCode.ENTER:return k.preventDefault(),clearTimeout(this.activating),this._activate(l===this.options.active?!1:l),void 0;default:return}k.preventDefault(),clearTimeout(this.activating),l=this._focusNextTab(l,j),k.ctrlKey||(h.attr("aria-selected","false"),this.tabs.eq(l).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",l)},this.delay))}},_panelKeydown:function(h){this._handlePageNav(h)||h.ctrlKey&&h.keyCode===b.ui.keyCode.UP&&(h.preventDefault(),this.active.focus())},_handlePageNav:function(h){return h.altKey&&h.keyCode===b.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):h.altKey&&h.keyCode===b.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(k,h){function l(){return k>j&&(k=0),0>k&&(k=j),k}for(var j=this.tabs.length-1;-1!==b.inArray(l(),this.options.disabled);){k=h?k+1:k-1}return k},_focusNextTab:function(h,i){return h=this._findNextTab(h,i),this.tabs.eq(h).focus(),h},_setOption:function(h,i){return"active"===h?(this._activate(i),void 0):"disabled"===h?(this._setupDisabled(i),void 0):(this._super(h,i),"collapsible"===h&&(this.element.toggleClass("ui-tabs-collapsible",i),i||this.options.active!==!1||this._activate(0)),"event"===h&&this._setupEvents(i),"heightStyle"===h&&this._setupHeightStyle(i),void 0)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+a()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var j=this.options,h=this.tablist.children(":has(a[href])");j.disabled=b.map(h.filter(".ui-state-disabled"),function(e){return h.index(e)}),this._processTabs(),j.active!==!1&&this.anchors.length?this.active.length&&!b.contains(this.tablist[0],this.active[0])?this.tabs.length===j.disabled.length?(j.active=!1,this.active=b()):this._activate(this._findNextTab(Math.max(0,j.active-1),!1)):j.active=this.tabs.index(this.active):(j.active=!1,this.active=b()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var h=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return b("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=b(),this.anchors.each(function(k,n){var q,p,j,e=b(n).uniqueId().attr("id"),m=b(n).closest("li"),t=m.attr("aria-controls");g(n)?(q=n.hash,p=h.element.find(h._sanitizeSelector(q))):(j=h._tabId(m),q="#"+j,p=h.element.find(q),p.length||(p=h._createPanel(j),p.insertAfter(h.panels[k-1]||h.tablist)),p.attr("aria-live","polite")),p.length&&(h.panels=h.panels.add(p)),t&&m.data("ui-tabs-aria-controls",t),m.attr({"aria-controls":q.substring(1),"aria-labelledby":e}),p.attr("aria-labelledby",e)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(h){return b("<div>").attr("id",h).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(j){b.isArray(j)&&(j.length?j.length===this.anchors.length&&(j=!0):j=!1);for(var h,k=0;h=this.tabs[k];k++){j===!0||-1!==b.inArray(k,j)?b(h).addClass("ui-state-disabled").attr("aria-disabled","true"):b(h).removeClass("ui-state-disabled").removeAttr("aria-disabled")}this.options.disabled=j},_setupEvents:function(j){var h={click:function(e){e.preventDefault()}};j&&b.each(j.split(" "),function(i,k){h[k]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,h),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(j){var h,k=this.element.parent();"fill"===j?(h=k.height(),h-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var i=b(this),l=i.css("position");"absolute"!==l&&"fixed"!==l&&(h-=i.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){h-=b(this).outerHeight(!0)}),this.panels.each(function(){b(this).height(Math.max(0,h-b(this).innerHeight()+b(this).height()))}).css("overflow","auto")):"auto"===j&&(h=0,this.panels.each(function(){h=Math.max(h,b(this).height("").height())}).height(h))},_eventHandler:function(u){var q=this.options,m=this.active,x=b(u.currentTarget),k=x.closest("li"),j=k[0]===m[0],w=j&&q.collapsible,p=w?b():this._getPanelForTab(k),t=m.length?this._getPanelForTab(m):b(),v={oldTab:m,oldPanel:t,newTab:w?b():k,newPanel:p};u.preventDefault(),k.hasClass("ui-state-disabled")||k.hasClass("ui-tabs-loading")||this.running||j&&!q.collapsible||this._trigger("beforeActivate",u,v)===!1||(q.active=w?!1:this.tabs.index(k),this.active=j?b():k,this.xhr&&this.xhr.abort(),t.length||p.length||b.error("jQuery UI Tabs: Mismatching fragment identifier."),p.length&&this.load(this.tabs.index(k),u),this._toggle(u,v))},_toggle:function(m,j){function q(){p.running=!1,p._trigger("activate",m,j)}function k(){j.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),l.length&&p.options.show?p._show(l,p.options.show,q):(l.show(),q())}var p=this,l=j.newPanel,h=j.oldPanel;this.running=!0,h.length&&this.options.hide?this._hide(h,this.options.hide,function(){j.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),k()}):(j.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),h.hide(),k()),h.attr({"aria-expanded":"false","aria-hidden":"true"}),j.oldTab.attr("aria-selected","false"),l.length&&h.length?j.oldTab.attr("tabIndex",-1):l.length&&this.tabs.filter(function(){return 0===b(this).attr("tabIndex")}).attr("tabIndex",-1),l.attr({"aria-expanded":"true","aria-hidden":"false"}),j.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(j){var h,k=this._findActive(j);k[0]!==this.active[0]&&(k.length||(k=this.active),h=k.find(".ui-tabs-anchor")[0],this._eventHandler({target:h,currentTarget:h,preventDefault:b.noop}))},_findActive:function(h){return h===!1?b():this.tabs.eq(h)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){b.data(this,"ui-tabs-destroy")?b(this).remove():b(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var j=b(this),h=j.data("ui-tabs-aria-controls");h?j.attr("aria-controls",h).removeData("ui-tabs-aria-controls"):j.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var h=this.options.disabled;h!==!1&&(e===d?h=!1:(e=this._getIndex(e),h=b.isArray(h)?b.map(h,function(i){return i!==e?i:null}):b.map(this.tabs,function(i,j){return j!==e?j:null})),this._setupDisabled(h))},disable:function(e){var h=this.options.disabled;if(h!==!0){if(e===d){h=!0}else{if(e=this._getIndex(e),-1!==b.inArray(e,h)){return}h=b.isArray(h)?b.merge([e],h).sort():[e]}this._setupDisabled(h)}},load:function(p,k){p=this._getIndex(p);var m=this,q=this.tabs.eq(p),n=q.find(".ui-tabs-anchor"),j=this._getPanelForTab(q),h={tab:q,panel:j};g(n[0])||(this.xhr=b.ajax(this._ajaxSettings(n,k,h)),this.xhr&&"canceled"!==this.xhr.statusText&&(q.addClass("ui-tabs-loading"),j.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){j.html(e),m._trigger("load",k,h)},1)}).complete(function(i,l){setTimeout(function(){"abort"===l&&m.panels.stop(!1,!0),q.removeClass("ui-tabs-loading"),j.removeAttr("aria-busy"),i===m.xhr&&delete m.xhr},1)})))},_ajaxSettings:function(k,h,l){var j=this;return{url:k.attr("href"),beforeSend:function(i,m){return j._trigger("beforeLoad",h,b.extend({jqXHR:i,ajaxSettings:m},l))}}},_getPanelForTab:function(j){var h=b(j).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+h))}})}($),
/*!
 * jQuery UI Tooltip 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/tooltip/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */
function(b){function c(g,f){var h=(g.attr("aria-describedby")||"").split(/\s+/);h.push(f),g.data("ui-tooltip-id",f).attr("aria-describedby",b.trim(h.join(" ")))}function a(h){var f=h.data("ui-tooltip-id"),j=(h.attr("aria-describedby")||"").split(/\s+/),g=b.inArray(f,j);-1!==g&&j.splice(g,1),h.removeData("ui-tooltip-id"),j=b.trim(j.join(" ")),j?h.attr("aria-describedby",j):h.removeAttr("aria-describedby")}var d=0;b.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var f=b(this).attr("title")||"";return b("<a>").text(f).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(g,f){var h=this;return"disabled"===g?(this[f?"_disable":"_enable"](),this.options[g]=f,void 0):(this._super(g,f),"content"===g&&b.each(this.tooltips,function(i,j){h._updateContent(j)}),void 0)},_disable:function(){var f=this;b.each(this.tooltips,function(e,h){var g=b.Event("blur");g.target=g.currentTarget=h[0],f.close(g,!0)}),this.element.find(this.options.items).addBack().each(function(){var g=b(this);g.is("[title]")&&g.data("ui-tooltip-title",g.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var f=b(this);f.data("ui-tooltip-title")&&f.attr("title",f.data("ui-tooltip-title"))})},open:function(g){var f=this,h=b(g?g.target:this.element).closest(this.options.items);h.length&&!h.data("ui-tooltip-id")&&(h.attr("title")&&h.data("ui-tooltip-title",h.attr("title")),h.data("ui-tooltip-open",!0),g&&"mouseover"===g.type&&h.parents().each(function(){var i,j=b(this);j.data("ui-tooltip-open")&&(i=b.Event("blur"),i.target=i.currentTarget=this,f.close(i,!0)),j.attr("title")&&(j.uniqueId(),f.parents[this.id]={element:this,title:j.attr("title")},j.attr("title",""))}),this._updateContent(h,g))},_updateContent:function(g,j){var f,l=this.options.content,h=this,k=j?j.type:null;return"string"==typeof l?this._open(j,g,l):(f=l.call(g[0],function(e){g.data("ui-tooltip-open")&&h._delay(function(){j&&(j.type=k),this._open(j,g,e)})}),f&&this._open(j,g,f),void 0)},_open:function(g,q,k){function p(h){j.of=h,m.is(":hidden")||m.position(j)}var m,f,e,j=b.extend({},this.options.position);if(k){if(m=this._find(q),m.length){return m.find(".ui-tooltip-content").html(k),void 0}q.is("[title]")&&(g&&"mouseover"===g.type?q.attr("title",""):q.removeAttr("title")),m=this._tooltip(q),c(q,m.attr("id")),m.find(".ui-tooltip-content").html(k),this.options.track&&g&&/^mouse/.test(g.type)?(this._on(this.document,{mousemove:p}),p(g)):m.position(b.extend({of:q},this.options.position)),m.hide(),this._show(m,this.options.show),this.options.show&&this.options.show.delay&&(e=this.delayedShow=setInterval(function(){m.is(":visible")&&(p(j.of),clearInterval(e))},b.fx.interval)),this._trigger("open",g,{tooltip:m}),f={keyup:function(l){if(l.keyCode===b.ui.keyCode.ESCAPE){var h=b.Event(l);h.currentTarget=q[0],this.close(h,!0)}},remove:function(){this._removeTooltip(m)}},g&&"mouseover"!==g.type||(f.mouseleave="close"),g&&"focusin"!==g.type||(f.focusout="close"),this._on(!0,q,f)}},close:function(g){var i=this,f=b(g?g.currentTarget:this.element),h=this._find(f);this.closing||(clearInterval(this.delayedShow),f.data("ui-tooltip-title")&&f.attr("title",f.data("ui-tooltip-title")),a(f),h.stop(!0),this._hide(h,this.options.hide,function(){i._removeTooltip(b(this))}),f.removeData("ui-tooltip-open"),this._off(f,"mouseleave focusout keyup"),f[0]!==this.element[0]&&this._off(f,"remove"),this._off(this.document,"mousemove"),g&&"mouseleave"===g.type&&b.each(this.parents,function(k,j){b(j.element).attr("title",j.title),delete i.parents[k]}),this.closing=!0,this._trigger("close",g,{tooltip:h}),this.closing=!1)},_tooltip:function(h){var f="ui-tooltip-"+d++,g=b("<div>").attr({id:f,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return b("<div>").addClass("ui-tooltip-content").appendTo(g),g.appendTo(this.document[0].body),this.tooltips[f]=h,g},_find:function(g){var f=g.data("ui-tooltip-id");return f?b("#"+f):b()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var f=this;b.each(this.tooltips,function(e,h){var g=b.Event("blur");g.target=g.currentTarget=h[0],f.close(g,!0),b("#"+e).remove(),h.data("ui-tooltip-title")&&(h.attr("title",h.data("ui-tooltip-title")),h.removeData("ui-tooltip-title"))})}})}($),function(a){var b=null;a.modal=function(c,f){a.modal.close();var d,e;if(this.$body=a("body"),this.options=a.extend({},a.modal.defaults,f),c.is("a")){if(e=c.attr("href"),/^#/.test(e)){if(this.$elm=a(e),1!==this.$elm.length){return null}this.open()}else{this.$elm=a("<div>"),this.$body.append(this.$elm),d=function(g,h){h.elm.remove()},this.showSpinner(),c.trigger(a.modal.AJAX_SEND),a.get(e).done(function(g){b&&(c.trigger(a.modal.AJAX_SUCCESS),b.$elm.empty().append(g).on(a.modal.CLOSE,d),b.hideSpinner(),b.open(),c.trigger(a.modal.AJAX_COMPLETE))}).fail(function(){c.trigger(a.modal.AJAX_FAIL),b.hideSpinner(),c.trigger(a.modal.AJAX_COMPLETE)})}}else{this.$elm=c,this.open()}},a.modal.prototype={constructor:a.modal,open:function(){this.block(),this.show(),this.options.escapeClose&&a(document).on("keydown.modal",function(c){27==c.which&&a.modal.close()}),this.options.clickClose&&this.blocker.click(a.modal.close)},close:function(){this.unblock(),this.hide(),a(document).off("keydown.modal")},block:function(){this.$elm.trigger(a.modal.BEFORE_BLOCK,[this._ctx()]),this.blocker=a('<div class="jquery-modal blocker"></div>').css({top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",position:"fixed",zIndex:this.options.zIndex,background:this.options.overlay,opacity:this.options.opacity}),this.$body.append(this.blocker),this.$elm.trigger(a.modal.BLOCK,[this._ctx()])},unblock:function(){this.blocker.remove()},show:function(){this.$elm.trigger(a.modal.BEFORE_OPEN,[this._ctx()]),this.options.showClose&&(this.closeButton=a('<a href="#close-modal" rel="modal:close" class="close-modal">'+this.options.closeText+"</a>"),this.$elm.append(this.closeButton)),this.$elm.addClass(this.options.modalClass+" current"),this.center(),this.$elm.show().trigger(a.modal.OPEN,[this._ctx()])},hide:function(){this.$elm.trigger(a.modal.BEFORE_CLOSE,[this._ctx()]),this.closeButton&&this.closeButton.remove(),this.$elm.removeClass("current").hide(),this.$elm.trigger(a.modal.CLOSE,[this._ctx()])},showSpinner:function(){this.options.showSpinner&&(this.spinner=this.spinner||a('<div class="'+this.options.modalClass+'-spinner"></div>').append(this.options.spinnerHtml),this.$body.append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&this.spinner.remove()},center:function(){this.$elm.css({position:"fixed",top:"50%",left:"50%",marginTop:-(this.$elm.outerHeight()/2),marginLeft:-(this.$elm.outerWidth()/2),zIndex:this.options.zIndex+1})},_ctx:function(){return{elm:this.$elm,blocker:this.blocker,options:this.options}}},a.modal.prototype.resize=a.modal.prototype.center,a.modal.close=function(d){if(b){d&&d.preventDefault(),b.close();var c=b.$elm;return b=null,c}},a.modal.resize=function(){b&&b.resize()},a.modal.defaults={overlay:"#000",opacity:0.75,zIndex:1,escapeClose:!0,clickClose:!0,closeText:"Close",modalClass:"modal",spinnerHtml:null,showSpinner:!0,showClose:!0},a.modal.BEFORE_BLOCK="modal:before-block",a.modal.BLOCK="modal:block",a.modal.BEFORE_OPEN="modal:before-open",a.modal.OPEN="modal:open",a.modal.BEFORE_CLOSE="modal:before-close",a.modal.CLOSE="modal:close",a.modal.AJAX_SEND="modal:ajax:send",a.modal.AJAX_SUCCESS="modal:ajax:success",a.modal.AJAX_FAIL="modal:ajax:fail",a.modal.AJAX_COMPLETE="modal:ajax:complete",a.fn.modal=function(c){return 1===this.length&&(b=new a.modal(this,c)),this},a(document).on("click.modal",'a[rel="modal:close"]',a.modal.close),a(document).on("click.modal",'a[rel="modal:open"]',function(c){c.preventDefault(),a(this).modal()})}($);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/vendor/jquery.jeditable.js' */
(function($){$.fn.editable=function(target,options){if("disable"==target){$(this).data("disabled.editable",true);return}if("enable"==target){$(this).data("disabled.editable",false);return}if("destroy"==target){$(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");return}var settings=$.extend({},$.fn.editable.defaults,{target:target},options);var plugin=$.editable.types[settings.type].plugin||function(){};var submit=$.editable.types[settings.type].submit||function(){};var buttons=$.editable.types[settings.type].buttons||$.editable.types.defaults.buttons;var content=$.editable.types[settings.type].content||$.editable.types.defaults.content;var element=$.editable.types[settings.type].element||$.editable.types.defaults.element;var reset=$.editable.types[settings.type].reset||$.editable.types.defaults.reset;var callback=settings.callback||function(){};var onedit=settings.onedit||function(){};var onsubmit=settings.onsubmit||function(){};var onreset=settings.onreset||function(){};var onerror=settings.onerror||reset;if(settings.tooltip){$(this).attr("title",settings.tooltip)}settings.autowidth="auto"==settings.width;settings.autoheight="auto"==settings.height;return this.each(function(){var self=this;var savedwidth=$(self).width();var savedheight=$(self).height();$(this).data("event.editable",settings.event);if(!$.trim($(this).html())){$(this).html(settings.placeholder)}$(this).bind(settings.event,function(e){if(true===$(this).data("disabled.editable")){return}if(self.editing){return}if(false===onedit.apply(this,[settings,self])){return}e.preventDefault();e.stopPropagation();if(settings.tooltip){$(self).removeAttr("title")}if(0==$(self).width()){settings.width=savedwidth;settings.height=savedheight}else{if(settings.width!="none"){settings.width=settings.autowidth?$(self).width():settings.width}if(settings.height!="none"){settings.height=settings.autoheight?$(self).height():settings.height}}if($(this).html().toLowerCase().replace(/(;|")/g,"")==settings.placeholder.toLowerCase().replace(/(;|")/g,"")){$(this).html("")}self.editing=true;self.revert=$(self).html();$(self).html("");var form=$("<form />");if(settings.cssclass){if("inherit"==settings.cssclass){form.attr("class",$(self).attr("class"))}else{form.attr("class",settings.cssclass)}}if(settings.style){if("inherit"==settings.style){form.attr("style",$(self).attr("style"));form.css("display",$(self).css("display"))}else{form.attr("style",settings.style)}}var input=element.apply(form,[settings,self]);var input_content;if(settings.loadurl){var t=setTimeout(function(){input.disabled=true;content.apply(form,[settings.loadtext,settings,self])},100);var loaddata={};loaddata[settings.id]=self.id;if($.isFunction(settings.loaddata)){$.extend(loaddata,settings.loaddata.apply(self,[self.revert,settings]))}else{$.extend(loaddata,settings.loaddata)}$.ajax({type:settings.loadtype,url:settings.loadurl,data:loaddata,async:false,success:function(result){window.clearTimeout(t);input_content=result;input.disabled=false}})}else{if(settings.data){input_content=settings.data;if($.isFunction(settings.data)){input_content=settings.data.apply(self,[self.revert,settings])}}else{input_content=$("<textarea/>").html(self.revert).val()}}content.apply(form,[input_content,settings,self]);input.attr("name",settings.name);buttons.apply(form,[settings,self]);$(self).append(form);plugin.apply(form,[settings,self]);$(":input:visible:enabled:first",form).focus();if(settings.select){input.select()}input.keydown(function(e){if(e.keyCode==27){e.preventDefault();reset.apply(form,[settings,self])}});var t;if("cancel"==settings.onblur){input.blur(function(e){t=setTimeout(function(){reset.apply(form,[settings,self])},500)})}else{if("submit"==settings.onblur){input.blur(function(e){t=setTimeout(function(){form.submit()},200)})}else{if($.isFunction(settings.onblur)){input.blur(function(e){settings.onblur.apply(self,[input.val(),settings])})}else{input.blur(function(e){})}}}form.submit(function(e){if(t){clearTimeout(t)}e.preventDefault();if(false!==onsubmit.apply(form,[settings,self])){if(false!==submit.apply(form,[settings,self])){if($.isFunction(settings.target)){var str=settings.target.apply(self,[input.val(),settings]);$(self).html(str);self.editing=false;callback.apply(self,[self.innerHTML,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder)}}else{var submitdata={};submitdata[settings.name]=input.val();submitdata[settings.id]=self.id;if($.isFunction(settings.submitdata)){$.extend(submitdata,settings.submitdata.apply(self,[self.revert,settings]))}else{$.extend(submitdata,settings.submitdata)}if("PUT"==settings.method){submitdata._method="put"}$(self).html(settings.indicator);var ajaxoptions={type:"POST",data:submitdata,dataType:"html",url:settings.target,success:function(result,status){if(ajaxoptions.dataType=="html"){$(self).html(result)}self.editing=false;callback.apply(self,[result,settings]);if(!$.trim($(self).html())){$(self).html(settings.placeholder)}},error:function(xhr,status,error){onerror.apply(form,[settings,self,xhr])}};$.extend(ajaxoptions,settings.ajaxoptions);$.ajax(ajaxoptions)}}}$(self).attr("title",settings.tooltip);return false})});this.reset=function(form){if(this.editing){if(false!==onreset.apply(form,[settings,self])){$(self).html(self.revert);self.editing=false;if(!$.trim($(self).html())){$(self).html(settings.placeholder)}if(settings.tooltip){$(self).attr("title",settings.tooltip)}}}}})};$.editable={types:{defaults:{element:function(settings,original){var input=$('<input type="hidden"></input>');$(this).append(input);return(input)},content:function(string,settings,original){$(":input:first",this).val(string)},reset:function(settings,original){original.reset(this)},buttons:function(settings,original){var form=this;if(settings.submit){if(settings.submit.match(/>$/)){var submit=$(settings.submit).click(function(){if(submit.attr("type")!="submit"){form.submit()}})}else{var submit=$('<button type="submit" />');submit.html(settings.submit)}$(this).append(submit)}if(settings.cancel){if(settings.cancel.match(/>$/)){var cancel=$(settings.cancel)}else{var cancel=$('<button type="cancel" />');cancel.html(settings.cancel)}$(this).append(cancel);$(cancel).click(function(event){if($.isFunction($.editable.types[settings.type].reset)){var reset=$.editable.types[settings.type].reset}else{var reset=$.editable.types.defaults.reset}reset.apply(form,[settings,original]);return false})}}},text:{element:function(settings,original){var input=$('<input type="text" class="text" />');if(settings.width!="none"){input.width(settings.width)}if(settings.height!="none"){input.height(settings.height)}input.attr("autocomplete","off");$(this).append(input);return(input)}},textarea:{element:function(settings,original){var textarea=$("<textarea />");if(settings.rows){textarea.attr("rows",settings.rows)}else{if(settings.height!="none"){textarea.height(settings.height)}}if(settings.cols){textarea.attr("cols",settings.cols)}else{if(settings.width!="none"){textarea.width(settings.width)}}$(this).append(textarea);return(textarea)}},select:{element:function(settings,original){var select=$("<select />");$(this).append(select);return(select)},content:function(data,settings,original){if(String==data.constructor){eval("var json = "+data)}else{var json=data}for(var key in json){if(!json.hasOwnProperty(key)){continue}if("selected"==key){continue}var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}$("select",this).children().each(function(){if($(this).val()==json.selected||$(this).text()==$.trim(original.revert)){$(this).attr("selected","selected")}})}}},addInputType:function(name,input){$.editable.types[name]=input}};$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}})($);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/vendor/jquery.timeago.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a($)}}(function(d){d.timeago=function(h){if(h instanceof Date){return a(h)}else{if(typeof h==="string"){return a(d.timeago.parse(h))}else{if(typeof h==="number"){return a(new Date(h))}else{return a(d.timeago.datetime(h))}}}};var g=d.timeago;d.extend(d.timeago,{settings:{refreshMillis:60000,allowFuture:false,localeTitle:false,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(n){var o=this.settings.strings;var k=o.prefixAgo;var s=o.suffixAgo;if(this.settings.allowFuture){if(n<0){k=o.prefixFromNow;s=o.suffixFromNow}}var q=Math.abs(n)/1000;var h=q/60;var p=h/60;var r=p/24;var l=r/365;function j(t,v){var u=d.isFunction(t)?t(v,n):t;var w=(o.numbers&&o.numbers[v])||v;return u.replace(/%d/i,w)}var m=q<45&&j(o.seconds,Math.round(q))||q<90&&j(o.minute,1)||h<45&&j(o.minutes,Math.round(h))||h<90&&j(o.hour,1)||p<24&&j(o.hours,Math.round(p))||p<42&&j(o.day,1)||r<30&&j(o.days,Math.round(r))||r<45&&j(o.month,1)||r<365&&j(o.months,Math.round(r/30))||l<1.5&&j(o.year,1)||j(o.years,Math.round(l));var i=o.wordSeparator||"";if(o.wordSeparator===undefined){i=" "}return d.trim([k,m,s].join(i))},parse:function(i){var h=d.trim(i);h=h.replace(/\.\d+/,"");h=h.replace(/-/,"/").replace(/-/,"/");h=h.replace(/T/," ").replace(/Z/," UTC");h=h.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(h)},datetime:function(i){var h=g.isTime(i)?d(i).attr("datetime"):d(i).attr("title");return g.parse(h)},isTime:function(h){return d(h).get(0).tagName.toLowerCase()==="time"}});var e={init:function(){var i=d.proxy(c,this);i();var h=g.settings;if(h.refreshMillis>0){setInterval(i,h.refreshMillis)}},update:function(h){d(this).data("timeago",{datetime:g.parse(h)});c.apply(this)},updateFromDOM:function(){d(this).data("timeago",{datetime:g.parse(g.isTime(this)?d(this).attr("datetime"):d(this).attr("title"))});c.apply(this)}};d.fn.timeago=function(j,h){var i=j?e[j]:e.init;if(!i){throw new Error("Unknown function name '"+j+"' for timeago")}this.each(function(){i.call(this,h)});return this};function c(){var i=b(this);var h=g.settings;if(!isNaN(i.datetime)){if(h.cutoff==0||f(i.datetime)<h.cutoff){d(this).text(a(i.datetime))}}return this}function b(h){h=d(h);if(!h.data("timeago")){h.data("timeago",{datetime:g.datetime(h)});var i=d.trim(h.text());if(g.settings.localeTitle){h.attr("title",h.data("timeago").datetime.toLocaleString())}else{if(i.length>0&&!(g.isTime(h)&&h.attr("title"))){h.attr("title",i)}}}return h.data("timeago")}function a(h){return g.inWords(f(h))}function f(h){return(new Date().getTime()-h.getTime())}document.createElement("abbr");document.createElement("time")}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/vendor/jquery.serializeJSON.js' */
/*!
  SerializeJSON jQuery plugin.
  https://github.com/marioizquierdo/jquery.serializeJSON
  version 1.0.1 (Aug 20, 2012)

  Copyright (c) 2012 Mario Izquierdo
  Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
  and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
*/
(function(b){b.fn.serializeJSON=function(){var d,c;d={};c=this.serializeArray();b.each(c,function(g,e){var f,j,h;f=e.name;j=e.value;h=b.map(f.split("["),function(i){var k;k=i[i.length-1];return k==="]"?i.substring(0,i.length-1):i});if(h[0]===""){h.shift()}b.deepSet(d,h,j)});return d};var a=function(c){return c===Object(c)};b.deepSet=function(c,k,g){if(!k||k.length===0){throw new Error("ArgumentError: keys param expected to be an array with least one key")}var i,d,f,h,j,e;i=k[0];d=k[1];if(d!==undefined&&d!==null){f=k.slice(1);if(i===""){j=c.length-1;e=c[c.length-1];if(a(e)&&!e[d]){i=j}else{c.push({});i=j+1}}if(c[i]===undefined){h=(d===""||!isNaN(parseInt(d,10)))?[]:{};c[i]=h}b.deepSet(c[i],f,g)}else{if(i===""){c.push(g)}else{c[i]=g}}}}($));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/vendor/underscore.js' */
(function(){var w=this;var k=w._;var D={};var C=Array.prototype,f=Object.prototype,r=Function.prototype;var G=C.push,o=C.slice,y=C.concat,d=f.toString,j=f.hasOwnProperty;var K=C.forEach,q=C.map,E=C.reduce,c=C.reduceRight,b=C.filter,B=C.every,p=C.some,n=C.indexOf,l=C.lastIndexOf,u=Array.isArray,e=Object.keys,F=r.bind;var L=function(M){if(M instanceof L){return M}if(!(this instanceof L)){return new L(M)}this._wrapped=M};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=L}exports._=L}else{w._=L}L.VERSION="1.4.4";var H=L.each=L.forEach=function(R,Q,P){if(R==null){return}if(K&&R.forEach===K){R.forEach(Q,P)}else{if(R.length===+R.length){for(var O=0,M=R.length;O<M;O++){if(Q.call(P,R[O],O,R)===D){return}}}else{for(var N in R){if(L.has(R,N)){if(Q.call(P,R[N],N,R)===D){return}}}}}};L.map=L.collect=function(P,O,N){var M=[];if(P==null){return M}if(q&&P.map===q){return P.map(O,N)}H(P,function(S,Q,R){M[M.length]=O.call(N,S,Q,R)});return M};var g="Reduce of empty array with no initial value";L.reduce=L.foldl=L.inject=function(Q,P,M,O){var N=arguments.length>2;if(Q==null){Q=[]}if(E&&Q.reduce===E){if(O){P=L.bind(P,O)}return N?Q.reduce(P,M):Q.reduce(P)}H(Q,function(T,R,S){if(!N){M=T;N=true}else{M=P.call(O,M,T,R,S)}});if(!N){throw new TypeError(g)}return M};L.reduceRight=L.foldr=function(S,P,M,O){var N=arguments.length>2;if(S==null){S=[]}if(c&&S.reduceRight===c){if(O){P=L.bind(P,O)}return N?S.reduceRight(P,M):S.reduceRight(P)}var R=S.length;if(R!==+R){var Q=L.keys(S);R=Q.length}H(S,function(V,T,U){T=Q?Q[--R]:--R;if(!N){M=S[T];N=true}else{M=P.call(O,M,S[T],T,U)}});if(!N){throw new TypeError(g)}return M};L.find=L.detect=function(P,O,N){var M;A(P,function(S,Q,R){if(O.call(N,S,Q,R)){M=S;return true}});return M};L.filter=L.select=function(P,O,N){var M=[];if(P==null){return M}if(b&&P.filter===b){return P.filter(O,N)}H(P,function(S,Q,R){if(O.call(N,S,Q,R)){M[M.length]=S}});return M};L.reject=function(O,N,M){return L.filter(O,function(R,P,Q){return !N.call(M,R,P,Q)},M)};L.every=L.all=function(P,O,N){O||(O=L.identity);var M=true;if(P==null){return M}if(B&&P.every===B){return P.every(O,N)}H(P,function(S,Q,R){if(!(M=M&&O.call(N,S,Q,R))){return D}});return !!M};var A=L.some=L.any=function(P,O,N){O||(O=L.identity);var M=false;if(P==null){return M}if(p&&P.some===p){return P.some(O,N)}H(P,function(S,Q,R){if(M||(M=O.call(N,S,Q,R))){return D}});return !!M};L.contains=L.include=function(N,M){if(N==null){return false}if(n&&N.indexOf===n){return N.indexOf(M)!=-1}return A(N,function(O){return O===M})};L.invoke=function(O,P){var M=o.call(arguments,2);var N=L.isFunction(P);return L.map(O,function(Q){return(N?P:Q[P]).apply(Q,M)})};L.pluck=function(N,M){return L.map(N,function(O){return O[M]})};L.where=function(N,M,O){if(L.isEmpty(M)){return O?null:[]}return L[O?"find":"filter"](N,function(Q){for(var P in M){if(M[P]!==Q[P]){return false}}return true})};L.findWhere=function(N,M){return L.where(N,M,true)};L.max=function(P,O,N){if(!O&&L.isArray(P)&&P[0]===+P[0]&&P.length<65535){return Math.max.apply(Math,P)}if(!O&&L.isEmpty(P)){return -Infinity}var M={computed:-Infinity,value:-Infinity};H(P,function(T,Q,S){var R=O?O.call(N,T,Q,S):T;R>=M.computed&&(M={value:T,computed:R})});return M.value};L.min=function(P,O,N){if(!O&&L.isArray(P)&&P[0]===+P[0]&&P.length<65535){return Math.min.apply(Math,P)}if(!O&&L.isEmpty(P)){return Infinity}var M={computed:Infinity,value:Infinity};H(P,function(T,Q,S){var R=O?O.call(N,T,Q,S):T;R<M.computed&&(M={value:T,computed:R})});return M.value};L.shuffle=function(P){var O;var N=0;var M=[];H(P,function(Q){O=L.random(N++);M[N-1]=M[O];M[O]=Q});return M};var a=function(M){return L.isFunction(M)?M:function(N){return N[M]}};L.sortBy=function(P,O,M){var N=a(O);return L.pluck(L.map(P,function(S,Q,R){return{value:S,index:Q,criteria:N.call(M,S,Q,R)}}).sort(function(T,S){var R=T.criteria;var Q=S.criteria;if(R!==Q){if(R>Q||R===void 0){return 1}if(R<Q||Q===void 0){return -1}}return T.index<S.index?-1:1}),"value")};var t=function(R,Q,N,P){var M={};var O=a(Q||L.identity);H(R,function(U,S){var T=O.call(N,U,S,R);P(M,T,U)});return M};L.groupBy=function(O,N,M){return t(O,N,M,function(P,Q,R){(L.has(P,Q)?P[Q]:(P[Q]=[])).push(R)})};L.countBy=function(O,N,M){return t(O,N,M,function(P,Q){if(!L.has(P,Q)){P[Q]=0}P[Q]++})};L.sortedIndex=function(T,S,P,O){P=P==null?L.identity:a(P);var R=P.call(O,S);var M=0,Q=T.length;while(M<Q){var N=(M+Q)>>>1;P.call(O,T[N])<R?M=N+1:Q=N}return M};L.toArray=function(M){if(!M){return[]}if(L.isArray(M)){return o.call(M)}if(M.length===+M.length){return L.map(M,L.identity)}return L.values(M)};L.size=function(M){if(M==null){return 0}return(M.length===+M.length)?M.length:L.keys(M).length};L.first=L.head=L.take=function(O,N,M){if(O==null){return void 0}return(N!=null)&&!M?o.call(O,0,N):O[0]};L.initial=function(O,N,M){return o.call(O,0,O.length-((N==null)||M?1:N))};L.last=function(O,N,M){if(O==null){return void 0}if((N!=null)&&!M){return o.call(O,Math.max(O.length-N,0))}else{return O[O.length-1]}};L.rest=L.tail=L.drop=function(O,N,M){return o.call(O,(N==null)||M?1:N)};L.compact=function(M){return L.filter(M,L.identity)};var x=function(N,O,M){H(N,function(P){if(L.isArray(P)){O?G.apply(M,P):x(P,O,M)}else{M.push(P)}});return M};L.flatten=function(N,M){return x(N,M,[])};L.without=function(M){return L.difference(M,o.call(arguments,1))};L.uniq=L.unique=function(S,R,Q,P){if(L.isFunction(R)){P=Q;Q=R;R=false}var N=Q?L.map(S,Q,P):S;var O=[];var M=[];H(N,function(U,T){if(R?(!T||M[M.length-1]!==U):!L.contains(M,U)){M.push(U);O.push(S[T])}});return O};L.union=function(){return L.uniq(y.apply(C,arguments))};L.intersection=function(N){var M=o.call(arguments,1);return L.filter(L.uniq(N),function(O){return L.every(M,function(P){return L.indexOf(P,O)>=0})})};L.difference=function(N){var M=y.apply(C,o.call(arguments,1));return L.filter(N,function(O){return !L.contains(M,O)})};L.zip=function(){var M=o.call(arguments);var P=L.max(L.pluck(M,"length"));var O=new Array(P);for(var N=0;N<P;N++){O[N]=L.pluck(M,""+N)}return O};L.object=function(Q,O){if(Q==null){return{}}var M={};for(var P=0,N=Q.length;P<N;P++){if(O){M[Q[P]]=O[P]}else{M[Q[P][0]]=Q[P][1]}}return M};L.indexOf=function(Q,O,P){if(Q==null){return -1}var N=0,M=Q.length;if(P){if(typeof P=="number"){N=(P<0?Math.max(0,M+P):P)}else{N=L.sortedIndex(Q,O);return Q[N]===O?N:-1}}if(n&&Q.indexOf===n){return Q.indexOf(O,P)}for(;N<M;N++){if(Q[N]===O){return N}}return -1};L.lastIndexOf=function(Q,O,P){if(Q==null){return -1}var M=P!=null;if(l&&Q.lastIndexOf===l){return M?Q.lastIndexOf(O,P):Q.lastIndexOf(O)}var N=(M?P:Q.length);while(N--){if(Q[N]===O){return N}}return -1};L.range=function(R,P,Q){if(arguments.length<=1){P=R||0;R=0}Q=arguments[2]||1;var N=Math.max(Math.ceil((P-R)/Q),0);var M=0;var O=new Array(N);while(M<N){O[M++]=R;R+=Q}return O};L.bind=function(O,N){if(O.bind===F&&F){return F.apply(O,o.call(arguments,1))}var M=o.call(arguments,2);return function(){return O.apply(N,M.concat(o.call(arguments)))}};L.partial=function(N){var M=o.call(arguments,1);return function(){return N.apply(this,M.concat(o.call(arguments)))}};L.bindAll=function(N){var M=o.call(arguments,1);if(M.length===0){M=L.functions(N)}H(M,function(O){N[O]=L.bind(N[O],N)});return N};L.memoize=function(O,N){var M={};N||(N=L.identity);return function(){var P=N.apply(this,arguments);return L.has(M,P)?M[P]:(M[P]=O.apply(this,arguments))}};L.delay=function(N,O){var M=o.call(arguments,2);return setTimeout(function(){return N.apply(null,M)},O)};L.defer=function(M){return L.delay.apply(L,[M,1].concat(o.call(arguments,1)))};L.throttle=function(R,T){var P,O,S,M;var Q=0;var N=function(){Q=new Date;S=null;M=R.apply(P,O)};return function(){var U=new Date;var V=T-(U-Q);P=this;O=arguments;if(V<=0){clearTimeout(S);S=null;Q=U;M=R.apply(P,O)}else{if(!S){S=setTimeout(N,V)}}return M}};L.debounce=function(O,Q,N){var P,M;return function(){var U=this,T=arguments;var S=function(){P=null;if(!N){M=O.apply(U,T)}};var R=N&&!P;clearTimeout(P);P=setTimeout(S,Q);if(R){M=O.apply(U,T)}return M}};L.once=function(O){var M=false,N;return function(){if(M){return N}M=true;N=O.apply(this,arguments);O=null;return N}};L.wrap=function(M,N){return function(){var O=[M];G.apply(O,arguments);return N.apply(this,O)}};L.compose=function(){var M=arguments;return function(){var N=arguments;for(var O=M.length-1;O>=0;O--){N=[M[O].apply(this,N)]}return N[0]}};L.after=function(N,M){if(N<=0){return M()}return function(){if(--N<1){return M.apply(this,arguments)}}};L.keys=e||function(O){if(O!==Object(O)){throw new TypeError("Invalid object")}var N=[];for(var M in O){if(L.has(O,M)){N[N.length]=M}}return N};L.values=function(O){var M=[];for(var N in O){if(L.has(O,N)){M.push(O[N])}}return M};L.pairs=function(O){var N=[];for(var M in O){if(L.has(O,M)){N.push([M,O[M]])}}return N};L.invert=function(O){var M={};for(var N in O){if(L.has(O,N)){M[O[N]]=N}}return M};L.functions=L.methods=function(O){var N=[];for(var M in O){if(L.isFunction(O[M])){N.push(M)}}return N.sort()};L.extend=function(M){H(o.call(arguments,1),function(N){if(N){for(var O in N){M[O]=N[O]}}});return M};L.pick=function(N){var O={};var M=y.apply(C,o.call(arguments,1));H(M,function(P){if(P in N){O[P]=N[P]}});return O};L.omit=function(O){var P={};var N=y.apply(C,o.call(arguments,1));for(var M in O){if(!L.contains(N,M)){P[M]=O[M]}}return P};L.defaults=function(M){H(o.call(arguments,1),function(N){if(N){for(var O in N){if(M[O]==null){M[O]=N[O]}}}});return M};L.clone=function(M){if(!L.isObject(M)){return M}return L.isArray(M)?M.slice():L.extend({},M)};L.tap=function(N,M){M(N);return N};var I=function(T,S,N,O){if(T===S){return T!==0||1/T==1/S}if(T==null||S==null){return T===S}if(T instanceof L){T=T._wrapped}if(S instanceof L){S=S._wrapped}var Q=d.call(T);if(Q!=d.call(S)){return false}switch(Q){case"[object String]":return T==String(S);case"[object Number]":return T!=+T?S!=+S:(T==0?1/T==1/S:T==+S);case"[object Date]":case"[object Boolean]":return +T==+S;case"[object RegExp]":return T.source==S.source&&T.global==S.global&&T.multiline==S.multiline&&T.ignoreCase==S.ignoreCase}if(typeof T!="object"||typeof S!="object"){return false}var M=N.length;while(M--){if(N[M]==T){return O[M]==S}}N.push(T);O.push(S);var V=0,W=true;if(Q=="[object Array]"){V=T.length;W=V==S.length;if(W){while(V--){if(!(W=I(T[V],S[V],N,O))){break}}}}else{var R=T.constructor,P=S.constructor;if(R!==P&&!(L.isFunction(R)&&(R instanceof R)&&L.isFunction(P)&&(P instanceof P))){return false}for(var U in T){if(L.has(T,U)){V++;if(!(W=L.has(S,U)&&I(T[U],S[U],N,O))){break}}}if(W){for(U in S){if(L.has(S,U)&&!(V--)){break}}W=!V}}N.pop();O.pop();return W};L.isEqual=function(N,M){return I(N,M,[],[])};L.isEmpty=function(N){if(N==null){return true}if(L.isArray(N)||L.isString(N)){return N.length===0}for(var M in N){if(L.has(N,M)){return false}}return true};L.isElement=function(M){return !!(M&&M.nodeType===1)};L.isArray=u||function(M){return d.call(M)=="[object Array]"};L.isObject=function(M){return M===Object(M)};H(["Arguments","Function","String","Number","Date","RegExp"],function(M){L["is"+M]=function(N){return d.call(N)=="[object "+M+"]"}});if(!L.isArguments(arguments)){L.isArguments=function(M){return !!(M&&L.has(M,"callee"))}}if(typeof(/./)!=="function"){L.isFunction=function(M){return typeof M==="function"}}L.isFinite=function(M){return isFinite(M)&&!isNaN(parseFloat(M))};L.isNaN=function(M){return L.isNumber(M)&&M!=+M};L.isBoolean=function(M){return M===true||M===false||d.call(M)=="[object Boolean]"};L.isNull=function(M){return M===null};L.isUndefined=function(M){return M===void 0};L.has=function(N,M){return j.call(N,M)};L.noConflict=function(){w._=k;return this};L.identity=function(M){return M};L.times=function(Q,P,O){var M=Array(Q);for(var N=0;N<Q;N++){M[N]=P.call(O,N)}return M};L.random=function(N,M){if(M==null){M=N;N=0}return N+Math.floor(Math.random()*(M-N+1))};var m={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};m.unescape=L.invert(m.escape);var J={escape:new RegExp("["+L.keys(m.escape).join("")+"]","g"),unescape:new RegExp("("+L.keys(m.unescape).join("|")+")","g")};L.each(["escape","unescape"],function(M){L[M]=function(N){if(N==null){return""}return(""+N).replace(J[M],function(O){return m[M][O]})}});L.result=function(M,O){if(M==null){return null}var N=M[O];return L.isFunction(N)?N.call(M):N};L.mixin=function(M){H(L.functions(M),function(N){var O=L[N]=M[N];L.prototype[N]=function(){var P=[this._wrapped];G.apply(P,arguments);return s.call(this,O.apply(L,P))}})};var z=0;L.uniqueId=function(M){var N=++z+"";return M?M+N:N};L.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var v=/(.)^/;var h={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var i=/\\|'|\r|\n|\t|\u2028|\u2029/g;L.template=function(U,P,O){var N;O=L.defaults({},O,L.templateSettings);var Q=new RegExp([(O.escape||v).source,(O.interpolate||v).source,(O.evaluate||v).source].join("|")+"|$","g");var R=0;var M="__p+='";U.replace(Q,function(W,X,V,Z,Y){M+=U.slice(R,Y).replace(i,function(aa){return"\\"+h[aa]});if(X){M+="'+\n((__t=("+X+"))==null?'':_.escape(__t))+\n'"}if(V){M+="'+\n((__t=("+V+"))==null?'':__t)+\n'"}if(Z){M+="';\n"+Z+"\n__p+='"}R=Y+W.length;return W});M+="';\n";if(!O.variable){M="with(obj||{}){\n"+M+"}\n"}M="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+M+"return __p;\n";try{N=new Function(O.variable||"obj","_",M)}catch(S){S.source=M;throw S}if(P){return N(P,L)}var T=function(V){return N.call(this,V,L)};T.source="function("+(O.variable||"obj")+"){\n"+M+"}";return T};L.chain=function(M){return L(M).chain()};var s=function(M){return this._chain?L(M).chain():M};L.mixin(L);H(["pop","push","reverse","shift","sort","splice","unshift"],function(M){var N=C[M];L.prototype[M]=function(){var O=this._wrapped;N.apply(O,arguments);if((M=="shift"||M=="splice")&&O.length===0){delete O[0]}return s.call(this,O)}});H(["concat","join","slice"],function(M){var N=C[M];L.prototype[M]=function(){return s.call(this,N.apply(this._wrapped,arguments))}});L.extend(L.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/vendor/backbone.js' */
(function(){var u=this;var B=u.Backbone;var g=[];var D=g.push;var n=g.slice;var t=g.splice;var z;if(typeof exports!=="undefined"){z=exports}else{z=u.Backbone={}}z.VERSION="1.0.0";var L=u._;if(!L&&(typeof require!=="undefined")){L=require("underscore")}z.$=u.$||u.Zepto||u.ender||u.$;z.noConflict=function(){u.Backbone=B;return this};z.emulateHTTP=false;z.emulateJSON=false;var J=z.Events={on:function(M,P,O){if(!x(this,"on",M,[P,O])||!P){return this}this._events||(this._events={});var N=this._events[M]||(this._events[M]=[]);N.push({callback:P,context:O,ctx:O||this});return this},once:function(N,Q,O){if(!x(this,"once",N,[Q,O])||!Q){return this}var M=this;var P=L.once(function(){M.off(N,P);Q.apply(this,arguments)});P._callback=Q;return this.on(N,P,O)},off:function(M,V,N){var T,U,W,S,R,O,Q,P;if(!this._events||!x(this,"off",M,[V,N])){return this}if(!M&&!V&&!N){this._events={};return this}S=M?[M]:L.keys(this._events);for(R=0,O=S.length;R<O;R++){M=S[R];if(W=this._events[M]){this._events[M]=T=[];if(V||N){for(Q=0,P=W.length;Q<P;Q++){U=W[Q];if((V&&V!==U.callback&&V!==U.callback._callback)||(N&&N!==U.context)){T.push(U)}}}if(!T.length){delete this._events[M]}}}return this},trigger:function(O){if(!this._events){return this}var N=n.call(arguments,1);if(!x(this,"trigger",O,N)){return this}var P=this._events[O];var M=this._events.all;if(P){b(P,N)}if(M){b(M,arguments)}return this},stopListening:function(P,M,R){var N=this._listeners;if(!N){return this}var O=!M&&!R;if(typeof M==="object"){R=this}if(P){(N={})[P._listenerId]=P}for(var Q in N){N[Q].off(M,R,this);if(O){delete this._listeners[Q]}}return this}};var w=/\s+/;var x=function(T,R,N,Q){if(!N){return true}if(typeof N==="object"){for(var P in N){T[R].apply(T,[P,N[P]].concat(Q))}return false}if(w.test(N)){var S=N.split(w);for(var O=0,M=S.length;O<M;O++){T[R].apply(T,[S[O]].concat(Q))}return false}return true};var b=function(R,P){var S,Q=-1,O=R.length,N=P[0],M=P[1],T=P[2];switch(P.length){case 0:while(++Q<O){(S=R[Q]).callback.call(S.ctx)}return;case 1:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N)}return;case 2:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M)}return;case 3:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M,T)}return;default:while(++Q<O){(S=R[Q]).callback.apply(S.ctx,P)}}};var C={listenTo:"on",listenToOnce:"once"};L.each(C,function(M,N){J[N]=function(Q,O,S){var P=this._listeners||(this._listeners={});var R=Q._listenerId||(Q._listenerId=L.uniqueId("l"));P[R]=Q;if(typeof O==="object"){S=this}Q[M](O,S,this);return this}});J.bind=J.on;J.unbind=J.off;L.extend(z,J);var E=z.Model=function(M,O){var P;var N=M||{};O||(O={});this.cid=L.uniqueId("c");this.attributes={};L.extend(this,L.pick(O,F));if(O.parse){N=this.parse(N,O)||{}}if(P=L.result(this,"defaults")){N=L.defaults({},N,P)}this.set(N,O);this.changed={};this.initialize.apply(this,arguments)};var F=["url","urlRoot","collection"];L.extend(E.prototype,J,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(M){return L.clone(this.attributes)},sync:function(){return z.sync.apply(this,arguments)},get:function(M){return this.attributes[M]},escape:function(M){return L.escape(this.get(M))},has:function(M){return this.get(M)!=null},set:function(U,M,Y){var S,V,W,T,R,X,O,Q;if(U==null){return this}if(typeof U==="object"){V=U;Y=M}else{(V={})[U]=M}Y||(Y={});if(!this._validate(V,Y)){return false}W=Y.unset;R=Y.silent;T=[];X=this._changing;this._changing=true;if(!X){this._previousAttributes=L.clone(this.attributes);this.changed={}}Q=this.attributes,O=this._previousAttributes;if(this.idAttribute in V){this.id=V[this.idAttribute]}for(S in V){M=V[S];if(!L.isEqual(Q[S],M)){T.push(S)}if(!L.isEqual(O[S],M)){this.changed[S]=M}else{delete this.changed[S]}W?delete Q[S]:Q[S]=M}if(!R){if(T.length){this._pending=true}for(var P=0,N=T.length;P<N;P++){this.trigger("change:"+T[P],this,Q[T[P]],Y)}}if(X){return this}if(!R){while(this._pending){this._pending=false;this.trigger("change",this,Y)}}this._pending=false;this._changing=false;return this},unset:function(M,N){return this.set(M,void 0,L.extend({},N,{unset:true}))},clear:function(N){var M={};for(var O in this.attributes){M[O]=void 0}return this.set(M,L.extend({},N,{unset:true}))},hasChanged:function(M){if(M==null){return !L.isEmpty(this.changed)}return L.has(this.changed,M)},changedAttributes:function(O){if(!O){return this.hasChanged()?L.clone(this.changed):false}var Q,P=false;var N=this._changing?this._previousAttributes:this.attributes;for(var M in O){if(L.isEqual(N[M],(Q=O[M]))){continue}(P||(P={}))[M]=Q}return P},previous:function(M){if(M==null||!this._previousAttributes){return null}return this._previousAttributes[M]},previousAttributes:function(){return L.clone(this._previousAttributes)},fetch:function(N){N=N?L.clone(N):{};if(N.parse===void 0){N.parse=true}var M=this;var O=N.success;N.success=function(P){if(!M.set(M.parse(P,N),N)){return false}if(O){O(M,P,N)}M.trigger("sync",M,P,N)};H(this,N);return this.sync("read",this,N)},save:function(Q,N,U){var R,M,T,O=this.attributes;if(Q==null||typeof Q==="object"){R=Q;U=N}else{(R={})[Q]=N}if(R&&(!U||!U.wait)&&!this.set(R,U)){return false}U=L.extend({validate:true},U);if(!this._validate(R,U)){return false}if(R&&U.wait){this.attributes=L.extend({},O,R)}if(U.parse===void 0){U.parse=true}var P=this;var S=U.success;U.success=function(W){P.attributes=O;var V=P.parse(W,U);if(U.wait){V=L.extend(R||{},V)}if(L.isObject(V)&&!P.set(V,U)){return false}if(S){S(P,W,U)}P.trigger("sync",P,W,U)};H(this,U);M=this.isNew()?"create":(U.patch?"patch":"update");if(M==="patch"){U.attrs=R}T=this.sync(M,this,U);if(R&&U.wait){this.attributes=O}return T},destroy:function(N){N=N?L.clone(N):{};var M=this;var Q=N.success;var O=function(){M.trigger("destroy",M,M.collection,N)};N.success=function(R){if(N.wait||M.isNew()){O()}if(Q){Q(M,R,N)}if(!M.isNew()){M.trigger("sync",M,R,N)}};if(this.isNew()){N.success();return false}H(this,N);var P=this.sync("delete",this,N);if(!N.wait){O()}return P},url:function(){var M=L.result(this,"urlRoot")||L.result(this.collection,"url")||r();if(this.isNew()){return M}return M+(M.charAt(M.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(N,M){return N},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(M){return this._validate({},L.extend(M||{},{validate:true}))},_validate:function(O,N){if(!N.validate||!this.validate){return true}O=L.extend({},this.attributes,O);var M=this.validationError=this.validate(O,N)||null;if(!M){return true}this.trigger("invalid",this,M,L.extend(N||{},{validationError:M}));return false}});var a=["keys","values","pairs","invert","pick","omit"];L.each(a,function(M){E.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.attributes);return L[M].apply(L,N)}});var c=z.Collection=function(N,M){M||(M={});if(M.url){this.url=M.url}if(M.model){this.model=M.model}if(M.comparator!==void 0){this.comparator=M.comparator}this._reset();this.initialize.apply(this,arguments);if(N){this.reset(N,L.extend({silent:true},M))}};var o={add:true,remove:true,merge:true};var K={add:true,merge:false,remove:false};L.extend(c.prototype,J,{model:E,initialize:function(){},toJSON:function(M){return this.map(function(N){return N.toJSON(M)})},sync:function(){return z.sync.apply(this,arguments)},add:function(N,M){return this.set(N,L.defaults(M||{},K))},remove:function(R,P){R=L.isArray(R)?R.slice():[R];P||(P={});var Q,M,O,N;for(Q=0,M=R.length;Q<M;Q++){N=this.get(R[Q]);if(!N){continue}delete this._byId[N.id];delete this._byId[N.cid];O=this.indexOf(N);this.models.splice(O,1);this.length--;if(!P.silent){P.index=O;N.trigger("remove",N,this,P)}this._removeReference(N)}return this},set:function(N,Z){Z=L.defaults(Z||{},o);if(Z.parse){N=this.parse(N,Z)}if(!L.isArray(N)){N=N?[N]:[]}var U,Q,W,X,O,V;var P=Z.at;var T=this.comparator&&(P==null)&&Z.sort!==false;var R=L.isString(this.comparator)?this.comparator:null;var Y=[],M=[],S={};for(U=0,Q=N.length;U<Q;U++){if(!(W=this._prepareModel(N[U],Z))){continue}if(O=this.get(W)){if(Z.remove){S[O.cid]=true}if(Z.merge){O.set(W.attributes,Z);if(T&&!V&&O.hasChanged(R)){V=true}}}else{if(Z.add){Y.push(W);W.on("all",this._onModelEvent,this);this._byId[W.cid]=W;if(W.id!=null){this._byId[W.id]=W}}}}if(Z.remove){for(U=0,Q=this.length;U<Q;++U){if(!S[(W=this.models[U]).cid]){M.push(W)}}if(M.length){this.remove(M,Z)}}if(Y.length){if(T){V=true}this.length+=Y.length;if(P!=null){t.apply(this.models,[P,0].concat(Y))}else{D.apply(this.models,Y)}}if(V){this.sort({silent:true})}if(Z.silent){return this}for(U=0,Q=Y.length;U<Q;U++){(W=Y[U]).trigger("add",W,this,Z)}if(V){this.trigger("sort",this,Z)}return this},reset:function(P,N){N||(N={});for(var O=0,M=this.models.length;O<M;O++){this._removeReference(this.models[O])}N.previousModels=this.models;this._reset();this.add(P,L.extend({silent:true},N));if(!N.silent){this.trigger("reset",this,N)}return this},push:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:this.length},M));return N},pop:function(N){var M=this.at(this.length-1);this.remove(M,N);return M},unshift:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:0},M));return N},shift:function(N){var M=this.at(0);this.remove(M,N);return M},slice:function(N,M){return this.models.slice(N,M)},get:function(M){if(M==null){return void 0}return this._byId[M.id!=null?M.id:M.cid||M]},at:function(M){return this.models[M]},where:function(M,N){if(L.isEmpty(M)){return N?void 0:[]}return this[N?"find":"filter"](function(O){for(var P in M){if(M[P]!==O.get(P)){return false}}return true})},findWhere:function(M){return this.where(M,true)},sort:function(M){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}M||(M={});if(L.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(L.bind(this.comparator,this))}if(!M.silent){this.trigger("sort",this,M)}return this},sortedIndex:function(M,P,N){P||(P=this.comparator);var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L.sortedIndex(this.models,M,O,N)},pluck:function(M){return L.invoke(this.models,"get",M)},fetch:function(M){M=M?L.clone(M):{};if(M.parse===void 0){M.parse=true}var O=M.success;var N=this;M.success=function(P){var Q=M.reset?"reset":"set";N[Q](P,M);if(O){O(N,P,M)}N.trigger("sync",N,P,M)};H(this,M);return this.sync("read",this,M)},create:function(N,M){M=M?L.clone(M):{};if(!(N=this._prepareModel(N,M))){return false}if(!M.wait){this.add(N,M)}var P=this;var O=M.success;M.success=function(Q){if(M.wait){P.add(N,M)}if(O){O(N,Q,M)}};N.save(null,M);return N},parse:function(N,M){return N},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(O,N){if(O instanceof E){if(!O.collection){O.collection=this}return O}N||(N={});N.collection=this;var M=new this.model(O,N);if(!M._validate(O,N)){this.trigger("invalid",this,O,N);return false}return M},_removeReference:function(M){if(this===M.collection){delete M.collection}M.off("all",this._onModelEvent,this)},_onModelEvent:function(O,N,P,M){if((O==="add"||O==="remove")&&P!==this){return}if(O==="destroy"){this.remove(N,M)}if(N&&O==="change:"+N.idAttribute){delete this._byId[N.previous(N.idAttribute)];if(N.id!=null){this._byId[N.id]=N}}this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];L.each(y,function(M){c.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.models);return L[M].apply(L,N)}});var k=["groupBy","countBy","sortBy"];L.each(k,function(M){c.prototype[M]=function(P,N){var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L[M](this.models,O,N)}});var G=z.View=function(M){this.cid=L.uniqueId("view");this._configure(M||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var v=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];L.extend(G.prototype,J,{tagName:"div",$:function(M){return this.$el.find(M)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(M,N){if(this.$el){this.undelegateEvents()}this.$el=M instanceof z.$?M:z.$(M);this.el=this.$el[0];if(N!==false){this.delegateEvents()}return this},delegateEvents:function(Q){if(!(Q||(Q=L.result(this,"events")))){return this}this.undelegateEvents();for(var P in Q){var R=Q[P];if(!L.isFunction(R)){R=this[Q[P]]}if(!R){continue}var O=P.match(v);var N=O[1],M=O[2];R=L.bind(R,this);N+=".delegateEvents"+this.cid;if(M===""){this.$el.on(N,R)}else{this.$el.on(N,M,R)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(M){if(this.options){M=L.extend({},L.result(this,"options"),M)}L.extend(this,L.pick(M,e));this.options=M},_ensureElement:function(){if(!this.el){var M=L.extend({},L.result(this,"attributes"));if(this.id){M.id=L.result(this,"id")}if(this.className){M["class"]=L.result(this,"className")}var N=z.$("<"+L.result(this,"tagName")+">").attr(M);this.setElement(N,false)}else{this.setElement(L.result(this,"el"),false)}}});z.sync=function(S,N,M){var P=j[S];L.defaults(M||(M={}),{emulateHTTP:z.emulateHTTP,emulateJSON:z.emulateJSON});var R={type:P,dataType:"json"};if(!M.url){R.url=L.result(N,"url")||r()}if(M.data==null&&N&&(S==="create"||S==="update"||S==="patch")){R.contentType="application/json";R.data=JSON.stringify(M.attrs||N.toJSON(M))}if(M.emulateJSON){R.contentType="application/x-www-form-urlencoded";R.data=R.data?{model:R.data}:{}}if(M.emulateHTTP&&(P==="PUT"||P==="DELETE"||P==="PATCH")){R.type="POST";if(M.emulateJSON){R.data._method=P}var O=M.beforeSend;M.beforeSend=function(T){T.setRequestHeader("X-HTTP-Method-Override",P);if(O){return O.apply(this,arguments)}}}if(R.type!=="GET"&&!M.emulateJSON){R.processData=false}if(R.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){R.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var Q=M.xhr=z.ajax(L.extend(R,M));N.trigger("request",N,Q,M);return Q};var j={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};z.ajax=function(){return z.$.ajax.apply(z.$,arguments)};var p=z.Router=function(M){M||(M={});if(M.routes){this.routes=M.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var q=/\((.*?)\)/g;var s=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;L.extend(p.prototype,J,{initialize:function(){},route:function(N,O,P){if(!L.isRegExp(N)){N=this._routeToRegExp(N)}if(L.isFunction(O)){P=O;O=""}if(!P){P=this[O]}var M=this;z.history.route(N,function(R){var Q=M._extractParameters(N,R);P&&P.apply(M,Q);M.trigger.apply(M,["route:"+O].concat(Q));M.trigger("route",O,Q);z.history.trigger("route",M,O,Q)});return this},navigate:function(N,M){z.history.navigate(N,M);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=L.result(this,"routes");var N,M=L.keys(this.routes);while((N=M.pop())!=null){this.route(N,this.routes[N])}},_routeToRegExp:function(M){M=M.replace(h,"\\$&").replace(q,"(?:$1)?").replace(s,function(O,N){return N?O:"([^/]+)"}).replace(d,"(.*?)");return new RegExp("^"+M+"$")},_extractParameters:function(M,N){var O=M.exec(N).slice(1);return L.map(O,function(P){return P?decodeURIComponent(P):null})}});var i=z.History=function(){this.handlers=[];L.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var A=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var I=/msie [\w.]+/;var m=/\/$/;i.started=false;L.extend(i.prototype,J,{interval:50,getHash:function(N){var M=(N||this).location.href.match(/#(.*)$/);return M?M[1]:""},getFragment:function(O,N){if(O==null){if(this._hasPushState||!this._wantsHashChange||N){O=this.location.pathname;var M=this.root.replace(m,"");if(!O.indexOf(M)){O=O.substr(M.length)}}else{O=this.getHash()}}return O.replace(A,"")},start:function(O){if(i.started){throw new Error("Backbone.history has already been started")}i.started=true;this.options=L.extend({},{root:"/"},this.options,O);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var N=this.getFragment();var M=document.documentMode;var Q=(I.exec(navigator.userAgent.toLowerCase())&&(!M||M<=7));this.root=("/"+this.root+"/").replace(f,"/");if(Q&&this._wantsHashChange){this.iframe=z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(N)}if(this._hasPushState){z.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!Q){z.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=N;var R=this.location;var P=R.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!P){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&P&&R.hash){this.fragment=this.getHash().replace(A,"");this.history.replaceState({},document.title,this.root+this.fragment+R.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);i.started=false},route:function(M,N){this.handlers.unshift({route:M,callback:N})},checkUrl:function(N){var M=this.getFragment();if(M===this.fragment&&this.iframe){M=this.getFragment(this.getHash(this.iframe))}if(M===this.fragment){return false}if(this.iframe){this.navigate(M)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(O){var N=this.fragment=this.getFragment(O);var M=L.any(this.handlers,function(P){if(P.route.test(N)){P.callback(N);return true}});return M},navigate:function(O,N){if(!i.started){return false}if(!N||N===true){N={trigger:N}}O=this.getFragment(O||"");if(this.fragment===O){return}this.fragment=O;var M=this.root+O;if(this._hasPushState){this.history[N.replace?"replaceState":"pushState"]({},document.title,M)}else{if(this._wantsHashChange){this._updateHash(this.location,O,N.replace);if(this.iframe&&(O!==this.getFragment(this.getHash(this.iframe)))){if(!N.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,O,N.replace)}}else{return this.location.assign(M)}}if(N.trigger){this.loadUrl(O)}},_updateHash:function(M,O,P){if(P){var N=M.href.replace(/(javascript:|#).*$/,"");M.replace(N+"#"+O)}else{M.hash="#"+O}}});z.history=new i;var l=function(M,O){var N=this;var Q;if(M&&L.has(M,"constructor")){Q=M.constructor}else{Q=function(){return N.apply(this,arguments)}}L.extend(Q,N,O);var P=function(){this.constructor=Q};P.prototype=N.prototype;Q.prototype=new P;if(M){L.extend(Q.prototype,M)}Q.__super__=N.prototype;return Q};E.extend=c.extend=p.extend=G.extend=i.extend=l;var r=function(){throw new Error('A "url" property or function must be specified')};var H=function(O,N){var M=N.error;N.error=function(P){if(M){M(O,P,N)}O.trigger("error",O,P,N)}}}).call(this);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/vendor/backbone-relational.js' */
(function(b){var i,h,c;if(typeof window==="undefined"){i=require("underscore");h=require("backbone");c=module.exports=h}else{i=window._;h=window.Backbone;c=window}h.Relational={showWarnings:true};h.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable){throw new Error("Max permits acquired")}else{this._permitsUsed++}},release:function(){if(this._permitsUsed===0){throw new Error("All permits released")}else{this._permitsUsed--}},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(j){if(this._permitsUsed>j){throw new Error("Available permits cannot be less than used permits")}this._permitsAvailable=j}};h.BlockingQueue=function(){this._queue=[]};i.extend(h.BlockingQueue.prototype,h.Semaphore,{_queue:null,add:function(j){if(this.isBlocked()){this._queue.push(j)}else{j()}},process:function(){var j=this._queue;this._queue=[];while(j&&j.length){j.shift()()}},block:function(){this.acquire()},unblock:function(){this.release();if(!this.isBlocked()){this.process()}},isBlocked:function(){return this.isLocked()}});h.Relational.eventQueue=new h.BlockingQueue();h.Store=function(){this._collections=[];this._reverseRelations=[];this._orphanRelations=[];this._subModels=[];this._modelScopes=[c]};i.extend(h.Store.prototype,h.Events,{initializeRelation:function(k,m,j){var l=!i.isString(m.type)?m.type:h[m.type]||this.getObjectByName(m.type);if(l&&l.prototype instanceof h.Relation){new l(k,m,j)}else{h.Relational.showWarnings&&typeof console!=="undefined"&&console.warn("Relation=%o; missing or invalid relation type!",m)}},addModelScope:function(j){this._modelScopes.push(j)},removeModelScope:function(j){this._modelScopes=i.without(this._modelScopes,j)},addSubModels:function(j,k){this._subModels.push({superModelType:k,subModels:j})},setupSuperModel:function(j){i.find(this._subModels,function(k){return i.find(k.subModels||[],function(m,n){var l=this.getObjectByName(m);if(j===l){k.superModelType._subModels[n]=j;j._superModel=k.superModelType;j._subModelTypeValue=n;j._subModelTypeAttribute=k.superModelType.prototype.subModelTypeAttribute;return true}},this)},this)},addReverseRelation:function(k){var j=i.any(this._reverseRelations,function(l){return i.all(k||[],function(n,m){return n===l[m]})});if(!j&&k.model&&k.type){this._reverseRelations.push(k);this._addRelation(k.model,k);this.retroFitRelation(k)}},addOrphanRelation:function(k){var j=i.any(this._orphanRelations,function(l){return i.all(k||[],function(n,m){return n===l[m]})});if(!j&&k.model&&k.type){this._orphanRelations.push(k)}},processOrphanRelations:function(){i.each(this._orphanRelations.slice(0),function(j){var k=h.Relational.store.getObjectByName(j.relatedModel);if(k){this.initializeRelation(null,j);this._orphanRelations=i.without(this._orphanRelations,j)}},this)},_addRelation:function(j,k){if(!j.prototype.relations){j.prototype.relations=[]}j.prototype.relations.push(k);i.each(j._subModels||[],function(l){this._addRelation(l,k)},this)},retroFitRelation:function(k){var j=this.getCollection(k.model,false);j&&j.each(function(l){if(!(l instanceof k.model)){return}new k.type(l,k)},this)},getCollection:function(m,l){if(m instanceof h.RelationalModel){m=m.constructor}var j=m;while(j._superModel){j=j._superModel}var k=i.find(this._collections,function(n){return n.model===j});if(!k&&l!==false){k=this._createCollection(j)}return k},getObjectByName:function(j){var l=j.split("."),k=null;i.find(this._modelScopes,function(m){k=i.reduce(l||[],function(n,o){return n?n[o]:b},m);if(k&&k!==m){return true}},this);return k},_createCollection:function(k){var j;if(k instanceof h.RelationalModel){k=k.constructor}if(k.prototype instanceof h.RelationalModel){j=new h.Collection();j.model=k;this._collections.push(j)}return j},resolveIdForItem:function(j,k){var l=i.isString(k)||i.isNumber(k)?k:null;if(l===null){if(k instanceof h.RelationalModel){l=k.id}else{if(i.isObject(k)){l=k[j.prototype.idAttribute]}}}if(!l&&l!==0){l=null}return l},find:function(k,l){var n=this.resolveIdForItem(k,l);var j=this.getCollection(k);if(j){var m=j.get(n);if(m instanceof k){return m}}return null},register:function(k){var l=this.getCollection(k);if(l){var j=k.collection;l.add(k);this.listenTo(k,"destroy",this.unregister,this);this.listenTo(k,"relational:unregister",this.unregister,this);k.collection=j}},checkId:function(j,m){var k=this.getCollection(j),l=k&&k.get(m);if(l&&j!==l){if(h.Relational.showWarnings&&typeof console!=="undefined"){console.warn("Duplicate id! Old RelationalModel=%o, new RelationalModel=%o",l,j)}throw new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!")}},update:function(j){var k=this.getCollection(j);k._onModelEvent("change:"+j.idAttribute,j,k);j.trigger("relational:change:id",j,k)},unregister:function(k,m,j){this.stopListening(k,"destroy",this.unregister);this.stopListening(k,"relational:unregister",this.unregister);var l=this.getCollection(k);l&&l.remove(k,j)},reset:function(){this.stopListening();this._collections=[];this._subModels=[];this._modelScopes=[c]}});h.Relational.store=new h.Store();h.Relation=function(j,k,l){this.instance=j;k=i.isObject(k)?k:{};this.reverseRelation=i.defaults(k.reverseRelation||{},this.options.reverseRelation);this.options=i.defaults(k,this.options,h.Relation.prototype.options);this.reverseRelation.type=!i.isString(this.reverseRelation.type)?this.reverseRelation.type:h[this.reverseRelation.type]||h.Relational.store.getObjectByName(this.reverseRelation.type);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.keyDestination=this.options.keyDestination||this.keySource||this.key;this.model=this.options.model||this.instance.constructor;this.relatedModel=this.options.relatedModel;if(i.isString(this.relatedModel)){this.relatedModel=h.Relational.store.getObjectByName(this.relatedModel)}if(!this.checkPreconditions()){return}if(!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key){h.Relational.store.addReverseRelation(i.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation))}if(j){var m=this.keySource;if(m!==this.key&&typeof this.instance.get(this.key)==="object"){m=this.key}this.setKeyContents(this.instance.get(m));this.relatedCollection=h.Relational.store.getCollection(this.relatedModel);if(this.keySource!==this.key){this.instance.unset(this.keySource,{silent:true})}this.instance._relations[this.key]=this;this.initialize(l);if(this.options.autoFetch){this.instance.fetchRelated(this.key,i.isObject(this.options.autoFetch)?this.options.autoFetch:{})}this.listenTo(this.instance,"destroy",this.destroy).listenTo(this.relatedCollection,"relational:add relational:change:id",this.tryAddRelated).listenTo(this.relatedCollection,"relational:remove",this.removeRelated)}};h.Relation.extend=h.Model.extend;i.extend(h.Relation.prototype,h.Events,h.Semaphore,{options:{createModels:true,includeInJSON:true,isAutoRelation:false,autoFetch:false,parse:false},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var n=this.instance,l=this.key,j=this.model,p=this.relatedModel,q=h.Relational.showWarnings&&typeof console!=="undefined";if(!j||!l||!p){q&&console.warn("Relation=%o: missing model, key or relatedModel (%o, %o, %o).",this,j,l,p);return false}if(!(j.prototype instanceof h.RelationalModel)){q&&console.warn("Relation=%o: model does not inherit from Backbone.RelationalModel (%o).",this,n);return false}if(!(p.prototype instanceof h.RelationalModel)){q&&console.warn("Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).",this,p);return false}if(this instanceof h.HasMany&&this.reverseRelation.type===h.HasMany){q&&console.warn("Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.",this);return false}if(n&&i.keys(n._relations).length){var o=i.find(n._relations,function(k){return k.key===l},this);if(o){q&&console.warn("Cannot create relation=%o on %o for model=%o: already taken by relation=%o.",this,l,n,o);return false}}return true},setRelated:function(j){this.related=j;this.instance.acquire();this.instance.attributes[this.key]=j;this.instance.release()},_isReverseRelation:function(j){return j.instance instanceof this.relatedModel&&this.reverseRelation.key===j.key&&this.key===j.reverseRelation.key},getReverseRelations:function(j){var k=[];var l=!i.isUndefined(j)?[j]:this.related&&(this.related.models||[this.related]);i.each(l||[],function(m){i.each(m.getRelations()||[],function(n){if(this._isReverseRelation(n)){k.push(n)}},this)},this);return k},destroy:function(){this.stopListening();if(this instanceof h.HasOne){this.setRelated(null)}else{if(this instanceof h.HasMany){this.setRelated(this._prepareCollection())}}i.each(this.getReverseRelations(),function(j){j.removeRelated(this.instance)},this)}});h.HasOne=h.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(j){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);var k=this.findRelated(j);this.setRelated(k);i.each(this.getReverseRelations(),function(l){l.addRelated(this.instance,j)},this)},findRelated:function(j){var l=null;j=i.defaults({parse:this.options.parse},j);if(this.keyContents instanceof this.relatedModel){l=this.keyContents}else{if(this.keyContents||this.keyContents===0){var k=i.defaults({create:this.options.createModels},j);l=this.relatedModel.findOrCreate(this.keyContents,k)}}if(this.related){this.keyId=null}return l},setKeyContents:function(j){this.keyContents=j;this.keyId=h.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents)},onChange:function(m,j,l){if(this.isLocked()){return}this.acquire();l=l?i.clone(l):{};var p=i.isUndefined(l.__related),n=p?this.related:l.__related;if(p){this.setKeyContents(j);var o=this.findRelated(l);this.setRelated(o)}if(n&&this.related!==n){i.each(this.getReverseRelations(n),function(q){q.removeRelated(this.instance,null,l)},this)}i.each(this.getReverseRelations(),function(q){q.addRelated(this.instance,l)},this);if(!l.silent&&this.related!==n){var k=this;this.changed=true;h.Relational.eventQueue.add(function(){k.instance.trigger("change:"+k.key,k.instance,k.related,l,true);k.changed=false})}this.release()},tryAddRelated:function(k,l,j){if((this.keyId||this.keyId===0)&&k.id===this.keyId){this.addRelated(k,j);this.keyId=null}},addRelated:function(l,k){var j=this;l.queue(function(){if(l!==j.related){var m=j.related||null;j.setRelated(l);j.onChange(j.instance,l,i.defaults({__related:m},k))}})},removeRelated:function(k,l,j){if(!this.related){return}if(k===this.related){var m=this.related||null;this.setRelated(null);this.onChange(this.instance,k,i.defaults({__related:m},j))}}});h.HasMany=h.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:h.Collection,collectionKey:true,collectionOptions:{}},initialize:function(j){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);this.collectionType=this.options.collectionType;if(i.isString(this.collectionType)){this.collectionType=h.Relational.store.getObjectByName(this.collectionType)}if(this.collectionType!==h.Collection&&!(this.collectionType.prototype instanceof h.Collection)){throw new Error("`collectionType` must inherit from Backbone.Collection")}var k=this.findRelated(j);this.setRelated(k)},_prepareCollection:function(l){if(this.related){this.stopListening(this.related)}if(!l||!(l instanceof h.Collection)){var j=i.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;l=new this.collectionType(null,j)}l.model=this.relatedModel;if(this.options.collectionKey){var k=this.options.collectionKey===true?this.options.reverseRelation.key:this.options.collectionKey;if(l[k]&&l[k]!==this.instance){if(h.Relational.showWarnings&&typeof console!=="undefined"){console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,k,this.options.collectionKey)}}else{if(k){l[k]=this.instance}}}this.listenTo(l,"relational:add",this.handleAddition).listenTo(l,"relational:remove",this.handleRemoval).listenTo(l,"relational:reset",this.handleReset);return l},findRelated:function(j){var l=null;j=i.defaults({parse:this.options.parse},j);if(this.keyContents instanceof h.Collection){this._prepareCollection(this.keyContents);l=this.keyContents}else{var k=[];i.each(this.keyContents,function(m){if(m instanceof this.relatedModel){var n=m}else{n=this.relatedModel.findOrCreate(m,i.extend({merge:true},j,{create:this.options.createModels}))}n&&k.push(n)},this);if(this.related instanceof h.Collection){l=this.related}else{l=this._prepareCollection()}l.set(k,i.defaults({merge:false,parse:false},j))}this.keyIds=i.difference(this.keyIds,i.pluck(l.models,"id"));return l},setKeyContents:function(j){this.keyContents=j instanceof h.Collection?j:null;this.keyIds=[];if(!this.keyContents&&(j||j===0)){this.keyContents=i.isArray(j)?j:[j];i.each(this.keyContents,function(k){var l=h.Relational.store.resolveIdForItem(this.relatedModel,k);if(l||l===0){this.keyIds.push(l)}},this)}},onChange:function(m,j,l){l=l?i.clone(l):{};this.setKeyContents(j);this.changed=false;var n=this.findRelated(l);this.setRelated(n);if(!l.silent){var k=this;h.Relational.eventQueue.add(function(){if(k.changed){k.instance.trigger("change:"+k.key,k.instance,k.related,l,true);k.changed=false}})}},handleAddition:function(l,m,k){k=k?i.clone(k):{};this.changed=true;i.each(this.getReverseRelations(l),function(n){n.addRelated(this.instance,k)},this);var j=this;!k.silent&&h.Relational.eventQueue.add(function(){j.instance.trigger("add:"+j.key,l,j.related,k)})},handleRemoval:function(l,m,k){k=k?i.clone(k):{};this.changed=true;i.each(this.getReverseRelations(l),function(n){n.removeRelated(this.instance,null,k)},this);var j=this;!k.silent&&h.Relational.eventQueue.add(function(){j.instance.trigger("remove:"+j.key,l,j.related,k)})},handleReset:function(l,k){var j=this;k=k?i.clone(k):{};!k.silent&&h.Relational.eventQueue.add(function(){j.instance.trigger("reset:"+j.key,j.related,k)})},tryAddRelated:function(k,l,j){var m=i.contains(this.keyIds,k.id);if(m){this.addRelated(k,j);this.keyIds=i.without(this.keyIds,k.id)}},addRelated:function(l,k){var j=this;l.queue(function(){if(j.related&&!j.related.get(l)){j.related.add(l,i.defaults({parse:false},k))}})},removeRelated:function(k,l,j){if(this.related.get(k)){this.related.remove(k,j)}}});h.RelationalModel=h.Model.extend({relations:null,_relations:null,_isInitialized:false,_deferProcessing:false,_queue:null,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(k,l){if(l&&l.collection){var j=this,n=this.collection=l.collection;delete l.collection;this._deferProcessing=true;var m=function(o){if(o===j){j._deferProcessing=false;j.processQueue();n.off("relational:add",m)}};n.on("relational:add",m);i.defer(function(){m(j)})}h.Relational.store.processOrphanRelations();this._queue=new h.BlockingQueue();this._queue.block();h.Relational.eventQueue.block();try{h.Model.apply(this,arguments)}finally{h.Relational.eventQueue.unblock()}},trigger:function(k){if(k.length>5&&k.indexOf("change")===0){var j=this,l=arguments;h.Relational.eventQueue.add(function(){if(!j._isInitialized){return}var o=true;if(k==="change"){o=j.hasChanged()}else{var n=k.slice(7),m=j.getRelation(n);if(m){o=(l[4]===true);if(o){j.changed[n]=l[2]}else{if(!m.changed){delete j.changed[n]}}}}o&&h.Model.prototype.trigger.apply(j,l)})}else{h.Model.prototype.trigger.apply(this,arguments)}return this},initializeRelations:function(j){this.acquire();this._relations={};i.each(this.relations||[],function(k){h.Relational.store.initializeRelation(this,k,j)},this);this._isInitialized=true;this.release();this.processQueue()},updateRelations:function(j){if(this._isInitialized&&!this.isLocked()){i.each(this._relations,function(k){var l=this.attributes[k.keySource]||this.attributes[k.key];if(k.related!==l){this.trigger("relational:change:"+k.key,this,l,j||{})}},this)}},queue:function(j){this._queue.add(j)},processQueue:function(){if(this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()){this._queue.unblock()}},getRelation:function(j){return this._relations[j]},getRelations:function(){return i.values(this._relations)},fetchRelated:function(q,s,p){s=i.extend({update:true,remove:false},s);var o,k=[],r=this.getRelation(q),m=r&&(r.keyIds||((r.keyId||r.keyId===0)?[r.keyId]:[]));if(p){var l=r.related instanceof h.Collection?r.related.models:[r.related];i.each(l,function(t){if(t.id||t.id===0){m.push(t.id)}})}if(m&&m.length){var n=[],l=i.map(m,function(v){var u=h.Relational.store.find(r.relatedModel,v);if(!u){var t={};t[r.relatedModel.prototype.idAttribute]=v;u=r.relatedModel.findOrCreate(t,s);n.push(u)}return u},this);if(r.related instanceof h.Collection&&i.isFunction(r.related.url)){o=r.related.url(l)}if(o&&o!==r.related.url()){var j=i.defaults({error:function(){var t=arguments;i.each(n,function(u){u.trigger("destroy",u,u.collection,s);s.error&&s.error.apply(u,t)})},url:o},s);k=[r.related.fetch(j)]}else{k=i.map(l,function(t){var u=i.defaults({error:function(){if(i.contains(n,t)){t.trigger("destroy",t,t.collection,s);s.error&&s.error.apply(t,arguments)}}},s);return t.fetch(u)},this)}}return k},get:function(k){var l=h.Model.prototype.get.call(this,k);if(!this.dotNotation||k.indexOf(".")===-1){return l}var m=k.split(".");var j=i.reduce(m,function(n,o){if(!(n instanceof h.Model)){throw new Error("Attribute must be an instanceof Backbone.Model. Is: "+n+", currentSplit: "+o)}return h.Model.prototype.get.call(n,o)},this);if(l!==b&&j!==b){throw new Error("Ambiguous result for '"+k+"'. direct result: "+l+", dotNotation: "+j)}return l||j},set:function(n,o,m){h.Relational.eventQueue.block();var k;if(i.isObject(n)||n==null){k=n;m=o}else{k={};k[n]=o}try{var p=this.id,l=k&&this.idAttribute in k&&k[this.idAttribute];h.Relational.store.checkId(this,l);var j=h.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){this.constructor.initializeModelHierarchy();h.Relational.store.register(this);this.initializeRelations(m)}else{if(l&&l!==p){h.Relational.store.update(this)}}if(k){this.updateRelations(m)}}finally{h.Relational.eventQueue.unblock()}return j},unset:function(l,k){h.Relational.eventQueue.block();var j=h.Model.prototype.unset.apply(this,arguments);this.updateRelations(k);h.Relational.eventQueue.unblock();return j},clear:function(k){h.Relational.eventQueue.block();var j=h.Model.prototype.clear.apply(this,arguments);this.updateRelations(k);h.Relational.eventQueue.unblock();return j},clone:function(){var j=i.clone(this.attributes);if(!i.isUndefined(j[this.idAttribute])){j[this.idAttribute]=null}i.each(this.getRelations(),function(k){delete j[k.key]});return new this.constructor(j)},toJSON:function(j){if(this.isLocked()){return this.id}this.acquire();var k=h.Model.prototype.toJSON.call(this,j);if(this.constructor._superModel&&!(this.constructor._subModelTypeAttribute in k)){k[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue}i.each(this._relations,function(l){var n=k[l.key],o=l.options.includeInJSON,m=null;if(o===true){if(n&&i.isFunction(n.toJSON)){m=n.toJSON(j)}}else{if(i.isString(o)){if(n instanceof h.Collection){m=n.pluck(o)}else{if(n instanceof h.Model){m=n.get(o)}}if(o===l.relatedModel.prototype.idAttribute){if(l instanceof h.HasMany){m=m.concat(l.keyIds)}else{if(l instanceof h.HasOne){m=m||l.keyId}}}}else{if(i.isArray(o)){if(n instanceof h.Collection){m=[];n.each(function(q){var p={};i.each(o,function(r){p[r]=q.get(r)});m.push(p)})}else{if(n instanceof h.Model){m={};i.each(o,function(p){m[p]=n.get(p)})}}}else{delete k[l.key]}}}if(o){k[l.keyDestination]=m}if(l.keyDestination!==l.key){delete k[l.key]}});this.release();return k}},{setup:function(j){this.prototype.relations=(this.prototype.relations||[]).slice(0);this._subModels={};this._superModel=null;if(this.prototype.hasOwnProperty("subModelTypes")){h.Relational.store.addSubModels(this.prototype.subModelTypes,this)}else{this.prototype.subModelTypes=null}i.each(this.prototype.relations||[],function(k){if(!k.model){k.model=this}if(k.reverseRelation&&k.model===this){var m=true;if(i.isString(k.relatedModel)){var l=h.Relational.store.getObjectByName(k.relatedModel);m=l&&(l.prototype instanceof h.RelationalModel)}if(m){h.Relational.store.initializeRelation(null,k)}else{if(i.isString(k.relatedModel)){h.Relational.store.addOrphanRelation(k)}}}},this);return this},build:function(l,n){var m=this;this.initializeModelHierarchy();if(this._subModels&&this.prototype.subModelTypeAttribute in l){var k=l[this.prototype.subModelTypeAttribute];var j=this._subModels[k];if(j){m=j}}return new m(l,n)},initializeModelHierarchy:function(){if(i.isUndefined(this._superModel)||i.isNull(this._superModel)){h.Relational.store.setupSuperModel(this);if(this._superModel&&this._superModel.prototype.relations){var j=i.select(this._superModel.prototype.relations||[],function(k){return !i.any(this.prototype.relations||[],function(l){return k.relatedModel===l.relatedModel&&k.key===l.key},this)},this);this.prototype.relations=j.concat(this.prototype.relations)}else{this._superModel=false}}if(this.prototype.subModelTypes&&i.keys(this.prototype.subModelTypes).length!==i.keys(this._subModels).length){i.each(this.prototype.subModelTypes||[],function(l){var k=h.Relational.store.getObjectByName(l);k&&k.initializeModelHierarchy()})}},findOrCreate:function(j,l){l||(l={});var m=(i.isObject(j)&&l.parse&&this.prototype.parse)?this.prototype.parse(i.clone(j)):j;var k=h.Relational.store.find(this,m);if(i.isObject(j)){if(k&&l.merge!==false){delete l.collection;delete l.url;k.set(m,l)}else{if(!k&&l.create!==false){k=this.build(j,l)}}}return k},find:function(j,k){k||(k={});k.create=false;return this.findOrCreate(j,k)}});i.extend(h.RelationalModel.prototype,h.Semaphore);h.Collection.prototype.__prepareModel=h.Collection.prototype._prepareModel;h.Collection.prototype._prepareModel=function(l,k){var j;if(l instanceof h.Model){if(!l.collection){l.collection=this}j=l}else{k||(k={});k.collection=this;if(typeof this.model.findOrCreate!=="undefined"){j=this.model.findOrCreate(l,k)}else{j=new this.model(l,k)}if(j&&j.isNew()&&!j._validate(l,k)){this.trigger("invalid",this,l,k);j=false}}return j};var g=h.Collection.prototype.__set=h.Collection.prototype.set;h.Collection.prototype.set=function(m,k){if(!(this.model.prototype instanceof h.RelationalModel)){return g.apply(this,arguments)}if(k&&k.parse){m=this.parse(m,k)}if(!i.isArray(m)){m=m?[m]:[]}var j=[],l=[];i.each(m,function(n){if(!(n instanceof h.Model)){n=h.Collection.prototype._prepareModel.call(this,n,k)}if(n){l.push(n);if(!(this.get(n)||this.get(n.cid))){j.push(n)}else{if(n.id!=null){this._byId[n.id]=n}}}},this);g.call(this,l,i.defaults({parse:false},k));i.each(j,function(n){if(this.get(n)||this.get(n.cid)){this.trigger("relational:add",n,this,k)}},this);return this};var e=h.Collection.prototype.__remove=h.Collection.prototype.remove;h.Collection.prototype.remove=function(l,j){if(!(this.model.prototype instanceof h.RelationalModel)){return e.apply(this,arguments)}l=i.isArray(l)?l.slice():[l];j||(j={});var k=[];i.each(l,function(m){m=this.get(m)||this.get(m.cid);m&&k.push(m)},this);if(k.length){e.call(this,k,j);i.each(k,function(m){this.trigger("relational:remove",m,this,j)},this)}return this};var f=h.Collection.prototype.__reset=h.Collection.prototype.reset;h.Collection.prototype.reset=function(k,j){j=i.extend({merge:true},j);f.call(this,k,j);if(this.model.prototype instanceof h.RelationalModel){this.trigger("relational:reset",this,j)}return this};var d=h.Collection.prototype.__sort=h.Collection.prototype.sort;h.Collection.prototype.sort=function(j){d.call(this,j);if(this.model.prototype instanceof h.RelationalModel){this.trigger("relational:reset",this,j)}return this};var a=h.Collection.prototype.__trigger=h.Collection.prototype.trigger;h.Collection.prototype.trigger=function(k){if(!(this.model.prototype instanceof h.RelationalModel)){return a.apply(this,arguments)}if(k==="add"||k==="remove"||k==="reset"||k==="sort"){var j=this,l=arguments;if(i.isObject(l[3])){l=i.toArray(l);l[3]=i.clone(l[3])}h.Relational.eventQueue.add(function(){a.apply(j,l)})}else{a.apply(this,arguments)}return this};h.RelationalModel.extend=function(j,k){var l=h.Model.extend.apply(this,arguments);l.setup(this);return l}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/flowboard-restore.js' */
FlowBoard.$=$;FlowBoard.$=$;FlowBoard._=_;FlowBoard.Backbone=Backbone;$.noConflict();Backbone.noConflict();$=FlowBoard.__ojq;$=FlowBoard.__o$;_=FlowBoard.__ou;Backbone=FlowBoard.__obb;delete FlowBoard.__ojq;delete FlowBoard.__o$;delete FlowBoard.__ou;delete FlowBoard.__obb;
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/flowboard.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;"use strict";a.extend(d,{Models:{},Collections:{},Views:{},Routers:{},Templates:{},initialize:function(){var e=this;e.$rootEl=b("#content");d.currentUser=new d.Models.CurrentUser();d.currentUser.fetch({success:function(f){d.boards=new d.Collections.Boards();d.boards.fetch({success:function(g){new d.Routers.Main({$rootEl:e.$rootEl});c.history.start()}})},error:function(){d.syncError("Error syncing boards",arguments)}})},resourceUrl:function(e){return AJS.contextPath()+"/rest/flowboard/1.0"+e},getBoardIds:function(){return b.makeArray(b(".flowboard").map(function(){return b(this).attr("id").slice("flowboard-".length)}))},syncError:function(f,e){console.error(f,e)}});b(function(){d.initialize()});if(!Date.prototype.toISOString){(function(){function e(f){if(f<10){return"0"+f}return f}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1000).toFixed(3).slice(2,5)+"Z"}}())}}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/models/board.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Models.Board=c.RelationalModel.extend({url:d.resourceUrl("/boards"),relations:[{type:c.HasMany,key:"lists",relatedModel:"FlowBoard.Models.List",collectionType:"FlowBoard.Collections.Lists",reverseRelation:{key:"board"}}]})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/models/card.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Models.Card=c.RelationalModel.extend({urlRoot:d.resourceUrl("/cards"),relations:[{type:c.HasMany,key:"assignees",relatedModel:"FlowBoard.Models.User",collectionType:"FlowBoard.Collections.Users"},{type:c.HasMany,key:"comments",relatedModel:"FlowBoard.Models.CardComment",collectionType:"FlowBoard.Collections.CardComments",reverseRelation:{key:"card"}}]})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/models/card-comment.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Models.CardComment=c.RelationalModel.extend({urlRoot:d.resourceUrl("/card-comments"),relations:[{type:c.HasOne,key:"author",relatedModel:"FlowBoard.Models.User",collectionType:"FlowBoard.Collections.Users",reverseRelation:{key:"card"}}]})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/models/list.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Models.List=c.RelationalModel.extend({urlRoot:d.resourceUrl("/lists"),relations:[{type:c.HasMany,key:"cards",relatedModel:"FlowBoard.Models.Card",collectionType:"FlowBoard.Collections.Cards",reverseRelation:{key:"list"}}]})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/models/user.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Models.User=c.RelationalModel.extend({urlRoot:d.resourceUrl("/users")})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/models/current-user.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Models.CurrentUser=d.Models.User.extend({urlRoot:d.resourceUrl("/current-user")})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/collections/boards.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;b(function(){d.Collections.Boards=c.Collection.extend({model:d.Models.Board,url:d.resourceUrl("/boards?in="+d.getBoardIds().join(","))})})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/collections/card-comments.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Collections.CardComments=c.Collection.extend({model:d.Models.CardComment})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/collections/cards.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Collections.Cards=c.Collection.extend({model:d.Models.Card,url:d.resourceUrl("/cards"),comparator:function(e){return e.get("position")}})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/collections/lists.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Collections.Lists=c.Collection.extend({model:d.Models.List,comparator:function(e){return e.get("position")}})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/collections/users.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Collections.Users=c.Collection.extend({model:d.Models.User,url:d.resourceUrl("/users")})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/templates/boards-index.ejs' */
FlowBoard.Templates["boards-index-tmpl"] = FlowBoard._.template("");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/templates/board-show.ejs' */
FlowBoard.Templates["board-show-tmpl"] = FlowBoard._.template("<div class=\"lists_wrapper\">\n  <div class=\"lists_inner_wrapper\">\n\n    <section class=\"lists\"></section>\n\n    <div class=\"add_list\">\n      <form class=\"aui add_list\">\n        <input type=\"text\"\n           class=\"list_title\"\n           name=\"list[title]\"\n           placeholder=\"Add a list...\" />\n        <input class=\"aui-button\" type=\"submit\" value=\"Add List\" />\n      </form>\n    </div>\n  </div> <!-- inner_wrapper -->\n</div>\n");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/templates/cards-index.ejs' */
FlowBoard.Templates["cards-index-tmpl"] = FlowBoard._.template("<div class=\"cards\"\n   id=\"cards_list_<%= cards.list.id %>\"\n   data-list-id=\"<%= cards.list.id %>\"><% cards.each(function (card) { %>\n  <div class=\"card\"\n     id=\"card_<%= card.id %>\"\n     data-card-id=\"<%= card.id %>\">\n\n    <button class=\"archive_card\" data-card-id=\"<%= card.id %>\">\n      <i class=\"fa fa-times\"></i>\n    </button>\n\n    <span class=\"card_title\">\n      <%= card.escape(\"title\") %>\n    </span>\n\n    <%\n      var description = card.get(\"description\");\n      var commentsCount = card.get(\"commentsCount\");\n      var assignees = card.get(\"assignees\");\n    %>\n    <% if (description || commentsCount > 0 || assignees.length > 0) { %>\n    <footer>\n      <% if (description) { %>\n      <span class=\"card_aspect card_description\">\n        <i class=\"fa fa-pencil\"></i>\n      </span>\n      <% } %>\n\n      <% if (commentsCount > 0) { %>\n      <span class=\"card_aspect comments_count\">\n        <i class=\"fa fa-comments\"></i>\n        <%= card.escape(\"commentsCount\") %>\n      </span>\n      <% } %>\n\n      <% if (assignees.length > 0) { %>\n      <span class=\"card_aspect assignees\">\n        <% assignees.each(function (assignee) { %>\n        <img src=\"<%= AJS.contextPath() + assignee.escape('avatarUrl') %>\"\n             title=\"<%= assignee.escape('fullName') %>\" />\n        <% }); %>\n      </span>\n      <% } %>\n    </footer>\n    <% } %>\n\n  </div>\n  <% }); %></div>\n");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/templates/card-show.ejs' */
FlowBoard.Templates["card-show-tmpl"] = FlowBoard._.template("<header class=\"card_title\">\n  <div class=\"aui-group\">\n    <div class=\"aui-item\">\n      <div class=\"preamble\">\n        <span>In list</span>\n        <span class=\"card_list_title\"><%= list.escape(\"title\") %></span>\n      </div>\n      <h3>\n        <span class=\"edit js-edit-card-title\"><%= card.escape(\"title\") %></span>\n      </h3>\n    </div>\n    <div class=\"aui-item card_dialog_close_cell\">\n      <a href=\"\" class=\"card_dialog_close\"><i class=\"fa fa-times fa-lg\"></i></a>\n    </div>\n  </div>\n</header>\n\n<section class=\"card_description\">\n  <h5>Description &nbsp; <a href=\"\" class=\"edit_description heading_action\">Edit</a></h5>\n  <% if (card.get(\"description\")) { %>\n  <p class=\"card_description_value\"><%= card.escape(\"description\") %></p>\n  <% } else { %>\n  <button class=\"aui-button aui-button-subtle add_description\">\n    <i class=\"fa fa-pencil\"></i>\n    Add description\n  </button>\n  <% } %>\n  <div class=\"description_editor\" style=\"display: none\">\n    <form id=\"edit_description\" class=\"aui\">\n      <textarea name=\"card_description[content]\"\n                class=\"card_description_content textarea\"\n                placeholder=\"Add a description...\"></textarea>\n      <button class=\"aui-button save_description\">Save</button>\n      <button class=\"aui-button aui-button-link cancel_description\">Cancel</button>\n    </form>\n  </div>\n</section>\n\n<section class=\"card_assignees\">\n  <h5>Assigned to</h5>\n  <form id=\"assign_users\" class=\"aui\">\n    <input class=\"assignee_picker autocomplete-multiuser text\" name=\"assignee_names\"\n           data-none-message=\"No users found\" data-template=\"{username}\">\n  </form>\n</section>\n\n<section class=\"card_activity\">\n  <h5>Activity</h5>\n\n  <form id=\"add_comment\" class=\"aui\">\n    <textarea name=\"card_comment[content]\"\n              class=\"card_comment_content textarea\"\n              placeholder=\"Write a comment...\"></textarea>\n    <input class=\"aui-button\" type=\"submit\" value=\"Comment\" />\n  </form>\n\n  <ul class=\"card_comments\">\n  <% comments.each(function (comment) { %>\n    <% var author = comment.get(\"author\") %>\n    <li>\n      <article class=\"comment\">\n        <header>\n          <img src=\"<%= AJS.contextPath() + author.get('avatarUrl') %>\" />\n        </header>\n\n        <a rel=\"author\"><%= author.escape(\"fullName\") %></a>\n\n        <div class=\"content\">\n          <%= comment.escape(\"content\") %>\n        </div>\n\n        <footer>\n          <% created = new Date(comment.get(\"created\")).toISOString() %>\n          <abbr class=\"timeago quiet\" title=\"<%= created %>\"><%= created %></abbr>\n        </footer>\n      </article>\n    </li>\n  <% }); %>\n  </ul>\n\n  <section class=\"comments\"></section>\n</section>\n");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/templates/list-show.ejs' */
FlowBoard.Templates["list-show-tmpl"] = FlowBoard._.template("<header class=\"list_title\">\n  <span class=\"edit js-edit-list-title\"\n        id=\"list_<%= list.id %>\"><%= list.escape(\"title\") %></span>\n  <button class=\"archive_list\" data-list-id=\"<%= list.id %>\">\n      <i class=\"fa fa-times\"></i>\n  </button>\n</header>\n\n<section class=\"cards\"></section>\n\n<div class=\"add_card\">\n  <form class=\"aui add_card\" data-list-id=\"<%= list.id %>\">\n    <input type=\"text\"\n       class=\"card_title\"\n       name=\"card[title]\"\n       placeholder=\"Add a card...\" />\n    <input class=\"aui-button\" type=\"submit\" value=\"Add Card\" />\n  </form>\n</div>\n");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/views/board-show.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Views.BoardShow=c.View.extend({template:d.Templates["board-show-tmpl"],tagName:"section",className:"board-show group",initialize:function(){var e=this;e.model.on("all",e.render,e)},events:{"submit form.add_list":"addList","click button.archive_list":"archiveList"},addList:function(f){f.preventDefault();var n=this;var i=n.model;var o=b(f.currentTarget);var l=o.serializeJSON();o[0].reset();l.list.boardId=i.id;var h=new d.Models.List();var m=i.get("lists");var j=b("div.lists_wrapper");if(!l.list.title){var k=j.scrollLeft();var e=b("div.add_list");var g=b("div.add_list input.list_title");g.hide();e.effect("shake",{distance:9,times:2,complete:function(){g.show();g.focus()}},350);j.scrollLeft(k);return false}h.save(l.list,{success:function(p){m.add(h);setTimeout(function(){b("#list_"+h.id).removeClass("animated flipInY")},650);b("#list_"+h.id).addClass("animated flipInY");b("div.add_list input.list_title").focus()}})},archiveList:function(j){j.stopPropagation();var g=this;var i=g.model;var f=parseInt(b(j.currentTarget).data("list-id"));var e=i.get("lists");var k=e.get(f);var h=b("div.lists_wrapper").scrollLeft();b("#list_"+f).addClass("animated flipOutY");setTimeout(function(){k.destroy({success:function(l){e.remove({id:f});g.updateLists();b("div.lists_wrapper").scrollLeft(h)}})},655)},render:function(){var f=this;var g=f.model;var e=g.get("lists");f.$el.html(f.template({board:g}));e.each(function(k){var j=new d.Views.ListShow({model:k});f.$("section.lists").append(j.render().el)});var i=d.resourceUrl("/lists/order");var h=f.$("section.lists");h.sortable({items:"div.list",tolerance:"pointer",placeholder:"list-placeholder",start:function(k,j){j.placeholder.width(j.item.width());j.placeholder.height(j.item.height())},update:function(){var j=f.getListOrder();var k=JSON.stringify({boardId:g.get("id"),listOrder:j});b.ajax({type:"PUT",url:i,data:k,contentType:"application/json",dataType:"json",success:function(){f.updateLists()},error:function(){d.syncError("Error sorting lists",arguments)}})}});return f},updateLists:function(){var g=this;var f=g.getListOrder();var e=g.model.get("lists");b.each(f,function(h,j){e.get(j).set("position",h)});e.sort()},getListOrder:function(){var f=this;var e=f.$("section.lists").sortable("toArray");return b.map(e,function(g){return parseInt(g.slice("list_".length))})}})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/views/boards-index.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/views/card-comments-index.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Views.CardCommentsIndex=c.View.extend({template:d.Templates["card-comments-index"]})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/views/card-show.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Views.CardShow=c.View.extend({template:d.Templates["card-show-tmpl"],tagName:"article",className:"flowboard card_detail",initialize:function(){var e=this;e.model.on("update",e.render,e);e.model.on("change",e.render,e);e.model.get("comments").on("add",e.render,e)},events:{"submit form#add_comment":"addComment"},addComment:function(j){j.preventDefault();var f=this;var i=f.model;var k=i.get("comments");var e=b(j.target);var h=e.serializeJSON();e[0].reset();h.card_comment.cardId=i.id;if(!h.card_comment.content){f.$el.effect("shake",{distance:9,times:2,complete:function(){var l=f.$el.find(".card_comment_content");l.focus()}},350);return}var g=new d.Models.CardComment();g.save(h.card_comment,{success:function(l){k.add(g,{at:0});var m=k.card;var n=+m.get("commentsCount");m.set({commentsCount:n+1});a.defer(function(){b("ul.card_comments li:first-child").addClass("animated fadeIn")});m.get("list").trigger("change")}})},render:function(){var e=this;var f=e.model;var i=f.get("comments");var g=f.get("assignees");var h=e.template({card:f,list:f.get("list"),comments:i});e.$el.html(h);e.$(".js-edit-card-title").editable(function(k,j){f.set("title",k);f.save().fail(function(){d.syncError("Failed to save change to assignees",arguments)});return k},{submit:"Save",onblur:"submit",cssclass:"animated fadeIn aui",width:"none",height:"none"});e.$("abbr.timeago").timeago();a.defer(function(){e.initDescription();e.initAssigneePicker();e.$(".card_comment_content").focus()});return e},initDescription:function(){var e=this;e.$(".add_description, .edit_description").click(function(f){f.preventDefault();e.showDescriptionEditor()});e.$(".save_description").click(function(g){g.preventDefault();var f=b.trim(e.$(".card_description_content").val());e.model.set("description",f);e.model.save().done(function(){card.get("list").trigger("change")}).fail(function(){d.syncError("Failed to save changes to card description",arguments)});e.hideDescriptionEditor()});e.$(".cancel_description").click(function(g){g.preventDefault();var f=e.model.get("description");e.$(".card_description_content").val(f);e.hideDescriptionEditor()});e.hideDescriptionEditor()},showDescriptionEditor:function(){var e=this;e.$(".add_description, .edit_description, .card_description_value").hide();e.$(".description_editor").show();var f=e.model.get("description");e.$(".card_description_content").val(f).focus()},hideDescriptionEditor:function(){var e=this;e.$(".description_editor").hide();var f=e.model.get("description");if(f){e.$(".add_description").hide();e.$(".edit_description, .card_description_value").show()}else{e.$(".add_description").show();e.$(".edit_description, .card_description_value").hide()}},initAssigneePicker:function(){var e=this;var f=e.model;var g=f.get("assignees");Confluence.Binder.autocompleteMultiUser(e.$el);var h=AJS.$("#assign_users .assignee_picker");h.on("change",function(k){k.preventDefault();var j=b.map(h.auiSelect2("data"),function(m){var l=new d.Models.User();l.set("name",m.id);l.set("fullName",m.text);l.set("avatarUrl",m.imgSrc);return l});e.model.set("assignees",j);e.model.save().done(function(){f.get("list").trigger("change");AJS.$("#assign_users .assignee_picker").auiSelect2("open")}).fail(function(){d.syncError("Failed to save changes to card assignees",arguments)})});var i=g.map(function(j){return{id:j.get("name"),text:j.get("fullName"),imgSrc:AJS.contextPath()+j.get("avatarUrl")}});h.auiSelect2("data",i)}})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/views/cards-index.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Views.CardsIndex=c.View.extend({template:d.Templates["cards-index-tmpl"],initialize:function(){},render:function(){var e=this;var g=e.collection;var f=e.template({cards:g});e.$el.html(f);return e}})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/views/list-show.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Views.ListShow=c.View.extend({template:d.Templates["list-show-tmpl"],tagName:"div",className:"list",initialize:function(){var e=this;e.model.on("add",e.render,e);e.model.get("cards").on("add",e.render,e);e.model.get("cards").on("remove",e.render,e);e.model.get("cards").on("change",e.render,e)},events:{"click div.card":"cardClick","submit form.add_card":"addCard","click button.archive_card":"archiveCard"},cardClick:function(g){g.stopPropagation();var e=this;var j=parseInt(b(g.currentTarget).data("card-id"));var h=e.model;var i=h.get("cards");var f=i.get(j);f.fetch({success:function(k){var n=new d.Views.CardShow({model:k});var m=n.render().$el;var l=e.createCardDialog(k.id,m);l.gotoPage(0);l.gotoPanel(0);l.show()}})},createCardDialog:function(g,f){var e=new AJS.Dialog({width:700,height:525,id:"edit-card-"+g+"-dialog",closeOnOutsideClick:true});e.addPanel("Content",f,"panel-body");e.popup.element.delegate(".card_dialog_close","click",function(h){h.preventDefault();e.remove()});return e},addCard:function(f){f.preventDefault();var o=this;var l=o.model;var e=l.get("cards");var h=new d.Models.Card();var k=b("div.lists_wrapper");var m=k.scrollLeft();var p=b(f.currentTarget);var n=p.serializeJSON();p[0].reset();n.card.listId=l.get("id");if(!n.card.title){var j=l.get("id");var i=b("div #list_"+j);var g=b("div #list_"+j+" input.card_title");g.hide();i.effect("shake",{distance:9,times:2,complete:function(){g.show();g.focus()}},350);k.scrollLeft(m);return false}h.save(n.card,{success:function(r){var q=l.id;e.add(h);setTimeout(function(){b("#card_"+h.id).removeClass("animated flipInX")},450);b("#card_"+h.id).addClass("animated flipInX");b("div.lists").scrollLeft(m);b("div #list_"+q+" input.card_title").focus()}})},archiveCard:function(g){g.stopPropagation();var e=this;var h=e.model;var j=parseInt(b(g.currentTarget).data("card-id"));var i=h.get("cards");var f=i.get(j);b("#card_"+f.id).addClass("animated flipOutX");setTimeout(function(){f.destroy({success:function(k){i.remove(f);e.updateCards()}})},300)},render:function(){var f=this;var j=f.model;var e=j.get("id");f.$el.attr("id","list_"+e);f.$el.html(f.template({list:j}));var k=j.get("cards");var i=new d.Views.CardsIndex({collection:k});f.$("section.cards").html(i.render().el);f.$(".js-edit-list-title").editable(function(n,m){j.set({title:n});j.save();return n},{submit:"Save",onblur:"submit",cssclass:"animated fadeIn aui",width:"none",height:"none"});var g=d.resourceUrl("/cards/order");var h=f.$("div.cards");var l;f.$("div.card").on("mousedown",function(n){if(n.which===1){var m=b(n.currentTarget).closest("div.card").outerHeight();l=h.closest(".flowboard").find("div.cards");l.css({minHeight:m});l.addClass("sorting")}});f.$("div.card").on("mouseup",function(m){if(l){l.css({minHeight:""});l.removeClass("sorting");l=null}});h.sortable({items:"div.card",connectWith:"div.cards",delay:125,tolerance:"pointer",placeholder:"card-placeholder",start:function(n,m){m.placeholder.width(m.item.width());m.placeholder.height(m.item.height())},update:function(){var m=f.getCardOrder();var n=JSON.stringify({listId:e,cardOrder:m});b.ajax({type:"PUT",url:g,data:n,contentType:"application/json",dataType:"json",success:function(){f.updateCards()},error:function(){d.syncError("Error sorting cards",arguments)}})}});return f},updateCards:function(){var f=this;var e=f.getCardOrder();var g=f.model.get("cards");b.each(e,function(j,k){var h=g.get(k);if(!h){h=f.takeCard(k)}h.set("position",j,k)});g.sort();f.render()},getCardOrder:function(){var f=this;var e=f.$("div.cards").sortable("toArray");return b.map(e,function(g){return parseInt(g.slice("card_".length))})},takeCard:function(k){var f=this;var h=f.model;var g=h.get("cards");var e=h.get("board");var j=e.get("lists");var i=null;j.each(function(l){var m=l.get("cards");m.each(function(n){if(n.get("id")===k){i=n;m.remove(k);n.set("list",h);n.set("listId",h.get("id"));g.add(n)}})});return i}});AJS.$(document).on("hideLayer",function(i,h,f){if(h==="popup"&&f.element&&f.element[0]){var g=f.element[0];if(/^edit-card-/.test(b(g).attr("id"))){f.remove()}}})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.flowboard.FlowBoard:flowboard-resources', location = 'assets/routers/main-router.js' */
(function(d){var b=d.$,a=d._,c=d.Backbone;d.Routers.Main=c.Router.extend({initialize:function(e){this.$rootEl=e.$rootEl},routes:{"":"showBoards"},showBoards:function(){var e=this;b.each(d.getBoardIds(),function(g,j){var h=d.boards.get(j);var f=new d.Views.BoardShow({model:h});b("#flowboard-"+j+" .flowboard-panel").html(f.render().$el)})}})}(FlowBoard));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-flag', location = 'js/aui/flag.js' */
(function(A){define("aui/flag",[],function(){return A(AJS,AJS.$,AJS.template)})})(function(L,F,N){var O=5000;var A="aui-flag-container";var E={body:"",persistent:false,close:"",title:"",type:"info"};function J(R){if(R.hasOwnProperty("persistent")){var P;if(R.persistent){P=L.deprecate.getMessageLogger("persistent: true","5.8.0",{alternativeName:"close: never",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2893."})}else{if(!R.persistent){P=L.deprecate.getMessageLogger("persistent: false","5.8.0",{alternativeName:"close: manual",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2893."})}}P()}R=F.extend({},E,R);var Q=R.close!=="never"&&(R.close||(R.persistent!==true));var S=D(R,Q);G(S);if(R.close==="auto"){M(S);C(S)}else{if(R.close==="manual"){M(S)}else{if(R.close==="never"){}else{if(!R.persistent){M(S)}}}}H();return K(S)}function G(Q){var P=Q[0];P.close=function(){B(Q)}}function D(Q,P){var R='<div class="aui-flag"><div class="aui-message aui-message-{type} {type} {closeable} shadowed"><p class="title"><strong>{title}</strong></p>{body}<!-- .aui-message --></div></div>';var S=N(R).fill({"body:html":Q.body||"",closeable:P?"closeable":"",title:Q.title||"",type:Q.type}).toString();return F(S)}function M(Q){var P=F('<span class="aui-icon icon-close" role="button" tabindex="0"></span>');P.click(function(){B(Q)});P.keypress(function(R){if((R.which===L.keyCode.ENTER)||(R.which===L.keyCode.SPACE)){B(Q);R.preventDefault()}});return Q.find(".aui-message").append(P)[0]}function C(P){P.find(".aui-message").addClass("aui-will-close");setTimeout(function(){P[0].close()},O)}function B(Q){var P=Q.get(0);P.setAttribute("aria-hidden","true");P.dispatchEvent(new CustomEvent("aui-flag-close",{bubbles:true}));return P}function H(){var Q=I();var P=Q.find(".aui-flag");P.get().forEach(function(R){var S=R.getAttribute("aria-hidden")==="true";if(S){F(R).remove()}})}function I(){return F("#"+A)}function K(Q){var P=I();if(!P.length){P=F('<div id="'+A+'"></div>');F("body").prepend(P)}Q.appendTo(P);L._internal.animation.recomputeStyle(Q);return Q.attr("aria-hidden","false")[0]}return J});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.watch-button:watch-resources', location = 'js/watch-model.js' */
define("confluence-watch-button/watch-model",["ajs","backbone"],function(a,b){return b.Model.extend({saveSettings:function(d,e){this.trigger("request");var c=this;return a.safe.ajax({url:d,type:"POST",dataType:"json",data:e}).done(function(){c.trigger("sync",c)}).fail(function(){c.trigger("error")})},saveWatchPage:function(d){var c=a.contextPath()+"/users/"+(d?"add":"remove")+"pagenotificationajax.action";this.set("watchingPage",d);return this.saveSettings(c,{pageId:this.get("pageId")})},saveWatchBlogs:function(d){var c=a.contextPath()+"/users/"+(d?"add":"remove")+"spacenotificationajax.action";this.set("watchingBlogs",d);return this.saveSettings(c,{spaceKey:this.get("spaceKey"),contentType:"blogpost"})},saveWatchSpace:function(d){var c=a.contextPath()+"/users/"+(d?"add":"remove")+"spacenotificationajax.action";this.set("watchingSpace",d);return this.saveSettings(c,{spaceKey:this.get("spaceKey")})}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.watch-button:watch-resources', location = 'js/watch-view.js' */
define("confluence-watch-button/watch-view",["jquery","ajs","backbone"],function(b,a,c){return c.View.extend({events:{"change #cw-watch-page":"changeWatchPage","change #cw-watch-blogs":"changeWatchBlogs","change #cw-watch-space":"changeWatchSpace"},initialize:function(){_.bindAll(this,"render","initTooltips","changeWatchPage","changeWatchBlogs","changeWatchSpace","togglePageEnabledState","toggleBlogsEnabledState","startLoading","stopLoading","setTitle");this.model.on("sync change:watchingSpace",this.togglePageEnabledState,this);this.model.on("change:watchingSpace",this.toggleBlogsEnabledState,this);this.model.on("request",this.startLoading,this);this.model.on("sync",this.setTitle,this);this.model.on("sync",this.stopLoading,this)},render:function(){this.$el.html(Confluence.Watch.Templates.dialogBody(this.model.toJSON()));this.initTooltips();this.setTitle(this.model);return this},initTooltips:function(){this.$(".cw-tooltip").tooltip({gravity:"e",offset:5,delayIn:0});this.togglePageEnabledState(this.model);this.toggleBlogsEnabledState(this.model)},changeWatchPage:function(f){var d=b(f.target).is(":checked");this.model.saveWatchPage(d)},changeWatchBlogs:function(f){var d=b(f.target).is(":checked");this.model.saveWatchBlogs(d)},changeWatchSpace:function(f){var d=b(f.target).is(":checked");this.model.saveWatchSpace(d)},togglePageEnabledState:function(d){var e=d.get("watchingPage");var g=d.get("watchingSpace");this.$("#cw-watch-page").prop("disabled",g);this.$("#cw-watch-page").prop("checked",e||g);var f=g?"You will receive updates for this page because you are watching this space.":"";this.$(".cw-tooltip-watch-page").attr("original-title",f)},toggleBlogsEnabledState:function(d){var g=d.get("watchingBlogs");var f=d.get("watchingSpace");this.$("#cw-watch-blogs").prop("disabled",f);this.$("#cw-watch-blogs").prop("checked",g||f);var e=f?"You are subscribed to all blog posts because you are watching this space.":"";this.$(".cw-tooltip-watch-blogs").attr("original-title",e)},startLoading:function(){this.$(".cw-status").addClass("loading")},stopLoading:function(){this.$(".cw-status").removeClass("loading")},setTitle:function(){var e=this.model.get("watchingPage");var i=this.model.get("watchingBlogs");var g=this.model.get("watchingSpace");var d=this.model.get("isBlogPost");function h(){if(g){return{title:"You are watching this space",description:"Receiving email updates for all content in this space.",}}if(e&&d&&i){return{title:"You are watching this blog post",description:"Receiving email updates about changes to this blog post and all new blog posts in this space.",}}if(e&&d){return{title:"You are watching this blog post",description:"Receiving email updates about changes to this blog post.",}}if(e){return{title:"You are watching this page",description:"Receiving email updates about changes to this page.",}}if(d&&i){return{title:"You are watching for new blog posts",description:"Receiving email updates for new blog posts in this space.",}}if(d){return{title:"You are not watching this blog",description:"Start watching to receive email updates about changes to this blog.",}}return{title:"You are not watching this page",description:"Start watching to receive email updates about changes to this page.",}}var f=h();this.$(".cw-title").text(f.title);this.$(".cw-title-description").text(f.description)}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.watch-button:watch-resources', location = 'js/watch.js' */
require(["jquery","underscore","ajs","confluence-watch-button/watch-model","confluence-watch-button/watch-view","confluence-watch-button/watch-notification"],function(b,i,h,f,d,g){h.toInit(function(){var j=b("#watch-content-button");if(!j.length){return}j.click(function(l){l.preventDefault()});var k=h.Meta.get("page-id");b.getJSON(h.contextPath()+"/rest/watch-button/1.0/watchState/"+k,function(l){i.extend(l,{pageId:k,spaceKey:h.Meta.get("space-key"),spaceName:h.Meta.get("space-name")});a(j,l);j.addClass("watch-state-initialised")})});function a(j,n){e(j,n);var m=new f(n);var l=new d({model:m});h.InlineDialog(j,"confluence-watch",function(p,o,q){l.setElement(p);l.render();q()},{width:325,offsetX:-180,cacheContent:false,hideDelay:null,hideCallback:function(){b(".tipsy").hide()}});m.on("change:watchingPage change:watchingBlogs change:watchingSpace",function(o){e(j,o.toJSON())});m.on("change:watchingPage",function(o,q){var p=q?"watch-page":"unwatch-page";h.trigger("analytics",{name:p})});m.on("change:watchingBlogs",function(o,q){var p=q?"watch-blogs":"unwatch-blogs";h.trigger("analytics",{name:p})});m.on("change:watchingSpace",function(o,q){var p=q?"watch-space":"unwatch-space";h.trigger("analytics",{name:p})});c(m);var k=false;b(document).on("keyup",function(){k=false});window.CW_watchPage=function(){if(k){return}k=true;var q=m.get("watchingSpace");var p=m.get("watchingPage");if(q){b("body, #splitter-content").animate({scrollTop:0},300,function(){j.click();setTimeout(function(){b(".cw-tooltip-watch-page").tipsy("show")},50)})}else{var r=!p;m.saveWatchPage(r);var o=r?"You started watching this page.":"You stopped watching this page.";g(o)}}}function e(k,q){var m=q.watchingPage;var j=q.isBlogPost&&q.watchingBlogs;var o=q.watchingSpace;if(m||j||o){var l=k.find(".aui-icon").removeClass("aui-iconfont-unwatch").addClass("aui-iconfont-watch");var n=h.format("{0}W{1}atching","<u>","</u>");k.prop("title","Stop watching (w)").children("span").empty().append(l).append(" "+n)}else{var l=k.find(".aui-icon").removeClass("aui-iconfont-watch").addClass("aui-iconfont-unwatch");var p=h.format("{0}W{1}atch","<u>","</u>");k.prop("title","Watch (w)").children("span").empty().append(l).append(" "+p)}}function c(j){j.on("change:watchingPage",function(k,m){var l=m?"watchpage.pageoperation":"unwatchpage.pageoperation";h.trigger(l)})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.watch-button:watch-resources', location = 'js/notification.js' */
define("confluence-watch-button/watch-notification",["jquery","aui/flag"],function(b,a){return function(e){var c=document.getElementById("watch-notification");if(c!=null){c.close()}var d=a({type:"success",body:e,close:"auto"});d.setAttribute("id","watch-notification")}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.watch-button:watch-resources', location = 'templates/watch.soy' */
// This file was automatically generated from watch.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Watch.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Watch == 'undefined') { Confluence.Watch = {}; }
if (typeof Confluence.Watch.Templates == 'undefined') { Confluence.Watch.Templates = {}; }


Confluence.Watch.Templates.dialogBody = function(opt_data, opt_ignored) {
  return '<div class="cw-status"><h2 class="cw-title"></h2><p class="cw-title-description"></p></div><form class="aui cw-dialog"><div class="cw-tooltip cw-tooltip-watch-page"><div class="checkbox"><input class="checkbox" type="checkbox" id="cw-watch-page" ' + ((opt_data.watchingPage) ? 'checked' : '') + '><label for="cw-watch-page">' + ((opt_data.isBlogPost) ? soy.$$escapeHtml("Watch blog post") : soy.$$escapeHtml("Watch page")) + '</label></div></div>' + ((opt_data.isBlogPost) ? '<div class="cw-tooltip cw-tooltip-watch-blogs"><div class="checkbox"><input class="checkbox" type="checkbox" id="cw-watch-blogs" ' + ((opt_data.watchingBlogs) ? 'checked' : '') + '><label for="cw-watch-blogs">' + soy.$$escapeHtml("Watch for new blog posts in this space") + '</label></div></div>' : '') + '<div class="checkbox"><input class="checkbox" type="checkbox" id="cw-watch-space" ' + ((opt_data.watchingSpace) ? 'checked' : '') + '><label for="cw-watch-space">' + soy.$$escapeHtml("Watch all content in this space") + '</label></div></form>' + ((opt_data.isAdmin) ? '<div class="cw-manage-watchers-wrapper"><button class="aui-button aui-button-link cw-manage-watchers">' + soy.$$escapeHtml("Manage Watchers") + '</button></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Watch.Templates.dialogBody.soyTemplateName = 'Confluence.Watch.Templates.dialogBody';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:soy-resources', location = 'soy/sidebar.soy' */
// This file was automatically generated from sidebar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Sidebar.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Sidebar == 'undefined') { Confluence.Templates.Sidebar = {}; }


Confluence.Templates.Sidebar.headerStyles = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '' + ((opt_data.sidebarWidth) ? '<style>.ia-fixed-sidebar, .ia-splitter-left {width: ' + soy.$$escapeHtml(opt_data.sidebarWidth) + 'px;}.theme-default .ia-splitter #main {margin-left: ' + soy.$$escapeHtml(opt_data.sidebarWidth) + 'px;}.ia-fixed-sidebar {visibility: hidden;}</style>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.headerStyles.soyTemplateName = 'Confluence.Templates.Sidebar.headerStyles';
}


Confluence.Templates.Sidebar.sidebar = function(opt_data, opt_ignored) {
  return '<div class="acs-side-bar ia-scrollable-section"><div class="acs-side-bar-space-info tipsy-enabled" data-configure-tooltip="' + soy.$$escapeHtml("Edit space details") + '"><div class="avatar"><div class="space-logo" data-key="' + soy.$$escapeHtml(opt_data.space.key) + '" data-name="' + soy.$$escapeHtml(opt_data.space.name) + '" data-entity-type="confluence.space"><div class="avatar-img-container"><div class="avatar-img-wrapper"><a href="' + soy.$$escapeHtml(opt_data.space.homeUrl) + '" title="' + soy.$$escapeHtml(opt_data.space.name) + '"><img class="avatar-img" src="' + soy.$$escapeHtml(opt_data.space.logoUrl) + '" alt="' + soy.$$escapeHtml(opt_data.space.name) + '"></a></div></div></div></div><div class="space-information-container"><div class="name"><a href="' + soy.$$escapeHtml(opt_data.space.homeUrl) + '" title="' + soy.$$escapeHtml(opt_data.space.name) + '">' + soy.$$escapeHtml(opt_data.space.name) + '</a></div><div class="flyout-handle icon"></div><div class="favourite-space-icon">' + Confluence.Templates.Sidebar.renderFavouriteSpace(opt_data) + '</div></div></div><div class="acs-side-bar-content"><div class="acs-nav-wrapper"><div class="acs-nav" data-has-create-permission="' + soy.$$escapeHtml(opt_data.hasCreatePermission) + '" data-quick-links-state="' + soy.$$escapeHtml(opt_data.quickLinksState) + '" data-nav-type="' + soy.$$escapeHtml(opt_data.navType) + '">' + Confluence.Templates.Sidebar.renderLinks(opt_data) + '</div></div>' + ((opt_data.contextualNav) ? Confluence.Templates.Sidebar.contextualNav(opt_data) : '') + '</div><div class="hidden"><a href="' + soy.$$escapeHtml(opt_data.space.browseSpaceUrl) + '" id="space-pages-link"></a><script type="text/x-template" title="logo-config-content"><h2>' + soy.$$escapeHtml("Space Details") + '</h2><div class="personal-space-logo-hint">' + soy.$$filterNoAutoescape(AJS.format("Your profile picture is used as the logo for your personal space. \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3eChange your profile picture\x3c/a\x3e.","" + '/users/profile/editmyprofilepicture.action')) + '</div><\/script></div></div>' + Confluence.Templates.Sidebar.renderSpaceToolsSection({advancedLinks: opt_data.advancedLinks, hasConfigurePermission: opt_data.hasConfigurePermission, currentlyViewed: opt_data.collectorToHighlight == 'spacebar-advanced'});
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.sidebar.soyTemplateName = 'Confluence.Templates.Sidebar.sidebar';
}


Confluence.Templates.Sidebar.renderFavouriteSpace = function(opt_data, opt_ignored) {
  return '<button title="' + soy.$$escapeHtml("Add to my spaces") + '" id="space-favourite-add" class="space-favourite aui-icon aui-icon-small aui-iconfont-unstar"></button><button class="' + ((! opt_data.isFavouriteSpace) ? ' space-favourite-hidden ' : '') + ' space-favourite aui-icon aui-icon-small aui-iconfont-star" id="space-favourite-remove" title="' + soy.$$escapeHtml("Remove from my spaces") + '"></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.renderFavouriteSpace.soyTemplateName = 'Confluence.Templates.Sidebar.renderFavouriteSpace';
}


Confluence.Templates.Sidebar.renderLinks = function(opt_data, opt_ignored) {
  return '<div class="acs-nav-sections">' + ((opt_data.mainLinks.length) ? Confluence.Templates.Sidebar.renderLinksSection({links: opt_data.mainLinks, sectionClass: 'main-links-section', collectorToHighlight: opt_data.collectorToHighlight}) : '') + ((opt_data.quickLinksState != 'hide') ? '<div class="quick-links-wrapper">' + ((opt_data.quickLinks.length) ? '<h5 class="ia-quick-links-header-title">' + soy.$$escapeHtml("Space shortcuts") + '</h5>' + Confluence.Templates.Sidebar.renderLinksSection({links: opt_data.quickLinks, sectionClass: 'quick-links-section tipsy-enabled', collectorToHighlight: null}) : (opt_data.hasConfigurePermission) ? '<h5 class="ia-quick-links-header-title">' + soy.$$escapeHtml("Space shortcuts") + '</h5><p class="tip">' + soy.$$filterNoAutoescape(AJS.format("Here you can add shortcut links to the most important content for your team or project. \x3ca href\x3d\x22{0}\x22 class\x3d\x22{1}\x22\x3eConfigure sidebar\x3c/a\x3e.",'','configure-sidebar')) + '</p>' : '') + '</div>' : '') + ((opt_data.hasSidebarCustomisation) ? Confluence.Templates.Sidebar.renderCustomContent(opt_data) : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.renderLinks.soyTemplateName = 'Confluence.Templates.Sidebar.renderLinks';
}


Confluence.Templates.Sidebar.renderCustomContent = function(opt_data, opt_ignored) {
  return '<div class="custom-sidebar"><div class="custom-sidebar-content"><div class="content">' + soy.$$filterNoAutoescape(opt_data.sidebarCustomisation) + '</div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.renderCustomContent.soyTemplateName = 'Confluence.Templates.Sidebar.renderCustomContent';
}


Confluence.Templates.Sidebar.renderLinksSection = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.links.length) {
    output += '<div class="' + soy.$$escapeHtml(opt_data.sectionClass) + ' ' + ((opt_data.highlightSection) ? ' current-section' : '') + '"><ul class="acs-nav-list">';
    var linkList123 = opt_data.links;
    var linkListLen123 = linkList123.length;
    for (var linkIndex123 = 0; linkIndex123 < linkListLen123; linkIndex123++) {
      var linkData123 = linkList123[linkIndex123];
      output += '<li class="acs-nav-item ' + soy.$$escapeHtml(linkData123.styleClass) + ((opt_data.collectorToHighlight && linkData123.collectorKey == opt_data.collectorToHighlight) ? ' current-item' : '') + '"' + ((linkData123.collectorKey) ? 'data-collector-key="' + soy.$$escapeHtml(linkData123.collectorKey) + '"' : '') + '><a class="acs-nav-item-link tipsy-enabled" href="' + soy.$$escapeHtml(linkData123.url) + '" data-collapsed-tooltip="' + soy.$$escapeHtml(linkData123.tooltip) + '"><span class="icon"></span><span class="acs-nav-item-label">' + soy.$$escapeHtml(linkData123.title) + '</span></a></li>';
    }
    output += '</ul></div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.renderLinksSection.soyTemplateName = 'Confluence.Templates.Sidebar.renderLinksSection';
}


Confluence.Templates.Sidebar.contextualNav = function(opt_data, opt_ignored) {
  return '<div class="ia-secondary-container tipsy-enabled" data-tree-type="' + ((opt_data.forBlogs) ? 'blogs' : (opt_data.forSettings) ? 'settings' : soy.$$escapeHtml(opt_data.navType)) + '">' + ((opt_data.forBlogs) ? '<div class="ia-secondary-header"><h5 class="ia-secondary-header-title blog"><span class="icon"></span><span class="label">' + soy.$$escapeHtml("Blog") + '</span></h5></div><div class="ia-secondary-content">' + Confluence.Templates.Sidebar.pagetreeList({pagetree: opt_data.contextualNav}) + '</div>' : (opt_data.forSettings) ? '<div class="ia-secondary-header"><h5 class="ia-secondary-header-title settings"><span class="label">' + soy.$$escapeHtml("Advanced") + '</span></h5></div><div class="ia-secondary-content">' + Confluence.Templates.Sidebar.pagetreeList({pagetree: opt_data.contextualNav}) + '</div>' : (opt_data.navType == 'page-tree') ? '<div class="ia-secondary-header"><h5 class="ia-secondary-header-title page-tree"><span class="icon"></span><span class="label">' + soy.$$escapeHtml("Page tree") + '</span></h5></div>' + ((opt_data.pageTreeEmpty) ? '<p class="tip">' + soy.$$filterNoAutoescape(AJS.format("Get started by adding some pages to this space. \x3ca href\x3d\x22{0}\x22 class\x3d\x22{1}\x22\x3eCreate page\x3c/a\x3e.","" + '/pages/createpage.action?spaceKey=' + opt_data.space.key,'page-tree-create-child-page-link')) + '</p>' : '<div class="ia-secondary-content">' + soy.$$filterNoAutoescape(opt_data.contextualNav) + '</div>') : Confluence.Templates.Sidebar.Pages.renderPageContextualNav({pageContextualNav: opt_data.contextualNav, hasCreatePermission: opt_data.hasCreatePermission})) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.contextualNav.soyTemplateName = 'Confluence.Templates.Sidebar.contextualNav';
}


Confluence.Templates.Sidebar.pagetreeList = function(opt_data, opt_ignored) {
  var output = '<ul class="' + ((opt_data.isSubtree) ? 'ia-subpagetree' : 'ia-pagetree') + '">';
  var itemList197 = opt_data.pagetree;
  var itemListLen197 = itemList197.length;
  for (var itemIndex197 = 0; itemIndex197 < itemListLen197; itemIndex197++) {
    var itemData197 = itemList197[itemIndex197];
    output += Confluence.Templates.Sidebar.pagetreeItem(itemData197);
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.pagetreeList.soyTemplateName = 'Confluence.Templates.Sidebar.pagetreeList';
}


Confluence.Templates.Sidebar.throbber = function(opt_data, opt_ignored) {
  return '<div class="content-container"><div class="throbber-container"><div class="throbber"><div class="spinner"></div><span>' + soy.$$escapeHtml("Loading...") + '</span></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.throbber.soyTemplateName = 'Confluence.Templates.Sidebar.throbber';
}


Confluence.Templates.Sidebar.treeThrobber = function(opt_data, opt_ignored) {
  return '<ul class="ia-subpagetree"><li class="acs-tree-item leaf"><span class="node-title">' + soy.$$escapeHtml("Loading...") + '</span></li></ul>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.treeThrobber.soyTemplateName = 'Confluence.Templates.Sidebar.treeThrobber';
}


Confluence.Templates.Sidebar.pagetreeItem = function(opt_data, opt_ignored) {
  return '<li class="acs-tree-item' + ((opt_data.hasChildren) ? (opt_data.children.length) ? ' opened' : ' closed' : ' leaf') + ((opt_data.groupType) ? ' grouping' : '') + ((opt_data.active) ? ' current-item' : '') + '"' + ((opt_data.pageId) ? ' data-page-id="' + soy.$$escapeHtml(opt_data.pageId) + '"' : '') + ((opt_data.groupType) ? ' data-group-type="' + soy.$$escapeHtml(opt_data.groupType) + '" data-group-value="' + soy.$$escapeHtml(opt_data.groupValue) + '"' : '') + '>' + ((! opt_data.groupType) ? '<a href="' + soy.$$escapeHtml(opt_data.url) + '">' : '') + '<span class="icon ' + ((opt_data.hasChildren) ? (opt_data.children.length) ? 'icon-section-opened' : 'icon-section-closed' : '') + '"></span><span class="node-title navigation-pseudo-link">' + soy.$$escapeHtml(opt_data.title) + '</span>' + ((! opt_data.groupType) ? '</a>' : '') + ((opt_data.children && opt_data.children.length > 0) ? Confluence.Templates.Sidebar.pagetreeList({pagetree: opt_data.children, isSubtree: true}) : '') + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.pagetreeItem.soyTemplateName = 'Confluence.Templates.Sidebar.pagetreeItem';
}


Confluence.Templates.Sidebar.renderSpaceToolsSection = function(opt_data, opt_ignored) {
  var output = '<div class="space-tools-section"><div id="space-tools-menu-additional-items" class="hidden">';
  var linkList267 = opt_data.advancedLinks;
  var linkListLen267 = linkList267.length;
  for (var linkIndex267 = 0; linkIndex267 < linkListLen267; linkIndex267++) {
    var linkData267 = linkList267[linkIndex267];
    output += '<div data-label="' + soy.$$escapeHtml(linkData267.title) + '" data-class="' + soy.$$escapeHtml(linkData267.styleClass) + '" data-href="' + soy.$$escapeHtml(linkData267.url) + '">' + soy.$$escapeHtml(linkData267.title) + '</div>';
  }
  output += ((opt_data.hasConfigurePermission) ? '<div data-label="' + soy.$$escapeHtml("Configure sidebar") + '" data-class="configure-sidebar" data-href="">' + soy.$$escapeHtml("Configure sidebar") + '</div>' : '') + '</div>' + aui.dropdown2.trigger({menu: {id: 'space-tools-menu'}, id: 'space-tools-menu-trigger', tagName: 'button', extraClasses: 'aui-button aui-button-subtle tipsy-enabled' + ((opt_data.currentlyViewed) ? ' current-item' : ''), content: aui.icons.icon({useIconFont: true, icon: 'configure', accessibilityText: "Configure"}) + '<span class="aui-button-label">' + soy.$$escapeHtml("Space tools") + '</span>'}) + aui.dropdown2.contents({id: 'space-tools-menu', extraClasses: 'aui-style-default', extraAttributes: {'data-aui-alignment': 'top left'}}) + '<a class="expand-collapse-trigger"></a></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.renderSpaceToolsSection.soyTemplateName = 'Confluence.Templates.Sidebar.renderSpaceToolsSection';
}


Confluence.Templates.Sidebar.spaceToolsMenu = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.isAuiFiveSeven) {
    output += '<div class="space-tools-menu"><div class="aui-dropdown2-section"><ul class="space-tools-navigation">';
    var linkList312 = opt_data.spaceToolLinks;
    var linkListLen312 = linkList312.length;
    for (var linkIndex312 = 0; linkIndex312 < linkListLen312; linkIndex312++) {
      var linkData312 = linkList312[linkIndex312];
      output += '<li><a href="' + soy.$$escapeHtml(linkData312.href) + '" title="' + soy.$$escapeHtml(linkData312.label) + '">' + soy.$$escapeHtml(linkData312.label) + '</a></li>';
    }
    output += '</ul></div>';
    if (opt_data.spaceLinks.length > 0) {
      output += '<div class="aui-dropdown2-section"><ul class="space-operations">';
      var linkList325 = opt_data.spaceLinks;
      var linkListLen325 = linkList325.length;
      for (var linkIndex325 = 0; linkIndex325 < linkListLen325; linkIndex325++) {
        var linkData325 = linkList325[linkIndex325];
        output += '<li><a class="' + soy.$$escapeHtml(linkData325.className) + '" href="' + soy.$$escapeHtml(linkData325.href) + '" title="' + soy.$$escapeHtml(linkData325.label) + '">' + soy.$$escapeHtml(linkData325.label) + '</a></li>';
      }
      output += '</ul></div>';
    }
    output += '</div>';
  } else {
    output += aui.dropdown2.itemGroup({isTruncated: true, items: opt_data.spaceToolLinks}) + ((opt_data.spaceLinks.length > 0) ? aui.dropdown2.itemGroup({isTruncated: true, items: opt_data.spaceLinks}) : '');
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.spaceToolsMenu.soyTemplateName = 'Confluence.Templates.Sidebar.spaceToolsMenu';
}


Confluence.Templates.Sidebar.configure = function(opt_data, opt_ignored) {
  return '<div class="acs-nav-sections"><table id="acs-nav-list-main" class="acs-nav-list"></table><div class="acs-nav-list-quick-section' + ((opt_data.quickLinksState == 'hide') ? ' hidden-section' : '') + '"><div class="quick-links-header"><h5>' + soy.$$escapeHtml("Space shortcuts") + '</h5><a href="#" class="aui-icon aui-icon-small toggle-link" data-tooltip="' + soy.$$escapeHtml("Hide/Show space shortcuts") + '"/></div><table id="acs-nav-list-quick" class="acs-nav-list"></table><p class="tip">' + soy.$$escapeHtml("Click \x22Add link\x22 to add links to the sidebar.") + '</p><a class="acs-add-link" href="#"><span class="icon"></span><span class="label">' + soy.$$escapeHtml("Add link") + '</span></a></div>' + ((opt_data.hasSidebarCustomisation) ? '<p class="tip">' + soy.$$filterNoAutoescape(AJS.format("You can continue editing your customized sidebar in the space admin. \x3ca href\x3d\x22{0}\x22 class\x3d\x22{1}\x22\x3eGo to space admin\x3c/a\x3e.",opt_data.customContentAdminLink,'custom-sidebar-tip')) + '</p>' + Confluence.Templates.Sidebar.renderCustomContent(opt_data) : '') + '<h5>' + soy.$$escapeHtml("Navigation display options") + '</h5><form class="aui"><div class="radio"><input class="radio acs-nav-type" type="radio" name="nav-type" value="pages" id="nav-type-pages" ' + ((! opt_data.pageTree) ? 'checked' : '') + '><label for="nav-type-pages">' + soy.$$escapeHtml("Child pages") + '</label></div><div class="radio"><input class="radio acs-nav-type" type="radio" name="nav-type" value="page-tree" id="nav-type-tree" ' + ((opt_data.pageTree) ? 'checked' : '') + '><label for="nav-type-tree">' + soy.$$escapeHtml("Page tree") + '</label></div></form><button class="aui-style aui-button acs-done-link">' + soy.$$escapeHtml("Done") + '</button></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.configure.soyTemplateName = 'Confluence.Templates.Sidebar.configure';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:soy-resources', location = 'soy/sidebar-pages.soy' */
// This file was automatically generated from sidebar-pages.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Sidebar.Pages.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Sidebar == 'undefined') { Confluence.Templates.Sidebar = {}; }
if (typeof Confluence.Templates.Sidebar.Pages == 'undefined') { Confluence.Templates.Sidebar.Pages = {}; }


Confluence.Templates.Sidebar.Pages.renderPageContextualNav = function(opt_data, opt_ignored) {
  return '<div class="ia-secondary-header"><h5 class="ia-secondary-header-title pages"><span class="label">' + soy.$$escapeHtml("Child pages") + '</span></h5></div><div class="ia-secondary-parent-content">' + Confluence.Templates.Sidebar.Pages.parentPage({parentPage: opt_data.pageContextualNav.parentPage}) + '</div><div class="ia-secondary-current-content">' + Confluence.Templates.Sidebar.Pages.currentPage({currentPage: opt_data.pageContextualNav.currentPage}) + '</div><div class="ia-secondary-content">' + Confluence.Templates.Sidebar.Pages.childPages({children: opt_data.pageContextualNav, createPermission: opt_data.hasCreatePermission}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.Pages.renderPageContextualNav.soyTemplateName = 'Confluence.Templates.Sidebar.Pages.renderPageContextualNav';
}


Confluence.Templates.Sidebar.Pages.childPages = function(opt_data, opt_ignored) {
  return '<div class="contextual-nav-child-pages">' + ((opt_data.children.initialChildPages.length) ? '<ul class="children">' + Confluence.Templates.Sidebar.Pages.renderChildren({children: opt_data.children.initialChildPages}) + '</ul>' + ((opt_data.children.remainingChildPages.length) ? '<ul class="more-children">' + Confluence.Templates.Sidebar.Pages.renderChildren({children: opt_data.children.remainingChildPages}) + '</ul><a class="more-children-link" href=""><span class="icon"></span><span class="label">' + soy.$$escapeHtml(AJS.format("{0} more child pages",opt_data.children.remainingChildPages.length)) + '</span></a>' : '') : '') + ((opt_data.createPermission && opt_data.children.createLink) ? '<a class="create-child-page-link" href="' + soy.$$escapeHtml(opt_data.children.createLink) + '"><span class="icon"></span><span class="label">' + soy.$$escapeHtml("Create child page") + '</span></a>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.Pages.childPages.soyTemplateName = 'Confluence.Templates.Sidebar.Pages.childPages';
}


Confluence.Templates.Sidebar.Pages.currentPage = function(opt_data, opt_ignored) {
  return '' + ((opt_data.currentPage) ? '<ul class="ia-secondary-currentPage-title wiki' + ((opt_data.currentPage.active) ? ' current-item' : '') + '"><li><span class="icon"></span><span class="label">' + soy.$$escapeHtml(opt_data.currentPage.title) + '</span></li></ul>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.Pages.currentPage.soyTemplateName = 'Confluence.Templates.Sidebar.Pages.currentPage';
}


Confluence.Templates.Sidebar.Pages.parentPage = function(opt_data, opt_ignored) {
  return '' + ((opt_data.parentPage) ? '<ul class="parent ia-secondary-header-title wiki' + ((opt_data.parentPage.active) ? ' current-item' : '') + '"><li class="parent-item"><a class="parent-item-link" href="' + soy.$$escapeHtml(opt_data.parentPage.url) + '" title="' + soy.$$escapeHtml(opt_data.parentPage.title) + '"><span class="icon"></span><span class="label">' + soy.$$escapeHtml(opt_data.parentPage.title) + '</span></a></li></ul>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.Pages.parentPage.soyTemplateName = 'Confluence.Templates.Sidebar.Pages.parentPage';
}


Confluence.Templates.Sidebar.Pages.renderChildren = function(opt_data, opt_ignored) {
  var output = '';
  var childList65 = opt_data.children;
  var childListLen65 = childList65.length;
  for (var childIndex65 = 0; childIndex65 < childListLen65; childIndex65++) {
    var childData65 = childList65[childIndex65];
    output += '<li class="child-item" data-page-id="' + soy.$$escapeHtml(childData65.pageId) + '"><span class="icon"></span><a href="' + soy.$$escapeHtml(childData65.url) + '" title="' + soy.$$escapeHtml(childData65.title) + '"><span class="label">' + soy.$$escapeHtml(childData65.title) + '</span></a></li>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Sidebar.Pages.renderChildren.soyTemplateName = 'Confluence.Templates.Sidebar.Pages.renderChildren';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.editor-loader:background-loading-editor', location = 'jscripts/editor-loader.js' */
define("confluence-editor-loader/editor-loader","jquery confluence/legacy confluence/meta ajs wrm window".split(" "),function(e,j,h,d,l,m){var b,c={_listening:false,_queuedHandlers:[],_watchHandler:function(){j.Editor.UI.toggleWatchPage(false)},_unwatchHandler:function(){j.Editor.UI.toggleWatchPage(true)},_createQueueAdder:function(a){return function(){c._listening&&c._queuedHandlers.push(a)}},bind:function(){d.bind("watchpage.pageoperation",this._createQueueAdder(this._watchHandler));d.bind("unwatchpage.pageoperation",
this._createQueueAdder(this._unwatchHandler))},setListening:function(a){this._listening=a},applyHandlers:function(){for(var a=this._queuedHandlers.pop();a;){a();a=this._queuedHandlers.pop()}}};c.setListening(true);c.bind();var k=function(){var a=e("#editor-preload-container");a.length||(a=e('<div id="editor-preload-container" style="display: none;"></div>'));return a},f;return{getPreloadContainer:k,getEditorPreloadMarkup:function(){if(f)return f;var a=d.contextPath()+"/plugins/editor-loader/editor.action";
return f=e.get(a,{parentPageId:h.get("parent-page-id"),pageId:h.get("page-id"),spaceKey:h.get("space-key"),atl_after_login_redirect:m.location.pathname,timeout:d.Confluence.EditorLoader.loadingTimeout})},resourcesLoaded:function(){return b&&b.isResolved()},loadingTimeout:12E3,isEditorActive:function(){var a=e("#editor-preload-container");return a.length&&a.is(":visible")},load:function(a,c){var g;if(b){b.fail(function(){c?c.call(this,arguments):d.log("EditorLoader: loadGuard - previous load failed.")});
b.done(function(){a?b.done(function(){setTimeout(a,0)}):d.log("EditorLoader: loadGuard - editor is already loaded.")});g=true}else g=void 0;if(!g){b=new e.Deferred;a&&b.done(a);c&&b.fail(c);var f=k();e("body").append(f);var i=new e.Deferred;h.get("page-id")?this.getEditorPreloadMarkup().done(function(a,b,c){if(b==="success"||b==="notmodified"){f.append(a);a=d.renderTemplate("dynamic-editor-metadata");e("head").append(a);d.populateParameters();d.debug("EditorLoader: Finished loading the editor template.");
i.resolve()}else i.reject("Error loading the Editor template: "+c.status+" - "+c.statusText)}):i.resolve();g=l.require(["wrc!editor","wrc!macro-browser","wrc!fullpage-editor"]).fail(function(a){d.logError("Failed to load editor resources",a)});e.when(i,g).done(function(){d.debug("EditorLoader: Finished loading the editor.");b.resolve()}).fail(function(){b.reject(arguments)})}},getEditorForm:function(){if(this.isEditorActive()){var a=require("tinymce");return e(a.activeEditor.getContainer()).closest("form")}return null}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor-loader/editor-loader","AJS.Confluence.EditorLoader");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.editor-loader:background-loading-editor', location = 'jscripts/block-and-buffer-keys.js' */
define("confluence-editor-loader/block-and-buffer-keys",[],function(){return{block:function(e){var d=[],f=function(a){a.preventDefault();a.stopPropagation();var c=a.which;c||(c=a.charCode?a.charCode:a.keyCode);13!==c&&48>c||d.push(c);a.preventDefault()};e.keypress(f);return function(){e.unbind("keypress",f);for(var a="",c=0;c<d.length;c++){var b;b=d[c];65535<b?(b-=65536,b=String.fromCharCode(55296+(b>>10),56320+(b&1023))):b=String.fromCharCode(b);a+=b}return a}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor-loader/block-and-buffer-keys","AJS.Confluence.BlockAndBuffer");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/linkbrowser-editor-adapter.js' */
AJS.$(function(){if(!$("body").hasClass("with-space-sidebar")){return}Confluence=Confluence||{};Confluence.Editor=Confluence.Editor||{};AJS.Rte=AJS.Rte||{};AJS.Rte.BookmarkManager=AJS.Rte.BookmarkManager||{};AJS.Rte.BookmarkManager.storeBookmark=AJS.$.noop;AJS.Rte.BookmarkManager.restoreBookmark=AJS.$.noop});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-ia.js' */
(function(a){Confluence.Sidebar={};AJS.toInit(function(h){var s=h(window);var G=h(document);var w=Math.min(285,s.width()/3);var H=285;var F=150;var t=55;var q=AJS.contextPath();var p=AJS.Meta.get("space-key");var c=AJS.Meta.get("use-keyboard-shortcuts")?" "+"(\u2009[\u2009)":"";Confluence.Sidebar.collapseTooltip="Collapse sidebar"+c;Confluence.Sidebar.expandTooltip="Expand sidebar"+c;var g=h(".ia-splitter").children();var I=h(".ia-splitter-left");if(I.length<1){return}var n=h(".acs-side-bar");var y=I.find(".ia-fixed-sidebar");var d=h("<div>",{"class":"ia-splitter-handle tipsy-enabled","data-tooltip":Confluence.Sidebar.collapseTooltip}).appendTo(y);h("<div>",{"class":"ia-splitter-handle-highlight"}).appendTo(d);var i=h(".ia-secondary-container");var A=h("#footer, #studio-footer");Confluence.Sidebar.throbberDiv=j;i.length&&E(i.attr("data-tree-type"));s.scroll(x);s.resize(x);s.on("touchend",x);G.ready(x);AJS.bind("confluence.header-resized",x);h("#header-precursor img").load(x);Confluence.Sidebar.applyTooltip=u;l();AJS.bind("sidebar.exit-configure-mode",l);try{var m=localStorage.sidebarWidth||w}catch(C){m=w}var f=m>F?m:t;k(f);v();y.css("visibility","visible");x();o();setTimeout(function(){Confluence.Sidebar.createFlyouts(n)},0);AJS.trigger("sidebar.finished-loading");s.one("pagetree-children-loaded",function(){var e=h(".plugin_pagetree_current");if(e.length){var K=e.offset();if(K.top>n.height()/2){n.scrollTop(K.top-n.height()/3)}if(K.left>n.width()/2){n.scrollLeft(K.left-n.width()/2)}}});AJS.bind("sidebar.enter-configure-mode",function(){b();J();y.addClass("configure-mode")});AJS.bind("sidebar.exit-configure-mode",function(){b();z();y.removeClass("configure-mode")});function b(){AJS.trigger("sidebar.hide-overlays")}function u(e,L){var K={live:true,gravity:"w",title:"data-tooltip",delayIn:500,delayOut:0,offset:5};h(e).tooltip(L?h.extend(K,L):K)}function l(){h(".acs-side-bar .quick-links-section").attr("data-collapsed-tooltip","Space shortcuts");h("#space-tools-menu-trigger").attr("data-collapsed-tooltip","Space tools");if(i.attr("data-tree-type")=="pages"){h(".acs-side-bar .ia-secondary-container").attr("data-collapsed-tooltip","Child pages");u(".collapsed .ia-secondary-container.tipsy-enabled",{title:"data-collapsed-tooltip"})}u(".expand-collapse-trigger");u(".ia-splitter-handle.tipsy-enabled");u(".collapsed .quick-links-section.tipsy-enabled, .collapsed .acs-nav-item > a.tipsy-enabled, .collapsed #space-tools-menu-trigger.tipsy-enabled",{title:"data-collapsed-tooltip"});u(".configure-mode .acs-side-bar-space-info.tipsy-enabled",{title:"data-configure-tooltip"});n.on("mousedown click scroll",b);h(window).on("scroll resize",b);AJS.bind("sidebar.hide-overlays",K);AJS.bind("sidebar.disable-tooltip",L);AJS.bind("sidebar.enable-all-tooltips",e);function L(P,O){var M=h(O).closest(".tipsy-enabled");if(M.size()!=1){return}M.removeClass("tipsy-enabled").addClass("tipsy-disabled").attr("title","");var N=M.data("tipsy");if(N){N.hoverState="out"}K()}function e(){h(".tipsy-disabled").removeClass("tipsy-disabled").addClass("tipsy-enabled")}function K(){h(".tipsy").remove()}}function v(){G.on("mousewheel",".ia-scrollable-section",function(N,O){var M=h(this).scrollTop();var L=h(this).get(0).scrollHeight-h(this).innerHeight()-1;if((O>0&&M<=0)||(O<0&&M>=L)){N.preventDefault()}else{if(h.browser.msie){N.preventDefault();var K=30;h(this).scrollTop(M+(-1*O*K))}}N.stopPropagation()})}function j(){var K=h(Confluence.Templates.Sidebar.throbber()),L=K.find(".spinner"),e=Raphael.spinner(L[0],10,"#666");K.find(".throbber").bind("remove",function(){e()});return K}function E(e){if(e==="blogs"){D(n,r)}else{if(e==="pages"){Confluence.Sidebar.Pages.installHandlers(n)}}}function r(M,N){var L=M.attr("data-group-type");var e=M.attr("data-group-value");var K=q+"/rest/ia/1.0/pagetree/blog/subtree";h.get(K,{spaceKey:p,groupType:L,groupValue:e}).done(N)}function D(e,K){e.delegate(".acs-tree-item > .icon, .acs-tree-item > .node-title","click",function(){var P=h(this);var O=P.parent();var L=O.find("> .icon");if(O.hasClass("opened")){O.children("ul").hide();O.removeClass("opened").addClass("closed");L.removeClass("icon-section-opened").addClass("icon-section-closed")}else{if(O.hasClass("closed")){var M=O.children("ul");if(M.length){M.show()}else{var N=h(Confluence.Templates.Sidebar.treeThrobber());O.append(N);K(O,function(R){var Q=h(Confluence.Templates.Sidebar.pagetreeList({pagetree:R,isSubtree:true}));N.remove();Q.appendTo(O)})}O.removeClass("closed").addClass("opened");L.removeClass("icon-section-closed").addClass("icon-section-opened")}}})}function x(){var e=I.offset().top,K=s.scrollTop(),L=s.scrollLeft();if(K<0){return}if(K>(G.height()-s.height())){return}if(L<0){return}if(L>(G.width()-s.width())){return}if(h("#header").css("position")!=="fixed"){y.css({top:Math.max(e-K,0)+"px",left:Math.min(L*-1,0)+"px"})}else{y.css({left:Math.min(L*-1,0)+"px"})}}function B(){A.css("margin-left",y.outerWidth()+"px")}function o(){var M=h("body");var K=false;var L=false;var N=function(O){L=true;O.preventDefault();g.one("selectstart",function(Q){Q.preventDefault()});var P=function(){if(y.width()<=F){k(t)}else{w=y.width()}L=false;M.off("mousemove.ia-splitter")};K=false;M.on("mousemove.ia-splitter",function(Q){if(Confluence.Sidebar.Configure.mode&&Q.pageX<H){return}k(Q.pageX);K=true});M.one("mouseup mouseleave",P)};d.on("mousedown.ia-splitter",function(O){N(O);b()}).click(function(){if(!K){e()}else{K=false}});Confluence.Sidebar.toggle=e;function e(){if(Confluence.Sidebar.Configure.mode){return}var O=y.width();if(O>t){if(O<=F){w=H;k(w)}else{w=O;k(t)}}else{k(w)}}}function k(K){K=Math.max(K,t);try{localStorage.sidebarWidth=K}catch(L){}if(K<=F){y.addClass("collapsed");d.attr("data-tooltip",Confluence.Sidebar.expandTooltip);AJS.trigger("sidebar.collapsed")}else{if(y.hasClass("collapsed")){y.removeClass("collapsed");d.attr("data-tooltip",Confluence.Sidebar.collapseTooltip);AJS.trigger("sidebar.expanded")}}y.width(K);g.eq(1).css("margin-left",K+"px");B()}function J(){if(y.width()<H){Confluence.Sidebar.widthBeforeConfiguring=y.width();k(H)}}function z(){if(Confluence.Sidebar.widthBeforeConfiguring){k(Confluence.Sidebar.widthBeforeConfiguring);Confluence.Sidebar.widthBeforeConfiguring=undefined}}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/configurable-nav.js' */
(function(a){AJS.Confluence.ConfigurableNav=AJS.RestfulTable.extend({initialize:function(c){var b=this;b.options=a.extend(true,c,{model:AJS.RestfulTable.EntryModel,Collection:Backbone.Collection.extend({url:c.resources.self,model:AJS.RestfulTable.EntryModel}),columns:[{id:"title"}]});b._events=b._events||AJS.RestfulTable.Events;b._event=b._event||AJS.RestfulTable.Events;b.classNames=AJS.RestfulTable.ClassNames;b.dataKeys=AJS.RestfulTable.DataKeys;b.$table=c.$el.addClass(this.classNames.RESTFUL_TABLE).addClass(this.classNames.ALLOW_HOVER).addClass("aui").addClass(b.classNames.LOADING);b.$table.prepend('<colgroup><col span="1" class="aui-restfultable-order"><col span="1"><col span="1" class="aui-restfultable-operations"></colgroup>');b.$tbody=a("<tbody/>");b._models=this._createCollection();b._rowClass=AJS.Confluence.ConfigurableNav.Row;b.editRows=[];b.enableReordering();b._models.bind("remove",function(d){a.each(b.getRows(),function(e,f){if(f.model===d){if(f.hasFocus()&&b._createRow){b._createRow.trigger(b._event.FOCUS)}b.removeRow(f)}})});a.get(b.options.resources.all,function(d){b.populate(d)});Confluence.Sidebar.applyTooltip(".hide-link, .show-link, .delete-link, .toggle-link",{gravity:"ne"})},enableReordering:function(){var b=this;this.$tbody.sortable({handle:"."+this.classNames.DRAG_HANDLE,helper:function(f,c){var d=c.clone(true).addClass(b.classNames.MOVEABLE);d.children().each(function(e){a(this).width(c.children().eq(e).width())});return d},start:function(c,d){var e=d.placeholder.find("td");d.item.addClass(b.classNames.MOVEABLE).children().each(function(f){a(this).width(e.eq(f).width())});d.placeholder.html('<td colspan="'+b.getColumnCount()+'">&nbsp;</td>').css("visibility","visible");b.getRowFromElement(d.item[0]).trigger(b._event.MODAL)},stop:function(c,d){if(jQuery(d.item[0]).is(":visible")){d.item.removeClass(b.classNames.MOVEABLE).children().attr("style","");d.placeholder.removeClass(b.classNames.ROW);b.getRowFromElement(d.item[0]).trigger(b._event.MODELESS)}},update:function(e,g){var c,d,f={},h=b.getRowFromElement(g.item[0]);if(h){if(b.options.reverseOrder){d=g.item.next();if(!d.length){f.position="First"}else{c=b.getRowFromElement(d).model;f.after=c.url()}}else{d=g.item.prev();if(!d.length){f.position="First"}else{c=b.getRowFromElement(d).model;f.after=c.url()}}f.spaceKey=AJS.Meta.get("space-key");a.ajax({url:h.model.url()+"/move",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(f),complete:function(){h.hideLoading()},success:function(i){AJS.triggerEvtForInst(b._event.REORDER_SUCCESS,b,[i])},error:function(j){var i=a.parseJSON(j.responseText||j.data);AJS.triggerEvtForInst(b._event.SERVER_ERROR,b,[i,j])}});h.showLoading()}},axis:"y",delay:0,containment:"document",cursor:"move",scroll:true,zIndex:8000});this.$tbody.bind("selectstart mousedown",function(c){return !a(c.target).is("."+b.classNames.DRAG_HANDLE)})}});AJS.Confluence.ConfigurableNav.ReadView=AJS.RestfulTable.CustomReadView.extend({render:function(b){return _.template('<span class="acs-nav-item-link" title="<%=title%>"><span class="icon"></span><span class="acs-nav-item-label"><%=title%></span></span>',{title:AJS.escapeHtml(b.title)})}});AJS.Confluence.ConfigurableNav.Row=AJS.RestfulTable.Row.extend({render:function(){var b=this,d=this.model.toJSON(),e=a("<td class='aui-restfultable-operations' />").append(this.renderOperations(d.canHide,d.hidden)),c=a('<td class="'+this.classNames.ORDER+'"/>').append(this.renderDragHandle());b._event=b._event||b._events;b.$el.attr("data-id",this.model.id);b.$el.append(c);a.each(b.columns,function(f,g){var h,k=a("<td />"),j=d[g.id];if(j){b.$el.attr("data-"+g.id,j)}h=new AJS.Confluence.ConfigurableNav.ReadView().render(d);k.append(h);b.$el.append(k)});b.$el.append(e);d.canHide&&d.hidden&&b.$el.addClass("hidden-link");b.$el.addClass(this.classNames.ROW+" "+b.classNames.READ_ONLY+" acs-nav-item "+d.styleClass);b.trigger(this._event.RENDER,this.$el,d);b.$el.trigger(this._event.CONTENT_REFRESHED,[b.$el]);return b},renderOperations:function(f,e){var c=this,b=a('<a href="#" class="aui-icon aui-icon-small"/>');if(f){function d(g){if(g.hasClass("hide-link")){g.attr("data-tooltip","Hide link")}else{g.attr("data-tooltip","Show link")}}b.addClass(e?"show-link":"hide-link").click(function(g){g.preventDefault();a.ajax({url:c.model.url()+(e?"/show":"/hide"),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({spaceKey:AJS.Meta.get("space-key")})}).done(function(){b.closest(".acs-nav-item").toggleClass("hidden-link");b.toggleClass("hide-link").toggleClass("show-link");d(b)})});d(b)}else{b.addClass("delete-link tipsy-enabled").click(function(g){g.preventDefault();if(a(".acs-nav").data("quick-links-state")!="hide"){AJS.trigger("sidebar.disable-tooltip",this);c.destroy()}}).attr("data-tooltip","Remove link")}return b},destroy:function(){this.model.destroy({data:{spaceKey:AJS.Meta.get("space-key")}})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-pages.js' */
(function(b){var a=AJS.Meta.get("context-path");Confluence.Sidebar.Pages={installHandlers:function(d){d.find(".more-children-link").click(function(f){f.preventDefault();d.find("ul.more-children").show();b(this).hide()})},quickLinksContent:function(){return new b.Deferred().resolve(b(".acs-side-bar .quick-links-wrapper").html())},childPageCollapsedContent:function(){var e=b(".acs-side-bar .ia-secondary-header");var d=b(".acs-side-bar .ia-secondary-parent-content");var g=b(".acs-side-bar .ia-secondary-current-content");var f=b(".acs-side-bar .ia-secondary-content");return new b.Deferred().resolve(b("<div>").append(b("<div>").addClass("acs-side-bar-flyout-wiki-wrapper").append(e.clone()).append(d.clone()).append(g.clone()).append(f.clone())).html())},pageTreeCollapsedContent:function(){var d=b(".page-tree-flyout-content");if(d.length==0){return c().pipe(function(e){var f=b("<div>").addClass("acs-side-bar-flyout-wiki-wrapper").append(Confluence.Templates.Sidebar.Pages.renderPageContextualNav({pageContextualNav:e,hasCreatePermission:b(".acs-nav").data("has-create-permission")}));b("body").append(b("<div>").addClass("page-tree-flyout-content hidden").append(f.clone()));return f})}else{return new b.Deferred().resolve(d.html())}}};function c(){return b.ajax({url:a+"/rest/ia/1.0/space/childPagesContextualNav",data:{pageId:AJS.Meta.get("page-id")}})}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-links.js' */
AJS.$(function(){Confluence.Sidebar.Configure={mode:false};var c=AJS.$,m=AJS.Meta.get("context-path"),k=AJS.Meta.get("space-key"),i=c(".acs-side-bar"),q=i.find(".ia-secondary-container"),d,o,j,l,g=c(".acs-nav");c.ajaxSetup({cache:false});c("body").on("click","#acs-configure-link, a.configure-sidebar",function(u){u.preventDefault();t()});c("#space-favourite-remove").on("click",function(){b("remove");c("#space-favourite-add").show();c("#space-favourite-remove").hide()});c("#space-favourite-add").on("click",function(){b("add");c("#space-favourite-remove").show();c("#space-favourite-add").hide()});function b(v){var w;var u;if(v==="add"){w="PUT";u="confluence.space-sidebar.favourite.click"}else{w="DELETE";u='confluence.space-sidebar.favourite-remove.click"'}c.ajax({url:m+"/rest/experimental/relation/user/current/favourite/toSpace/"+k,type:w,dataType:"json",contentType:"application/json",data:JSON.stringify({spaceKey:k})});AJS.trigger("analyticsEvent",{name:u})}function t(){AJS.trigger("sidebar-before-enter-configure-mode");var u=c(".custom-sidebar-content");var x=u.length;var A;var z;if(x){z=m+"/spaces/custompagecontent.action?key="+k;A=u.children().html()}l=g.data("nav-type");Confluence.Sidebar.Configure.mode=true;j=c(".acs-nav-sections .acs-nav-item.current-item").data("collector-key");d=Confluence.Sidebar.throbberDiv();d.height(c(".acs-nav-sections").height());q.hide();c(".acs-nav-sections").replaceWith(d);var w=Confluence.Templates.Sidebar.configure({pageTree:l==="page-tree",quickLinksState:g.data("quick-links-state"),hasSidebarCustomisation:x,customContentAdminLink:z,sidebarCustomisation:A});o=c(w).hide();d.after(o);h();f();r();var y={};var v=function(){d.replaceWith(o);o.show()};c("#acs-nav-list-main").one(AJS.RestfulTable.Events.INITIALIZED,function(){y.main=true;y.quick&&v()});c("#acs-nav-list-quick").one(AJS.RestfulTable.Events.INITIALIZED,function(){y.quick=true;y.main&&v()});c(".acs-nav-type").change(function(B){s("nav-type",c(this).val(),function(C){q.data("tree-type",C);g.data("nav-type",C)})});c(".acs-done-link").click(function(B){B.preventDefault();c(".acs-done-link").attr("aria-disabled",true).prop("disabled",true);n()});c(".quick-links-header a").click(function(C){C.preventDefault();var B=g.data("quick-links-state")=="hide"?"show":"hide";s("quick-links-state",B,a)});AJS.$(".acs-side-bar-space-info").on("click.configurelogo",p);AJS.trigger("sidebar.enter-configure-mode")}function p(w){var v=AJS.$(".acs-side-bar-space-info > .flyout-handle");v.addClass("loading").spin();var u=WRM.require("wr!com.atlassian.confluence.plugins.confluence-space-ia:avatar-picker",function(){AJS.trigger("deferred.spaceia.open.configure.space")});u.always(function(){v.removeClass("loading").spinStop()});w.preventDefault()}function s(u,v,w){c.ajax({url:m+"/rest/ia/1.0/space/option",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({spaceKey:k,option:u,value:v}),success:function(x){w(v)}})}function n(){if(l!==g.data("nav-type")){location.reload();return}var u=c(".custom-sidebar-content");var w=u.length;var y;if(w){y=u.children().html()}d=Confluence.Sidebar.throbberDiv();d.height(o.height());o.replaceWith(d);e();q.show().css("display","");var v=function(){var z=c(Confluence.Templates.Sidebar.renderLinks({mainLinks:x.main,quickLinks:x.quick.reverse(),advancedLinks:x.advanced,hasConfigurePermission:true,collectorToHighlight:j,quickLinksState:g.data("quick-links-state"),hasSidebarCustomisation:w,sidebarCustomisation:y}));d.replaceWith(z);Confluence.Sidebar.Configure.mode=false;AJS.trigger("sidebar.exit-configure-mode")};var x={};c.get(m+"/rest/ia/1.0/link/main",{spaceKey:k,includeHidden:false}).done(function(z){x.main=z;x.quick&&x.advanced&&v()});c.get(m+"/rest/ia/1.0/link/quick",{spaceKey:k}).done(function(z){x.quick=z;x.main&&x.advanced&&v()});c.get(m+"/rest/ia/1.0/link/advanced",{spaceKey:k}).done(function(z){x.advanced=z;x.main&&x.quick&&v()});Confluence.Sidebar.Configure.Logo&&Confluence.Sidebar.Configure.Logo.unbind()}function h(){WRM.require("wr!com.atlassian.confluence.plugins.confluence-space-ia:link-dialog",function(){var u=new c.Deferred();c(".acs-add-link").click(function(v){u.done(function(){v.preventDefault();if(g.data("quick-links-state")!=="hide"){Confluence.Sidebar.LinkAdapter.hijackLinkBrowser();Confluence.Editor.LinkBrowser.open();c("#recentlyviewed-panel-id").click()}})}).addClass("acs-add-link-ready");if(AJS.Meta.get("space-key")){AJS.Confluence.EditorLoader.load(function(){u.resolve()},function(){AJS.log("Attempted to load editor for space ia side bar. Loading the editor failed.");u.reject()})}else{u.resolve()}})}function f(){var u=c("#acs-nav-list-quick");var w=c(".acs-nav-sections .tip").hide();var v=function(){if(Confluence.Sidebar.Configure.QuickLinks.isEmpty()){u.hide();w.show()}else{w.hide();u.show()}};AJS.bindEvt(AJS.RestfulTable.Events.INITIALIZED,v);AJS.bindEvt(AJS.RestfulTable.Events.ROW_ADDED,v);AJS.bindEvt(AJS.RestfulTable.Events.ROW_REMOVED,v)}function r(){Confluence.Sidebar.Configure.MainLinks=new AJS.Confluence.ConfigurableNav({$el:c("#acs-nav-list-main"),resources:{all:m+"/rest/ia/1.0/link/main?spaceKey="+k+"&includeHidden=true",self:m+"/rest/ia/1.0/link"}});Confluence.Sidebar.Configure.QuickLinks=new AJS.Confluence.ConfigurableNav({$el:c("#acs-nav-list-quick"),resources:{all:m+"/rest/ia/1.0/link/quick?spaceKey="+k,self:m+"/rest/ia/1.0/link"},reverseOrder:true})}function e(){Confluence.Sidebar.Configure.MainLinks.remove();Confluence.Sidebar.Configure.MainLinks.unbind();Confluence.Sidebar.Configure.QuickLinks.remove();Confluence.Sidebar.Configure.QuickLinks.unbind();c(AJS).unbind(AJS.RestfulTable.Events.INITIALIZED);c(AJS).unbind(AJS.RestfulTable.Events.ROW_ADDED);c(AJS).unbind(AJS.RestfulTable.Events.ROW_REMOVED)}function a(u){g.data("quick-links-state",u);if(u==="hide"){c(".acs-nav-list-quick-section").addClass("hidden-section")}else{c(".acs-nav-list-quick-section").removeClass("hidden-section")}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-space-tools.js' */
define("confluence-space-ia/sidebar-space-tools",["ajs","jquery","confluence/legacy"],function(b,c,d){function a(){var e=[];var h=[];var k=b.version.indexOf("5.7")===0;var i;var l;var f,j;if(!k){f=c("#space-tools-menu-trigger");j=c("#space-tools-menu")}var g;if(k){c("#space-tools-web-items").children("div").each(function(){e.push({label:c(this).data("label"),href:c(this).data("href")})})}else{b.warn("Remove legacy sidebar code when upgrade to AUI 5.8+");j.on({"aui-dropdown2-show":function(){b.trigger("sidebar.disable-tooltip",f)},"aui-dropdown2-hide":function(){b.trigger("sidebar.enable-all-tooltips")}});c("#space-tools-web-items").children("div").each(function(){e.push({text:c(this).data("label"),href:c(this).data("href")})})}if(k){c("#space-tools-menu-additional-items").children("div").each(function(){h.push({className:c(this).data("class"),label:c(this).data("label"),href:c(this).data("href")})})}else{c("#space-tools-menu-additional-items").children("div").each(function(){h.push({extraClasses:c(this).data("class"),text:c(this).data("label"),href:c(this).data("href")})})}if(k){l={hideDelay:null,width:170,displayShadow:false,calculatePositions:function(m,n){var o=n.target.offset();return{popupCss:{top:o.top-m.height(),left:o.left},arrowCss:{display:"none"}}},hideCallback:function(){b.trigger("sidebar.enable-all-tooltips")}};i=b.InlineDialog(c("#space-tools-menu-trigger"),"space-tools",function(n,m,o){n.html(d.Templates.Sidebar.spaceToolsMenu({spaceToolLinks:e,spaceLinks:h,isAuiFiveSeven:k}));c(m).one("click",function(p){if(c("#inline-dialog-space-tools").is(":visible")){setTimeout(function(){i.hide()},0)}});b.trigger("sidebar.disable-tooltip",m);b.trigger("sidebar.spacetools-loaded");o();return false},l);i.addClass("aui-dropdown2 aui-style-default");b.bind("sidebar.hide-overlays",i.hide)}else{j.html(d.Templates.Sidebar.spaceToolsMenu({spaceToolLinks:e,spaceLinks:h}));if(b&&b.Confluence&&b.Confluence.Analytics&&b.Confluence.Analytics.setAnalyticsSource){b.Confluence.Analytics.setAnalyticsSource(j.find("a:not(.configure-sidebar)"),"spacetools")}b.bind("sidebar.hide-overlays",function(){if(j.filter('[aria-hidden="false"]').length){c("#space-tools-menu-trigger").trigger("aui-button-invoke")}})}g=c(".expand-collapse-trigger");g.click(function(m){m.preventDefault();d.Sidebar.toggle()});g.attr("data-tooltip",c(".ia-fixed-sidebar").hasClass("collapsed")?d.Sidebar.expandTooltip:d.Sidebar.collapseTooltip);b.bind("sidebar.collapsed",function(){g.attr("data-tooltip",d.Sidebar.expandTooltip)});b.bind("sidebar.expanded",function(){g.attr("data-tooltip",d.Sidebar.collapseTooltip)})}return a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-space-tools-require.js' */
require(["confluence-space-ia/sidebar-space-tools"],function(a){AJS.toInit(function(){a()})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-flyouts.js' */
(function(d){var b,c,a;Confluence.Sidebar.createFlyouts=function(g){b=f(d(".collapsed .quick-links-section"),Confluence.Sidebar.Pages.quickLinksContent,"sidebar-quick-links-flyout",{flyout:"quick-links"});var h=g.find(".ia-secondary-container");if(h.length&&h.attr("data-tree-type")=="pages"){c=f(d(".collapsed .ia-secondary-header-title.wiki"),Confluence.Sidebar.Pages.childPageCollapsedContent,"sidebar-children-flyout",{flyout:"children"})}if(h.length&&h.attr("data-tree-type")=="page-tree"){a=f(d(".collapsed .ia-secondary-header-title.page-tree"),Confluence.Sidebar.Pages.pageTreeCollapsedContent,"sidebar-page-tree-flyout",{flyout:"pagetree"})}};function f(g,j,i,l){var k=function(n,m,o){d(n).addClass("acs-side-bar-flyout ia-scrollable-section");d(n).empty().append(Confluence.Sidebar.throbberDiv());j().done(function(p){d(n).html(p)});AJS.trigger("sidebar.flyout-triggered",l);o();d(m).one("click",function(p){if(d("#inline-dialog-"+i).is(":visible")){setTimeout(function(){h.hide()},0)}});AJS.trigger("sidebar.disable-tooltip",m)};var h=AJS.InlineDialog(g,i,k,{gravity:"w",calculatePositions:e,useLiveEvents:true,hideDelay:null,hideCallback:function(){AJS.trigger("sidebar.enable-all-tooltips")}});AJS.bind("sidebar.hide-overlays",h.hide);return h}function e(h,k,p,g){var q=k.target.offset();var o=k.target.width();var l=k.target.height();var n={top:q.top+l/2-15,left:q.left+o+5,right:"auto"};var i=d(window);var m=20;n.maxHeight=i.height()+i.scrollTop()-n.top-m;if(d.browser.msie&&parseInt(d.browser.version,10)<=8){n.maxHeight-=40}var j={top:9};return{popupCss:n,arrowCss:j,gravity:"w"}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/external/jquery.mousewheel.min.js' */
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(a){function d(b){var c=b||window.event,d=[].slice.call(arguments,1),e=0,f=!0,g=0,h=0;return b=a.event.fix(c),b.type="mousewheel",c.wheelDelta&&(e=c.wheelDelta/120),c.detail&&(e=-c.detail/3),h=e,c.axis!==undefined&&c.axis===c.HORIZONTAL_AXIS&&(h=0,g=-1*e),c.wheelDeltaY!==undefined&&(h=c.wheelDeltaY/120),c.wheelDeltaX!==undefined&&(g=-1*c.wheelDeltaX/120),d.unshift(b,e,g,h),(a.event.dispatch||a.event.handle).apply(this,d)}var b=["DOMMouseScroll","mousewheel"];if(a.event.fixHooks)for(var c=b.length;c;)a.event.fixHooks[b[--c]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=b.length;a;)this.addEventListener(b[--a],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var a=b.length;a;)this.removeEventListener(b[--a],d,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacesidebar', location = 'js/sidebar-logo.js' */
AJS.toInit(function(f){Confluence.Sidebar.Configure.Logo={};var b=f(".acs-side-bar-space-info div.name a");var h;var a;var e=function(i){f(".space-logo .avatar-img").attr("src",AJS.Meta.get("context-path")+i)};var d=function(i){b.attr("title",i).text(i)};var g=function(i){if(!h){h=new i({onCrop:function(k,j){f.ajax({type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({spaceKey:AJS.Meta.get("space-key"),spaceName:j,logoDataURI:k}),url:AJS.Meta.get("context-path")+"/rest/ia/1.0/space/setLogo",success:function(l){e(l.logoDownloadPath);d(l.name);h.hide()},error:function(l){h.setMessage("An error occurred while updating space details");h._removeSaveImageLoadingIcon()}})}})}h.show(f(".acs-side-bar-space-info div.name a").text());return false};var c=function(){var i=function(l,k,m){f(l).addClass("acs-side-bar-flyout");f(l).empty();l.html(AJS.template.load("logo-config-content"));l.unbind("mouseover mouseout");AJS.trigger("sidebar.disable-tooltip",k);m()};if(!a){a=AJS.InlineDialog(f(".acs-side-bar-space-info"),"space-logo-config",i,{gravity:"w",calculatePositions:j,useLiveEvents:true,hideCallback:function(){AJS.trigger("sidebar.enable-all-tooltips")},hideDelay:null,noBind:true,width:635})}function j(l,n,r,k){var s=n.target.offset();var q=n.target.width();var o=n.target.height();var p={top:s.top+o/2-15,left:s.left+q+5,right:"auto"};var m={top:9};return{popupCss:p,arrowCss:m,gravity:"w"}}a.show()};AJS.bind("sidebar-before-enter-configure-mode",function(){AJS.bind("deferred.spaceia.open.configure.space",function(i){if(AJS.Meta.get("space-key")=="~"+AJS.Meta.get("remote-user")){c()}else{require(["confluence-space-ia/avatar-picker/avatar-picker-dialog",],g)}i.preventDefault();return false})});Confluence.Sidebar.Configure.Logo.unbind=function(){f("#inline-dialog-space-logo-config .cancel").click();f(".acs-side-bar-space-info").off("click.configurelogo");AJS.unbind("deferred.spaceia.open.configure.space")}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:sidebar-relevant', location = 'soy/sidebar-relevant.soy' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:sidebar-relevant', location = 'js/relevant/content-heuristics.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:sidebar-relevant', location = 'js/relevant/content-parser.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:sidebar-relevant', location = 'js/relevant/content-structure.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:sidebar-relevant', location = 'js/relevant/content-tracker.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:sidebar-relevant', location = 'js/relevant/page-mode-view.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:sidebar-relevant', location = 'js/relevant/keyboard-mode-view.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:sidebar-relevant', location = 'js/relevant/controller.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.share-page:mail-page-resources', location = 'templates/sharepage/share-dialog.soy' */
// This file was automatically generated from share-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Share.Dialog.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Share == 'undefined') { Confluence.Templates.Share = {}; }
if (typeof Confluence.Templates.Share.Dialog == 'undefined') { Confluence.Templates.Share.Dialog = {}; }


Confluence.Templates.Share.Dialog.shareContentPopup = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui share-content-popup"><div class="field-group"><div class="autocomplete-user-target"><input class="text autocomplete-sharepage" id="users" data-max="10" data-dropdown-target=".autocomplete-user-target" data-none-message="' + soy.$$escapeHtml("No matches") + '" placeholder="' + soy.$$escapeHtml("User name, group or email") + '"/></div><ol class="recipients"></ol></div><div class="field-group"><textarea class="textarea" id="note" placeholder="' + soy.$$escapeHtml("Add an optional note") + '"/></div><div class="field-group button-panel"><div class="progress-messages-icon"></div><div class="progress-messages"></div><input class="button submit" type="submit" value="' + soy.$$escapeHtml("Share") + '" disabled/><a class="close-dialog" href="#">' + soy.$$escapeHtml("Cancel") + '</a></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.Share.Dialog.shareContentPopup.soyTemplateName = 'Confluence.Templates.Share.Dialog.shareContentPopup';
}


Confluence.Templates.Share.Dialog.recipientUser = function(opt_data, opt_ignored) {
  return '<li data-userkey="' + soy.$$escapeHtml(opt_data.userKey) + '" style="display: none" class="recipient-user"><img src="' + soy.$$escapeHtml(opt_data.thumbnailLink.href) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"/><span class="title" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.title) + '</span><span class="remove-recipient"/></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Share.Dialog.recipientUser.soyTemplateName = 'Confluence.Templates.Share.Dialog.recipientUser';
}


Confluence.Templates.Share.Dialog.recipientEmail = function(opt_data, opt_ignored) {
  return '<li data-email="' + soy.$$escapeHtml(opt_data.email) + '" style="display: none" class="recipient-email"><img src="' + soy.$$escapeHtml(opt_data.icon) + '" title="' + soy.$$escapeHtml(opt_data.email) + '"/><span class="title" title="' + soy.$$escapeHtml(opt_data.email) + '">' + soy.$$escapeHtml(opt_data.email) + '</span><span class="remove-recipient"/></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Share.Dialog.recipientEmail.soyTemplateName = 'Confluence.Templates.Share.Dialog.recipientEmail';
}


Confluence.Templates.Share.Dialog.recipientGroup = function(opt_data, opt_ignored) {
  return '<li data-group="' + soy.$$escapeHtml(opt_data.title) + '" style="display: none" class="recipient-group"><span><img src="' + soy.$$escapeHtml(opt_data.thumbnailLink.href) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"/><span>' + soy.$$escapeHtml(opt_data.title) + '</span><span class="remove-recipient"/></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Share.Dialog.recipientGroup.soyTemplateName = 'Confluence.Templates.Share.Dialog.recipientGroup';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.share-page:mail-page-resources', location = 'js/mailpage.js' */
AJS.Confluence.SharePage={};AJS.Confluence.SharePage.autocompleteUser=function(d){d=d||document.body;var e=AJS.$,a=/^([a-zA-Z0-9_\.\-\+\!#\$%&'\*/=\?\^_`{|}~])+\@.*/;var c=function(j){if(!j||!j.result){throw new Error("Invalid JSON format")}var f=[];for(var g=0;g<j.result.length;g++){var h=j.result[g];if(h.type=="group"){h=b(h)}}f.push(j.result);return f};function b(f){if(f.name=="confluence-users"||f.name=="confluence-administrators"){return f}f.title=f.name;f.group=f.name;f.thumbnailLink={href:Confluence.getContextPath()+"/download/resources/com.atlassian.confluence.plugins.share-page:mail-page-resources/images/group.png",type:"image/png",rel:"thumbnail"};f.link=[{href:Confluence.getContextPath(),rel:"self"}];return f}e("input.autocomplete-sharepage[data-autocomplete-user-bound!=true]",d).each(function(){var h=e(this).attr("data-autocomplete-sharepage-bound","true").attr("autocomplete","off");var g=h.attr("data-max")||10,j=h.attr("data-alignment")||"left",i=h.attr("data-dropdown-target"),f=null;if(i){f=e(i)}else{f=e("<div></div>");h.after(f)}f.addClass("aui-dd-parent autocomplete");h.quicksearch(AJS.REST.getBaseUrl()+"search/user-or-group.json",function(){h.trigger("open.autocomplete-sharepage")},{makeParams:function(k){return{"max-results":g,query:k.replace("{|}","")}},dropdownPlacement:function(k){f.append(k)},makeRestMatrixFromData:c,addDropdownData:function(l){var k=e.trim(h.val());if(a.test(k)){l.push([{name:k,email:k,href:"#",icon:Confluence.getContextPath()+"/download/resources/com.atlassian.confluence.plugins.share-page:mail-page-resources/images/envelope.png"}])}if(!l.length){var m=h.attr("data-none-message");if(m){l.push([{name:m,className:"no-results",href:"#"}])}}return l},ajsDropDownOptions:{alignment:j,displayHandler:function(k){if(k.restObj&&k.restObj.username){return k.name+" ("+k.restObj.username+")"}return k.name},selectionHandler:function(m,l){if(l.find(".search-for").length){h.trigger("selected.autocomplete-sharepage",{searchFor:h.val()});return}if(l.find(".no-results").length){this.hide();m.preventDefault();return}var k=e("span:eq(0)",l).data("properties");if(!k.email){k=k.restObj}h.trigger("selected.autocomplete-sharepage",{content:k});this.hide();m.preventDefault()}}})})};(function(a){jQuery.fn.extend({elastic:function(){var b=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each(function(){if(this.type!=="textarea"){return false}var g=jQuery(this),c=jQuery("<div />").css({position:"absolute",display:"none","word-wrap":"break-word","white-space":"pre-wrap"}),j=parseInt(g.css("line-height"),10)||parseInt(g.css("font-size"),"10"),l=parseInt(g.css("height"),10)||j*3,k=parseInt(g.css("max-height"),10)||Number.MAX_VALUE,d=0;if(k<0){k=Number.MAX_VALUE}c.appendTo(g.parent());var f=b.length;while(f--){c.css(b[f].toString(),g.css(b[f].toString()))}function h(){var i=Math.floor(parseInt(g.width(),10));if(c.width()!==i){c.css({width:i+"px"});e(true)}}function m(i,o){var n=Math.floor(parseInt(i,10));if(g.height()!==n){g.css({height:n+"px",overflow:o})}}function e(p){var o=g.val().replace(/&/g,"&amp;").replace(/ {2}/g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />");var i=c.html().replace(/<br>/ig,"<br />");if(p||o+"&nbsp;"!==i){c.html(o+"&nbsp;");if(Math.abs(c.height()+j-g.height())>3){var n=c.height()+j;if(n>=k){m(k,"auto")}else{if(n<=l){m(l,"hidden")}else{m(n,"hidden")}}}}}g.css({overflow:"hidden"});g.bind("keyup change cut paste",function(){e()});a(window).bind("resize",h);g.bind("resize",h);g.bind("update",e);g.bind("input paste",function(i){setTimeout(e,250)});e()})}})})(AJS.$);(function(f){var e,c={hideCallback:a,width:250,hideDelay:3600000,calculatePositions:function(h,o,w,s){var p;var y;var u;var l=-7;var m;var q;var x=o.target.offset();var g=o.target.outerWidth();var j=x.left+g/2;var t=(window.pageYOffset||document.documentElement.scrollTop)+f(window).height();var k=10;u=x.top+o.target.outerHeight()+s.offsetY;p=x.left+s.offsetX;var n=x.top>h.height();var i=(u+h.height())<t;q=(!i&&n)||(s.onTop&&n);var r=f(window).width()-(p+s.width+k);if(q){u=x.top-h.height()-8;var v=s.displayShadow?(AJS.$.browser.msie?10:9):0;l=h.height()-v}m=j-p+s.arrowOffsetX;if(s.isRelativeToMouse){if(r<0){y=k;p="auto";m=w.x-(f(window).width()-s.width)}else{p=w.x-20;y="auto";m=w.x-p}}else{if(r<0){y=k;p="auto";m=j-(f(window).width()-h.outerWidth())}else{if(s.width<=g/2){m=s.width/2;p=j-s.width/2}}}return{displayAbove:q,popupCss:{left:p,right:y,top:u},arrowCss:{position:"absolute",left:m,right:"auto",top:l}}}};var a=function(){f(".dashboard-actions .explanation").hide()};var d=function(j,h,i){if(j.find("input").length){i();return}j.append(Confluence.Templates.Share.Dialog.shareContentPopup());AJS.Confluence.SharePage.autocompleteUser();var k=function(m){AJS.Confluence.SharePage.current.hide();if(m){setTimeout(function(){j.empty()},300)}return false};f(document).keyup(function(m){if(m.keyCode==27){k(true);f(document).unbind("keyup",arguments.callee);return false}return true});j.find(".close-dialog").click(function(){k(true)});j.find("#note").elastic();j.find("form").submit(function(){var r=[];j.find(".recipients li").each(function(s,t){r.push(f(t).attr("data-userKey"))});if(r.length<=0){return false}f("button,input,textarea",this).attr("disabled","disabled");j.find(".progress-messages-icon").removeClass("error");j.find(".progress-messages").text("Sending");j.find(".progress-messages").attr("title","Sending");var o=Raphael.spinner(j.find(".progress-messages-icon")[0],7,"#666");j.find(".progress-messages-icon").css("position","absolute").css("left","0").css("margin-top","3px");j.find(".progress-messages").css("padding-left",j.find(".progress-messages-icon").innerWidth()+20);var r=[];j.find(".recipients li[data-userKey]").each(function(s,t){r.push(f(t).attr("data-userKey"))});var q=[];j.find(".recipients li[data-email]").each(function(s,t){q.push(f(t).attr("data-email"))});var m=[];j.find(".recipients li[data-group]").each(function(s,t){m.push(f(t).attr("data-group"))});var n=j.find("#note");var p={users:r,emails:q,groups:m,note:n.hasClass("placeholded")?"":n.val(),entityId:AJS.params.pageId};f.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:Confluence.getContextPath()+"/rest/share-page/latest/share",data:JSON.stringify(p),dataType:"text",success:function(){setTimeout(function(){o();j.find(".progress-messages-icon").addClass("done");j.find(".progress-messages").text("Sent");j.find(".progress-messages").attr("title","Sent");setTimeout(function(){j.find(".progress-messages").text("");j.find(".progress-messages-icon").removeClass("done");j.find("#note").val("");f("button,input,textarea",j).removeAttr("disabled");k(false)},1000)},500)},error:function(t,s){o();j.find(".progress-messages-icon").addClass("error");j.find(".progress-messages").text("Error sending");j.find(".progress-messages").attr("title","Error sending"+": "+s);f("button,input,textarea",j).removeAttr("disabled")}});return false});var l=j.find("#users");var g=j.find("input.submit");l.bind("selected.autocomplete-sharepage",function(n,m){var o=function(r,q,s){var u=j.find(".recipients"),t,p;t="li[data-"+r+'="'+s.content[r]+'"]';if(u.find(t).length>0){u.find(t).hide()}else{u.append(q(s.content))}p=u.find(t);p.find(".remove-recipient").click(function(){p.remove();if(u.find("li").length==0){g.attr("disabled","true")}AJS.Confluence.SharePage.current.refresh();l.focus();return false});p.fadeIn(200)};if(m.content.email){o("email",Confluence.Templates.Share.Dialog.recipientEmail,m)}else{if(m.content.type=="group"){o("group",Confluence.Templates.Share.Dialog.recipientGroup,m)}else{o("userKey",Confluence.Templates.Share.Dialog.recipientUser,m)}}AJS.Confluence.SharePage.current.refresh();g.removeAttr("disabled");l.val("");l.focus();return false});l.bind("open.autocomplete-sharepage",function(n,m){if(f("a:not(.no-results)",AJS.dropDown.current.links).length>0){AJS.dropDown.current.moveDown()}});l.keypress(function(m){return m.keyCode!=13});f(document).bind("showLayer",function(o,n,m){if(n=="inlineDialog"&&m.popup==AJS.Confluence.SharePage.current){m.popup.find("#users").focus()}});f(h).parents().filter(function(){return this.scrollTop>0}).scrollTop(0);i()};var b=function(g){var h=f("#splitter-content");if(h.length!==0){g.container=h;g.offsetY=AJS.InlineDialog.opts.offsetY-h.offset().top}return g};AJS.Confluence.SharePage.initDialog=function(g,i,h){if(g.length){var j=f.extend(false,b(c),h);AJS.Confluence.SharePage.current=AJS.InlineDialog(g,i,d,j)}};AJS.toInit(function(g){AJS.Confluence.SharePage.initDialog(g("#shareContentLink"),"shareContentPopup")})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.editor.confluence-source-editor:atlassian-source-editor-view-storage-javascript', location = 'jscripts/source-editor/view-source.js' */
AJS.toInit(function(a){if(a("#action-view-storage-link").length){a("#action-source-editor-view-storage-link").closest("li").hide()}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:querystring', location = '/includes/js/api/querystring.js' */
define("confluence/api/querystring",[],function(){return{stringify:function(a){var b="",c;for(c in a)for(var d=0;d<a[c].length;d++)b+="&"+c,a[c][d]&&(b+="="+a[c][d]);return b.substring(1)},parse:function(a){var b={};if(a){"?"===a.substr(0,1)&&(a=a.substr(1));for(var a=a.split("&"),c=0;c<a.length;c++){var d=a[c].split("=");b[d[0]]||(b[d[0]]=[]);b[d[0]].push(a[c].substring(d[0].length+1))}}return b}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:url', location = '/includes/js/api/url.js' */
define("confluence/api/url",["confluence/api/querystring","jquery"],function(d,e){var g=/([^\?|#]+)[\?]?([^#]*)[#]?(.*)/,f=["source","urlPath","queryParams","anchor"];return{parse:function(a){var b={};if(a=g.exec(a)){for(var c=0;c<f.length;c++)b[f[c]]=a[c];b.queryParams=d.parse(b.queryParams)}return b},format:function(a){return e.isEmptyObject(a)?"":(!a.urlPath?"":a.urlPath)+(e.isEmptyObject(a.queryParams)?"":"?"+d.stringify(a.queryParams))+(!a.anchor?"":"#"+a.anchor)}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:analytics-support', location = '/includes/js/analytics-support.js' */
define("confluence/analytics-support","jquery ajs confluence/meta window document confluence/api/url".split(" "),function(j,o,n,k,l,h){var b={},m;b.setAnalyticsSource=function(a,d){if(typeof m==="undefined"){var c=j._data(k,"events");m=c&&c.analytics&&c.analytics.length>0}m&&a.attr("href",function(a,c){var b=encodeURIComponent(d),g=h.parse(c);if(!j.isEmptyObject(g))g.queryParams.src=[b];return h.format(g)})};b.srcRemovedUrl=function(a){a=h.parse(a);delete a.queryParams.src;for(var d=Object.keys(a.queryParams),
c=0;c<d.length;c++){var b=d[c],f=b.split(".");f.length===3&&f[0]==="src"&&delete a.queryParams[b];b==="jwt"&&delete a.queryParams[b]}return h.format(a)};b.srcParamValues=function(a){return(a=h.parse(a).queryParams)&&a.src?a.src:[]};b.srcAttrParamValues=function(a){for(var a=h.parse(a).queryParams,b={},c=Object.keys(a),e=0;e<c.length;e++){var f=c[e],i=f.split(".");if(i.length===3&&i[0]==="src"){var g=i[1],i=i[2];b[g]=b[g]||{};b[g][i]=decodeURIComponent(a[f][0])}}return b};b.extractAnalyticsData=function(a){for(var d=
[],c=b.srcParamValues(a),a=b.srcAttrParamValues(a),e=0;e<c.length;e++){var f=c[e];d.push({src:f,attr:a[f]||{}})}return d};b.publish=function(a,b){o.trigger("analytics",{name:a,data:b||{}})};b.init=function(){var a=b.extractAnalyticsData(l.URL),d={userKey:n.get("remote-user-key"),pageID:n.get("page-id")};if(a.length>0){for(var c=0;c<a.length;c++){var e=a[c],f=j.extend({},d,e.attr);b.publish("confluence.viewpage.src."+e.src,f)}if(k.history&&k.history.replaceState){a=b.srcRemovedUrl(l.URL);l.URL!==a&&
k.history.replaceState(null,"",a)}}else b.publish("confluence.viewpage.src.empty",d)};return b});require("confluence/module-exporter").exportModuleAsGlobal("confluence/analytics-support","AJS.Confluence.Analytics",function(j){require("ajs").toInit(j.init)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:page-analytics', location = '/includes/js/page.js' */
define("confluence/page",["ajs","jquery","confluence/analytics-support","window","document"],function(b,c,e,f,g){var j=b.Meta.get("page-id"),d=function(a,b){e.publish("confluence.page."+a,c.extend({pageID:j},b||{}))},i=function(a){setTimeout(function(){d("reading");i(a)},a)},k=(new Date).getTime();return function(){var a=c("#main-content");d("view");a.on("click","a",function(a){a=-1<a.currentTarget.href.indexOf(f.location.host)?"internal":"external";d("link.click",{linkType:a})});var h=c(f),e=(new Date).getTime();
h.on("scroll.content",b.debounce(function(){var b=g.body.scrollTop+g.body.offsetHeight,c=a.offset().top+a.height();b>c&&(d("scroll-to-bottom",{secondsSinceReadyEvent:((new Date).getTime()-e)/1E3,secondsSincePageLoad:((new Date).getTime()-k)/1E3}),h.off("scroll.content"))},200));i(3E5)}});require("confluence/module-exporter").safeRequire("confluence/page",function(b){require("ajs").toInit(b)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:bundled', location = 'templates/com/comalatech/workflow/common/js/cml.js' */
var CML=CML||{VERSION:"0.2",allVersions:function(){if(console.group){console.group("Confluence versions")}console.log("Confluence:",AJS.params.versionNumber);console.log("AJS:",AJS.version);console.log("jQuery:",jQuery.fn.jquery);console.log("jQuery UI:",jQuery.ui.version);console.log("Backbone:",Backbone.VERSION);console.log("Underscore:",_.VERSION);if(console.group){console.groupEnd();console.group("Comalatech versions")}console.log("CML:",this.VERSION);console.log("AWP:",AWP.VERSION);if(console.group){console.groupEnd()}},getUrlParameters:function(){var b={};var a=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(c,d,e){b[d]=e});return b}};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c){if(this==null){throw new TypeError()}var d=Object(this);var a=d.length>>>0;if(a===0){return -1}var e=0;if(arguments.length>1){e=Number(arguments[1]);if(e!=e){e=0}else{if(e!=0&&e!=Infinity&&e!=-Infinity){e=(e>0||-1)*Math.floor(Math.abs(e))}}}if(e>=a){return -1}var b=e>=0?e:Math.max(a-Math.abs(e),0);for(;b<a;b++){if(b in d&&d[b]===c){return b}}return -1}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:bundled', location = 'templates/com/comalatech/workflow/embedded/soy/embeddedtemplates.soy' */
// This file was automatically generated from embeddedtemplates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace AWP.Templates.
 */

if (typeof AWP == 'undefined') { var AWP = {}; }
if (typeof AWP.Templates == 'undefined') { AWP.Templates = {}; }


AWP.Templates.iframe = function(opt_data, opt_ignored) {
  return '<iframe frameborder=\'0\' width=\'100%\' height=\'350\' class=\'adhoworkflows\'src="' + soy.$$escapeHtml(opt_data.contextPath) + '/plugins/servlet/adhocworkflows/' + soy.$$escapeHtml(opt_data.action) + '/' + soy.$$escapeHtml(opt_data.pageId) + '"/>';
};
if (goog.DEBUG) {
  AWP.Templates.iframe.soyTemplateName = 'AWP.Templates.iframe';
}


AWP.Templates.iframeSmall = function(opt_data, opt_ignored) {
  return '<iframe frameborder=\'0\' width=\'100%\' height=\'220\' class=\'adhoworkflows\'src="' + soy.$$escapeHtml(opt_data.contextPath) + '/plugins/servlet/adhocworkflows/workflow/' + soy.$$escapeHtml(opt_data.pageId) + '"/>';
};
if (goog.DEBUG) {
  AWP.Templates.iframeSmall.soyTemplateName = 'AWP.Templates.iframeSmall';
}


AWP.Templates.pageState = function(opt_data, opt_ignored) {
  return '<span class="adhocworkflows-state cw-tracker ' + soy.$$escapeHtml(opt_data.finalClass) + '" ' + ((opt_data.hover != opt_data.stateName) ? 'title="' + soy.$$escapeHtml(opt_data.hover) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.stateName) + '</span>';
};
if (goog.DEBUG) {
  AWP.Templates.pageState.soyTemplateName = 'AWP.Templates.pageState';
}


AWP.Templates.versionInfo = function(opt_data, opt_ignored) {
  return '(' + soy.$$escapeHtml("view:") + '&nbsp;<a id="view-change-link" href="' + soy.$$escapeHtml(opt_data.changeUrl) + '">' + soy.$$escapeHtml("change") + '</a> &middot;&nbsp;<a id="awp-alternate-view" href="' + soy.$$escapeHtml(opt_data.contextPath) + soy.$$escapeHtml(opt_data.pageStatus.alternateViewUrl) + '">' + soy.$$escapeHtml(opt_data.pageStatus.alternateViewStateName) + '</a>)';
};
if (goog.DEBUG) {
  AWP.Templates.versionInfo.soyTemplateName = 'AWP.Templates.versionInfo';
}


AWP.Templates.altLinkNoVersion = function(opt_data, opt_ignored) {
  return '<span class="noprint">(<a id="awp-alternate-view" href="' + soy.$$escapeHtml(opt_data.contextPath) + soy.$$escapeHtml(opt_data.pageStatus.alternateViewUrl) + '">' + soy.$$escapeHtml(opt_data.pageStatus.alternateViewStateName) + '</a>)</span>';
};
if (goog.DEBUG) {
  AWP.Templates.altLinkNoVersion.soyTemplateName = 'AWP.Templates.altLinkNoVersion';
}


AWP.Templates.badge = function(opt_data, opt_ignored) {
  return '<sub class="awp-badge ' + ((opt_data.message == '0') ? 'awp-badge-0' : '') + ' badge aui-lozenge">' + ((opt_data.message == '0') ? '!' : soy.$$escapeHtml(opt_data.message)) + '</sub>';
};
if (goog.DEBUG) {
  AWP.Templates.badge.soyTemplateName = 'AWP.Templates.badge';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:bundled', location = 'templates/com/comalatech/workflow/common/js/analytics.js' */
var AWP=AWP||{};var _gaq=_gaq||[];AWP.Analytics=(function(g){var f="1.2";var d="";var a=false;var c="AWP";var h=function(l){if(l){d=l;_gaq.push([c+"._setAccount",l]);_gaq.push([c+"._setDomainName","none"]);_gaq.push([c+"._setDetectTitle",false]);var k=document.createElement("script");k.type="text/javascript";k.async=true;k.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var j=document.getElementsByTagName("script")[0];j.parentNode.insertBefore(k,j);e("initiated with key "+l)}else{e("UA Key not found")}};var b=function(j){if(d){if(j){_gaq.push([c+"._trackPageview",j])}else{_gaq.push([c+"._trackPageview"])}e("trackPage")}};var i=function(l,m,j){if(d){if(arguments.length===3){_gaq.push([c+"._trackEvent",l,m,j])}else{_gaq.push([c+"._trackEvent",l,m])}var k=[l,m,j];e("trackEvent: "+k.join(","))}};var e=function(j){if(a){g.log("["+c+".Analytics] "+j)}};return{init:h,trackPage:b,trackEvent:i,VERSION:f,debug:a}})(AJS);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:bundled', location = 'templates/com/comalatech/workflow/embedded/js/workflow.js' */
var AWP=AWP||{};AWP.Embedded=AWP.Embedded||{};AWP.Embedded.Workflow=(function(i,f){var e="workflow",g=null,k="",a="",b="",c=null,h="",d=false;setState=function(t){var q=f("#"+k);var r="#title-text";var u="#workflow-page-message";q.css("display","block");if(t.stateName&&t.stateName!==""&&!t.hideStates){var o="";if(t.finalState){o="final"}else{if(t.hasFinalState){o="notfinal"}}f("#title-heading .adhocworkflows-state, .rw_page_title .adhocworkflows-state").remove();if(f(".rw_page_title").length>0){r=".rw_page_title"}if(t.updatePageStatus){var p=i.$("#content .status-macro:first");if(p.length>0){p.removeClass("aui-lozenge-complete aui-lozenge-success aui-lozenge-current");p.html(t.stateName);if(t.finalState){p.addClass("aui-lozenge-success")}else{if(t.hasFinalState){p.addClass("aui-lozenge-current")}else{p.addClass("aui-lozenge-complete")}}}}}setMessages(t.messages);if(t.hasFinalState){if(t.alternateViewUrl){var m=f("#view-change-link");if(m.length>0){var l=m.attr("href");var s=m.parents("span");s.html(AWP.Templates.versionInfo({changeUrl:l,contextPath:i.Confluence.getContextPath(),pageStatus:t,pageId:i.params.pageId}))}else{var n=f("li.page-metadata-modification-info");if(n.length>0){if(f("#awp-alternate-view").length>0){f("#awp-alternate-view").parent().remove()}n.append(AWP.Templates.altLinkNoVersion({contextPath:i.Confluence.getContextPath(),pageStatus:t}))}}}else{}}else{}f(".awp-badge").remove();if(t.actionable||t.activeTasks>0){$parent=q.parent();$div=i.$("<div></div>",{id:"awp-menu-icon"});q.appendTo($div);$div.append(AWP.Templates.badge({message:t.activeTasks}));$parent.prepend($div);if(i.$("#inline-dialog-adhocWorkflowsDialogPopup").is(":visible")){f(".awp-badge").hide()}}if(!t.hideStates){f("#addAdhocWorkflow").css("display","none");f("#addApprovalWorkflow").css("display","none")}f("#editPageWorkflowLink").css("display","block");if(f("#workflow_page_not_permitted").length){f(".page-metadata").hide()}};setMessages=function(p){var o="#workflow-page-message";if(p){if(!jQuery.isArray(p)){p=[p]}if(p.length>0){var n=f(o);if(n.length===0){pageMessageContainer=f("<div></div>",{id:"workflow-page-message"})}else{n.html("")}for(var l=0;l<p.length;l++){var m=p[l];p={title:m.title?m.title:undefined,closeable:true,body:m.renderedMessage};switch(m.type){case"ERROR":i.messages.error(o,p);break;case"SUCCESS":i.messages.success(o,p);break;case"INFO":i.messages.info(o,p);break;case"HINT":i.messages.hint(o,p);break;case"WARNING":i.messages.warning(o,p);break;default:i.messages.generic(o,p)}}i.$(o).show();i.$(".cw-top-iframe").hide()}}};updateBadge=function(m){var l=f(".awp-badge").html();if(m!=l){if(m=="0"){f(".awp-badge").addClass("awp-badge-0");m="!"}else{f(".awp-badge").removeClass("awp-badge-0")}f(".awp-badge").html(m)}};generatePopup=function(o,m,n){var l=f(m);f(".awp-badge").hide();var p=f("<div></div>").attr({"class":"awp-loading"}).html("loading");o.height("350px").html(p).append(AWP.Templates.iframe({pageId:i.params.pageId,contextPath:i.Confluence.getContextPath(),action:e}));n()};generateFeedbackPopup=function(l){if(l){var m="#"+l;$popup=f(m);$popup.addClass("awp-"+l);$popup.html(AWP.Templates.feedback({}));f("<iframe></iframe>").attr({src:"http://comalatech.wufoo.com/embed/m7x1p5/",height:"365",allowtransparency:"true",frameborder:"0",scrolling:"no"}).appendTo(m+" .awp-content");f(m+" .awp-btn-close").bind("click",hideFeedbackDialog)}};getModalDialogId=function(){return h};getDialogId=function(){return k};isModalDialogOpen=function(){return d};setModalDialogOpen=function(l){d=l};showModalDlg=function(){setModalDialogOpen(true);c.show()};hideDialog=function(){g.hide()};hideModalDialog=function(){setModalDialogOpen(false);c.hide()};setAction=function(l){e=l};getTask=function(){return b};setTask=function(l){b=l};setApproval=function(l){a=l};getApproval=function(){return a};queryString=function(){var o={};var n=window.location.search.substring(1);var p=n.split("&");for(var m=0;m<p.length;m++){var q=p[m].split("=");if(typeof o[q[0]]==="undefined"){o[q[0]]=q[1]}else{if(typeof o[q[0]]==="string"){var l=[o[q[0]],q[1]];o[q[0]]=l}else{o[q[0]].push(q[1])}}}return o};init=function(m,l){i.log("[AWP] init embedded.workflow");k=m;h=l;var n="#"+k;f("#rte-button-adhoctasks").click(function(){AWP.Embedded.Workflow.setAction("addtask")});g=i.InlineDialog(f(n+",#rte-button-adhoctasks"),"adhocWorkflowsDialogPopup",generatePopup,{width:420,offsetY:17,hideDelay:null,hideCallback:function(){f(".awp-badge").show("fast")},initCallback:function(){setModalDialogOpen(false)}});c=new i.Dialog({width:350,height:220,id:h,closeOnOutsideClick:true});if(i.params.buildNumber<5700){f(n).parents("li").appendTo(f("#navigation ul.ajs-menu-bar"))}if(f("#rw_page_toolbar").length>0){f(n).find("span").html("").end().addClass("rw_icon_button").removeClass("aui-button").prependTo(f("#rw_page_toolbar"))}else{if(f(".rw_custom_section").length>0){f(n+" span").html("");f(n).addClass("rw_icon_button").prependTo(f("#rw_page_right .rw_custom_section"))}}};var j=function(){var l="rte-button-adhoctasks";f("#"+l).click(function(){AWP.Embedded.Workflow.setAction("addtask")});g=i.InlineDialog(f("#"+l),"adhocWorkflowsDialogPopup",generatePopup,{width:420,offsetY:17,hideDelay:null,hideCallback:function(){f(".awp-badge").show("fast")},initCallback:function(){setModalDialogOpen(false)}})};i.toInit(function(l){init("adhocWorkflowsPopupLink","addWorkflowDialog");AWP.params=queryString();if(AWP.params.task||AWP.params.approval){i.Confluence.EditorLoader.load(function(){if(AWP.params.task){setTask(AWP.params.task);l("#"+getDialogId()).click()}else{if(AWP.params.approval){setApproval(AWP.params.approval);l("#"+getDialogId()).click()}}})}var m=i.params;if(m.workflowStatsUAKey){AWP.Analytics.init(m.workflowStatsUAKey);if(m.workflowStatsLicenseType||m.workflowStatsLicenseSize){AWP.Analytics.trackEvent("Space Workflows Usage - "+m.workflowStatsLicenseType,m.workflowStatsLicenseSize,m.workflowStatsSpaceUsage)}}l(document).delegate(".awp-badge","click",g.show);l(document).delegate("#editPageLink","click",j)});return{setState:setState,setMessages:setMessages,setAction:setAction,updateBadge:updateBadge,dialog:g,getDialogId:getDialogId,hideDialog:hideDialog,modalDialog:c,getModalDialogId:getModalDialogId,isModalDialogOpen:isModalDialogOpen,setModalDialogOpen:setModalDialogOpen,showModalDlg:showModalDlg,hideModalDialog:hideModalDialog,setTask:setTask,getTask:getTask,setApproval:setApproval,getApproval:getApproval}})(AJS,AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:bundled', location = 'templates/com/comalatech/workflow/embedded/js/events.js' */
var AWP=AWP||{};AWP.Embedded=AWP.Embedded||{};AWP.Embedded.Events=new function(a){this.refreshState=function(b,c){AWP.Embedded.Workflow.setState(c)};this.refreshMsg=function(c,b){AWP.Embedded.Workflow.setMessages(b)};this.closeWorkflowDialog=function(){AWP.Embedded.Workflow.hideDialog();AWP.Embedded.Workflow.hideModalDialog()};this.addWorkflow=function(c){c.preventDefault();var d=AWP.Embedded.Workflow;d.showModalDlg();var b=a("#"+d.getModalDialogId());b.html("").append(AWP.Templates.iframeSmall({pageId:AJS.params.pageId,contextPath:AJS.Confluence.getContextPath()}));return false};this.addTask=function(b){b.preventDefault();var c=AWP.Embedded.Workflow;c.setAction("addtask");a("#"+c.getDialogId()).click()};this.addApprovalWorkflow=function(b){b.preventDefault();AWP.Embedded.Workflow.setAction("addapproval");a("#"+AWP.Embedded.Workflow.getDialogId()).click()};a(document).delegate("iframe.adhoworkflows","awp.refresh",this.refreshState);a(document).delegate("iframe.adhoworkflows","awp.refreshMsg",this.refreshMsg);a(document).delegate("iframe.adhoworkflows","awp.close",this.closeWorkflowDialog);a(document).delegate("#addApprovalWorkflow","click",this.addApprovalWorkflow)}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:bundled', location = 'templates/com/comalatech/workflow/common/js/view/progresstracker.js' */
var AWP=AWP||{};AWP.ProgressTracker=(function(b,g,a){var f=5,h=false,e="",d="awp-progress-tracker",c=AWP.Templates.progresstracker;initialize=function(){filterStates();if(!a){a=""}};checkStates=function(){var l=false;if(arguments.length>0){g=arguments[0]}var k=b.indexOf(g);if(k>=0){l=true}return l};filterStates=function(){var k=b.length;this.hintHiddenStates="";if(k>f){var n=k-f;var l=0,m=false;while(l<k&&!m){if(b[l]==g){m=true}l++}l--;if(l==0){for(j=0;j<f-2;j++){b[j]=b[l+j]}b[j]="...";b[j+1]=b[k-1];b.splice(f);hiddenStates=k-(l+(f-1));e="+"+hiddenStates+" states"}else{if(l<n){for(j=0;j<f-2;j++){b[j]=b[l+j]}b[j]="...";b[j+1]=b[k-1];b.splice(f);hiddenStates=k-(l+(f-1));e="+"+hiddenStates+" states"}else{b.splice(0,n);b.unshift("...")}}}};render=function(){var i="";i=c({el:d,states:b,current:g,hintHiddenStates:e,stateDescription:a});h=true;return i};isRendered=function(){return h};$el=function(){return AJS.$("."+d)};initialize();return{$el:$el,checkStates:checkStates,isRendered:isRendered,render:render}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/adhocworkflows/js/autocomplete-filtered-user.js' */
var AWP=AWP||{};AWP.autocompleteFilteredUser=function(b){b=b||document.body;var c=AJS.$;var a=function(e){if(!e||!e.result){throw new Error("Invalid JSON format")}var d=[];d.push(e.result);return d};c('input.autocomplete-filtered-user[data-autocomplete-filtered-user-bound!="true"]',b).each(function(){var g=c(this).attr("data-autocomplete-filtered-user-bound","true").attr("autocomplete","off");var f=g.attr("data-max")||10,j=g.attr("data-alignment")||"left",h=g.attr("data-dropdown-target"),e=null;if(h){e=c(h)}else{e=c("<div></div>");g.after(e)}if(g.attr("data-resize-to-input")){e.width(g.outerWidth());e.addClass("resize-to-input")}e.addClass("aui-dd-parent autocomplete");var d=c(this).attr("groups");var i=c(this).attr("users");d=d||"";i=i||"";g.quicksearch("/rest/adhocworkflows/1/search/user.json?groups="+d+"&users="+i,function(){g.trigger("open.autocomplete-filtered-user")},{makeParams:function(k){return{"max-results":f,query:k}},dropdownPlacement:function(k){e.append(k)},makeRestMatrixFromData:a,addDropdownData:function(k){if(!k.length){var l=g.attr("data-none-message");if(l){k.push([{name:l,className:"no-results",href:"#"}])}}return k},ajsDropDownOptions:{alignment:j,displayHandler:function(k){if(k.restObj&&k.restObj.username){return k.name+" ("+k.restObj.username+")"}return k.name},selectionHandler:function(p,m){if(m.find(".search-for").length){g.trigger("selected.autocomplete-filtered-user",{searchFor:g.val()});return}if(m.find(".no-results").length){this.hide();p.preventDefault();return}var k=c("span:eq(0)",m).data("properties"),q=k.restObj.username,n=g.attr("data-target"),o=n&&c(n),l=g.attr("data-template")||"{username}";g.val(AJS.template(l).fillHtml(k.restObj));o&&o.val(q);g.trigger("selected.autocomplete-filtered-user",{content:k.restObj});this.hide();p.preventDefault()}}})})};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/adhocworkflows/js/states.js' */
var Adhoc=Adhoc||{};Adhoc.Workflow=Adhoc.Workflow||{};Adhoc.menuActions=Adhoc.menuActions||[];(function(a){Adhoc.Workflow.setState=function(b){Adhoc.state=b;var c=a("#adhocWorkflowsLink");if(!b.stateName||b.publishedView){c.css("display","none")}else{c.addClass("workflow-state").css("display","block").css("visibility","inherit");c.attr("title",b.hoverDescription);a("#workflow-page-message").html("")}if(b.activeTasks>0){a("#adhocTasksLink").css("display","block");Adhoc.Tasks.generateTasksPopup(Adhoc.Tasks.dialog.find(".contents"),this,function(){})}else{a("#adhocTasksLink").hide()}if(b.taskable){a("#addPageTaskLink").removeClass("notTaskable");a("#addPageTaskLink").addClass("taskable");a("#taskable").val("true")}else{a("#addPageTaskLink").removeClass("taskable");a("#addPageTaskLink").addClass("notTaskable");a("#taskable").val("false")}a("#editPageWorkflowLink").css("display","block");AWP.Embedded.Workflow.setState(b)};Adhoc.Workflow.refreshState=function(){a.ajax({type:"GET",cache:false,url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/state/"+AJS.params.pageId+"?publishedView="+Adhoc.publishedView,success:function(c,d,b){if(b.status!=200){return}AWP.Embedded.Workflow.setState(c);if(Adhoc.clickedApprovalId){a("#adhocWorkflowsLink").click()}},error:Adhoc.errorHandler});return false};Adhoc.Workflow.stateAction=function(){var c=a(this).parents("form");var b={name:c.hasClass("adhoc")?c.find("input.newstatename").val():c.find("select").val(),assignee:Adhoc.getAssignees(c),note:c.find("textarea").val()};var d=a(this).attr("name");Adhoc.submitProgress(a(this).parents(".adhoc"));a.ajax({type:"POST",cache:false,contentType:"application/json; charset=utf-8",url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/state/"+AJS.params.pageId+"/"+d,data:JSON.stringify(b),success:function(f,g,e){if(e.status==200){AWP.Embedded.Workflow.setState(f)}Adhoc.dialog.hide()},error:Adhoc.errorHandler});return false};Adhoc.Workflow.assign=function(){var b=a(this).parents("form");b.addClass("assign");return false};Adhoc.Workflow.unassign=function(){var b=a(this).parents("form");b.addClass("unassign");return false};Adhoc.Workflow.doStateDialog=function(e,c){var b=e.states;c.append(AJS.template.load("adhocworkflows-states").fill());for(i=0;i<b.length;i++){var d={name:b[i]};c.find("select").append(AJS.template.load("adhocworkflows-state").fill(d))}if(e.adhoc){c.find("select").append(AJS.template.load("adhocworkflows-state-adhoc").fill());c.find("select").change(function(){var f=a(this).parents("form");var g=a(this).val();if(g=="0"){f.addClass("adhoc")}else{f.removeClass("adhoc");f.find("input.newstatename").val("")}})}c.find("form.state input[type='submit']").click(Adhoc.Workflow.stateAction);c.find(".cancel-dialog").click(Adhoc.doHidePopup);Adhoc.setPresetUsers(a("#inline-dialog-adhocWorkflowsPopup .usersdropdown .aui-dropdown"),e.involvedUsers);c.find(".usersdropdown").dropDown("Standard");c.find("input.autocomplete-user").click(function(){var f=a(this).parents("form");f.find(".usersdropdown a.aui-dd-trigger").click()});AJS.Confluence.Binder.autocompleteUser();c.find("input.autocomplete-user").bind("selected.autocomplete-user",Adhoc.selectAssignee);c.find(".assign-page").click(Adhoc.Workflow.assign);if(e.assignee!=undefined){c.find("input[name='assignee']").attr("placeholder",c.find("input[name='assignee']").attr("placeholder2"));c.find("ol.assignees.assigned").append(AJS.template.load("adhocworkflows-assignee").fill(e.assignee))}c.find("ol.assignees.assigned .remove-assignee").click(Adhoc.Workflow.unassign);if(!e.pageAssignable){a("form.aui.state").addClass("unassignable")}else{a("form.aui.state").removeClass("unassignable")}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/adhocworkflows/js/approvals.js' */
var Adhoc=Adhoc||{};Adhoc.Approvals=Adhoc.Approvals||{};(function(a){Adhoc.Approvals.hideApproval=function(){a(this).parents(".approvals .approval").removeClass("active");a("#workflow-main .button-panel.dialog").show();return false};Adhoc.Approvals.showApproval=function(){a(this).parents(".approvals").find(".cancel-approval").click();var b=a(this).parents(".approval");var e=a(this).attr("name");var c=b.find("form");a(this).parents(".approvals .approval").removeClass("active");b.addClass("active");b.removeClass("approve").removeClass("reject").removeClass("assign");c.removeClass("approve").removeClass("reject").removeClass("assign");a("ol.assignees.select").empty();b.addClass(e);c.addClass(e);var d=b.find(".button-panel input[name='"+e+"']");d.toggleClass("highlight");setTimeout(function(){d.toggleClass("highlight")},400);a("#workflow-main .button-panel.dialog").hide();return false};Adhoc.Approvals.assign=function(){var b=a(this).parents(".approval");var c=b.find("form");c.removeClass("approve").removeClass("reject");c.addClass("assign");c.find("input.autocomplete-filtered-user").click().focus();return false};Adhoc.Approvals.doAction=function(){var d=a(this).attr("name");var b=a(this).parents("form");var c={assignee:Adhoc.getAssignees(b),user:b.find("input[name='username']").val(),password:b.find("input[name='password']").val(),name:b.find("input[name='name']").val(),note:b.find("textarea").val()};Adhoc.submitProgress(a(this).parents(".adhoc"));a.ajax({type:"POST",cache:false,contentType:"application/json; charset=utf-8",url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/approval/"+AJS.params.pageId+"/"+d,data:JSON.stringify(c),success:function(g,h,f){if(f.status==200){var e=Adhoc.state.stateName!=g.stateName;Adhoc.Workflow.setState(g);if(!e){a("#adhocWorkflowsLink").click()}else{Adhoc.dialog.hide()}}else{Adhoc.dialog.hide()}},error:Adhoc.errorHandler});return false};Adhoc.Approvals.doDialog=function(d,n){var k;if(d.approvals.length>1){k=AJS.params.approvalsLabel}else{k=""}fillApprovalActions=function(i,o){var p=i.find(".approval-header .workflow-actions");for(var j=o.actions.length-1;j>=0;j--){p.append(AJS.template.load("adhoc-action").fill(o.actions[j]))}};fillDefaultAction=function(i,j,o){$name=i.find(".name");if(j.hint!=undefined){i.attr("title",j.hint)}if(j.defaultAction!=undefined){j.defaultAction.name=o.fullName?o.fullName:o.name;j.defaultAction.shortName=o.shortName;$name.append(AJS.template.load("adhocworkflows-approval-action-default").fill(j))}else{$name.append(o.fullName?o.fullName:o.name)}};var m=d.approvals;n.append(AJS.template.load("adhocworkflows-approvals").fill());var l="";for(var g=0;g<m.length;g++){var c=m[g];c.separator=l;n.find(".approvals").append(AJS.template.load("adhocworkflows-approval").fill(c));var h=a("#"+c.id);if(c.assignees!=undefined&&c.assignees.length>0){Adhoc.setPresetUsers(h.find(".usersdropdown .aui-dropdown ol"),c.assignees);h.addClass("assignees")}else{Adhoc.setPresetUsers(h.find(".usersdropdown .aui-dropdown ol"),d.involvedUsers)}if(c.dueDate){h.find(".approval-duedate").html(AJS.template.load("adhocworkflows-approval-duedate").fill(c))}if(c.message!=undefined&&c.message.length>0){h.find(".adhoc-message").html(c.message)}fillApprovalActions(h,c);fillDefaultAction(h,c,c);for(var f=0;f<c.approvers.length;f++){var e=c.approvers[f];n.find(".approvals").append(AJS.template.load("adhocworkflows-approver").fill(e));var b=a("#"+e.id);fillApprovalActions(b,e);fillDefaultAction(b,e,e.user)}l="separator"}n.find(".workflow-action").click(Adhoc.Approvals.showApproval);n.find("form.approval input[type='submit']").click(Adhoc.Approvals.doAction);n.find(".cancel-approval").click(Adhoc.Approvals.hideApproval);n.find(".assign-approval").click(Adhoc.Approvals.assign);n.find(".cancel-dialog").click(Adhoc.doHidePopup);n.find(".usersdropdown").dropDown("Standard");if(!AJS.$.browser.msie){n.find("input.autocomplete-filtered-user,input.assignee-user").click(function(){var i=a(this).parents("form");i.find(".usersdropdown a.aui-dd-trigger").click()})}else{n.find("div.approval.assignees input.assignee-user").click(function(){var i=a(this).parents("form");i.find(".usersdropdown a.aui-dd-trigger").click()})}n.find("input.autocomplete-filtered-user").bind("selected.autocomplete-filtered-user",Adhoc.selectAssignee);n.find("input.assignee-user").keypress(function(i){i.preventDefault()});AWP.autocompleteFilteredUser();if(Adhoc.clickedApprovalId){a("#"+Adhoc.clickedApprovalId+" .approval-header .name a").click();Adhoc.clickedApprovalId=undefined}else{if(!a("#adhocWorkflowsLink").hasClass("approvalworkflow")){if(n.find(".approval-header").length==1&&n.find("a.approve:first").length==1){n.find("a.approve:first").click()}}}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/adhocworkflows/js/tasks.js' */
Adhoc=Adhoc||{};Adhoc.Tasks=Adhoc.Tasks||{};(function(a){Adhoc.Tasks.clickedTasksId;Adhoc.Tasks.editDialog,Adhoc.Tasks.dialog,Adhoc.Tasks.dialogOptions={width:280,offsetY:17,offsetX:-40,hideDelay:10000};Adhoc.Tasks.editDialogOptions={width:480,height:400,id:"inline-dialog-adhocTasks",closeOnOutsideClick:true};Adhoc.Tasks.hideDialog=function(){if(Adhoc.Tasks.dialog&&Adhoc.Tasks.dialog!=undefined){Adhoc.Tasks.dialog.hide()}if(Adhoc.Tasks.editDialog&&Adhoc.Tasks.editDialog!=undefined){Adhoc.Tasks.editDialog.hide()}return false};Adhoc.Tasks.isInlineDialog=function(){return a("#inline-dialog-adhocTasks").hasClass("aui-inline-dialog")};Adhoc.Tasks.getSelectedText=function(){var b;if(jQuery.browser.msie){b=document.selection.createRange().text}else{b=window.getSelection()}b=""+b;if(b&&b.length>2&&b.indexOf("'")!=0&&b.indexOf('"')!=0&&b.indexOf("|")<0&&b.indexOf('"')<0){b=""+b;return b.split("\n",10)}else{return[]}};Adhoc.Tasks.getNames=function(b){var c=[];b.find("input.taskName:not(.placeholded)").each(function(){var d=a(this).val();if(d.length>0){c.push(d)}});return c};Adhoc.Tasks.doAction=function(){var b=a(this).parents("form");var d=a(this).attr("name");var c=b.find("input[name='id']").val();var e={names:Adhoc.Tasks.getNames(b),assignee:Adhoc.getAssignees(b),note:b.find("textarea:not(.placeholded)").val()};Adhoc.submitProgress(a(this).parents(".adhoc"));a.ajax({type:"POST",cache:false,contentType:"application/json; charset=utf-8",url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/tasks/"+AJS.params.pageId+"/"+(c!=undefined&&c>0?c+"/":"")+d,data:JSON.stringify(e),success:function(h,i,g){if(g.status==200){Adhoc.Tasks.tasks=h.tasks;Adhoc.Tasks.updateCount(h.tasks.length);var f;if(Adhoc.Tasks.isInlineDialog()){f=Adhoc.Tasks.dialog.find(".contents")}else{f=a("#inline-dialog-adhocTasks .editor-task-dialog")}Adhoc.Tasks.doDialog(h.tasks,f,true);if(!Adhoc.Tasks.isInlineDialog()){Adhoc.Tasks.editDialog.show()}}else{Adhoc.Tasks.hideDialog()}},error:Adhoc.errorHandler});return false};Adhoc.Tasks.hideTask=function(){a(".adhoc .task").removeClass("active");return false};Adhoc.Tasks.showTask=function(){if(AJS.dropDown.current!=undefined){AJS.dropDown.current.hide()}a("#inline-dialog-adhocTasks form.addtask").removeClass("active");var d=a(this).parents(".task");var c=a(this).attr("name");if(c==undefined||c==""){c=a(this).find("a").attr("name")}var b=d.find("form");d.find(".cancel-task").click();d.addClass("active");b.attr("class","aui").addClass(c);return false};Adhoc.Tasks.updateCount=function(c){a("#adhocTasksLink span, #rte-button-adhoctasks span.trigger-text").html("");var b;if(c==undefined){c=0}if(c==0){b="adhoctasks-tasks-count0"}else{if(c==1){a("#adhocTasksLink").css("display","block");b="adhoctasks-tasks-count1"}else{a("#adhocTasksLink").css("display","block");b="adhoctasks-tasks-count"}}a("#adhocTasksLink span, #rte-button-adhoctasks span.trigger-text").append(AJS.template.load(b).fill({count:c}))};Adhoc.Tasks.toggleAddTask=function(){Adhoc.Tasks.hideTask();a("#inline-dialog-adhocTasks form.addtask").toggleClass("active");a("#taskName0").click().focus();return false};Adhoc.Tasks.assign=function(){var c=a(this);var b=a(this).parents(".task").find("form");b.addClass("assign");b.removeClass("complete");b.removeClass("view");b.removeClass("remove");return false};Adhoc.Tasks.remove=function(){var c=a(this);var b=a(this).parents(".task").find("form");b.addClass("remove");b.removeClass("complete");b.removeClass("view");b.removeClass("assign");return false};Adhoc.Tasks.assignNewTask=function(){var c=a(this);var b=c.parents("form");b.addClass("assign");c.hide();return false};Adhoc.Tasks.initClipboardSelection=function(e,h){var f;if(!e.hasClass("reload")){f=Adhoc.Tasks.getSelectedText()}else{f=[]}Adhoc.selected=f;if(!a("#adhocTasksLink").hasClass("addtasklink")&&(h.length==0||f.length>0)){e.find("a.add-task").click();var d=0;for(var b=0;b<f.length;b++){var c=a.trim(f[b]);if(c.length>0){var g=a("#taskName"+d++);g.addClass("active").click().val(c)}}if(d>1){a("form.addtask").addClass("multiple")}else{a("form.addtask").addClass("single")}}else{a("form.addtask").addClass("single")}};Adhoc.Tasks.doDialog=function(f,c,d){var e=function(k,h,n){h.toggle=n?"even":"";k.find(".tasks").append(AJS.template.load("adhoctasks-task").fill(h));var m=a("#task-"+h.id);try{m.find(".task-caption").append(AJS.template.load("adhoctasks-task-completed").fill(h))}catch(l){alert("Comala Workflows panel out of sync because of CONF-23672. Please restart server")}if(!h.comment||h.comment.length==0){m.find(".task-caption .note").remove()}var o=m.find(".name");if(h.actions&&h.actions.length>0){o.append(AJS.template.load("adhoctasks-task-action-default").fill({hint:h.hint,action:h.actions[0],shortName:h.shortName,name:h.name}))}else{o.append(h.name)}if(h.user){if(Adhoc.Tasks.isInlineDialog()){var g=m.find("ol.assignees.select");Adhoc.addAssignee(g,h.user.name,h.user.fullName,h.user.pictureUrl,"assigned")}else{o.append(AJS.template.load("adhoctasks-task-assignee").fill(h))}}if(h.dueDate){o.append(AJS.template.load("adhoctasks-task-duedate").fill(h))}for(var i=h.actions.length-1;i>=0;i--){m.find(".task-header .workflow-actions").append(AJS.template.load("adhoc-action").fill(h.actions[i]))}};c.empty();if(d){c.addClass("reload")}Adhoc.Tasks.tasks=f;c.append(AJS.template.load("adhoctasks-tasks").fill());for(var b=0;b<f.length;b++){e(c,f[b],b%2==1)}c.find("a.cancel-dialog").click(Adhoc.Tasks.hideDialog);c.find("a.cancel-addtask, a.add-task").click(Adhoc.Tasks.toggleAddTask);c.find("input[type='submit']").click(Adhoc.Tasks.doAction);c.find(".task-header, li.dropdown-item .workflow-action").click(Adhoc.Tasks.showTask);c.find(".cancel-task").click(Adhoc.Tasks.hideTask);c.find(".workflow-actions").dropDown("Standard");Adhoc.Tasks.initClipboardSelection(c,f);c.find(".assign-new-task").click(Adhoc.Tasks.assignNewTask);c.find(".assign").click(Adhoc.Tasks.assign);c.find(".remove").click(Adhoc.Tasks.remove);a.ajax({type:"GET",cache:false,url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/tasks/"+AJS.params.pageId+"/users",success:function(h,i,g){Adhoc.setPresetUsers(a(".adhoc .usersdropdown .aui-dropdown"),h.users);if(!AJS.$.browser.msie){c.find("input.autocomplete-user").click(function(){var j=a(this).parents("form");j.find(".usersdropdown a.aui-dd-trigger").click()})}c.find(".usersdropdown").dropDown("Standard")},error:Adhoc.errorHandler});c.find("input.autocomplete-user").bind("selected.autocomplete-user",Adhoc.selectAssignee);AJS.Confluence.Binder.autocompleteUser();if(Adhoc.Tasks.clickedTasksId&&Adhoc.Tasks.clickedTasksId>0){a("#task-"+Adhoc.Tasks.clickedTasksId+" .task-header .name a").click();Adhoc.Tasks.clickedTasksId=0}if(a("#adhocTasksLink").hasClass("addtasklink")){a("#adhocTasksLink").removeClass("addtasklink");c.find("a.add-task").click()}if(a("#taskable").val()=="false"){a("a.add-task").hide()}};Adhoc.Tasks.generateTasksPopup=function(e,b,d){e.addClass("adhoc");e.empty();e.append(AJS.template.load("adhocworkflows-loading").fill());d();var c=Raphael.spinner(e.find(".progress-messages-icon")[0],7,"#666");a.ajax({type:"GET",cache:false,url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/tasks/"+AJS.params.pageId,success:function(g,h,f){Adhoc.Tasks.tasks=g.tasks;Adhoc.Tasks.updateCount(g.tasks.length);Adhoc.Tasks.doDialog(Adhoc.Tasks.tasks,e,false)},error:Adhoc.errorHandler})};Adhoc.Tasks.addTaskLink=function(){if(a("#taskable").val()!="false"){a("#adhocTasksLink").css("display","block").addClass("addtasklink").click()}return false};AJS.toInit(function(b){try{Adhoc.Tasks.clickedTasksId=Adhoc.getUrlParams()["task"]}catch(c){}if(b("#editor-container, #rte-toolbar").length==0){Adhoc.Tasks.dialog=AJS.InlineDialog(b("#adhocTasksLink"),"adhocTasks",Adhoc.Tasks.generateTasksPopup,Adhoc.Tasks.dialogOptions);if(b("#adhocTasksLink").length==0){return}}else{if(AJS.params.pageId>0){Adhoc.Tasks.editDialog=new AJS.Dialog(Adhoc.Tasks.editDialogOptions);Adhoc.Tasks.editDialog.addPage("editor-task-dialog").addHeader(AJS.params.tasksLabel)}else{b("#rte-button-adhoctasks").hide()}}if(AJS.params.pageId>0&&(AJS.params.contentType=="blogpost"||AJS.params.contentType=="page")){try{b.ajax({type:"GET",cache:false,url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/tasks/"+AJS.params.pageId+"/count",success:function(e,f,d){Adhoc.Tasks.updateCount(e);if(Adhoc.Tasks.clickedTasksId&&Adhoc.Tasks.clickedTasksId>0){b("#adhocTasksLink").click()}}})}catch(c){}}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/adhocworkflows/js/templates.js' */
var Adhoc=Adhoc||{};Adhoc.Workflow=Adhoc.Workflow||{};(function(a){Adhoc.Workflow.workflowAction=function(){var b=a("#adhocWorkflowsLink");a("#add-menu-link").click();b.css("display","block").css("visibility","inherit").click();return false};Adhoc.Workflow.addApprovalAction=function(){var b=a("#adhocWorkflowsLink");a("#add-menu-link").click();b.css("display","block").css("visibility","inherit").addClass("approvalworkflow").click();return false};Adhoc.Workflow.doAddWorkflow=function(){var c=a(this);var b={workflowId:c.find("select").val(),stateNames:c.find("input.state-names").val()};Adhoc.submitProgress(a(this).parents(".adhoc"));a.ajax({type:"POST",cache:false,contentType:"application/json; charset=utf-8",url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/workflow/"+AJS.params.pageId+"/add",data:JSON.stringify(b),success:function(e,f,d){if(d.status==200){a("#addAdhocWorkflow").hide();Adhoc.Workflow.setState(e)}Adhoc.dialog.hide()},error:Adhoc.errorHandler});return false};Adhoc.Workflow.doAddApprovalWorkflow=function(){var c=a(this);var b={workflowId:0};a.ajax({type:"POST",cache:false,contentType:"application/json; charset=utf-8",url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/workflow/"+AJS.params.pageId+"/add?default=true",data:JSON.stringify(b),success:function(e,f,d){if(d.status==200){a("#addAdhocWorkflow").hide();a("#addApprovalWorkflow").hide();Adhoc.Workflow.setState(e)}Adhoc.dialog.hide();a("#adhocWorkflowsLink").click()},error:Adhoc.errorHandler});return false};Adhoc.Workflow.doSelectTemplate=function(){var c=a(this).val();var b=a(this).parents("form");if(c==0){b.addClass("adhoc")}else{b.removeClass("adhoc")}};Adhoc.Workflow.doTemplatesDialog=function(b,d,e){d.empty();d.append(AJS.template.load("adhocworkflows-select").fill());d.find(".close-dialog").click(Adhoc.doHidePopup);d.find("select").change(Adhoc.Workflow.doSelectTemplate);if(e.status!=200){return}var c=b.templates;for(i=0;i<c.length;i++){d.find("#select-workflow-templates").append(AJS.template.load("adhocworkflows-select-template").fill(c[i]))}d.find("#select-workflow-templates").append(AJS.template.load("adhocworkflows-adhoc-template").fill());d.find("form").submit(Adhoc.Workflow.doAddWorkflow)}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/adhocworkflows/js/forms.js' */
var Adhoc=Adhoc||{};Adhoc.Form=Adhoc.Form||{};Adhoc.menuActions=Adhoc.menuActions||[];(function(a){Adhoc.Form.toggleEdit=function(){a("#workflow-form").toggleClass("edit");return false};Adhoc.Form.doSubmitForm=function(){var d={fields:[]};var c=a(this).parents("form").find("table input");c.each(function(){d.fields.push({id:a(this).attr("name"),value:a(this).attr("value")})});var b=a(this).parents("form").find("table select");b.each(function(){d.fields.push({id:a(this).attr("name"),value:a("option:selected",a(this)).text()})});Adhoc.submitProgress(a(this).parents(".adhoc"));a.ajax({type:"POST",cache:false,contentType:"application/json; charset=utf-8",url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/forms/"+AJS.params.pageId+"/submit",data:JSON.stringify(d),success:function(g,h,f){if(f.status==200){var e=Adhoc.state.stateName!=g.stateName;Adhoc.Workflow.setState(g);a("#adhocWorkflowsLink").click()}else{Adhoc.dialog.hide()}},error:Adhoc.errorHandler});return false};Adhoc.Form.doFormDialog=function(g,c){var e=g.inputFields;c.append(AJS.template.load("adhocworkflows-form").fill());var d=c.find(".ahoc-form table");for(i=0;i<e.length;i++){var b=e[i];d.append(AJS.template.load("adhocworkflows-inputfield").fill(b));var f=c.find("#"+b.id);if(b.type=="USER"){f.append(AJS.template.load("adhocworkflows-inputfield-user").fill(b));a.ajax({type:"GET",cache:false,url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/forms/user/"+f.find("span").html(),success:function(h,l,k){if(k.status!=200){return}c.find("span[title='"+h.name+"']").html("").append(AJS.template.load("adhocworkflows-inputfield-decorated-user").fill(h))},error:Adhoc.errorHandler})}else{if(b.type=="LIST"){f.append(AJS.template.load("adhocworkflows-inputfield-list").fill(b));for(j=0;j<b.options.length;j++){f.find("select").append(AJS.template.load("adhocworkflows-inputfield-list-option").fill({option:b.options[j],selected:(b.options[j]==b.value?"selected='selected'":"")}))}}else{f.append(AJS.template.load("adhocworkflows-inputfield-text").fill(b))}}}c.find(".edit-form").click(Adhoc.Form.toggleEdit);if(g.initParameters){c.find(".edit-form").click()}c.find("input[type='submit']").click(Adhoc.Form.doSubmitForm);c.find(".cancel-dialog").click(Adhoc.doHidePopup);Adhoc.setPresetUsers(a("#inline-dialog-adhocWorkflowsPopup .usersdropdown .aui-dropdown"),g.involvedUsers);c.find("input.autocomplete-user").click(function(){a(this).parents("td").find(".usersdropdown a.aui-dd-trigger").click()});c.find(".usersdropdown").dropDown("Standard")};Adhoc.Form.showParameters=function(){Adhoc.action.showParameters=true;Adhoc.generateActionDialog(Adhoc.dialog.find("div.contents"),Adhoc.action);return false}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/adhocworkflows/js/adhocworkflows.js' */
var Adhoc=Adhoc||{};Adhoc.Workflow=Adhoc.Workflow||{};Adhoc.viewHistory=false;(function(b){Adhoc.clickedApprovalId=null;Adhoc.dialog=null;Adhoc.dialogOptions={width:280,offsetY:17,offsetX:-40,hideDelay:10000};Adhoc.activityOptions={onHover:true,width:380,offsetY:10,offsetX:-40,hideDelay:500};Adhoc.setPresetUsers=function(e,f){e.empty();for(var d=0;d<f.length;d++){e.append(AJS.template.load("adhocworkflows-user").fill(f[d]))}e.find("a").click(Adhoc.clickAssignee)};Adhoc.updateAssignButton=function(d){var e=d.parents("form").find("input.assign");if(d.find("li").length>0){e.removeAttr("disabled")}else{e.attr("disabled","disabled")}};Adhoc.addAssignee=function(f,g,i,h,j){if(f.find("li[name='"+g+"']").length>0){return}if(f.hasClass("single")){f.find("li").remove()}var e={name:g,fullName:i,pictureUrl:h};f.append(AJS.template.load("adhocworkflows-assignee").fill(e));var d=f.find("li[name='"+e.name+"']");if(j!==undefined){d.addClass(j)}d.find(".remove-assignee").click(Adhoc.removeAssignee);Adhoc.updateAssignButton(f)};Adhoc.removeAssignee=function(){var e=b(this).parents("ol");var d=b(this).parents("li");d.remove();Adhoc.updateAssignButton(e);return false};Adhoc.clickAssignee=function(){var e=b(this).parents("form");var f=b(this).attr("name");var d=e.find("ol.assignees.select");b.ajax({type:"GET",cache:false,url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/workflow/userdetails?username="+f,success:function(h,j,i){if(h!==undefined){var g=h;Adhoc.addAssignee(d,g.name,g.fullName,g.pictureUrl)}},error:function(){}});AJS.dropDown.current.hide();return false};Adhoc.selectAssignee=function(j,h){try{var g=b(this).parents("form");var f=g.find("ol.assignees.select");var d=h.content;Adhoc.addAssignee(f,d.username,d.title,d.thumbnailLink.href);g.find("input.autocomplete-user").val("")}catch(i){}return false};Adhoc.getAssignees=function(e){var d=e.find("ol.assignees.select li, ol.assignees.assignee li");var g="";var f="";d.each(function(){f=f+g+jQuery(this).attr("name");g=","});return f};Adhoc.errorHandler=function(e,d){console.error("Error, check Adhoc.errorData and Adhoc.errorStatus");Adhoc.errorData=e;Adhoc.errorStatus=d};Adhoc.doHidePopup=function(){Adhoc.dialog.hide();return false};Adhoc.generateActionDialog=function(d,e){Adhoc.action=e;d.empty();if(e.hasParameters){d.addClass("parameters")}if(e.showParameters){Adhoc.Form.doFormDialog(e,d)}else{if(e.approvals){Adhoc.Approvals.doDialog(e,d)}else{if(e.states){Adhoc.Workflow.doStateDialog(e,d)}else{b("#adhocWorkflowsLink").addClass("published").unbind("click").click(function(){return false});Adhoc.doHidePopup()}}}d.find("a.parameters").click(Adhoc.Form.showParameters)};Adhoc.getUrlParams=function c(){var e={};var d=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(f,g,h){e[g]=h});return e};Adhoc.submitProgress=function(e){e.find("input, select, a").attr("disabled","disabled");var d=Raphael.spinner(e.find(".progress-messages-icon")[0],7,"#666")};var a=function(g,d,f){g.addClass("adhoc");g.empty();g.append(AJS.template.load("adhocworkflows-loading").fill());f();var e=Raphael.spinner(g.find(".progress-messages-icon")[0],7,"#666");var h=b("#adhocWorkflowsLink");if(h.hasClass("workflow-state")){b.ajax({type:"GET",cache:false,url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/workflow/"+AJS.params.pageId+"/actions"+(AJS.params.workflowAdmin?"?admin=true":""),success:function(j,k,i){Adhoc.generateActionDialog(g,j)},error:Adhoc.errorHandler})}else{if(h.hasClass("approvalworkflow")){Adhoc.Workflow.doAddApprovalWorkflow()}else{b.ajax({type:"GET",cache:false,url:AJS.Confluence.getContextPath()+"/rest/adhocworkflows/latest/workflow/"+AJS.params.pageId+"/templates",success:function(i,k,j){Adhoc.Workflow.doTemplatesDialog(i,g,j)},error:Adhoc.errorHandler})}}};AJS.toInit(function(g){console.log("initializing Comala Workflows...");g("#labelsString").focus(Adhoc.Workflow.refreshState);if(AJS.params.publishedView){g("#adhocWorkflowsLink").addClass("published").click(function(){return false});g("body").addClass("cw-published-view")}else{if(AJS.params.anonymous){g("#adhocWorkflowsLink").click(function(){return false})}else{Adhoc.dialog=AJS.InlineDialog(g("#adhocWorkflowsLink"),"adhocWorkflowsPopup",a,Adhoc.dialogOptions)}}if(g("#workflow-page-status").length===0){return}var f={stateName:AJS.params.stateName,stateDescription:AJS.params.stateDescription,finalState:AJS.params.finalState,hasFinalState:AJS.params.hasFinalState,publishedView:AJS.params.publishedView,alternateViewStateName:AJS.params.alternateViewStateName,alternateViewUrl:AJS.params.alternateViewUrl,taskable:AJS.params.taskable,hoverDescription:AJS.params.hoverDescription};g("#main-content").before("<div id='workflow-page-message'></div>");if(g("workflow-license-message")){g("#main-content").before(g("#workflow-license-message"))}if(g("#workflow-page-header")){g("#main-content").before(g("#workflow-page-header"))}if(g("#workflow-page-footer")){g("#main-content").after(g("#workflow-page-footer"))}Adhoc.publishedView=f.publishedView;if(Adhoc.publishedView){g("#viewPageLink").hide();g("#viewPageLink").parents("li").hide()}else{if(f.alternateViewUrl){var i=g("#action-export-pdf-link").attr("href");g("#action-export-pdf-link").attr("href",i+"&publishedView=false");var d=g("#action-export-word-link").attr("href");g("#action-export-word-link").attr("href",d+"&publishedView=false")}}Adhoc.Workflow.refreshState();try{Adhoc.clickedApprovalId=Adhoc.getUrlParams().approval}catch(h){}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/com/comalatech/workflow/common/soy/progresstracker.soy' */
// This file was automatically generated from progresstracker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace AWP.Templates.
 */

if (typeof AWP == 'undefined') { var AWP = {}; }
if (typeof AWP.Templates == 'undefined') { AWP.Templates = {}; }


AWP.Templates.progresstracker = function(opt_data, opt_ignored) {
  var output = '<div class="' + soy.$$escapeHtml(opt_data.el) + '"><ol class="aui-progress-tracker">';
  var stateList6 = opt_data.states;
  var stateListLen6 = stateList6.length;
  for (var stateIndex6 = 0; stateIndex6 < stateListLen6; stateIndex6++) {
    var stateData6 = stateList6[stateIndex6];
    output += '<li ' + ((stateData6 == '...') ? 'title="' + soy.$$escapeHtml(opt_data.hintHiddenStates) + '"' : '') + 'class="aui-progress-tracker-step ' + ((stateData6 == opt_data.current) ? 'aui-progress-tracker-step-current' : '') + ' ' + ((stateData6 == '...') ? (stateIndex6 == 0) ? 'awp-progress-tracker-step-first' : 'awp-progress-tracker-step-short' : '') + '"><span class="' + ((stateData6 == '...') ? 'awp-progress-tracker-transition' : '') + '">' + soy.$$escapeHtml(stateData6) + '</span></li>';
  }
  output += '</ol>' + ((opt_data.stateDescription && opt_data.current != opt_data.stateDescription) ? '<div class="awp-progress-statedesc">' + soy.$$escapeHtml(opt_data.stateDescription) + '</div>' : '') + '</div>';
  return output;
};
if (goog.DEBUG) {
  AWP.Templates.progresstracker.soyTemplateName = 'AWP.Templates.progresstracker';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:adhocworkflows-resource', location = 'templates/com/comalatech/workflow/common/js/view/progresstracker.js' */
var AWP=AWP||{};AWP.ProgressTracker=(function(b,g,a){var f=5,h=false,e="",d="awp-progress-tracker",c=AWP.Templates.progresstracker;initialize=function(){filterStates();if(!a){a=""}};checkStates=function(){var l=false;if(arguments.length>0){g=arguments[0]}var k=b.indexOf(g);if(k>=0){l=true}return l};filterStates=function(){var k=b.length;this.hintHiddenStates="";if(k>f){var n=k-f;var l=0,m=false;while(l<k&&!m){if(b[l]==g){m=true}l++}l--;if(l==0){for(j=0;j<f-2;j++){b[j]=b[l+j]}b[j]="...";b[j+1]=b[k-1];b.splice(f);hiddenStates=k-(l+(f-1));e="+"+hiddenStates+" states"}else{if(l<n){for(j=0;j<f-2;j++){b[j]=b[l+j]}b[j]="...";b[j+1]=b[k-1];b.splice(f);hiddenStates=k-(l+(f-1));e="+"+hiddenStates+" states"}else{b.splice(0,n);b.unshift("...")}}}};render=function(){var i="";i=c({el:d,states:b,current:g,hintHiddenStates:e,stateDescription:a});h=true;return i};isRendered=function(){return h};$el=function(){return AJS.$("."+d)};initialize();return{$el:$el,checkStates:checkStates,isRendered:isRendered,render:render}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:deletePageVersionsResource', location = '/templates/javascript/page-delete-versions.js' */
(function(a,b){a.toInit(function(){if(a.params.deletePageVersionsForbidden){b(".remove-historical-version-trigger").each(function(){var c=this.previousSibling;if(c&&c.nodeType&&c.nodeType===3){b(c).remove()}b(this).remove()})}})})(AJS,AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics', location = 'browser-metrics-legacy.js' */
(function(){var a=window.BrowserMetrics||{};var b=window.WRM||{};a.isFunction=function(c){return !!(c&&c.constructor&&c.call&&c.apply)};a.isEnabled=function(){if(a.enabled===undefined){var c="com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy";a.enabled=a.isFunction(b.data)?b.data(c):b.data.claim(c)}return a.enabled};window.BrowserMetrics=a}());(function(){var b=window.BrowserMetrics||{};if(b.isEnabled()){var f=5;var e=12000;var c=function(g){return Math.round(g)};var a=function(g){return Math.round(g*100)/100};var d=function(k){var h=(function(){var n=/^(\w+):\/\/([^\/]*)(.*)$/;return function(p){var o=p.match(n);if(!o){return{path:p}}return{scheme:o[1],host:o[2],path:o[3]}}}());var i=(function(){var n=["secureConnectionStart","requestStart","responseStart","responseEnd","domContentLoadedEventStart","domContentLoadedEventEnd","loadEventEnd"];return function(o){if(k.performance){var s=k.performance.timing;var p=s.navigationStart;if(p){for(var r=0;r<n.length;++r){var q=n[r];var t=s[q];if(t){o(q,t-p)}}}}}}());var g=(function(){var o=[{key:"LOGIN",pattern:/^\/login.*/i},{key:"J-DASH",pattern:/^\/secure\/dashboard\.jspa.*/i},{key:"J-ISSUE",pattern:/^\/browse\/\w+\-\w+.*/i},{key:"J-NAV",pattern:/^\/issues.*/i},{key:"J-RAPID",pattern:/secure\/rapidboard\.jspa/i},{key:"SD-AGENT",pattern:/^(\/\w+)?\/servicedesk\/agent\/.*/i},{key:"SD-CUSTOMER",pattern:/^(\/\w+)?\/servicedesk\/customer\/.*/i},{key:"C-DASH",pattern:/^\/wiki(\/)?(\?.*|#.*)?$/i},{key:"C-DASH",pattern:/^\/wiki\/dashboard\.action.*$/i},{key:"C-SPACE",pattern:/^\/wiki\/display\/\w+(\?.*|#.*)?$/i},{key:"C-PAGE",pattern:/^\/wiki\/display\/\w+\/.*/i},{key:"C-PAGE",pattern:/^\/wiki\/pages\/viewpage\.action.*/i},{key:"C-BLOG",pattern:/^\/wiki\/display\/~\w+\/\d+\/\d+\/\d+\/.*/i},{key:"C-EDITOR",pattern:/^\/wiki\/pages\/editpage\.action.*/i},{key:"C-CREATE",pattern:/^\/wiki\/pages\/createpage\.action.*/i}];return function n(){var r=h(k.location.href).path;for(var p=0;p<o.length;++p){var q=o[p];if(r.match(q.pattern)){return q.key}}return null}}());function j(){var n=g();if(n){i(function(p,r){var o="browser.metrics."+p,q={version:f,page:n,value:r>e?"x":Math.ceil((r)/100),rawValue:c(r)};AJS.Analytics?AJS.Analytics.triggerPrivacyPolicySafeEvent(o,q):AJS.trigger("analyticsEvent",{name:o,data:q})})}}function m(){try{j()}catch(n){if(window.console){window.console.log("Error reporting browser metrics: "+n)}}}function l(){if(k.performance.timing.loadEventEnd){m()}else{setTimeout(l,1000)}}if(k.performance&&k.performance.timing){l()}};if(!window.ATL_PERF){window.ATL_PERF={}}window.ATL_PERF.initPageLoad=d}}());(function(){var b=window.BrowserMetrics||{};if(b.isEnabled()){var e=5;var d=12000;var a=function(f){return Math.round(f*100)/100};var c=function(g){var l={};function h(){return g.performance&&g.performance.now?g.performance.now():new Date().getTime()}function n(o){return o===Object(o)}function k(o){if(n(o)){return o.eventName+"."+o.eventType}else{return o}}function m(o){if(n(o)){return o.eventName}else{return o}}function j(o){if(n(o)){return o.eventType}else{return""}}function f(o){var p=k(o);l[p]=h()}function i(r,u){var v=k(r);if(!l[v]){throw ("Error logging browser metrics event end: no start event for key '"+v+"'")}var t=h()-l[v];l[v]=null;var o=m(r),q=j(r);var p="browser.metrics.e."+o+(u?"."+u:""),s={version:e,value:t>d?"x":Math.ceil((t)/100),rawValue:a(t),eventType:q};g.AJS.Analytics?g.AJS.Analytics.triggerPrivacyPolicySafeEvent(p,s):g.AJS.trigger("analyticsEvent",{name:p,data:s})}return{start:f,end:i}};if(!window.ATL_PERF){window.ATL_PERF={}}window.ATL_PERF.initEvents=c}}());(function(){var a=window.BrowserMetrics||{};if(a.isEnabled()){if(Math.random()<0.1){window.ATL_PERF&&window.ATL_PERF.initPageLoad&&window.ATL_PERF.initPageLoad(window)}window.ATL_PERF&&window.ATL_PERF.initEvents&&(function(){window.BrowserMetrics=window.ATL_PERF.initEvents(window)}())}}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:almond', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/almond-noconflict-pre.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:almond', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/almond/almond.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:almond', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/almond-noconflict-post.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-for-confluence-lt-5.7', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/ajs-amd.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-for-confluence-lt-5.7', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/jquery-amd.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd-for-confluence-lt-5.7', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/underscore-amd.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd', location = '/com/atlassian/confluence/extra/calendar3/amd/shim/templates-amd.js' */
define("tc/templates",function(){return Confluence.TeamCalendars.Templates});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd', location = '/com/atlassian/confluence/extra/calendar3/amd/shim/dialogs-amd.js' */
define("tc/dialogs",function(){return Confluence.TeamCalendars.Dialogs});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/backbone-amd.js' */
(function(a,b){if(typeof define==="function"&&define.amd){define(["underscore","jquery","exports"],function(e,f,d){a.Backbone=b(a,d,e,f)})}else{if(typeof exports!=="undefined"){var c=require("underscore");b(a,exports,c)}else{a.Backbone=b(a,{},a._,(a.jQuery||a.Zepto||a.ender||a.$))}}}(this,function(t,c,G,h){var r=t.Backbone;var j=[];var s=j.slice;c.VERSION="1.1.2";c.$=h;c.noConflict=function(){t.Backbone=r;return this};c.emulateHTTP=false;c.emulateJSON=false;var p=c.Events={on:function(J,M,L){if(!I(this,"on",J,[M,L])||!M){return this}this._events||(this._events={});var K=this._events[J]||(this._events[J]=[]);K.push({callback:M,context:L,ctx:L||this});return this},once:function(K,N,L){if(!I(this,"once",K,[N,L])||!N){return this}var J=this;var M=G.once(function(){J.off(K,M);N.apply(this,arguments)});M._callback=N;return this.on(K,M,L)},off:function(K,S,L){if(!this._events||!I(this,"off",K,[S,L])){return this}if(!K&&!S&&!L){this._events=void 0;return this}var R=K?[K]:G.keys(this._events);for(var Q=0,M=R.length;Q<M;Q++){K=R[Q];var T=this._events[K];if(!T){continue}if(!S&&!L){delete this._events[K];continue}var O=[];for(var P=0,N=T.length;P<N;P++){var J=T[P];if(S&&S!==J.callback&&S!==J.callback._callback||L&&L!==J.context){O.push(J)}}if(O.length){this._events[K]=O}else{delete this._events[K]}}return this},trigger:function(L){if(!this._events){return this}var K=s.call(arguments,1);if(!I(this,"trigger",L,K)){return this}var M=this._events[L];var J=this._events.all;if(M){d(M,K)}if(J){d(J,arguments)}return this},stopListening:function(M,K,O){var L=this._listeningTo;if(!L){return this}var J=!K&&!O;if(!O&&typeof K==="object"){O=this}if(M){(L={})[M._listenId]=M}for(var N in L){M=L[N];M.off(K,O,this);if(J||G.isEmpty(M._events)){delete this._listeningTo[N]}}return this}};var a=/\s+/;var I=function(Q,O,J,M){if(!J){return true}if(typeof J==="object"){for(var L in J){Q[O].apply(Q,[L,J[L]].concat(M))}return false}if(a.test(J)){var P=J.split(a);for(var K=0,N=P.length;K<N;K++){Q[O].apply(Q,[P[K]].concat(M))}return false}return true};var d=function(O,M){var P,N=-1,L=O.length,K=M[0],J=M[1],Q=M[2];switch(M.length){case 0:while(++N<L){(P=O[N]).callback.call(P.ctx)}return;case 1:while(++N<L){(P=O[N]).callback.call(P.ctx,K)}return;case 2:while(++N<L){(P=O[N]).callback.call(P.ctx,K,J)}return;case 3:while(++N<L){(P=O[N]).callback.call(P.ctx,K,J,Q)}return;default:while(++N<L){(P=O[N]).callback.apply(P.ctx,M)}return}};var q={listenTo:"on",listenToOnce:"once"};G.each(q,function(J,K){p[K]=function(N,L,P){var M=this._listeningTo||(this._listeningTo={});var O=N._listenId||(N._listenId=G.uniqueId("l"));M[O]=N;if(!P&&typeof L==="object"){P=this}N[J](L,P,this);return this}});p.bind=p.on;p.unbind=p.off;G.extend(c,p);var m=c.Model=function(J,L){var K=J||{};L||(L={});this.cid=G.uniqueId("c");this.attributes={};if(L.collection){this.collection=L.collection}if(L.parse){K=this.parse(K,L)||{}}K=G.defaults({},K,G.result(this,"defaults"));this.set(K,L);this.changed={};this.initialize.apply(this,arguments)};G.extend(m.prototype,p,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(J){return G.clone(this.attributes)},sync:function(){return c.sync.apply(this,arguments)},get:function(J){return this.attributes[J]},escape:function(J){return G.escape(this.get(J))},has:function(J){return this.get(J)!=null},set:function(R,K,V){var P,S,T,Q,O,U,L,N;if(R==null){return this}if(typeof R==="object"){S=R;V=K}else{(S={})[R]=K}V||(V={});if(!this._validate(S,V)){return false}T=V.unset;O=V.silent;Q=[];U=this._changing;this._changing=true;if(!U){this._previousAttributes=G.clone(this.attributes);this.changed={}}N=this.attributes,L=this._previousAttributes;if(this.idAttribute in S){this.id=S[this.idAttribute]}for(P in S){K=S[P];if(!G.isEqual(N[P],K)){Q.push(P)}if(!G.isEqual(L[P],K)){this.changed[P]=K}else{delete this.changed[P]}T?delete N[P]:N[P]=K}if(!O){if(Q.length){this._pending=V}for(var M=0,J=Q.length;M<J;M++){this.trigger("change:"+Q[M],this,N[Q[M]],V)}}if(U){return this}if(!O){while(this._pending){V=this._pending;this._pending=false;this.trigger("change",this,V)}}this._pending=false;this._changing=false;return this},unset:function(J,K){return this.set(J,void 0,G.extend({},K,{unset:true}))},clear:function(K){var J={};for(var L in this.attributes){J[L]=void 0}return this.set(J,G.extend({},K,{unset:true}))},hasChanged:function(J){if(J==null){return !G.isEmpty(this.changed)}return G.has(this.changed,J)},changedAttributes:function(L){if(!L){return this.hasChanged()?G.clone(this.changed):false}var N,M=false;var K=this._changing?this._previousAttributes:this.attributes;for(var J in L){if(G.isEqual(K[J],(N=L[J]))){continue}(M||(M={}))[J]=N}return M},previous:function(J){if(J==null||!this._previousAttributes){return null}return this._previousAttributes[J]},previousAttributes:function(){return G.clone(this._previousAttributes)},fetch:function(K){K=K?G.clone(K):{};if(K.parse===void 0){K.parse=true}var J=this;var L=K.success;K.success=function(M){if(!J.set(J.parse(M,K),K)){return false}if(L){L(J,M,K)}J.trigger("sync",J,M,K)};e(this,K);return this.sync("read",this,K)},save:function(N,K,R){var O,J,Q,L=this.attributes;if(N==null||typeof N==="object"){O=N;R=K}else{(O={})[N]=K}R=G.extend({validate:true},R);if(O&&!R.wait){if(!this.set(O,R)){return false}}else{if(!this._validate(O,R)){return false}}if(O&&R.wait){this.attributes=G.extend({},L,O)}if(R.parse===void 0){R.parse=true}var M=this;var P=R.success;R.success=function(T){M.attributes=L;var S=M.parse(T,R);if(R.wait){S=G.extend(O||{},S)}if(G.isObject(S)&&!M.set(S,R)){return false}if(P){P(M,T,R)}M.trigger("sync",M,T,R)};e(this,R);J=this.isNew()?"create":(R.patch?"patch":"update");if(J==="patch"){R.attrs=O}Q=this.sync(J,this,R);if(O&&R.wait){this.attributes=L}return Q},destroy:function(K){K=K?G.clone(K):{};var J=this;var N=K.success;var L=function(){J.trigger("destroy",J,J.collection,K)};K.success=function(O){if(K.wait||J.isNew()){L()}if(N){N(J,O,K)}if(!J.isNew()){J.trigger("sync",J,O,K)}};if(this.isNew()){K.success();return false}e(this,K);var M=this.sync("delete",this,K);if(!K.wait){L()}return M},url:function(){var J=G.result(this,"urlRoot")||G.result(this.collection,"url")||x();if(this.isNew()){return J}return J.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(K,J){return K},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return !this.has(this.idAttribute)},isValid:function(J){return this._validate({},G.extend(J||{},{validate:true}))},_validate:function(L,K){if(!K.validate||!this.validate){return true}L=G.extend({},this.attributes,L);var J=this.validationError=this.validate(L,K)||null;if(!J){return true}this.trigger("invalid",this,J,G.extend(K,{validationError:J}));return false}});var C=["keys","values","pairs","invert","pick","omit","chain"];G.each(C,function(J){if(!G[J]){return}m.prototype[J]=function(){var K=s.call(arguments);K.unshift(this.attributes);return G[J].apply(G,K)}});var H=c.Collection=function(K,J){J||(J={});if(J.model){this.model=J.model}if(J.comparator!==void 0){this.comparator=J.comparator}this._reset();this.initialize.apply(this,arguments);if(K){this.reset(K,G.extend({silent:true},J))}};var z={add:true,remove:true,merge:true};var n={add:true,remove:false};G.extend(H.prototype,p,{model:m,initialize:function(){},toJSON:function(J){return this.map(function(K){return K.toJSON(J)})},sync:function(){return c.sync.apply(this,arguments)},add:function(K,J){return this.set(K,G.extend({merge:false},J,n))},remove:function(Q,L){var N=!G.isArray(Q);Q=N?[Q]:G.clone(Q);L||(L={});for(var M=0,O=Q.length;M<O;M++){var K=Q[M]=this.get(Q[M]);if(!K){continue}var P=this.modelId(K.attributes);if(P!=null){delete this._byId[P]}delete this._byId[K.cid];var J=this.indexOf(K);this.models.splice(J,1);this.length--;if(!L.silent){L.index=J;K.trigger("remove",K,this,L)}this._removeReference(K,L)}return N?Q[0]:Q},set:function(ab,L){L=G.defaults({},L,z);if(L.parse){ab=this.parse(ab,L)}var O=!G.isArray(ab);ab=O?(ab?[ab]:[]):ab.slice();var T,M,V,S,aa;var Q=L.at;var J=this.comparator&&(Q==null)&&L.sort!==false;var Z=G.isString(this.comparator)?this.comparator:null;var ac=[],W=[],U={};var R=L.add,N=L.merge,ad=L.remove;var X=!J&&R&&ad?[]:false;for(var Y=0,K=ab.length;Y<K;Y++){V=ab[Y];if(S=this.get(V)){if(ad){U[S.cid]=true}if(N&&V!==S){V=this._isModel(V)?V.attributes:V;if(L.parse){V=S.parse(V,L)}S.set(V,L);if(J&&!aa&&S.hasChanged(Z)){aa=true}}ab[Y]=S}else{if(R){M=ab[Y]=this._prepareModel(V,L);if(!M){continue}ac.push(M);this._addReference(M,L)}}M=S||M;if(!M){continue}T=this.modelId(M.attributes);if(X&&(M.isNew()||!U[T])){X.push(M)}U[T]=true}if(ad){for(var Y=0,K=this.length;Y<K;Y++){if(!U[(M=this.models[Y]).cid]){W.push(M)}}if(W.length){this.remove(W,L)}}if(ac.length||(X&&X.length)){if(J){aa=true}this.length+=ac.length;if(Q!=null){for(var Y=0,K=ac.length;Y<K;Y++){this.models.splice(Q+Y,0,ac[Y])}}else{if(X){this.models.length=0}var P=X||ac;for(var Y=0,K=P.length;Y<K;Y++){this.models.push(P[Y])}}}if(aa){this.sort({silent:true})}if(!L.silent){for(var Y=0,K=ac.length;Y<K;Y++){(M=ac[Y]).trigger("add",M,this,L)}if(aa||(X&&X.length)){this.trigger("sort",this,L)}}return O?ab[0]:ab},reset:function(M,J){J||(J={});for(var K=0,L=this.models.length;K<L;K++){this._removeReference(this.models[K],J)}J.previousModels=this.models;this._reset();M=this.add(M,G.extend({silent:true},J));if(!J.silent){this.trigger("reset",this,J)}return M},push:function(K,J){return this.add(K,G.extend({at:this.length},J))},pop:function(K){var J=this.at(this.length-1);this.remove(J,K);return J},unshift:function(K,J){return this.add(K,G.extend({at:0},J))},shift:function(K){var J=this.at(0);this.remove(J,K);return J},slice:function(){return s.apply(this.models,arguments)},get:function(J){if(J==null){return void 0}var K=this.modelId(this._isModel(J)?J.attributes:J);return this._byId[J]||this._byId[K]||this._byId[J.cid]},at:function(J){return this.models[J]},where:function(J,K){if(G.isEmpty(J)){return K?void 0:[]}return this[K?"find":"filter"](function(L){for(var M in J){if(J[M]!==L.get(M)){return false}}return true})},findWhere:function(J){return this.where(J,true)},sort:function(J){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}J||(J={});if(G.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(G.bind(this.comparator,this))}if(!J.silent){this.trigger("sort",this,J)}return this},pluck:function(J){return G.invoke(this.models,"get",J)},fetch:function(J){J=J?G.clone(J):{};if(J.parse===void 0){J.parse=true}var L=J.success;var K=this;J.success=function(M){var N=J.reset?"reset":"set";K[N](M,J);if(L){L(K,M,J)}K.trigger("sync",K,M,J)};e(this,J);return this.sync("read",this,J)},create:function(K,J){J=J?G.clone(J):{};if(!(K=this._prepareModel(K,J))){return false}if(!J.wait){this.add(K,J)}var M=this;var L=J.success;J.success=function(N,O){if(J.wait){M.add(N,J)}if(L){L(N,O,J)}};K.save(null,J);return K},parse:function(K,J){return K},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(J){return J[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(L,K){if(this._isModel(L)){if(!L.collection){L.collection=this}return L}K=K?G.clone(K):{};K.collection=this;var J=new this.model(L,K);if(!J.validationError){return J}this.trigger("invalid",this,J.validationError,K);return false},_isModel:function(J){return J instanceof m},_addReference:function(K,J){this._byId[K.cid]=K;var L=this.modelId(K.attributes);if(L!=null){this._byId[L]=K}K.on("all",this._onModelEvent,this)},_removeReference:function(K,J){if(this===K.collection){delete K.collection}K.off("all",this._onModelEvent,this)},_onModelEvent:function(L,K,N,J){if((L==="add"||L==="remove")&&N!==this){return}if(L==="destroy"){this.remove(K,J)}if(L==="change"){var M=this.modelId(K.previousAttributes());var O=this.modelId(K.attributes);if(M!==O){if(M!=null){delete this._byId[M]}if(O!=null){this._byId[O]=K}}}this.trigger.apply(this,arguments)}});var D=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];G.each(D,function(J){if(!G[J]){return}H.prototype[J]=function(){var K=s.call(arguments);K.unshift(this.models);return G[J].apply(G,K)}});var i=["groupBy","countBy","sortBy","indexBy"];G.each(i,function(J){if(!G[J]){return}H.prototype[J]=function(M,K){var L=G.isFunction(M)?M:function(N){return N.get(M)};return G[J](this.models,L,K)}});var w=c.View=function(J){this.cid=G.uniqueId("view");J||(J={});G.extend(this,G.pick(J,y));this._ensureElement();this.initialize.apply(this,arguments)};var g=/^(\S+)\s*(.*)$/;var y=["model","collection","el","id","attributes","className","tagName","events"];G.extend(w.prototype,p,{tagName:"div",$:function(J){return this.$el.find(J)},initialize:function(){},render:function(){return this},remove:function(){this._removeElement();this.stopListening();return this},_removeElement:function(){this.$el.remove()},setElement:function(J){this.undelegateEvents();this._setElement(J);this.delegateEvents();return this},_setElement:function(J){this.$el=J instanceof c.$?J:c.$(J);this.el=this.$el[0]},delegateEvents:function(L){if(!(L||(L=G.result(this,"events")))){return this}this.undelegateEvents();for(var K in L){var M=L[K];if(!G.isFunction(M)){M=this[L[K]]}if(!M){continue}var J=K.match(g);this.delegate(J[1],J[2],G.bind(M,this))}return this},delegate:function(K,J,L){this.$el.on(K+".delegateEvents"+this.cid,J,L)},undelegateEvents:function(){if(this.$el){this.$el.off(".delegateEvents"+this.cid)}return this},undelegate:function(K,J,L){this.$el.off(K+".delegateEvents"+this.cid,J,L)},_createElement:function(J){return document.createElement(J)},_ensureElement:function(){if(!this.el){var J=G.extend({},G.result(this,"attributes"));if(this.id){J.id=G.result(this,"id")}if(this.className){J["class"]=G.result(this,"className")}this.setElement(this._createElement(G.result(this,"tagName")));this._setAttributes(J)}else{this.setElement(G.result(this,"el"))}},_setAttributes:function(J){this.$el.attr(J)}});c.sync=function(Q,L,K){var N=u[Q];G.defaults(K||(K={}),{emulateHTTP:c.emulateHTTP,emulateJSON:c.emulateJSON});var P={type:N,dataType:"json"};if(!K.url){P.url=G.result(L,"url")||x()}if(K.data==null&&L&&(Q==="create"||Q==="update"||Q==="patch")){P.contentType="application/json";P.data=JSON.stringify(K.attrs||L.toJSON(K))}if(K.emulateJSON){P.contentType="application/x-www-form-urlencoded";P.data=P.data?{model:P.data}:{}}if(K.emulateHTTP&&(N==="PUT"||N==="DELETE"||N==="PATCH")){P.type="POST";if(K.emulateJSON){P.data._method=N}var M=K.beforeSend;K.beforeSend=function(R){R.setRequestHeader("X-HTTP-Method-Override",N);if(M){return M.apply(this,arguments)}}}if(P.type!=="GET"&&!K.emulateJSON){P.processData=false}var J=K.error;K.error=function(S,T,R){K.textStatus=T;K.errorThrown=R;if(J){J.apply(this,arguments)}};var O=K.xhr=c.ajax(G.extend(P,K));L.trigger("request",L,O,K);return O};var u={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};c.ajax=function(){return c.$.ajax.apply(c.$,arguments)};var F=c.Router=function(J){J||(J={});if(J.routes){this.routes=J.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var l=/\((.*?)\)/g;var k=/(\(\?)?:\w+/g;var E=/\*\w+/g;var f=/[\-{}\[\]+?.,\\\^$|#\s]/g;G.extend(F.prototype,p,{initialize:function(){},route:function(K,L,M){if(!G.isRegExp(K)){K=this._routeToRegExp(K)}if(G.isFunction(L)){M=L;L=""}if(!M){M=this[L]}var J=this;c.history.route(K,function(O){var N=J._extractParameters(K,O);if(J.execute(M,N,L)!==false){J.trigger.apply(J,["route:"+L].concat(N));J.trigger("route",L,N);c.history.trigger("route",J,L,N)}});return this},execute:function(L,K,J){if(L){L.apply(this,K)}},navigate:function(K,J){c.history.navigate(K,J);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=G.result(this,"routes");var K,J=G.keys(this.routes);while((K=J.pop())!=null){this.route(K,this.routes[K])}},_routeToRegExp:function(J){J=J.replace(f,"\\$&").replace(l,"(?:$1)?").replace(k,function(L,K){return K?L:"([^/?]+)"}).replace(E,"([^?]*?)");return new RegExp("^"+J+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(J,K){var L=J.exec(K).slice(1);return G.map(L,function(N,M){if(M===L.length-1){return N||null}return N?decodeURIComponent(N):null})}});var b=c.History=function(){this.handlers=[];G.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var o=/^[#\/]|\s+$/g;var B=/^\/+|\/+$/g;var v=/#.*$/;b.started=false;G.extend(b.prototype,p,{interval:50,atRoot:function(){var J=this.location.pathname.replace(/[^\/]$/,"$&/");return J===this.root&&!this.location.search},getHash:function(K){var J=(K||this).location.href.match(/#(.*)$/);return J?J[1]:""},getPath:function(){var K=decodeURI(this.location.pathname+this.location.search);var J=this.root.slice(0,-1);if(!K.indexOf(J)){K=K.slice(J.length)}return K.slice(1)},getFragment:function(J){if(J==null){if(this._hasPushState||!this._wantsHashChange){J=this.getPath()}else{J=this.getHash()}}return J.replace(o,"")},start:function(K){if(b.started){throw new Error("Backbone.history has already been started")}b.started=true;this.options=G.extend({root:"/"},this.options,K);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._hasHashChange="onhashchange" in window;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);this.fragment=this.getFragment();var M=window.addEventListener||function(N,O){return attachEvent("on"+N,O)};this.root=("/"+this.root+"/").replace(B,"/");if(!this._hasHashChange&&this._wantsHashChange&&(!this._wantsPushState||!this._hasPushState)){var L=document.createElement("iframe");L.src="javascript:0";L.style.display="none";L.tabIndex=-1;var J=document.body;this.iframe=J.insertBefore(L,J.firstChild).contentWindow;this.navigate(this.fragment)}if(this._hasPushState){M("popstate",this.checkUrl,false)}else{if(this._wantsHashChange&&this._hasHashChange&&!this.iframe){M("hashchange",this.checkUrl,false)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){this.location.replace(this.root+"#"+this.getPath());return true}else{if(this._hasPushState&&this.atRoot()){this.navigate(this.getHash(),{replace:true})}}}if(!this.options.silent){return this.loadUrl()}},stop:function(){var J=window.removeEventListener||function(K,L){return detachEvent("on"+K,L)};if(this._hasPushState){J("popstate",this.checkUrl,false)}else{if(this._wantsHashChange&&this._hasHashChange&&!this.iframe){J("hashchange",this.checkUrl,false)}}if(this.iframe){document.body.removeChild(this.iframe.frameElement);this.iframe=null}if(this._checkUrlInterval){clearInterval(this._checkUrlInterval)}b.started=false},route:function(J,K){this.handlers.unshift({route:J,callback:K})},checkUrl:function(K){var J=this.getFragment();if(J===this.fragment&&this.iframe){J=this.getHash(this.iframe)}if(J===this.fragment){return false}if(this.iframe){this.navigate(J)}this.loadUrl()},loadUrl:function(J){J=this.fragment=this.getFragment(J);return G.any(this.handlers,function(K){if(K.route.test(J)){K.callback(J);return true}})},navigate:function(L,K){if(!b.started){return false}if(!K||K===true){K={trigger:!!K}}var J=this.root+(L=this.getFragment(L||""));L=decodeURI(L.replace(v,""));if(this.fragment===L){return}this.fragment=L;if(L===""&&J!=="/"){J=J.slice(0,-1)}if(this._hasPushState){this.history[K.replace?"replaceState":"pushState"]({},document.title,J)}else{if(this._wantsHashChange){this._updateHash(this.location,L,K.replace);if(this.iframe&&(L!==this.getHash(this.iframe))){if(!K.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,L,K.replace)}}else{return this.location.assign(J)}}if(K.trigger){return this.loadUrl(L)}},_updateHash:function(J,L,M){if(M){var K=J.href.replace(/(javascript:|#).*$/,"");J.replace(K+"#"+L)}else{J.hash="#"+L}}});c.history=new b;var A=function(J,L){var K=this;var N;if(J&&G.has(J,"constructor")){N=J.constructor}else{N=function(){return K.apply(this,arguments)}}G.extend(N,K,L);var M=function(){this.constructor=N};M.prototype=K.prototype;N.prototype=new M;if(J){G.extend(N.prototype,J)}N.__super__=K.prototype;return N};m.extend=H.extend=F.extend=w.extend=b.extend=A;var x=function(){throw new Error('A "url" property or function must be specified')};var e=function(L,K){var J=K.error;K.error=function(M){if(J){J(L,M,K)}L.trigger("error",L,M,K)}};return c}));if(typeof Backbone!=="undefined"){var backboneTCVersion=Backbone.noConflict();define("tc-backbone",["underscore"],function(){return backboneTCVersion})};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:amd', location = '/com/atlassian/confluence/extra/calendar3/lib/amd/shim/wrm-amd.js' */
define("wrm",function(){return WRM});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:calendar-init-common', location = 'com/atlassian/confluence/extra/calendar3/components/initialiser/init-resources.js' */
define("tc/init-resources",["wrm","jquery"],function(a,c){var b=function(d){return d.removeClass("spinner").removeClass("aui-icon").removeClass("aui-icon-wait")};return{requireResources:function(){a.require(["wrc!com.atlassian.confluence.extra.team-calendars.resources-batch"],function(){b(c("div.plugin-calendar"));require(["tc/calendar-plugin"],function(d){d.onTeamCalendarsLoaded()})}).fail(function(){b(c("div.plugin-calendar")).text("Failed to load calendar resources")})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:calendar-init', location = 'com/atlassian/confluence/extra/calendar3/components/initialiser/initialiser.js' */
require(["ajs","tc/init-resources"],function(a,b){var d=function(e){e("calendar-container",{type:e.types.CLASS,attached:function(){b.requireResources()},create:function(){b.requireResources()},ready:function(){b.requireResources()}})};var c=a.Meta.get("version-number").split(".");if(c[0]==="5"&&c[1]<9){d(window.skate)}else{require(["skate"],function(e){d(e)})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.macros.advanced:blog-post-resources', location = 'com/atlassian/confluence/plugins/macros/advanced/blog-posts.js' */
jQuery(function(a){a(".macro-blank-experience .create-post").bind("click",function(){var b=AJS.Meta.get("base-url")+"/pages/createblogpost.action?spaceKey="+AJS.Meta.get("space-key");window.location=b})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.macros.multimedia:flash-autosize', location = 'javascript/flash-autosize.js' */
AJS.toInit(function(b){function a(e,d){var c;if(d>=20){AJS.log("unable to auto size flash - took too long to load");return}c=b([]);e.each(function(){var g=b(this);var i;var f;if(this.GetVariable){if(!g.attr("height")){i=this.GetVariable("height");if(i){g.height(i)}else{c=c.add(g);return}}if(!g.attr("width")){f=this.GetVariable("width");if(f){g.width(f)}else{c=c.add(g);return}}}});if(c.length){setTimeout(function(){a(c,d+1)},100)}}a(b('embed[type="application/x-shockwave-flash"]'),0);b(window).bind("render-content-loaded",function(d,c){a(b('embed[type="application/x-shockwave-flash"]',c),0)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.view-source:view-source-menu-resources', location = 'com/atlassian/confluence/plugins/viewsource/js/viewsource.js' */
define("confluence-view-source/viewsource",["jquery","window"],function(a,b){return function(){a("#action-view-source-link").click(function(a){b.open(this.href,(this.id+"-popupwindow").replace(/-/g,"_"),"width=800, height=600, scrollbars, resizable");a.preventDefault();return!1})}});require("confluence/module-exporter").safeRequire("confluence-view-source/viewsource",function(a){require("ajs").toInit(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.view-storage-format:view-storage-menu-resources', location = 'com/atlassian/confluence/plugins/viewstorage/js/viewstorage.js' */
AJS.toInit(function(a){a(".view-storage-link, .view-storage-link a").click(function(b){window.open(this.href,(this.id+"-popupwindow").replace(/-/g,"_"),"width=800, height=600, scrollbars, resizable");b.preventDefault();return false})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/easyforms-capture.js' */
window.easyforms={};easyforms.__ojq=window.jQuery;easyforms.__o$=window.$;easyforms.__ou=window._;easyforms.__obb=window.Backbone;
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/jquery.js' */
var Node=Node||{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3};
/*!
 * jQuery JavaScript Library v2.0.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03T13:30Z
 */
(function(window,undefined){var rootjQuery,readyList,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="2.0.3",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()},completed=function(){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false);jQuery.ready()};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem;if(!selector){return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match])}else{this.attr(match,context[match])}}}return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else{if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}}else{if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}else{if(jQuery.isFunction(selector)){return rootjQuery.ready(selector)}}}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(num){return num==null?this.toArray():(num<0?this[this.length+num]:this[num])},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.ready.promise().done(fn);return this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else{if(copy!==undefined){target[name]=copy}}}}}return target};jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready")}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray,isWindow:function(obj){return obj!=null&&obj===obj.window},isNumeric:function(obj){return !isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){if(obj==null){return String(obj)}return typeof obj==="object"||typeof obj==="function"?class2type[core_toString.call(obj)]||"object":typeof obj},isPlainObject:function(obj){if(jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}try{if(obj.constructor&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}return true},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},error:function(msg){throw new Error(msg)},parseHTML:function(data,context,keepScripts){if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){keepScripts=context;context=false}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}parsed=jQuery.buildFragment([data],context,scripts);if(scripts){jQuery(scripts).remove()}return jQuery.merge([],parsed.childNodes)},parseJSON:JSON.parse,parseXML:function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml")}catch(e){xml=undefined}if(!xml||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml},noop:function(){},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code);if(code){if(code.indexOf("use strict")===1){script=document.createElement("script");script.text=code;document.head.appendChild(script).parentNode.removeChild(script)}else{indirect(code)}}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}}return obj},trim:function(text){return text==null?"":core_trim.call(text)},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{core_push.call(ret,arr)}}return ret},inArray:function(elem,arr,i){return arr==null?-1:core_indexOf.call(arr,elem,i)},merge:function(first,second){var l=second.length,i=first.length,j=0;if(typeof l==="number"){for(;j<l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;inv=!!inv;for(;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i])}}return ret},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}return core_concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}args=core_slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(core_slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},access:function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw)}}else{if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true}if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}if(fn){for(;i<length;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}}return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:Date.now,swap:function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}return ret}});jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready)}else{document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false)}}return readyList.promise(obj)};jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(jQuery.isWindow(obj)){return false}if(obj.nodeType===1&&length){return true}return type==="array"||type!=="function"&&(length===0||typeof length==="number"&&length>0&&(length-1) in obj)}rootjQuery=jQuery(document);
/*!
   * Sizzle CSS Selector Engine v1.9.4-pre
   * http://sizzlejs.com/
   *
   * Copyright 2013 jQuery Foundation, Inc. and other contributors
   * Released under the MIT license
   * http://jquery.org/license
   *
   * Date: 2013-06-03
   */
(function(window,undefined){var i,support,cachedruns,Expr,getText,isXML,compile,outermostContext,sortInput,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-(new Date()),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),hasDuplicate=false,sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i}}return -1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rsibling=new RegExp(whitespace+"*[+~]"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)};try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[]}if(documentIsHTML&&!seed){if((match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else{if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else{if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&context.parentNode||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+=" ")>Expr.cacheLength){delete cache[keys.shift()]}return(cache[key]=value)}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var div=document.createElement("div");try{return !!fn(div)}catch(e){return false}finally{if(div.parentNode){div.parentNode.removeChild(div)}div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while((cur=cur.nextSibling)){if(cur===b){return -1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j])}}})})}isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};support=Sizzle.support={};setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent.attachEvent&&parent!==parent.top){parent.attachEvent("onbeforeunload",function(){setDocument()})}support.attributes=assert(function(div){div.className="i";return !div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return !div.getElementsByTagName("*").length});support.getElementsByClassName=assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return !doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find.ID;Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){div.innerHTML="<select><option selected=''></option></select>";if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("t","");if(div.querySelectorAll("[t^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if((support.matchesSelector=rnative.test((matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));contains=rnative.test(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true}}}return false};sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);if(compare){if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||contains(preferredDoc,a)){return -1}if(b===doc||contains(preferredDoc,b)){return 1}return sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0}return compare&4?-1:1}return a.compareDocumentPosition?-1:1}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b){hasDuplicate=true;return 0}else{if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0}else{if(aup===bup){return siblingCheck(a,b)}}}cur=a;while((cur=cur.parentNode)){ap.unshift(cur)}cur=b;while((cur=cur.parentNode)){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val===undefined?support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null:val};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){for(;(node=elem[i]);i++){ret+=getText(node)}}else{if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else{if(nodeType===3||nodeType===4){return elem.nodeValue}}}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd")}else{if(match[3]){Sizzle.error(match[0])}}return match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];if(matchExpr.CHILD.test(match[0])){return null}if(match[3]&&match[4]!==undefined){match[2]=match[4]}else{if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return !!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else{if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}}diff-=last;return diff===first||(diff%first===0&&diff/first>=0)}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return !results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected)},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeName>"@"||elem.nodeType===3||elem.nodeType===4){return false}}return true},parent:function(elem){return !Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()===elem.type)},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos.nth=Expr.pseudos.eq;for(i in {radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in {submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===true||data===cachedruns){return data===true}}else{cache=outerCache[dir]=[dirkey];cache[1]=matcher(elem,context,xml)||cachedruns;if(cache[1]===true){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem))}}postFinder(null,(matcherOut=[]),temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){return(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=expandContext!=null,contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",expandContext&&context.parentNode||context),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1);if(outermost){outermostContext=context!==document&&context;cachedruns=matcherCachedRuns}for(;(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique;cachedruns=++matcherCachedRuns}}if(bySet){if((elem=!matcher&&elem)){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!group){group=tokenize(selector)}i=group.length;while(i--){cached=matcherFromTokens(group[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached};function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed){if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}selector=selector.slice(tokens.shift().value.length)}i=matchExpr.needsContext.test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break}if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}}compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector));return results}support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return(val=elem.getAttributeNode(name))&&val.specified?val.value:elem[name]===true?name.toLowerCase():null}})}jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})(window);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?(optionsCache[options]||createOptions(options)):jQuery.extend({},options);var memory,fired,firing,firingStart,firingLength,firingIndex,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift())}}else{if(memory){list=[]}else{self.disable()}}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)}}else{if(arg&&arg.length&&type!=="string"){add(arg)}}})})(arguments);if(firing){firingLength=list.length}else{if(memory){firingStart=start;fire(memory)}}}return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}if(index<=firingIndex){firingIndex--}}}})}return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)},empty:function(){list=[];firingLength=0;return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return !list},lock:function(){stack=undefined;if(!memory){self.disable()}return this},locked:function(){return !stack},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args)}else{fire(args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return !!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)}})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(subordinate){var i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?core_slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else{if(!(--remaining)){deferred.resolveWith(contexts,values)}}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}return deferred.promise()}});jQuery.support=(function(support){var input=document.createElement("input"),fragment=document.createDocumentFragment(),div=document.createElement("div"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));if(!input.type){return support}input.type="checkbox";support.checkOn=input.value!=="";support.optSelected=opt.selected;support.reliableMarginRight=true;support.boxSizingReliable=true;support.pixelPosition=false;input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t";input.setAttribute("checked","t");input.setAttribute("name","t");fragment.appendChild(input);support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;support.focusinBubbles="onfocusin" in window;div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";jQuery(function(){var container,marginDiv,divReset="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",body=document.getElementsByTagName("body")[0];if(!body){return}container=document.createElement("div");container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";body.appendChild(container).appendChild(div);div.innerHTML="";div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%";jQuery.swap(body,body.style.zoom!=null?{zoom:1}:{},function(){support.boxSizing=div.offsetWidth===4});if(window.getComputedStyle){support.pixelPosition=(window.getComputedStyle(div,null)||{}).top!=="1%";support.boxSizingReliable=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText=divReset;marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight)}body.removeChild(container)});return support})({});var data_user,data_priv,rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=jQuery.expando+Math.random()}Data.uid=1;Data.accepts=function(owner){return owner.nodeType?owner.nodeType===1||owner.nodeType===9:true};Data.prototype={key:function(owner){if(!Data.accepts(owner)){return 0}var descriptor={},unlock=owner[this.expando];if(!unlock){unlock=Data.uid++;try{descriptor[this.expando]={value:unlock};Object.defineProperties(owner,descriptor)}catch(e){descriptor[this.expando]=unlock;jQuery.extend(owner,descriptor)}}if(!this.cache[unlock]){this.cache[unlock]={}}return unlock},set:function(owner,data,value){var prop,unlock=this.key(owner),cache=this.cache[unlock];if(typeof data==="string"){cache[data]=value}else{if(jQuery.isEmptyObject(cache)){jQuery.extend(this.cache[unlock],data)}else{for(prop in data){cache[prop]=data[prop]}}}return cache},get:function(owner,key){var cache=this.cache[this.key(owner)];return key===undefined?cache:cache[key]},access:function(owner,key,value){var stored;if(key===undefined||((key&&typeof key==="string")&&value===undefined)){stored=this.get(owner,key);return stored!==undefined?stored:this.get(owner,jQuery.camelCase(key))}this.set(owner,key,value);return value!==undefined?value:key},remove:function(owner,key){var i,name,camel,unlock=this.key(owner),cache=this.cache[unlock];if(key===undefined){this.cache[unlock]={}}else{if(jQuery.isArray(key)){name=key.concat(key.map(jQuery.camelCase))}else{camel=jQuery.camelCase(key);if(key in cache){name=[key,camel]}else{name=camel;name=name in cache?[name]:(name.match(core_rnotwhite)||[])}}i=name.length;while(i--){delete cache[name[i]]}}},hasData:function(owner){return !jQuery.isEmptyObject(this.cache[owner[this.expando]]||{})},discard:function(owner){if(owner[this.expando]){delete this.cache[owner[this.expando]]}}};data_user=new Data();data_priv=new Data();jQuery.extend({acceptData:Data.accepts,hasData:function(elem){return data_user.hasData(elem)||data_priv.hasData(elem)},data:function(elem,name,data){return data_user.access(elem,name,data)},removeData:function(elem,name){data_user.remove(elem,name)},_data:function(elem,name,data){return data_priv.access(elem,name,data)},_removeData:function(elem,name){data_priv.remove(elem,name)}});jQuery.fn.extend({data:function(key,value){var attrs,name,elem=this[0],i=0,data=null;if(key===undefined){if(this.length){data=data_user.get(elem);if(elem.nodeType===1&&!data_priv.get(elem,"hasDataAttrs")){attrs=elem.attributes;for(;i<attrs.length;i++){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}data_priv.set(elem,"hasDataAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){data_user.set(this,key)})}return jQuery.access(this,function(value){var data,camelKey=jQuery.camelCase(key);if(elem&&value===undefined){data=data_user.get(elem,key);if(data!==undefined){return data}data=data_user.get(elem,camelKey);if(data!==undefined){return data}data=dataAttr(elem,camelKey,undefined);if(data!==undefined){return data}return}this.each(function(){var data=data_user.get(this,camelKey);data_user.set(this,camelKey,value);if(key.indexOf("-")!==-1&&data!==undefined){data_user.set(this,key,value)}})},null,value,arguments.length>1,null,true)},removeData:function(key){return this.each(function(){data_user.remove(this,key)})}});function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?JSON.parse(data):data}catch(e){}data_user.set(elem,key,data)}else{data=undefined}}return data}jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=data_priv.get(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=data_priv.access(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return data_priv.get(elem,key)||data_priv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(elem,[type+"queue",key])})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=data_priv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var nodeHook,boolHook,rclass=/[\t\r\n\f]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})},addClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(core_rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}elem.className=jQuery.trim(cur)}}}return this},removeClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(core_rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")}}elem.className=value?jQuery.trim(cur):""}}}return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(core_rnotwhite)||[];while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else{if(type===core_strundefined||type==="boolean"){if(this.className){data_priv.set(this,"__className__",this.className)}this.className=this.className||value===false?"":data_priv.get(this,"__className__")||""}}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true}}return false},val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get" in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}if(val==null){val=""}else{if(typeof val==="number"){val+=""}else{if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}}}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set" in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return !val||val.specified?elem.value:elem.text}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if((option.selected=jQuery.inArray(jQuery(option).val(),values)>=0)){optionSet=true}}if(!optionSet){elem.selectedIndex=-1}return values}}},attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(typeof elem.getAttribute===core_strundefined){return jQuery.prop(elem,name,value)}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)}else{if(hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,value+"");return value}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret}}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(core_rnotwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){elem[propName]=false}elem.removeAttribute(name)}}},attrHooks:{type:{set:function(elem,value){if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){return hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem[name]=value)}else{return hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){return elem.hasAttribute("tabindex")||rfocusable.test(elem.nodeName)||elem.href?elem.tabIndex:-1}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)}else{elem.setAttribute(name,name)}return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=jQuery.expr.attrHandle[name]||jQuery.find.attr;jQuery.expr.attrHandle[name]=function(elem,name,isXML){var fn=jQuery.expr.attrHandle[name],ret=isXML?undefined:(jQuery.expr.attrHandle[name]=undefined)!=getter(elem,name,isXML)?name.toLowerCase():null;jQuery.expr.attrHandle[name]=fn;return ret}});if(!jQuery.support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent&&parent.parentNode){parent.parentNode.selectedIndex}return null}}}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0)}}};if(!jQuery.support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.get(elem);if(!elemData){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}if(!(events=elemData.events)){events=elemData.events={}}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==core_strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}types=(types||"").match(core_rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}elem=null},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=data_priv.hasData(elem)&&data_priv.get(elem);if(!elemData||!(events=elemData.events)){return}types=(types||"").match(core_rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){delete elemData.handle;data_priv.remove(elem,"events")}},trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=core_hasOwn.call(event,"type")?event.type:event,namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(data_priv.get(cur,"events")||{})[event.type]&&data_priv.get(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===false){event.preventDefault()}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=core_slice.call(arguments),handlers=(data_priv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!==this;cur=cur.parentNode||this){if(cur.disabled!==true||event.type!=="click"){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length}if(matches[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches})}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})}return handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)))}return event}},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}if(!event.target){event.target=document}if(event.target.nodeType===3){event.target=event.target.parentNode}return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input")){this.click();return false}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined){event.originalEvent.returnValue=event.result}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=(src.defaultPrevented||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e&&e.preventDefault){e.preventDefault()}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(e&&e.stopPropagation){e.stopPropagation()}},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true)}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else{if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}}if(fn===false){fn=returnFalse}else{if(!fn){return this}}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true)}}});var isSimple=/^.[^:#\[\.,]*$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true}}}))}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++){if(jQuery.contains(this,targets[i])){return true}}})},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},is:function(selector){return !!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=(rneedsContext.test(selectors)||typeof selectors!=="string")?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){cur=matched.push(cur);break}}}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1}if(typeof elem==="string"){return core_indexOf.call(jQuery(elem),this[0])}return core_indexOf.call(this,elem.jquery?elem[0]:elem)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(jQuery.unique(all))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1){}return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}if(selector&&typeof selector==="string"){matched=jQuery.filter(selector,matched)}if(this.length>1){if(!guaranteedUnique[name]){jQuery.unique(matched)}if(rparentsprev.test(name)){matched.reverse()}}return this.pushStack(matched)}});jQuery.extend({filter:function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))},dir:function(elem,dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[dir])&&elem.nodeType!==9){if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until)){break}matched.push(elem)}}return matched},sibling:function(n,elem){var matched=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){matched.push(n)}}return matched}});function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return !!qualifier.call(elem,i,elem)!==not})}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not})}if(typeof qualifier==="string"){if(isSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)}qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return(core_indexOf.call(qualifier,elem)>=0)!==not})}var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))}elem.parentNode.removeChild(elem)}}return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent=""}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1){return elem.innerHTML}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var args=jQuery.map(this,function(elem){return[elem.nextSibling,elem.parentNode]}),i=0;this.domManip(arguments,function(elem){var next=args[i++],parent=args[i++];if(parent){if(next&&next.parentNode!==parent){next=this.nextSibling}jQuery(this).remove();parent.insertBefore(elem,next)}},true);return i?this:this.remove()},detach:function(selector){return this.remove(selector,true)},domManip:function(args,callback,allowIntersection){args=core_concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||!(l<=1||typeof value!=="string"||jQuery.support.checkClone||!rchecked.test(value))){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html())}self.domManip(args,callback,allowIntersection)})}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,!allowIntersection&&this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}callback.call(this[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!data_priv.access(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){jQuery._evalUrl(node.src)}else{jQuery.globalEval(node.textContent.replace(rcleanScript,""))}}}}}}return this}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);core_push.apply(ret,elems.get())}return this.pushStack(ret)}});jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=jQuery.contains(elem.ownerDocument,elem);if(!jQuery.support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++){fixInput(srcElements[i],destElements[i])}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++){cloneCopyEvent(srcElements[i],destElements[i])}}else{cloneCopyEvent(elem,clone)}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}return clone},buildFragment:function(elems,context,scripts,selection){var elem,tmp,tag,wrap,contains,j,i=0,l=elems.length,fragment=context.createDocumentFragment(),nodes=[];for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else{if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent=""}}}}fragment.textContent="";i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)!==-1){continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(fragment.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}return fragment},cleanData:function(elems){var data,elem,events,type,key,j,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++){if(Data.accepts(elem)){key=elem[data_priv.expando];if(key&&(data=data_priv.cache[key])){events=Object.keys(data.events||{});if(events.length){for(j=0;(type=events[j])!==undefined;j++){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}if(data_priv.cache[key]){delete data_priv.cache[key]}}}delete data_user.cache[elem[data_user.expando]]}},_evalUrl:function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true})}});function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType===1?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1]}else{elem.removeAttribute("type")}return elem}function setGlobalEval(elems,refElements){var l=elems.length,i=0;for(;i<l;i++){data_priv.set(elems[i],"globalEval",!refElements||data_priv.get(refElements[i],"globalEval"))}}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(dest.nodeType!==1){return}if(data_priv.hasData(src)){pdataOld=data_priv.access(src);pdataCur=data_priv.set(dest,pdataOld);events=pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}}if(data_user.hasData(src)){udataOld=data_user.access(src);udataCur=jQuery.extend({},udataOld);data_user.set(dest,udataCur)}}function getAll(context,tag){var ret=context.getElementsByTagName?context.getElementsByTagName(tag||"*"):context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&manipulation_rcheckableType.test(src.type)){dest.checked=src.checked}else{if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}}jQuery.fn.extend({wrapAll:function(html){var wrap;if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstElementChild){elem=elem.firstElementChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()}});var curCSS,iframe,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name}var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName}function isHidden(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)}function getStyles(elem){return window.getComputedStyle(elem,null)}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}values[index]=data_priv.get(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display=""}if(elem.style.display===""&&isHidden(elem)){values[index]=data_priv.access(elem,"olddisplay",css_defaultDisplay(elem.nodeName))}}else{if(!values[index]){hidden=isHidden(elem);if(display&&display!=="none"||!hidden){data_priv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}return elements}jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)}return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}return this.each(function(){if(isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||type==="number"&&isNaN(value)){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!jQuery.support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}if(!hooks||!("set" in hooks)||(value=hooks.set(elem,value,extra))!==undefined){style[name]=value}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get" in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name,styles)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val}return val}});curCSS=function(elem,name,_computed){var width,minWidth,maxWidth,computed=_computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,style=elem.style;if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret};function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles)}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]);val=parseFloat(val)||0}return(val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles))+"px"}function css_defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(doc.documentElement);doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;doc.write("<!doctype html><html><body>");doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");elem.remove();return display}jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return elem.offsetWidth===0&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0)}}});jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){if(computed){return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}}}}if(!jQuery.support.pixelPosition&&jQuery.fn.position){jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}}}})}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0};jQuery.expr.filters.visible=function(elem){return !jQuery.expr.filters.hidden(elem)}}jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!manipulation_rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():(value==null?"":value);s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")};function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else{if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}}jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(func)){while((dataType=dataTypes[i++])){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else{if(seekingTransport){return !(selected=dataTypeOrTransport)}}});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}return target}jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}var selector,type,response,self=this,off=url.indexOf(" ");if(off>=0){selector=url.slice(off);url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=undefined}else{if(params&&typeof params==="object"){type="POST"}}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])})}return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,parts,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]}}else{jqXHR.always(map[jqXHR.status])}}return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}fireGlobals=s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=(s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data);delete s.data}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+ajax_nonce++):cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()}strAbort="abort";for(i in {success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}if(status===204||s.type==="HEAD"){statusText="nocontent"}else{if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop")}}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}});function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0] in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else{if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else{if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}}break}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}}return{state:"success",data:response}}jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET"}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({async:true,charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();callback=null;if(evt){complete(evt.type==="error"?404:200,evt.type)}});document.head.appendChild(script[0])},abort:function(){if(callback){callback()}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(ajax_nonce++));this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else{if(s.jsonp!==false){s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest()}catch(e){}};var xhrSupported=jQuery.ajaxSettings.xhr(),xhrSuccessStatus={0:200,1223:204},xhrId=0,xhrCallbacks={};if(window.ActiveXObject){jQuery(window).on("unload",function(){for(var key in xhrCallbacks){xhrCallbacks[key]()}xhrCallbacks=undefined})}jQuery.support.cors=!!xhrSupported&&("withCredentials" in xhrSupported);jQuery.support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback;if(jQuery.support.cors||xhrSupported&&!options.crossDomain){return{send:function(headers,complete){var i,id,xhr=options.xhr();xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i]}}if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType)}if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}for(i in headers){xhr.setRequestHeader(i,headers[i])}callback=function(type){return function(){if(callback){delete xhrCallbacks[id];callback=xhr.onload=xhr.onerror=null;if(type==="abort"){xhr.abort()}else{if(type==="error"){complete(xhr.status||404,xhr.statusText)}else{complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,typeof xhr.responseText==="string"?{text:xhr.responseText}:undefined,xhr.getAllResponseHeaders())}}}}};xhr.onload=callback();xhr.onerror=callback("error");callback=xhrCallbacks[(id=xhrId++)]=callback("abort");xhr.send(options.hasContent&&options.data||null)},abort:function(){if(callback){callback()}}}}});var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit)}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)}if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]}return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined});return(fxNow=jQuery.now())}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return false}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}stopped=true;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand" in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=data_priv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}if(elem.nodeType===1&&("height" in props||"width" in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];if(jQuery.css(elem,"display")==="inline"&&jQuery.css(elem,"float")==="none"){style.display="inline-block"}}if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true}else{continue}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden" in dataShow){hidden=dataShow.hidden}}else{dataShow=data_priv.access(elem,"fxshow",{})}if(toggle){dataShow.hidden=!hidden}if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}anim.done(function(){var prop;data_priv.remove(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,"");return !result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else{if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||data_priv.get(this,"finish")){anim.stop(true)}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=data_priv.get(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==false){type=type||"fx"}return this.each(function(){var index,data=data_priv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true)}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}delete data.finish})}});function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.easing={linear:function(p){return p},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2}};jQuery.timers=[];jQuery.fx=Tween.prototype.init;jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}fxNow=undefined};jQuery.fx.timer=function(timer){if(timer()&&jQuery.timers.push(timer)){jQuery.fx.start()}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fx.step={};if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}}jQuery.fn.offset=function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(!doc){return}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box}if(typeof elem.getBoundingClientRect!==core_strundefined){box=elem.getBoundingClientRect()}win=getWindow(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}};jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative"}curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=(options.top-curOffset.top)+curTop}if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft}if("using" in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({position:function(){if(!this[0]){return}var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent||docElem})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?win[prop]:elem[method]}if(win){win.scrollTo(!top?val:window.pageXOffset,top?val:window.pageYOffset)}else{elem[method]=val}},method,val,arguments.length,null)}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9&&elem.defaultView}jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.size=function(){return this.length};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=jQuery}else{if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery})}}if(typeof window==="object"&&typeof window.document==="object"){window.jQuery=window.$=jQuery}})(window);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/jquery.ui.js' */
/*!
 * jQuery UI Core 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
(function(b,f){var a=0,e=/^ui-id-\d+$/;b.ui=b.ui||{};b.extend(b.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});b.fn.extend({focus:(function(g){return function(h,i){return typeof h==="number"?this.each(function(){var j=this;setTimeout(function(){b(j).focus();if(i){i.call(j)}},h)}):g.apply(this,arguments)}})(b.fn.focus),scrollParent:function(){var g;if((b.ui.ie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){g=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(b.css(this,"position"))&&(/(auto|scroll)/).test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0)}else{g=this.parents().filter(function(){return(/(auto|scroll)/).test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0)}return(/fixed/).test(this.css("position"))||!g.length?b(document):g},zIndex:function(j){if(j!==f){return this.css("zIndex",j)}if(this.length){var h=b(this[0]),g,i;while(h.length&&h[0]!==document){g=h.css("position");if(g==="absolute"||g==="relative"||g==="fixed"){i=parseInt(h.css("zIndex"),10);if(!isNaN(i)&&i!==0){return i}}h=h.parent()}}return 0},uniqueId:function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++a)}})},removeUniqueId:function(){return this.each(function(){if(e.test(this.id)){b(this).removeAttr("id")}})}});function d(i,g){var k,j,h,l=i.nodeName.toLowerCase();if("area"===l){k=i.parentNode;j=k.name;if(!i.href||!j||k.nodeName.toLowerCase()!=="map"){return false}h=b("img[usemap=#"+j+"]")[0];return !!h&&c(h)}return(/input|select|textarea|button|object/.test(l)?!i.disabled:"a"===l?i.href||g:g)&&c(i)}function c(g){return b.expr.filters.visible(g)&&!b(g).parents().addBack().filter(function(){return b.css(this,"visibility")==="hidden"}).length}b.extend(b.expr[":"],{data:b.expr.createPseudo?b.expr.createPseudo(function(g){return function(h){return !!b.data(h,g)}}):function(j,h,g){return !!b.data(j,g[3])},focusable:function(g){return d(g,!isNaN(b.attr(g,"tabindex")))},tabbable:function(i){var g=b.attr(i,"tabindex"),h=isNaN(g);return(h||g>=0)&&d(i,!h)}});if(!b("<a>").outerWidth(1).jquery){b.each(["Width","Height"],function(j,g){var h=g==="Width"?["Left","Right"]:["Top","Bottom"],k=g.toLowerCase(),m={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,outerWidth:b.fn.outerWidth,outerHeight:b.fn.outerHeight};function l(o,n,i,p){b.each(h,function(){n-=parseFloat(b.css(o,"padding"+this))||0;if(i){n-=parseFloat(b.css(o,"border"+this+"Width"))||0}if(p){n-=parseFloat(b.css(o,"margin"+this))||0}});return n}b.fn["inner"+g]=function(i){if(i===f){return m["inner"+g].call(this)}return this.each(function(){b(this).css(k,l(this,i)+"px")})};b.fn["outer"+g]=function(i,n){if(typeof i!=="number"){return m["outer"+g].call(this,i)}return this.each(function(){b(this).css(k,l(this,i,true,n)+"px")})}})}if(!b.fn.addBack){b.fn.addBack=function(g){return this.add(g==null?this.prevObject:this.prevObject.filter(g))}}if(b("<a>").data("a-b","a").removeData("a-b").data("a-b")){b.fn.removeData=(function(g){return function(h){if(arguments.length){return g.call(this,b.camelCase(h))}else{return g.call(this)}}})(b.fn.removeData)}b.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());b.support.selectstart="onselectstart" in document.createElement("div");b.fn.extend({disableSelection:function(){return this.bind((b.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(g){g.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});b.extend(b.ui,{plugin:{add:function(h,j,l){var g,k=b.ui[h].prototype;for(g in l){k.plugins[g]=k.plugins[g]||[];k.plugins[g].push([j,l[g]])}},call:function(g,j,h){var k,l=g.plugins[j];if(!l||!g.element[0].parentNode||g.element[0].parentNode.nodeType===11){return}for(k=0;k<l.length;k++){if(g.options[l[k][0]]){l[k][1].apply(g.element,h)}}}},hasScroll:function(j,h){if(b(j).css("overflow")==="hidden"){return false}var g=(h&&h==="left")?"scrollLeft":"scrollTop",i=false;if(j[g]>0){return true}j[g]=1;i=(j[g]>0);j[g]=0;return i}})})(jQuery);
/*!
 * jQuery UI Widget 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
(function(b,e){var a=0,d=Array.prototype.slice,c=b.cleanData;b.cleanData=function(f){for(var g=0,h;(h=f[g])!=null;g++){try{b(h).triggerHandler("remove")}catch(j){}}c(f)};b.widget=function(f,g,n){var k,l,i,m,h={},j=f.split(".")[0];f=f.split(".")[1];k=j+"-"+f;if(!n){n=g;g=b.Widget}b.expr[":"][k.toLowerCase()]=function(o){return !!b.data(o,k)};b[j]=b[j]||{};l=b[j][f];i=b[j][f]=function(o,p){if(!this._createWidget){return new i(o,p)}if(arguments.length){this._createWidget(o,p)}};b.extend(i,l,{version:n.version,_proto:b.extend({},n),_childConstructors:[]});m=new g();m.options=b.widget.extend({},m.options);b.each(n,function(p,o){if(!b.isFunction(o)){h[p]=o;return}h[p]=(function(){var q=function(){return g.prototype[p].apply(this,arguments)},r=function(s){return g.prototype[p].apply(this,s)};return function(){var u=this._super,s=this._superApply,t;this._super=q;this._superApply=r;t=o.apply(this,arguments);this._super=u;this._superApply=s;return t}})()});i.prototype=b.widget.extend(m,{widgetEventPrefix:l?(m.widgetEventPrefix||f):f},h,{constructor:i,namespace:j,widgetName:f,widgetFullName:k});if(l){b.each(l._childConstructors,function(p,q){var o=q.prototype;b.widget(o.namespace+"."+o.widgetName,i,q._proto)});delete l._childConstructors}else{g._childConstructors.push(i)}b.widget.bridge(f,i)};b.widget.extend=function(k){var g=d.call(arguments,1),j=0,f=g.length,h,i;for(;j<f;j++){for(h in g[j]){i=g[j][h];if(g[j].hasOwnProperty(h)&&i!==e){if(b.isPlainObject(i)){k[h]=b.isPlainObject(k[h])?b.widget.extend({},k[h],i):b.widget.extend({},i)}else{k[h]=i}}}}return k};b.widget.bridge=function(g,f){var h=f.prototype.widgetFullName||g;b.fn[g]=function(k){var i=typeof k==="string",j=d.call(arguments,1),l=this;k=!i&&j.length?b.widget.extend.apply(null,[k].concat(j)):k;if(i){this.each(function(){var n,m=b.data(this,h);if(!m){return b.error("cannot call methods on "+g+" prior to initialization; attempted to call method '"+k+"'")}if(!b.isFunction(m[k])||k.charAt(0)==="_"){return b.error("no such method '"+k+"' for "+g+" widget instance")}n=m[k].apply(m,j);if(n!==m&&n!==e){l=n&&n.jquery?l.pushStack(n.get()):n;return false}})}else{this.each(function(){var m=b.data(this,h);if(m){m.option(k||{})._init()}else{b.data(this,h,new f(k,this))}})}return l}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(f,g){g=b(g||this.defaultElement||this)[0];this.element=b(g);this.uuid=a++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=b.widget.extend({},this.options,this._getCreateOptions(),f);this.bindings=b();this.hoverable=b();this.focusable=b();if(g!==this){b.data(g,this.widgetFullName,this);this._on(true,this.element,{remove:function(h){if(h.target===g){this.destroy()}}});this.document=b(g.style?g.ownerDocument:g.document||g);this.window=b(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(j,k){var f=j,l,h,g;if(arguments.length===0){return b.widget.extend({},this.options)}if(typeof j==="string"){f={};l=j.split(".");j=l.shift();if(l.length){h=f[j]=b.widget.extend({},this.options[j]);for(g=0;g<l.length-1;g++){h[l[g]]=h[l[g]]||{};h=h[l[g]]}j=l.pop();if(arguments.length===1){return h[j]===e?null:h[j]}h[j]=k}else{if(arguments.length===1){return this.options[j]===e?null:this.options[j]}f[j]=k}}this._setOptions(f);return this},_setOptions:function(f){var g;for(g in f){this._setOption(g,f[g])}return this},_setOption:function(f,g){this.options[f]=g;if(f==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!g).attr("aria-disabled",g);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_on:function(i,h,g){var j,f=this;if(typeof i!=="boolean"){g=h;h=i;i=false}if(!g){g=h;h=this.element;j=this.widget()}else{h=j=b(h);this.bindings=this.bindings.add(h)}b.each(g,function(p,o){function m(){if(!i&&(f.options.disabled===true||b(this).hasClass("ui-state-disabled"))){return}return(typeof o==="string"?f[o]:o).apply(f,arguments)}if(typeof o!=="string"){m.guid=o.guid=o.guid||m.guid||b.guid++}var n=p.match(/^(\w+)\s*(.*)$/),l=n[1]+f.eventNamespace,k=n[2];if(k){j.delegate(k,l,m)}else{h.bind(l,m)}})},_off:function(g,f){f=(f||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;g.unbind(f).undelegate(f)},_delay:function(i,h){function g(){return(typeof i==="string"?f[i]:i).apply(f,arguments)}var f=this;return setTimeout(g,h||0)},_hoverable:function(f){this.hoverable=this.hoverable.add(f);this._on(f,{mouseenter:function(g){b(g.currentTarget).addClass("ui-state-hover")},mouseleave:function(g){b(g.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(f){this.focusable=this.focusable.add(f);this._on(f,{focusin:function(g){b(g.currentTarget).addClass("ui-state-focus")},focusout:function(g){b(g.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(f,g,h){var k,j,i=this.options[f];h=h||{};g=b.Event(g);g.type=(f===this.widgetEventPrefix?f:this.widgetEventPrefix+f).toLowerCase();g.target=this.element[0];j=g.originalEvent;if(j){for(k in j){if(!(k in g)){g[k]=j[k]}}}this.element.trigger(g,h);return !(b.isFunction(i)&&i.apply(this.element[0],[g].concat(h))===false||g.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(g,f){b.Widget.prototype["_"+g]=function(j,i,l){if(typeof i==="string"){i={effect:i}}var k,h=!i?g:i===true||typeof i==="number"?f:i.effect||f;i=i||{};if(typeof i==="number"){i={duration:i}}k=!b.isEmptyObject(i);i.complete=l;if(i.delay){j.delay(i.delay)}if(k&&b.effects&&b.effects.effect[h]){j[g](i)}else{if(h!==g&&j[h]){j[h](i.duration,i.easing,l)}else{j.queue(function(m){b(this)[g]();if(l){l.call(j[0])}m()})}}}})})(jQuery);
/*!
 * jQuery UI Mouse 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(b,c){var a=false;b(document).mouseup(function(){a=false});b.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var d=this;this.element.bind("mousedown."+this.widgetName,function(e){return d._mouseDown(e)}).bind("click."+this.widgetName,function(e){if(true===b.data(e.target,d.widgetName+".preventClickEvent")){b.removeData(e.target,d.widgetName+".preventClickEvent");e.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(f){if(a){return}(this._mouseStarted&&this._mouseUp(f));this._mouseDownEvent=f;var e=this,g=(f.which===1),d=(typeof this.options.cancel==="string"&&f.target.nodeName?b(f.target).closest(this.options.cancel).length:false);if(!g||d||!this._mouseCapture(f)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(f)&&this._mouseDelayMet(f)){this._mouseStarted=(this._mouseStart(f)!==false);if(!this._mouseStarted){f.preventDefault();return true}}if(true===b.data(f.target,this.widgetName+".preventClickEvent")){b.removeData(f.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(h){return e._mouseMove(h)};this._mouseUpDelegate=function(h){return e._mouseUp(h)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);f.preventDefault();a=true;return true},_mouseMove:function(d){if(b.ui.ie&&(!document.documentMode||document.documentMode<9)&&!d.button){return this._mouseUp(d)}if(this._mouseStarted){this._mouseDrag(d);return d.preventDefault()}if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,d)!==false);(this._mouseStarted?this._mouseDrag(d):this._mouseUp(d))}return !this._mouseStarted},_mouseUp:function(d){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(d.target===this._mouseDownEvent.target){b.data(d.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(d)}return false},_mouseDistanceMet:function(d){return(Math.max(Math.abs(this._mouseDownEvent.pageX-d.pageX),Math.abs(this._mouseDownEvent.pageY-d.pageY))>=this.options.distance)},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
/*!
 * jQuery UI Draggable 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}if(this.options.addClasses){this.element.addClass("ui-draggable")}if(this.options.disabled){this.element.addClass("ui-draggable-disabled")}this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(c){var d=this.options;if(this.helper||d.disabled||a(c.target).closest(".ui-resizable-handle").length>0){return false}this.handle=this._getHandle(c);if(!this.handle){return false}a(d.iframeFix===true?"iframe":d.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")});return true},_mouseStart:function(c){var d=this.options;this.helper=this._createHelper(c);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offsetParent=this.helper.offsetParent();this.offsetParentCssPosition=this.offsetParent.css("position");this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.offset.scroll=false;a.extend(this.offset,{click:{left:c.pageX-this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(c);this.originalPageX=c.pageX;this.originalPageY=c.pageY;(d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt));this._setContainment();if(this._trigger("start",c)===false){this._clear();return false}this._cacheHelperProportions();if(a.ui.ddmanager&&!d.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,c)}this._mouseDrag(c,true);if(a.ui.ddmanager){a.ui.ddmanager.dragStart(this,c)}return true},_mouseDrag:function(c,e){if(this.offsetParentCssPosition==="fixed"){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(c);this.positionAbs=this._convertPositionTo("absolute");if(!e){var d=this._uiHash();if(this._trigger("drag",c,d)===false){this._mouseUp({});return false}this.position=d.position}if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}if(a.ui.ddmanager){a.ui.ddmanager.drag(this,c)}return false},_mouseStop:function(d){var c=this,e=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){e=a.ui.ddmanager.drop(this,d)}if(this.dropped){e=this.dropped;this.dropped=false}if(this.options.helper==="original"&&!a.contains(this.element[0].ownerDocument,this.element[0])){return false}if((this.options.revert==="invalid"&&!e)||(this.options.revert==="valid"&&e)||this.options.revert===true||(a.isFunction(this.options.revert)&&this.options.revert.call(this.element,e))){a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(c._trigger("stop",d)!==false){c._clear()}})}else{if(this._trigger("stop",d)!==false){this._clear()}}return false},_mouseUp:function(c){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});if(a.ui.ddmanager){a.ui.ddmanager.dragStop(this,c)}return a.ui.mouse.prototype._mouseUp.call(this,c)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(c){return this.options.handle?!!a(c.target).closest(this.element.find(this.options.handle)).length:true},_createHelper:function(d){var e=this.options,c=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[d])):(e.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!c.parents("body").length){c.appendTo((e.appendTo==="parent"?this.element[0].parentNode:e.appendTo))}if(c[0]!==this.element[0]&&!(/(fixed|absolute)/).test(c.css("position"))){c.css("position","absolute")}return c},_adjustOffsetFromHelper:function(c){if(typeof c==="string"){c=c.split(" ")}if(a.isArray(c)){c={left:+c[0],top:+c[1]||0}}if("left" in c){this.offset.click.left=c.left+this.margins.left}if("right" in c){this.offset.click.left=this.helperProportions.width-c.right+this.margins.left}if("top" in c){this.offset.click.top=c.top+this.margins.top}if("bottom" in c){this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top}},_getParentOffset:function(){var c=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])){c.left+=this.scrollParent.scrollLeft();c.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]===document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&a.ui.ie)){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var c=this.element.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,g,d,f=this.options;if(!f.containment){this.containment=null;return}if(f.containment==="window"){this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(f.containment==="document"){this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(f.containment.constructor===Array){this.containment=f.containment;return}if(f.containment==="parent"){f.containment=this.helper[0].parentNode}g=a(f.containment);d=g[0];if(!d){return}e=g.css("overflow")!=="hidden";this.containment=[(parseInt(g.css("borderLeftWidth"),10)||0)+(parseInt(g.css("paddingLeft"),10)||0),(parseInt(g.css("borderTopWidth"),10)||0)+(parseInt(g.css("paddingTop"),10)||0),(e?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(g.css("borderRightWidth"),10)||0)-(parseInt(g.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(g.css("borderBottomWidth"),10)||0)-(parseInt(g.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=g},_convertPositionTo:function(f,g){if(!g){g=this.position}var e=f==="absolute"?1:-1,c=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent;if(!this.offset.scroll){this.offset.scroll={top:c.scrollTop(),left:c.scrollLeft()}}return{top:(g.top+this.offset.relative.top*e+this.offset.parent.top*e-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)*e)),left:(g.left+this.offset.relative.left*e+this.offset.parent.left*e-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)*e))}},_generatePosition:function(d){var c,i,j,f,e=this.options,k=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,h=d.pageX,g=d.pageY;if(!this.offset.scroll){this.offset.scroll={top:k.scrollTop(),left:k.scrollLeft()}}if(this.originalPosition){if(this.containment){if(this.relative_container){i=this.relative_container.offset();c=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else{c=this.containment}if(d.pageX-this.offset.click.left<c[0]){h=c[0]+this.offset.click.left}if(d.pageY-this.offset.click.top<c[1]){g=c[1]+this.offset.click.top}if(d.pageX-this.offset.click.left>c[2]){h=c[2]+this.offset.click.left}if(d.pageY-this.offset.click.top>c[3]){g=c[3]+this.offset.click.top}}if(e.grid){j=e.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1]:this.originalPageY;g=c?((j-this.offset.click.top>=c[1]||j-this.offset.click.top>c[3])?j:((j-this.offset.click.top>=c[1])?j-e.grid[1]:j+e.grid[1])):j;f=e.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/e.grid[0])*e.grid[0]:this.originalPageX;h=c?((f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2])?f:((f-this.offset.click.left>=c[0])?f-e.grid[0]:f+e.grid[0])):f}}return{top:(g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)),left:(h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(c,d,e){e=e||this._uiHash();a.ui.plugin.call(this,c,[d,e]);if(c==="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,c,d,e)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.ui.plugin.add("draggable","connectToSortable",{start:function(d,f){var e=a(this).data("ui-draggable"),g=e.options,c=a.extend({},f,{item:e.element});e.sortables=[];a(g.connectToSortable).each(function(){var h=a.data(this,"ui-sortable");if(h&&!h.options.disabled){e.sortables.push({instance:h,shouldRevert:h.options.revert});h.refreshPositions();h._trigger("activate",d,c)}})},stop:function(d,f){var e=a(this).data("ui-draggable"),c=a.extend({},f,{item:e.element});a.each(e.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;e.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=this.shouldRevert}this.instance._mouseStop(d);this.instance.options.helper=this.instance.options._helper;if(e.options.helper==="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",d,c)}})},drag:function(d,f){var e=a(this).data("ui-draggable"),c=this;a.each(e.sortables,function(){var g=false,h=this;this.instance.positionAbs=e.positionAbs;this.instance.helperProportions=e.helperProportions;this.instance.offset.click=e.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){g=true;a.each(e.sortables,function(){this.instance.positionAbs=e.positionAbs;this.instance.helperProportions=e.helperProportions;this.instance.offset.click=e.offset.click;if(this!==h&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(h.instance.element[0],this.instance.element[0])){g=false}return g})}if(g){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(c).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return f.helper[0]};d.target=this.instance.currentItem[0];this.instance._mouseCapture(d,true);this.instance._mouseStart(d,true,true);this.instance.offset.click.top=e.offset.click.top;this.instance.offset.click.left=e.offset.click.left;this.instance.offset.parent.left-=e.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=e.offset.parent.top-this.instance.offset.parent.top;e._trigger("toSortable",d);e.dropped=this.instance.element;e.currentItem=e.element;this.instance.fromOutside=e}if(this.instance.currentItem){this.instance._mouseDrag(d)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",d,this.instance._uiHash(this.instance));this.instance._mouseStop(d,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}e._trigger("fromSortable",d);e.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(){var c=a("body"),d=a(this).data("ui-draggable").options;if(c.css("cursor")){d._cursor=c.css("cursor")}c.css("cursor",d.cursor)},stop:function(){var c=a(this).data("ui-draggable").options;if(c._cursor){a("body").css("cursor",c._cursor)}}});a.ui.plugin.add("draggable","opacity",{start:function(d,e){var c=a(e.helper),f=a(this).data("ui-draggable").options;if(c.css("opacity")){f._opacity=c.css("opacity")}c.css("opacity",f.opacity)},stop:function(c,d){var e=a(this).data("ui-draggable").options;if(e._opacity){a(d.helper).css("opacity",e._opacity)}}});a.ui.plugin.add("draggable","scroll",{start:function(){var c=a(this).data("ui-draggable");if(c.scrollParent[0]!==document&&c.scrollParent[0].tagName!=="HTML"){c.overflowOffset=c.scrollParent.offset()}},drag:function(e){var d=a(this).data("ui-draggable"),f=d.options,c=false;if(d.scrollParent[0]!==document&&d.scrollParent[0].tagName!=="HTML"){if(!f.axis||f.axis!=="x"){if((d.overflowOffset.top+d.scrollParent[0].offsetHeight)-e.pageY<f.scrollSensitivity){d.scrollParent[0].scrollTop=c=d.scrollParent[0].scrollTop+f.scrollSpeed}else{if(e.pageY-d.overflowOffset.top<f.scrollSensitivity){d.scrollParent[0].scrollTop=c=d.scrollParent[0].scrollTop-f.scrollSpeed}}}if(!f.axis||f.axis!=="y"){if((d.overflowOffset.left+d.scrollParent[0].offsetWidth)-e.pageX<f.scrollSensitivity){d.scrollParent[0].scrollLeft=c=d.scrollParent[0].scrollLeft+f.scrollSpeed}else{if(e.pageX-d.overflowOffset.left<f.scrollSensitivity){d.scrollParent[0].scrollLeft=c=d.scrollParent[0].scrollLeft-f.scrollSpeed}}}}else{if(!f.axis||f.axis!=="x"){if(e.pageY-a(document).scrollTop()<f.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()-f.scrollSpeed)}else{if(a(window).height()-(e.pageY-a(document).scrollTop())<f.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()+f.scrollSpeed)}}}if(!f.axis||f.axis!=="y"){if(e.pageX-a(document).scrollLeft()<f.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()-f.scrollSpeed)}else{if(a(window).width()-(e.pageX-a(document).scrollLeft())<f.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()+f.scrollSpeed)}}}}if(c!==false&&a.ui.ddmanager&&!f.dropBehaviour){a.ui.ddmanager.prepareOffsets(d,e)}}});a.ui.plugin.add("draggable","snap",{start:function(){var c=a(this).data("ui-draggable"),d=c.options;c.snapElements=[];a(d.snap.constructor!==String?(d.snap.items||":data(ui-draggable)"):d.snap).each(function(){var f=a(this),e=f.offset();if(this!==c.element[0]){c.snapElements.push({item:this,width:f.outerWidth(),height:f.outerHeight(),top:e.top,left:e.left})}})},drag:function(u,p){var c,z,j,k,s,n,m,A,v,h,g=a(this).data("ui-draggable"),q=g.options,y=q.snapTolerance,x=p.offset.left,w=x+g.helperProportions.width,f=p.offset.top,e=f+g.helperProportions.height;for(v=g.snapElements.length-1;v>=0;v--){s=g.snapElements[v].left;n=s+g.snapElements[v].width;m=g.snapElements[v].top;A=m+g.snapElements[v].height;if(w<s-y||x>n+y||e<m-y||f>A+y||!a.contains(g.snapElements[v].item.ownerDocument,g.snapElements[v].item)){if(g.snapElements[v].snapping){(g.options.snap.release&&g.options.snap.release.call(g.element,u,a.extend(g._uiHash(),{snapItem:g.snapElements[v].item})))}g.snapElements[v].snapping=false;continue}if(q.snapMode!=="inner"){c=Math.abs(m-e)<=y;z=Math.abs(A-f)<=y;j=Math.abs(s-w)<=y;k=Math.abs(n-x)<=y;if(c){p.position.top=g._convertPositionTo("relative",{top:m-g.helperProportions.height,left:0}).top-g.margins.top}if(z){p.position.top=g._convertPositionTo("relative",{top:A,left:0}).top-g.margins.top}if(j){p.position.left=g._convertPositionTo("relative",{top:0,left:s-g.helperProportions.width}).left-g.margins.left}if(k){p.position.left=g._convertPositionTo("relative",{top:0,left:n}).left-g.margins.left}}h=(c||z||j||k);if(q.snapMode!=="outer"){c=Math.abs(m-f)<=y;z=Math.abs(A-e)<=y;j=Math.abs(s-x)<=y;k=Math.abs(n-w)<=y;if(c){p.position.top=g._convertPositionTo("relative",{top:m,left:0}).top-g.margins.top}if(z){p.position.top=g._convertPositionTo("relative",{top:A-g.helperProportions.height,left:0}).top-g.margins.top}if(j){p.position.left=g._convertPositionTo("relative",{top:0,left:s}).left-g.margins.left}if(k){p.position.left=g._convertPositionTo("relative",{top:0,left:n-g.helperProportions.width}).left-g.margins.left}}if(!g.snapElements[v].snapping&&(c||z||j||k||h)){(g.options.snap.snap&&g.options.snap.snap.call(g.element,u,a.extend(g._uiHash(),{snapItem:g.snapElements[v].item})))}g.snapElements[v].snapping=(c||z||j||k||h)}}});a.ui.plugin.add("draggable","stack",{start:function(){var c,e=this.data("ui-draggable").options,d=a.makeArray(a(e.stack)).sort(function(g,f){return(parseInt(a(g).css("zIndex"),10)||0)-(parseInt(a(f).css("zIndex"),10)||0)});if(!d.length){return}c=parseInt(a(d[0]).css("zIndex"),10)||0;a(d).each(function(f){a(this).css("zIndex",c+f)});this.css("zIndex",(c+d.length))}});a.ui.plugin.add("draggable","zIndex",{start:function(d,e){var c=a(e.helper),f=a(this).data("ui-draggable").options;if(c.css("zIndex")){f._zIndex=c.css("zIndex")}c.css("zIndex",f.zIndex)},stop:function(c,d){var e=a(this).data("ui-draggable").options;if(e._zIndex){a(d.helper).css("zIndex",e._zIndex)}}})})(jQuery);
/*!
 * jQuery UI Droppable 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
(function(b,c){function a(e,d,f){return(e>d)&&(e<(d+f))}b.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,f=this.options,d=f.accept;this.isover=false;this.isout=true;this.accept=b.isFunction(d)?d:function(g){return g.is(d)};this.proportions=function(){if(arguments.length){e=arguments[0]}else{return e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};b.ui.ddmanager.droppables[f.scope]=b.ui.ddmanager.droppables[f.scope]||[];b.ui.ddmanager.droppables[f.scope].push(this);(f.addClasses&&this.element.addClass("ui-droppable"))},_destroy:function(){var e=0,d=b.ui.ddmanager.droppables[this.options.scope];for(;e<d.length;e++){if(d[e]===this){d.splice(e,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(d,e){if(d==="accept"){this.accept=b.isFunction(e)?e:function(f){return f.is(e)}}b.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var d=b.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}if(d){this._trigger("activate",e,this.ui(d))}},_deactivate:function(e){var d=b.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(d){this._trigger("deactivate",e,this.ui(d))}},_over:function(e){var d=b.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(d.currentItem||d.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",e,this.ui(d))}},_out:function(e){var d=b.ui.ddmanager.current;if(!d||(d.currentItem||d.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(d.currentItem||d.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",e,this.ui(d))}},_drop:function(e,f){var d=f||b.ui.ddmanager.current,g=false;if(!d||(d.currentItem||d.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var h=b.data(this,"ui-droppable");if(h.options.greedy&&!h.options.disabled&&h.options.scope===d.options.scope&&h.accept.call(h.element[0],(d.currentItem||d.element))&&b.ui.intersect(d,b.extend(h,{offset:h.element.offset()}),h.options.tolerance)){g=true;return false}});if(g){return false}if(this.accept.call(this.element[0],(d.currentItem||d.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",e,this.ui(d));return this.element}return false},ui:function(d){return{draggable:(d.currentItem||d.element),helper:d.helper,position:d.position,offset:d.positionAbs}}});b.ui.intersect=function(q,j,o){if(!j.offset){return false}var h,i,f=(q.positionAbs||q.position.absolute).left,n=(q.positionAbs||q.position.absolute).top,e=f+q.helperProportions.width,m=n+q.helperProportions.height,g=j.offset.left,p=j.offset.top,d=g+j.proportions().width,k=p+j.proportions().height;switch(o){case"fit":return(g<=f&&e<=d&&p<=n&&m<=k);case"intersect":return(g<f+(q.helperProportions.width/2)&&e-(q.helperProportions.width/2)<d&&p<n+(q.helperProportions.height/2)&&m-(q.helperProportions.height/2)<k);case"pointer":h=((q.positionAbs||q.position.absolute).left+(q.clickOffset||q.offset.click).left);i=((q.positionAbs||q.position.absolute).top+(q.clickOffset||q.offset.click).top);return a(i,p,j.proportions().height)&&a(h,g,j.proportions().width);case"touch":return((n>=p&&n<=k)||(m>=p&&m<=k)||(n<p&&m>k))&&((f>=g&&f<=d)||(e>=g&&e<=d)||(f<g&&e>d));default:return false}};b.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(g,k){var f,e,d=b.ui.ddmanager.droppables[g.options.scope]||[],h=k?k.type:null,l=(g.currentItem||g.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(f=0;f<d.length;f++){if(d[f].options.disabled||(g&&!d[f].accept.call(d[f].element[0],(g.currentItem||g.element)))){continue}for(e=0;e<l.length;e++){if(l[e]===d[f].element[0]){d[f].proportions().height=0;continue droppablesLoop}}d[f].visible=d[f].element.css("display")!=="none";if(!d[f].visible){continue}if(h==="mousedown"){d[f]._activate.call(d[f],k)}d[f].offset=d[f].element.offset();d[f].proportions({width:d[f].element[0].offsetWidth,height:d[f].element[0].offsetHeight})}},drop:function(d,e){var f=false;b.each((b.ui.ddmanager.droppables[d.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&b.ui.intersect(d,this,this.options.tolerance)){f=this._drop.call(this,e)||f}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(d.currentItem||d.element))){this.isout=true;this.isover=false;this._deactivate.call(this,e)}});return f},dragStart:function(d,e){d.element.parentsUntil("body").bind("scroll.droppable",function(){if(!d.options.refreshPositions){b.ui.ddmanager.prepareOffsets(d,e)}})},drag:function(d,e){if(d.options.refreshPositions){b.ui.ddmanager.prepareOffsets(d,e)}b.each(b.ui.ddmanager.droppables[d.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var i,g,f,h=b.ui.intersect(d,this,this.options.tolerance),j=!h&&this.isover?"isout":(h&&!this.isover?"isover":null);if(!j){return}if(this.options.greedy){g=this.options.scope;f=this.element.parents(":data(ui-droppable)").filter(function(){return b.data(this,"ui-droppable").options.scope===g});if(f.length){i=b.data(f[0],"ui-droppable");i.greedyChild=(j==="isover")}}if(i&&j==="isover"){i.isover=false;i.isout=true;i._out.call(i,e)}this[j]=true;this[j==="isout"?"isover":"isout"]=false;this[j==="isover"?"_over":"_out"].call(this,e);if(i&&j==="isout"){i.isout=false;i.isover=true;i._over.call(i,e)}})},dragStop:function(d,e){d.element.parentsUntil("body").unbind("scroll.droppable");if(!d.options.refreshPositions){b.ui.ddmanager.prepareOffsets(d,e)}}}})(jQuery);
/*!
 * jQuery UI Sortable 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(b,d){function a(f,e,g){return(f>e)&&(f<(e+g))}function c(e){return(/left|right/).test(e.css("float"))||(/inline|table-cell/).test(e.css("display"))}b.widget("ui.sortable",b.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?e.axis==="x"||c(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this.ready=true},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--){this.items[e].item.removeData(this.widgetName+"-item")}return this},_setOption:function(e,f){if(e==="disabled"){this.options[e]=f;this.widget().toggleClass("ui-sortable-disabled",!!f)}else{b.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(g,h){var e=null,i=false,f=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(g);b(g.target).parents().each(function(){if(b.data(this,f.widgetName+"-item")===f){e=b(this);return false}});if(b.data(g.target,f.widgetName+"-item")===f){e=b(g.target)}if(!e){return false}if(this.options.handle&&!h){b(this.options.handle,e).find("*").addBack().each(function(){if(this===g.target){i=true}});if(!i){return false}}this.currentItem=e;this._removeCurrentsFromItems();return true},_mouseStart:function(h,j,f){var g,e,k=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(h);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};b.extend(this.offset,{click:{left:h.pageX-this.offset.left,top:h.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(h);this.originalPageX=h.pageX;this.originalPageY=h.pageY;(k.cursorAt&&this._adjustOffsetFromHelper(k.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(k.containment){this._setContainment()}if(k.cursor&&k.cursor!=="auto"){e=this.document.find("body");this.storedCursor=e.css("cursor");e.css("cursor",k.cursor);this.storedStylesheet=b("<style>*{ cursor: "+k.cursor+" !important; }</style>").appendTo(e)}if(k.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",k.opacity)}if(k.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",k.zIndex)}if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",h,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!f){for(g=this.containers.length-1;g>=0;g--){this.containers[g]._trigger("activate",h,this._uiHash(this))}}if(b.ui.ddmanager){b.ui.ddmanager.current=this}if(b.ui.ddmanager&&!k.dropBehaviour){b.ui.ddmanager.prepareOffsets(this,h)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(h);return true},_mouseDrag:function(j){var g,h,f,l,k=this.options,e=false;this.position=this._generatePosition(j);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-j.pageY<k.scrollSensitivity){this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop+k.scrollSpeed}else{if(j.pageY-this.overflowOffset.top<k.scrollSensitivity){this.scrollParent[0].scrollTop=e=this.scrollParent[0].scrollTop-k.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-j.pageX<k.scrollSensitivity){this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft+k.scrollSpeed}else{if(j.pageX-this.overflowOffset.left<k.scrollSensitivity){this.scrollParent[0].scrollLeft=e=this.scrollParent[0].scrollLeft-k.scrollSpeed}}}else{if(j.pageY-b(document).scrollTop()<k.scrollSensitivity){e=b(document).scrollTop(b(document).scrollTop()-k.scrollSpeed)}else{if(b(window).height()-(j.pageY-b(document).scrollTop())<k.scrollSensitivity){e=b(document).scrollTop(b(document).scrollTop()+k.scrollSpeed)}}if(j.pageX-b(document).scrollLeft()<k.scrollSensitivity){e=b(document).scrollLeft(b(document).scrollLeft()-k.scrollSpeed)}else{if(b(window).width()-(j.pageX-b(document).scrollLeft())<k.scrollSensitivity){e=b(document).scrollLeft(b(document).scrollLeft()+k.scrollSpeed)}}}if(e!==false&&b.ui.ddmanager&&!k.dropBehaviour){b.ui.ddmanager.prepareOffsets(this,j)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}for(g=this.items.length-1;g>=0;g--){h=this.items[g];f=h.item[0];l=this._intersectsWithPointer(h);if(!l){continue}if(h.instance!==this.currentContainer){continue}if(f!==this.currentItem[0]&&this.placeholder[l===1?"next":"prev"]()[0]!==f&&!b.contains(this.placeholder[0],f)&&(this.options.type==="semi-dynamic"?!b.contains(this.element[0],f):true)){this.direction=l===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(h)){this._rearrange(j,h)}else{break}this._trigger("change",j,this._uiHash());break}}this._contactContainers(j);if(b.ui.ddmanager){b.ui.ddmanager.drag(this,j)}this._trigger("sort",j,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(g,i){if(!g){return}if(b.ui.ddmanager&&!this.options.dropBehaviour){b.ui.ddmanager.drop(this,g)}if(this.options.revert){var f=this,j=this.placeholder.offset(),e=this.options.axis,h={};if(!e||e==="x"){h.left=j.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)}if(!e||e==="y"){h.top=j.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)}this.reverting=true;b(this.helper).animate(h,parseInt(this.options.revert,10)||500,function(){f._clear(g)})}else{this._clear(g,i)}return false},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("deactivate",null,this._uiHash(this));if(this.containers[e].containerCache.over){this.containers[e]._trigger("out",null,this._uiHash(this));this.containers[e].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}b.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){b(this.domPosition.prev).after(this.currentItem)}else{b(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(g){var e=this._getItemsAsjQuery(g&&g.connected),f=[];g=g||{};b(e).each(function(){var h=(b(g.item||this).attr(g.attribute||"id")||"").match(g.expression||(/(.+)[\-=_](.+)/));if(h){f.push((g.key||h[1]+"[]")+"="+(g.key&&g.expression?h[1]:h[2]))}});if(!f.length&&g.key){f.push(g.key+"=")}return f.join("&")},toArray:function(g){var e=this._getItemsAsjQuery(g&&g.connected),f=[];g=g||{};e.each(function(){f.push(b(g.item||this).attr(g.attribute||"id")||"")});return f},_intersectsWith:function(q){var g=this.positionAbs.left,f=g+this.helperProportions.width,o=this.positionAbs.top,n=o+this.helperProportions.height,h=q.left,e=h+q.width,s=q.top,m=s+q.height,u=this.offset.click.top,k=this.offset.click.left,j=(this.options.axis==="x")||((o+u)>s&&(o+u)<m),p=(this.options.axis==="y")||((g+k)>h&&(g+k)<e),i=j&&p;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>q[this.floating?"width":"height"])){return i}else{return(h<g+(this.helperProportions.width/2)&&f-(this.helperProportions.width/2)<e&&s<o+(this.helperProportions.height/2)&&n-(this.helperProportions.height/2)<m)}},_intersectsWithPointer:function(g){var h=(this.options.axis==="x")||a(this.positionAbs.top+this.offset.click.top,g.top,g.height),f=(this.options.axis==="y")||a(this.positionAbs.left+this.offset.click.left,g.left,g.width),j=h&&f,e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();if(!j){return false}return this.floating?(((i&&i==="right")||e==="down")?2:1):(e&&(e==="down"?2:1))},_intersectsWithSides:function(h){var f=a(this.positionAbs.top+this.offset.click.top,h.top+(h.height/2),h.height),g=a(this.positionAbs.left+this.offset.click.left,h.left+(h.width/2),h.width),e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();if(this.floating&&i){return((i==="right"&&g)||(i==="left"&&!g))}else{return e&&((e==="down"&&f)||(e==="up"&&!f))}},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!==0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!==0&&(e>0?"right":"left")},refresh:function(e){this._refreshItems(e);this.refreshPositions();return this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(e){var g,f,n,k,l=[],h=[],m=this._connectWith();if(m&&e){for(g=m.length-1;g>=0;g--){n=b(m[g]);for(f=n.length-1;f>=0;f--){k=b.data(n[f],this.widgetFullName);if(k&&k!==this&&!k.options.disabled){h.push([b.isFunction(k.options.items)?k.options.items.call(k.element):b(k.options.items,k.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),k])}}}}h.push([b.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):b(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function o(){l.push(this)}for(g=h.length-1;g>=0;g--){h[g][0].each(o)}return b(l)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=b.grep(this.items,function(g){for(var f=0;f<e.length;f++){if(e[f]===g.item[0]){return false}}return true})},_refreshItems:function(e){this.items=[];this.containers=[this];var k,g,p,l,o,f,r,q,m=this.items,h=[[b.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):b(this.options.items,this.element),this]],n=this._connectWith();if(n&&this.ready){for(k=n.length-1;k>=0;k--){p=b(n[k]);for(g=p.length-1;g>=0;g--){l=b.data(p[g],this.widgetFullName);if(l&&l!==this&&!l.options.disabled){h.push([b.isFunction(l.options.items)?l.options.items.call(l.element[0],e,{item:this.currentItem}):b(l.options.items,l.element),l]);this.containers.push(l)}}}}for(k=h.length-1;k>=0;k--){o=h[k][1];f=h[k][0];for(g=0,q=f.length;g<q;g++){r=b(f[g]);r.data(this.widgetName+"-item",o);m.push({item:r,instance:o,width:0,height:0,left:0,top:0})}}},refreshPositions:function(e){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}var g,h,f,j;for(g=this.items.length-1;g>=0;g--){h=this.items[g];if(h.instance!==this.currentContainer&&this.currentContainer&&h.item[0]!==this.currentItem[0]){continue}f=this.options.toleranceElement?b(this.options.toleranceElement,h.item):h.item;if(!e){h.width=f.outerWidth();h.height=f.outerHeight()}j=f.offset();h.left=j.left;h.top=j.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(g=this.containers.length-1;g>=0;g--){j=this.containers[g].element.offset();this.containers[g].containerCache.left=j.left;this.containers[g].containerCache.top=j.top;this.containers[g].containerCache.width=this.containers[g].element.outerWidth();this.containers[g].containerCache.height=this.containers[g].element.outerHeight()}}return this},_createPlaceholder:function(f){f=f||this;var e,g=f.options;if(!g.placeholder||g.placeholder.constructor===String){e=g.placeholder;g.placeholder={element:function(){var i=f.currentItem[0].nodeName.toLowerCase(),h=b("<"+i+">",f.document[0]).addClass(e||f.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(i==="tr"){f.currentItem.children().each(function(){b("<td>&#160;</td>",f.document[0]).attr("colspan",b(this).attr("colspan")||1).appendTo(h)})}else{if(i==="img"){h.attr("src",f.currentItem.attr("src"))}}if(!e){h.css("visibility","hidden")}return h},update:function(h,i){if(e&&!g.forcePlaceholderSize){return}if(!i.height()){i.height(f.currentItem.innerHeight()-parseInt(f.currentItem.css("paddingTop")||0,10)-parseInt(f.currentItem.css("paddingBottom")||0,10))}if(!i.width()){i.width(f.currentItem.innerWidth()-parseInt(f.currentItem.css("paddingLeft")||0,10)-parseInt(f.currentItem.css("paddingRight")||0,10))}}}}f.placeholder=b(g.placeholder.element.call(f.element,f.currentItem));f.currentItem.after(f.placeholder);g.placeholder.update(f,f.placeholder)},_contactContainers:function(e){var l,h,p,m,n,r,f,s,k,o,g=null,q=null;for(l=this.containers.length-1;l>=0;l--){if(b.contains(this.currentItem[0],this.containers[l].element[0])){continue}if(this._intersectsWith(this.containers[l].containerCache)){if(g&&b.contains(this.containers[l].element[0],g.element[0])){continue}g=this.containers[l];q=l}else{if(this.containers[l].containerCache.over){this.containers[l]._trigger("out",e,this._uiHash(this));this.containers[l].containerCache.over=0}}}if(!g){return}if(this.containers.length===1){if(!this.containers[q].containerCache.over){this.containers[q]._trigger("over",e,this._uiHash(this));this.containers[q].containerCache.over=1}}else{p=10000;m=null;o=g.floating||c(this.currentItem);n=o?"left":"top";r=o?"width":"height";f=this.positionAbs[n]+this.offset.click[n];for(h=this.items.length-1;h>=0;h--){if(!b.contains(this.containers[q].element[0],this.items[h].item[0])){continue}if(this.items[h].item[0]===this.currentItem[0]){continue}if(o&&!a(this.positionAbs.top+this.offset.click.top,this.items[h].top,this.items[h].height)){continue}s=this.items[h].item.offset()[n];k=false;if(Math.abs(s-f)>Math.abs(s+this.items[h][r]-f)){k=true;s+=this.items[h][r]}if(Math.abs(s-f)<p){p=Math.abs(s-f);m=this.items[h];this.direction=k?"up":"down"}}if(!m&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[q]){return}m?this._rearrange(e,m,null,true):this._rearrange(e,null,this.containers[q].element,true);this._trigger("change",e,this._uiHash());this.containers[q]._trigger("change",e,this._uiHash(this));this.currentContainer=this.containers[q];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[q]._trigger("over",e,this._uiHash(this));this.containers[q].containerCache.over=1}},_createHelper:function(f){var g=this.options,e=b.isFunction(g.helper)?b(g.helper.apply(this.element[0],[f,this.currentItem])):(g.helper==="clone"?this.currentItem.clone():this.currentItem);if(!e.parents("body").length){b(g.appendTo!=="parent"?g.appendTo:this.currentItem[0].parentNode)[0].appendChild(e[0])}if(e[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!e[0].style.width||g.forceHelperSize){e.width(this.currentItem.width())}if(!e[0].style.height||g.forceHelperSize){e.height(this.currentItem.height())}return e},_adjustOffsetFromHelper:function(e){if(typeof e==="string"){e=e.split(" ")}if(b.isArray(e)){e={left:+e[0],top:+e[1]||0}}if("left" in e){this.offset.click.left=e.left+this.margins.left}if("right" in e){this.offset.click.left=this.helperProportions.width-e.right+this.margins.left}if("top" in e){this.offset.click.top=e.top+this.margins.top}if("bottom" in e){this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0])){e.left+=this.scrollParent.scrollLeft();e.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===document.body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&b.ui.ie)){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var f,h,e,g=this.options;if(g.containment==="parent"){g.containment=this.helper[0].parentNode}if(g.containment==="document"||g.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,b(g.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b(g.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(g.containment)){f=b(g.containment)[0];h=b(g.containment).offset();e=(b(f).css("overflow")!=="hidden");this.containment=[h.left+(parseInt(b(f).css("borderLeftWidth"),10)||0)+(parseInt(b(f).css("paddingLeft"),10)||0)-this.margins.left,h.top+(parseInt(b(f).css("borderTopWidth"),10)||0)+(parseInt(b(f).css("paddingTop"),10)||0)-this.margins.top,h.left+(e?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(b(f).css("borderLeftWidth"),10)||0)-(parseInt(b(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,h.top+(e?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(b(f).css("borderTopWidth"),10)||0)-(parseInt(b(f).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(g,i){if(!i){i=this.position}var f=g==="absolute"?1:-1,e=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,h=(/(html|body)/i).test(e[0].tagName);return{top:(i.top+this.offset.relative.top*f+this.offset.parent.top*f-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(h?0:e.scrollTop()))*f)),left:(i.left+this.offset.relative.left*f+this.offset.parent.left*f-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():h?0:e.scrollLeft())*f))}},_generatePosition:function(h){var j,i,k=this.options,g=h.pageX,f=h.pageY,e=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&b.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,l=(/(html|body)/i).test(e[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(h.pageX-this.offset.click.left<this.containment[0]){g=this.containment[0]+this.offset.click.left}if(h.pageY-this.offset.click.top<this.containment[1]){f=this.containment[1]+this.offset.click.top}if(h.pageX-this.offset.click.left>this.containment[2]){g=this.containment[2]+this.offset.click.left}if(h.pageY-this.offset.click.top>this.containment[3]){f=this.containment[3]+this.offset.click.top}}if(k.grid){j=this.originalPageY+Math.round((f-this.originalPageY)/k.grid[1])*k.grid[1];f=this.containment?((j-this.offset.click.top>=this.containment[1]&&j-this.offset.click.top<=this.containment[3])?j:((j-this.offset.click.top>=this.containment[1])?j-k.grid[1]:j+k.grid[1])):j;i=this.originalPageX+Math.round((g-this.originalPageX)/k.grid[0])*k.grid[0];g=this.containment?((i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2])?i:((i-this.offset.click.left>=this.containment[0])?i-k.grid[0]:i+k.grid[0])):i}}return{top:(f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(l?0:e.scrollTop())))),left:(g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():l?0:e.scrollLeft())))}},_rearrange:function(j,h,f,g){f?f[0].appendChild(this.placeholder[0]):h.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?h.item[0]:h.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){if(e===this.counter){this.refreshPositions(!g)}})},_clear:function(f,h){this.reverting=false;var e,j=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(e in this._storedCSS){if(this._storedCSS[e]==="auto"||this._storedCSS[e]==="static"){this._storedCSS[e]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!h){j.push(function(i){this._trigger("receive",i,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!h){j.push(function(i){this._trigger("update",i,this._uiHash())})}if(this!==this.currentContainer){if(!h){j.push(function(i){this._trigger("remove",i,this._uiHash())});j.push((function(i){return function(k){i._trigger("receive",k,this._uiHash(this))}}).call(this,this.currentContainer));j.push((function(i){return function(k){i._trigger("update",k,this._uiHash(this))}}).call(this,this.currentContainer))}}function g(l,i,k){return function(m){k._trigger(l,m,i._uiHash(i))}}for(e=this.containers.length-1;e>=0;e--){if(!h){j.push(g("deactivate",this,this.containers[e]))}if(this.containers[e].containerCache.over){j.push(g("out",this,this.containers[e]));this.containers[e].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!h){this._trigger("beforeStop",f,this._uiHash());for(e=0;e<j.length;e++){j[e].call(this,f)}this._trigger("stop",f,this._uiHash())}this.fromOutside=false;return false}if(!h){this._trigger("beforeStop",f,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null;if(!h){for(e=0;e<j.length;e++){j[e].call(this,f)}this._trigger("stop",f,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if(b.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(e){var f=e||this;return{helper:f.helper,placeholder:f.placeholder||b([]),position:f.position,originalPosition:f.originalPosition,offset:f.positionAbs,item:f.currentItem,sender:e?e.element:null}}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/underscore.js' */
(function(){var ak=this,ae=ak._,ag={},au=Array.prototype,ad=Object.prototype,ap=Function.prototype,ay=au.push,aj=au.slice,aw=au.concat,am=ad.toString,at=ad.hasOwnProperty,af=au.forEach,ai=au.map,aq=au.reduce,ac=au.reduceRight,ar=au.filter,av=au.every,al=au.some,Z=au.indexOf,ax=au.lastIndexOf,aa=Array.isArray,ab=Object.keys,az=ap.bind,ao=function(a){return a instanceof ao?a:this instanceof ao?(this._wrapped=a,void 0):new ao(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=ao),exports._=ao):ak._=ao,ao.VERSION="1.5.2";var X=ao.each=ao.forEach=function(h,f,g){if(null!=h){if(af&&h.forEach===af){h.forEach(f,g)}else{if(h.length===+h.length){for(var c=0,d=h.length;d>c;c++){if(f.call(g,h[c],c,h)===ag){return}}}else{for(var b=ao.keys(h),c=0,d=b.length;d>c;c++){if(f.call(g,h[b[c]],b[c],h)===ag){return}}}}}};ao.map=ao.collect=function(d,a,b){var c=[];return null==d?c:ai&&d.map===ai?d.map(a,b):(X(d,function(g,e,f){c.push(a.call(b,g,e,f))}),c)};var U="Reduce of empty array with no initial value";ao.reduce=ao.foldl=ao.inject=function(f,b,c,d){var a=arguments.length>2;if(null==f&&(f=[]),aq&&f.reduce===aq){return d&&(b=ao.bind(b,d)),a?f.reduce(b,c):f.reduce(b)}if(X(f,function(h,g,e){a?c=b.call(d,c,h,g,e):(c=h,a=!0)}),!a){throw new TypeError(U)}return c},ao.reduceRight=ao.foldr=function(j,f,g,h){var c=arguments.length>2;if(null==j&&(j=[]),ac&&j.reduceRight===ac){return h&&(f=ao.bind(f,h)),c?j.reduceRight(f,g):j.reduceRight(f)}var d=j.length;if(d!==+d){var b=ao.keys(j);d=b.length}if(X(j,function(e,i,a){i=b?b[--d]:--d,c?g=f.call(h,g,j[i],i,a):(g=j[i],c=!0)}),!c){throw new TypeError(U)}return g},ao.find=ao.detect=function(d,a,b){var c;return J(d,function(g,e,f){return a.call(b,g,e,f)?(c=g,!0):void 0}),c},ao.filter=ao.select=function(d,a,b){var c=[];return null==d?c:ar&&d.filter===ar?d.filter(a,b):(X(d,function(g,e,f){a.call(b,g,e,f)&&c.push(g)}),c)},ao.reject=function(c,a,b){return ao.filter(c,function(g,f,d){return !a.call(b,g,f,d)},b)},ao.every=ao.all=function(d,b,c){b||(b=ao.identity);var a=!0;return null==d?a:av&&d.every===av?d.every(b,c):(X(d,function(g,f,e){return(a=a&&b.call(c,g,f,e))?void 0:ag}),!!a)};var J=ao.some=ao.any=function(d,b,c){b||(b=ao.identity);var a=!1;return null==d?a:al&&d.some===al?d.some(b,c):(X(d,function(g,f,e){return a||(a=b.call(c,g,f,e))?ag:void 0}),!!a)};ao.contains=ao.include=function(b,a){return null==b?!1:Z&&b.indexOf===Z?b.indexOf(a)!=-1:J(b,function(c){return c===a})},ao.invoke=function(d,a){var b=aj.call(arguments,2),c=ao.isFunction(a);return ao.map(d,function(e){return(c?a:e[a]).apply(e,b)})},ao.pluck=function(b,a){return ao.map(b,function(c){return c[a]})},ao.where=function(c,a,b){return ao.isEmpty(a)?b?void 0:[]:ao[b?"find":"filter"](c,function(e){for(var d in a){if(a[d]!==e[d]){return !1}}return !0})},ao.findWhere=function(b,a){return ao.where(b,a,!0)},ao.max=function(d,a,b){if(!a&&ao.isArray(d)&&d[0]===+d[0]&&d.length<65535){return Math.max.apply(Math,d)}if(!a&&ao.isEmpty(d)){return -1/0}var c={computed:-1/0,value:-1/0};return X(d,function(h,f,g){var e=a?a.call(b,h,f,g):h;e>c.computed&&(c={value:h,computed:e})}),c.value},ao.min=function(d,a,b){if(!a&&ao.isArray(d)&&d[0]===+d[0]&&d.length<65535){return Math.min.apply(Math,d)}if(!a&&ao.isEmpty(d)){return 1/0}var c={computed:1/0,value:1/0};return X(d,function(h,f,g){var e=a?a.call(b,h,f,g):h;e<c.computed&&(c={value:h,computed:e})}),c.value},ao.shuffle=function(d){var a,b=0,c=[];return X(d,function(e){a=ao.random(b++),c[b-1]=c[a],c[a]=e}),c},ao.sample=function(c,a,b){return arguments.length<2||b?c[ao.random(c.length-1)]:ao.shuffle(c).slice(0,Math.max(0,a))};var an=function(a){return ao.isFunction(a)?a:function(b){return b[a]}};ao.sortBy=function(d,a,b){var c=an(a);return ao.pluck(ao.map(d,function(g,f,e){return{value:g,index:f,criteria:c.call(b,g,f,e)}}).sort(function(i,f){var g=i.criteria,h=f.criteria;if(g!==h){if(g>h||g===void 0){return 1}if(h>g||h===void 0){return -1}}return i.index-f.index}),"value")};var Q=function(a){return function(d,f,g){var b={},c=null==f?ao.identity:an(f);return X(d,function(h,e){var i=c.call(g,h,e,d);a(b,i,h)}),b}};ao.groupBy=Q(function(c,a,b){(ao.has(c,a)?c[a]:c[a]=[]).push(b)}),ao.indexBy=Q(function(c,a,b){c[a]=b}),ao.countBy=Q(function(b,a){ao.has(b,a)?b[a]++:b[a]=1}),ao.sortedIndex=function(k,f,g,h){g=null==g?ao.identity:an(g);for(var c=g.call(h,f),d=0,b=k.length;b>d;){var j=d+b>>>1;g.call(h,k[j])<c?d=j+1:b=j}return d},ao.toArray=function(a){return a?ao.isArray(a)?aj.call(a):a.length===+a.length?ao.map(a,ao.identity):ao.values(a):[]},ao.size=function(a){return null==a?0:a.length===+a.length?a.length:ao.keys(a).length},ao.first=ao.head=ao.take=function(c,a,b){return null==c?void 0:null==a||b?c[0]:aj.call(c,0,a)},ao.initial=function(c,a,b){return aj.call(c,0,c.length-(null==a||b?1:a))},ao.last=function(c,a,b){return null==c?void 0:null==a||b?c[c.length-1]:aj.call(c,Math.max(c.length-a,0))},ao.rest=ao.tail=ao.drop=function(c,a,b){return aj.call(c,null==a||b?1:a)},ao.compact=function(a){return ao.filter(a,ao.identity)};var L=function(c,a,b){return a&&ao.every(c,ao.isArray)?aw.apply(b,c):(X(c,function(d){ao.isArray(d)||ao.isArguments(d)?a?ay.apply(b,d):L(d,a,b):b.push(d)}),b)};ao.flatten=function(b,a){return L(b,a,[])},ao.without=function(a){return ao.difference(a,aj.call(arguments,1))},ao.uniq=ao.unique=function(j,f,g,h){ao.isFunction(f)&&(h=g,g=f,f=!1);var c=g?ao.map(j,g,h):j,d=[],b=[];return X(c,function(a,i){(f?i&&b[b.length-1]===a:ao.contains(b,a))||(b.push(a),d.push(j[i]))}),d},ao.union=function(){return ao.uniq(ao.flatten(arguments,!0))},ao.intersection=function(b){var a=aj.call(arguments,1);return ao.filter(ao.uniq(b),function(c){return ao.every(a,function(d){return ao.indexOf(d,c)>=0})})},ao.difference=function(b){var a=aw.apply(au,aj.call(arguments,1));return ao.filter(b,function(c){return !ao.contains(a,c)})},ao.zip=function(){for(var c=ao.max(ao.pluck(arguments,"length").concat(0)),a=new Array(c),b=0;c>b;b++){a[b]=ao.pluck(arguments,""+b)}return a},ao.object=function(f,b){if(null==f){return{}}for(var c={},d=0,a=f.length;a>d;d++){b?c[f[d]]=b[d]:c[f[d][0]]=f[d][1]}return c},ao.indexOf=function(f,b,c){if(null==f){return -1}var d=0,a=f.length;if(c){if("number"!=typeof c){return d=ao.sortedIndex(f,b),f[d]===b?d:-1}d=0>c?Math.max(0,a+c):c}if(Z&&f.indexOf===Z){return f.indexOf(b,c)}for(;a>d;d++){if(f[d]===b){return d}}return -1},ao.lastIndexOf=function(f,b,c){if(null==f){return -1}var d=null!=c;if(ax&&f.lastIndexOf===ax){return d?f.lastIndexOf(b,c):f.lastIndexOf(b)}for(var a=d?c:f.length;a--;){if(f[a]===b){return a}}return -1},ao.range=function(g,c,d){arguments.length<=1&&(c=g||0,g=0),d=arguments[2]||1;for(var f=Math.max(Math.ceil((c-g)/d),0),a=0,b=new Array(f);f>a;){b[a++]=g,g+=d}return b};var H=function(){};ao.bind=function(d,a){var b,c;if(az&&d.bind===az){return az.apply(d,aj.call(arguments,1))}if(!ao.isFunction(d)){throw new TypeError}return b=aj.call(arguments,2),c=function(){if(!(this instanceof c)){return d.apply(a,b.concat(aj.call(arguments)))}H.prototype=d.prototype;var e=new H;H.prototype=null;var f=d.apply(e,b.concat(aj.call(arguments)));return Object(f)===f?f:e}},ao.partial=function(b){var a=aj.call(arguments,1);return function(){return b.apply(this,a.concat(aj.call(arguments)))}},ao.bindAll=function(b){var a=aj.call(arguments,1);if(0===a.length){throw new Error("bindAll must be passed function names")}return X(a,function(c){b[c]=ao.bind(b[c],b)}),b},ao.memoize=function(c,a){var b={};return a||(a=ao.identity),function(){var d=a.apply(this,arguments);return ao.has(b,d)?b[d]:b[d]=c.apply(this,arguments)}},ao.delay=function(c,a){var b=aj.call(arguments,2);return setTimeout(function(){return c.apply(null,b)},a)},ao.defer=function(a){return ao.delay.apply(ao,[a,1].concat(aj.call(arguments,1)))},ao.throttle=function(f,m,b){var h,l,g,k=null,d=0;b||(b={});var j=function(){d=b.leading===!1?0:new Date,k=null,g=f.apply(h,l)};return function(){var a=new Date;d||b.leading!==!1||(d=a);var c=m-(a-d);return h=this,l=arguments,0>=c?(clearTimeout(k),k=null,d=a,g=f.apply(h,l)):k||b.trailing===!1||(k=setTimeout(j,c)),g}},ao.debounce=function(k,f,g){var h,c,d,b,j;return function(){d=this,c=arguments,b=new Date;var e=function(){var i=new Date-b;f>i?h=setTimeout(e,f-i):(h=null,g||(j=k.apply(d,c)))},a=g&&!h;return h||(h=setTimeout(e,f)),a&&(j=k.apply(d,c)),j}},ao.once=function(c){var a,b=!1;return function(){return b?a:(b=!0,a=c.apply(this,arguments),c=null,a)}},ao.wrap=function(b,a){return function(){var c=[b];return ay.apply(c,arguments),a.apply(this,c)}},ao.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--){b=[a[c].apply(this,b)]}return b[0]}},ao.after=function(b,a){return function(){return --b<1?a.apply(this,arguments):void 0}},ao.keys=ab||function(c){if(c!==Object(c)){throw new TypeError("Invalid object")}var a=[];for(var b in c){ao.has(c,b)&&a.push(b)}return a},ao.values=function(f){for(var b=ao.keys(f),c=b.length,d=new Array(c),a=0;c>a;a++){d[a]=f[b[a]]}return d},ao.pairs=function(f){for(var b=ao.keys(f),c=b.length,d=new Array(c),a=0;c>a;a++){d[a]=[b[a],f[b[a]]]}return d},ao.invert=function(f){for(var b={},c=ao.keys(f),d=0,a=c.length;a>d;d++){b[f[c[d]]]=c[d]}return b},ao.functions=ao.methods=function(c){var a=[];for(var b in c){ao.isFunction(c[b])&&a.push(b)}return a.sort()},ao.extend=function(a){return X(aj.call(arguments,1),function(b){if(b){for(var c in b){a[c]=b[c]}}}),a},ao.pick=function(c){var a={},b=aw.apply(au,aj.call(arguments,1));return X(b,function(d){d in c&&(a[d]=c[d])}),a},ao.omit=function(d){var b={},c=aw.apply(au,aj.call(arguments,1));for(var a in d){ao.contains(c,a)||(b[a]=d[a])}return b},ao.defaults=function(a){return X(aj.call(arguments,1),function(b){if(b){for(var c in b){a[c]===void 0&&(a[c]=b[c])}}}),a},ao.clone=function(a){return ao.isObject(a)?ao.isArray(a)?a.slice():ao.extend({},a):a},ao.tap=function(b,a){return a(b),b};var G=function(g,q,b,k){if(g===q){return 0!==g||1/g==1/q}if(null==g||null==q){return g===q}g instanceof ao&&(g=g._wrapped),q instanceof ao&&(q=q._wrapped);var p=am.call(g);if(p!=am.call(q)){return !1}switch(p){case"[object String]":return g==String(q);case"[object Number]":return g!=+g?q!=+q:0==g?1/g==1/q:g==+q;case"[object Date]":case"[object Boolean]":return +g==+q;case"[object RegExp]":return g.source==q.source&&g.global==q.global&&g.multiline==q.multiline&&g.ignoreCase==q.ignoreCase}if("object"!=typeof g||"object"!=typeof q){return !1}for(var h=b.length;h--;){if(b[h]==g){return k[h]==q}}var m=g.constructor,d=q.constructor;if(m!==d&&!(ao.isFunction(m)&&m instanceof m&&ao.isFunction(d)&&d instanceof d)){return !1}b.push(g),k.push(q);var l=0,j=!0;if("[object Array]"==p){if(l=g.length,j=l==q.length){for(;l--&&(j=G(g[l],q[l],b,k));){}}}else{for(var v in g){if(ao.has(g,v)&&(l++,!(j=ao.has(q,v)&&G(g[v],q[v],b,k)))){break}}if(j){for(v in q){if(ao.has(q,v)&&!l--){break}}j=!l}}return b.pop(),k.pop(),j};ao.isEqual=function(b,a){return G(b,a,[],[])},ao.isEmpty=function(b){if(null==b){return !0}if(ao.isArray(b)||ao.isString(b)){return 0===b.length}for(var a in b){if(ao.has(b,a)){return !1}}return !0},ao.isElement=function(a){return !(!a||1!==a.nodeType)},ao.isArray=aa||function(a){return"[object Array]"==am.call(a)},ao.isObject=function(a){return a===Object(a)},X(["Arguments","Function","String","Number","Date","RegExp"],function(a){ao["is"+a]=function(b){return am.call(b)=="[object "+a+"]"}}),ao.isArguments(arguments)||(ao.isArguments=function(a){return !(!a||!ao.has(a,"callee"))}),"function"!=typeof/./&&(ao.isFunction=function(a){return"function"==typeof a}),ao.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},ao.isNaN=function(a){return ao.isNumber(a)&&a!=+a},ao.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==am.call(a)},ao.isNull=function(a){return null===a},ao.isUndefined=function(a){return a===void 0},ao.has=function(b,a){return at.call(b,a)},ao.noConflict=function(){return ak._=ae,this},ao.identity=function(a){return a},ao.times=function(f,b,c){for(var d=Array(Math.max(0,f)),a=0;f>a;a++){d[a]=b.call(c,a)}return d},ao.random=function(b,a){return null==a&&(a=b,b=0),b+Math.floor(Math.random()*(a-b+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};P.unescape=ao.invert(P.escape);var C={escape:new RegExp("["+ao.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+ao.keys(P.unescape).join("|")+")","g")};ao.each(["escape","unescape"],function(a){ao[a]=function(b){return null==b?"":(""+b).replace(C[a],function(c){return P[a][c]})}}),ao.result=function(c,a){if(null==c){return void 0}var b=c[a];return ao.isFunction(b)?b.call(c):b},ao.mixin=function(a){X(ao.functions(a),function(b){var c=ao[b]=a[b];ao.prototype[b]=function(){var d=[this._wrapped];return ay.apply(d,arguments),Y.call(this,c.apply(ao,d))}})};var K=0;ao.uniqueId=function(b){var a=++K+"";return b?b+a:a},ao.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var ah=/(.)^/,W={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g;ao.template=function(f,m,b){var h;b=ao.defaults({},b,ao.templateSettings);var l=new RegExp([(b.escape||ah).source,(b.interpolate||ah).source,(b.evaluate||ah).source].join("|")+"|$","g"),g=0,k="__p+='";f.replace(l,function(c,i,n,a,p){return k+=f.slice(g,p).replace(V,function(e){return"\\"+W[e]}),i&&(k+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(k+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),a&&(k+="';\n"+a+"\n__p+='"),g=p+c.length,c}),k+="';\n",b.variable||(k="with(obj||{}){\n"+k+"}\n"),k="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+k+"return __p;\n";try{h=new Function(b.variable||"obj","_",k)}catch(d){throw d.source=k,d}if(m){return h(m,ao)}var j=function(a){return h.call(this,a,ao)};return j.source="function("+(b.variable||"obj")+"){\n"+k+"}",j},ao.chain=function(a){return ao(a).chain()};var Y=function(a){return this._chain?ao(a).chain():a};ao.mixin(ao),X(["pop","push","reverse","shift","sort","splice","unshift"],function(b){var a=au[b];ao.prototype[b]=function(){var c=this._wrapped;return a.apply(c,arguments),"shift"!=b&&"splice"!=b||0!==c.length||delete c[0],Y.call(this,c)}}),X(["concat","join","slice"],function(b){var a=au[b];ao.prototype[b]=function(){return Y.call(this,a.apply(this._wrapped,arguments))}}),ao.extend(ao.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);(function(d){var f,a,h,c,e,b,g=[].slice;h=function(k){var j,i;if(!d.isObject(k||d.isFunction(k))){return k}if(d.isDate(k)){return new Date(k.getTime())}if(d.isRegExp(k)){return new RegExp(k.source,k.toString().replace(/.*\//,""))}i=d.isArray(k||d.isArguments(k));j=function(l,n,m){if(i){l.push(h(n))}else{l[m]=h(n)}return l};return d.reduce(k,j,i?[]:{})};b=function(i){if(i===null){return false}return(i.prototype==={}.prototype||i.prototype===Object.prototype)&&d.isObject(i)&&!d.isArray(i)&&!d.isFunction(i)&&!d.isDate(i)&&!d.isRegExp(i)&&!d.isArguments(i)};a=function(i){return d.filter(d.keys(i),function(j){return b(i[j])})};f=function(i){return d.filter(d.keys(i),function(j){return d.isArray(i[j])})};e=function(q,i,l){var s,j,t,o,p,u,n,m,r,k;if(l==null){l=20}if(l<=0){console.warn("_.deepExtend(): Maximum depth of recursion hit.");return d.extend(q,i)}u=d.intersection(a(q),a(i));j=function(v){return i[v]=e(q[v],i[v],l-1)};for(n=0,r=u.length;n<r;n++){p=u[n];j(p)}o=d.intersection(f(q),f(i));s=function(v){return i[v]=d.union(q[v],i[v])};for(m=0,k=o.length;m<k;m++){t=o[m];s(t)}return d.extend(q,i)};c=function(){var i,l,k,j;k=2<=arguments.length?g.call(arguments,0,j=arguments.length-1):(j=0,[]),l=arguments[j++];if(!d.isNumber(l)){k.push(l);l=20}if(k.length<=1){return k[0]}if(l<=0){return d.extend.apply(this,k)}i=k.shift();while(k.length>0){i=e(i,h(k.shift()),l)}return i};d.mixin({deepClone:h,isBasicObject:b,basicObjects:a,arrays:f,deepExtend:c})}).call(this,_);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/rivets.js' */
(function(){var e,g,b=function(h,i){return function(){return h.apply(i,arguments)}},f=[].slice,a={}.hasOwnProperty,d=function(k,i){for(var h in i){if(a.call(i,h)){k[h]=i[h]}}function j(){this.constructor=k}j.prototype=i.prototype;k.prototype=new j();k.__super__=i.prototype;return k},c=[].indexOf||function(k){for(var j=0,h=this.length;j<h;j++){if(j in this&&this[j]===k){return j}}return -1};e={};g=window.jQuery||window.Zepto;if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}e.Binding=(function(){function h(o,i,n,q,k,r){var l,m,p,j;this.view=o;this.el=i;this.type=n;this.key=q;this.keypath=k;this.options=r!=null?r:{};this.update=b(this.update,this);this.unbind=b(this.unbind,this);this.bind=b(this.bind,this);this.publish=b(this.publish,this);this.sync=b(this.sync,this);this.set=b(this.set,this);this.eventHandler=b(this.eventHandler,this);this.formattedValue=b(this.formattedValue,this);if(!(this.binder=this.view.binders[n])){j=this.view.binders;for(l in j){p=j[l];if(l!=="*"&&l.indexOf("*")!==-1){m=new RegExp("^"+(l.replace("*",".+"))+"$");if(m.test(n)){this.binder=p;this.args=new RegExp("^"+(l.replace("*","(.+)"))+"$").exec(n);this.args.shift()}}}}this.binder||(this.binder=this.view.binders["*"]);if(this.binder instanceof Function){this.binder={routine:this.binder}}this.formatters=this.options.formatters||[];this.model=this.key?this.view.models[this.key]:this.view.models}h.prototype.formattedValue=function(n){var j,k,o,m,i,l;l=this.formatters;for(m=0,i=l.length;m<i;m++){k=l[m];j=k.split(/\s+/);o=j.shift();k=this.model[o] instanceof Function?this.model[o]:this.view.formatters[o];if((k!=null?k.read:void 0) instanceof Function){n=k.read.apply(k,[n].concat(f.call(j)))}else{if(k instanceof Function){n=k.apply(null,[n].concat(f.call(j)))}}}return n};h.prototype.eventHandler=function(j){var k,i;i=(k=this).view.config.handler;return function(l){return i.call(j,this,l,k)}};h.prototype.set=function(j){var i;j=j instanceof Function&&!this.binder["function"]?this.formattedValue(j.call(this.model)):this.formattedValue(j);return(i=this.binder.routine)!=null?i.call(this,this.el,j):void 0};h.prototype.sync=function(){return this.set(this.options.bypass?this.model[this.keypath]:this.view.config.adapter.read(this.model,this.keypath))};h.prototype.publish=function(){var n,q,i,p,l,o,m,k,j;p=e.Util.getInputValue(this.el);m=this.formatters.slice(0).reverse();for(l=0,o=m.length;l<o;l++){q=m[l];n=q.split(/\s+/);i=n.shift();if((k=this.view.formatters[i])!=null?k.publish:void 0){p=(j=this.view.formatters[i]).publish.apply(j,[p].concat(f.call(n)))}}return this.view.config.adapter.publish(this.model,this.keypath,p)};h.prototype.bind=function(){var i,p,o,m,q,n,l,j,k;if((n=this.binder.bind)!=null){n.call(this,this.el)}if(this.options.bypass){this.sync()}else{this.view.config.adapter.subscribe(this.model,this.keypath,this.sync);if(this.view.config.preloadData){this.sync()}}if((l=this.options.dependencies)!=null?l.length:void 0){j=this.options.dependencies;k=[];for(m=0,q=j.length;m<q;m++){i=j[m];if(/^\./.test(i)){o=this.model;p=i.substr(1)}else{i=i.split(".");o=this.view.models[i.shift()];p=i.join(".")}k.push(this.view.config.adapter.subscribe(o,p,this.sync))}return k}};h.prototype.unbind=function(){var i,p,o,m,q,n,l,j,k;if((n=this.binder.unbind)!=null){n.call(this,this.el)}if(!this.options.bypass){this.view.config.adapter.unsubscribe(this.model,this.keypath,this.sync)}if((l=this.options.dependencies)!=null?l.length:void 0){j=this.options.dependencies;k=[];for(m=0,q=j.length;m<q;m++){i=j[m];if(/^\./.test(i)){o=this.model;p=i.substr(1)}else{i=i.split(".");o=this.view.models[i.shift()];p=i.join(".")}k.push(this.view.config.adapter.unsubscribe(o,p,this.sync))}return k}};h.prototype.update=function(j){var i;if(j==null){j={}}if(this.key){if(j[this.key]){if(!this.options.bypass){this.view.config.adapter.unsubscribe(this.model,this.keypath,this.sync)}this.model=j[this.key];if(this.options.bypass){this.sync()}else{this.view.config.adapter.subscribe(this.model,this.keypath,this.sync);if(this.view.config.preloadData){this.sync()}}}}else{this.sync()}return(i=this.binder.update)!=null?i.call(this,j):void 0};return h})();e.ComponentBinding=(function(h){d(i,h);function i(l,n,m){var o,q,k,p,j;this.view=l;this.el=n;this.type=m;this.unbind=b(this.unbind,this);this.bind=b(this.bind,this);this.update=b(this.update,this);this.locals=b(this.locals,this);this.component=e.components[this.type];this.attributes={};this.inflections={};p=this.el.attributes||[];for(q=0,k=p.length;q<k;q++){o=p[q];if(j=o.name,c.call(this.component.attributes,j)>=0){this.attributes[o.name]=o.value}else{this.inflections[o.name]=o.value}}}i.prototype.sync=function(){};i.prototype.locals=function(j){var m,q,o,r,s,l,p,n,k;if(j==null){j=this.view.models}s={};n=this.inflections;for(q in n){m=n[q];k=m.split(".");for(l=0,p=k.length;l<p;l++){r=k[l];s[q]=(s[q]||j)[r]}}for(q in j){o=j[q];if(s[q]==null){s[q]=o}}return s};i.prototype.update=function(k){var j;return(j=this.componentView)!=null?j.update(this.locals(k)):void 0};i.prototype.bind=function(){var j,k;if(this.componentView!=null){return(k=this.componentView)!=null?k.bind():void 0}else{j=this.component.build.call(this.attributes);(this.componentView=new e.View(j,this.locals(),this.view.options)).bind();return this.el.parentNode.replaceChild(j,this.el)}};i.prototype.unbind=function(){var j;return(j=this.componentView)!=null?j.unbind():void 0};return i})(e.Binding);e.TextBinding=(function(i){d(h,i);function h(j,o,n,m,k,l){this.view=j;this.el=o;this.type=n;this.key=m;this.keypath=k;this.options=l!=null?l:{};this.sync=b(this.sync,this);this.formatters=this.options.formatters||[];this.model=this.key?this.view.models[this.key]:this.view.models}h.prototype.binder={routine:function(j,k){return j.data=k!=null?k:""}};h.prototype.sync=function(){return h.__super__.sync.apply(this,arguments)};return h})(e.Binding);e.View=(function(){function h(o,i,u){var m,q,t,s,n,r,p,l,j;this.els=o;this.models=i;this.options=u!=null?u:{};this.update=b(this.update,this);this.publish=b(this.publish,this);this.sync=b(this.sync,this);this.unbind=b(this.unbind,this);this.bind=b(this.bind,this);this.select=b(this.select,this);this.build=b(this.build,this);this.componentRegExp=b(this.componentRegExp,this);this.bindingRegExp=b(this.bindingRegExp,this);if(typeof this.els.length==="undefined"){this.els=[this.els]}p=["config","binders","formatters"];for(n=0,r=p.length;n<r;n++){q=p[n];this[q]={};if(this.options[q]){l=this.options[q];for(m in l){t=l[m];this[q][m]=t}}j=e[q];for(m in j){t=j[m];if((s=this[q])[m]==null){s[m]=t}}}this.build()}h.prototype.bindingRegExp=function(){var i;i=this.config.prefix;if(i){return new RegExp("^data-"+i+"-")}else{return/^data-/}};h.prototype.componentRegExp=function(){var j,i;return new RegExp("^"+((j=(i=this.config.prefix)!=null?i.toUpperCase():void 0)!=null?j:"RV")+"-")};h.prototype.build=function(){var i,n,q,j,k,p,l,r,m,o=this;this.bindings=[];p=[];i=this.bindingRegExp();q=this.componentRegExp();n=function(z,w,A,u){var t,D,y,C,x,F,E,v,s,B;F={};s=(function(){var J,H,I,G;I=u.split("|");G=[];for(J=0,H=I.length;J<H;J++){v=I[J];G.push(v.trim())}return G})();t=(function(){var J,H,I,G;I=s.shift().split("<");G=[];for(J=0,H=I.length;J<H;J++){D=I[J];G.push(D.trim())}return G})();E=t.shift();B=E.split(/\.|:/);F.formatters=s;F.bypass=E.indexOf(":")!==-1;if(B[0]){C=B.shift()}else{C=null;B.shift()}x=B.join(".");if(y=t.shift()){F.dependencies=y.split(/\s+/)}return o.bindings.push(new e[z](o,w,A,C,x,F))};k=function(S){var N,K,L,E,I,C,Q,D,Y,F,H,O,J,P,G,R,z,w,u,t,V,X,W,U,T,s,M,B,A,y,v,x;if(c.call(p,S)<0){if(S.nodeType===Node.TEXT_NODE){D=e.TextTemplateParser;if(I=o.config.templateDelimiters){if((P=D.parse(S.data,I)).length){if(!(P.length===1&&P[0].type===D.types.text)){H=P[0],F=2<=P.length?f.call(P,1):[];S.data=H.value;if(H.type===0){S.data=H.value}else{n("TextBinding",S,null,H.value)}for(z=0,V=F.length;z<V;z++){J=F[z];O=document.createTextNode(J.value);S.parentNode.appendChild(O);if(J.type===1){n("TextBinding",O,null,J.value)}}}}}}else{if(q.test(S.tagName)){G=S.tagName.replace(q,"").toLowerCase();o.bindings.push(new e.ComponentBinding(o,S,G))}else{if(S.attributes!=null){M=S.attributes;for(w=0,X=M.length;w<X;w++){N=M[w];if(i.test(N.name)){G=N.name.replace(i,"");if(!(L=o.binders[G])){B=o.binders;for(C in B){R=B[C];if(C!=="*"&&C.indexOf("*")!==-1){Y=new RegExp("^"+(C.replace("*",".+"))+"$");if(Y.test(G)){L=R}}}}L||(L=o.binders["*"]);if(L.block){A=S.childNodes;for(u=0,W=A.length;u<W;u++){Q=A[u];p.push(Q)}K=[N]}}}y=K||S.attributes;for(t=0,U=y.length;t<U;t++){N=y[t];if(i.test(N.name)){G=N.name.replace(i,"");n("Binding",S,G,N.value)}}}}}v=S.childNodes;x=[];for(s=0,T=v.length;s<T;s++){E=v[s];x.push(k(E))}return x}};m=this.els;for(l=0,r=m.length;l<r;l++){j=m[l];k(j)}};h.prototype.select=function(k){var n,m,j,l,i;l=this.bindings;i=[];for(m=0,j=l.length;m<j;m++){n=l[m];if(k(n)){i.push(n)}}return i};h.prototype.bind=function(){var m,l,j,k,i;k=this.bindings;i=[];for(l=0,j=k.length;l<j;l++){m=k[l];i.push(m.bind())}return i};h.prototype.unbind=function(){var m,l,j,k,i;k=this.bindings;i=[];for(l=0,j=k.length;l<j;l++){m=k[l];i.push(m.unbind())}return i};h.prototype.sync=function(){var m,l,j,k,i;k=this.bindings;i=[];for(l=0,j=k.length;l<j;l++){m=k[l];i.push(m.sync())}return i};h.prototype.publish=function(){var m,l,j,k,i;k=this.select(function(n){return n.binder.publishes});i=[];for(l=0,j=k.length;l<j;l++){m=k[l];i.push(m.publish())}return i};h.prototype.update=function(p){var o,l,k,n,j,m,i;if(p==null){p={}}for(l in p){k=p[l];this.models[l]=k}m=this.bindings;i=[];for(n=0,j=m.length;n<j;n++){o=m[n];i.push(o.update(p))}return i};return h})();e.TextTemplateParser=(function(){function h(){}h.types={text:0,binding:1};h.parse=function(q,o){var m,k,j,i,l,n,p;n=[];i=q.length;m=0;k=0;while(k<i){m=q.indexOf(o[0],k);if(m<0){n.push({type:this.types.text,value:q.slice(k)});break}else{if(m>0&&k<m){n.push({type:this.types.text,value:q.slice(k,m)})}k=m+2;m=q.indexOf(o[1],k);if(m<0){l=q.slice(k-2);j=n[n.length-1];if((j!=null?j.type:void 0)===this.types.text){j.value+=l}else{n.push({type:this.types.text,value:l})}break}p=q.slice(k,m).trim();n.push({type:this.types.binding,value:p});k=m+2}}return n};return h})();e.Util={bindEvent:function(i,j,h){if(window.jQuery!=null){i=g(i);if(i.on!=null){return i.on(j,h)}else{return i.bind(j,h)}}else{if(window.addEventListener!=null){return i.addEventListener(j,h,false)}else{j="on"+j;return i.attachEvent(j,h)}}},unbindEvent:function(i,j,h){if(window.jQuery!=null){i=g(i);if(i.off!=null){return i.off(j,h)}else{return i.unbind(j,h)}}else{if(window.removeEventListener!=null){return i.removeEventListener(j,h,false)}else{j="on"+j;return i.detachEvent(j,h)}}},getInputValue:function(j){var l,k,i,h;if(window.jQuery!=null){j=g(j);switch(j[0].type){case"checkbox":return j.is(":checked");default:return j.val()}}else{switch(j.type){case"checkbox":return j.checked;case"select-multiple":h=[];for(k=0,i=j.length;k<i;k++){l=j[k];if(l.selected){h.push(l.value)}}return h;break;default:return j.value}}}};e.binders={enabled:function(h,i){return h.disabled=!i},disabled:function(h,i){return h.disabled=!!i},checked:{publishes:true,bind:function(h){return e.Util.bindEvent(h,"change",this.publish)},unbind:function(h){return e.Util.unbindEvent(h,"change",this.publish)},routine:function(h,j){var i;if(h.type==="radio"){return h.checked=((i=h.value)!=null?i.toString():void 0)===(j!=null?j.toString():void 0)}else{return h.checked=!!j}}},unchecked:{publishes:true,bind:function(h){return e.Util.bindEvent(h,"change",this.publish)},unbind:function(h){return e.Util.unbindEvent(h,"change",this.publish)},routine:function(h,j){var i;if(h.type==="radio"){return h.checked=((i=h.value)!=null?i.toString():void 0)!==(j!=null?j.toString():void 0)}else{return h.checked=!j}}},show:function(h,i){return h.style.display=i?"":"none"},hide:function(h,i){return h.style.display=i?"none":""},html:function(h,i){return h.innerHTML=i!=null?i:""},value:{publishes:true,bind:function(h){return e.Util.bindEvent(h,"change",this.publish)},unbind:function(h){return e.Util.unbindEvent(h,"change",this.publish)},routine:function(i,q){var h,m,p,n,l,j,k;if(window.jQuery!=null){i=g(i);if((q!=null?q.toString():void 0)!==((n=i.val())!=null?n.toString():void 0)){return i.val(q!=null?q:"")}}else{if(i.type==="select-multiple"){if(q!=null){k=[];for(m=0,p=i.length;m<p;m++){h=i[m];k.push(h.selected=(l=h.value,c.call(q,l)>=0))}return k}}else{if((q!=null?q.toString():void 0)!==((j=i.value)!=null?j.toString():void 0)){return i.value=q!=null?q:""}}}}},text:function(h,i){if(h.innerText!=null){return h.innerText=i!=null?i:""}else{return h.textContent=i!=null?i:""}},"if":{block:true,bind:function(i){var h,j;if(this.marker==null){h=["data",this.view.config.prefix,this.type].join("-").replace("--","-");j=i.getAttribute(h);this.marker=document.createComment(" rivets: "+this.type+" "+j+" ");i.removeAttribute(h);i.parentNode.insertBefore(this.marker,i);return i.parentNode.removeChild(i)}},unbind:function(){var h;return(h=this.nested)!=null?h.unbind():void 0},routine:function(k,m){var j,i,n,h,l;if(!!m===(this.nested==null)){if(m){n={};l=this.view.models;for(j in l){i=l[j];n[j]=i}h={binders:this.view.options.binders,formatters:this.view.options.formatters,config:this.view.options.config};(this.nested=new e.View(k,n,h)).bind();return this.marker.parentNode.insertBefore(k,this.marker.nextSibling)}else{k.parentNode.removeChild(k);this.nested.unbind();return delete this.nested}}},update:function(i){var h;return(h=this.nested)!=null?h.update(i):void 0}},unless:{block:true,bind:function(h){return e.binders["if"].bind.call(this,h)},unbind:function(){return e.binders["if"].unbind.call(this)},routine:function(h,i){return e.binders["if"].routine.call(this,h,!i)},update:function(h){return e.binders["if"].update.call(this,h)}},"on-*":{"function":true,unbind:function(h){if(this.handler){return e.Util.unbindEvent(h,this.args[0],this.handler)}},routine:function(h,i){if(this.handler){e.Util.unbindEvent(h,this.args[0],this.handler)}return e.Util.bindEvent(h,this.args[0],this.handler=this.eventHandler(i))}},"each-*":{block:true,bind:function(i){var h;if(this.marker==null){h=["data",this.view.config.prefix,this.type].join("-").replace("--","-");this.marker=document.createComment(" rivets: "+this.type+" ");this.iterated=[];i.removeAttribute(h);i.parentNode.insertBefore(this.marker,i);return i.parentNode.removeChild(i)}},unbind:function(k){var j,m,i,l,h;if(this.iterated!=null){l=this.iterated;h=[];for(m=0,i=l.length;m<i;m++){j=l[m];h.push(j.unbind())}return h}},routine:function(j,x){var E,A,s,z,F,r,y,q,p,C,u,w,m,h,B,D,t,o,n,l;y=this.args[0];x=x||[];if(this.iterated.length>x.length){t=Array(this.iterated.length-x.length);for(m=0,B=t.length;m<B;m++){A=t[m];w=this.iterated.pop();w.unbind();this.marker.parentNode.removeChild(w.els[0])}}l=[];for(s=h=0,D=x.length;h<D;s=++h){r=x[s];E={};E[y]=r;if(this.iterated[s]==null){o=this.view.models;for(F in o){r=o[F];if(E[F]==null){E[F]=r}}p=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker;q={binders:this.view.options.binders,formatters:this.view.options.formatters,config:{}};n=this.view.options.config;for(z in n){u=n[z];q.config[z]=u}q.config.preloadData=true;C=j.cloneNode(true);w=new e.View(C,E,q);w.bind();this.iterated.push(w);l.push(this.marker.parentNode.insertBefore(C,p.nextSibling))}else{if(this.iterated[s].models[y]!==r){l.push(this.iterated[s].update(E))}else{l.push(void 0)}}}return l},update:function(h){var k,p,m,n,j,o,l,i;k={};for(p in h){m=h[p];if(p!==this.args[0]){k[p]=m}}l=this.iterated;i=[];for(j=0,o=l.length;j<o;j++){n=l[j];i.push(n.update(k))}return i}},"class-*":function(h,j){var i;i=" "+h.className+" ";if(!j===(i.indexOf(" "+this.args[0]+" ")!==-1)){return h.className=j?""+h.className+" "+this.args[0]:i.replace(" "+this.args[0]+" "," ").trim()}},"*":function(h,i){if(i){return h.setAttribute(this.type,i)}else{return h.removeAttribute(this.type)}}};e.components={};e.config={preloadData:true,handler:function(h,i,j){return this.call(h,i,j.view.models)}};e.formatters={};e.factory=function(h){h._=e;h.binders=e.binders;h.components=e.components;h.formatters=e.formatters;h.config=e.config;h.configure=function(i){var k,j;if(i==null){i={}}for(k in i){j=i[k];e.config[k]=j}};return h.bind=function(k,l,j){var i;if(l==null){l={}}if(j==null){j={}}i=new e.View(k,l,j);i.bind();return i}};if(typeof exports==="object"){e.factory(exports)}else{if(typeof define==="function"&&define.amd){define(["exports"],function(h){e.factory(this.rivets=h);return h})}else{e.factory(this.rivets={})}}}).call(this);(function(){rivets.binders.input={publishes:true,routine:rivets.binders.value.routine,bind:function(a){return $(a).bind("input.rivets",this.publish)},unbind:function(a){return $(a).unbind("input.rivets")}};rivets.configure({prefix:"rv",adapter:{subscribe:function(b,a,c){c.wrapped=function(d,e){return c(e)};return b.on("change:"+a,c.wrapped)},unsubscribe:function(b,a,c){return b.off("change:"+a,c.wrapped)},read:function(b,a){if(a==="cid"){return b.cid}return b.get(a)},publish:function(c,a,b){if(c.cid){return c.set(a,b)}else{return c[a]=b}}}})}).call(this);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/backbone.js' */
(function(a,b){a.Backbone=b(a,{},a._,(a.jQuery||a.Zepto||a.ender||a.$))}(this,function(v,B,N,z){var D=v.Backbone;var g=[];var F=g.push;var o=g.slice;var u=g.splice;B.VERSION="1.1.2";B.$=z;B.noConflict=function(){v.Backbone=D;return this};B.emulateHTTP=false;B.emulateJSON=false;var L=B.Events={on:function(O,R,Q){if(!y(this,"on",O,[R,Q])||!R){return this}this._events||(this._events={});var P=this._events[O]||(this._events[O]=[]);P.push({callback:R,context:Q,ctx:Q||this});return this},once:function(P,S,Q){if(!y(this,"once",P,[S,Q])||!S){return this}var O=this;var R=N.once(function(){O.off(P,R);S.apply(this,arguments)});R._callback=S;return this.on(P,R,Q)},off:function(O,X,P){var V,W,Y,U,T,Q,S,R;if(!this._events||!y(this,"off",O,[X,P])){return this}if(!O&&!X&&!P){this._events=void 0;return this}U=O?[O]:N.keys(this._events);for(T=0,Q=U.length;T<Q;T++){O=U[T];if(Y=this._events[O]){this._events[O]=V=[];if(X||P){for(S=0,R=Y.length;S<R;S++){W=Y[S];if((X&&X!==W.callback&&X!==W.callback._callback)||(P&&P!==W.context)){V.push(W)}}}if(!V.length){delete this._events[O]}}}return this},trigger:function(Q){if(!this._events){return this}var P=o.call(arguments,1);if(!y(this,"trigger",Q,P)){return this}var R=this._events[Q];var O=this._events.all;if(R){b(R,P)}if(O){b(O,arguments)}return this},stopListening:function(R,P,T){var Q=this._listeningTo;if(!Q){return this}var O=!P&&!T;if(!T&&typeof P==="object"){T=this}if(R){(Q={})[R._listenId]=R}for(var S in Q){R=Q[S];R.off(P,T,this);if(O||N.isEmpty(R._events)){delete this._listeningTo[S]}}return this}};var x=/\s+/;var y=function(V,T,P,S){if(!P){return true}if(typeof P==="object"){for(var R in P){V[T].apply(V,[R,P[R]].concat(S))}return false}if(x.test(P)){var U=P.split(x);for(var Q=0,O=U.length;Q<O;Q++){V[T].apply(V,[U[Q]].concat(S))}return false}return true};var b=function(T,R){var U,S=-1,Q=T.length,P=R[0],O=R[1],V=R[2];switch(R.length){case 0:while(++S<Q){(U=T[S]).callback.call(U.ctx)}return;case 1:while(++S<Q){(U=T[S]).callback.call(U.ctx,P)}return;case 2:while(++S<Q){(U=T[S]).callback.call(U.ctx,P,O)}return;case 3:while(++S<Q){(U=T[S]).callback.call(U.ctx,P,O,V)}return;default:while(++S<Q){(U=T[S]).callback.apply(U.ctx,R)}return}};var E={listenTo:"on",listenToOnce:"once"};N.each(E,function(O,P){L[P]=function(S,Q,U){var R=this._listeningTo||(this._listeningTo={});var T=S._listenId||(S._listenId=N.uniqueId("l"));R[T]=S;if(!U&&typeof Q==="object"){U=this}S[O](Q,U,this);return this}});L.bind=L.on;L.unbind=L.off;N.extend(B,L);var G=B.Model=function(O,Q){var P=O||{};Q||(Q={});this.cid=N.uniqueId("c");this.attributes={};if(Q.collection){this.collection=Q.collection}if(Q.parse){P=this.parse(P,Q)||{}}P=N.defaults({},P,N.result(this,"defaults"));this.set(P,Q);this.changed={};this.initialize.apply(this,arguments)};N.extend(G.prototype,L,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(O){return N.clone(this.attributes)},sync:function(){return B.sync.apply(this,arguments)},get:function(O){return this.attributes[O]},escape:function(O){return N.escape(this.get(O))},has:function(O){return this.get(O)!=null},set:function(W,O,aa){var U,X,Y,V,T,Z,Q,S;if(W==null){return this}if(typeof W==="object"){X=W;aa=O}else{(X={})[W]=O}aa||(aa={});if(!this._validate(X,aa)){return false}Y=aa.unset;T=aa.silent;V=[];Z=this._changing;this._changing=true;if(!Z){this._previousAttributes=N.clone(this.attributes);this.changed={}}S=this.attributes,Q=this._previousAttributes;if(this.idAttribute in X){this.id=X[this.idAttribute]}for(U in X){O=X[U];if(!N.isEqual(S[U],O)){V.push(U)}if(!N.isEqual(Q[U],O)){this.changed[U]=O}else{delete this.changed[U]}Y?delete S[U]:S[U]=O}if(!T){if(V.length){this._pending=aa}for(var R=0,P=V.length;R<P;R++){this.trigger("change:"+V[R],this,S[V[R]],aa)}}if(Z){return this}if(!T){while(this._pending){aa=this._pending;this._pending=false;this.trigger("change",this,aa)}}this._pending=false;this._changing=false;return this},unset:function(O,P){return this.set(O,void 0,N.extend({},P,{unset:true}))},clear:function(P){var O={};for(var Q in this.attributes){O[Q]=void 0}return this.set(O,N.extend({},P,{unset:true}))},hasChanged:function(O){if(O==null){return !N.isEmpty(this.changed)}return N.has(this.changed,O)},changedAttributes:function(Q){if(!Q){return this.hasChanged()?N.clone(this.changed):false}var S,R=false;var P=this._changing?this._previousAttributes:this.attributes;for(var O in Q){if(N.isEqual(P[O],(S=Q[O]))){continue}(R||(R={}))[O]=S}return R},previous:function(O){if(O==null||!this._previousAttributes){return null}return this._previousAttributes[O]},previousAttributes:function(){return N.clone(this._previousAttributes)},fetch:function(P){P=P?N.clone(P):{};if(P.parse===void 0){P.parse=true}var O=this;var Q=P.success;P.success=function(R){if(!O.set(O.parse(R,P),P)){return false}if(Q){Q(O,R,P)}O.trigger("sync",O,R,P)};J(this,P);return this.sync("read",this,P)},save:function(S,P,W){var T,O,V,Q=this.attributes;if(S==null||typeof S==="object"){T=S;W=P}else{(T={})[S]=P}W=N.extend({validate:true},W);if(T&&!W.wait){if(!this.set(T,W)){return false}}else{if(!this._validate(T,W)){return false}}if(T&&W.wait){this.attributes=N.extend({},Q,T)}if(W.parse===void 0){W.parse=true}var R=this;var U=W.success;W.success=function(Y){R.attributes=Q;var X=R.parse(Y,W);if(W.wait){X=N.extend(T||{},X)}if(N.isObject(X)&&!R.set(X,W)){return false}if(U){U(R,Y,W)}R.trigger("sync",R,Y,W)};J(this,W);O=this.isNew()?"create":(W.patch?"patch":"update");if(O==="patch"){W.attrs=T}V=this.sync(O,this,W);if(T&&W.wait){this.attributes=Q}return V},destroy:function(P){P=P?N.clone(P):{};var O=this;var S=P.success;var Q=function(){O.trigger("destroy",O,O.collection,P)};P.success=function(T){if(P.wait||O.isNew()){Q()}if(S){S(O,T,P)}if(!O.isNew()){O.trigger("sync",O,T,P)}};if(this.isNew()){P.success();return false}J(this,P);var R=this.sync("delete",this,P);if(!P.wait){Q()}return R},url:function(){var O=N.result(this,"urlRoot")||N.result(this.collection,"url")||s();if(this.isNew()){return O}return O.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(P,O){return P},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return !this.has(this.idAttribute)},isValid:function(O){return this._validate({},N.extend(O||{},{validate:true}))},_validate:function(Q,P){if(!P.validate||!this.validate){return true}Q=N.extend({},this.attributes,Q);var O=this.validationError=this.validate(Q,P)||null;if(!O){return true}this.trigger("invalid",this,O,N.extend(P,{validationError:O}));return false}});var a=["keys","values","pairs","invert","pick","omit"];N.each(a,function(O){G.prototype[O]=function(){var P=o.call(arguments);P.unshift(this.attributes);return N[O].apply(N,P)}});var c=B.Collection=function(P,O){O||(O={});if(O.model){this.model=O.model}if(O.comparator!==void 0){this.comparator=O.comparator}this._reset();this.initialize.apply(this,arguments);if(P){this.reset(P,N.extend({silent:true},O))}};var p={add:true,remove:true,merge:true};var M={add:true,remove:false};N.extend(c.prototype,L,{model:G,initialize:function(){},toJSON:function(O){return this.map(function(P){return P.toJSON(O)})},sync:function(){return B.sync.apply(this,arguments)},add:function(P,O){return this.set(P,N.extend({merge:false},O,M))},remove:function(U,R){var T=!N.isArray(U);U=T?[U]:N.clone(U);R||(R={});var S,O,Q,P;for(S=0,O=U.length;S<O;S++){P=U[S]=this.get(U[S]);if(!P){continue}delete this._byId[P.id];delete this._byId[P.cid];Q=this.indexOf(P);this.models.splice(Q,1);this.length--;if(!R.silent){R.index=Q;P.trigger("remove",P,this,R)}this._removeReference(P,R)}return T?U[0]:U},set:function(ah,P){P=N.defaults({},P,p);if(P.parse){ah=this.parse(ah,P)}var S=!N.isArray(ah);ah=S?(ah?[ah]:[]):N.clone(ah);var ad,ab,X,Q,Z,W,ag;var U=P.at;var af=this.model;var O=this.comparator&&(U==null)&&P.sort!==false;var ae=N.isString(this.comparator)?this.comparator:null;var aj=[],aa=[],Y={};var V=P.add,R=P.merge,ai=P.remove;var ac=!O&&V&&ai?[]:false;for(ad=0,ab=ah.length;ad<ab;ad++){Z=ah[ad]||{};if(Z instanceof G){X=Q=Z}else{X=Z[af.prototype.idAttribute||"id"]}if(W=this.get(X)){if(ai){Y[W.cid]=true}if(R){Z=Z===Q?Q.attributes:Z;if(P.parse){Z=W.parse(Z,P)}W.set(Z,P);if(O&&!ag&&W.hasChanged(ae)){ag=true}}ah[ad]=W}else{if(V){Q=ah[ad]=this._prepareModel(Z,P);if(!Q){continue}aj.push(Q);this._addReference(Q,P)}}Q=W||Q;if(ac&&(Q.isNew()||!Y[Q.id])){ac.push(Q)}Y[Q.id]=true}if(ai){for(ad=0,ab=this.length;ad<ab;++ad){if(!Y[(Q=this.models[ad]).cid]){aa.push(Q)}}if(aa.length){this.remove(aa,P)}}if(aj.length||(ac&&ac.length)){if(O){ag=true}this.length+=aj.length;if(U!=null){for(ad=0,ab=aj.length;ad<ab;ad++){this.models.splice(U+ad,0,aj[ad])}}else{if(ac){this.models.length=0}var T=ac||aj;for(ad=0,ab=T.length;ad<ab;ad++){this.models.push(T[ad])}}}if(ag){this.sort({silent:true})}if(!P.silent){for(ad=0,ab=aj.length;ad<ab;ad++){(Q=aj[ad]).trigger("add",Q,this,P)}if(ag||(ac&&ac.length)){this.trigger("sort",this,P)}}return S?ah[0]:ah},reset:function(R,P){P||(P={});for(var Q=0,O=this.models.length;Q<O;Q++){this._removeReference(this.models[Q],P)}P.previousModels=this.models;this._reset();R=this.add(R,N.extend({silent:true},P));if(!P.silent){this.trigger("reset",this,P)}return R},push:function(P,O){return this.add(P,N.extend({at:this.length},O))},pop:function(P){var O=this.at(this.length-1);this.remove(O,P);return O},unshift:function(P,O){return this.add(P,N.extend({at:0},O))},shift:function(P){var O=this.at(0);this.remove(O,P);return O},slice:function(){return o.apply(this.models,arguments)},get:function(O){if(O==null){return void 0}return this._byId[O]||this._byId[O.id]||this._byId[O.cid]},at:function(O){return this.models[O]},where:function(O,P){if(N.isEmpty(O)){return P?void 0:[]}return this[P?"find":"filter"](function(Q){for(var R in O){if(O[R]!==Q.get(R)){return false}}return true})},findWhere:function(O){return this.where(O,true)},sort:function(O){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}O||(O={});if(N.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(N.bind(this.comparator,this))}if(!O.silent){this.trigger("sort",this,O)}return this},pluck:function(O){return N.invoke(this.models,"get",O)},fetch:function(O){O=O?N.clone(O):{};if(O.parse===void 0){O.parse=true}var Q=O.success;var P=this;O.success=function(R){var S=O.reset?"reset":"set";P[S](R,O);if(Q){Q(P,R,O)}P.trigger("sync",P,R,O)};J(this,O);return this.sync("read",this,O)},create:function(P,O){O=O?N.clone(O):{};if(!(P=this._prepareModel(P,O))){return false}if(!O.wait){this.add(P,O)}var R=this;var Q=O.success;O.success=function(S,T){if(O.wait){R.add(S,O)}if(Q){Q(S,T,O)}};P.save(null,O);return P},parse:function(P,O){return P},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(Q,P){if(Q instanceof G){return Q}P=P?N.clone(P):{};P.collection=this;var O=new this.model(Q,P);if(!O.validationError){return O}this.trigger("invalid",this,O.validationError,P);return false},_addReference:function(P,O){this._byId[P.cid]=P;if(P.id!=null){this._byId[P.id]=P}if(!P.collection){P.collection=this}P.on("all",this._onModelEvent,this)},_removeReference:function(P,O){if(this===P.collection){delete P.collection}P.off("all",this._onModelEvent,this)},_onModelEvent:function(Q,P,R,O){if((Q==="add"||Q==="remove")&&R!==this){return}if(Q==="destroy"){this.remove(P,O)}if(P&&Q==="change:"+P.idAttribute){delete this._byId[P.previous(P.idAttribute)];if(P.id!=null){this._byId[P.id]=P}}this.trigger.apply(this,arguments)}});var A=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];N.each(A,function(O){c.prototype[O]=function(){var P=o.call(arguments);P.unshift(this.models);return N[O].apply(N,P)}});var l=["groupBy","countBy","sortBy","indexBy"];N.each(l,function(O){c.prototype[O]=function(R,P){var Q=N.isFunction(R)?R:function(S){return S.get(R)};return N[O](this.models,Q,P)}});var I=B.View=function(O){this.cid=N.uniqueId("view");O||(O={});N.extend(this,N.pick(O,e));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var w=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];N.extend(I.prototype,L,{tagName:"div",$:function(O){return this.$el.find(O)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(O,P){if(this.$el){this.undelegateEvents()}this.$el=O instanceof B.$?O:B.$(O);this.el=this.$el[0];if(P!==false){this.delegateEvents()}return this},delegateEvents:function(S){if(!(S||(S=N.result(this,"events")))){return this}this.undelegateEvents();for(var R in S){var T=S[R];if(!N.isFunction(T)){T=this[S[R]]}if(!T){continue}var Q=R.match(w);var P=Q[1],O=Q[2];T=N.bind(T,this);P+=".delegateEvents"+this.cid;if(O===""){this.$el.on(P,T)}else{this.$el.on(P,O,T)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_ensureElement:function(){if(!this.el){var O=N.extend({},N.result(this,"attributes"));if(this.id){O.id=N.result(this,"id")}if(this.className){O["class"]=N.result(this,"className")}var P=B.$("<"+N.result(this,"tagName")+">").attr(O);this.setElement(P,false)}else{this.setElement(N.result(this,"el"),false)}}});B.sync=function(U,P,O){var R=k[U];N.defaults(O||(O={}),{emulateHTTP:B.emulateHTTP,emulateJSON:B.emulateJSON});var T={type:R,dataType:"json"};if(!O.url){T.url=N.result(P,"url")||s()}if(O.data==null&&P&&(U==="create"||U==="update"||U==="patch")){T.contentType="application/json";T.data=JSON.stringify(O.attrs||P.toJSON(O))}if(O.emulateJSON){T.contentType="application/x-www-form-urlencoded";T.data=T.data?{model:T.data}:{}}if(O.emulateHTTP&&(R==="PUT"||R==="DELETE"||R==="PATCH")){T.type="POST";if(O.emulateJSON){T.data._method=R}var Q=O.beforeSend;O.beforeSend=function(V){V.setRequestHeader("X-HTTP-Method-Override",R);if(Q){return Q.apply(this,arguments)}}}if(T.type!=="GET"&&!O.emulateJSON){T.processData=false}if(T.type==="PATCH"&&j){T.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var S=O.xhr=B.ajax(N.extend(T,O));P.trigger("request",P,S,O);return S};var j=typeof window!=="undefined"&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};B.ajax=function(){return B.$.ajax.apply(B.$,arguments)};var q=B.Router=function(O){O||(O={});if(O.routes){this.routes=O.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var r=/\((.*?)\)/g;var t=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;N.extend(q.prototype,L,{initialize:function(){},route:function(P,Q,R){if(!N.isRegExp(P)){P=this._routeToRegExp(P)}if(N.isFunction(Q)){R=Q;Q=""}if(!R){R=this[Q]}var O=this;B.history.route(P,function(T){var S=O._extractParameters(P,T);O.execute(R,S);O.trigger.apply(O,["route:"+Q].concat(S));O.trigger("route",Q,S);B.history.trigger("route",O,Q,S)});return this},execute:function(P,O){if(P){P.apply(this,O)}},navigate:function(P,O){B.history.navigate(P,O);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=N.result(this,"routes");var P,O=N.keys(this.routes);while((P=O.pop())!=null){this.route(P,this.routes[P])}},_routeToRegExp:function(O){O=O.replace(h,"\\$&").replace(r,"(?:$1)?").replace(t,function(Q,P){return P?Q:"([^/?]+)"}).replace(d,"([^?]*?)");return new RegExp("^"+O+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(O,P){var Q=O.exec(P).slice(1);return N.map(Q,function(S,R){if(R===Q.length-1){return S||null}return S?decodeURIComponent(S):null})}});var i=B.History=function(){this.handlers=[];N.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var C=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var K=/msie [\w.]+/;var n=/\/$/;var H=/#.*$/;i.started=false;N.extend(i.prototype,L,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(P){var O=(P||this).location.href.match(/#(.*)$/);return O?O[1]:""},getFragment:function(Q,P){if(Q==null){if(this._hasPushState||!this._wantsHashChange||P){Q=decodeURI(this.location.pathname+this.location.search);var O=this.root.replace(n,"");if(!Q.indexOf(O)){Q=Q.slice(O.length)}}else{Q=this.getHash()}}return Q.replace(C,"")},start:function(Q){if(i.started){throw new Error("Backbone.history has already been started")}i.started=true;this.options=N.extend({root:"/"},this.options,Q);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var P=this.getFragment();var O=document.documentMode;var R=(K.exec(navigator.userAgent.toLowerCase())&&(!O||O<=7));this.root=("/"+this.root+"/").replace(f,"/");if(R&&this._wantsHashChange){var T=B.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=T.hide().appendTo("body")[0].contentWindow;this.navigate(P)}if(this._hasPushState){B.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!R){B.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=P;var S=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){this.fragment=this.getFragment(null,true);this.location.replace(this.root+"#"+this.fragment);return true}else{if(this._hasPushState&&this.atRoot()&&S.hash){this.fragment=this.getHash().replace(C,"");this.history.replaceState({},document.title,this.root+this.fragment)}}}if(!this.options.silent){return this.loadUrl()}},stop:function(){B.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);if(this._checkUrlInterval){clearInterval(this._checkUrlInterval)}i.started=false},route:function(O,P){this.handlers.unshift({route:O,callback:P})},checkUrl:function(P){var O=this.getFragment();if(O===this.fragment&&this.iframe){O=this.getFragment(this.getHash(this.iframe))}if(O===this.fragment){return false}if(this.iframe){this.navigate(O)}this.loadUrl()},loadUrl:function(O){O=this.fragment=this.getFragment(O);return N.any(this.handlers,function(P){if(P.route.test(O)){P.callback(O);return true}})},navigate:function(Q,P){if(!i.started){return false}if(!P||P===true){P={trigger:!!P}}var O=this.root+(Q=this.getFragment(Q||""));Q=Q.replace(H,"");if(this.fragment===Q){return}this.fragment=Q;if(Q===""&&O!=="/"){O=O.slice(0,-1)}if(this._hasPushState){this.history[P.replace?"replaceState":"pushState"]({},document.title,O)}else{if(this._wantsHashChange){this._updateHash(this.location,Q,P.replace);if(this.iframe&&(Q!==this.getFragment(this.getHash(this.iframe)))){if(!P.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,Q,P.replace)}}else{return this.location.assign(O)}}if(P.trigger){return this.loadUrl(Q)}},_updateHash:function(O,Q,R){if(R){var P=O.href.replace(/(javascript:|#).*$/,"");O.replace(P+"#"+Q)}else{O.hash="#"+Q}}});B.history=new i;var m=function(O,Q){var P=this;var S;if(O&&N.has(O,"constructor")){S=O.constructor}else{S=function(){return P.apply(this,arguments)}}N.extend(S,P,Q);var R=function(){this.constructor=S};R.prototype=P.prototype;S.prototype=new R;if(O){N.extend(S.prototype,O)}S.__super__=P.prototype;return S};G.extend=c.extend=q.extend=I.extend=i.extend=m;var s=function(){throw new Error('A "url" property or function must be specified')};var J=function(Q,P){var O=P.error;P.error=function(R){if(O){O(Q,R,P)}Q.trigger("error",Q,R,P)}};return B}));(function(a){a(_,Backbone)}(function(c,g){function e(n){var h={},m=b.keyPathSeparator;for(var i in n){var o=n[i];if(o&&o.constructor===Object&&!c.isEmpty(o)){var l=e(o);for(var j in l){var k=l[j];h[i+m+j]=k}}else{h[i]=o}}return h}function f(p,o,l){var m=b.keyPathSeparator;var j=o.split(m);var h=p;l||(l===false);for(var k=0,q=j.length;k<q;k++){if(l&&!c.has(h,j[k])){return false}h=h[j[k]];if(h==null&&k<q-1){h={}}if(typeof h==="undefined"){if(l){return true}return h}}if(l){return true}return h}function a(k,q,j,r){r=r||{};var m=b.keyPathSeparator;var o=q.split(m);var s=k;for(var l=0,h=o.length;l<h&&s!==undefined;l++){var p=o[l];if(l===h-1){r.unset?delete s[p]:s[p]=j}else{if(typeof s[p]==="undefined"||!c.isObject(s[p])){s[p]={}}s=s[p]}}}function d(i,h){a(i,h,null,{unset:true})}var b=g.Model.extend({constructor:function(h,j){var k;var i=h||{};this.cid=c.uniqueId("c");this.attributes={};if(j&&j.collection){this.collection=j.collection}if(j&&j.parse){i=this.parse(i,j)||{}}if(k=c.result(this,"defaults")){i=c.deepExtend({},k,i)}this.set(i,j);this.changed={};this.initialize.apply(this,arguments)},toJSON:function(h){return c.deepClone(this.attributes)},get:function(h){return f(this.attributes,h)},set:function(A,B,m){var u,r,j,z,y,k,p,s;if(A==null){return this}if(typeof A==="object"){r=A;m=B||{}}else{(r={})[A]=B}m||(m={});if(!this._validate(r,m)){return false}j=m.unset;y=m.silent;z=[];k=this._changing;this._changing=true;if(!k){this._previousAttributes=c.deepClone(this.attributes);this.changed={}}s=this.attributes,p=this._previousAttributes;if(this.idAttribute in r){this.id=r[this.idAttribute]}r=e(r);for(u in r){B=r[u];if(!c.isEqual(f(s,u),B)){z.push(u)}if(!c.isEqual(f(p,u),B)){a(this.changed,u,B)}else{d(this.changed,u)}j?d(s,u):a(s,u,B)}if(!y){if(z.length){this._pending=true}var o=b.keyPathSeparator;for(var x=0,v=z.length;x<v;x++){var A=z[x];this.trigger("change:"+A,this,f(s,A),m);var q=A.split(o);for(var t=q.length-1;t>0;t--){var w=c.first(q,t).join(o),h=w+o+"*";this.trigger("change:"+h,this,f(s,w),m)}}}if(k){return this}if(!y){while(this._pending){this._pending=false;this.trigger("change",this,m)}}this._pending=false;this._changing=false;return this},clear:function(i){var h={};var k=e(this.attributes);for(var j in k){h[j]=void 0}return this.set(h,c.extend({},i,{unset:true}))},hasChanged:function(h){if(h==null){return !c.isEmpty(this.changed)}return f(this.changed,h)!==undefined},changedAttributes:function(j){if(!j){return this.hasChanged()?e(this.changed):false}var i=this._changing?this._previousAttributes:this.attributes;j=e(j);i=e(i);var l,k=false;for(var h in j){if(c.isEqual(i[h],(l=j[h]))){continue}(k||(k={}))[h]=l}return k},previous:function(h){if(h==null||!this._previousAttributes){return null}return f(this._previousAttributes,h)},previousAttributes:function(){return c.deepClone(this._previousAttributes)}});b.keyPathSeparator=".";g.DeepModel=b;if(typeof module!="undefined"){module.exports=b}return g}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/formbuilder.js' */
(function(j,n,m){var h,o,g,l,p,a,i,f,d,c,b,k={}.hasOwnProperty,e=function(t,r){for(var q in r){if(k.call(r,q)){t[q]=r[q]}}function s(){this.constructor=t}s.prototype=r.prototype;t.prototype=new s();t.__super__=r.prototype;return t};p=(function(r){e(q,r);function q(){i=q.__super__.constructor.apply(this,arguments);return i}q.prototype.sync=function(){};q.prototype.indexInDOM=function(){var s,t=this;s=j(".fb-field-wrapper").filter((function(u,v){return j(v).data("cid")===t.cid}));return j(".fb-field-wrapper").index(s)};q.prototype.is_input=function(){return g.inputFields[this.get(g.options.mappings.FIELD_TYPE)]!=null};return q})(m.DeepModel);l=(function(r){e(q,r);function q(){f=q.__super__.constructor.apply(this,arguments);return f}q.prototype.initialize=function(){return this.on("add",this.copyCidToModel)};q.prototype.model=p;q.prototype.comparator=function(s){return s.indexInDOM()};q.prototype.copyCidToModel=function(s){return s.attributes.cid=s.cid};return q})(m.Collection);a=(function(r){e(q,r);function q(){d=q.__super__.constructor.apply(this,arguments);return d}q.prototype.className="fb-field-wrapper";q.prototype.events={"click .subtemplate-wrapper":"focusEditView","click .js-duplicate":"duplicate","click .js-clear":"clear"};q.prototype.initialize=function(s){this.parentView=s.parentView;this.listenTo(this.model,"change",this.render);return this.listenTo(this.model,"destroy",this.remove)};q.prototype.render=function(){this.$el.addClass("response-field-"+this.model.get(g.options.mappings.FIELD_TYPE)).html(g.templates["view/base"+(!this.model.is_input()?"_non_input":"")]({rf:this.model}));this.$el.attr("data-cid",this.model.cid);return this};q.prototype.focusEditView=function(){return this.parentView.createAndShowEditView(this.model)};q.prototype.clear=function(u){var t,s,v=this;u.preventDefault();u.stopPropagation();t=function(){v.parentView.handleFormUpdate();return v.model.destroy()};s=g.options.CLEAR_FIELD_CONFIRM;switch(typeof s){case"string":if(confirm(s)){return t()}break;case"function":return s(t);default:return t()}};q.prototype.duplicate=function(){var s;s=n.clone(this.model.attributes);delete s.id;delete s.uid;s.label+=" Copy";return this.parentView.createField(s,{position:this.model.indexInDOM()+1})};return q})(m.View);o=(function(q){e(r,q);function r(){c=r.__super__.constructor.apply(this,arguments);return c}r.prototype.className="edit-response-field";r.prototype.events={"click .js-add-option":"addOption","click .js-remove-option":"removeOption","click .js-default-updated":"defaultUpdated","input .option-label-input":"forceRender"};r.prototype.initialize=function(s){this.parentView=s.parentView;return this.listenTo(this.model,"destroy",this.remove)};r.prototype.render=function(){console.log("render",this.model);this.$el.html(g.templates["edit/base"+(!this.model.is_input()?"_non_input":"")]({rf:this.model}));rivets.bind(this.$el,{model:this.model});return this};r.prototype.remove=function(){this.parentView.editView=void 0;this.parentView.$el.find('[data-target="#addField"]').click();return r.__super__.remove.apply(this,arguments)};r.prototype.addOption=function(w){var u,t,v,s;u=j(w.currentTarget);t=this.$el.find(".option").index(u.closest(".option"));s=this.model.get(g.options.mappings.OPTIONS)||[];v={label:"",checked:false};if(t>-1){s.splice(t+1,0,v)}else{s.push(v)}this.model.set(g.options.mappings.OPTIONS,s);this.model.trigger("change:"+g.options.mappings.OPTIONS);return this.forceRender()};r.prototype.removeOption=function(v){var u,t,s;u=j(v.currentTarget);t=this.$el.find(".js-remove-option").index(u);s=this.model.get(g.options.mappings.OPTIONS);s.splice(t,1);this.model.set(g.options.mappings.OPTIONS,s);this.model.trigger("change:"+g.options.mappings.OPTIONS);return this.forceRender()};r.prototype.defaultUpdated=function(t){var s;s=j(t.currentTarget);if(this.model.get(g.options.mappings.FIELD_TYPE)!=="checkboxes"){this.$el.find(".js-default-updated").not(s).attr("checked",false).trigger("change")}return this.forceRender()};r.prototype.forceRender=function(){return this.model.trigger("change")};return r})(m.View);h=(function(r){e(q,r);function q(){b=q.__super__.constructor.apply(this,arguments);return b}q.prototype.SUBVIEWS=[];q.prototype.events={"click .js-save-form":"saveForm","click .fb-tabs a":"showTab","click .fb-add-field-types a":"addField","mouseover .fb-add-field-types":"lockLeftWrapper","mouseout .fb-add-field-types":"unlockLeftWrapper"};q.prototype.initialize=function(t){var s;s=t.selector,this.formBuilder=t.formBuilder,this.bootstrapData=t.bootstrapData;if(s!=null){this.setElement(j(s))}this.collection=new l;this.collection.bind("add",this.addOne,this);this.collection.bind("reset",this.reset,this);this.collection.bind("change",this.handleFormUpdate,this);this.collection.bind("destroy add reset",this.hideShowNoResponseFields,this);this.collection.bind("destroy",this.ensureEditViewScrolled,this);this.render();this.collection.reset(this.bootstrapData);return this.bindSaveEvent()};q.prototype.bindSaveEvent=function(){var s=this;this.formSaved=true;this.saveFormButton=this.$el.find(".js-save-form");this.saveFormButton.attr("disabled",true).text(g.options.dict.ALL_CHANGES_SAVED);if(!!g.options.AUTOSAVE){setInterval(function(){return s.saveForm.call(s)},1000)}return j(window).bind("beforeunload",function(){if(s.formSaved){return void 0}else{return g.options.dict.UNSAVED_CHANGES}})};q.prototype.reset=function(){this.$responseFields.html("");return this.addAll()};q.prototype.render=function(){var v,u,s,t;this.$el.html(g.templates.page());this.$fbLeft=this.$el.find(".fb-left");this.$responseFields=this.$el.find(".fb-response-fields");this.bindWindowScrollEvent();this.hideShowNoResponseFields();t=this.SUBVIEWS;for(u=0,s=t.length;u<s;u++){v=t[u];new v({parentView:this}).render()}return this};q.prototype.bindWindowScrollEvent=function(){var s=this;return j(window).on("scroll",function(){var t,u;if(s.$fbLeft.data("locked")===true){return}u=Math.max(0,j(window).scrollTop()-s.$el.offset().top);t=s.$responseFields.height();return s.$fbLeft.css({"margin-top":Math.min(t,u)})})};q.prototype.showTab=function(v){var t,s,u;t=j(v.currentTarget);u=t.data("target");t.closest("li").addClass("active").siblings("li").removeClass("active");j(u).addClass("active").siblings(".fb-tab-pane").removeClass("active");if(u!=="#editField"){this.unlockLeftWrapper()}if(u==="#editField"&&!this.editView&&(s=this.collection.models[0])){return this.createAndShowEditView(s)}};q.prototype.addOne=function(w,v,u){var t,s;s=new a({model:w,parentView:this});if(u.$replaceEl!=null){return u.$replaceEl.replaceWith(s.render().el)}else{if((u.position==null)||u.position===-1){return this.$responseFields.append(s.render().el)}else{if(u.position===0){return this.$responseFields.prepend(s.render().el)}else{if((t=this.$responseFields.find(".fb-field-wrapper").eq(u.position))[0]){return t.before(s.render().el)}else{return this.$responseFields.append(s.render().el)}}}}};q.prototype.setSortable=function(){var s=this;if(this.$responseFields.hasClass("ui-sortable")){this.$responseFields.sortable("destroy")}this.$responseFields.sortable({forcePlaceholderSize:true,placeholder:"sortable-placeholder",stop:function(v,u){var t;if(u.item.data("field-type")){t=s.collection.create(g.helpers.defaultFieldAttrs(u.item.data("field-type")),{$replaceEl:u.item});s.createAndShowEditView(t)}s.handleFormUpdate();return true},update:function(u,t){if(!t.item.data("field-type")){return s.ensureEditViewScrolled()}}});return this.setDraggable()};q.prototype.setDraggable=function(){var t,s=this;t=this.$el.find("[data-field-type]");return t.draggable({connectToSortable:this.$responseFields,helper:function(){var u;u=j("<div class='response-field-draggable-helper' />");u.css({width:s.$responseFields.width(),height:"80px"});return u}})};q.prototype.addAll=function(){this.collection.each(this.addOne,this);return this.setSortable()};q.prototype.hideShowNoResponseFields=function(){return this.$el.find(".fb-no-response-fields")[this.collection.length>0?"hide":"show"]()};q.prototype.addField=function(t){var s;s=j(t.currentTarget).data("field-type");return this.createField(g.helpers.defaultFieldAttrs(s))};q.prototype.createField=function(t,s){var u;u=this.collection.create(t,s);this.createAndShowEditView(u);return this.handleFormUpdate()};q.prototype.createAndShowEditView=function(t){var s,u;u=this.$el.find(".fb-field-wrapper").filter(function(){return j(this).data("cid")===t.cid});u.addClass("editing").siblings(".fb-field-wrapper").removeClass("editing");if(this.editView){if(this.editView.model.cid===t.cid){this.$el.find('.fb-tabs a[data-target="#editField"]').click();this.scrollLeftWrapper(u);return}this.editView.remove()}this.editView=new o({model:t,parentView:this});s=this.editView.render().$el;this.$el.find(".fb-edit-field-wrapper").html(s);this.$el.find('.fb-tabs a[data-target="#editField"]').click();this.scrollLeftWrapper(u);return this};q.prototype.ensureEditViewScrolled=function(){if(!this.editView){return}return this.scrollLeftWrapper(j(".fb-field-wrapper.editing"))};q.prototype.scrollLeftWrapper=function(t){var u=this;this.unlockLeftWrapper();if(!t[0]){return}function s(x,w,v){if(w==null){w=0}if(x===j(window).scrollTop()){j(window).trigger("scroll");if(typeof v==="function"){v()}return}return j("html, body").animate({scrollTop:x},w,function(){return typeof v==="function"?v():void 0})}return s((this.$el.offset().top+t.offset().top)-this.$responseFields.offset().top,200,function(){return u.lockLeftWrapper()})};q.prototype.lockLeftWrapper=function(){return this.$fbLeft.data("locked",true)};q.prototype.unlockLeftWrapper=function(){return this.$fbLeft.data("locked",false)};q.prototype.handleFormUpdate=function(){if(this.updatingBatch){return}this.formSaved=false;return this.saveFormButton.removeAttr("disabled").text(g.options.dict.SAVE_FORM)};q.prototype.saveForm=function(t){var s;if(this.formSaved){return}this.formSaved=true;this.saveFormButton.attr("disabled",true).text(g.options.dict.ALL_CHANGES_SAVED);this.collection.sort();s=JSON.stringify({fields:this.collection.toJSON()});if(g.options.HTTP_ENDPOINT){this.doAjaxSave(s)}return this.formBuilder.trigger("save",s)};q.prototype.doAjaxSave=function(s){var t=this;return j.ajax({url:g.options.HTTP_ENDPOINT,type:g.options.HTTP_METHOD,data:s,contentType:"application/json",success:function(y){var v,x,u,w;t.updatingBatch=true;for(x=0,u=y.length;x<u;x++){v=y[x];if((w=t.collection.get(v.cid))!=null){w.set({id:v.id})}t.collection.trigger("sync")}return t.updatingBatch=void 0}})};return q})(m.View);g=(function(){q.helpers={defaultFieldAttrs:function(t){var r,s;r={};r[q.options.mappings.LABEL]="Untitled";r[q.options.mappings.FIELD_TYPE]=t;r[q.options.mappings.REQUIRED]=true;r.field_options={};return(typeof(s=q.fields[t]).defaultAttributes==="function"?s.defaultAttributes(r):void 0)||r},simple_format:function(r){return r!=null?r.replace(/\n/g,"<br />"):void 0}};q.options={BUTTON_CLASS:"fb-button",HTTP_ENDPOINT:"",HTTP_METHOD:"POST",AUTOSAVE:true,CLEAR_FIELD_CONFIRM:false,mappings:{SIZE:"field_options.size",UNITS:"field_options.units",LABEL:"label",FIELD_TYPE:"field_type",REQUIRED:"required",ADMIN_ONLY:"admin_only",OPTIONS:"field_options.options",DESCRIPTION:"field_options.description",INCLUDE_OTHER:"field_options.include_other_option",INCLUDE_BLANK:"field_options.include_blank_option",INTEGER_ONLY:"field_options.integer_only",MIN:"field_options.min",MAX:"field_options.max",MINLENGTH:"field_options.minlength",MAXLENGTH:"field_options.maxlength",LENGTH_UNITS:"field_options.min_max_length_units"},dict:{ALL_CHANGES_SAVED:"All changes saved",SAVE_FORM:"Save form",UNSAVED_CHANGES:"You have unsaved changes. If you leave this page, you will lose those changes!"}};q.fields={};q.inputFields={};q.nonInputFields={};q.registerField=function(t,u){var r,w,s,v;v=["view","edit"];for(w=0,s=v.length;w<s;w++){r=v[w];u[r]=n.template(u[r])}u.field_type=t;q.fields[t]=u;if(u.type==="non_input"){return q.nonInputFields[t]=u}else{return q.inputFields[t]=u}};function q(s){var r;if(s==null){s={}}n.extend(this,m.Events);r=n.extend(s,{formBuilder:this});this.mainView=new h(r)}return q})();window.Formbuilder=g;if(typeof module!=="undefined"&&module!==null){module.exports=g}else{window.Formbuilder=g}}).call(this,jQuery,_,Backbone);(function(a,b){Formbuilder.registerField("address",{order:50,view:"<div class='input-line'>\n  <span class='street'>\n    <input type='text' class='text long-field' />\n    <label>Street</label>\n  </span>\n</div>\n\n<div class='input-line'>\n  <span class='city'>\n    <input type='text' class='text' />\n    <label>City</label>\n  </span>\n\n  <span class='state'>\n    <input type='text' class='text' />\n    <label>State / Province / Region</label>\n  </span>\n</div>\n\n<div class='input-line'>\n  <span class='zip'>\n    <input type='text' class='text' />\n    <label>Zipcode</label>\n  </span>\n\n  <span class='country'>\n    <select class='select'><option>United States</option></select>\n    <label>Country</label>\n  </span>\n</div>",edit:"",addButton:'<span class="symbol"><span class="fa fa-home"></span></span> Address'})}).call(this,_,Backbone);(function(a,b){Formbuilder.registerField("checkboxes",{order:10,view:"<% for (i in (rf.get(Formbuilder.options.mappings.OPTIONS) || [])) { %>\n  <div>\n    <label class='fb-option'>\n      <input type='checkbox' class='checkbox' <%= rf.get(Formbuilder.options.mappings.OPTIONS)[i].checked && 'checked' %> onclick=\"javascript: return false;\" />\n      <%= rf.get(Formbuilder.options.mappings.OPTIONS)[i].label %>\n    </label>\n  </div>\n<% } %>\n\n<% if (rf.get(Formbuilder.options.mappings.INCLUDE_OTHER)) { %>\n  <div class='other-option'>\n    <label class='fb-option'>\n      <input type='checkbox' class='checkbox' />\n      Other\n    </label>\n\n    &nbsp;<input type='text' size='40' />\n  </div>\n<% } %>",edit:"<%= Formbuilder.templates['edit/options']({ includeOther: true }) %>",addButton:'<span class="symbol"><span class="fa fa-square-o"></span></span> Checkboxes',defaultAttributes:function(c){c.field_options.options=[{label:"",checked:false},{label:"",checked:false}];return c}})}).call(this,_,Backbone);(function(a,b){Formbuilder.registerField("date",{order:20,view:'<div class=\'input-line\'>\n  <input type="text" class="text" placeholder="YYYY-MM-DD" />\n</div>',edit:"",addButton:'<span class="symbol"><span class="fa fa-calendar"></span></span> Date'})}).call(this,_,Backbone);(function(a,b){Formbuilder.registerField("dropdown",{order:24,view:"<select class='select long-field'>\n  <% if (rf.get(Formbuilder.options.mappings.INCLUDE_BLANK)) { %>\n    <option value=''></option>\n  <% } %>\n\n  <% for (i in (rf.get(Formbuilder.options.mappings.OPTIONS) || [])) { %>\n    <option <%= rf.get(Formbuilder.options.mappings.OPTIONS)[i].checked && 'selected' %>>\n      <%= rf.get(Formbuilder.options.mappings.OPTIONS)[i].label %>\n    </option>\n  <% } %>\n</select>",edit:"<%= Formbuilder.templates['edit/options']({ includeBlank: true }) %>",addButton:'<span class="symbol"><span class="fa fa-caret-down"></span></span> Dropdown',defaultAttributes:function(c){c.field_options.options=[{label:"",checked:false},{label:"",checked:false}];c.field_options.include_blank_option=false;return c}})}).call(this,_,Backbone);(function(){Formbuilder.registerField("email",{order:40,view:"<div class='input-line'><input type='text' class='text long-field' placeholder='username@example.com' /></div>",edit:"",addButton:'<span class="symbol"><span class="fa fa-envelope-o"></span></span> Email'})}).call(this);(function(){Formbuilder.registerField("number",{order:30,view:"<input type='text' class='text long-field' />\n<% if (units = rf.get(Formbuilder.options.mappings.UNITS)) { %>\n  <%= units %>\n<% } %>",edit:"<%= Formbuilder.templates['edit/min_max']() %>\n<%= Formbuilder.templates['edit/units']() %>\n<%= Formbuilder.templates['edit/integer_only']() %>",addButton:'<span class="symbol"><span class="fa fa-number">123</span></span> Number'})}).call(this);(function(){Formbuilder.registerField("paragraph",{order:5,view:"<textarea class='textarea long-field' rows='5'></textarea>",edit:"<%= Formbuilder.templates['edit/min_max_length']() %>",addButton:'<span class="symbol">&#182;</span> Paragraph',defaultAttributes:function(a){a.field_options.size="small";return a}})}).call(this);(function(){Formbuilder.registerField("radio",{order:15,view:"<% for (i in (rf.get(Formbuilder.options.mappings.OPTIONS) || [])) { %>\n  <div>\n    <label class='fb-option'>\n      <input type='radio' class='radio' <%= rf.get(Formbuilder.options.mappings.OPTIONS)[i].checked && 'checked' %> onclick=\"javascript: return false;\" />\n      <%= rf.get(Formbuilder.options.mappings.OPTIONS)[i].label %>\n    </label>\n  </div>\n<% } %>\n\n<% if (rf.get(Formbuilder.options.mappings.INCLUDE_OTHER)) { %>\n  <div class='other-option'>\n    <label class='fb-option'>\n      <input type='radio' class='radio' />\n      Other\n    </label>\n\n    &nbsp;<input type='text' size='40'/>\n  </div>\n<% } %>",edit:"<%= Formbuilder.templates['edit/options']({ includeOther: true }) %>",addButton:'<span class="symbol"><span class="fa fa-circle-o"></span></span> Multiple Choice',defaultAttributes:function(a){a.field_options.options=[{label:"",checked:false},{label:"",checked:false}];return a}})}).call(this);(function(){Formbuilder.registerField("section",{order:0,type:"non_input",view:"<label class='section-name'><%= rf.get(Formbuilder.options.mappings.LABEL) %></label>\n<p><%= rf.get(Formbuilder.options.mappings.DESCRIPTION) %></p>",edit:"<div class='fb-edit-section-header'>Label</div>\n<input type='text' class='text' data-rv-input='model.<%= Formbuilder.options.mappings.LABEL %>' />\n<p></p>\n<textarea class='textarea' data-rv-input='model.<%= Formbuilder.options.mappings.DESCRIPTION %>'\n  placeholder='Add a longer description to this field'></textarea>",addButton:"<span class='symbol'><span class='fa fa-minus'></span></span> Section Title"})}).call(this);(function(){Formbuilder.registerField("text",{order:0,view:"<input type='text' class='text long-field' />",edit:"<%= Formbuilder.templates['edit/min_max_length']() %>",addButton:"<span class='symbol'><span class='fa fa-font'></span></span> Text",defaultAttributes:function(a){return a}})}).call(this);(function(){Formbuilder.registerField("time",{order:25,view:"<div class='input-line'><input type='text' class='text' placeholder='HH:MM AM'></div>",edit:"",addButton:'<span class="symbol"><span class="fa fa-clock-o"></span></span> Time'})}).call(this);(function(){Formbuilder.registerField("website",{order:35,view:"<input type='text' class='text long-field' placeholder='http://'>",edit:"",addButton:'<span class="symbol"><span class="fa fa-link"></span></span> Website'})}).call(this);(function(_){this["Formbuilder"]=this["Formbuilder"]||{};this["Formbuilder"]["templates"]=this["Formbuilder"]["templates"]||{};this["Formbuilder"]["templates"]["edit/base"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+=((__t=(Formbuilder.templates["edit/base_header"]()))==null?"":__t)+"\n"+((__t=(Formbuilder.templates["edit/common"]()))==null?"":__t)+"\n"+((__t=(Formbuilder.fields[rf.get(Formbuilder.options.mappings.FIELD_TYPE)].edit({rf:rf})))==null?"":__t)+"\n"}return __p};this["Formbuilder"]["templates"]["edit/base_header"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='fb-field-label'>\n  <span data-rv-text=\"model."+((__t=(Formbuilder.options.mappings.LABEL))==null?"":__t)+"\"></span>\n  <code class='field-type' data-rv-text='model."+((__t=(Formbuilder.options.mappings.FIELD_TYPE))==null?"":__t)+"'></code>\n  <span class='fa fa-arrow-right pull-right'></span>\n</div>"}return __p};this["Formbuilder"]["templates"]["edit/base_non_input"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+=((__t=(Formbuilder.templates["edit/base_header"]()))==null?"":__t)+"\n"+((__t=(Formbuilder.fields[rf.get(Formbuilder.options.mappings.FIELD_TYPE)].edit({rf:rf})))==null?"":__t)+"\n"}return __p};this["Formbuilder"]["templates"]["edit/checkboxes"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<label>\n  <input type='checkbox' class=\"checkbox\" data-rv-checked='model."+((__t=(Formbuilder.options.mappings.REQUIRED))==null?"":__t)+"' />\n  Required\n</label>\n<!-- label>\n  <input type='checkbox' data-rv-checked='model."+((__t=(Formbuilder.options.mappings.ADMIN_ONLY))==null?"":__t)+"' />\n  Admin only\n</label -->"}return __p};this["Formbuilder"]["templates"]["edit/common"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='fb-edit-section-header'>Label</div>\n\n<div class='fb-common-wrapper'>\n  <div class='fb-label-description'>\n    "+((__t=(Formbuilder.templates["edit/label_description"]()))==null?"":__t)+"\n  </div>\n  <div class='fb-common-checkboxes'>\n    "+((__t=(Formbuilder.templates["edit/checkboxes"]()))==null?"":__t)+"\n  </div>\n  <div class='fb-clear'></div>\n</div>\n"}return __p};this["Formbuilder"]["templates"]["edit/integer_only"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='fb-edit-section-header'>Integer only</div>\n<label>\n  <input type='checkbox' class=\"checkbox\" data-rv-checked='model."+((__t=(Formbuilder.options.mappings.INTEGER_ONLY))==null?"":__t)+"' />\n  Only accept integers\n</label>\n"}return __p};this["Formbuilder"]["templates"]["edit/label_description"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<input type='text' class=\"text\" data-rv-input='model."+((__t=(Formbuilder.options.mappings.LABEL))==null?"":__t)+"' />\n<p></p>\n<textarea class=\"textarea\" data-rv-input='model."+((__t=(Formbuilder.options.mappings.DESCRIPTION))==null?"":__t)+"'\n  placeholder='Add a longer description to this field'></textarea>"}return __p};this["Formbuilder"]["templates"]["edit/min_max"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+='<div class=\'fb-edit-section-header\'>Minimum / Maximum</div>\n\nAbove\n<input type="text" class="text" data-rv-input="model.'+((__t=(Formbuilder.options.mappings.MIN))==null?"":__t)+'" style="width: 40px" />\n\n&nbsp;&nbsp;\n\nBelow\n<input type="text" class="text" data-rv-input="model.'+((__t=(Formbuilder.options.mappings.MAX))==null?"":__t)+'" style="width: 40px" />\n'}return __p};this["Formbuilder"]["templates"]["edit/min_max_length"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+='<div class=\'fb-edit-section-header\'>Length Limit</div>\n\nMin\n<input type="text" class="text" data-rv-input="model.'+((__t=(Formbuilder.options.mappings.MINLENGTH))==null?"":__t)+'" style="width: 40px" />\n\n&nbsp;&nbsp;\n\nMax\n<input type="text" class="text" data-rv-input="model.'+((__t=(Formbuilder.options.mappings.MAXLENGTH))==null?"":__t)+'" style="width: 40px" />\n\n&nbsp;&nbsp;\n\n<select class="select" data-rv-value="model.'+((__t=(Formbuilder.options.mappings.LENGTH_UNITS))==null?"":__t)+'" style="width: auto;">\n  <option value="characters">characters</option>\n  <option value="words">words</option>\n</select>\n'}return __p};this["Formbuilder"]["templates"]["edit/options"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){__p+="<div class='fb-edit-section-header'>Options</div>\n\n";if(typeof includeBlank!=="undefined"){__p+="\n  <label>\n    <input type='checkbox' class=\"checkbox\" data-rv-checked='model."+((__t=(Formbuilder.options.mappings.INCLUDE_BLANK))==null?"":__t)+"' />\n    Include blank\n  </label>\n"}__p+="\n\n<div class='option' data-rv-each-option='model."+((__t=(Formbuilder.options.mappings.OPTIONS))==null?"":__t)+'\'>\n  <input type="checkbox" class=\'checkbox js-default-updated\' data-rv-checked="option:checked" />\n  <input type="text" data-rv-input="option:label" class=\'option-label-input\' />\n  <a class="js-add-option '+((__t=(Formbuilder.options.BUTTON_CLASS))==null?"":__t)+'" title="Add Option"><i class=\'fa fa-plus-circle\'></i></a>\n  <a class="js-remove-option '+((__t=(Formbuilder.options.BUTTON_CLASS))==null?"":__t)+'" title="Remove Option"><i class=\'fa fa-minus-circle\'></i></a>\n</div>\n\n';if(typeof includeOther!=="undefined"){__p+="\n  <label>\n    <input type='checkbox' class=\"checkbox\" data-rv-checked='model."+((__t=(Formbuilder.options.mappings.INCLUDE_OTHER))==null?"":__t)+'\' />\n    Include "other"\n  </label>\n'}__p+="\n\n<div class='fb-bottom-add'>\n  <a class=\"js-add-option "+((__t=(Formbuilder.options.BUTTON_CLASS))==null?"":__t)+'">Add option</a>\n</div>\n'}return __p};this["Formbuilder"]["templates"]["edit/size"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+='<div class=\'fb-edit-section-header\'>Size</div>\n<select class="select" data-rv-value="model.'+((__t=(Formbuilder.options.mappings.SIZE))==null?"":__t)+'">\n  <option value="small">Small</option>\n  <option value="medium">Medium</option>\n  <option value="large">Large</option>\n</select>\n'}return __p};this["Formbuilder"]["templates"]["edit/units"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+='<div class=\'fb-edit-section-header\'>Units</div>\n<input type="text" class="text" data-rv-input="model.'+((__t=(Formbuilder.options.mappings.UNITS))==null?"":__t)+'" />\n'}return __p};this["Formbuilder"]["templates"]["page"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+=((__t=(Formbuilder.templates["partials/save_button"]()))==null?"":__t)+"\n"+((__t=(Formbuilder.templates["partials/left_side"]()))==null?"":__t)+"\n"+((__t=(Formbuilder.templates["partials/right_side"]()))==null?"":__t)+"\n<div class='fb-clear'></div>"}return __p};this["Formbuilder"]["templates"]["partials/add_field"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){__p+="<div class='fb-tab-pane active' id='addField'>\n  <div class='fb-add-field-types'>\n    <div class='section'>\n      ";_.each(_.sortBy(Formbuilder.inputFields,"order"),function(f){__p+='\n        <a data-field-type="'+((__t=(f.field_type))==null?"":__t)+'" class="'+((__t=(Formbuilder.options.BUTTON_CLASS))==null?"":__t)+'">\n          '+((__t=(f.addButton))==null?"":__t)+"\n        </a>\n      "});__p+="\n    </div>\n\n    <div class='section'>\n      ";_.each(_.sortBy(Formbuilder.nonInputFields,"order"),function(f){__p+='\n        <a data-field-type="'+((__t=(f.field_type))==null?"":__t)+'" class="'+((__t=(Formbuilder.options.BUTTON_CLASS))==null?"":__t)+'">\n          '+((__t=(f.addButton))==null?"":__t)+"\n        </a>\n      "});__p+="\n    </div>\n  </div>\n</div>\n"}return __p};this["Formbuilder"]["templates"]["partials/edit_field"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='fb-tab-pane' id='editField'>\n  <div class='fb-edit-field-wrapper'></div>\n</div>\n"}return __p};this["Formbuilder"]["templates"]["partials/left_side"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='fb-left'>\n  <ul class='fb-tabs'>\n    <li class='active'><a data-target='#addField'>Add new field</a></li>\n    <li><a data-target='#editField'>Edit field</a></li>\n  </ul>\n\n  <div class='fb-tab-content'>\n    "+((__t=(Formbuilder.templates["partials/add_field"]()))==null?"":__t)+"\n    "+((__t=(Formbuilder.templates["partials/edit_field"]()))==null?"":__t)+"\n  </div>\n</div>"}return __p};this["Formbuilder"]["templates"]["partials/right_side"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='fb-right'>\n  <div class='fb-no-response-fields'>No response fields</div>\n  <div class='fb-response-fields'></div>\n</div>\n"}return __p};this["Formbuilder"]["templates"]["partials/save_button"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='fb-save-wrapper'>\n  <button class='js-save-form "+((__t=(Formbuilder.options.BUTTON_CLASS))==null?"":__t)+"'></button>\n</div>"}return __p};this["Formbuilder"]["templates"]["view/base"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='subtemplate-wrapper'>\n  <div class='cover'></div>\n  "+((__t=(Formbuilder.templates["view/label"]({rf:rf})))==null?"":__t)+"\n\n  "+((__t=(Formbuilder.fields[rf.get(Formbuilder.options.mappings.FIELD_TYPE)].view({rf:rf})))==null?"":__t)+"\n\n  "+((__t=(Formbuilder.templates["view/description"]({rf:rf})))==null?"":__t)+"\n  "+((__t=(Formbuilder.templates["view/duplicate_remove"]({rf:rf})))==null?"":__t)+"\n</div>\n"}return __p};this["Formbuilder"]["templates"]["view/base_non_input"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='subtemplate-wrapper'>\n  <div class='cover'></div>\n  "+((__t=(Formbuilder.templates["view/section"]({rf:rf})))==null?"":__t)+"\n\n  "+((__t=(Formbuilder.templates["view/description"]({rf:rf})))==null?"":__t)+"\n  "+((__t=(Formbuilder.templates["view/duplicate_remove"]({rf:rf})))==null?"":__t)+"\n</div>\n"}return __p};this["Formbuilder"]["templates"]["view/section"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+='<h3 class="fb-section">'+((__t=(Formbuilder.helpers.simple_format(__e(rf.get(Formbuilder.options.mappings.LABEL)))))==null?"":__t)+"</h3>"}return __p};this["Formbuilder"]["templates"]["view/description"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<span class='help-block'>\n  "+((__t=(Formbuilder.helpers.simple_format(__e(rf.get(Formbuilder.options.mappings.DESCRIPTION)))))==null?"":__t)+"\n</span>\n"}return __p};this["Formbuilder"]["templates"]["view/duplicate_remove"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj){__p+="<div class='actions-wrapper'>\n  <a class=\"js-duplicate "+((__t=(Formbuilder.options.BUTTON_CLASS))==null?"":__t)+'" title="Duplicate Field"><i class=\'fa fa-plus-circle\'></i></a>\n  <a class="js-clear '+((__t=(Formbuilder.options.BUTTON_CLASS))==null?"":__t)+'" title="Remove Field"><i class=\'fa fa-minus-circle\'></i></a>\n</div>'}return __p};this["Formbuilder"]["templates"]["view/label"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){__p+="<label>\n  <span>"+((__t=(Formbuilder.helpers.simple_format(__e(rf.get(Formbuilder.options.mappings.LABEL)))))==null?"":__t)+"\n  ";if(rf.get(Formbuilder.options.mappings.REQUIRED)){__p+="\n    <abbr title='required'>*</abbr>\n  "}__p+="\n</label>\n"}return __p}}).call(this,_);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/jquery.timepicker.js' */
(function(a){if(typeof exports==="object"&&exports&&typeof module==="object"&&module&&module.exports===exports){a(require("jquery"))}else{if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}}(function(h){var n=d();var l=86400;var t={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"};var w={init:function(A){return this.each(function(){var B=h(this);var E=[];for(var C in h.fn.timepicker.defaults){if(B.data(C)){E[C]=B.data(C)}}var D=h.extend({},h.fn.timepicker.defaults,E,A);if(D.lang){t=h.extend(t,D.lang)}D=g(D);B.data("timepicker-settings",D);B.addClass("ui-timepicker-input");if(D.useSelect){k(B)}else{B.prop("autocomplete","off");B.on("click.timepicker focus.timepicker",w.show);B.on("change.timepicker",f);B.on("keydown.timepicker",j);B.on("keyup.timepicker",z);f.call(B.get(0))}})},show:function(G){var B=h(this);var E=B.data("timepicker-settings");if(G){if(!E.showOnFocus){return true}G.preventDefault()}if(E.useSelect){B.data("timepicker-list").focus();return}if(r(B)){B.blur()}var F=B.data("timepicker-list");if(B.prop("readonly")){return}if(!F||F.length===0||typeof E.durationTime==="function"){k(B);F=B.data("timepicker-list")}if(q(F)){return}w.hide();F.show();var A={};if(E.orientation=="rtl"){A.left=B.offset().left+B.outerWidth()-F.outerWidth()+parseInt(F.css("marginLeft").replace("px",""),10)}else{A.left=B.offset().left+parseInt(F.css("marginLeft").replace("px",""),10)}if((B.offset().top+B.outerHeight(true)+F.outerHeight())>h(window).height()+h(window).scrollTop()){F.addClass("ui-timepicker-positioned-top");A.top=B.offset().top-F.outerHeight()+parseInt(F.css("marginTop").replace("px",""),10)}else{F.removeClass("ui-timepicker-positioned-top");A.top=B.offset().top+B.outerHeight()+parseInt(F.css("marginTop").replace("px",""),10)}F.offset(A);var D=F.find(".ui-timepicker-selected");if(!D.length){if(a(B)){D=e(B,F,p(a(B)))}else{if(E.scrollDefault){D=e(B,F,E.scrollDefault)}}}if(D&&D.length){var C=F.scrollTop()+D.position().top-D.outerHeight();F.scrollTop(C)}else{F.scrollTop(0)}h(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",o);if(E.closeOnWindowScroll){h(document).on("scroll.ui-timepicker",o)}B.trigger("showTimepicker");return this},hide:function(C){var A=h(this);var B=A.data("timepicker-settings");if(B&&B.useSelect){A.blur()}h(".ui-timepicker-wrapper").each(function(){var F=h(this);if(!q(F)){return}var D=F.data("timepicker-input");var E=D.data("timepicker-settings");if(E&&E.selectOnBlur){m(D)}F.hide();D.trigger("hideTimepicker")});return this},option:function(A,B){return this.each(function(){var C=h(this);var D=C.data("timepicker-settings");var E=C.data("timepicker-list");if(typeof A=="object"){D=h.extend(D,A)}else{if(typeof A=="string"&&typeof B!="undefined"){D[A]=B}else{if(typeof A=="string"){return D[A]}}}D=g(D);C.data("timepicker-settings",D);if(E){E.remove();C.data("timepicker-list",false)}if(D.useSelect){k(C)}})},getSecondsFromMidnight:function(){return p(a(this))},getTime:function(E){var A=this;var B=a(A);if(!B){return null}if(!E){E=new Date()}var D=p(B);var C=new Date(E);C.setHours(D/3600);C.setMinutes(D%3600/60);C.setSeconds(D%60);C.setMilliseconds(0);return C},setTime:function(C){var A=this;var B=A.data("timepicker-settings");if(B.forceRoundTime){var D=s(C,B)}else{var D=y(p(C),B.timeFormat)}c(A,D);if(A.data("timepicker-list")){u(A,A.data("timepicker-list"))}return this},remove:function(){var A=this;if(!A.hasClass("ui-timepicker-input")){return}var B=A.data("timepicker-settings");A.removeAttr("autocomplete","off");A.removeClass("ui-timepicker-input");A.removeData("timepicker-settings");A.off(".timepicker");if(A.data("timepicker-list")){A.data("timepicker-list").remove()}if(B.useSelect){A.show()}A.removeData("timepicker-list");return this}};function q(B){var A=B[0];return A.offsetWidth>0&&A.offsetHeight>0}function g(B){if(B.minTime){B.minTime=p(B.minTime)}if(B.maxTime){B.maxTime=p(B.maxTime)}if(B.durationTime&&typeof B.durationTime!=="function"){B.durationTime=p(B.durationTime)}if(B.scrollDefault=="now"){B.scrollDefault=p(new Date())}else{if(B.scrollDefault){B.scrollDefault=p(B.scrollDefault)}else{if(B.minTime){B.scrollDefault=B.minTime}}}if(B.scrollDefault){B.scrollDefault=v(B.scrollDefault,B)}if(h.type(B.timeFormat)==="string"&&B.timeFormat.match(/[gh]/)){B._twelveHourTime=true}if(B.disableTimeRanges.length>0){for(var A in B.disableTimeRanges){B.disableTimeRanges[A]=[p(B.disableTimeRanges[A][0]),p(B.disableTimeRanges[A][1])]}B.disableTimeRanges=B.disableTimeRanges.sort(function(D,C){return D[0]-C[0]});for(var A=B.disableTimeRanges.length-1;A>0;A--){if(B.disableTimeRanges[A][0]<=B.disableTimeRanges[A-1][1]){B.disableTimeRanges[A-1]=[Math.min(B.disableTimeRanges[A][0],B.disableTimeRanges[A-1][0]),Math.max(B.disableTimeRanges[A][1],B.disableTimeRanges[A-1][1])];B.disableTimeRanges.splice(A,1)}}}return B}function k(K){var Q=K.data("timepicker-settings");var O=K.data("timepicker-list");if(O&&O.length){O.remove();K.data("timepicker-list",false)}if(Q.useSelect){O=h("<select />",{"class":"ui-timepicker-select"});var R=O}else{O=h("<ul />",{"class":"ui-timepicker-list"});var R=h("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});R.css({display:"none",position:"absolute"}).append(O)}if(Q.noneOption){if(Q.noneOption===true){Q.noneOption=(Q.useSelect)?"Time...":"None"}if(h.isArray(Q.noneOption)){for(var M in Q.noneOption){if(parseInt(M,10)==M){var J=i(Q.noneOption[M],Q.useSelect);O.append(J)}}}else{var J=i(Q.noneOption,Q.useSelect);O.append(J)}}if(Q.className){R.addClass(Q.className)}if((Q.minTime!==null||Q.durationTime!==null)&&Q.showDuration){R.addClass("ui-timepicker-with-duration");R.addClass("ui-timepicker-step-"+Q.step)}var P=Q.minTime;if(typeof Q.durationTime==="function"){P=p(Q.durationTime())}else{if(Q.durationTime!==null){P=Q.durationTime}}var F=(Q.minTime!==null)?Q.minTime:0;var D=(Q.maxTime!==null)?Q.maxTime:(F+l-1);if(D<=F){D+=l}if(D===l-1&&h.type(Q.timeFormat)==="string"&&Q.timeFormat.indexOf("H")!==-1){D=l}var L=Q.disableTimeRanges;var C=0;var N=L.length;for(var M=F;M<=D;M+=Q.step*60){var A=M;var H=y(A,Q.timeFormat);if(Q.useSelect){var G=h("<option />",{value:H});G.text(H)}else{var G=h("<li />");G.data("time",(A<=86400?A:A%86400));G.text(H)}if((Q.minTime!==null||Q.durationTime!==null)&&Q.showDuration){var I=b(M-P,Q.step);if(Q.useSelect){G.text(G.text()+" ("+I+")")}else{var B=h("<span />",{"class":"ui-timepicker-duration"});B.text(" ("+I+")");G.append(B)}}if(C<N){if(A>=L[C][1]){C+=1}if(L[C]&&A>=L[C][0]&&A<L[C][1]){if(Q.useSelect){G.prop("disabled",true)}else{G.addClass("ui-timepicker-disabled")}}}O.append(G)}R.data("timepicker-input",K);K.data("timepicker-list",R);if(Q.useSelect){if(K.val()){O.val(s(K.val(),Q))}O.on("focus",function(){h(this).data("timepicker-input").trigger("showTimepicker")});O.on("blur",function(){h(this).data("timepicker-input").trigger("hideTimepicker")});O.on("change",function(){c(K,h(this).val(),"select")});c(K,O.val());K.hide().after(O)}else{var E=Q.appendTo;if(typeof E==="string"){E=h(E)}else{if(typeof E==="function"){E=E(K)}}E.append(R);u(K,O);O.on("mousedown","li",function(S){K.off("focus.timepicker");K.on("focus.timepicker-ie-hack",function(){K.off("focus.timepicker-ie-hack");K.on("focus.timepicker",w.show)});if(!r(K)){K[0].focus()}O.find("li").removeClass("ui-timepicker-selected");h(this).addClass("ui-timepicker-selected");if(m(K)){K.trigger("hideTimepicker");R.hide()}})}}function i(E,C){var A,B,D;if(typeof E=="object"){A=E.label;B=E.className;D=E.value}else{if(typeof E=="string"){A=E}else{h.error("Invalid noneOption value")}}if(C){return h("<option />",{value:D,"class":B,text:A})}else{return h("<li />",{"class":B,text:A}).data("time",D)}}function v(C,A){if(!h.isNumeric(C)){C=p(C)}if(C===null){return null}else{var B=C%(A.step*60);if(B>=A.step*30){C+=(A.step*60)-B}else{C-=B}return C}}function s(B,A){B=v(B,A);if(B!==null){return y(B,A.timeFormat)}}function d(){return new Date(1970,1,1,0,0,0)}function o(C){var B=h(C.target);var A=B.closest(".ui-timepicker-input");if(A.length===0&&B.closest(".ui-timepicker-wrapper").length===0){w.hide();h(document).unbind(".ui-timepicker")}}function r(A){var B=A.data("timepicker-settings");return((window.navigator.msMaxTouchPoints||"ontouchstart" in document)&&B.disableTouchKeyboard)}function e(A,F,E){if(!E&&E!==0){return false}var C=A.data("timepicker-settings");var B=false;var D=C.step*30;F.find("li").each(function(G,I){var H=h(I);if(typeof H.data("time")!="number"){return}var J=H.data("time")-E;if(Math.abs(J)<D||J==D){B=H;return false}});return B}function u(B,E){E.find("li").removeClass("ui-timepicker-selected");var D=p(a(B),B.data("timepicker-settings"));if(D===null){return}var C=e(B,E,D);if(C){var A=C.offset().top-E.offset().top;if(A+C.outerHeight()>E.outerHeight()||A<0){E.scrollTop(E.scrollTop()+C.position().top-C.outerHeight())}C.addClass("ui-timepicker-selected")}}function f(D,G){if(this.value===""||G=="timepicker"){return}var I=h(this);var E=I.data("timepicker-list");if(I.is(":focus")&&(!D||D.type!="change")){return}var F=p(this.value);if(F===null){I.trigger("timeFormatError");return}var A=I.data("timepicker-settings");var C=false;if(A.minTime!==null&&F<A.minTime){C=true}else{if(A.maxTime!==null&&F>A.maxTime){C=true}}h.each(A.disableTimeRanges,function(){if(F>=this[0]&&F<this[1]){C=true;return false}});if(A.forceRoundTime){var B=F%(A.step*60);if(B>=A.step*30){F+=(A.step*60)-B}else{F-=B}}var H=y(F,A.timeFormat);if(C){if(c(I,H,"error")){I.trigger("timeRangeError")}}else{c(I,H)}}function a(A){if(A.is("input")){return A.val()}else{return A.data("ui-timepicker-value")}}function c(A,D,C){if(A.is("input")){A.val(D);var B=A.data("timepicker-settings");if(B.useSelect&&C!="select"){A.data("timepicker-list").val(s(D,B))}}if(A.data("ui-timepicker-value")!=D){A.data("ui-timepicker-value",D);if(C=="select"){A.trigger("selectTime").trigger("changeTime").trigger("change","timepicker")}else{if(C!="error"){A.trigger("changeTime")}}return true}else{A.trigger("selectTime");return false}}function j(D){var A=h(this);var C=A.data("timepicker-list");if(!C||!q(C)){if(D.keyCode==40){w.show.call(A.get(0));C=A.data("timepicker-list");if(!r(A)){A.focus()}}else{return true}}switch(D.keyCode){case 13:if(m(A)){w.hide.apply(this)}D.preventDefault();return false;case 38:var B=C.find(".ui-timepicker-selected");if(!B.length){C.find("li").each(function(E,F){if(h(F).position().top>0){B=h(F);return false}});B.addClass("ui-timepicker-selected")}else{if(!B.is(":first-child")){B.removeClass("ui-timepicker-selected");B.prev().addClass("ui-timepicker-selected");if(B.prev().position().top<B.outerHeight()){C.scrollTop(C.scrollTop()-B.outerHeight())}}}return false;case 40:B=C.find(".ui-timepicker-selected");if(B.length===0){C.find("li").each(function(E,F){if(h(F).position().top>0){B=h(F);return false}});B.addClass("ui-timepicker-selected")}else{if(!B.is(":last-child")){B.removeClass("ui-timepicker-selected");B.next().addClass("ui-timepicker-selected");if(B.next().position().top+2*B.outerHeight()>C.outerHeight()){C.scrollTop(C.scrollTop()+B.outerHeight())}}}return false;case 27:C.find("li").removeClass("ui-timepicker-selected");w.hide();break;case 9:w.hide();break;default:return true}}function z(C){var A=h(this);var B=A.data("timepicker-list");if(!B||!q(B)){return true}if(!A.data("timepicker-settings").typeaheadHighlight){B.find("li").removeClass("ui-timepicker-selected");return true}switch(C.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:u(A,B);break;default:return}}function m(A){var D=A.data("timepicker-settings");var E=A.data("timepicker-list");var C=null;var F=E.find(".ui-timepicker-selected");if(F.hasClass("ui-timepicker-disabled")){return false}if(F.length){C=F.data("time")}if(C!==null){if(typeof C=="string"){A.val(C);A.trigger("selectTime").trigger("changeTime").trigger("change","timepicker")}else{var B=y(C,D.timeFormat);c(A,B,"select")}}return true}function b(F,D){F=Math.abs(F);var B=Math.round(F/60),E=[],A,C;if(B<60){E=[B,t.mins]}else{A=Math.floor(B/60);C=B%60;if(D==30&&C==30){A+=t.decimal+5}E.push(A);E.push(A==1?t.hr:t.hrs);if(D!=30&&C){E.push(C);E.push(t.mins)}}return E.join(" ")}function y(H,G){if(H===null){return}var F=new Date(n.valueOf()+(H*1000));if(isNaN(F.getTime())){return}if(h.type(G)==="function"){return G(F)}var B="";var A,E;for(var D=0;D<G.length;D++){E=G.charAt(D);switch(E){case"a":B+=(F.getHours()>11)?t.pm:t.am;break;case"A":B+=(F.getHours()>11)?t.pm.toUpperCase():t.am.toUpperCase();break;case"g":A=F.getHours()%12;B+=(A===0)?"12":A;break;case"G":B+=F.getHours();break;case"h":A=F.getHours()%12;if(A!==0&&A<10){A="0"+A}B+=(A===0)?"12":A;break;case"H":A=F.getHours();if(H===l){A=24}B+=(A>9)?A:"0"+A;break;case"i":var C=F.getMinutes();B+=(C>9)?C:"0"+C;break;case"s":H=F.getSeconds();B+=(H>9)?H:"0"+H;break;case"\\":D++;B+=G.charAt(D);break;default:B+=E}}return B}function p(A,C){if(A===""){return null}if(!A||A+0==A){return A}if(typeof(A)=="object"){return A.getHours()*3600+A.getMinutes()*60+A.getSeconds()}A=A.toLowerCase();if(A.slice(-1)=="a"||A.slice(-1)=="p"){A+="m"}var F=new RegExp("^([0-2]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?\\s*("+t.am+"|"+t.pm+")?$");var B=A.match(F);if(!B){return null}var E=parseInt(B[1]*1,10);var G=B[4];var H=E;if(E<=12&&G){if(E==12){H=(B[4]==t.pm)?12:0}else{H=(E+(B[4]==t.pm?12:0))}}var D=(B[2]*1||0);var I=(B[3]*1||0);var K=H*3600+D*60+I;if(!G&&C&&C._twelveHourTime&&C.scrollDefault){var J=K-C.scrollDefault;if(J<0&&J>=l/-2){K=(K+(l/2))%l}}return K}function x(A){return("0"+A).slice(-2)}h.fn.timepicker=function(A){if(!this.length){return this}if(w[A]){if(!this.hasClass("ui-timepicker-input")){return this}return w[A].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof A==="object"||!A){return w.init.apply(this,arguments)}else{h.error("Method "+A+" does not exist on jQuery.timepicker")}}};h.fn.timepicker.defaults={className:null,minTime:null,maxTime:null,durationTime:null,step:30,showDuration:false,showOnFocus:true,timeFormat:"g:ia",scrollDefault:null,selectOnBlur:false,disableTouchKeyboard:false,forceRoundTime:false,appendTo:"body",orientation:"ltr",disableTimeRanges:[],closeOnWindowScroll:false,typeaheadHighlight:true,noneOption:false}}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/jquery.dataTables.js' */
/*! DataTables 1.10.4
 * 2008-2014 SpryMedia Ltd - datatables.net/license
 */
(function(b,a,c){(function(d){if(typeof define==="function"&&define.amd){define("datatables",["jquery"],d)}else{if(typeof exports==="object"){d(require("jquery"))}else{if(jQuery&&!jQuery.fn.dataTable){d(jQuery)}}}}(function(bF){var N;var I;var J;var bk;var aB;var a7={};var W=/[\r\n]/g;var aU=/<.*?>/g;var am=/^[\w\+\-]/;var bv=/[\w\+\-]$/;var aD=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g");var bG=/[',$%\u2009\u202F]/g;var bB=function(bR){return !bR||bR===true||bR==="-"?true:false};var F=function(bS){var bR=parseInt(bS,10);return !isNaN(bR)&&isFinite(bS)?bR:null};var bD=function(bS,bR){if(!a7[bR]){a7[bR]=new RegExp(m(bR),"g")}return typeof bS==="string"&&bR!=="."?bS.replace(/\./g,"").replace(a7[bR],"."):bS};var aj=function(bU,bR,bT){var bS=typeof bU==="string";if(bR&&bS){bU=bD(bU,bR)}if(bT&&bS){bU=bU.replace(bG,"")}return bB(bU)||(!isNaN(parseFloat(bU))&&isFinite(bU))};var bM=function(bR){return bB(bR)||typeof bR==="string"};var j=function(bU,bR,bT){if(bB(bU)){return true}var bS=bM(bU);return !bS?null:aj(D(bU),bR,bT)?true:null};var au=function(bS,bW,bV){var bT=[];var bU=0,bR=bS.length;if(bV!==c){for(;bU<bR;bU++){if(bS[bU]&&bS[bU][bW]){bT.push(bS[bU][bW][bV])}}}else{for(;bU<bR;bU++){if(bS[bU]){bT.push(bS[bU][bW])}}}return bT};var t=function(bT,bR,bX,bW){var bU=[];var bV=0,bS=bR.length;if(bW!==c){for(;bV<bS;bV++){if(bT[bR[bV]][bX]){bU.push(bT[bR[bV]][bX][bW])}}}else{for(;bV<bS;bV++){bU.push(bT[bR[bV]][bX])}}return bU};var bg=function(bR,bV){var bT=[];var bS;if(bV===c){bV=0;bS=bR}else{bS=bV;bV=bR}for(var bU=bV;bU<bS;bU++){bT.push(bU)}return bT};var ad=function(bS){var bT=[];for(var bU=0,bR=bS.length;bU<bR;bU++){if(bS[bU]){bT.push(bS[bU])}}return bT};var D=function(bR){return bR.replace(aU,"")};var aH=function(bX){var bU=[],bW,bV,bR=bX.length,bT,bS=0;again:for(bV=0;bV<bR;bV++){bW=bX[bV];for(bT=0;bT<bS;bT++){if(bU[bT]===bW){continue again}}bU.push(bW);bS++}return bU};function T(bV){var bU="a aa ai ao as b fn i m o s ",bR,bT,bS={};bF.each(bV,function(bW,bX){bR=bW.match(/^([^A-Z]+?)([A-Z])/);if(bR&&bU.indexOf(bR[1]+" ")!==-1){bT=bW.replace(bR[0],bR[2].toLowerCase());bS[bT]=bW;if(bR[1]==="o"){T(bV[bW])}}});bV._hungarianMap=bS}function aa(bU,bR,bT){if(!bU._hungarianMap){T(bU)}var bS;bF.each(bR,function(bV,bW){bS=bU._hungarianMap[bV];if(bS!==c&&(bT||bR[bS]===c)){if(bS.charAt(0)==="o"){if(!bR[bS]){bR[bS]={}}bF.extend(true,bR[bS],bR[bV]);aa(bU[bS],bR[bS],bT)}else{bR[bS]=bR[bV]}}})}function aS(bU){var bT=N.defaults.oLanguage;var bS=bU.sZeroRecords;if(!bU.sEmptyTable&&bS&&bT.sEmptyTable==="No data available in table"){R(bU,bU,"sZeroRecords","sEmptyTable")}if(!bU.sLoadingRecords&&bS&&bT.sLoadingRecords==="Loading..."){R(bU,bU,"sZeroRecords","sLoadingRecords")}if(bU.sInfoThousands){bU.sThousands=bU.sInfoThousands}var bR=bU.sDecimal;if(bR){br(bR)}}var aM=function(bT,bS,bR){if(bT[bS]!==c){bT[bR]=bT[bS]}};function a4(bU){aM(bU,"ordering","bSort");aM(bU,"orderMulti","bSortMulti");aM(bU,"orderClasses","bSortClasses");aM(bU,"orderCellsTop","bSortCellsTop");aM(bU,"order","aaSorting");aM(bU,"orderFixed","aaSortingFixed");aM(bU,"paging","bPaginate");aM(bU,"pagingType","sPaginationType");aM(bU,"pageLength","iDisplayLength");aM(bU,"searching","bFilter");var bT=bU.aoSearchCols;if(bT){for(var bS=0,bR=bT.length;bS<bR;bS++){if(bT[bS]){aa(N.models.oSearch,bT[bS])}}}}function X(bR){aM(bR,"orderable","bSortable");aM(bR,"orderData","aDataSort");aM(bR,"orderSequence","asSorting");aM(bR,"orderDataType","sortDataType")}function be(bS){var bR=bS.oBrowser;var bU=bF("<div/>").css({position:"absolute",top:0,left:0,height:1,width:1,overflow:"hidden"}).append(bF("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(bF('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body");var bT=bU.find(".test");bR.bScrollOversize=bT[0].offsetWidth===100;bR.bScrollbarLeft=bT.offset().left!==1;bU.remove()}function aV(bV,bX,bZ,bR,bT,bS){var bU=bR,bY,bW=false;if(bZ!==c){bY=bZ;bW=true}while(bU!==bT){if(!bV.hasOwnProperty(bU)){continue}bY=bW?bX(bY,bV[bU],bU,bV):bV[bU];bW=true;bU+=bS}return bY}function O(bV,bU){var bW=N.defaults.column;var bR=bV.aoColumns.length;var bT=bF.extend({},N.models.oColumn,bW,{nTh:bU?bU:a.createElement("th"),sTitle:bW.sTitle?bW.sTitle:bU?bU.innerHTML:"",aDataSort:bW.aDataSort?bW.aDataSort:[bR],mData:bW.mData?bW.mData:bR,idx:bR});bV.aoColumns.push(bT);var bS=bV.aoPreSearchCols;bS[bR]=bF.extend({},N.models.oSearch,bS[bR]);a2(bV,bR,null)}function a2(bT,b2,b1){var bX=bT.aoColumns[b2];var bR=bT.oClasses;var bS=bF(bX.nTh);if(!bX.sWidthOrig){bX.sWidthOrig=bS.attr("width")||null;var b3=(bS.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);if(b3){bX.sWidthOrig=b3[1]}}if(b1!==c&&b1!==null){X(b1);aa(N.defaults.column,b1);if(b1.mDataProp!==c&&!b1.mData){b1.mData=b1.mDataProp}if(b1.sType){bX._sManualType=b1.sType}if(b1.className&&!b1.sClass){b1.sClass=b1.className}bF.extend(bX,b1);R(bX,b1,"sWidth","sWidthOrig");if(typeof b1.iDataSort==="number"){bX.aDataSort=[b1.iDataSort]}R(bX,b1,"aDataSort")}var b0=bX.mData;var bW=ao(b0);var bZ=bX.mRender?ao(bX.mRender):null;var bV=function(b4){return typeof b4==="string"&&b4.indexOf("@")!==-1};bX._bAttrSrc=bF.isPlainObject(b0)&&(bV(b0.sort)||bV(b0.type)||bV(b0.filter));bX.fnGetData=function(b6,b5,b7){var b4=bW(b6,b5,c,b7);return bZ&&b5?bZ(b4,b5,b6,b7):b4};bX.fnSetData=function(b4,b6,b5){return ax(b0)(b4,b6,b5)};if(typeof b0!=="number"){bT._rowReadObject=true}if(!bT.oFeatures.bSort){bX.bSortable=false;bS.addClass(bR.sSortableNone)}var bU=bF.inArray("asc",bX.asSorting)!==-1;var bY=bF.inArray("desc",bX.asSorting)!==-1;if(!bX.bSortable||(!bU&&!bY)){bX.sSortingClass=bR.sSortableNone;bX.sSortingClassJUI=""}else{if(bU&&!bY){bX.sSortingClass=bR.sSortableAsc;bX.sSortingClassJUI=bR.sSortJUIAscAllowed}else{if(!bU&&bY){bX.sSortingClass=bR.sSortableDesc;bX.sSortingClassJUI=bR.sSortJUIDescAllowed}else{bX.sSortingClass=bR.sSortable;bX.sSortingClassJUI=bR.sSortJUI}}}}function aJ(bV){if(bV.oFeatures.bAutoWidth!==false){var bU=bV.aoColumns;bw(bV);for(var bT=0,bS=bU.length;bT<bS;bT++){bU[bT].nTh.style.width=bU[bT].sWidth}}var bR=bV.oScroll;if(bR.sY!==""||bR.sX!==""){l(bV)}L(bV,null,"column-sizing",[bV])}function r(bT,bR){var bS=p(bT,"bVisible");return typeof bS[bR]==="number"?bS[bR]:null}function bJ(bT,bR){var bS=p(bT,"bVisible");var bU=bF.inArray(bR,bS);return bU!==-1?bU:null}function aQ(bR){return p(bR,"bVisible").length}function p(bT,bS){var bR=[];bF.map(bT.aoColumns,function(bV,bU){if(bV[bS]){bR.push(bU)}});return bR}function v(bU){var bV=bU.aoColumns;var bZ=bU.aoData;var b1=N.ext.type.detect;var b0,b4,bY,bS,bX,bW;var bT,b2,b3,bR;for(b0=0,b4=bV.length;b0<b4;b0++){bT=bV[b0];bR=[];if(!bT.sType&&bT._sManualType){bT.sType=bT._sManualType}else{if(!bT.sType){for(bY=0,bS=b1.length;bY<bS;bY++){for(bX=0,bW=bZ.length;bX<bW;bX++){if(bR[bX]===c){bR[bX]=bu(bU,bX,b0,"type")}b3=b1[bY](bR[bX],bU);if(!b3&&bY!==b1.length-1){break}if(b3==="html"){break}}if(b3){bT.sType=b3;break}}if(!bT.sType){bT.sType="string"}}}}}function k(bS,b2,bT,b1){var bY,bU,bX,b3,bW,b0,bR;var bV=bS.aoColumns;if(b2){for(bY=b2.length-1;bY>=0;bY--){bR=b2[bY];var bZ=bR.targets!==c?bR.targets:bR.aTargets;if(!bF.isArray(bZ)){bZ=[bZ]}for(bX=0,b3=bZ.length;bX<b3;bX++){if(typeof bZ[bX]==="number"&&bZ[bX]>=0){while(bV.length<=bZ[bX]){O(bS)}b1(bZ[bX],bR)}else{if(typeof bZ[bX]==="number"&&bZ[bX]<0){b1(bV.length+bZ[bX],bR)}else{if(typeof bZ[bX]==="string"){for(bW=0,b0=bV.length;bW<b0;bW++){if(bZ[bX]=="_all"||bF(bV[bW].nTh).hasClass(bZ[bX])){b1(bW,bR)}}}}}}}}if(bT){for(bY=0,bU=bT.length;bY<bU;bY++){b1(bY,bT[bY])}}}function aO(bS,b1,b0,bX){var bZ=bS.aoData.length;var bR=bF.extend(true,{},N.models.oRow,{src:b0?"dom":"data"});bR._aData=b1;bS.aoData.push(bR);var bW,bU;var bV=bS.aoColumns;for(var bY=0,bT=bV.length;bY<bT;bY++){if(b0){bm(bS,bZ,bY,bu(bS,bZ,bY))}bV[bY].sType=null}bS.aiDisplayMaster.push(bZ);if(b0||!bS.oFeatures.bDeferRender){P(bS,bZ,b0,bX)}return bZ}function bQ(bS,bR){var bT;if(!(bR instanceof bF)){bR=bF(bR)}return bR.map(function(bU,bV){bT=bf(bS,bV);return aO(bS,bT.data,bV,bT.cells)})}function bs(bR,bS){return(bS._DT_RowIndex!==c)?bS._DT_RowIndex:null}function a0(bR,bS,bT){return bF.inArray(bT,bR.aoData[bS].anCells)}function bu(bU,bR,bV,bX){var bY=bU.iDraw;var bS=bU.aoColumns[bV];var bT=bU.aoData[bR]._aData;var bZ=bS.sDefaultContent;var bW=bS.fnGetData(bT,bX,{settings:bU,row:bR,col:bV});if(bW===c){if(bU.iDrawError!=bY&&bZ===null){aN(bU,0,"Requested unknown parameter "+(typeof bS.mData=="function"?"{function}":"'"+bS.mData+"'")+" for row "+bR,4);bU.iDrawError=bY}return bZ}if((bW===bT||bW===null)&&bZ!==null){bW=bZ}else{if(typeof bW==="function"){return bW.call(bT)}}if(bW===null&&bX=="display"){return""}return bW}function bm(bS,bT,bW,bV){var bR=bS.aoColumns[bW];var bU=bS.aoData[bT]._aData;bR.fnSetData(bU,bV,{settings:bS,row:bT,col:bW})}var K=/\[.*?\]$/;var f=/\(\)$/;function ak(bR){return bF.map(bR.match(/(\\.|[^\.])+/g),function(bS){return bS.replace(/\\./g,".")})}function ao(bS){if(bF.isPlainObject(bS)){var bT={};bF.each(bS,function(bU,bV){if(bV){bT[bU]=ao(bV)}});return function(bW,bV,bY,bX){var bU=bT[bV]||bT._;return bU!==c?bU(bW,bV,bY,bX):bW}}else{if(bS===null){return function(bU){return bU}}else{if(typeof bS==="function"){return function(bV,bU,bX,bW){return bS(bV,bU,bX,bW)}}else{if(typeof bS==="string"&&(bS.indexOf(".")!==-1||bS.indexOf("[")!==-1||bS.indexOf("(")!==-1)){var bR=function(b2,b3,bU){var b5,bY,b0,bX;if(bU!==""){var b4=ak(bU);for(var b1=0,bW=b4.length;b1<bW;b1++){b5=b4[b1].match(K);bY=b4[b1].match(f);if(b5){b4[b1]=b4[b1].replace(K,"");if(b4[b1]!==""){b2=b2[b4[b1]]}b0=[];b4.splice(0,b1+1);bX=b4.join(".");for(var bZ=0,b6=b2.length;bZ<b6;bZ++){b0.push(bR(b2[bZ],b3,bX))}var bV=b5[0].substring(1,b5[0].length-1);b2=(bV==="")?b0:b0.join(bV);break}else{if(bY){b4[b1]=b4[b1].replace(f,"");b2=b2[b4[b1]]();continue}}if(b2===null||b2[b4[b1]]===c){return c}b2=b2[b4[b1]]}}return b2};return function(bV,bU){return bR(bV,bU,bS)}}else{return function(bV,bU){return bV[bS]}}}}}}function ax(bS){if(bF.isPlainObject(bS)){return ax(bS._)}else{if(bS===null){return function(){}}else{if(typeof bS==="function"){return function(bT,bV,bU){bS(bT,"set",bV,bU)}}else{if(typeof bS==="string"&&(bS.indexOf(".")!==-1||bS.indexOf("[")!==-1||bS.indexOf("(")!==-1)){var bR=function(b1,bX,bT){var b4=ak(bT),b2;var b3=b4[b4.length-1];var b5,bY,bU,bW;for(var b0=0,bV=b4.length-1;b0<bV;b0++){b5=b4[b0].match(K);bY=b4[b0].match(f);if(b5){b4[b0]=b4[b0].replace(K,"");b1[b4[b0]]=[];b2=b4.slice();b2.splice(0,b0+1);bW=b2.join(".");for(var bZ=0,b6=bX.length;bZ<b6;bZ++){bU={};bR(bU,bX[bZ],bW);b1[b4[b0]].push(bU)}return}else{if(bY){b4[b0]=b4[b0].replace(f,"");b1=b1[b4[b0]](bX)}}if(b1[b4[b0]]===null||b1[b4[b0]]===c){b1[b4[b0]]={}}b1=b1[b4[b0]]}if(b3.match(f)){b1=b1[b3.replace(f,"")](bX)}else{b1[b3.replace(K,"")]=bX}};return function(bT,bU){return bR(bT,bU,bS)}}else{return function(bT,bU){bT[bS]=bU}}}}}}function bH(bR){return au(bR.aoData,"_aData")}function bi(bR){bR.aoData.length=0;bR.aiDisplayMaster.length=0;bR.aiDisplay.length=0}function a5(bS,bU,bW){var bV=-1;for(var bT=0,bR=bS.length;bT<bR;bT++){if(bS[bT]==bU){bV=bT}else{if(bS[bT]>bU){bS[bT]--}}}if(bV!=-1&&bW===c){bS.splice(bV,1)}}function B(bU,bS,bR,bV){var b0=bU.aoData[bS];var bW,bY;var bT=function(b1,b2){while(b1.childNodes.length){b1.removeChild(b1.firstChild)}b1.innerHTML=bu(bU,bS,b2,"display")};if(bR==="dom"||((!bR||bR==="auto")&&b0.src==="dom")){b0._aData=bf(bU,b0,bV,bV===c?c:b0._aData).data}else{var bZ=b0.anCells;if(bZ){if(bV!==c){bT(bZ[bV],bV)}else{for(bW=0,bY=bZ.length;bW<bY;bW++){bT(bZ[bW],bW)}}}}b0._aSortData=null;b0._aFilterData=null;var bX=bU.aoColumns;if(bV!==c){bX[bV].sType=null}else{for(bW=0,bY=bX.length;bW<bY;bW++){bX[bW].sType=null}ac(b0)}}function bf(bY,b7,b1,b5){var b2=[],bX=b7.firstChild,bR,bU,bT,b0=0,bV,bW=bY.aoColumns,b3=bY._rowReadObject;b5=b5||b3?{}:[];var b4=function(ca,cc){if(typeof ca==="string"){var b9=ca.indexOf("@");if(b9!==-1){var b8=ca.substring(b9+1);var cb=ax(ca);cb(b5,cc.getAttribute(b8))}}};var b6=function(b8){if(b1===c||b1===b0){bU=bW[b0];bV=bF.trim(b8.innerHTML);if(bU&&bU._bAttrSrc){var b9=ax(bU.mData._);b9(b5,bV);b4(bU.mData.sort,b8);b4(bU.mData.type,b8);b4(bU.mData.filter,b8)}else{if(b3){if(!bU._setter){bU._setter=ax(bU.mData)}bU._setter(b5,bV)}else{b5[b0]=bV}}}b0++};if(bX){while(bX){bR=bX.nodeName.toUpperCase();if(bR=="TD"||bR=="TH"){b6(bX);b2.push(bX)}bX=bX.nextSibling}}else{b2=b7.anCells;for(var bZ=0,bS=b2.length;bZ<bS;bZ++){b6(b2[bZ])}}return{data:b5,cells:b2}}function P(bS,bZ,bR,bX){var b2=bS.aoData[bZ],bV=b2._aData,b1=[],b0,bW,bU,bY,bT;if(b2.nTr===null){b0=bR||a.createElement("tr");b2.nTr=b0;b2.anCells=b1;b0._DT_RowIndex=bZ;ac(b2);for(bY=0,bT=bS.aoColumns.length;bY<bT;bY++){bU=bS.aoColumns[bY];bW=bR?bX[bY]:a.createElement(bU.sCellType);b1.push(bW);if(!bR||bU.mRender||bU.mData!==bY){bW.innerHTML=bu(bS,bZ,bY,"display")}if(bU.sClass){bW.className+=" "+bU.sClass}if(bU.bVisible&&!bR){b0.appendChild(bW)}else{if(!bU.bVisible&&bR){bW.parentNode.removeChild(bW)}}if(bU.fnCreatedCell){bU.fnCreatedCell.call(bS.oInstance,bW,bu(bS,bZ,bY),bV,bZ,bY)}}L(bS,"aoRowCreatedCallback",null,[b0,bV,bZ])}b2.nTr.setAttribute("role","row")}function ac(bU){var bT=bU.nTr;var bS=bU._aData;if(bT){if(bS.DT_RowId){bT.id=bS.DT_RowId}if(bS.DT_RowClass){var bR=bS.DT_RowClass.split(" ");bU.__rowc=bU.__rowc?aH(bU.__rowc.concat(bR)):bR;bF(bT).removeClass(bU.__rowc.join(" ")).addClass(bS.DT_RowClass)}if(bS.DT_RowData){bF(bT).data(bS.DT_RowData)}}}function aL(bR){var bV,b0,bZ,b2,bU;var bW=bR.nTHead;var bX=bR.nTFoot;var bY=bF("th, td",bW).length===0;var bT=bR.oClasses;var bS=bR.aoColumns;if(bY){b2=bF("<tr/>").appendTo(bW)}for(bV=0,b0=bS.length;bV<b0;bV++){bU=bS[bV];bZ=bF(bU.nTh).addClass(bU.sClass);if(bY){bZ.appendTo(b2)}if(bR.oFeatures.bSort){bZ.addClass(bU.sSortingClass);if(bU.bSortable!==false){bZ.attr("tabindex",bR.iTabIndex).attr("aria-controls",bR.sTableId);C(bR,bU.nTh,bV)}}if(bU.sTitle!=bZ.html()){bZ.html(bU.sTitle)}S(bR,"header")(bR,bZ,bU,bT)}if(bY){aw(bR.aoHeader,bW)}bF(bW).find(">tr").attr("role","row");bF(bW).find(">tr>th, >tr>td").addClass(bT.sHeaderTH);bF(bX).find(">tr>th, >tr>td").addClass(bT.sFooterTH);if(bX!==null){var b1=bR.aoFooter[0];for(bV=0,b0=b1.length;bV<b0;bV++){bU=bS[bV];bU.nTf=b1[bV].cell;if(bU.sClass){bF(bU.nTf).addClass(bU.sClass)}}}}function a6(bU,b3,b6){var bZ,bW,bY,b2,bX,b0,bV,b5;var bT=[];var b1=[];var bR=bU.aoColumns.length;var bS,b4;if(!b3){return}if(b6===c){b6=false}for(bZ=0,bW=b3.length;bZ<bW;bZ++){bT[bZ]=b3[bZ].slice();bT[bZ].nTr=b3[bZ].nTr;for(bY=bR-1;bY>=0;bY--){if(!bU.aoColumns[bY].bVisible&&!b6){bT[bZ].splice(bY,1)}}b1.push([])}for(bZ=0,bW=bT.length;bZ<bW;bZ++){b5=bT[bZ].nTr;if(b5){while((bV=b5.firstChild)){b5.removeChild(bV)}}for(bY=0,b2=bT[bZ].length;bY<b2;bY++){bS=1;b4=1;if(b1[bZ][bY]===c){b5.appendChild(bT[bZ][bY].cell);b1[bZ][bY]=1;while(bT[bZ+bS]!==c&&bT[bZ][bY].cell==bT[bZ+bS][bY].cell){b1[bZ+bS][bY]=1;bS++}while(bT[bZ][bY+b4]!==c&&bT[bZ][bY].cell==bT[bZ][bY+b4].cell){for(bX=0;bX<bS;bX++){b1[bZ+bX][bY+b4]=1}b4++}bF(bT[bZ][bY].cell).attr("rowspan",bS).attr("colspan",b4)}}}}function a3(bT){var cd=L(bT,"aoPreDrawCallback","preDraw",[bT]);if(bF.inArray(false,cd)!==-1){w(bT,false);return}var cc,b8,b4;var bX=[];var cf=0;var b1=bT.asStripeClasses;var b6=b1.length;var b2=bT.aoOpenRows.length;var b7=bT.oLanguage;var b3=bT.iInitDisplayStart;var cb=y(bT)=="ssp";var bW=bT.aiDisplay;bT.bDrawing=true;if(b3!==c&&b3!==-1){bT._iDisplayStart=cb?b3:b3>=bT.fnRecordsDisplay()?0:b3;bT.iInitDisplayStart=-1}var bS=bT._iDisplayStart;var bU=bT.fnDisplayEnd();if(bT.bDeferLoading){bT.bDeferLoading=false;bT.iDraw++;w(bT,false)}else{if(!cb){bT.iDraw++}else{if(!bT.bDestroying&&!af(bT)){return}}}if(bW.length!==0){var bV=cb?0:bS;var bR=cb?bT.aoData.length:bU;for(var b9=bV;b9<bR;b9++){var bZ=bW[b9];var b0=bT.aoData[bZ];if(b0.nTr===null){P(bT,bZ)}var ce=b0.nTr;if(b6!==0){var ca=b1[cf%b6];if(b0._sRowStripe!=ca){bF(ce).removeClass(b0._sRowStripe).addClass(ca);b0._sRowStripe=ca}}L(bT,"aoRowCallback",null,[ce,b0._aData,cf,b9]);bX.push(ce);cf++}}else{var b5=b7.sZeroRecords;if(bT.iDraw==1&&y(bT)=="ajax"){b5=b7.sLoadingRecords}else{if(b7.sEmptyTable&&bT.fnRecordsTotal()===0){b5=b7.sEmptyTable}}bX[0]=bF("<tr/>",{"class":b6?b1[0]:""}).append(bF("<td />",{valign:"top",colSpan:aQ(bT),"class":bT.oClasses.sRowEmpty}).html(b5))[0]}L(bT,"aoHeaderCallback","header",[bF(bT.nTHead).children("tr")[0],bH(bT),bS,bU,bW]);L(bT,"aoFooterCallback","footer",[bF(bT.nTFoot).children("tr")[0],bH(bT),bS,bU,bW]);var bY=bF(bT.nTBody);bY.children().detach();bY.append(bF(bX));L(bT,"aoDrawCallback","draw",[bT]);bT.bSorted=false;bT.bFiltered=false;bT.bDrawing=false}function ai(bV,bS){var bU=bV.oFeatures,bR=bU.bSort,bT=bU.bFilter;if(bR){x(bV)}if(bT){u(bV,bV.oPreviousSearch)}else{bV.aiDisplay=bV.aiDisplayMaster.slice()}if(bS!==true){bV._iDisplayStart=0}bV._drawHold=bS;a3(bV);bV._drawHold=false}function i(bV){var b8=bV.oClasses;var b5=bF(bV.nTable);var bX=bF("<div/>").insertBefore(b5);var bW=bV.oFeatures;var bS=bF("<div/>",{id:bV.sTableId+"_wrapper","class":b8.sWrapper+(bV.nTFoot?"":" "+b8.sNoFooter)});bV.nHolding=bX[0];bV.nTableWrapper=bS[0];bV.nTableReinsertBefore=bV.nTable.nextSibling;var bY=bV.sDom.split("");var b3,bZ,bU,b9,b7,b1;for(var b4=0;b4<bY.length;b4++){b3=null;bZ=bY[b4];if(bZ=="<"){bU=bF("<div/>")[0];b9=bY[b4+1];if(b9=="'"||b9=='"'){b7="";b1=2;while(bY[b4+b1]!=b9){b7+=bY[b4+b1];b1++}if(b7=="H"){b7=b8.sJUIHeader}else{if(b7=="F"){b7=b8.sJUIFooter}}if(b7.indexOf(".")!=-1){var b2=b7.split(".");bU.id=b2[0].substr(1,b2[0].length-1);bU.className=b2[1]}else{if(b7.charAt(0)=="#"){bU.id=b7.substr(1,b7.length-1)}else{bU.className=b7}}b4+=b1}bS.append(bU);bS=bF(bU)}else{if(bZ==">"){bS=bS.parent()}else{if(bZ=="l"&&bW.bPaginate&&bW.bLengthChange){b3=aR(bV)}else{if(bZ=="f"&&bW.bFilter){b3=q(bV)}else{if(bZ=="r"&&bW.bProcessing){b3=bA(bV)}else{if(bZ=="t"){b3=bz(bV)}else{if(bZ=="i"&&bW.bInfo){b3=g(bV)}else{if(bZ=="p"&&bW.bPaginate){b3=aA(bV)}else{if(N.ext.feature.length!==0){var b6=N.ext.feature;for(var b0=0,bR=b6.length;b0<bR;b0++){if(bZ==b6[b0].cFeature){b3=b6[b0].fnInit(bV);break}}}}}}}}}}}if(b3){var bT=bV.aanFeatures;if(!bT[bZ]){bT[bZ]=[]}bT[bZ].push(b3);bS.append(b3)}}bX.replaceWith(bS)}function aw(bX,bS){var b4=bF(bS).children("tr");var b3,b1;var bZ,bW,bV,bT,b5,b0,bY,b6,bR;var b2;var bU=function(b7,ca,b9){var b8=b7[ca];while(b8[b9]){b9++}return b9};bX.splice(0,bX.length);for(bZ=0,bT=b4.length;bZ<bT;bZ++){bX.push([])}for(bZ=0,bT=b4.length;bZ<bT;bZ++){b3=b4[bZ];bY=0;b1=b3.firstChild;while(b1){if(b1.nodeName.toUpperCase()=="TD"||b1.nodeName.toUpperCase()=="TH"){b6=b1.getAttribute("colspan")*1;bR=b1.getAttribute("rowspan")*1;b6=(!b6||b6===0||b6===1)?1:b6;bR=(!bR||bR===0||bR===1)?1:bR;b0=bU(bX,bZ,bY);b2=b6===1?true:false;for(bV=0;bV<b6;bV++){for(bW=0;bW<bR;bW++){bX[bZ+bW][b0+bV]={cell:b1,unique:b2};bX[bZ+bW].nTr=b3}}}b1=b1.nextSibling}}}function bh(bY,bS,bW){var bT=[];if(!bW){bW=bY.aoHeader;if(bS){bW=[];aw(bW,bS)}}for(var bV=0,bR=bW.length;bV<bR;bV++){for(var bU=0,bX=bW[bV].length;bU<bX;bU++){if(bW[bV][bU].unique&&(!bT[bU]||!bY.bSortCellsTop)){bT[bU]=bW[bV][bU].cell}}}return bT}function av(bS,bT,bX){L(bS,"aoServerParams","serverParams",[bT]);if(bT&&bF.isArray(bT)){var bU={};var bV=/(.*?)\[\]$/;bF.each(bT,function(b3,b4){var b2=b4.name.match(bV);if(b2){var b1=b2[0];if(!bU[b1]){bU[b1]=[]}bU[b1].push(b4.value)}else{bU[b4.name]=b4.value}});bT=bU}var bR;var bY=bS.ajax;var bZ=bS.oInstance;if(bF.isPlainObject(bY)&&bY.data){bR=bY.data;var b0=bF.isFunction(bR)?bR(bT):bR;bT=bF.isFunction(bR)&&b0?b0:bF.extend(true,bT,b0);delete bY.data}var bW={data:bT,success:function(b2){var b1=b2.error||b2.sError;if(b1){bS.oApi._fnLog(bS,0,b1)}bS.json=b2;L(bS,null,"xhr",[bS,b2]);bX(b2)},dataType:"json",cache:false,type:bS.sServerMethod,error:function(b4,b1,b3){var b2=bS.oApi._fnLog;if(b1=="parsererror"){b2(bS,0,"Invalid JSON response",1)}else{if(b4.readyState===4){b2(bS,0,"Ajax error",7)}}w(bS,false)}};bS.oAjaxData=bT;L(bS,null,"preXhr",[bS,bT]);if(bS.fnServerData){bS.fnServerData.call(bZ,bS.sAjaxSource,bF.map(bT,function(b2,b1){return{name:b1,value:b2}}),bX,bS)}else{if(bS.sAjaxSource||typeof bY==="string"){bS.jqXHR=bF.ajax(bF.extend(bW,{url:bY||bS.sAjaxSource}))}else{if(bF.isFunction(bY)){bS.jqXHR=bY.call(bZ,bT,bX,bS)}else{bS.jqXHR=bF.ajax(bF.extend(bW,bY));bY.data=bR}}}}function af(bR){if(bR.bAjaxDataGet){bR.iDraw++;w(bR,true);av(bR,bL(bR),function(bS){V(bR,bS)});return false}return true}function bL(bW){var bX=bW.aoColumns,b3=bX.length,bT=bW.oFeatures,bR=bW.oPreviousSearch,b2=bW.aoPreSearchCols,b0,bZ=[],bS,bV,b5,bY=aI(bW),b7=bW._iDisplayStart,b1=bT.bPaginate!==false?bW._iDisplayLength:-1;var bU=function(b8,b9){bZ.push({name:b8,value:b9})};bU("sEcho",bW.iDraw);bU("iColumns",b3);bU("sColumns",au(bX,"sName").join(","));bU("iDisplayStart",b7);bU("iDisplayLength",b1);var b4={draw:bW.iDraw,columns:[],order:[],start:b7,length:b1,search:{value:bR.sSearch,regex:bR.bRegex}};for(b0=0;b0<b3;b0++){bV=bX[b0];b5=b2[b0];bS=typeof bV.mData=="function"?"function":bV.mData;b4.columns.push({data:bS,name:bV.sName,searchable:bV.bSearchable,orderable:bV.bSortable,search:{value:b5.sSearch,regex:b5.bRegex}});bU("mDataProp_"+b0,bS);if(bT.bFilter){bU("sSearch_"+b0,b5.sSearch);bU("bRegex_"+b0,b5.bRegex);bU("bSearchable_"+b0,bV.bSearchable)}if(bT.bSort){bU("bSortable_"+b0,bV.bSortable)}}if(bT.bFilter){bU("sSearch",bR.sSearch);bU("bRegex",bR.bRegex)}if(bT.bSort){bF.each(bY,function(b8,b9){b4.order.push({column:b9.col,dir:b9.dir});bU("iSortCol_"+b8,b9.col);bU("sSortDir_"+b8,b9.dir)});bU("iSortingCols",bY.length)}var b6=N.ext.legacy.ajax;if(b6===null){return bW.sAjaxSource?bZ:b4}return b6?bZ:b4}function V(bR,bZ){var bW=function(b0,b1){return bZ[b0]!==c?bZ[b0]:bZ[b1]};var bU=bW("sEcho","draw");var bV=bW("iTotalRecords","recordsTotal");var bY=bW("iTotalDisplayRecords","recordsFiltered");if(bU){if(bU*1<bR.iDraw){return}bR.iDraw=bU*1}bi(bR);bR._iRecordsTotal=parseInt(bV,10);bR._iRecordsDisplay=parseInt(bY,10);var bS=bt(bR,bZ);for(var bT=0,bX=bS.length;bT<bX;bT++){aO(bR,bS[bT])}bR.aiDisplay=bR.aiDisplayMaster.slice();bR.bAjaxDataGet=false;a3(bR);if(!bR._bInitComplete){aC(bR,bZ)}bR.bAjaxDataGet=true;w(bR,false)}function bt(bT,bS){var bR=bF.isPlainObject(bT.ajax)&&bT.ajax.dataSrc!==c?bT.ajax.dataSrc:bT.sAjaxDataProp;if(bR==="data"){return bS.aaData||bS[bR]}return bR!==""?ao(bR)(bS):bS}function q(bU){var bV=bU.oClasses;var bT=bU.sTableId;var bX=bU.oLanguage;var bW=bU.oPreviousSearch;var bS=bU.aanFeatures;var b2='<input type="search" class="'+bV.sFilterInput+'"/>';var b1=bX.sSearch;b1=b1.match(/_INPUT_/)?b1.replace("_INPUT_",b2):b1+b2;var bR=bF("<div/>",{id:!bS.f?bT+"_filter":null,"class":bV.sFilter}).append(bF("<label/>").append(b1));var b0=function(){var b4=bS.f;var b3=!this.value?"":this.value;if(b3!=bW.sSearch){u(bU,{sSearch:b3,bRegex:bW.bRegex,bSmart:bW.bSmart,bCaseInsensitive:bW.bCaseInsensitive});bU._iDisplayStart=0;a3(bU)}};var bZ=bU.searchDelay!==null?bU.searchDelay:y(bU)==="ssp"?400:0;var bY=bF("input",bR).val(bW.sSearch).attr("placeholder",bX.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",bZ?al(b0,bZ):b0).bind("keypress.DT",function(b3){if(b3.keyCode==13){return false}}).attr("aria-controls",bT);bF(bU.nTable).on("search.dt.DT",function(b4,b3){if(bU===b3){try{if(bY[0]!==a.activeElement){bY.val(bW.sSearch)}}catch(b5){}}});return bR[0]}function u(bU,bY,bX){var bT=bU.oPreviousSearch;var bW=bU.aoPreSearchCols;var bV=function(bZ){bT.sSearch=bZ.sSearch;bT.bRegex=bZ.bRegex;bT.bSmart=bZ.bSmart;bT.bCaseInsensitive=bZ.bCaseInsensitive};var bS=function(bZ){return bZ.bEscapeRegex!==c?!bZ.bEscapeRegex:bZ.bRegex};v(bU);if(y(bU)!="ssp"){ay(bU,bY.sSearch,bX,bS(bY),bY.bSmart,bY.bCaseInsensitive);bV(bY);for(var bR=0;bR<bW.length;bR++){Y(bU,bW[bR].sSearch,bR,bS(bW[bR]),bW[bR].bSmart,bW[bR].bCaseInsensitive)}ar(bU)}else{bV(bY)}bU.bFiltered=true;L(bU,null,"search",[bU])}function ar(bU){var bT=N.ext.search;var bX=bU.aiDisplay;var bZ,bS;for(var bW=0,bY=bT.length;bW<bY;bW++){var b0=[];for(var bV=0,bR=bX.length;bV<bR;bV++){bS=bX[bV];bZ=bU.aoData[bS];if(bT[bW](bU,bZ._aFilterData,bS,bZ._aData,bV)){b0.push(bS)}}bX.length=0;bX.push.apply(bX,b0)}}function Y(bS,bR,bW,bZ,b0,bU){if(bR===""){return}var bX;var bY=bS.aiDisplay;var bT=aW(bR,bZ,b0,bU);for(var bV=bY.length-1;bV>=0;bV--){bX=bS.aoData[bY[bV]]._aFilterData[bW];if(!bT.test(bX)){bY.splice(bV,1)}}}function ay(bS,b0,bR,bZ,b2,bV){var bU=aW(b0,bZ,b2,bV);var bT=bS.oPreviousSearch.sSearch;var bX=bS.aiDisplayMaster;var bY,b1,bW;if(N.ext.search.length!==0){bR=true}b1=aE(bS);if(b0.length<=0){bS.aiDisplay=bX.slice()}else{if(b1||bR||bT.length>b0.length||b0.indexOf(bT)!==0||bS.bSorted){bS.aiDisplay=bX.slice()}bY=bS.aiDisplay;for(bW=bY.length-1;bW>=0;bW--){if(!bU.test(bS.aoData[bY[bW]]._sFilterRow)){bY.splice(bW,1)}}}}function aW(bT,bU,bV,bR){bT=bU?bT:m(bT);if(bV){var bS=bF.map(bT.match(/"[^"]+"|[^ ]+/g)||"",function(bX){if(bX.charAt(0)==='"'){var bW=bX.match(/^"(.*)"$/);bX=bW?bW[1]:bX}return bX.replace('"',"")});bT="^(?=.*?"+bS.join(")(?=.*?")+").*$"}return new RegExp(bT,bR?"i":"")}function m(bR){return bR.replace(aD,"\\$1")}var e=bF("<div>")[0];var aq=e.textContent!==c;function aE(bS){var bU=bS.aoColumns;var bT;var bW,bV,b0,bR,bZ,bX,b2;var b1=N.ext.type.search;var bY=false;for(bW=0,b0=bS.aoData.length;bW<b0;bW++){b2=bS.aoData[bW];if(!b2._aFilterData){bZ=[];for(bV=0,bR=bU.length;bV<bR;bV++){bT=bU[bV];if(bT.bSearchable){bX=bu(bS,bW,bV,"filter");if(b1[bT.sType]){bX=b1[bT.sType](bX)}if(bX===null){bX=""}if(typeof bX!=="string"&&bX.toString){bX=bX.toString()}}else{bX=""}if(bX.indexOf&&bX.indexOf("&")!==-1){e.innerHTML=bX;bX=aq?e.textContent:e.innerText}if(bX.replace){bX=bX.replace(/[\r\n]/g,"")}bZ.push(bX)}b2._aFilterData=bZ;b2._sFilterRow=bZ.join("  ");bY=true}}return bY}function by(bR){return{search:bR.sSearch,smart:bR.bSmart,regex:bR.bRegex,caseInsensitive:bR.bCaseInsensitive}}function aF(bR){return{sSearch:bR.search,bSmart:bR.smart,bRegex:bR.regex,bCaseInsensitive:bR.caseInsensitive}}function g(bS){var bT=bS.sTableId,bR=bS.aanFeatures.i,bU=bF("<div/>",{"class":bS.oClasses.sInfo,id:!bR?bT+"_info":null});if(!bR){bS.aoDrawCallback.push({fn:at,sName:"information"});bU.attr("role","status").attr("aria-live","polite");bF(bS.nTable).attr("aria-describedby",bT+"_info")}return bU[0]}function at(bU){var bR=bU.aanFeatures.i;if(bR.length===0){return}var bT=bU.oLanguage,bS=bU._iDisplayStart+1,bV=bU.fnDisplayEnd(),bY=bU.fnRecordsTotal(),bX=bU.fnRecordsDisplay(),bW=bX?bT.sInfo:bT.sInfoEmpty;if(bX!==bY){bW+=" "+bT.sInfoFiltered}bW+=bT.sInfoPostFix;bW=bp(bU,bW);var bZ=bT.fnInfoCallback;if(bZ!==null){bW=bZ.call(bU.oInstance,bU,bS,bV,bY,bX,bW)}bF(bR).html(bW)}function bp(bU,bW){var bS=bU.fnFormatNumber,bX=bU._iDisplayStart+1,bR=bU._iDisplayLength,bV=bU.fnRecordsDisplay(),bT=bR===-1;return bW.replace(/_START_/g,bS.call(bU,bX)).replace(/_END_/g,bS.call(bU,bU.fnDisplayEnd())).replace(/_MAX_/g,bS.call(bU,bU.fnRecordsTotal())).replace(/_TOTAL_/g,bS.call(bU,bV)).replace(/_PAGE_/g,bS.call(bU,bT?1:Math.ceil(bX/bR))).replace(/_PAGES_/g,bS.call(bU,bT?1:Math.ceil(bV/bR)))}function h(bX){var bU,bR,bY=bX.iInitDisplayStart;var bT=bX.aoColumns,bW;var bV=bX.oFeatures;if(!bX.bInitialised){setTimeout(function(){h(bX)},200);return}i(bX);aL(bX);a6(bX,bX.aoHeader);a6(bX,bX.aoFooter);w(bX,true);if(bV.bAutoWidth){bw(bX)}for(bU=0,bR=bT.length;bU<bR;bU++){bW=bT[bU];if(bW.sWidth){bW.nTh.style.width=bK(bW.sWidth)}}ai(bX);var bS=y(bX);if(bS!="ssp"){if(bS=="ajax"){av(bX,[],function(b0){var bZ=bt(bX,b0);for(bU=0;bU<bZ.length;bU++){aO(bX,bZ[bU])}bX.iInitDisplayStart=bY;ai(bX);w(bX,false);aC(bX,b0)},bX)}else{w(bX,false);aC(bX)}}}function aC(bS,bR){bS._bInitComplete=true;if(bR){aJ(bS)}L(bS,"aoInitComplete","init",[bS,bR])}function aT(bS,bT){var bR=parseInt(bT,10);bS._iDisplayLength=bR;bl(bS);L(bS,null,"length",[bS,bR])}function aR(bW){var bX=bW.oClasses,bU=bW.sTableId,bT=bW.aLengthMenu,bR=bF.isArray(bT[0]),bV=bR?bT[0]:bT,bZ=bR?bT[1]:bT;var b0=bF("<select/>",{name:bU+"_length","aria-controls":bU,"class":bX.sLengthSelect});for(var bY=0,b1=bV.length;bY<b1;bY++){b0[0][bY]=new Option(bZ[bY],bV[bY])}var bS=bF("<div><label/></div>").addClass(bX.sLength);if(!bW.aanFeatures.l){bS[0].id=bU+"_length"}bS.children().append(bW.oLanguage.sLengthMenu.replace("_MENU_",b0[0].outerHTML));bF("select",bS).val(bW._iDisplayLength).bind("change.DT",function(b2){aT(bW,bF(this).val());a3(bW)});bF(bW.nTable).bind("length.dt.DT",function(b4,b3,b2){if(bW===b3){bF("select",bS).val(b2)}});return bS[0]}function aA(bU){var bT=bU.sPaginationType,bW=N.ext.pager[bT],bS=typeof bW==="function",bX=function(bY){a3(bY)},bV=bF("<div/>").addClass(bU.oClasses.sPaging+bT)[0],bR=bU.aanFeatures;if(!bS){bW.fnInit(bU,bV,bX)}if(!bR.p){bV.id=bU.sTableId+"_paginate";bU.aoDrawCallback.push({fn:function(b1){if(bS){var bY=b1._iDisplayStart,b3=b1._iDisplayLength,bZ=b1.fnRecordsDisplay(),b6=b3===-1,b4=b6?0:Math.ceil(bY/b3),b0=b6?1:Math.ceil(bZ/b3),b5=bW(b4,b0),b2,b7;for(b2=0,b7=bR.p.length;b2<b7;b2++){S(b1,"pageButton")(b1,bR.p[b2],b2,b5,b4,b0)}}else{bW.fnUpdate(b1,bX)}},sName:"pagination"})}return bV}function aG(bT,bU,bX){var bW=bT._iDisplayStart,bR=bT._iDisplayLength,bS=bT.fnRecordsDisplay();if(bS===0||bR===-1){bW=0}else{if(typeof bU==="number"){bW=bU*bR;if(bW>bS){bW=0}}else{if(bU=="first"){bW=0}else{if(bU=="previous"){bW=bR>=0?bW-bR:0;if(bW<0){bW=0}}else{if(bU=="next"){if(bW+bR<bS){bW+=bR}}else{if(bU=="last"){bW=Math.floor((bS-1)/bR)*bR}else{aN(bT,0,"Unknown paging action: "+bU,5)}}}}}}var bV=bT._iDisplayStart!==bW;bT._iDisplayStart=bW;if(bV){L(bT,null,"page",[bT]);if(bX){a3(bT)}}return bV}function bA(bR){return bF("<div/>",{id:!bR.aanFeatures.r?bR.sTableId+"_processing":null,"class":bR.oClasses.sProcessing}).html(bR.oLanguage.sProcessing).insertBefore(bR.nTable)[0]}function w(bS,bR){if(bS.oFeatures.bProcessing){bF(bS.aanFeatures.r).css("display",bR?"block":"none")}L(bS,null,"processing",[bS,bR])}function bz(b5){var b4=bF(b5.nTable);b4.attr("role","grid");var bR=b5.oScroll;if(bR.sX===""&&bR.sY===""){return b5.nTable}var bZ=bR.sX;var bY=bR.sY;var b6=b5.oClasses;var b3=b4.children("caption");var bS=b3.length?b3[0]._captionSide:null;var bV=bF(b4[0].cloneNode(false));var b8=bF(b4[0].cloneNode(false));var bX=b4.children("tfoot");var b0="<div/>";var bW=function(b9){return !b9?null:bK(b9)};if(bR.sX&&b4.attr("width")==="100%"){b4.removeAttr("width")}if(!bX.length){bX=null}var b2=bF(b0,{"class":b6.sScrollWrapper}).append(bF(b0,{"class":b6.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:bZ?bW(bZ):"100%"}).append(bF(b0,{"class":b6.sScrollHeadInner}).css({"box-sizing":"content-box",width:bR.sXInner||"100%"}).append(bV.removeAttr("id").css("margin-left",0).append(bS==="top"?b3:null).append(b4.children("thead"))))).append(bF(b0,{"class":b6.sScrollBody}).css({overflow:"auto",height:bW(bY),width:bW(bZ)}).append(b4));if(bX){b2.append(bF(b0,{"class":b6.sScrollFoot}).css({overflow:"hidden",border:0,width:bZ?bW(bZ):"100%"}).append(bF(b0,{"class":b6.sScrollFootInner}).append(b8.removeAttr("id").css("margin-left",0).append(bS==="bottom"?b3:null).append(b4.children("tfoot")))))}var bT=b2.children();var b1=bT[0];var b7=bT[1];var bU=bX?bT[2]:null;if(bZ){bF(b7).scroll(function(b9){var ca=this.scrollLeft;b1.scrollLeft=ca;if(bX){bU.scrollLeft=ca}})}b5.nScrollHead=b1;b5.nScrollBody=b7;b5.nScrollFoot=bU;b5.aoDrawCallback.push({fn:l,sName:"scrolling"});return b2[0]}function l(cr){var cm=cr.oScroll,bW=cm.sX,ch=cm.sXInner,bT=cm.sY,cf=cm.iBarWidth,ck=bF(cr.nScrollHead),b9=ck[0].style,bV=ck.children("div"),bS=bV[0].style,cu=bV.children("table"),b2=cr.nScrollBody,cd=bF(b2),b8=b2.style,cn=bF(cr.nScrollFoot),cc=cn.children("div"),ca=cc.children("table"),b0=bF(cr.nTHead),cb=bF(cr.nTable),ce=cb[0],bY=ce.style,b7=cr.nTFoot?bF(cr.nTFoot):null,bZ=cr.oBrowser,b4=bZ.bScrollOversize,bU,bX,cp,cs,b5,b3,cj=[],cl=[],cg=[],ct,b1,cv,b6=function(cw){var cx=cw.style;cx.paddingTop="0";cx.paddingBottom="0";cx.borderTopWidth="0";cx.borderBottomWidth="0";cx.height=0};cb.children("thead, tfoot").remove();b5=b0.clone().prependTo(cb);bU=b0.find("tr");cp=b5.find("tr");b5.find("th, td").removeAttr("tabindex");if(b7){b3=b7.clone().prependTo(cb);bX=b7.find("tr");cs=b3.find("tr")}if(!bW){b8.width="100%";ck[0].style.width="100%"}bF.each(bh(cr,b5),function(cw,cx){ct=r(cr,cw);cx.style.width=cr.aoColumns[ct].sWidth});if(b7){a8(function(cw){cw.style.width=""},cs)}if(cm.bCollapse&&bT!==""){b8.height=(cd[0].offsetHeight+b0[0].offsetHeight)+"px"}cv=cb.outerWidth();if(bW===""){bY.width="100%";if(b4&&(cb.find("tbody").height()>b2.offsetHeight||cd.css("overflow-y")=="scroll")){bY.width=bK(cb.outerWidth()-cf)}}else{if(ch!==""){bY.width=bK(ch)}else{if(cv==cd.width()&&cd.height()<cb.height()){bY.width=bK(cv-cf);if(cb.outerWidth()>cv-cf){bY.width=bK(cv)}}else{bY.width=bK(cv)}}}cv=cb.outerWidth();a8(b6,cp);a8(function(cw){cg.push(cw.innerHTML);cj.push(bK(bF(cw).css("width")))},cp);a8(function(cx,cw){cx.style.width=cj[cw]},bU);bF(cp).height(0);if(b7){a8(b6,cs);a8(function(cw){cl.push(bK(bF(cw).css("width")))},cs);a8(function(cx,cw){cx.style.width=cl[cw]},bX);bF(cs).height(0)}a8(function(cx,cw){cx.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+cg[cw]+"</div>";cx.style.width=cj[cw]},cp);if(b7){a8(function(cx,cw){cx.innerHTML="";cx.style.width=cl[cw]},cs)}if(cb.outerWidth()<cv){b1=((b2.scrollHeight>b2.offsetHeight||cd.css("overflow-y")=="scroll"))?cv+cf:cv;if(b4&&(b2.scrollHeight>b2.offsetHeight||cd.css("overflow-y")=="scroll")){bY.width=bK(b1-cf)}if(bW===""||ch!==""){aN(cr,1,"Possible column misalignment",6)}}else{b1="100%"}b8.width=bK(b1);b9.width=bK(b1);if(b7){cr.nScrollFoot.style.width=bK(b1)}if(!bT){if(b4){b8.height=bK(ce.offsetHeight+cf)}}if(bT&&cm.bCollapse){b8.height=bK(bT);var cq=(bW&&ce.offsetWidth>b2.offsetWidth)?cf:0;if(ce.offsetHeight<b2.offsetHeight){b8.height=bK(ce.offsetHeight+cq)}}var bR=cb.outerWidth();cu[0].style.width=bK(bR);bS.width=bK(bR);var ci=cb.height()>b2.clientHeight||cd.css("overflow-y")=="scroll";var co="padding"+(bZ.bScrollbarLeft?"Left":"Right");bS[co]=ci?cf+"px":"0px";if(b7){ca[0].style.width=bK(bR);cc[0].style.width=bK(bR);cc[0].style[co]=ci?cf+"px":"0px"}cd.scroll();if((cr.bSorted||cr.bFiltered)&&!cr._drawHold){b2.scrollTop=0}}function a8(bW,bT,bS){var bU=0,bV=0,bR=bT.length;var bY,bX;while(bV<bR){bY=bT[bV].firstChild;bX=bS?bS[bV].firstChild:null;while(bY){if(bY.nodeType===1){if(bS){bW(bY,bX,bU)}else{bW(bY,bU)}bU++}bY=bY.nextSibling;bX=bS?bX.nextSibling:null}bV++}}var a1=/<.*?>/g;function bw(bX){var b5=bX.nTable,bU=bX.aoColumns,bT=bX.oScroll,b2=bT.sY,b3=bT.sX,bW=bT.sXInner,b9=bU.length,b7=p(bX,"bVisible"),b6=bF("th",bX.nTHead),b0=b5.getAttribute("width"),bZ=b5.parentNode,b8=false,b4,bV,ca,b1,bR;for(b4=0;b4<b7.length;b4++){bV=bU[b7[b4]];if(bV.sWidth!==null){bV.sWidth=ag(bV.sWidthOrig,bZ);b8=true}}if(!b8&&!b3&&!b2&&b9==aQ(bX)&&b9==b6.length){for(b4=0;b4<b9;b4++){bU[b4].sWidth=bK(b6.eq(b4).width())}}else{var bY=bF(b5).clone().empty().css("visibility","hidden").removeAttr("id").append(bF(bX.nTHead).clone(false)).append(bF(bX.nTFoot).clone(false)).append(bF("<tbody><tr/></tbody>"));bY.find("tfoot th, tfoot td").css("width","");var bS=bY.find("tbody tr");b6=bh(bX,bY.find("thead")[0]);for(b4=0;b4<b7.length;b4++){bV=bU[b7[b4]];b6[b4].style.width=bV.sWidthOrig!==null&&bV.sWidthOrig!==""?bK(bV.sWidthOrig):""}if(bX.aoData.length){for(b4=0;b4<b7.length;b4++){ca=b7[b4];bV=bU[ca];bF(aK(bX,ca)).clone(false).append(bV.sContentPadding).appendTo(bS)}}bY.appendTo(bZ);if(b3&&bW){bY.width(bW)}else{if(b3){bY.css("width","auto");if(bY.width()<bZ.offsetWidth){bY.width(bZ.offsetWidth)}}else{if(b2){bY.width(bZ.offsetWidth)}else{if(b0){bY.width(b0)}}}}az(bX,bY[0]);if(b3){var cb=0;for(b4=0;b4<b7.length;b4++){bV=bU[b7[b4]];bR=bF(b6[b4]).outerWidth();cb+=bV.sWidthOrig===null?bR:parseInt(bV.sWidth,10)+bR-bF(b6[b4]).width()}bY.width(bK(cb));b5.style.width=bK(cb)}for(b4=0;b4<b7.length;b4++){bV=bU[b7[b4]];b1=bF(b6[b4]).width();if(b1){bV.sWidth=bK(b1)}}b5.style.width=bK(bY.css("width"));bY.remove()}if(b0){b5.style.width=bK(b0)}if((b0||b3)&&!bX._reszEvt){bF(b).bind("resize.DT-"+bX.sInstance,al(function(){aJ(bX)}));bX._reszEvt=true}}function al(bR,bU){var bT=bU!==c?bU:200,bS,bV;return function(){var bY=this,bX=+new Date(),bW=arguments;if(bS&&bX<bS+bT){clearTimeout(bV);bV=setTimeout(function(){bS=c;bR.apply(bY,bW)},bT)}else{if(bS){bS=bX;bR.apply(bY,bW)}else{bS=bX}}}}function ag(bS,bR){if(!bS){return 0}var bU=bF("<div/>").css("width",bK(bS)).appendTo(bR||a.body);var bT=bU[0].offsetWidth;bU.remove();return bT}function az(bT,bU){var bR=bT.oScroll;if(bR.sX||bR.sY){var bS=!bR.sX?bR.iBarWidth:0;bU.style.width=bK(bF(bU).outerWidth()-bS)}}function aK(bS,bU){var bR=ab(bS,bU);if(bR<0){return null}var bT=bS.aoData[bR];return !bT.nTr?bF("<td/>").html(bu(bS,bR,bU,"display"))[0]:bT.anCells[bU]}function ab(bW,bX){var bV,bR=-1,bT=-1;for(var bU=0,bS=bW.aoData.length;bU<bS;bU++){bV=bu(bW,bU,bX,"display")+"";bV=bV.replace(a1,"");if(bV.length>bR){bR=bV.length;bT=bU}}return bT}function bK(bR){if(bR===null){return"0px"}if(typeof bR=="number"){return bR<0?"0px":bR+"px"}return bR.match(/\d$/)?bR+"px":bR}function bb(){if(!N.__scrollbarWidth){var bT=bF("<p/>").css({width:"100%",height:200,padding:0})[0];var bU=bF("<div/>").css({position:"absolute",top:0,left:0,width:200,height:150,padding:0,overflow:"hidden",visibility:"hidden"}).append(bT).appendTo("body");var bS=bT.offsetWidth;bU.css("overflow","scroll");var bR=bT.offsetWidth;if(bS===bR){bR=bU[0].clientWidth}bU.remove();N.__scrollbarWidth=bS-bR}return N.__scrollbarWidth}function aI(bU){var bZ,bT,bW,b0,bX=[],b2=[],b4=bU.aoColumns,bY,b3,bR,b1,bV=bU.aaSortingFixed,b6=bF.isPlainObject(bV),bS=[],b5=function(b7){if(b7.length&&!bF.isArray(b7[0])){bS.push(b7)}else{bS.push.apply(bS,b7)}};if(bF.isArray(bV)){b5(bV)}if(b6&&bV.pre){b5(bV.pre)}b5(bU.aaSorting);if(b6&&bV.post){b5(bV.post)}for(bZ=0;bZ<bS.length;bZ++){b1=bS[bZ][0];bY=b4[b1].aDataSort;for(bW=0,b0=bY.length;bW<b0;bW++){b3=bY[bW];bR=b4[b3].sType||"string";if(bS[bZ]._idx===c){bS[bZ]._idx=bF.inArray(bS[bZ][1],b4[b3].asSorting)}bX.push({src:b1,col:b3,dir:bS[bZ][1],index:bS[bZ]._idx,type:bR,formatter:N.ext.type.order[bR+"-pre"]})}}return bX}function x(bW){var b8,bU,b5,b7,b9,b4,bR,b1,bX,cd=[],b0=N.ext.type.order,b2=bW.aoData,b6=bW.aoColumns,bS,cc,bV,bZ,b3,ca=0,bY,bT=bW.aiDisplayMaster,cb;v(bW);cb=aI(bW);for(b8=0,bU=cb.length;b8<bU;b8++){bY=cb[b8];if(bY.formatter){ca++}G(bW,bY.col)}if(y(bW)!="ssp"&&cb.length!==0){for(b8=0,b5=bT.length;b8<b5;b8++){cd[bT[b8]]=b8}if(ca===cb.length){bT.sort(function(cm,cl){var cn,ck,ce,cj,cf,cg=cb.length,ci=b2[cm]._aSortData,ch=b2[cl]._aSortData;for(ce=0;ce<cg;ce++){cf=cb[ce];cn=ci[cf.col];ck=ch[cf.col];cj=cn<ck?-1:cn>ck?1:0;if(cj!==0){return cf.dir==="asc"?cj:-cj}}cn=cd[cm];ck=cd[cl];return cn<ck?-1:cn>ck?1:0})}else{bT.sort(function(co,cn){var cp,cm,cf,ce,ck,cg,cl,ch=cb.length,cj=b2[co]._aSortData,ci=b2[cn]._aSortData;for(cf=0;cf<ch;cf++){cg=cb[cf];cp=cj[cg.col];cm=ci[cg.col];cl=b0[cg.type+"-"+cg.dir]||b0["string-"+cg.dir];ck=cl(cp,cm);if(ck!==0){return ck}}cp=cd[co];cm=cd[cn];return cp<cm?-1:cp>cm?1:0})}}bW.bSorted=true}function bd(bV){var b1;var b0;var bW=bV.aoColumns;var bX=aI(bV);var bY=bV.oLanguage.oAria;for(var bZ=0,bT=bW.length;bZ<bT;bZ++){var bS=bW[bZ];var bU=bS.asSorting;var b2=bS.sTitle.replace(/<.*?>/g,"");var bR=bS.nTh;bR.removeAttribute("aria-sort");if(bS.bSortable){if(bX.length>0&&bX[0].col==bZ){bR.setAttribute("aria-sort",bX[0].dir=="asc"?"ascending":"descending");b0=bU[bX[0].index+1]||bU[0]}else{b0=bU[0]}b1=b2+(b0==="asc"?bY.sSortAscending:bY.sSortDescending)}else{b1=b2}bR.setAttribute("aria-label",b1)}}function bj(bU,bW,bR,b0){var bS=bU.aoColumns[bW];var bY=bU.aaSorting;var bV=bS.asSorting;var bZ;var bX=function(b2,b3){var b1=b2._idx;if(b1===c){b1=bF.inArray(b2[1],bV)}return b1+1<bV.length?b1+1:b3?null:0};if(typeof bY[0]==="number"){bY=bU.aaSorting=[bY]}if(bR&&bU.oFeatures.bSortMulti){var bT=bF.inArray(bW,au(bY,"0"));if(bT!==-1){bZ=bX(bY[bT],true);if(bZ===null){bY.splice(bT,1)}else{bY[bT][1]=bV[bZ];bY[bT]._idx=bZ}}else{bY.push([bW,bV[0],0]);bY[bY.length-1]._idx=0}}else{if(bY.length&&bY[0][0]==bW){bZ=bX(bY[0]);bY.length=1;bY[0][1]=bV[bZ];bY[0]._idx=bZ}else{bY.length=0;bY.push([bW,bV[0]]);bY[0]._idx=0}}ai(bU);if(typeof b0=="function"){b0(bU)}}function C(bT,bS,bV,bU){var bR=bT.aoColumns[bV];bc(bS,{},function(bW){if(bR.bSortable===false){return}if(bT.oFeatures.bProcessing){w(bT,true);setTimeout(function(){bj(bT,bV,bW.shiftKey,bU);if(y(bT)!=="ssp"){w(bT,false)}},0)}else{bj(bT,bV,bW.shiftKey,bU)}})}function ae(bW){var bX=bW.aLastSort;var bS=bW.oClasses.sSortColumn;var bU=aI(bW);var bV=bW.oFeatures;var bT,bR,bY;if(bV.bSort&&bV.bSortClasses){for(bT=0,bR=bX.length;bT<bR;bT++){bY=bX[bT].src;bF(au(bW.aoData,"anCells",bY)).removeClass(bS+(bT<2?bT+1:3))}for(bT=0,bR=bU.length;bT<bR;bT++){bY=bU[bT].src;bF(au(bW.aoData,"anCells",bY)).addClass(bS+(bT<2?bT+1:3))}}bW.aLastSort=bU}function G(bR,bW){var bS=bR.aoColumns[bW];var b0=N.ext.order[bS.sSortDataType];var bY;if(b0){bY=b0.call(bR.oInstance,bR,bW,bJ(bR,bW))}var bZ,bU;var bV=N.ext.type.order[bS.sType+"-pre"];for(var bT=0,bX=bR.aoData.length;bT<bX;bT++){bZ=bR.aoData[bT];if(!bZ._aSortData){bZ._aSortData=[]}if(!bZ._aSortData[bW]||b0){bU=b0?bY[bT]:bu(bR,bT,bW,"sort");bZ._aSortData[bW]=bV?bV(bU):bU}}}function bo(bR){if(!bR.oFeatures.bStateSave||bR.bDestroying){return}var bS={time:+new Date(),start:bR._iDisplayStart,length:bR._iDisplayLength,order:bF.extend(true,[],bR.aaSorting),search:by(bR.oPreviousSearch),columns:bF.map(bR.aoColumns,function(bT,bU){return{visible:bT.bVisible,search:by(bR.aoPreSearchCols[bU])}})};L(bR,"aoStateSaveParams","stateSaveParams",[bR,bS]);bR.oSavedState=bS;bR.fnStateSaveCallback.call(bR.oInstance,bR,bS)}function bO(bT,bY){var bW,bZ;var bU=bT.aoColumns;if(!bT.oFeatures.bStateSave){return}var bR=bT.fnStateLoadCallback.call(bT.oInstance,bT);if(!bR||!bR.time){return}var bX=L(bT,"aoStateLoadParams","stateLoadParams",[bT,bR]);if(bF.inArray(false,bX)!==-1){return}var bV=bT.iStateDuration;if(bV>0&&bR.time<+new Date()-(bV*1000)){return}if(bU.length!==bR.columns.length){return}bT.oLoadedState=bF.extend(true,{},bR);bT._iDisplayStart=bR.start;bT.iInitDisplayStart=bR.start;bT._iDisplayLength=bR.length;bT.aaSorting=[];bF.each(bR.order,function(b1,b0){bT.aaSorting.push(b0[0]>=bU.length?[0,b0[1]]:b0)});bF.extend(bT.oPreviousSearch,aF(bR.search));for(bW=0,bZ=bR.columns.length;bW<bZ;bW++){var bS=bR.columns[bW];bU[bW].bVisible=bS.visible;bF.extend(bT.aoPreSearchCols[bW],aF(bS.search))}L(bT,"aoStateLoaded","stateLoaded",[bT,bR])}function an(bT){var bS=N.settings;var bR=bF.inArray(bT,au(bS,"nTable"));return bR!==-1?bS[bR]:null}function aN(bU,bW,bV,bR){bV="DataTables warning: "+(bU!==null?"table id="+bU.sTableId+" - ":"")+bV;if(bR){bV+=". For more information about this error, please see http://datatables.net/tn/"+bR}if(!bW){var bT=N.ext;var bS=bT.sErrMode||bT.errMode;if(bS=="alert"){alert(bV)}else{throw new Error(bV)}}else{if(b.console&&console.log){console.log(bV)}}}function R(bS,bU,bR,bT){if(bF.isArray(bR)){bF.each(bR,function(bV,bW){if(bF.isArray(bW)){R(bS,bU,bW[0],bW[1])}else{R(bS,bU,bW)}});return}if(bT===c){bT=bR}if(bU[bR]!==c){bS[bT]=bU[bR]}}function aX(bR,bT,bS){var bU;for(var bV in bT){if(bT.hasOwnProperty(bV)){bU=bT[bV];if(bF.isPlainObject(bU)){if(!bF.isPlainObject(bR[bV])){bR[bV]={}}bF.extend(true,bR[bV],bU)}else{if(bS&&bV!=="data"&&bV!=="aaData"&&bF.isArray(bU)){bR[bV]=bU.slice()}else{bR[bV]=bU}}}}return bR}function bc(bT,bS,bR){bF(bT).bind("click.DT",bS,function(bU){bT.blur();bR(bU)}).bind("keypress.DT",bS,function(bU){if(bU.which===13){bU.preventDefault();bR(bU)}}).bind("selectstart.DT",function(){return false})}function bN(bU,bS,bR,bT){if(bR){bU[bS].push({fn:bR,sName:bT})}}function L(bT,bU,bV,bS){var bR=[];if(bU){bR=bF.map(bT[bU].slice().reverse(),function(bX,bW){return bX.fn.apply(bT.oInstance,bS)})}if(bV!==null){bF(bT.nTable).trigger(bV+".dt",bS)}return bR}function bl(bT){var bU=bT._iDisplayStart,bS=bT.fnDisplayEnd(),bR=bT._iDisplayLength;if(bU>=bS){bU=bS-bR}bU-=(bU%bR);if(bR===-1||bU<0){bU=0}bT._iDisplayStart=bU}function S(bS,bR){var bU=bS.renderer;var bT=N.ext.renderer[bR];if(bF.isPlainObject(bU)&&bU[bR]){return bT[bU[bR]]||bT._}else{if(typeof bU==="string"){return bT[bU]||bT._}}return bT._}function y(bR){if(bR.oFeatures.bServerSide){return"ssp"}else{if(bR.ajax||bR.sAjaxSource){return"ajax"}}return"dom"}N=function(bT){this.$=function(bX,bW){return this.api(true).$(bX,bW)};this._=function(bX,bW){return this.api(true).rows(bX,bW).data()};this.api=function(bW){return bW?new J(an(this[I.iApiIndex])):new J(this)};this.fnAddData=function(bY,bZ){var bW=this.api(true);var bX=bF.isArray(bY)&&(bF.isArray(bY[0])||bF.isPlainObject(bY[0]))?bW.rows.add(bY):bW.row.add(bY);if(bZ===c||bZ){bW.draw()}return bX.flatten().toArray()};this.fnAdjustColumnSizing=function(bZ){var bY=this.api(true).columns.adjust();var bX=bY.settings()[0];var bW=bX.oScroll;if(bZ===c||bZ){bY.draw(false)}else{if(bW.sX!==""||bW.sY!==""){l(bX)}}};this.fnClearTable=function(bX){var bW=this.api(true).clear();if(bX===c||bX){bW.draw()}};this.fnClose=function(bW){this.api(true).row(bW).child.hide()};this.fnDeleteRow=function(b0,b2,b1){var bX=this.api(true);var bZ=bX.rows(b0);var bW=bZ.settings()[0];var bY=bW.aoData[bZ[0][0]];bZ.remove();if(b2){b2.call(this,bW,bY)}if(b1===c||b1){bX.draw()}return bY};this.fnDestroy=function(bW){this.api(true).destroy(bW)};this.fnDraw=function(bW){this.api(true).draw(!bW)};this.fnFilter=function(b0,bX,bY,b2,b1,bW){var bZ=this.api(true);if(bX===null||bX===c){bZ.search(b0,bY,b2,bW)}else{bZ.column(bX).search(b0,bY,b2,bW)}bZ.draw()};this.fnGetData=function(bZ,bW){var bY=this.api(true);if(bZ!==c){var bX=bZ.nodeName?bZ.nodeName.toLowerCase():"";return bW!==c||bX=="td"||bX=="th"?bY.cell(bZ,bW).data():bY.row(bZ).data()||null}return bY.data().toArray()};this.fnGetNodes=function(bX){var bW=this.api(true);return bX!==c?bW.row(bX).node():bW.rows().nodes().flatten().toArray()};this.fnGetPosition=function(bY){var bX=this.api(true);var bZ=bY.nodeName.toUpperCase();if(bZ=="TR"){return bX.row(bY).index()}else{if(bZ=="TD"||bZ=="TH"){var bW=bX.cell(bY).index();return[bW.row,bW.columnVisible,bW.column]}}return null};this.fnIsOpen=function(bW){return this.api(true).row(bW).child.isShown()};this.fnOpen=function(bX,bW,bY){return this.api(true).row(bX).child(bW,bY).show().child()[0]};this.fnPageChange=function(bW,bY){var bX=this.api(true).page(bW);if(bY===c||bY){bX.draw(false)}};this.fnSetColumnVis=function(bX,bW,bZ){var bY=this.api(true).column(bX).visible(bW);if(bZ===c||bZ){bY.columns.adjust().draw()}};this.fnSettings=function(){return an(this[I.iApiIndex])};this.fnSort=function(bW){this.api(true).order(bW).draw()};this.fnSortListener=function(bX,bW,bY){this.api(true).order.listener(bX,bW,bY)};this.fnUpdate=function(b0,bZ,bW,b1,bY){var bX=this.api(true);if(bW===c||bW===null){bX.row(bZ).data(b0)}else{bX.cell(bZ,bW).data(b0)}if(bY===c||bY){bX.columns.adjust()}if(b1===c||b1){bX.draw()}return 0};this.fnVersionCheck=I.fnVersionCheck;var bU=this;var bS=bT===c;var bR=this.length;if(bS){bT={}}this.oApi=this.internal=I.internal;for(var bV in N.ext.internal){if(bV){this[bV]=ah(bV)}}this.each(function(){var ce={};var cb=bR>1?aX(ce,bT,true):bT;var ck=0,ci,cj,cn,ch,bW;var b6=this.getAttribute("id");var b5=false;var b9=N.defaults;if(this.nodeName.toLowerCase()!="table"){aN(null,0,"Non-table node initialisation ("+this.nodeName+")",2);return}a4(b9);X(b9.column);aa(b9,b9,true);aa(b9.column,b9.column,true);aa(b9,cb);var b2=N.settings;for(ck=0,ci=b2.length;ck<ci;ck++){if(b2[ck].nTable==this){var cg=cb.bRetrieve!==c?cb.bRetrieve:b9.bRetrieve;var b8=cb.bDestroy!==c?cb.bDestroy:b9.bDestroy;if(bS||cg){return b2[ck].oInstance}else{if(b8){b2[ck].oInstance.fnDestroy();break}else{aN(b2[ck],0,"Cannot reinitialise DataTable",3);return}}}if(b2[ck].sTableId==this.id){b2.splice(ck,1);break}}if(b6===null||b6===""){b6="DataTables_Table_"+(N.ext._unique++);this.id=b6}var b3=bF.extend(true,{},N.models.oSettings,{nTable:this,oApi:bU.internal,oInit:cb,sDestroyWidth:bF(this)[0].style.width,sInstance:b6,sTableId:b6});b2.push(b3);b3.oInstance=(bU.length===1)?bU:bF(this).dataTable();a4(cb);if(cb.oLanguage){aS(cb.oLanguage)}if(cb.aLengthMenu&&!cb.iDisplayLength){cb.iDisplayLength=bF.isArray(cb.aLengthMenu[0])?cb.aLengthMenu[0][0]:cb.aLengthMenu[0]}cb=aX(bF.extend(true,{},b9),cb);R(b3.oFeatures,cb,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]);R(b3,cb,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]);R(b3.oScroll,cb,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]);R(b3.oLanguage,cb,"fnInfoCallback");bN(b3,"aoDrawCallback",cb.fnDrawCallback,"user");bN(b3,"aoServerParams",cb.fnServerParams,"user");bN(b3,"aoStateSaveParams",cb.fnStateSaveParams,"user");bN(b3,"aoStateLoadParams",cb.fnStateLoadParams,"user");bN(b3,"aoStateLoaded",cb.fnStateLoaded,"user");bN(b3,"aoRowCallback",cb.fnRowCallback,"user");bN(b3,"aoRowCreatedCallback",cb.fnCreatedRow,"user");bN(b3,"aoHeaderCallback",cb.fnHeaderCallback,"user");bN(b3,"aoFooterCallback",cb.fnFooterCallback,"user");bN(b3,"aoInitComplete",cb.fnInitComplete,"user");bN(b3,"aoPreDrawCallback",cb.fnPreDrawCallback,"user");var b7=b3.oClasses;if(cb.bJQueryUI){bF.extend(b7,N.ext.oJUIClasses,cb.oClasses);if(cb.sDom===b9.sDom&&b9.sDom==="lfrtip"){b3.sDom='<"H"lfr>t<"F"ip>'}if(!b3.renderer){b3.renderer="jqueryui"}else{if(bF.isPlainObject(b3.renderer)&&!b3.renderer.header){b3.renderer.header="jqueryui"}}}else{bF.extend(b7,N.ext.classes,cb.oClasses)}bF(this).addClass(b7.sTable);if(b3.oScroll.sX!==""||b3.oScroll.sY!==""){b3.oScroll.iBarWidth=bb()}if(b3.oScroll.sX===true){b3.oScroll.sX="100%"}if(b3.iInitDisplayStart===c){b3.iInitDisplayStart=cb.iDisplayStart;b3._iDisplayStart=cb.iDisplayStart}if(cb.iDeferLoading!==null){b3.bDeferLoading=true;var co=bF.isArray(cb.iDeferLoading);b3._iRecordsDisplay=co?cb.iDeferLoading[0]:cb.iDeferLoading;b3._iRecordsTotal=co?cb.iDeferLoading[1]:cb.iDeferLoading}var cd=b3.oLanguage;bF.extend(true,cd,cb.oLanguage);if(cd.sUrl!==""){bF.ajax({dataType:"json",url:cd.sUrl,success:function(cq){aS(cq);aa(b9.oLanguage,cq);bF.extend(true,cd,cq);h(b3)},error:function(){h(b3)}});b5=true}if(cb.asStripeClasses===null){b3.asStripeClasses=[b7.sStripeOdd,b7.sStripeEven]}var cl=b3.asStripeClasses;var b1=bF("tbody tr:eq(0)",this);if(bF.inArray(true,bF.map(cl,function(cr,cq){return b1.hasClass(cr)}))!==-1){bF("tbody tr",this).removeClass(cl.join(" "));b3.asDestroyStripes=cl.slice()}var cf=[];var b0;var cc=this.getElementsByTagName("thead");if(cc.length!==0){aw(b3.aoHeader,cc[0]);cf=bh(b3)}if(cb.aoColumns===null){b0=[];for(ck=0,ci=cf.length;ck<ci;ck++){b0.push(null)}}else{b0=cb.aoColumns}for(ck=0,ci=b0.length;ck<ci;ck++){O(b3,cf?cf[ck]:null)}k(b3,cb.aoColumnDefs,b0,function(cr,cq){a2(b3,cr,cq)});if(b1.length){var cp=function(cq,cr){return cq.getAttribute("data-"+cr)?cr:null};bF.each(bf(b3,b1[0]).cells,function(ct,cq){var cr=b3.aoColumns[ct];if(cr.mData===ct){var cs=cp(cq,"sort")||cp(cq,"order");var cu=cp(cq,"filter")||cp(cq,"search");if(cs!==null||cu!==null){cr.mData={_:ct+".display",sort:cs!==null?ct+".@data-"+cs:c,type:cs!==null?ct+".@data-"+cs:c,filter:cu!==null?ct+".@data-"+cu:c};a2(b3,ct)}}})}var b4=b3.oFeatures;if(cb.bStateSave){b4.bStateSave=true;bO(b3,cb);bN(b3,"aoDrawCallback",bo,"state_save")}if(cb.aaSorting===c){var bZ=b3.aaSorting;for(ck=0,ci=bZ.length;ck<ci;ck++){bZ[ck][1]=b3.aoColumns[ck].asSorting[0]}}ae(b3);if(b4.bSort){bN(b3,"aoDrawCallback",function(){if(b3.bSorted){var cq=aI(b3);var cr={};bF.each(cq,function(cs,ct){cr[ct.src]=ct.dir});L(b3,null,"order",[b3,cq,cr]);bd(b3)}})}bN(b3,"aoDrawCallback",function(){if(b3.bSorted||y(b3)==="ssp"||b4.bDeferRender){ae(b3)}},"sc");be(b3);var bY=bF(this).children("caption").each(function(){this._captionSide=bF(this).css("caption-side")});var cm=bF(this).children("thead");if(cm.length===0){cm=bF("<thead/>").appendTo(this)}b3.nTHead=cm[0];var bX=bF(this).children("tbody");if(bX.length===0){bX=bF("<tbody/>").appendTo(this)}b3.nTBody=bX[0];var ca=bF(this).children("tfoot");if(ca.length===0&&bY.length>0&&(b3.oScroll.sX!==""||b3.oScroll.sY!=="")){ca=bF("<tfoot/>").appendTo(this)}if(ca.length===0||ca.children().length===0){bF(this).addClass(b7.sNoFooter)}else{if(ca.length>0){b3.nTFoot=ca[0];aw(b3.aoFooter,b3.nTFoot)}}if(cb.aaData){for(ck=0;ck<cb.aaData.length;ck++){aO(b3,cb.aaData[ck])}}else{if(b3.bDeferLoading||y(b3)=="dom"){bQ(b3,bF(b3.nTBody).children("tr"))}}b3.aiDisplay=b3.aiDisplayMaster.slice();b3.bInitialised=true;if(b5===false){h(b3)}});bU=null;return this};var U=[];var o=Array.prototype;var bP=function(bT){var bR,bV;var bU=N.settings;var bS=bF.map(bU,function(bX,bW){return bX.nTable});if(!bT){return[]}else{if(bT.nTable&&bT.oApi){return[bT]}else{if(bT.nodeName&&bT.nodeName.toLowerCase()==="table"){bR=bF.inArray(bT,bS);return bR!==-1?[bU[bR]]:null}else{if(bT&&typeof bT.settings==="function"){return bT.settings().toArray()}else{if(typeof bT==="string"){bV=bF(bT)}else{if(bT instanceof bF){bV=bT}}}}}}if(bV){return bV.map(function(bW){bR=bF.inArray(this,bS);return bR!==-1?bU[bR]:null}).toArray()}};J=function(bT,bV){if(!this instanceof J){throw"DT API must be constructed as a new object"}var bU=[];var bW=function(bY){var bX=bP(bY);if(bX){bU.push.apply(bU,bX)}};if(bF.isArray(bT)){for(var bS=0,bR=bT.length;bS<bR;bS++){bW(bT[bS])}}else{bW(bT)}this.context=aH(bU);if(bV){this.push.apply(this,bV.toArray?bV.toArray():bV)}this.selector={rows:null,cols:null,opts:null};J.extend(this,this,U)};N.Api=J;J.prototype={concat:o.concat,context:[],each:function(bT){for(var bS=0,bR=this.length;bS<bR;bS++){bT.call(this,this[bS],bS,this)}return this},eq:function(bR){var bS=this.context;return bS.length>bR?new J(bS[bR],this[bR]):null},filter:function(bU){var bS=[];if(o.filter){bS=o.filter.call(this,bU,this)}else{for(var bT=0,bR=this.length;bT<bR;bT++){if(bU.call(this,this[bT],bT,this)){bS.push(this[bT])}}}return new J(this.context,bS)},flatten:function(){var bR=[];return new J(this.context,bR.concat.apply(bR,this.toArray()))},join:o.join,indexOf:o.indexOf||function(bT,bU){for(var bS=(bU||0),bR=this.length;bS<bR;bS++){if(this[bS]===bT){return bS}}return -1},iterator:function(b8,bT,bU,bW){var b6=[],b7,b3,bR,b1,b0,bS=this.context,bV,bY,b5,b2=this.selector;if(typeof b8==="string"){bW=bU;bU=bT;bT=b8;b8=false}for(b3=0,bR=bS.length;b3<bR;b3++){var bZ=new J(bS[b3]);if(bT==="table"){b7=bU.call(bZ,bS[b3],b3);if(b7!==c){b6.push(b7)}}else{if(bT==="columns"||bT==="rows"){b7=bU.call(bZ,bS[b3],this[b3],b3);if(b7!==c){b6.push(b7)}}else{if(bT==="column"||bT==="column-rows"||bT==="row"||bT==="cell"){bY=this[b3];if(bT==="column-rows"){bV=aP(bS[b3],b2.opts)}for(b1=0,b0=bY.length;b1<b0;b1++){b5=bY[b1];if(bT==="cell"){b7=bU.call(bZ,bS[b3],b5.row,b5.column,b3,b1)}else{b7=bU.call(bZ,bS[b3],b5,b3,b1,bV)}if(b7!==c){b6.push(b7)}}}}}}if(b6.length||bW){var bX=new J(bS,b8?b6.concat.apply([],b6):b6);var b4=bX.selector;b4.rows=b2.rows;b4.cols=b2.cols;b4.opts=b2.opts;return bX}return this},lastIndexOf:o.lastIndexOf||function(bR,bS){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(bU){var bS=[];if(o.map){bS=o.map.call(this,bU,this)}else{for(var bT=0,bR=this.length;bT<bR;bT++){bS.push(bU.call(this,this[bT],bT))}}return new J(this.context,bS)},pluck:function(bR){return this.map(function(bS){return bS[bR]})},pop:o.pop,push:o.push,reduce:o.reduce||function(bR,bS){return aV(this,bR,bS,0,this.length,1)},reduceRight:o.reduceRight||function(bR,bS){return aV(this,bR,bS,this.length-1,-1,-1)},reverse:o.reverse,selector:null,shift:o.shift,sort:o.sort,splice:o.splice,toArray:function(){return o.slice.call(this)},to$:function(){return bF(this)},toJQuery:function(){return bF(this)},unique:function(){return new J(this.context,aH(this))},unshift:o.unshift};J.extend=function(bZ,bV,bS){if(!bV||(!(bV instanceof J)&&!bV.__dt_wrapper)){return}var bW,bY,bU,bR,bT,b0,bX=function(b2,b1,b3){return function(){var b4=b1.apply(b2,arguments);J.extend(b4,b4,b3.methodExt);return b4}};for(bW=0,bY=bS.length;bW<bY;bW++){bT=bS[bW];bV[bT.name]=typeof bT.val==="function"?bX(bZ,bT.val,bT):bF.isPlainObject(bT.val)?{}:bT.val;bV[bT.name].__dt_wrapper=true;J.extend(bZ,bV[bT.name],bT.propExt)}};J.register=bk=function(bT,bV){if(bF.isArray(bT)){for(var bY=0,bU=bT.length;bY<bU;bY++){J.register(bT[bY],bV)}return}var bZ,b2,bW=bT.split("."),bX=U,b1,bS;var b0=function(b6,b4){for(var b5=0,b3=b6.length;b5<b3;b5++){if(b6[b5].name===b4){return b6[b5]}}return null};for(bZ=0,b2=bW.length;bZ<b2;bZ++){bS=bW[bZ].indexOf("()")!==-1;b1=bS?bW[bZ].replace("()",""):bW[bZ];var bR=b0(bX,b1);if(!bR){bR={name:b1,val:{},methodExt:[],propExt:[]};bX.push(bR)}if(bZ===b2-1){bR.val=bV}else{bX=bS?bR.methodExt:bR.propExt}}};J.registerPlural=aB=function(bR,bT,bS){J.register(bR,bS);J.register(bT,function(){var bU=bS.apply(this,arguments);if(bU===this){return this}else{if(bU instanceof J){return bU.length?bF.isArray(bU[0])?new J(bU.context,bU[0]):bU[0]:c}}return bU})};var d=function(bR,bS){if(typeof bR==="number"){return[bS[bR]]}var bT=bF.map(bS,function(bV,bU){return bV.nTable});return bF(bT).filter(bR).map(function(bV){var bU=bF.inArray(this,bT);return bS[bU]}).toArray()};bk("tables()",function(bR){return bR?new J(d(bR,this.context)):this});bk("table()",function(bR){var bT=this.tables(bR);var bS=bT.context;return bS.length?new J(bS[0]):bT});aB("tables().nodes()","table().node()",function(){return this.iterator("table",function(bR){return bR.nTable},1)});aB("tables().body()","table().body()",function(){return this.iterator("table",function(bR){return bR.nTBody},1)});aB("tables().header()","table().header()",function(){return this.iterator("table",function(bR){return bR.nTHead},1)});aB("tables().footer()","table().footer()",function(){return this.iterator("table",function(bR){return bR.nTFoot},1)});aB("tables().containers()","table().container()",function(){return this.iterator("table",function(bR){return bR.nTableWrapper},1)});bk("draw()",function(bR){return this.iterator("table",function(bS){ai(bS,bR===false)})});bk("page()",function(bR){if(bR===c){return this.page.info().page}return this.iterator("table",function(bS){aG(bS,bR)})});bk("page.info()",function(bV){if(this.context.length===0){return c}var bU=this.context[0],bW=bU._iDisplayStart,bR=bU._iDisplayLength,bS=bU.fnRecordsDisplay(),bT=bR===-1;return{page:bT?0:Math.floor(bW/bR),pages:bT?1:Math.ceil(bS/bR),start:bW,end:bU.fnDisplayEnd(),length:bR,recordsTotal:bU.fnRecordsTotal(),recordsDisplay:bS}});bk("page.len()",function(bR){if(bR===c){return this.context.length!==0?this.context[0]._iDisplayLength:c}return this.iterator("table",function(bS){aT(bS,bR)})});var H=function(bT,bR,bU){if(y(bT)=="ssp"){ai(bT,bR)}else{w(bT,true);av(bT,[],function(bX){bi(bT);var bY=bt(bT,bX);for(var bW=0,bV=bY.length;bW<bV;bW++){aO(bT,bY[bW])}ai(bT,bR);w(bT,false)})}if(bU){var bS=new J(bT);bS.one("draw",function(){bU(bS.ajax.json())})}};bk("ajax.json()",function(){var bR=this.context;if(bR.length>0){return bR[0].json}});bk("ajax.params()",function(){var bR=this.context;if(bR.length>0){return bR[0].oAjaxData}});bk("ajax.reload()",function(bS,bR){return this.iterator("table",function(bT){H(bT,bR===false,bS)})});bk("ajax.url()",function(bS){var bR=this.context;if(bS===c){if(bR.length===0){return c}bR=bR[0];return bR.ajax?bF.isPlainObject(bR.ajax)?bR.ajax.url:bR.ajax:bR.sAjaxSource}return this.iterator("table",function(bT){if(bF.isPlainObject(bT.ajax)){bT.ajax.url=bS}else{bT.ajax=bS}})});bk("ajax.url().load()",function(bS,bR){return this.iterator("table",function(bT){H(bT,bR===false,bS)})});var ap=function(bS,bY){var bT=[],bW,bX,bV,b0,bU,bR,bZ=typeof bS;if(!bS||bZ==="string"||bZ==="function"||bS.length===c){bS=[bS]}for(bV=0,b0=bS.length;bV<b0;bV++){bX=bS[bV]&&bS[bV].split?bS[bV].split(","):[bS[bV]];for(bU=0,bR=bX.length;bU<bR;bU++){bW=bY(typeof bX[bU]==="string"?bF.trim(bX[bU]):bX[bU]);if(bW&&bW.length){bT.push.apply(bT,bW)}}}return bT};var bE=function(bR){if(!bR){bR={}}if(bR.filter&&!bR.search){bR.search=bR.filter}return{search:bR.search||"none",order:bR.order||"current",page:bR.page||"all"}};var z=function(bT){for(var bS=0,bR=bT.length;bS<bR;bS++){if(bT[bS].length>0){bT[0]=bT[bS];bT.length=1;bT.context=[bT.context[bS]];return bT}}bT.length=0;return bT};var aP=function(bT,bR){var bU,b0,bV,bY=[],bZ=bT.aiDisplay,bW=bT.aiDisplayMaster;var b1=bR.search,bS=bR.order,bX=bR.page;if(y(bT)=="ssp"){return b1==="removed"?[]:bg(0,bW.length)}else{if(bX=="current"){for(bU=bT._iDisplayStart,b0=bT.fnDisplayEnd();bU<b0;bU++){bY.push(bZ[bU])}}else{if(bS=="current"||bS=="applied"){bY=b1=="none"?bW.slice():b1=="applied"?bZ.slice():bF.map(bW,function(b3,b2){return bF.inArray(b3,bZ)===-1?b3:null})}else{if(bS=="index"||bS=="original"){for(bU=0,b0=bT.aoData.length;bU<b0;bU++){if(b1=="none"){bY.push(bU)}else{bV=bF.inArray(bU,bZ);if((bV===-1&&b1=="removed")||(bV>=0&&b1=="applied")){bY.push(bU)}}}}}}}return bY};var E=function(bS,bR,bT){return ap(bR,function(bZ){var bW=F(bZ);var bX,bU;if(bW!==null&&!bT){return[bW]}var bY=aP(bS,bT);if(bW!==null&&bF.inArray(bW,bY)!==-1){return[bW]}else{if(!bZ){return bY}}if(typeof bZ==="function"){return bF.map(bY,function(b0){var b1=bS.aoData[b0];return bZ(b0,b1._aData,b1.nTr)?b0:null})}var bV=ad(t(bS.aoData,bY,"nTr"));if(bZ.nodeName){if(bF.inArray(bZ,bV)!==-1){return[bZ._DT_RowIndex]}}return bF(bV).filter(bZ).map(function(){return this._DT_RowIndex}).toArray()})};bk("rows()",function(bR,bS){if(bR===c){bR=""}else{if(bF.isPlainObject(bR)){bS=bR;bR=""}}bS=bE(bS);var bT=this.iterator("table",function(bU){return E(bU,bR,bS)},1);bT.selector.rows=bR;bT.selector.opts=bS;return bT});bk("rows().nodes()",function(){return this.iterator("row",function(bR,bS){return bR.aoData[bS].nTr||c},1)});bk("rows().data()",function(){return this.iterator(true,"rows",function(bR,bS){return t(bR.aoData,bS,"_aData")},1)});aB("rows().cache()","row().cache()",function(bR){return this.iterator("row",function(bS,bU){var bT=bS.aoData[bU];return bR==="search"?bT._aFilterData:bT._aSortData},1)});aB("rows().invalidate()","row().invalidate()",function(bR){return this.iterator("row",function(bS,bT){B(bS,bT,bR)})});aB("rows().indexes()","row().index()",function(){return this.iterator("row",function(bR,bS){return bS},1)});aB("rows().remove()","row().remove()",function(){var bR=this;return this.iterator("row",function(bW,bY,bV){var bX=bW.aoData;bX.splice(bY,1);for(var bU=0,bT=bX.length;bU<bT;bU++){if(bX[bU].nTr!==null){bX[bU].nTr._DT_RowIndex=bU}}var bS=bF.inArray(bY,bW.aiDisplay);a5(bW.aiDisplayMaster,bY);a5(bW.aiDisplay,bY);a5(bR[bV],bY,false);bl(bW)})});bk("rows.add()",function(bT){var bS=this.iterator("table",function(bX){var bY,bW,bU;var bV=[];for(bW=0,bU=bT.length;bW<bU;bW++){bY=bT[bW];if(bY.nodeName&&bY.nodeName.toUpperCase()==="TR"){bV.push(bQ(bX,bY)[0])}else{bV.push(aO(bX,bY))}}return bV},1);var bR=this.rows(-1);bR.pop();bR.push.apply(bR,bS.toArray());return bR});bk("row()",function(bR,bS){return z(this.rows(bR,bS))});bk("row().data()",function(bS){var bR=this.context;if(bS===c){return bR.length&&this.length?bR[0].aoData[this[0]]._aData:c}bR[0].aoData[this[0]]._aData=bS;B(bR[0],this[0],"data");return this});bk("row().node()",function(){var bR=this.context;return bR.length&&this.length?bR[0].aoData[this[0]].nTr||null:null});bk("row.add()",function(bS){if(bS instanceof bF&&bS.length){bS=bS[0]}var bR=this.iterator("table",function(bT){if(bS.nodeName&&bS.nodeName.toUpperCase()==="TR"){return bQ(bT,bS)[0]}return aO(bT,bS)});return this.row(bR[0])});var Z=function(bU,bY,bX,bR){var bW=[];var bT=function(b0,bZ){if(b0.nodeName&&b0.nodeName.toLowerCase()==="tr"){bW.push(b0)}else{var b1=bF("<tr><td/></tr>").addClass(bZ);bF("td",b1).addClass(bZ).html(b0)[0].colSpan=aQ(bU);bW.push(b1[0])}};if(bF.isArray(bX)||bX instanceof bF){for(var bV=0,bS=bX.length;bV<bS;bV++){bT(bX[bV],bR)}}else{bT(bX,bR)}if(bY._details){bY._details.remove()}bY._details=bF(bW);if(bY._detailsShow){bY._details.insertAfter(bY.nTr)}};var A=function(bT,bR){var bS=bT.context;if(bS.length){var bU=bS[0].aoData[bR!==c?bR:bT[0]];if(bU._details){bU._details.remove();bU._detailsShow=c;bU._details=c}}};var ba=function(bT,bS){var bR=bT.context;if(bR.length&&bT.length){var bU=bR[0].aoData[bT[0]];if(bU._details){bU._detailsShow=bS;if(bS){bU._details.insertAfter(bU.nTr)}else{bU._details.detach()}bx(bR[0])}}};var bx=function(bW){var bV=new J(bW);var bU=".dt.DT_details";var bT="draw"+bU;var bR="column-visibility"+bU;var bS="destroy"+bU;var bX=bW.aoData;bV.off(bT+" "+bR+" "+bS);if(au(bX,"_details").length>0){bV.on(bT,function(bZ,bY){if(bW!==bY){return}bV.rows({page:"current"}).eq(0).each(function(b0){var b1=bX[b0];if(b1._detailsShow){b1._details.insertAfter(b1.nTr)}})});bV.on(bR,function(b3,b0,bY,b2){if(bW!==b0){return}var b5,b4=aQ(b0);for(var b1=0,bZ=bX.length;b1<bZ;b1++){b5=bX[b1];if(b5._details){b5._details.children("td[colspan]").attr("colspan",b4)}}});bV.on(bS,function(b1,bZ){if(bW!==bZ){return}for(var b0=0,bY=bX.length;b0<bY;b0++){if(bX[b0]._details){A(bV,b0)}}})}};var n="";var s=n+"row().child";var aY=s+"()";bk(aY,function(bT,bR){var bS=this.context;if(bT===c){return bS.length&&this.length?bS[0].aoData[this[0]]._details:c}else{if(bT===true){this.child.show()}else{if(bT===false){A(this)}else{if(bS.length&&this.length){Z(bS[0],bS[0].aoData[this[0]],bT,bR)}}}}return this});bk([s+".show()",aY+".show()"],function(bR){ba(this,true);return this});bk([s+".hide()",aY+".hide()"],function(){ba(this,false);return this});bk([s+".remove()",aY+".remove()"],function(){A(this);return this});bk(s+".isShown()",function(){var bR=this.context;if(bR.length&&this.length){return bR[0].aoData[this[0]]._detailsShow||false}return false});var a9=/^(.+):(name|visIdx|visible)$/;var aZ=function(bW,bV,bU,bT,bX){var bS=[];for(var bY=0,bR=bX.length;bY<bR;bY++){bS.push(bu(bW,bX[bY],bV))}return bS};var bC=function(bU,bR,bV){var bT=bU.aoColumns,bW=au(bT,"sName"),bS=au(bT,"nTh");return ap(bR,function(b1){var bY=F(b1);if(b1===""){return bg(bT.length)}if(bY!==null){return[bY>=0?bY:bT.length+bY]}if(typeof b1==="function"){var b2=aP(bU,bV);return bF.map(bT,function(b4,b3){return b1(b3,aZ(bU,b3,0,0,b2),bS[b3])?b3:null})}var bZ=typeof b1==="string"?b1.match(a9):"";if(bZ){switch(bZ[2]){case"visIdx":case"visible":var bX=parseInt(bZ[1],10);if(bX<0){var b0=bF.map(bT,function(b3,b4){return b3.bVisible?b4:null});return[b0[b0.length+bX]]}return[r(bU,bX)];case"name":return bF.map(bW,function(b3,b4){return b3===bZ[1]?b4:null})}}else{return bF(bS).filter(b1).map(function(){return bF.inArray(this,bS)}).toArray()}})};var M=function(bT,bU,bR,bY){var b0=bT.aoColumns,bS=b0[bU],bW=bT.aoData,b3,b2,bV,b1,bZ;if(bR===c){return bS.bVisible}if(bS.bVisible===bR){return}if(bR){var bX=bF.inArray(true,au(b0,"bVisible"),bU+1);for(bV=0,b1=bW.length;bV<b1;bV++){bZ=bW[bV].nTr;b2=bW[bV].anCells;if(bZ){bZ.insertBefore(b2[bU],b2[bX]||null)}}}else{bF(au(bT.aoData,"anCells",bU)).detach()}bS.bVisible=bR;a6(bT,bT.aoHeader);a6(bT,bT.aoFooter);if(bY===c||bY){aJ(bT);if(bT.oScroll.sX||bT.oScroll.sY){l(bT)}}L(bT,null,"column-visibility",[bT,bU,bR]);bo(bT)};bk("columns()",function(bR,bS){if(bR===c){bR=""}else{if(bF.isPlainObject(bR)){bS=bR;bR=""}}bS=bE(bS);var bT=this.iterator("table",function(bU){return bC(bU,bR,bS)},1);bT.selector.cols=bR;bT.selector.opts=bS;return bT});aB("columns().header()","column().header()",function(bR,bS){return this.iterator("column",function(bU,bT){return bU.aoColumns[bT].nTh},1)});aB("columns().footer()","column().footer()",function(bR,bS){return this.iterator("column",function(bU,bT){return bU.aoColumns[bT].nTf},1)});aB("columns().data()","column().data()",function(){return this.iterator("column-rows",aZ,1)});aB("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(bS,bR){return bS.aoColumns[bR].mData},1)});aB("columns().cache()","column().cache()",function(bR){return this.iterator("column-rows",function(bV,bU,bT,bS,bW){return t(bV.aoData,bW,bR==="search"?"_aFilterData":"_aSortData",bU)},1)});aB("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(bU,bT,bS,bR,bV){return t(bU.aoData,bV,"anCells",bT)},1)});aB("columns().visible()","column().visible()",function(bS,bR){return this.iterator("column",function(bU,bT){if(bS===c){return bU.aoColumns[bT].bVisible}M(bU,bT,bS,bR)})});aB("columns().indexes()","column().index()",function(bR){return this.iterator("column",function(bT,bS){return bR==="visible"?bJ(bT,bS):bS},1)});bk("columns.adjust()",function(){return this.iterator("table",function(bR){aJ(bR)},1)});bk("column.index()",function(bT,bR){if(this.context.length!==0){var bS=this.context[0];if(bT==="fromVisible"||bT==="toData"){return r(bS,bR)}else{if(bT==="fromData"||bT==="toVisible"){return bJ(bS,bR)}}}});bk("column()",function(bR,bS){return z(this.columns(bR,bS))});var bq=function(bU,bV,bR){var bY=bU.aoData;var b5=aP(bU,bR);var b3=ad(t(bY,b5,"anCells"));var b2=bF([].concat.apply([],b3));var b4;var bT=bU.aoColumns.length;var bZ,bX,b0,bW,bS,b1;return ap(bV,function(b6){var b7=typeof b6==="function";if(b6===null||b6===c||b7){bZ=[];for(bX=0,b0=b5.length;bX<b0;bX++){b4=b5[bX];for(bW=0;bW<bT;bW++){bS={row:b4,column:bW};if(b7){b1=bU.aoData[b4];if(b6(bS,bu(bU,b4,bW),b1.anCells[bW])){bZ.push(bS)}}else{bZ.push(bS)}}}return bZ}if(bF.isPlainObject(b6)){return[b6]}return b2.filter(b6).map(function(b8,b9){b4=b9.parentNode._DT_RowIndex;return{row:b4,column:bF.inArray(b9,bY[b4].anCells)}}).toArray()})};bk("cells()",function(bU,bR,bS){if(bF.isPlainObject(bU)){if(typeof bU.row!==c){bS=bR;bR=null}else{bS=bU;bU=null}}if(bF.isPlainObject(bR)){bS=bR;bR=null}if(bR===null||bR===c){return this.iterator("table",function(b2){return bq(b2,bU,bE(bS))})}var bV=this.columns(bR,bS);var b1=this.rows(bU,bS);var bY,bX,bZ,bW,bT;var b0=this.iterator("table",function(b3,b2){bY=[];for(bX=0,bZ=b1[b2].length;bX<bZ;bX++){for(bW=0,bT=bV[b2].length;bW<bT;bW++){bY.push({row:b1[b2][bX],column:bV[b2][bW]})}}return bY},1);bF.extend(b0.selector,{cols:bR,rows:bU,opts:bS});return b0});aB("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(bT,bU,bS){var bR=bT.aoData[bU].anCells;return bR?bR[bS]:c},1)});bk("cells().data()",function(){return this.iterator("cell",function(bS,bT,bR){return bu(bS,bT,bR)},1)});aB("cells().cache()","cell().cache()",function(bR){bR=bR==="search"?"_aFilterData":"_aSortData";return this.iterator("cell",function(bT,bU,bS){return bT.aoData[bU][bR][bS]},1)});aB("cells().render()","cell().render()",function(bR){return this.iterator("cell",function(bT,bU,bS){return bu(bT,bU,bS,bR)},1)});aB("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(bS,bT,bR){return{row:bT,column:bR,columnVisible:bJ(bS,bR)}},1)});aB("cells().invalidate()","cell().invalidate()",function(bR){return this.iterator("cell",function(bT,bU,bS){B(bT,bU,bR,bS)})});bk("cell()",function(bR,bT,bS){return z(this.cells(bR,bT,bS))});bk("cell().data()",function(bT){var bS=this.context;var bR=this[0];if(bT===c){return bS.length&&bR.length?bu(bS[0],bR[0].row,bR[0].column):c}bm(bS[0],bR[0].row,bR[0].column,bT);B(bS[0],bR[0].row,"data",bR[0].column);return this});bk("order()",function(bR,bT){var bS=this.context;if(bR===c){return bS.length!==0?bS[0].aaSorting:c}if(typeof bR==="number"){bR=[[bR,bT]]}else{if(!bF.isArray(bR[0])){bR=Array.prototype.slice.call(arguments)}}return this.iterator("table",function(bU){bU.aaSorting=bR.slice()})});bk("order.listener()",function(bS,bR,bT){return this.iterator("table",function(bU){C(bU,bS,bR,bT)})});bk(["columns().order()","column().order()"],function(bR){var bS=this;return this.iterator("table",function(bV,bU){var bT=[];bF.each(bS[bU],function(bX,bW){bT.push([bW,bR])});bV.aaSorting=bT})});bk("search()",function(bS,bU,bV,bT){var bR=this.context;if(bS===c){return bR.length!==0?bR[0].oPreviousSearch.sSearch:c}return this.iterator("table",function(bW){if(!bW.oFeatures.bFilter){return}u(bW,bF.extend({},bW.oPreviousSearch,{sSearch:bS+"",bRegex:bU===null?false:bU,bSmart:bV===null?true:bV,bCaseInsensitive:bT===null?true:bT}),1)})});aB("columns().search()","column().search()",function(bR,bT,bU,bS){return this.iterator("column",function(bX,bW){var bV=bX.aoPreSearchCols;if(bR===c){return bV[bW].sSearch}if(!bX.oFeatures.bFilter){return}bF.extend(bV[bW],{sSearch:bR+"",bRegex:bT===null?false:bT,bSmart:bU===null?true:bU,bCaseInsensitive:bS===null?true:bS});u(bX,bX.oPreviousSearch,1)})});bk("state()",function(){return this.context.length?this.context[0].oSavedState:null});bk("state.clear()",function(){return this.iterator("table",function(bR){bR.fnStateSaveCallback.call(bR.oInstance,bR,{})})});bk("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null});bk("state.save()",function(){return this.iterator("table",function(bR){bo(bR)})});N.versionCheck=N.fnVersionCheck=function(bT){var bX=N.version.split(".");var bU=bT.split(".");var bS,bW;for(var bV=0,bR=bU.length;bV<bR;bV++){bS=parseInt(bX[bV],10)||0;bW=parseInt(bU[bV],10)||0;if(bS===bW){continue}return bS>bW}return true};N.isDataTable=N.fnIsDataTable=function(bT){var bR=bF(bT).get(0);var bS=false;bF.each(N.settings,function(bU,bV){if(bV.nTable===bR||bV.nScrollHead===bR||bV.nScrollFoot===bR){bS=true}});return bS};N.tables=N.fnTables=function(bR){return bF.map(N.settings,function(bS){if(!bR||(bR&&bF(bS.nTable).is(":visible"))){return bS.nTable}})};N.util={throttle:al,escapeRegex:m};N.camelToHungarian=aa;bk("$()",function(bR,bT){var bU=this.rows(bT).nodes(),bS=bF(bU);return bF([].concat(bS.filter(bR).toArray(),bS.find(bR).toArray()))});bF.each(["on","one","off"],function(bS,bR){bk(bR+"()",function(){var bT=Array.prototype.slice.call(arguments);if(!bT[0].match(/\.dt\b/)){bT[0]+=".dt"}var bU=bF(this.tables().nodes());bU[bR].apply(bU,bT);return this})});bk("clear()",function(){return this.iterator("table",function(bR){bi(bR)})});bk("settings()",function(){return new J(this.context,this.context)});bk("data()",function(){return this.iterator("table",function(bR){return au(bR.aoData,"_aData")}).flatten()});bk("destroy()",function(bR){bR=bR||false;return this.iterator("table",function(bS){var b1=bS.nTableWrapper.parentNode;var bT=bS.oClasses;var b3=bS.nTable;var bW=bS.nTBody;var bY=bS.nTHead;var bZ=bS.nTFoot;var b4=bF(b3);var bV=bF(bW);var bX=bF(bS.nTableWrapper);var b5=bF.map(bS.aoData,function(b6){return b6.nTr});var bU,b2;bS.bDestroying=true;L(bS,"aoDestroyCallback","destroy",[bS]);if(!bR){new J(bS).columns().visible(true)}bX.unbind(".DT").find(":not(tbody *)").unbind(".DT");bF(b).unbind(".DT-"+bS.sInstance);if(b3!=bY.parentNode){b4.children("thead").detach();b4.append(bY)}if(bZ&&b3!=bZ.parentNode){b4.children("tfoot").detach();b4.append(bZ)}b4.detach();bX.detach();bS.aaSorting=[];bS.aaSortingFixed=[];ae(bS);bF(b5).removeClass(bS.asStripeClasses.join(" "));bF("th, td",bY).removeClass(bT.sSortable+" "+bT.sSortableAsc+" "+bT.sSortableDesc+" "+bT.sSortableNone);if(bS.bJUI){bF("th span."+bT.sSortIcon+", td span."+bT.sSortIcon,bY).detach();bF("th, td",bY).each(function(){var b6=bF("div."+bT.sSortJUIWrapper,this);bF(this).append(b6.contents());b6.detach()})}if(!bR&&b1){b1.insertBefore(b3,bS.nTableReinsertBefore)}bV.children().detach();bV.append(b5);b4.css("width",bS.sDestroyWidth).removeClass(bT.sTable);b2=bS.asDestroyStripes.length;if(b2){bV.children().each(function(b6){bF(this).addClass(bS.asDestroyStripes[b6%b2])})}var b0=bF.inArray(bS,N.settings);if(b0!==-1){N.settings.splice(b0,1)}})});N.version="1.10.4";N.settings=[];N.models={};N.models.oSearch={bCaseInsensitive:true,sSearch:"",bRegex:false,bSmart:true};N.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null};N.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:false,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};N.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:true,bDeferRender:false,bDestroy:false,bFilter:true,bInfo:true,bJQueryUI:false,bLengthChange:true,bPaginate:true,bProcessing:false,bRetrieve:false,bScrollCollapse:false,bServerSide:false,bSort:true,bSortMulti:true,bSortCellsTop:false,bSortClasses:true,bStateSave:false,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(bR){return bR.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(bR){try{return JSON.parse((bR.iStateDuration===-1?sessionStorage:localStorage).getItem("DataTables_"+bR.sInstance+"_"+location.pathname))}catch(bS){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(bR,bS){try{(bR.iStateDuration===-1?sessionStorage:localStorage).setItem("DataTables_"+bR.sInstance+"_"+location.pathname,JSON.stringify(bS))}catch(bT){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:bF.extend({},N.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null};T(N.defaults);N.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:true,bSortable:true,bVisible:true,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};T(N.defaults.column);N.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:false,bScrollbarLeft:false},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:false,bInitialised:false,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:true,jqXHR:null,json:c,oAjaxData:c,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:false,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:false,bSorted:false,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return y(this)=="ssp"?this._iRecordsTotal*1:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return y(this)=="ssp"?this._iRecordsDisplay*1:this.aiDisplay.length},fnDisplayEnd:function(){var bR=this._iDisplayLength,bW=this._iDisplayStart,bT=bW+bR,bS=this.aiDisplay.length,bU=this.oFeatures,bV=bU.bPaginate;if(bU.bServerSide){return bV===false||bR===-1?bW+bS:Math.min(bW+bR,this._iRecordsDisplay)}else{return !bV||bT>bS||bR===-1?bS:bT}},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{}};N.ext=I={classes:{},errMode:"alert",feature:[],search:[],internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:N.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:N.version};bF.extend(I,{afnFiltering:I.search,aTypes:I.type.detect,ofnSearch:I.type.search,oSort:I.type.order,afnSortData:I.order,aoFeatures:I.feature,oApi:I.internal,oStdClasses:I.classes,oPagination:I.pager});bF.extend(N.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});(function(){var bS="";bS="";var bT=bS+"ui-state-default";var bU=bS+"css_right ui-icon ui-icon-";var bR=bS+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";bF.extend(N.ext.oJUIClasses,N.ext.classes,{sPageButton:"fg-button ui-button "+bT,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:bT+" sorting_asc",sSortDesc:bT+" sorting_desc",sSortable:bT+" sorting",sSortableAsc:bT+" sorting_asc_disabled",sSortableDesc:bT+" sorting_desc_disabled",sSortableNone:bT+" sorting_disabled",sSortJUIAsc:bU+"triangle-1-n",sSortJUIDesc:bU+"triangle-1-s",sSortJUI:bU+"carat-2-n-s",sSortJUIAscAllowed:bU+"carat-1-n",sSortJUIDescAllowed:bU+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+bT,sScrollFoot:"dataTables_scrollFoot "+bT,sHeaderTH:bT,sFooterTH:bT,sJUIHeader:bR+" ui-corner-tl ui-corner-tr",sJUIFooter:bR+" ui-corner-bl ui-corner-br"})}());var bI=N.ext.pager;function bn(bW,bR){var bS=[],bU=bI.numbers_length,bV=Math.floor(bU/2),bT=1;if(bR<=bU){bS=bg(0,bR)}else{if(bW<=bV){bS=bg(0,bU-2);bS.push("ellipsis");bS.push(bR-1)}else{if(bW>=bR-1-bV){bS=bg(bR-(bU-2),bR);bS.splice(0,0,"ellipsis");bS.splice(0,0,0)}else{bS=bg(bW-1,bW+2);bS.push("ellipsis");bS.push(bR-1);bS.splice(0,0,"ellipsis");bS.splice(0,0,0)}}}bS.DT_el="span";return bS}bF.extend(bI,{simple:function(bS,bR){return["previous","next"]},full:function(bS,bR){return["first","previous","next","last"]},simple_numbers:function(bS,bR){return["previous",bn(bS,bR),"next"]},full_numbers:function(bS,bR){return["first","previous",bn(bS,bR),"next","last"]},_numbers:bn,numbers_length:7});bF.extend(true,N.ext.renderer,{pageButton:{_:function(bX,b4,b3,b2,b1,bV){var bY=bX.oClasses;var bU=bX.oLanguage.oPaginate;var bT,bS,bR=0;var bZ=function(b6,cb){var b9,b5,ca,b8;var cc=function(cd){aG(bX,cd.data.action,true)};for(b9=0,b5=cb.length;b9<b5;b9++){b8=cb[b9];if(bF.isArray(b8)){var b7=bF("<"+(b8.DT_el||"div")+"/>").appendTo(b6);bZ(b7,b8)}else{bT="";bS="";switch(b8){case"ellipsis":b6.append("<span>&hellip;</span>");break;case"first":bT=bU.sFirst;bS=b8+(b1>0?"":" "+bY.sPageButtonDisabled);break;case"previous":bT=bU.sPrevious;bS=b8+(b1>0?"":" "+bY.sPageButtonDisabled);break;case"next":bT=bU.sNext;bS=b8+(b1<bV-1?"":" "+bY.sPageButtonDisabled);break;case"last":bT=bU.sLast;bS=b8+(b1<bV-1?"":" "+bY.sPageButtonDisabled);break;default:bT=b8+1;bS=b1===b8?bY.sPageButtonActive:"";break}if(bT){ca=bF("<a>",{"class":bY.sPageButton+" "+bS,"aria-controls":bX.sTableId,"data-dt-idx":bR,tabindex:bX.iTabIndex,id:b3===0&&typeof b8==="string"?bX.sTableId+"_"+b8:null}).html(bT).appendTo(b6);bc(ca,{action:b8},cc);bR++}}}};try{var bW=bF(a.activeElement).data("dt-idx");bZ(bF(b4).empty(),b2);if(bW!==null){bF(b4).find("[data-dt-idx="+bW+"]").focus()}}catch(b0){}}}});bF.extend(N.ext.type.detect,[function(bT,bS){var bR=bS.oLanguage.sDecimal;return aj(bT,bR)?"num"+bR:null},function(bT,bS){if(bT&&!(bT instanceof Date)&&(!am.test(bT)||!bv.test(bT))){return null}var bR=Date.parse(bT);return(bR!==null&&!isNaN(bR))||bB(bT)?"date":null},function(bT,bS){var bR=bS.oLanguage.sDecimal;return aj(bT,bR,true)?"num-fmt"+bR:null},function(bT,bS){var bR=bS.oLanguage.sDecimal;return j(bT,bR)?"html-num"+bR:null},function(bT,bS){var bR=bS.oLanguage.sDecimal;return j(bT,bR,true)?"html-num-fmt"+bR:null},function(bS,bR){return bB(bS)||(typeof bS==="string"&&bS.indexOf("<")!==-1)?"html":null}]);bF.extend(N.ext.type.search,{html:function(bR){return bB(bR)?bR:typeof bR==="string"?bR.replace(W," ").replace(aU,""):""},string:function(bR){return bB(bR)?bR:typeof bR==="string"?bR.replace(W," "):bR}});var Q=function(bU,bR,bT,bS){if(bU!==0&&(!bU||bU==="-")){return -Infinity}if(bR){bU=bD(bU,bR)}if(bU.replace){if(bT){bU=bU.replace(bT,"")}if(bS){bU=bU.replace(bS,"")}}return bU*1};function br(bR){bF.each({num:function(bS){return Q(bS,bR)},"num-fmt":function(bS){return Q(bS,bR,bG)},"html-num":function(bS){return Q(bS,bR,aU)},"html-num-fmt":function(bS){return Q(bS,bR,aU,bG)}},function(bS,bT){I.type.order[bS+bR+"-pre"]=bT;if(bS.match(/^html\-/)){I.type.search[bS+bR]=I.type.search.html}})}bF.extend(I.type.order,{"date-pre":function(bR){return Date.parse(bR)||0},"html-pre":function(bR){return bB(bR)?"":bR.replace?bR.replace(/<.*?>/g,"").toLowerCase():bR+""},"string-pre":function(bR){return bB(bR)?"":typeof bR==="string"?bR.toLowerCase():!bR.toString?"":bR.toString()},"string-asc":function(bR,bS){return((bR<bS)?-1:((bR>bS)?1:0))},"string-desc":function(bR,bS){return((bR<bS)?1:((bR>bS)?-1:0))}});br("");bF.extend(true,N.ext.renderer,{header:{_:function(bU,bR,bT,bS){bF(bU.nTable).on("order.dt.DT",function(bY,bV,bX,bW){if(bU!==bV){return}var bZ=bT.idx;bR.removeClass(bT.sSortingClass+" "+bS.sSortAsc+" "+bS.sSortDesc).addClass(bW[bZ]=="asc"?bS.sSortAsc:bW[bZ]=="desc"?bS.sSortDesc:bT.sSortingClass)})},jqueryui:function(bU,bR,bT,bS){bF("<div/>").addClass(bS.sSortJUIWrapper).append(bR.contents()).append(bF("<span/>").addClass(bS.sSortIcon+" "+bT.sSortingClassJUI)).appendTo(bR);bF(bU.nTable).on("order.dt.DT",function(bY,bV,bX,bW){if(bU!==bV){return}var bZ=bT.idx;bR.removeClass(bS.sSortAsc+" "+bS.sSortDesc).addClass(bW[bZ]=="asc"?bS.sSortAsc:bW[bZ]=="desc"?bS.sSortDesc:bT.sSortingClass);bR.find("span."+bS.sSortIcon).removeClass(bS.sSortJUIAsc+" "+bS.sSortJUIDesc+" "+bS.sSortJUI+" "+bS.sSortJUIAscAllowed+" "+bS.sSortJUIDescAllowed).addClass(bW[bZ]=="asc"?bS.sSortJUIAsc:bW[bZ]=="desc"?bS.sSortJUIDesc:bT.sSortingClassJUI)})}}});N.render={number:function(bT,bS,bR,bU){return{display:function(bY){var bW=bY<0?"-":"";bY=Math.abs(parseFloat(bY));var bX=parseInt(bY,10);var bV=bR?bS+(bY-bX).toFixed(bR).substring(2):"";return bW+(bU||"")+bX.toString().replace(/\B(?=(\d{3})+(?!\d))/g,bT)+bV}}}};function ah(bR){return function(){var bS=[an(this[N.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return N.ext.internal[bR].apply(this,bS)}}bF.extend(N.ext.internal,{_fnExternApiFunc:ah,_fnBuildAjax:av,_fnAjaxUpdate:af,_fnAjaxParameters:bL,_fnAjaxUpdateDraw:V,_fnAjaxDataSrc:bt,_fnAddColumn:O,_fnColumnOptions:a2,_fnAdjustColumnSizing:aJ,_fnVisibleToColumnIndex:r,_fnColumnIndexToVisible:bJ,_fnVisbleColumns:aQ,_fnGetColumns:p,_fnColumnTypes:v,_fnApplyColumnDefs:k,_fnHungarianMap:T,_fnCamelToHungarian:aa,_fnLanguageCompat:aS,_fnBrowserDetect:be,_fnAddData:aO,_fnAddTr:bQ,_fnNodeToDataIndex:bs,_fnNodeToColumnIndex:a0,_fnGetCellData:bu,_fnSetCellData:bm,_fnSplitObjNotation:ak,_fnGetObjectDataFn:ao,_fnSetObjectDataFn:ax,_fnGetDataMaster:bH,_fnClearTable:bi,_fnDeleteIndex:a5,_fnInvalidate:B,_fnGetRowElements:bf,_fnCreateTr:P,_fnBuildHead:aL,_fnDrawHead:a6,_fnDraw:a3,_fnReDraw:ai,_fnAddOptionsHtml:i,_fnDetectHeader:aw,_fnGetUniqueThs:bh,_fnFeatureHtmlFilter:q,_fnFilterComplete:u,_fnFilterCustom:ar,_fnFilterColumn:Y,_fnFilter:ay,_fnFilterCreateSearch:aW,_fnEscapeRegex:m,_fnFilterData:aE,_fnFeatureHtmlInfo:g,_fnUpdateInfo:at,_fnInfoMacros:bp,_fnInitialise:h,_fnInitComplete:aC,_fnLengthChange:aT,_fnFeatureHtmlLength:aR,_fnFeatureHtmlPaginate:aA,_fnPageChange:aG,_fnFeatureHtmlProcessing:bA,_fnProcessingDisplay:w,_fnFeatureHtmlTable:bz,_fnScrollDraw:l,_fnApplyToChildren:a8,_fnCalculateColumnWidths:bw,_fnThrottle:al,_fnConvertToWidth:ag,_fnScrollingWidthAdjust:az,_fnGetWidestNode:aK,_fnGetMaxLenString:ab,_fnStringToCss:bK,_fnScrollBarWidth:bb,_fnSortFlatten:aI,_fnSort:x,_fnSortAria:bd,_fnSortListener:bj,_fnSortAttachListener:C,_fnSortingClasses:ae,_fnSortData:G,_fnSaveState:bo,_fnLoadState:bO,_fnSettingsFromNode:an,_fnLog:aN,_fnMap:R,_fnBindAction:bc,_fnCallbackReg:bN,_fnCallbackFire:L,_fnLengthOverflow:bl,_fnRenderer:S,_fnDataSource:y,_fnRowAttributes:ac,_fnCalculateEnd:function(){}});bF.fn.dataTable=N;bF.fn.dataTableSettings=N.settings;bF.fn.dataTableExt=N.ext;bF.fn.DataTable=function(bR){return bF(this).dataTable(bR).api()};bF.each(N,function(bS,bR){bF.fn.DataTable[bS]=bR});return bF.fn.dataTable}))}(window,document));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/jquery.loadmask.js' */
(function(a){a.fn.mask=function(c,b){a(this).each(function(){if(b!==undefined&&b>0){var d=a(this);d.data("_mask_timeout",setTimeout(function(){a.maskElement(d,c)},b))}else{a.maskElement(a(this),c)}})};a.fn.unmask=function(){a(this).each(function(){a.unmaskElement(a(this))})};a.fn.isMasked=function(){return this.hasClass("masked")};a.maskElement=function(d,c){if(d.data("_mask_timeout")!==undefined){clearTimeout(d.data("_mask_timeout"));d.removeData("_mask_timeout")}if(d.isMasked()){a.unmaskElement(d)}if(d.css("position")=="static"){d.addClass("masked-relative")}d.addClass("masked");var e=a('<div class="loadmask"></div>');if(navigator.userAgent.toLowerCase().indexOf("msie")>-1){e.height(d.height()+parseInt(d.css("padding-top"))+parseInt(d.css("padding-bottom")));e.width(d.width()+parseInt(d.css("padding-left"))+parseInt(d.css("padding-right")))}if(navigator.userAgent.toLowerCase().indexOf("msie 6")>-1){d.find("select").addClass("masked-hidden")}d.append(e);if(c!==undefined){var b=a('<div class="loadmask-msg" style="display:none;"></div>');b.append("<div>"+c+"</div>");d.append(b);b.css("top",Math.round(d.height()/2-(b.height()-parseInt(b.css("padding-top"))-parseInt(b.css("padding-bottom")))/2)+"px");b.css("left",Math.round(d.width()/2-(b.width()-parseInt(b.css("padding-left"))-parseInt(b.css("padding-right")))/2)+"px");b.show()}};a.unmaskElement=function(b){if(b.data("_mask_timeout")!==undefined){clearTimeout(b.data("_mask_timeout"));b.removeData("_mask_timeout")}b.find(".loadmask-msg,.loadmask").remove();b.removeClass("masked");b.removeClass("masked-relative");b.find("select").removeClass("masked-hidden")}})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/parsley.js' */
/*!
 * Parsleyjs
 * Guillaume Potier - <guillaume@wisembly.com>
 * Version 2.0.6 - built Tue Dec 02 2014 17:12:12
 * MIT Licensed
 *
 */
!(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(l){if("undefined"===typeof l&&"undefined"!==typeof window.jQuery){l=window.jQuery}var f={attr:function(o,s,v){var u,w={},q=this.msieversion(),t=new RegExp("^"+s,"i");if("undefined"===typeof o||"undefined"===typeof o[0]){return{}}for(var r in o[0].attributes){u=o[0].attributes[r];if("undefined"!==typeof u&&null!==u&&(!q||q>=8||u.specified)&&t.test(u.name)){if("undefined"!==typeof v&&new RegExp(v+"$","i").test(u.name)){return true}w[this.camelize(u.name.replace(s,""))]=this.deserializeValue(u.value)}}return"undefined"===typeof v?w:false},setAttr:function(q,r,o,s){q[0].setAttribute(this.dasherize(r+o),String(s))},get:function(r,q){var o=0,s=(q||"").split(".");while(this.isObject(r)||this.isArray(r)){r=r[s[o++]];if(o===s.length){return r}}return undefined},hash:function(o){return String(Math.random()).substring(2,o?o+2:9)},isArray:function(o){return Object.prototype.toString.call(o)==="[object Array]"},isObject:function(o){return o===Object(o)},deserializeValue:function(q){var o;try{return q?q=="true"||(q=="false"?false:q=="null"?null:!isNaN(o=Number(q))?o:/^[\[\{]/.test(q)?l.parseJSON(q):q):q}catch(r){return q}},camelize:function(o){return o.replace(/-+(.)?/g,function(q,r){return r?r.toUpperCase():""})},dasherize:function(o){return o.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()},msieversion:function(){var q=window.navigator.userAgent,o=q.indexOf("MSIE ");if(o>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return parseInt(q.substring(o+5,q.indexOf(".",o)),10)}return 0}};var k={namespace:"data-parsley-",inputs:"input, textarea, select",excluded:"input[type=button], input[type=submit], input[type=reset], input[type=hidden]",priorityEnabled:true,uiEnabled:true,validationThreshold:3,focus:"first",trigger:false,errorClass:"parsley-error",successClass:"parsley-success",classHandler:function(o){},errorsContainer:function(o){},errorsWrapper:'<ul class="parsley-errors-list"></ul>',errorTemplate:"<li></li>"};var b=function(){};b.prototype={asyncSupport:false,actualizeOptions:function(){this.options=this.OptionsFactory.get(this);return this},validateThroughValidator:function(q,r,o){return window.ParsleyValidator.validate.apply(window.ParsleyValidator,[q,r,o])},subscribe:function(o,q){l.listenTo(this,o.toLowerCase(),q);return this},unsubscribe:function(o){l.unsubscribeTo(this,o.toLowerCase());return this},reset:function(){if("ParsleyForm"!==this.__class__){return l.emit("parsley:field:reset",this)}for(var o=0;o<this.fields.length;o++){l.emit("parsley:field:reset",this.fields[o])}l.emit("parsley:form:reset",this)},destroy:function(){if("ParsleyForm"!==this.__class__){this.$element.removeData("Parsley");this.$element.removeData("ParsleyFieldMultiple");l.emit("parsley:field:destroy",this);return}for(var o=0;o<this.fields.length;o++){this.fields[o].destroy()}this.$element.removeData("Parsley");l.emit("parsley:form:destroy",this)}};
/*!
   * validator.js
   * Guillaume Potier - <guillaume@wisembly.com>
   * Version 1.0.0 - built Sun Aug 03 2014 17:42:31
   * MIT Licensed
   *
   */
var h=(function(){var r={};var t=function(w){this.__class__="Validator";this.__version__="1.0.0";this.options=w||{};this.bindingKey=this.options.bindingKey||"_validatorjsConstraint"};t.prototype={constructor:t,validate:function(w,x,y){if("string"!==typeof w&&"object"!==typeof w){throw new Error("You must validate an object or a string")}if("string"===typeof w||o(w)){return this._validateString(w,x,y)}if(this.isBinded(w)){return this._validateBindedObject(w,x)}return this._validateObject(w,x,y)},bind:function(w,x){if("object"!==typeof w){throw new Error("Must bind a Constraint to an object")}w[this.bindingKey]=new s(x);return this},unbind:function(w){if("undefined"===typeof w._validatorjsConstraint){return this}delete w[this.bindingKey];return this},isBinded:function(w){return"undefined"!==typeof w[this.bindingKey]},getBinded:function(w){return this.isBinded(w)?w[this.bindingKey]:null},_validateString:function(y,x,B){var w,A=[];if(!o(x)){x=[x]}for(var z=0;z<x.length;z++){if(!(x[z] instanceof v)){throw new Error("You must give an Assert or an Asserts array to validate a string")}w=x[z].check(y,B);if(w instanceof q){A.push(w)}}return A.length?A:true},_validateObject:function(w,y,x){if("object"!==typeof y){throw new Error("You must give a constraint to validate an object")}if(y instanceof s){return y.check(w,x)}return new s(y).check(w,x)},_validateBindedObject:function(w,x){return w[this.bindingKey].check(w,x)}};t.errorCode={must_be_a_string:"must_be_a_string",must_be_an_array:"must_be_an_array",must_be_a_number:"must_be_a_number",must_be_a_string_or_array:"must_be_a_string_or_array"};var s=function(y,w){this.__class__="Constraint";this.options=w||{};this.nodes={};if(y){try{this._bootstrap(y)}catch(x){throw new Error("Should give a valid mapping object to Constraint",x,y)}}};s.prototype={constructor:s,check:function(A,D){var F,x={};for(var E in this.nodes){var B=false;var w=this.get(E);var z=o(w)?w:[w];for(var C=z.length-1;C>=0;C--){if("Required"===z[C].__class__){B=z[C].requiresValidation(D);continue}}if(!this.has(E,A)&&!this.options.strict&&!B){continue}try{if(!this.has(E,this.options.strict||B?A:undefined)){new v().HaveProperty(E).validate(A)}F=this._check(E,A[E],D);if((o(F)&&F.length>0)||(!o(F)&&!u(F))){x[E]=F}}catch(y){x[E]=y}}return u(x)?true:x},add:function(x,w){if(w instanceof v||(o(w)&&w[0] instanceof v)){this.nodes[x]=w;return this}if("object"===typeof w&&!o(w)){this.nodes[x]=w instanceof s?w:new s(w);return this}throw new Error("Should give an Assert, an Asserts array, a Constraint",w)},has:function(x,w){w="undefined"!==typeof w?w:this.nodes;return"undefined"!==typeof w[x]},get:function(w,x){return this.has(w)?this.nodes[w]:x||null},remove:function(x){var y=[];for(var w in this.nodes){if(w!==x){y[w]=this.nodes[w]}}this.nodes=y;return this},_bootstrap:function(x){if(x instanceof s){return this.nodes=x.nodes}for(var w in x){this.add(w,x[w])}},_check:function(w,x,y){if(this.nodes[w] instanceof v){return this._checkAsserts(x,[this.nodes[w]],y)}if(o(this.nodes[w])){return this._checkAsserts(x,this.nodes[w],y)}if(this.nodes[w] instanceof s){return this.nodes[w].check(x,y)}throw new Error("Invalid node",this.nodes[w])},_checkAsserts:function(z,B,A){var w,y=[];for(var x=0;x<B.length;x++){w=B[x].check(z,A);if("undefined"!==typeof w&&true!==w){y.push(w)}}return y}};var q=function(w,y,x){this.__class__="Violation";if(!(w instanceof v)){throw new Error("Should give an assertion implementing the Assert interface")}this.assert=w;this.value=y;if("undefined"!==typeof x){this.violation=x}};q.prototype={show:function(){var w={assert:this.assert.__class__,value:this.value};if(this.violation){w.violation=this.violation}return w},__toString:function(){if("undefined"!==typeof this.violation){this.violation='", '+this.getViolation().constraint+" expected was "+this.getViolation().expected}return this.assert.__class__+' assert failed for "'+this.value+this.violation||""},getViolation:function(){var x,w;for(x in this.violation){w=this.violation[x]}return{constraint:x,expected:w}}};var v=function(w){this.__class__="Assert";this.__parentClass__=this.__class__;this.groups=[];if("undefined"!==typeof w){this.addGroup(w)}};v.prototype={construct:v,requiresValidation:function(w){if(w&&!this.hasGroup(w)){return false}if(!w&&this.hasGroups()){return false}return true},check:function(x,y){if(!this.requiresValidation(y)){return}try{return this.validate(x,y)}catch(w){return w}},hasGroup:function(w){if(o(w)){return this.hasOneOf(w)}if("Any"===w){return true}if(!this.hasGroups()){return"Default"===w}return -1!==this.groups.indexOf(w)},hasOneOf:function(w){for(var x=0;x<w.length;x++){if(this.hasGroup(w[x])){return true}}return false},hasGroups:function(){return this.groups.length>0},addGroup:function(w){if(o(w)){return this.addGroups(w)}if(!this.hasGroup(w)){this.groups.push(w)}return this},removeGroup:function(y){var x=[];for(var w=0;w<this.groups.length;w++){if(y!==this.groups[w]){x.push(this.groups[w])}}this.groups=x;return this},addGroups:function(w){for(var x=0;x<w.length;x++){this.addGroup(w[x])}return this},HaveProperty:function(w){this.__class__="HaveProperty";this.node=w;this.validate=function(x){if("undefined"===typeof x[this.node]){throw new q(this,x,{value:this.node})}return true};return this},Blank:function(){this.__class__="Blank";this.validate=function(w){if("string"!==typeof w){throw new q(this,w,{value:t.errorCode.must_be_a_string})}if(""!==w.replace(/^\s+/g,"").replace(/\s+$/g,"")){throw new q(this,w)}return true};return this},Callback:function(w){this.__class__="Callback";this.arguments=Array.prototype.slice.call(arguments);if(1===this.arguments.length){this.arguments=[]}else{this.arguments.splice(0,1)}if("function"!==typeof w){throw new Error("Callback must be instanciated with a function")}this.fn=w;this.validate=function(y){var x=this.fn.apply(this,[y].concat(this.arguments));if(true!==x){throw new q(this,y,{result:x})}return true};return this},Choice:function(w){this.__class__="Choice";if(!o(w)&&"function"!==typeof w){throw new Error("Choice must be instanciated with an array or a function")}this.list=w;this.validate=function(z){var y="function"===typeof this.list?this.list():this.list;for(var x=0;x<y.length;x++){if(z===y[x]){return true}}throw new q(this,z,{choices:y})};return this},Collection:function(w){this.__class__="Collection";this.constraint="undefined"!==typeof w?(w instanceof v?w:new s(w)):false;this.validate=function(E,D){var y,A=new t(),C=0,B={},x=this.groups.length?this.groups:D;if(!o(E)){throw new q(this,array,{value:t.errorCode.must_be_an_array})}for(var z=0;z<E.length;z++){y=this.constraint?A.validate(E[z],this.constraint,x):A.validate(E[z],x);if(!u(y)){B[C]=y}C++}return !u(B)?B:true};return this},Count:function(w){this.__class__="Count";this.count=w;this.validate=function(y){if(!o(y)){throw new q(this,y,{value:t.errorCode.must_be_an_array})}var x="function"===typeof this.count?this.count(y):this.count;if(isNaN(Number(x))){throw new Error("Count must be a valid interger",x)}if(x!==y.length){throw new q(this,y,{count:x})}return true};return this},Email:function(){this.__class__="Email";this.validate=function(x){var w=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i;if("string"!==typeof x){throw new q(this,x,{value:t.errorCode.must_be_a_string})}if(!w.test(x)){throw new q(this,x)}return true};return this},EqualTo:function(w){this.__class__="EqualTo";if("undefined"===typeof w){throw new Error("EqualTo must be instanciated with a value or a function")}this.reference=w;this.validate=function(y){var x="function"===typeof this.reference?this.reference(y):this.reference;if(x!==y){throw new q(this,y,{value:x})}return true};return this},GreaterThan:function(w){this.__class__="GreaterThan";if("undefined"===typeof w){throw new Error("Should give a threshold value")}this.threshold=w;this.validate=function(x){if(""===x||isNaN(Number(x))){throw new q(this,x,{value:t.errorCode.must_be_a_number})}if(this.threshold>=x){throw new q(this,x,{threshold:this.threshold})}return true};return this},GreaterThanOrEqual:function(w){this.__class__="GreaterThanOrEqual";if("undefined"===typeof w){throw new Error("Should give a threshold value")}this.threshold=w;this.validate=function(x){if(""===x||isNaN(Number(x))){throw new q(this,x,{value:t.errorCode.must_be_a_number})}if(this.threshold>x){throw new q(this,x,{threshold:this.threshold})}return true};return this},InstanceOf:function(w){this.__class__="InstanceOf";if("undefined"===typeof w){throw new Error("InstanceOf must be instanciated with a value")}this.classRef=w;this.validate=function(x){if(true!==(x instanceof this.classRef)){throw new q(this,x,{classRef:this.classRef})}return true};return this},Length:function(w){this.__class__="Length";if(!w.min&&!w.max){throw new Error("Lenth assert must be instanciated with a { min: x, max: y } object")}this.min=w.min;this.max=w.max;this.validate=function(x){if("string"!==typeof x&&!o(x)){throw new q(this,x,{value:t.errorCode.must_be_a_string_or_array})}if("undefined"!==typeof this.min&&this.min===this.max&&x.length!==this.min){throw new q(this,x,{min:this.min,max:this.max})}if("undefined"!==typeof this.max&&x.length>this.max){throw new q(this,x,{max:this.max})}if("undefined"!==typeof this.min&&x.length<this.min){throw new q(this,x,{min:this.min})}return true};return this},LessThan:function(w){this.__class__="LessThan";if("undefined"===typeof w){throw new Error("Should give a threshold value")}this.threshold=w;this.validate=function(x){if(""===x||isNaN(Number(x))){throw new q(this,x,{value:t.errorCode.must_be_a_number})}if(this.threshold<=x){throw new q(this,x,{threshold:this.threshold})}return true};return this},LessThanOrEqual:function(w){this.__class__="LessThanOrEqual";if("undefined"===typeof w){throw new Error("Should give a threshold value")}this.threshold=w;this.validate=function(x){if(""===x||isNaN(Number(x))){throw new q(this,x,{value:t.errorCode.must_be_a_number})}if(this.threshold<x){throw new q(this,x,{threshold:this.threshold})}return true};return this},NotNull:function(){this.__class__="NotNull";this.validate=function(w){if(null===w||"undefined"===typeof w){throw new q(this,w)}return true};return this},NotBlank:function(){this.__class__="NotBlank";this.validate=function(w){if("string"!==typeof w){throw new q(this,w,{value:t.errorCode.must_be_a_string})}if(""===w.replace(/^\s+/g,"").replace(/\s+$/g,"")){throw new q(this,w)}return true};return this},Null:function(){this.__class__="Null";this.validate=function(w){if(null!==w){throw new q(this,w)}return true};return this},Range:function(x,w){this.__class__="Range";if("undefined"===typeof x||"undefined"===typeof w){throw new Error("Range assert expects min and max values")}this.min=x;this.max=w;this.validate=function(z){try{if(("string"===typeof z&&isNaN(Number(z)))||o(z)){new v().Length({min:this.min,max:this.max}).validate(z)}else{new v().GreaterThanOrEqual(this.min).validate(z)&&new v().LessThanOrEqual(this.max).validate(z)}return true}catch(y){throw new q(this,z,y.violation)}return true};return this},Regexp:function(x,w){this.__class__="Regexp";if("undefined"===typeof x){throw new Error("You must give a regexp")}this.regexp=x;this.flag=w||"";this.validate=function(y){if("string"!==typeof y){throw new q(this,y,{value:t.errorCode.must_be_a_string})}if(!new RegExp(this.regexp,this.flag).test(y)){throw new q(this,y,{regexp:this.regexp,flag:this.flag})}return true};return this},Required:function(){this.__class__="Required";this.validate=function(x){if("undefined"===typeof x){throw new q(this,x)}try{if("string"===typeof x){new v().NotNull().validate(x)&&new v().NotBlank().validate(x)}else{if(true===o(x)){new v().Length({min:1}).validate(x)}}}catch(w){throw new q(this,x)}return true};return this},Unique:function(w){this.__class__="Unique";if("object"===typeof w){this.key=w.key}this.validate=function(A){var z,x=[];if(!o(A)){throw new q(this,A,{value:t.errorCode.must_be_an_array})}for(var y=0;y<A.length;y++){z="object"===typeof A[y]?A[y][this.key]:A[y];if("undefined"===typeof z){continue}if(-1!==x.indexOf(z)){throw new q(this,A,{value:z})}x.push(z)}return true};return this}};r.Assert=v;r.Validator=t;r.Violation=q;r.Constraint=s;if(!Array.prototype.indexOf){Array.prototype.indexOf=function(y){if(this===null){throw new TypeError()}var z=Object(this);var w=z.length>>>0;if(w===0){return -1}var A=0;if(arguments.length>1){A=Number(arguments[1]);if(A!=A){A=0}else{if(A!==0&&A!=Infinity&&A!=-Infinity){A=(A>0||-1)*Math.floor(Math.abs(A))}}}if(A>=w){return -1}var x=A>=0?A:Math.max(w-Math.abs(A),0);for(;x<w;x++){if(x in z&&z[x]===y){return x}}return -1}}var u=function(x){for(var w in x){return false}return true};var o=function(w){return Object.prototype.toString.call(w)==="[object Array]"};if(typeof define==="function"&&define.amd){define("vendors/validator.js/dist/validator",[],function(){return r})}else{if(typeof module!=="undefined"&&module.exports){module.exports=r}else{window["undefined"!==typeof validatorjs_ns?validatorjs_ns:"Validator"]=r}}return r})();h="undefined"!==typeof h?h:("undefined"!==typeof module?module.exports:null);var i=function(q,o){this.__class__="ParsleyValidator";this.Validator=h;this.locale="en";this.init(q||{},o||{})};i.prototype={init:function(q,o){this.catalog=o;for(var r in q){this.addValidator(r,q[r].fn,q[r].priority,q[r].requirementsTransformer)}l.emit("parsley:validator:init")},setLocale:function(o){if("undefined"===typeof this.catalog[o]){throw new Error(o+" is not available in the catalog")}this.locale=o;return this},addCatalog:function(o,q,r){if("object"===typeof q){this.catalog[o]=q}if(true===r){return this.setLocale(o)}return this},addMessage:function(o,q,r){if("undefined"===typeof this.catalog[o]){this.catalog[o]={}}this.catalog[o][q.toLowerCase()]=r;return this},validate:function(q,r,o){return new this.Validator.Validator().validate.apply(new h.Validator(),arguments)},addValidator:function(o,s,q,r){this.validators[o.toLowerCase()]=function(t){return l.extend(new h.Assert().Callback(s,t),{priority:q,requirementsTransformer:r})};return this},updateValidator:function(o,s,q,r){return this.addValidator(o,s,q,r)},removeValidator:function(o){delete this.validators[o];return this},getErrorMessage:function(q){var o;if("type"===q.name){o=this.catalog[this.locale][q.name][q.requirements]}else{o=this.formatMessage(this.catalog[this.locale][q.name],q.requirements)}return""!==o?o:this.catalog[this.locale].defaultMessage},formatMessage:function(o,r){if("object"===typeof r){for(var q in r){o=this.formatMessage(o,r[q])}return o}return"string"===typeof o?o.replace(new RegExp("%s","i"),r):""},validators:{notblank:function(){return l.extend(new h.Assert().NotBlank(),{priority:2})},required:function(){return l.extend(new h.Assert().Required(),{priority:512})},type:function(q){var o;switch(q){case"email":o=new h.Assert().Email();break;case"range":case"number":o=new h.Assert().Regexp("^-?(?:\\d+|\\d{1,3}(?:,\\d{3})+)?(?:\\.\\d+)?$");break;case"integer":o=new h.Assert().Regexp("^-?\\d+$");break;case"digits":o=new h.Assert().Regexp("^\\d+$");break;case"alphanum":o=new h.Assert().Regexp("^\\w+$","i");break;case"url":o=new h.Assert().Regexp("(https?:\\/\\/)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)","i");break;default:throw new Error("validator type `"+q+"` is not supported")}return l.extend(o,{priority:256})},pattern:function(q){var o="";if(!!(/^\/.*\/(?:[gimy]*)$/.test(q))){o=q.replace(/.*\/([gimy]*)$/,"$1");q=q.replace(new RegExp("^/(.*?)/"+o+"$"),"$1")}return l.extend(new h.Assert().Regexp(q,o),{priority:64})},minlength:function(o){return l.extend(new h.Assert().Length({min:o}),{priority:30,requirementsTransformer:function(){return"string"===typeof o&&!isNaN(o)?parseInt(o,10):o}})},maxlength:function(o){return l.extend(new h.Assert().Length({max:o}),{priority:30,requirementsTransformer:function(){return"string"===typeof o&&!isNaN(o)?parseInt(o,10):o}})},length:function(o){return l.extend(new h.Assert().Length({min:o[0],max:o[1]}),{priority:32})},mincheck:function(o){return this.minlength(o)},maxcheck:function(o){return this.maxlength(o)},check:function(o){return this.length(o)},min:function(o){return l.extend(new h.Assert().GreaterThanOrEqual(o),{priority:30,requirementsTransformer:function(){return"string"===typeof o&&!isNaN(o)?parseInt(o,10):o}})},max:function(o){return l.extend(new h.Assert().LessThanOrEqual(o),{priority:30,requirementsTransformer:function(){return"string"===typeof o&&!isNaN(o)?parseInt(o,10):o}})},range:function(o){return l.extend(new h.Assert().Range(o[0],o[1]),{priority:32,requirementsTransformer:function(){for(var q=0;q<o.length;q++){o[q]="string"===typeof o[q]&&!isNaN(o[q])?parseInt(o[q],10):o[q]}return o}})},equalto:function(o){return l.extend(new h.Assert().EqualTo(o),{priority:256,requirementsTransformer:function(){return l(o).length?l(o).val():o}})}}};var g=function(o){this.__class__="ParsleyUI"};g.prototype={listen:function(){l.listen("parsley:form:init",this,this.setupForm);l.listen("parsley:field:init",this,this.setupField);l.listen("parsley:field:validated",this,this.reflow);l.listen("parsley:form:validated",this,this.focus);l.listen("parsley:field:reset",this,this.reset);l.listen("parsley:form:destroy",this,this.destroy);l.listen("parsley:field:destroy",this,this.destroy);return this},reflow:function(o){if("undefined"===typeof o._ui||false===o._ui.active){return}var q=this._diff(o.validationResult,o._ui.lastValidationResult);o._ui.lastValidationResult=o.validationResult;o._ui.validatedOnce=true;this.manageStatusClass(o);this.manageErrorsMessages(o,q);this.actualizeTriggers(o);if((q.kept.length||q.added.length)&&"undefined"===typeof o._ui.failedOnce){this.manageFailingFieldTrigger(o)}},getErrorsMessages:function(o){if(true===o.validationResult){return[]}var r=[];for(var q=0;q<o.validationResult.length;q++){r.push(this._getErrorMessage(o,o.validationResult[q].assert))}return r},manageStatusClass:function(o){if(true===o.validationResult){this._successClass(o)}else{if(o.validationResult.length>0){this._errorClass(o)}else{this._resetClass(o)}}},manageErrorsMessages:function(o,r){if("undefined"!==typeof o.options.errorsMessagesDisabled){return}if("undefined"!==typeof o.options.errorMessage){if((r.added.length||r.kept.length)){if(0===o._ui.$errorsWrapper.find(".parsley-custom-error-message").length){o._ui.$errorsWrapper.append(l(o.options.errorTemplate).addClass("parsley-custom-error-message"))}return o._ui.$errorsWrapper.addClass("filled").find(".parsley-custom-error-message").html(o.options.errorMessage)}return o._ui.$errorsWrapper.removeClass("filled").find(".parsley-custom-error-message").remove()}for(var q=0;q<r.removed.length;q++){this.removeError(o,r.removed[q].assert.name,true)}for(q=0;q<r.added.length;q++){this.addError(o,r.added[q].assert.name,undefined,r.added[q].assert,true)}for(q=0;q<r.kept.length;q++){this.updateError(o,r.kept[q].assert.name,undefined,r.kept[q].assert,true)}},addError:function(q,r,s,o,t){q._ui.$errorsWrapper.addClass("filled").append(l(q.options.errorTemplate).addClass("parsley-"+r).html(s||this._getErrorMessage(q,o)));if(true!==t){this._errorClass(q)}},updateError:function(q,r,s,o,t){q._ui.$errorsWrapper.addClass("filled").find(".parsley-"+r).html(s||this._getErrorMessage(q,o));if(true!==t){this._errorClass(q)}},removeError:function(o,q,r){o._ui.$errorsWrapper.removeClass("filled").find(".parsley-"+q).remove();if(true!==r){this.manageStatusClass(o)}},focus:function(q){if(true===q.validationResult||"none"===q.options.focus){return q._focusedField=null}q._focusedField=null;for(var o=0;o<q.fields.length;o++){if(true!==q.fields[o].validationResult&&q.fields[o].validationResult.length>0&&"undefined"===typeof q.fields[o].options.noFocus){if("first"===q.options.focus){q._focusedField=q.fields[o].$element;return q._focusedField.focus()}q._focusedField=q.fields[o].$element}}if(null===q._focusedField){return null}return q._focusedField.focus()},_getErrorMessage:function(q,r){var o=r.name+"Message";if("undefined"!==typeof q.options[o]){return window.ParsleyValidator.formatMessage(q.options[o],r.requirements)}return window.ParsleyValidator.getErrorMessage(r)},_diff:function(q,w,o){var t=[],v=[];for(var s=0;s<q.length;s++){var u=false;for(var r=0;r<w.length;r++){if(q[s].assert.name===w[r].assert.name){u=true;break}}if(u){v.push(q[s])}else{t.push(q[s])}}return{kept:v,added:t,removed:!o?this._diff(w,q,true).added:[]}},setupForm:function(o){o.$element.on("submit.Parsley",false,l.proxy(o.onSubmitValidate,o));if(false===o.options.uiEnabled){return}o.$element.attr("novalidate","")},setupField:function(q){var o={active:false};if(false===q.options.uiEnabled){return}o.active=true;q.$element.attr(q.options.namespace+"id",q.__id__);o.$errorClassHandler=this._manageClassHandler(q);o.errorsWrapperId="parsley-id-"+("undefined"!==typeof q.options.multiple?"multiple-"+q.options.multiple:q.__id__);o.$errorsWrapper=l(q.options.errorsWrapper).attr("id",o.errorsWrapperId);o.lastValidationResult=[];o.validatedOnce=false;o.validationInformationVisible=false;q._ui=o;if(!q.$element.is(q.options.excluded)){this._insertErrorWrapper(q)}this.actualizeTriggers(q)},_manageClassHandler:function(q){if("string"===typeof q.options.classHandler&&l(q.options.classHandler).length){return l(q.options.classHandler)}var o=q.options.classHandler(q);if("undefined"!==typeof o&&o.length){return o}if("undefined"===typeof q.options.multiple||q.$element.is("select")){return q.$element}return q.$element.parent()},_insertErrorWrapper:function(o){var q;if("string"===typeof o.options.errorsContainer){if(l(o.options.errorsContainer).length){return l(o.options.errorsContainer).append(o._ui.$errorsWrapper)}else{if(window.console&&window.console.warn){window.console.warn("The errors container `"+o.options.errorsContainer+"` does not exist in DOM")}}}else{if("function"===typeof o.options.errorsContainer){q=o.options.errorsContainer(o)}}if("undefined"!==typeof q&&q.length){return q.append(o._ui.$errorsWrapper)}return"undefined"===typeof o.options.multiple?o.$element.after(o._ui.$errorsWrapper):o.$element.parent().after(o._ui.$errorsWrapper)},actualizeTriggers:function(o){var r=this;if(o.options.multiple){l("["+o.options.namespace+'multiple="'+o.options.multiple+'"]').each(function(){l(this).off(".Parsley")})}else{o.$element.off(".Parsley")}if(false===o.options.trigger){return}var q=o.options.trigger.replace(/^\s+/g,"").replace(/\s+$/g,"");if(""===q){return}if(o.options.multiple){l("["+o.options.namespace+'multiple="'+o.options.multiple+'"]').each(function(){l(this).on(q.split(" ").join(".Parsley ")+".Parsley",false,l.proxy("function"===typeof o.eventValidate?o.eventValidate:r.eventValidate,o))})}else{o.$element.on(q.split(" ").join(".Parsley ")+".Parsley",false,l.proxy("function"===typeof o.eventValidate?o.eventValidate:this.eventValidate,o))}},eventValidate:function(o){if(new RegExp("key").test(o.type)){if(!this._ui.validationInformationVisible&&this.getValue().length<=this.options.validationThreshold){return}}this._ui.validatedOnce=true;this.validate()},manageFailingFieldTrigger:function(o){o._ui.failedOnce=true;if(o.options.multiple){l("["+o.options.namespace+'multiple="'+o.options.multiple+'"]').each(function(){if(!new RegExp("change","i").test(l(this).parsley().options.trigger||"")){return l(this).on("change.ParsleyFailedOnce",false,l.proxy(o.validate,o))}})}if(o.$element.is("select")){if(!new RegExp("change","i").test(o.options.trigger||"")){return o.$element.on("change.ParsleyFailedOnce",false,l.proxy(o.validate,o))}}if(!new RegExp("keyup","i").test(o.options.trigger||"")){return o.$element.on("keyup.ParsleyFailedOnce",false,l.proxy(o.validate,o))}},reset:function(o){o.$element.off(".Parsley");o.$element.off(".ParsleyFailedOnce");if("undefined"===typeof o._ui){return}if("ParsleyForm"===o.__class__){return}o._ui.$errorsWrapper.removeClass("filled").children().remove();this._resetClass(o);o._ui.validatedOnce=false;o._ui.lastValidationResult=[];o._ui.validationInformationVisible=false},destroy:function(o){this.reset(o);if("ParsleyForm"===o.__class__){return}if("undefined"!==typeof o._ui){o._ui.$errorsWrapper.remove()}delete o._ui},_successClass:function(o){o._ui.validationInformationVisible=true;o._ui.$errorClassHandler.removeClass(o.options.errorClass).addClass(o.options.successClass)},_errorClass:function(o){o._ui.validationInformationVisible=true;o._ui.$errorClassHandler.removeClass(o.options.successClass).addClass(o.options.errorClass)},_resetClass:function(o){o._ui.$errorClassHandler.removeClass(o.options.successClass).removeClass(o.options.errorClass)}};var p=function(o,r,s,q){this.__class__="OptionsFactory";this.__id__=f.hash(4);this.formOptions=null;this.fieldOptions=null;this.staticOptions=l.extend(true,{},o,r,s,{namespace:q})};p.prototype={get:function(o){if("undefined"===typeof o.__class__){throw new Error("Parsley Instance expected")}switch(o.__class__){case"Parsley":return this.staticOptions;case"ParsleyForm":return this.getFormOptions(o);case"ParsleyField":case"ParsleyFieldMultiple":return this.getFieldOptions(o);default:throw new Error("Instance "+o.__class__+" is not supported")}},getFormOptions:function(o){this.formOptions=f.attr(o.$element,this.staticOptions.namespace);return l.extend({},this.staticOptions,this.formOptions)},getFieldOptions:function(o){this.fieldOptions=f.attr(o.$element,this.staticOptions.namespace);if(null===this.formOptions&&"undefined"!==typeof o.parent){this.formOptions=this.getFormOptions(o.parent)}return l.extend({},this.staticOptions,this.formOptions,this.fieldOptions)}};var c=function(o,q){this.__class__="ParsleyForm";this.__id__=f.hash(4);if("OptionsFactory"!==f.get(q,"__class__")){throw new Error("You must give an OptionsFactory instance")}this.OptionsFactory=q;this.$element=l(o);this.validationResult=null;this.options=this.OptionsFactory.get(this)};c.prototype={onSubmitValidate:function(o){this.validate(undefined,undefined,o);if(false===this.validationResult&&o instanceof l.Event){o.stopImmediatePropagation();o.preventDefault()}return this},validate:function(t,s,r){this.submitEvent=r;this.validationResult=true;var o=[];this._refreshFields();l.emit("parsley:form:validate",this);for(var q=0;q<this.fields.length;q++){if(t&&!this._isFieldInGroup(this.fields[q],t)){continue}o=this.fields[q].validate(s);if(true!==o&&o.length>0&&this.validationResult){this.validationResult=false}}l.emit("parsley:form:validated",this);return this.validationResult},isValid:function(r,q){this._refreshFields();for(var o=0;o<this.fields.length;o++){if(r&&!this._isFieldInGroup(this.fields[o],r)){continue}if(false===this.fields[o].isValid(q)){return false}}return true},_isFieldInGroup:function(q,o){if(f.isArray(q.options.group)){return -1!==l.inArray(o,q.options.group)}return q.options.group===o},_refreshFields:function(){return this.actualizeOptions()._bindFields()},_bindFields:function(){var o=this;this.fields=[];this.fieldsMappedById={};this.$element.find(this.options.inputs).each(function(){var q=new window.Parsley(this,{},o);if(("ParsleyField"===q.__class__||"ParsleyFieldMultiple"===q.__class__)&&!q.$element.is(q.options.excluded)){if("undefined"===typeof o.fieldsMappedById[q.__class__+"-"+q.__id__]){o.fieldsMappedById[q.__class__+"-"+q.__id__]=q;o.fields.push(q)}}});return this}};var n=function(s,q,t,r,o){if(!new RegExp("ParsleyField").test(f.get(s,"__class__"))){throw new Error("ParsleyField or ParsleyFieldMultiple instance expected")}if("function"!==typeof window.ParsleyValidator.validators[q]&&"Assert"!==window.ParsleyValidator.validators[q](t).__parentClass__){throw new Error("Valid validator expected")}var u=function(w,v){if("undefined"!==typeof w.options[v+"Priority"]){return w.options[v+"Priority"]}return f.get(window.ParsleyValidator.validators[v](t),"priority")||2};r=r||u(s,q);if("function"===typeof window.ParsleyValidator.validators[q](t).requirementsTransformer){t=window.ParsleyValidator.validators[q](t).requirementsTransformer()}return l.extend(window.ParsleyValidator.validators[q](t),{name:q,requirements:t,priority:r,groups:[r],isDomConstraint:o||f.attr(s.$element,s.options.namespace,q)})};var d=function(q,r,o){this.__class__="ParsleyField";this.__id__=f.hash(4);this.$element=l(q);if("undefined"!==typeof o){this.parent=o;this.OptionsFactory=this.parent.OptionsFactory;this.options=this.OptionsFactory.get(this)}else{this.OptionsFactory=r;this.options=this.OptionsFactory.get(this)}this.constraints=[];this.constraintsByName={};this.validationResult=[];this._bindConstraints()};d.prototype={validate:function(o){this.value=this.getValue();l.emit("parsley:field:validate",this);l.emit("parsley:field:"+(this.isValid(o,this.value)?"success":"error"),this);l.emit("parsley:field:validated",this);return this.validationResult},isValid:function(s,r){this.refreshConstraints();var o=this._getConstraintsSortedPriorities();if(0===o.length){return this.validationResult=[]}r=r||this.getValue();if(!r.length&&!this._isRequired()&&"undefined"===typeof this.options.validateIfEmpty&&true!==s){return this.validationResult=[]}if(false===this.options.priorityEnabled){return true===(this.validationResult=this.validateThroughValidator(r,this.constraints,"Any"))}for(var q=0;q<o.length;q++){if(true!==(this.validationResult=this.validateThroughValidator(r,this.constraints,o[q]))){return false}}return true},getValue:function(){var o;if("undefined"!==typeof this.options.value){o=this.options.value}else{o=this.$element.val()}if("undefined"===typeof o||null===o){return""}if(true===this.options.trimValue){return o.replace(/^\s+|\s+$/g,"")}return o},refreshConstraints:function(){return this.actualizeOptions()._bindConstraints()},addConstraint:function(q,s,r,o){q=q.toLowerCase();if("function"===typeof window.ParsleyValidator.validators[q]){var t=new n(this,q,s,r,o);if("undefined"!==this.constraintsByName[t.name]){this.removeConstraint(t.name)}this.constraints.push(t);this.constraintsByName[t.name]=t}return this},removeConstraint:function(o){for(var q=0;q<this.constraints.length;q++){if(o===this.constraints[q].name){this.constraints.splice(q,1);break}}delete this.constraintsByName[o];return this},updateConstraint:function(o,r,q){return this.removeConstraint(o).addConstraint(o,r,q)},_bindConstraints:function(){var s=[],o={};for(var r=0;r<this.constraints.length;r++){if(false===this.constraints[r].isDomConstraint){s.push(this.constraints[r]);o[this.constraints[r].name]=this.constraints[r]}}this.constraints=s;this.constraintsByName=o;for(var q in this.options){this.addConstraint(q,this.options[q])}return this._bindHtml5Constraints()},_bindHtml5Constraints:function(){if(this.$element.hasClass("required")||this.$element.attr("required")){this.addConstraint("required",true,undefined,true)}if("string"===typeof this.$element.attr("pattern")){this.addConstraint("pattern",this.$element.attr("pattern"),undefined,true)}if("undefined"!==typeof this.$element.attr("min")&&"undefined"!==typeof this.$element.attr("max")){this.addConstraint("range",[this.$element.attr("min"),this.$element.attr("max")],undefined,true)}else{if("undefined"!==typeof this.$element.attr("min")){this.addConstraint("min",this.$element.attr("min"),undefined,true)}else{if("undefined"!==typeof this.$element.attr("max")){this.addConstraint("max",this.$element.attr("max"),undefined,true)}}}var o=this.$element.attr("type");if("undefined"===typeof o){return this}if("number"===o){if(("undefined"===typeof this.$element.attr("step"))||(0===parseFloat(this.$element.attr("step"))%1)){return this.addConstraint("type","integer",undefined,true)}else{return this.addConstraint("type","number",undefined,true)}}else{if(new RegExp(o,"i").test("email url range")){return this.addConstraint("type",o,undefined,true)}}return this},_isRequired:function(){if("undefined"===typeof this.constraintsByName.required){return false}return false!==this.constraintsByName.required.requirements},_getConstraintsSortedPriorities:function(){var o=[];for(var q=0;q<this.constraints.length;q++){if(-1===o.indexOf(this.constraints[q].priority)){o.push(this.constraints[q].priority)}}o.sort(function(s,r){return r-s});return o}};var a=function(){this.__class__="ParsleyFieldMultiple"};a.prototype={addElement:function(o){this.$elements.push(o);return this},refreshConstraints:function(){var q;this.constraints=[];if(this.$element.is("select")){this.actualizeOptions()._bindConstraints();return this}for(var r=0;r<this.$elements.length;r++){if(!l("html").has(this.$elements[r]).length){this.$elements.splice(r,1);continue}q=this.$elements[r].data("ParsleyFieldMultiple").refreshConstraints().constraints;for(var o=0;o<q.length;o++){this.addConstraint(q[o].name,q[o].requirements,q[o].priority,q[o].isDomConstraint)}}return this},getValue:function(){if("undefined"!==typeof this.options.value){return this.options.value}if(this.$element.is("input[type=radio]")){return l("["+this.options.namespace+'multiple="'+this.options.multiple+'"]:checked').val()||""}if(this.$element.is("input[type=checkbox]")){var o=[];l("["+this.options.namespace+'multiple="'+this.options.multiple+'"]:checked').each(function(){o.push(l(this).val())});return o.length?o:[]}if(this.$element.is("select")&&null===this.$element.val()){return[]}return this.$element.val()},_init:function(o){this.$elements=[this.$element];this.options.multiple=o;return this}};var e=l({}),m={};l.listen=function(o){if("undefined"===typeof m[o]){m[o]=[]}if("function"===typeof arguments[1]){return m[o].push({fn:arguments[1]})}if("object"===typeof arguments[1]&&"function"===typeof arguments[2]){return m[o].push({fn:arguments[2],ctxt:arguments[1]})}throw new Error("Wrong parameters")};l.listenTo=function(o,q,r){if("undefined"===typeof m[q]){m[q]=[]}if(!(o instanceof d)&&!(o instanceof c)){throw new Error("Must give Parsley instance")}if("string"!==typeof q||"function"!==typeof r){throw new Error("Wrong parameters")}m[q].push({instance:o,fn:r})};l.unsubscribe=function(o,r){if("undefined"===typeof m[o]){return}if("string"!==typeof o||"function"!==typeof r){throw new Error("Wrong arguments")}for(var q=0;q<m[o].length;q++){if(m[o][q].fn===r){return m[o].splice(q,1)}}};l.unsubscribeTo=function(o,q){if("undefined"===typeof m[q]){return}if(!(o instanceof d)&&!(o instanceof c)){throw new Error("Must give Parsley instance")}for(var r=0;r<m[q].length;r++){if("undefined"!==typeof m[q][r].instance&&m[q][r].instance.__id__===o.__id__){return m[q].splice(r,1)}}};l.unsubscribeAll=function(o){if("undefined"===typeof m[o]){return}delete m[o]};l.emit=function(r,o){if("undefined"===typeof m[r]){return}for(var s=0;s<m[r].length;s++){if("undefined"===typeof m[r][s].instance){m[r][s].fn.apply("undefined"!==typeof m[r][s].ctxt?m[r][s].ctxt:e,Array.prototype.slice.call(arguments,1));continue}if(!(o instanceof d)&&!(o instanceof c)){continue}if(m[r][s].instance.__id__===o.__id__){m[r][s].fn.apply(e,Array.prototype.slice.call(arguments,1));continue}if(m[r][s].instance instanceof c&&o instanceof d){for(var q=0;q<m[r][s].instance.fields.length;q++){if(m[r][s].instance.fields[q].__id__===o.__id__){m[r][s].fn.apply(e,Array.prototype.slice.call(arguments,1));continue}}}}};l.subscribed=function(){return m};window.ParsleyConfig=window.ParsleyConfig||{};window.ParsleyConfig.i18n=window.ParsleyConfig.i18n||{};window.ParsleyConfig.i18n.en=l.extend(window.ParsleyConfig.i18n.en||{},{defaultMessage:"This value seems to be invalid.",type:{email:"This value should be a valid email.",url:"This value should be a valid url.",number:"This value should be a valid number.",integer:"This value should be a valid integer.",digits:"This value should be digits.",alphanum:"This value should be alphanumeric."},notblank:"This value should not be blank.",required:"This value is required.",pattern:"This value seems to be invalid.",min:"This value should be greater than or equal to %s.",max:"This value should be lower than or equal to %s.",range:"This value should be between %s and %s.",minlength:"This value is too short. It should have %s characters or more.",maxlength:"This value is too long. It should have %s characters or fewer.",length:"This value length is invalid. It should be between %s and %s characters long.",mincheck:"You must select at least %s choices.",maxcheck:"You must select %s choices or fewer.",check:"You must select between %s and %s choices.",equalto:"This value should be the same."});if("undefined"!==typeof window.ParsleyValidator){window.ParsleyValidator.addCatalog("en",window.ParsleyConfig.i18n.en,true)}var j=function(r,q,o){this.__class__="Parsley";this.__version__="2.0.6";this.__id__=f.hash(4);if("undefined"===typeof r){throw new Error("You must give an element")}if("undefined"!==typeof o&&"ParsleyForm"!==o.__class__){throw new Error("Parent instance must be a ParsleyForm instance")}return this.init(l(r),q,o)};j.prototype={init:function(q,r,o){if(!q.length){throw new Error("You must bind Parsley on an existing element.")}this.$element=q;if(this.$element.data("Parsley")){var s=this.$element.data("Parsley");if("undefined"!==typeof o){s.parent=o}return s}this.OptionsFactory=new p(k,f.get(window,"ParsleyConfig")||{},r,this.getNamespace(r));this.options=this.OptionsFactory.get(this);if(this.$element.is("form")||(f.attr(this.$element,this.options.namespace,"validate")&&!this.$element.is(this.options.inputs))){return this.bind("parsleyForm")}else{if(this.$element.is(this.options.inputs)&&!this.$element.is(this.options.excluded)){return this.isMultiple()?this.handleMultiple(o):this.bind("parsleyField",o)}}return this},isMultiple:function(){return(this.$element.is("input[type=radio], input[type=checkbox]")&&"undefined"===typeof this.options.multiple)||(this.$element.is("select")&&"undefined"!==typeof this.$element.attr("multiple"))},handleMultiple:function(q){var t=this,r,o,u;this.options=l.extend(this.options,q?q.OptionsFactory.get(q):{},f.attr(this.$element,this.options.namespace));if(this.options.multiple){o=this.options.multiple}else{if("undefined"!==typeof this.$element.attr("name")&&this.$element.attr("name").length){o=r=this.$element.attr("name")}else{if("undefined"!==typeof this.$element.attr("id")&&this.$element.attr("id").length){o=this.$element.attr("id")}}}if(this.$element.is("select")&&"undefined"!==typeof this.$element.attr("multiple")){return this.bind("parsleyFieldMultiple",q,o||this.__id__)}else{if("undefined"===typeof o){if(window.console&&window.console.warn){window.console.warn("To be binded by Parsley, a radio, a checkbox and a multiple select input must have either a name or a multiple option.",this.$element)}return this}}o=o.replace(/(:|\.|\[|\]|\{|\}|\$)/g,"");if("undefined"!==typeof r){l('input[name="'+r+'"]').each(function(){if(l(this).is("input[type=radio], input[type=checkbox]")){l(this).attr(t.options.namespace+"multiple",o)}})}if(l("["+this.options.namespace+"multiple="+o+"]").length){for(var s=0;s<l("["+this.options.namespace+"multiple="+o+"]").length;s++){if("undefined"!==typeof l(l("["+this.options.namespace+"multiple="+o+"]").get(s)).data("Parsley")){u=l(l("["+this.options.namespace+"multiple="+o+"]").get(s)).data("Parsley");if(!this.$element.data("ParsleyFieldMultiple")){u.addElement(this.$element);this.$element.attr(this.options.namespace+"id",u.__id__)}break}}}this.bind("parsleyField",q,o,true);return u||this.bind("parsleyFieldMultiple",q,o)},getNamespace:function(o){if("undefined"!==typeof this.$element.data("parsleyNamespace")){return this.$element.data("parsleyNamespace")}if("undefined"!==typeof f.get(o,"namespace")){return o.namespace}if("undefined"!==typeof f.get(window,"ParsleyConfig.namespace")){return window.ParsleyConfig.namespace}return k.namespace},bind:function(r,q,o,t){var s;switch(r){case"parsleyForm":s=l.extend(new c(this.$element,this.OptionsFactory),new b(),window.ParsleyExtend)._bindFields();break;case"parsleyField":s=l.extend(new d(this.$element,this.OptionsFactory,q),new b(),window.ParsleyExtend);break;case"parsleyFieldMultiple":s=l.extend(new d(this.$element,this.OptionsFactory,q),new b(),new a(),window.ParsleyExtend)._init(o);break;default:throw new Error(r+"is not a supported Parsley type")}if("undefined"!==typeof o){f.setAttr(this.$element,this.options.namespace,"multiple",o)}if("undefined"!==typeof t){this.$element.data("ParsleyFieldMultiple",s);return s}if(new RegExp("ParsleyF","i").test(s.__class__)){this.$element.data("Parsley",s);l.emit("parsley:"+("parsleyForm"===r?"form":"field")+":init",s)}return s}};l.fn.parsley=l.fn.psly=function(o){if(this.length>1){var q=[];this.each(function(){q.push(l(this).parsley(o))});return q}if(!l(this).length){if(window.console&&window.console.warn){window.console.warn("You must bind Parsley on an existing element.")}return}return new j(this,o)};window.ParsleyUI="function"===typeof f.get(window,"ParsleyConfig.ParsleyUI")?new window.ParsleyConfig.ParsleyUI().listen():new g().listen();if("undefined"===typeof window.ParsleyExtend){window.ParsleyExtend={}}if("undefined"===typeof window.ParsleyConfig){window.ParsleyConfig={}}window.Parsley=window.psly=j;window.ParsleyUtils=f;window.ParsleyValidator=new i(window.ParsleyConfig.validators,window.ParsleyConfig.i18n);if(false!==f.get(window,"ParsleyConfig.autoBind")){l(function(){if(l("[data-parsley-validate]").length){l("[data-parsley-validate]").parsley()}})}}));(function(a){var b=function(c){return c.replace(/(^\s*)|(\s*$)/gi,"").replace(/[ ]{2,}/gi," ").replace(/\n /,"\n").split(" ").length};a.ParsleyValidator.addValidator("minwords",function(c,d){return b(c)>=d},32).addMessage("en","minwords","This value needs more words");a.ParsleyValidator.addValidator("maxwords",function(c,d){return b(c)<=d},32).addMessage("en","maxwords","This value needs fewer words");a.ParsleyValidator.addValidator("words",function(e,c){var d=b(e);return d>=c[0]&&d<=c[1]},32).addMessage("en","words","This value has the incorrect number of words")})(window);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/easyforms-restore.js' */
easyforms.jQuery=jQuery;easyforms.$=$;easyforms._=_;easyforms.Backbone=Backbone;jQuery.noConflict();Backbone.noConflict();jQuery=easyforms.__ojq;$=easyforms.__o$;_=easyforms.__ou;Backbone=easyforms.__obb;delete easyforms.__ojq;delete easyforms.__o$;delete easyforms.__ou;delete easyforms.__obb;
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/easyforms.js' */
(function(c,b,a){c(function(){c('script[type="text/easyform"]').each(function(){var d=a.parseJSON(c(this).text());a.createForm(d)});c('script[type="text/easyform-report"]').each(function(){var d=a.parseJSON(c(this).text());a.createReport(d)})});a.parseJSON=function(f){var g=f.indexOf("{");var d=f.lastIndexOf("}");var e=f.slice(g,d+1);return JSON.parse(e)};a.createForm=function(d){var f=JSON.parse(a.decodeBase64(d.descriptor));if(d.hasSubmitted&&d.submissionReport){d.submissionReport=JSON.parse(a.decodeBase64(d.submissionReport))}var e=new a.FormController(d,f);e.render()};a.createReport=function(f){var d=JSON.parse(a.decodeBase64(f.report));var e=new a.FormReporter(f,d);e.render()};a.uid=function(){return"c"+a.encodeBase58(a.hashCode(a.cuid()))};a.restUrl=function(d){return AJS.Meta.get("context-path")+"/rest/easyform/1.0"+d};a.hashCode=function(h,e){var f,d,g=(e===undefined)?2166136261:e;for(f=0,d=h.length;f<d;f++){g^=h.charCodeAt(f);g+=(g<<1)+(g<<4)+(g<<7)+(g<<8)+(g<<24)}return g>>>0};(function(){var k=0,j=4,d=36,o=Math.pow(d,j),e=function e(p,q){var r="000000000"+p;return r.substr(r.length-q)},g=function g(){return e((Math.random()*o<<0).toString(d),j)},h=function(){k=(k<o)?k:0;k++;return k-1},i=function l(){var s="c",t=(new Date().getTime()).toString(d),p,q=i.fingerprint(),r=g()+g();p=e(h().toString(d),j);return(s+t+p+q+r)};i.slug=function f(){var r=new Date().getTime().toString(36),p,q=i.fingerprint().slice(0,1)+i.fingerprint().slice(-1),s=g().slice(-2);p=h().toString(36).slice(-4);return r.slice(-2)+p+q+s};i.globalCount=function n(){var p=(function q(){var r,s=0;for(r in b){s++}return s}());i.globalCount=function(){return p};return p};i.fingerprint=function m(){return e((navigator.mimeTypes.length+navigator.userAgent.length).toString(36)+i.globalCount().toString(36),4)};a.cuid=i}());(function(){var e="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";var d=e.length;a.encodeBase58=function(f){var g,h;if(!/^\d+$/.test(f)){throw new Error("Value passed is not an integer.")}if(typeof f!=="number"){f=parseInt(f)}h="";while(f>=d){g=f%d;h=e[g]+h;f=(f-g)/d}return e[f]+h};a.decodeBase58=function(m){var i,l,h,g,k,f,j;g=0;j=m.split("").reverse();for(h=k=0,f=j.length;k<f;h=++k){i=j[h];if((l=e.indexOf(i))===-1){throw new Error("Value passed is not a valid Base58 string.")}g+=l*Math.pow(d,h)}return g}}());(function(s){var l=s.Base64;var h="2.1.7";var t;if(typeof module!=="undefined"&&module.exports){t=require("buffer").Buffer}var q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var f=function(D){var C={};for(var B=0,A=D.length;B<A;B++){C[D.charAt(B)]=B}return C}(q);var w=String.fromCharCode;var y=function(B){if(B.length<2){var A=B.charCodeAt(0);return A<128?B:A<2048?(w(192|(A>>>6))+w(128|(A&63))):(w(224|((A>>>12)&15))+w(128|((A>>>6)&63))+w(128|(A&63)))}else{var A=65536+(B.charCodeAt(0)-55296)*1024+(B.charCodeAt(1)-56320);return(w(240|((A>>>18)&7))+w(128|((A>>>12)&63))+w(128|((A>>>6)&63))+w(128|(A&63)))}};var m=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g;var j=function(A){return A.replace(m,y)};var r=function(D){var C=[0,2,1][D.length%3],A=D.charCodeAt(0)<<16|((D.length>1?D.charCodeAt(1):0)<<8)|((D.length>2?D.charCodeAt(2):0)),B=[q.charAt(A>>>18),q.charAt((A>>>12)&63),C>=2?"=":q.charAt((A>>>6)&63),C>=1?"=":q.charAt(A&63)];return B.join("")};var n=s.btoa?function(A){return s.btoa(A)}:function(A){return A.replace(/[\s\S]{1,3}/g,r)};var p=t?function(A){return(A.constructor===t.constructor?A:new t(A)).toString("base64")}:function(A){return n(j(A))};var i=function(A,B){return !B?p(String(A)):p(String(A)).replace(/[+\/]/g,function(C){return C=="+"?"-":"_"}).replace(/=/g,"")};var v=function(A){return i(A,true)};var g=new RegExp(["[\xC0-\xDF][\x80-\xBF]","[\xE0-\xEF][\x80-\xBF]{2}","[\xF0-\xF7][\x80-\xBF]{3}"].join("|"),"g");var u=function(C){switch(C.length){case 4:var A=((7&C.charCodeAt(0))<<18)|((63&C.charCodeAt(1))<<12)|((63&C.charCodeAt(2))<<6)|(63&C.charCodeAt(3)),B=A-65536;return(w((B>>>10)+55296)+w((B&1023)+56320));case 3:return w(((15&C.charCodeAt(0))<<12)|((63&C.charCodeAt(1))<<6)|(63&C.charCodeAt(2)));default:return w(((31&C.charCodeAt(0))<<6)|(63&C.charCodeAt(1)))}};var e=function(A){return A.replace(g,u)};var d=function(E){var A=E.length,C=A%4,D=(A>0?f[E.charAt(0)]<<18:0)|(A>1?f[E.charAt(1)]<<12:0)|(A>2?f[E.charAt(2)]<<6:0)|(A>3?f[E.charAt(3)]:0),B=[w(D>>>16),w((D>>>8)&255),w(D&255)];B.length-=[0,0,2,1][C];return B.join("")};var k=s.atob?function(A){return s.atob(A)}:function(A){return A.replace(/[\s\S]{1,4}/g,d)};var x=t?function(A){return(A.constructor===t.constructor?A:new t(A,"base64")).toString()}:function(A){return e(k(A))};var o=function(A){return x(String(A).replace(/[-_]/g,function(B){return B=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};var z=function(){var A=s.Base64;s.Base64=l;return A};s.Base64={VERSION:h,atob:k,btoa:n,fromBase64:o,toBase64:i,utob:j,encode:i,encodeURI:v,btou:e,decode:o,noConflict:z}})(a);a.encodeBase64=a.Base64.encode;a.decodeBase64=a.Base64.decode}(jQuery,window,window.easyforms));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/vendor/simpledateformat.js' */
(function(){function a(c,b){this.locale=(b&&(b=="es_US"||b=="en_CA"||b=="fr_CA"||b=="en_GB"||b=="en_AU"))?b:"en_US";this.applyPattern=function(d){this.pattern=d||((this.locale=="en_CA"||this.locale=="fr_CA"||this.locale=="en_GB"||this.locale=="en_AU")?"d/M/yy":"M/d/yy")};this.applyPattern(c);this.format=function(l){l=l||new Date();if(!(l instanceof Date)){var e=l.split("T")[0].split("-"),n=(l.split("T").length>1)?l.split("T")[1].split(".")[0].split("Z")[0].split("-")[0].split(":"):["00","00","00"];l=new Date(e[0],(e[1]-1),e[2],n[0],n[1],n[2])}var m=function(i){i=""+i;return(i.indexOf("0")==0&&i!="0")?i.substring(1):i},f=function(i){i=Number(i);return isNaN(i)?"00":(((i<10)?"0":"")+i)},p={month:f(l.getMonth()+1),date:f(l.getDate()),year:f(l.getFullYear()),day:l.getDay(),hour24:l.getHours(),hour12:l.getHours(),minutes:f(l.getMinutes()),ampm:"AM"};if(p.hour24>11){p.ampm="PM"}p.hour24=f(p.hour24);if(p.hour12==0){p.hour12=12}if(p.hour12>12){p.hour12=p.hour12-12}p.hour12=f(p.hour12);var h,q=function(s){var r=s.replace(/yy+(?=y)/g,"yy").replace(/MMM+(?=M)/g,"MMM").replace(/d+(?=d)/g,"d").replace(/EEE+(?=E)/g,"EEE").replace(/a+(?=a)/g,"").replace(/k+(?=k)/g,"k").replace(/h+(?=h)/g,"h").replace(/m+(?=m)/g,"m"),u=r.replace(/yyy/g,p.year).replace(/yy/g,p.year.substring(2)).replace(/y/g,p.year).replace(/dd/g,p.date).replace(/d/g,m(p.date)),t=function(A,v,w){for(var z=1;z<A.length;z++){if(!isNaN(A[z].substring(0,1))){var x=A[z].substring(0,2);A[z]=A[z].substring(2);if(isNaN(x.substring(1))){A[z]=x.substring(1)+A[z];x=x.substring(0,1)}x=Number(x);if(x>23){x=23}var y=(w=="+")?x:(0-x);if(v=="kk"||v=="k"){y=(Number(p.hour24)+y);if(y>24){y=y-24}else{if(y<0){y=y+24}}}else{if(v=="HH"){y=(Number(p.hour24)+y);if(y>23){y=y-24}else{if(y<0){y=y+24}}}else{y=(Number(p.hour12)+y);if(y>24){y=y-24}else{if(y<0){y=y+24}}if(y>12){y=y-12}}}y=""+y;if(v=="kk"||v=="hh"||v=="HH"){y=f(y)}if((v=="h"&&y==0)||(v=="hh"&&y=="00")){y="12"}A[z]=y+A[z]}}return A.join("")};if(u.indexOf("k+")!=-1){u=t(u.split("kk+"),"kk","+");u=t(u.split("k+"),"k","+")}if(u.indexOf("k-")!=-1){u=t(u.split("kk-"),"kk","-");u=t(u.split("k-"),"k","-")}u=u.replace(/kk/g,p.hour24).replace(/k/g,m(p.hour24));if(u.indexOf("H+")!=-1){u=t(u.split("HH+"),"HH","+")}if(u.indexOf("H-")!=-1){u=t(u.split("HH-"),"HH","-")}u=u.replace(/HH/g,p.hour24);if(u.indexOf("h+")!=-1){u=t(u.split("hh+"),"hh","+");u=t(u.split("h+"),"h","+")}if(u.indexOf("h-")!=-1){u=t(u.split("hh-"),"hh","-");u=t(u.split("h-"),"h","-")}u=u.replace(/hh/g,((p.hour12<12&&p.hour12.indexOf&&p.hour12.indexOf("0")!=0)?("0"+p.hour12):p.hour12)).replace(/h/g,m(p.hour12));u=u.replace(/mm/g,p.minutes).replace(/m/g,m(p.minutes));u=u.replace(/a/g,"A");var j=["January","February","march","april","may","June","July","august","September","October","November","December"];if(b=="es_US"){j=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]}if(b=="fr_CA"){j=["janvier","f&#233;vrier","mars","avril","mai","juin","juillet","ao&#251;t","septembre","octobre","novembre","d&#233;cembre"]}u=u.replace(/MMMM/g,j[Number(p.month)-1]).replace(/MMM/g,j[Number(p.month)-1].substring(0,3)).replace(/MM/g,p.month).replace(/M/g,m(p.month)).replace(/\bmar/g,"Mar").replace(/\bmay/g,"May").replace(/Mayo/g,"mayo");var i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];if(b=="es_US"){i=["domingo","lunes","martes","mi&eacute;rcoles","jueves","viernes","s&aacute;bado"]}if(b=="fr_CA"){i=["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]}u=u.replace(/EEEE/g,i[p.day]).replace(/EEE/g,i[p.day].substring(0,3)).replace(/EE/g,i[p.day].substring(0,3)).replace(/E/g,i[p.day].substring(0,3));u=u.replace(/A/g,p.ampm).replace(/\bapr/g,"Apr").replace(/\baug/g,"Aug");return u};if(this.pattern.indexOf("'")==-1){h=q(this.pattern)}else{var o=this.pattern.replace(/\'+(?=\')/g,"''").split("''");if(o.length==1){o=this.pattern.split("'");for(var k=0;k<o.length;k++){if(k%2==0){o[k]=q(o[k])}}return o.join("")}else{for(var k=0;k<o.length;k++){var d=o[k].split("'");for(var g=0;g<d.length;g++){if(g%2==0){d[g]=q(d[g])}}o[k]=d.join("")}return o.join("'")}}return h}}easyforms.dateFormat=a}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/form-controller.js' */
(function(d,c){var e=c.$;function b(g,h){var f=this;f.id=g.id;f.isWide=g.size==="wide";f.descriptor=h||{fields:[]};f.hasSubmitted=g.hasSubmitted;f.isSubmissionEditable=g.isSingleSubmit&&g.isSingleSubmitEditable;f.submissionReport=g.submissionReport;f.dateFormat=g.dateFormat;f.$el=e("#"+f.id);f.$el.find(".easyforms-edit").click(function(i){i.preventDefault();f.edit()});f.$el.find(".easyforms-save").click(function(i){i.preventDefault();f.save()});f.$el.find(".easyforms-cancel").click(function(i){i.preventDefault();f.cancel()})}var a=b.prototype;a.render=function(){var h=this;if(h.hasSubmitted){if(h.isSubmissionEditable&&h.submissionReport){var i=(new c.dateFormat(h.dateFormat));var f=i.format(new Date(h.submissionReport.rows[0].updated));h.$el.find(".easyforms-submitted-date").text(f);h.setMode("view-submitted")}else{h.setMode("submitted");return}}else{h.setMode("view")}var j=new c.FormRenderer(h);j.render(h.submissionReport);var g=e("#"+h.id+"-form");g.parsley();g.find("input[type=text]").keypress(function(k){if(k.which===13){return false}});g.submit(function(l){l.preventDefault();h.setActivity("waiting");var n={fields:g.serializeObject()};var m;var k="/forms/"+h.id+"/submissions";if(h.submissionReport){m="PUT";k+="/"+h.submissionReport.rows[0].id}else{m="POST"}e.ajax({type:m,url:c.restUrl(k),contentType:"application/json",data:JSON.stringify(n),dataType:"json"}).done(function(o){h.setActivity("idle");h.hasSubmitted=true;h.submissionReport=o;h.render()}).fail(function(q,o,p){h.setActivity("idle");h.showError(p,o,q)})})};a.showError=function(i,f,j){var g=this;var h=i.message||i||"Cause unknown";g.$el.find(".easyforms-error").show().find(".easyforms-error-message").text(h);AJS.logError("EasyForms: "+f," ",i," ",j)};a.hideError=function(){var f=this;f.$el.find(".easyforms-error").hide()};a.edit=function(){var g=this;g.setMode("edit");var f=new Formbuilder({selector:"#"+g.id+" .easyforms-formbuilder",bootstrapData:g.descriptor.fields});f.on("save",function(h){g.setPending(JSON.parse(h))})};a.save=function(){var f=this;if(!f.pending){return}f.setActivity("waiting");e.each(f.pending.fields,function(h,j){j.uid=j.uid||c.uid()});var g=JSON.stringify(f.pending);e.ajax({type:"PUT",url:c.restUrl("/forms/"+f.id),contentType:"application/json",data:g,dataType:"json"}).done(function(){f.setActivity("idle");f.commitPending();f.render()}).fail(function(j,h,i){f.setActivity("idle");f.showError(i,h,j)})};a.cancel=function(){var f=this;f.setPending(null);f.render()};a.commitPending=function(){var f=this;f.descriptor=f.pending;f.setPending(null)};a.setPending=function(g){var f=this;f.pending=g;this.$el.find(".easyforms-save").attr("aria-disabled",!g)};a.setActivity=function(f){if(f==="waiting"){}else{if(f==="idle"){}}};a.setMode=function(g){var f=this;f.hideError();if(g==="view"){f.$el.find(".easyforms-edit, .easyforms-view").show();f.$el.find(".easyforms-save, .easyforms-cancel, .easyforms-submitted, .easyforms-formbuilder").hide()}else{if(g==="submitted"){f.$el.find(".easyforms-edit, .easyforms-submitted").show();f.$el.find(".easyforms-save, .easyforms-cancel, .easyforms-view, .easyforms-formbuilder").hide()}else{if(g==="view-submitted"){f.$el.find(".easyforms-edit, .easyforms-view, .easyforms-submitted").show();f.$el.find(".easyforms-save, .easyforms-cancel, .easyforms-formbuilder").hide()}else{if(g==="edit"){f.$el.find(".easyforms-save, .easyforms-cancel, .easyforms-formbuilder").show();f.$el.find(".easyforms-edit, .easyforms-view, .easyforms-submitted").hide()}}}}};c.FormController=b}(window,window.easyforms));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/form-renderer.js' */
(function(d,c){var f=c.$;var a=c._.escape;function b(h){var g=this;g.form=h;g.$el=h.$el.find(".easyforms-form")}var e=b.prototype;e.elementId=function(g){return this.form.id+"-"+g};e.render=function(i){var h=this;var k=h.$el.parent().find(".easyforms-empty");var g=h.form.descriptor.fields;if(g.length===0){h.$el.hide().empty();k.show();return}k.hide();var j=[];h.renderFormBegin(j);h.renderFieldsetBegin(j);var l=h.getSubmission(i);f.each(g,function(){var o=this;var n="render"+o.field_type.charAt(0).toUpperCase()+o.field_type.slice(1);var m=h[n];if(m){m.call(h,j,o,l)}else{console.warn("Unknown field type: "+o.field_type)}});h.renderSubmit(j);h.$el.html(j.join("")).show()};e.getSubmission=function(g){if(g){var i={columns:{},fields:{}};f.each(g.columns,function(){i.columns[this.uid]=this});var h=g.rows[0];f.each(h.fields,function(){i.fields[this.uid]=this});return i}};e.renderFormBegin=function(h){var g=this;h.push('<form id="'+a(g.elementId("form"))+'" class="aui">')};e.renderFormEnd=function(g){g.push("</form>")};e.renderFieldsetBegin=function(g,h){g.push("<fieldset"+(h?' class="group"':"")+">")};e.renderFieldsetEnd=function(g){g.push("</fieldset>")};e.renderFieldGroupBegin=function(g){g.push('<div class="field-group">')};e.renderFieldGroupEnd=function(g){g.push("</div>")};e.renderSection=function(h,i){var g=this;g.renderFieldsetEnd(h);g.renderFieldsetBegin(h);h.push("<h3>"+a(i.label)+"</h3>");if(i.field_options.description){h.push("<div><small>"+a(i.field_options.description)+"</small></div>")}g.renderFieldsetEnd(h);g.renderFieldsetBegin(h)};e.renderLabel=function(i,k,h,j){var g=this;i.push('<label for="'+a(k)+'">');i.push(a(h));g.renderRequired(i,j);i.push("</label>")};e.renderRequired=function(g,h){if(h){g.push('<span class="aui-icon icon-required"></span>')}};e.renderLegend=function(i,h,j){var g=this;h=h||"";i.push("<legend>");i.push("<span>");i.push(a(h));g.renderRequired(i,j);i.push("</span>");i.push("</legend>")};e.renderDescription=function(h,g){if(g&&g.description){h.push('<div class="description">'+a(g.description)+"</div>")}};e.renderTextField=function(i,l,m,k,h,j){var g=this;m=m||"";var n=g.elementId(l.uid);g.renderFieldGroupBegin(i);g.renderLabel(i,n,l.label,l.required);i.push('<input class="text'+(!h?(g.form.isWide?" long-field":""):"")+'" type="text" id="'+a(n)+'" name="'+a(l.uid)+'" title="'+a(l.label)+'" placeholder="'+m+'" value="'+(j?j:"")+'"');g.renderTextValidations(i,l,n);i.push(">");if(k){i.push('&nbsp;<span class="easyforms-suffix">'+a(k)+"</span>")}g.renderErrorContainer(i,n);g.renderDescription(i,l.field_options);g.renderFieldGroupEnd(i)};e.renderText=function(h,j,k){var g=this;var i=g.getSubmissionValue(k,j.uid);g.renderTextField(h,j,"",null,false,i)};e.renderParagraph=function(h,j,l){var g=this;var k=g.elementId(j.uid);g.renderFieldGroupBegin(h);g.renderLabel(h,k,j.label,j.required);h.push('<textarea id="'+a(k)+'" class="textarea'+(g.form.isWide?" long-field":"")+'" rows="5" name="'+a(j.uid)+'" title="'+a(j.label)+'"');g.renderTextValidations(h,j,k);h.push(">");var i=g.getSubmissionValue(l,j.uid);if(i){h.push(i)}h.push("</textarea>");g.renderErrorContainer(h,k);g.renderDescription(h,j.field_options);g.renderFieldGroupEnd(h)};e.renderTextValidations=function(j,n,h){var o=this;o.renderBaseValidations(j,n,h);var g=n.field_options;var l=n.field_type;if(l==="website"){j.push(' data-parsley-type="url"')}else{if(l==="email"){j.push(' data-parsley-type="email"')}else{if(l==="number"){if(g.integer_only){j.push(' data-parsley-type="integer"')}else{j.push(' data-parsley-type="number"')}if(g.min!=null){j.push(' data-parsley-min="'+a(g.min)+'"')}if(g.max!=null){j.push(' data-parsley-min="'+a(g.max)+'"')}}else{if(l==="date"){}else{if(l==="time"){j.push(' data-parsley-pattern="\\d\\d:\\d\\d [AP]M"')}}}}}var k=g.min_max_length_units==="words"?"words":"length";var i=g.minlength>>>0;var m=g.maxlength>>>0;if(i||m){if(i){if(k!=="words"){j.push(' data-parsley-validation-threshold="'+a(i)+'"')}j.push(" data-parsley-min"+a(k)+'="'+a(i)+'" ')}if(m){j.push(" data-parsley-max"+a(k)+'="'+a(m)+'"')}}};e.renderBaseValidations=function(g,h,i){if(h.required){g.push(" required")}g.push(' data-parsley-trigger="keyup change"');g.push(' data-parsley-errors-container="#'+a(i)+'-errors"')};e.renderErrorContainer=function(g,i,h){g.push('<div class="easyforms-validation-errors'+(h?" easyforms-inline":"")+'" id="'+a(i)+'-errors"></div>')};e.getSubmissionValues=function(h,g){return(h&&h.fields[g]&&h.fields[g].values)||[]};e.getSubmissionValue=function(j,i){var h=this;var g=h.getSubmissionValues(j,i);return g[0]};e.renderWebsite=function(h,j,k){var g=this;var i=g.getSubmissionValue(k,j.uid);g.renderTextField(h,j,"http://example.com",null,false,i)};e.renderNumber=function(h,j,k){var g=this;var i=g.getSubmissionValue(k,j.uid);g.renderTextField(h,j,"",j.field_options.units,true,i)};e.renderEmail=function(h,j,k){var g=this;var i=g.getSubmissionValue(k,j.uid);g.renderTextField(h,j,"username@example.com",null,false,i)};e.renderDate=function(h,j,k){var g=this;var i=g.getSubmissionValue(k,j.uid);g.renderTextField(h,j,"YYYY-MM-DD",null,true,i);setTimeout(function(){AJS.$(g.$el.find("input[name="+j.uid+"]")[0]).datepicker()},9)};e.renderTime=function(h,j,k){var g=this;var i=g.getSubmissionValue(k,j.uid);g.renderTextField(h,j,"00:00 AM",null,true,i);setTimeout(function(){g.$el.find("input[name="+j.uid+"]").timepicker({closeOnWindowScroll:true,scrollDefault:"now",timeFormat:"h:i A",step:15})},9)};e.renderCheckboxes=function(j,l,n){var h=this;var g=h.getSubmissionValues(n,l.uid);var m={};f.each(g,function(){m[this]=true});h.renderFieldsetEnd(j);h.renderFieldsetBegin(j,true);h.renderLegend(j,l.label,l.required);var i=l.field_options.options;f.each(i,function(o,p){p=f.extend({},p);var q=a(p.label);if(m[q]){p.checked=true;delete m[q]}h.renderCheckboxesOption(j,l,p,o)});if(l.field_options.include_other_option){var k=_.keys(m);h.renderCheckboxesOption(j,l,{label:"Other",checked:k.length>0,input:true},i.length,k[0]||"")}h.renderErrorContainer(j,h.elementId(l.uid));h.renderDescription(j,l.field_options);h.renderFieldsetEnd(j);h.renderFieldsetBegin(j)};e.renderCheckboxesOption=function(k,m,j,l,i){var o=this;var g=m.uid+"-"+l+(j.input?"-cb-custom":"");var h=o.elementId(g);k.push('<div class="checkbox">');k.push('<input id="'+a(h)+'" class="checkbox" type="checkbox" name="'+a(g)+'"'+(j.checked?" checked":"")+' value="'+a(j.label)+'"');o.renderBaseValidations(k,m,o.elementId(m.uid));if(m.required){k.push(' data-parsley-multiple="'+a(m.uid)+'"')}k.push(">");k.push('<label for="'+a(h)+'">'+a(j.label)+"</label>");if(j.input){var n=j.checked&&i?i:"";k.push('<input size="'+(o.form.isWide?40:30)+'" type="text" class="easyforms-other" id="'+a(h)+'-value" name="'+a(g)+'-value" value="'+i+'">')}k.push("</div>")};e.renderRadio=function(j,l,m){var h=this;h.renderFieldsetEnd(j);h.renderFieldsetBegin(j,true);h.renderLegend(j,l.label,l.required);var k=h.getSubmissionValue(m,l.uid);var g=false;var i=l.field_options.options;f.each(i,function(n,o){o=f.extend({},o);if(k&&!g){o.checked=k===a(o.label);if(o.checked){g=true}}h.renderRadioOption(j,l,o,n)});if(l.field_options.include_other_option){h.renderRadioOption(j,l,{label:"Other",checked:!!k&&!g,input:true},i.length,k||"")}h.renderErrorContainer(j,h.elementId(l.uid));h.renderDescription(j,l.field_options);h.renderFieldsetEnd(j);h.renderFieldsetBegin(j)};e.renderRadioOption=function(k,m,j,l,i){var o=this;var g=m.uid+"-rb";var h=o.elementId(g+"-"+l);k.push('<div class="radio">');k.push('<input id="'+a(h)+'" class="radio" type="radio" name="'+a(g)+'"'+(j.checked?" checked":"")+' value="'+a(j.label)+'"');o.renderBaseValidations(k,m,o.elementId(m.uid));if(m.required){k.push(' data-parsley-multiple="'+a(m.uid)+'"')}k.push(">");k.push('<label for="'+a(h)+'">'+a(j.label)+"</label>");if(j.input){var n=j.checked&&i?i:"";k.push('<input size="'+(o.form.isWide?40:30)+'" type="text" class="easyforms-other" id="'+a(h)+'-custom-value" name="'+a(g)+'-custom-value" value="'+n+'">')}k.push("</div>")};e.renderDropdown=function(i,k,m){var g=this;var l=g.elementId(k.uid);g.renderFieldGroupBegin(i);g.renderLabel(i,l,k.label,k.required);i.push('<select id="'+a(l)+'" class="select'+(g.form.isWide?" long-field":"")+'" name="'+a(k.uid)+'" title="'+a(k.label)+'">');if(k.field_options.include_blank_option){g.renderDropdownOption(i,{label:"",checked:false})}var h=k.field_options.options;var j=g.getSubmissionValue(m,k.uid);f.each(h,function(n,o){o=f.extend({},o);if(j){o.checked=j===a(o.label)}g.renderDropdownOption(i,o)});i.push("</select>");g.renderDescription(i,k.field_options);g.renderFieldGroupEnd(i)};e.renderDropdownOption=function(g,h){g.push("<option"+(h.checked?" selected":"")+">"+a(h.label)+"</option>")};e.renderAddress=function(i,j,l){var h=this;var k=h.elementId(j.uid);var g=h.getSubmissionValues(l,j.uid);h.renderFieldGroupBegin(i);h.renderLabel(i,"",j.label,j.required);i.push('<input class="text'+(h.form.isWide?" long-field":"")+'" type="text" id="'+a(k)+'-street" name="'+a(j.uid)+'-street" placeholder="Street"');if(g[0]){i.push(' value="'+g[0]+'"')}h.renderBaseValidations(i,j,k+"-street");i.push(">");h.renderErrorContainer(i,k+"-street");h.renderFieldGroupEnd(i);h.renderFieldGroupBegin(i);h.renderLabel(i,"","");i.push('<input class="text'+(h.form.isWide?" easyforms-inline":"")+'" type="text" id="'+a(k)+'-city" name="'+a(j.uid)+'-city" placeholder="City"');if(g[1]){i.push(' value="'+g[1]+'"')}h.renderBaseValidations(i,j,k+"-city");i.push(">");if(!h.form.isWide){h.renderErrorContainer(i,k+"-city");h.renderFieldGroupEnd(i);h.renderFieldGroupBegin(i);h.renderLabel(i,"","")}i.push('<input class="text'+(h.form.isWide?" easyforms-inline":"")+'" type="text" id="'+a(k)+'-state" name="'+a(j.uid)+'-state" placeholder="State"');if(g[2]){i.push(' value="'+g[2]+'"')}h.renderBaseValidations(i,j,k+"-state");i.push(">");if(!h.form.isWide){h.renderErrorContainer(i,k+"-state")}else{i.push('<div class="easyforms-inline-wrapper">');h.renderErrorContainer(i,k+"-city",true);h.renderErrorContainer(i,k+"-state",true);i.push("</div>")}h.renderFieldGroupEnd(i);h.renderFieldGroupBegin(i);h.renderLabel(i,"","");i.push('<input class="text'+(h.form.isWide?" easyforms-inline":"")+'" type="text" id="'+a(k)+'-zip" name="'+a(j.uid)+'-zip" placeholder="Zip"');if(g[3]){i.push(' value="'+g[3]+'"')}h.renderBaseValidations(i,j,k+"-zip");i.push(">");if(!h.form.isWide){h.renderErrorContainer(i,k+"-zip");h.renderFieldGroupEnd(i);h.renderFieldGroupBegin(i);h.renderLabel(i,"","")}i.push('<select class="select'+(h.form.isWide?" easyforms-inline":"")+'" id="'+a(k)+'-country" name="'+a(j.uid)+'-country">');f.each(c.countries,function(){var m=g[4]===this.name||(!g[4]&&this.code==="US");i.push("<option"+(m?" selected":"")+">"+this.name+"</option>")});i.push("</select>");h.renderErrorContainer(i,k+"-zip");h.renderDescription(i,j.field_options);h.renderFieldGroupEnd(i)};e.renderSubmit=function(g){g.push('<div class="buttons-container">');g.push('<div class="buttons">');g.push('<input class="button submit" type="submit" value="Submit">');g.push("</div>");g.push("</div>")};f.fn.serializeObject=function(){var h={};var g=this.serializeArray();f.each(g,function(){if(h[this.name]!==undefined){if(!h[this.name].push){h[this.name]=[h[this.name]]}h[this.name].push(this.value||"")}else{h[this.name]=this.value||""}});return h};c.FormRenderer=b}(window,window.easyforms));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/form-reporter.js' */
(function(c,b){var d=b.$;d.fn.dataTableExt.sErrMode="throw";function e(h,f){var g=this;g.id=h.id;g.config=h;g.report=f;g.$el=d("#"+g.id+"-report");g.$table=g.$el.find(".easyforms-report");g.$export=g.$el.find(".easyforms-export");g.$el.delegate(".easyforms-row-delete","click",g,g.deleteRow)}var a=e.prototype;a.render=function(){var f=this;var h=f.extractTableColumns();var j=f.extractTableData();if(h.length==0){f.$el.find(".easyforms-report-undefined").show();return}if(j.length==0){f.$el.find(".easyforms-report-empty").show();return}f.$el.find(".easyforms-report-view").show();f.$table.dataTable({columns:h,data:j});var g=AJS.Meta.get("context-path");var i=g+"/rest/easyform/1.0/forms/"+f.id+"/report?download=true&format=";f.$export.html("Export as: &nbsp;"+d.map(["json","xml","xls","csv"],function(l){var k=l.toUpperCase();return'<a href="'+i+l+'" target="_blank">'+k+"</a>"}).join(" | "))};a.extractTableColumns=function(){var f=this;return d.map(f.report.columns,function(g){return{title:g.title}}).concat([{title:"Created"},{title:"Updated"},{title:"User"},{title:"Actions",className:"easyforms-column-right",orderable:"false"}])};a.extractTableData=function(){var f=this;var h={};d.each(f.report.columns,function(j,k){h[k.uid]=k});var g=(new b.dateFormat(f.config.dateFormat));return d.map(f.report.rows,function(i){return[d.map(i.fields,function(j){return d.map(j.values,function(l){if(l){var k=h[j.uid].type;if(k==="website"){l='<a href="'+l+'" target="_blank">'+l+"</a>"}else{if(k==="email"){l='<a href="mailto:'+l+'">'+l+"</a>"}}return l}return null}).join(", ")}).concat([g.format(new Date(i.created)),g.format(new Date(i.updated)),(i.userName||"Anonymous"),'<a href="" class="easyforms-row-delete" data-row-id="'+i.id+'">Delete</a>'])]})};a.deleteRow=function(h){var f=h.data;h.preventDefault();var g=d(h.currentTarget).data("row-id");if(confirm("Are you sure you want to delete this row?")){f.setActivity("waiting");var i=f.$table.api().row(d(this).parents("tr"));d.ajax({type:"DELETE",url:b.restUrl("/forms/"+f.id+"/submissions/"+g)}).done(function(){f.setActivity("idle");i.remove().draw()}).fail(function(l,j,k){f.setActivity("idle");f.showError(k,j,l)})}};a.setActivity=function(g){var f=this;if(g==="waiting"){f.$table.mask("")}else{if(g==="idle"){f.$table.unmask()}}};a.showError=function(g,f,h){console.error(g,f,h)};b.FormReporter=e}(window,easyforms));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.artemissoftware.confluence.easyforms.EasyForms:easyforms-resources', location = 'assets/countries.js' */
(function(b){var a=b.easyforms;a.countries=[{name:"Afghanistan",code:"AF"},{name:"Aland Islands",code:"AX"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"American Samoa",code:"AS"},{name:"Andorra",code:"AD"},{name:"Angola",code:"AO"},{name:"Anguilla",code:"AI"},{name:"Antarctica",code:"AQ"},{name:"Antigua and Barbuda",code:"AG"},{name:"Argentina",code:"AR"},{name:"Armenia",code:"AM"},{name:"Aruba",code:"AW"},{name:"Australia",code:"AU"},{name:"Austria",code:"AT"},{name:"Azerbaijan",code:"AZ"},{name:"Bahamas",code:"BS"},{name:"Bahrain",code:"BH"},{name:"Bangladesh",code:"BD"},{name:"Barbados",code:"BB"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE"},{name:"Belize",code:"BZ"},{name:"Benin",code:"BJ"},{name:"Bermuda",code:"BM"},{name:"Bhutan",code:"BT"},{name:"Bolivia",code:"BO"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Botswana",code:"BW"},{name:"Bouvet Island",code:"BV"},{name:"Brazil",code:"BR"},{name:"British Indian Ocean Territory",code:"IO"},{name:"Brunei Darussalam",code:"BN"},{name:"Bulgaria",code:"BG"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cambodia",code:"KH"},{name:"Cameroon",code:"CM"},{name:"Canada",code:"CA"},{name:"Cape Verde",code:"CV"},{name:"Cayman Islands",code:"KY"},{name:"Central African Republic",code:"CF"},{name:"Chad",code:"TD"},{name:"Chile",code:"CL"},{name:"China",code:"CN"},{name:"Christmas Island",code:"CX"},{name:"Cocos (Keeling) Islands",code:"CC"},{name:"Colombia",code:"CO"},{name:"Comoros",code:"KM"},{name:"Congo",code:"CG"},{name:"Congo, The Democratic Republic of the",code:"CD"},{name:"Cook Islands",code:"CK"},{name:"Costa Rica",code:"CR"},{name:"Cote D'Ivoire",code:"CI"},{name:"Croatia",code:"HR"},{name:"Cuba",code:"CU"},{name:"Cyprus",code:"CY"},{name:"Czech Republic",code:"CZ"},{name:"Denmark",code:"DK"},{name:"Djibouti",code:"DJ"},{name:"Dominica",code:"DM"},{name:"Dominican Republic",code:"DO"},{name:"Ecuador",code:"EC"},{name:"Egypt",code:"EG"},{name:"El Salvador",code:"SV"},{name:"Equatorial Guinea",code:"GQ"},{name:"Eritrea",code:"ER"},{name:"Estonia",code:"EE"},{name:"Ethiopia",code:"ET"},{name:"Falkland Islands (Malvinas)",code:"FK"},{name:"Faroe Islands",code:"FO"},{name:"Fiji",code:"FJ"},{name:"Finland",code:"FI"},{name:"France",code:"FR"},{name:"French Guiana",code:"GF"},{name:"French Polynesia",code:"PF"},{name:"French Southern Territories",code:"TF"},{name:"Gabon",code:"GA"},{name:"Gambia",code:"GM"},{name:"Georgia",code:"GE"},{name:"Germany",code:"DE"},{name:"Ghana",code:"GH"},{name:"Gibraltar",code:"GI"},{name:"Greece",code:"GR"},{name:"Greenland",code:"GL"},{name:"Grenada",code:"GD"},{name:"Guadeloupe",code:"GP"},{name:"Guam",code:"GU"},{name:"Guatemala",code:"GT"},{name:"Guernsey",code:"GG"},{name:"Guinea",code:"GN"},{name:"Guinea-Bissau",code:"GW"},{name:"Guyana",code:"GY"},{name:"Haiti",code:"HT"},{name:"Heard Island and Mcdonald Islands",code:"HM"},{name:"Holy See (Vatican City State)",code:"VA"},{name:"Honduras",code:"HN"},{name:"Hong Kong",code:"HK"},{name:"Hungary",code:"HU"},{name:"Iceland",code:"IS"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Iran, Islamic Republic Of",code:"IR"},{name:"Iraq",code:"IQ"},{name:"Ireland",code:"IE"},{name:"Isle of Man",code:"IM"},{name:"Israel",code:"IL"},{name:"Italy",code:"IT"},{name:"Jamaica",code:"JM"},{name:"Japan",code:"JP"},{name:"Jersey",code:"JE"},{name:"Jordan",code:"JO"},{name:"Kazakhstan",code:"KZ"},{name:"Kenya",code:"KE"},{name:"Kiribati",code:"KI"},{name:"Korea, Democratic People'S Republic of",code:"KP"},{name:"Korea, Republic of",code:"KR"},{name:"Kuwait",code:"KW"},{name:"Kyrgyzstan",code:"KG"},{name:"Lao People's Democratic Republic",code:"LA"},{name:"Latvia",code:"LV"},{name:"Lebanon",code:"LB"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libyan Arab Jamahiriya",code:"LY"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT"},{name:"Luxembourg",code:"LU"},{name:"Macao",code:"MO"},{name:"Macedonia, The Former Yugoslav Republic of",code:"MK"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Malaysia",code:"MY"},{name:"Maldives",code:"MV"},{name:"Mali",code:"ML"},{name:"Malta",code:"MT"},{name:"Marshall Islands",code:"MH"},{name:"Martinique",code:"MQ"},{name:"Mauritania",code:"MR"},{name:"Mauritius",code:"MU"},{name:"Mayotte",code:"YT"},{name:"Mexico",code:"MX"},{name:"Micronesia, Federated States of",code:"FM"},{name:"Moldova, Republic of",code:"MD"},{name:"Monaco",code:"MC"},{name:"Mongolia",code:"MN"},{name:"Montserrat",code:"MS"},{name:"Morocco",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Myanmar",code:"MM"},{name:"Namibia",code:"NA"},{name:"Nauru",code:"NR"},{name:"Nepal",code:"NP"},{name:"Netherlands",code:"NL"},{name:"Netherlands Antilles",code:"AN"},{name:"New Caledonia",code:"NC"},{name:"New Zealand",code:"NZ"},{name:"Nicaragua",code:"NI"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Niue",code:"NU"},{name:"Norfolk Island",code:"NF"},{name:"Northern Mariana Islands",code:"MP"},{name:"Norway",code:"NO"},{name:"Oman",code:"OM"},{name:"Pakistan",code:"PK"},{name:"Palau",code:"PW"},{name:"Palestinian Territory, Occupied",code:"PS"},{name:"Panama",code:"PA"},{name:"Papua New Guinea",code:"PG"},{name:"Paraguay",code:"PY"},{name:"Peru",code:"PE"},{name:"Philippines",code:"PH"},{name:"Pitcairn",code:"PN"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Puerto Rico",code:"PR"},{name:"Qatar",code:"QA"},{name:"Reunion",code:"RE"},{name:"Romania",code:"RO"},{name:"Russian Federation",code:"RU"},{name:"RWANDA",code:"RW"},{name:"Saint Helena",code:"SH"},{name:"Saint Kitts and Nevis",code:"KN"},{name:"Saint Lucia",code:"LC"},{name:"Saint Pierre and Miquelon",code:"PM"},{name:"Saint Vincent and the Grenadines",code:"VC"},{name:"Samoa",code:"WS"},{name:"San Marino",code:"SM"},{name:"Sao Tome and Principe",code:"ST"},{name:"Saudi Arabia",code:"SA"},{name:"Senegal",code:"SN"},{name:"Serbia and Montenegro",code:"CS"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Singapore",code:"SG"},{name:"Slovakia",code:"SK"},{name:"Slovenia",code:"SI"},{name:"Solomon Islands",code:"SB"},{name:"Somalia",code:"SO"},{name:"South Africa",code:"ZA"},{name:"South Georgia and the South Sandwich Islands",code:"GS"},{name:"Spain",code:"ES"},{name:"Sri Lanka",code:"LK"},{name:"Sudan",code:"SD"},{name:"Suriname",code:"SR"},{name:"Svalbard and Jan Mayen",code:"SJ"},{name:"Swaziland",code:"SZ"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Syrian Arab Republic",code:"SY"},{name:"Taiwan, Province of China",code:"TW"},{name:"Tajikistan",code:"TJ"},{name:"Tanzania, United Republic of",code:"TZ"},{name:"Thailand",code:"TH"},{name:"Timor-Leste",code:"TL"},{name:"Togo",code:"TG"},{name:"Tokelau",code:"TK"},{name:"Tonga",code:"TO"},{name:"Trinidad and Tobago",code:"TT"},{name:"Tunisia",code:"TN"},{name:"Turkey",code:"TR"},{name:"Turkmenistan",code:"TM"},{name:"Turks and Caicos Islands",code:"TC"},{name:"Tuvalu",code:"TV"},{name:"Uganda",code:"UG"},{name:"Ukraine",code:"UA"},{name:"United Arab Emirates",code:"AE"},{name:"United Kingdom",code:"GB"},{name:"United States",code:"US"},{name:"United States Minor Outlying Islands",code:"UM"},{name:"Uruguay",code:"UY"},{name:"Uzbekistan",code:"UZ"},{name:"Vanuatu",code:"VU"},{name:"Venezuela",code:"VE"},{name:"Viet Nam",code:"VN"},{name:"Virgin Islands, British",code:"VG"},{name:"Virgin Islands, U.S.",code:"VI"},{name:"Wallis and Futuna",code:"WF"},{name:"Western Sahara",code:"EH"},{name:"Yemen",code:"YE"},{name:"Zambia",code:"ZM"},{name:"Zimbabwe",code:"ZW"}]}(this));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-amd-resources', location = '/js/amd/confluence-amd.js' */
define("confluence",function(){return Confluence});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-amd-resources', location = '/js/amd/tinymce-amd.js' */
define("tinymce",function(){return tinymce});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:common', location = '/js/view-file-macro-utils.js' */
define("vfm/view-file-macro-utils",[],function(){var a={DEFAULT_HEIGHT:"250",DEFAULT_HEIGHT_IN_COMMENT:"150",THUMBNAIL_STATUS_IN_PROGRESS:202,THUMBNAIL_STATUS_CONVERTED:200,THUMBNAIL_STATUS_ERROR:415,THUMBNAIL_STATUS_BUSY:429,THUMBNAIL_POLLING_PERIOD:1000,THUMBNAIL_POLLING_BACKOFF_RATIO:1.25,MAP_NICE_TYPE_TO_TEXT:{"pdf document":"PDF","word document":"Document","excel spreadsheet":"Spreadsheet","powerpoint presentation":"Presentation","generic file":"File"},getFileNameFromUrl:function(b){if(!b){return""}var c=b.indexOf("#");c=(c>=0)?c:b.length;b=b.substring(0,c);c=b.indexOf("?");c=(c>=0)?c:b.length;b=b.substring(0,c);c=b.lastIndexOf("/");b=b.substring(c+1,b.length);return decodeURIComponent(b)},isSupportPointerEvents:function(){var b=document.createElement("x");b.style.cssText="pointer-events:auto";return b.style.pointerEvents==="auto"},getParameterByName:function(d,c){var e=d.indexOf("#");if(e>=0){d=d.substring(0,e)}var b=new RegExp(c+"=([^&]*)","i").exec(d);return b?decodeURIComponent(b[1]):null},addParamsToUrl:function(b,h){var f="";if(b.indexOf("?")===-1){f="?"}else{f="&"}var e=Object.keys(h);for(var d=0;d<e.length;d++){var c=e[d];var g=h[c];if(d>0){f+="&"}f+=c+"="+g}return b+f},getFileTypeTextFromNiceType:function(b){b=b?b.toLowerCase():"";return this.MAP_NICE_TYPE_TO_TEXT[b]?this.MAP_NICE_TYPE_TO_TEXT[b]:b}};return a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:common', location = '/js/services/conversion-service.js' */
define("vfm/services/conversion-service",["ajs","jquery"],function(a,b){return{postThumbnailConversionResults:function(c){var d=a.contextPath()+"/rest/documentConversion/latest/conversion/thumbnail/results";var e=Object.keys(c);var f=_.map(e,function(g){return{id:g,v:c[g].version}});return b.ajax({type:"POST",url:d,contentType:"application/json",data:JSON.stringify(f)})},getThumbnailUrl:function(d,c){return a.contextPath()+"/rest/documentConversion/latest/conversion/thumbnail/"+d+"/"+c}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:file-types-utils-resources', location = 'utils/file-types-utils.js' */
define("confluence-editor/utils/file-types-utils",[],function(){var e={"aui-iconfont-file-image":"image/gif image/jpeg image/pjpeg image/png image/tiff image/bmp".split(" "),"aui-iconfont-file-pdf":["application/pdf"],"aui-iconfont-file-video":"audio/mpeg audio/x-wav audio/mp3 audio/mp4 video/mpeg video/quicktime video/mp4 video/x-m4v video/x-flv video/x-ms-wmv video/avi video/webm video/vnd.rn-realvideo".split(" "),"aui-iconfont-file-code":"text/html text/xml text/javascript application/javascript application/x-javascript text/css text/x-java-source".split(" "),
"aui-iconfont-file-doc":["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],"aui-iconfont-file-xls":["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],"aui-iconfont-file-ppt":["application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"],"aui-iconfont-file-txt":["text/plain"],"aui-iconfont-file-zip":["application/zip","application/java-archive"]},b={},c;for(c in e)for(var f=
e[c],d=0,g=f.length;d<g;d++)b[f[d]]=c;return{getAUIIconFromMime:function(a){return b[a]||"aui-iconfont-file-generic"},isImage:function(a){return b[a]&&0===a.indexOf("image/")}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/utils/file-types-utils","AJS.Confluence.FileTypesUtils");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-embedded-file-view-soy-resources', location = '/templates/embedded-file-view.soy' */
// This file was automatically generated from embedded-file-view.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.ViewFileMacro.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.ViewFileMacro == 'undefined') { Confluence.ViewFileMacro = {}; }
if (typeof Confluence.ViewFileMacro.Templates == 'undefined') { Confluence.ViewFileMacro.Templates = {}; }


Confluence.ViewFileMacro.Templates.embeddedFile = function(opt_data, opt_ignored) {
  return '<span class="confluence-embedded-file-wrapper"><a class="confluence-embedded-file" href="' + soy.$$escapeHtml(opt_data.fileSrc) + '" data-nice-type="' + soy.$$escapeHtml(opt_data.niceType) + '" data-file-src="' + soy.$$escapeHtml(opt_data.fileSrc) + '" data-linked-resource-id="' + soy.$$escapeHtml(opt_data.attachmentId) + '" data-linked-resource-type="attachment" data-linked-resource-container-id="' + soy.$$escapeHtml(opt_data.containerId) + '" data-linked-resource-default-alias="' + soy.$$escapeHtml(opt_data.fileName) + '" data-mime-type="' + soy.$$escapeHtml(opt_data.mimeType) + '" data-has-thumbnail="' + ((opt_data.hasThumbnail) ? 'true' : 'false') + '" data-linked-resource-version="' + soy.$$escapeHtml(opt_data.attachmentVersion) + '"' + ((opt_data.unresolvedCommentCount && opt_data.unresolvedCommentCount >= 0) ? 'data-unresolved-comment-count=' + soy.$$escapeHtml(opt_data.unresolvedCommentCount) : '') + '><img src="' + soy.$$escapeHtml(opt_data.placeholderSrc) + '" height="' + soy.$$escapeHtml(opt_data.height) + '" />' + ((! opt_data.hasThumbnail) ? '<span class="title">' + soy.$$escapeHtml(opt_data.fileName) + '</span>' : '') + '</a></span>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.embeddedFile.soyTemplateName = 'Confluence.ViewFileMacro.Templates.embeddedFile';
}


Confluence.ViewFileMacro.Templates.embeddedUnknownFile = function(opt_data, opt_ignored) {
  return '<span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-file unknown-attachment" src="' + soy.$$escapeHtml(opt_data.placeholderSrc) + '" /></span>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.embeddedUnknownFile.soyTemplateName = 'Confluence.ViewFileMacro.Templates.embeddedUnknownFile';
}


Confluence.ViewFileMacro.Templates.overlayEmbeddedFile = function(opt_data, opt_ignored) {
  return '<span class="overlay"></span>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.overlayEmbeddedFile.soyTemplateName = 'Confluence.ViewFileMacro.Templates.overlayEmbeddedFile';
}


Confluence.ViewFileMacro.Templates.overlayEmbeddedFileCommentCount = function(opt_data, opt_ignored) {
  return '<span class="comment-count-overlay"><span class="content">' + soy.$$escapeHtml(opt_data.commentCountRep) + '</span></span>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.overlayEmbeddedFileCommentCount.soyTemplateName = 'Confluence.ViewFileMacro.Templates.overlayEmbeddedFileCommentCount';
}


Confluence.ViewFileMacro.Templates.overlayEmbeddedFileFileTypeDesc = function(opt_data, opt_ignored) {
  return '<span class="file-type-desc-overlay"><i class="aui-icon aui-icon-small ' + soy.$$escapeHtml(opt_data.iconClass) + '"></i><span class="content"> ' + soy.$$escapeHtml(opt_data.fileType) + '</span></span>';
};
if (goog.DEBUG) {
  Confluence.ViewFileMacro.Templates.overlayEmbeddedFileFileTypeDesc.soyTemplateName = 'Confluence.ViewFileMacro.Templates.overlayEmbeddedFileFileTypeDesc';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-embedded-file-view-resources', location = '/js/services/file-service.js' */
define("vfm/services/file-service",["ajs","jquery"],function(a,b){return{getCommentCount:function(c,e){var d="/rest/files/1.0/files/content/{0}/commentCount?attachmentId={1}";d=a.contextPath()+a.format(d,c,e);return b.get(d)}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-embedded-file-view-resources', location = '/js/components/embedded-file-view.js' */
define("vfm/components/embedded-file-view",["jquery","backbone","ajs","confluence","vfm/view-file-macro-utils"],function(c,g,f,h,i){function b(s){var r=c(s.el);var q=r.find(".confluence-embedded-image, .confluence-embedded-file");if(q.hasClass("unknown-attachment")||(q.attr("src")&&q.attr("src").indexOf("/confluence/plugins/servlet/confluence/placeholder/unknown-attachment")>=0)){return this}var j={mimeType:"",niceType:""};var k=q.hasClass("confluence-embedded-image");var o=r.parent().is("a");var m=q.attr("data-has-thumbnail")==="true";if(k){j.mimeType="image/png"}else{j.mimeType=q.attr("data-mime-type");j.niceType=q.attr("data-nice-type")!=="null"?q.attr("data-nice-type"):"generic file"}var p=!o?e(q):"";var l=(!k&&m)?a(j):"";if(p||l){var n=h.ViewFileMacro.Templates.overlayEmbeddedFile();r.append(c(n).append(p).append(l));if(l){r.addClass("has-comment-overlay")}}}var d=function(j){j=parseInt(j,10);j=c.isNumeric(j)?j:0;return j>9?"9+":j+""};var e=function(o){var j="",k=o.attr("data-linked-resource-container-id"),m=o.attr("data-linked-resource-id");if(k&&m){var n=o.attr("data-unresolved-comment-count");var l=d(n);if(l!=="0"){j=h.ViewFileMacro.Templates.overlayEmbeddedFileCommentCount({commentCountRep:l})}}return j};var a=function(j){return h.ViewFileMacro.Templates.overlayEmbeddedFileFileTypeDesc({fileType:i.getFileTypeTextFromNiceType(j.niceType),iconClass:f.Confluence.FileTypesUtils.getAUIIconFromMime(j.mimeType)})};return{render:b}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-resources', location = '/js/vfm.js' */
require(["jquery","ajs","vfm/components/embedded-file-view"],function(c,a,b){c(document).on("click",".confluence-embedded-file.unknown-attachment",function(d){d.preventDefault()});a.toInit(function(){c(".confluence-embedded-file-wrapper").each(function(){b.render({el:this})})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:ajs-amd', location = 'lib/amd/ajs-amd.js' */
define("ajs",function(){return AJS});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:wrm-amd', location = 'lib/amd/wrm-amd.js' */
define("wrm/context-path",function(){return AJS.contextPath});define("wrm/data",function(){var a=function(){};if(WRM){if(typeof WRM.data==="function"){a=WRM.data}else{if(WRM.data&&typeof WRM.data.claim==="function"){a=WRM.data.claim}}}return{claim:a}});define("wrm",function(){if(WRM.data instanceof Function){WRM.data.claim=WRM.data}return WRM});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:backbone-amd', location = 'lib/amd/backbone-amd.js' */
define("backbone",function(){return Backbone});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:jquery-amd', location = 'lib/amd/jquery-amd.js' */
define("jquery",function(){return AJS.$});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:underscore-amd', location = 'lib/amd/underscore-amd.js' */
define("underscore",function(){return _});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:discovery-javascript-data', location = 'discovery/hipChatDiscovery.js' */
define("confluence/hipchat/integration/hipchat/discovery",["wrm/data"],function(a){var b="com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin";var c=b+":discovery-javascript-data.link-active";var d=a.claim(c);return{isLinked:function(){return d.linkActive===true},isConditionsMet:function(){return d.conditionsMet===true},isAdmin:function(){return d.admin===true},pluginKey:function(){return b}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:discovery-javascript-data', location = 'discovery/discoveryPopup.js' */
define("confluence/hipchat/integration/hipchat/discovery/popup",["jquery"],function(a){return{show:function(g){var c,b;var h=g.featureKey;if(g.shouldShow()&&Confluence.FeatureDiscovery){b=Confluence.FeatureDiscovery.forPlugin(g.pluginKey);c=b.shouldShow(g.featureKey,true)}else{c=false}if(c){AJS.trigger("analyticsEvent",{name:g.analytics+".view",data:{}});b&&b.addDiscoveryView(h);var d;var e=function(){b&&b.markDiscovered(h);d.hide();AJS.trigger("analyticsEvent",{name:g.analytics+".accept",data:{}});if(a.isFunction(g.onAccept)){g.onAccept()}};var f=function(i){return function(j){j.preventDefault();b&&b.markDiscovered(h);d.hide();i.parent().remove();AJS.trigger("analyticsEvent",{name:g.analytics+".dismiss",data:{}});if(a.isFunction(g.onDismiss)){g.onDismiss()}}};d=AJS.InlineDialog(g.target,g.name,function(k,i,l){k.html(g.template({}));l();var j=k.parent();j.addClass("hipchat-integration-discovery");if(g.fixed===true){j.addClass("hipchat-integration-discovery-fixed")}k.find("#hipchat-integration-discovery-open").click(e);k.find("#hipchat-integration-discovery-dismiss").click(f(k))},{noBind:true});d.show();if(g.fixed===true){a(window).resize(function(){d.refresh()})}}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:discovery-resources', location = 'discovery/integrationDiscovery.soy' */
// This file was automatically generated from integrationDiscovery.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Hipchat.Discovery.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Hipchat == 'undefined') { Confluence.Templates.Hipchat = {}; }
if (typeof Confluence.Templates.Hipchat.Discovery == 'undefined') { Confluence.Templates.Hipchat.Discovery = {}; }


Confluence.Templates.Hipchat.Discovery.integrationDialog = function(opt_data, opt_ignored) {
  return '<h2>' + soy.$$escapeHtml("Connect your Confluence site to HipChat") + '</h2><p>' + soy.$$escapeHtml("Set up and send notifications to HipChat rooms.") + '</p><br/><button class="aui-button" id="hipchat-integration-discovery-open">' + soy.$$escapeHtml("Integrate with HipChat") + '</button><a href="#" style="padding-left: 20px" id="hipchat-integration-discovery-dismiss">' + soy.$$escapeHtml("Not now") + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Hipchat.Discovery.integrationDialog.soyTemplateName = 'Confluence.Templates.Hipchat.Discovery.integrationDialog';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:hipChatServerDiscovery', location = 'discovery/integrationDiscovery.js' */
require(["jquery","confluence/hipchat/integration/hipchat/discovery","confluence/hipchat/integration/hipchat/discovery/popup"],function(c,b,a){c(function(){var d=AJS.contextPath()+"/plugins/servlet/hipchat/configure";a.show({featureKey:"hipChatServerIntegration",pluginKey:b.pluginKey(),analytics:"notifications.hipchat.discovery",template:Confluence.Templates.Hipchat.Discovery.integrationDialog,name:"hipchat-integration-dialog",target:c("#admin-menu-link"),shouldShow:function(){return !b.isLinked()&&b.isConditionsMet()&&b.isAdmin()},onAccept:function(){window.location.assign(d)},onDismiss:function(){},fixed:false})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:hipchat-presence-resources', location = 'presence/presence.soy' */
// This file was automatically generated from presence.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.HipChat.Presence.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.HipChat == 'undefined') { Confluence.Templates.HipChat = {}; }
if (typeof Confluence.Templates.HipChat.Presence == 'undefined') { Confluence.Templates.HipChat.Presence = {}; }


Confluence.Templates.HipChat.Presence.badge = function(opt_data, opt_ignored) {
  return '<span class="hipchat-status aui-icon aui-icon-small hipchat-icon-' + soy.$$escapeHtml(opt_data.statusCode) + '" data-status="' + soy.$$escapeHtml(opt_data.statusCode) + '" title="' + soy.$$escapeHtml(opt_data.statusMessage) + '">' + soy.$$escapeHtml(opt_data.statusMessage) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChat.Presence.badge.soyTemplateName = 'Confluence.Templates.HipChat.Presence.badge';
}


Confluence.Templates.HipChat.Presence.chatBar = function(opt_data, opt_ignored) {
  return '<div class="hipchat-chatbar aui-buttons"><button class="aui-button hipchat-chat" title="' + soy.$$escapeHtml("Unable to start chat as this user is not known in HipChat.") + '" aria-disabled="true"><span><span class="aui-icon aui-icon-small hipchat-icon-chat">' + soy.$$escapeHtml("Chat") + '</span></span></button><button class="aui-button hipchat-voice" title="' + soy.$$escapeHtml("Unable to start voice calls as this user is not known in HipChat.") + '" aria-disabled="true" data-call-type="voice"><span><span class="aui-icon aui-icon-small hipchat-icon-voice">' + soy.$$escapeHtml("Voice") + '</span></span></button><button class="aui-button hipchat-video" title="' + soy.$$escapeHtml("Unable to start video calls as this user is not known in HipChat.") + '" aria-disabled="true" data-call-type="video"><span><span class="aui-icon aui-icon-small hipchat-icon-video">' + soy.$$escapeHtml("Video") + '</span></span></button></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.HipChat.Presence.chatBar.soyTemplateName = 'Confluence.Templates.HipChat.Presence.chatBar';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:hipchat-presence-resources', location = 'presence/presence.js' */
(function(d){var f=AJS.DarkFeatures.isEnabled("hipchat.chatbar");var a={hipChatCall:function(g,h){if(!g){return}return"hipchat://hipchat.com/user/"+encodeURI(g)+(h?"?call="+encodeURI(h):"")}};var c=AJS.contextPath()+"/rest/hipchat/integration/1.0/users/";var b=function(g){return function(j){var i=d(this);var h=i.attr("data-user-id");var k=i.attr("data-caller-id");if(!k){return}var l=i.attr("data-call-type");if(!g&&l){return}window.location.replace(a.hipChatCall(k,l));AJS.trigger("analyticsEvent",{name:"hipchat.chatbar."+(l||"chat"),data:{userId:h}});j.preventDefault()}};var e=function(g){return function(i){if(!i||!i.presence){return}var j=i.userId;var h=i.hipChatUserId;var k;var m;var l=d(g).find(".hipchat-chatbar .aui-button");l.attr("data-user-id",j);l.attr("data-caller-id",h);l.click(b(i.presence.is_online));if(i.presence.is_online){if(i.presence.show==="xa"||i.presence.show==="away"){k="away";m="Away"}else{if(i.presence.show==="dnd"){k="dnd";m="Do not disturb"}else{k="available";m="Available"}}l.filter(".hipchat-chat").attr("title","Start chat with this user in HipChat.").removeAttr("aria-disabled");l.filter(".hipchat-voice").attr("title","Start a voice call with this user in HipChat.").removeAttr("aria-disabled");l.filter(".hipchat-video").attr("title","Start a video call with this user in HipChat.").removeAttr("aria-disabled")}else{k="offline";m="Offline";l.filter(".hipchat-chat").attr("title","Start chat with this user in HipChat.").removeAttr("aria-disabled");l.filter(".hipchat-voice").attr("title","Unable to start voice calls as this user is not known in HipChat.");l.filter(".hipchat-video").attr("title","Unable to start video calls as this user is not known in HipChat.")}if(i.presence.status){m+=" ("+i.presence.status+")"}d("div.values",g).append(Confluence.Templates.HipChat.Presence.badge({statusCode:k,statusMessage:m}));AJS.trigger("analyticsEvent",{name:"hipchat.presence.user.found",data:{userId:i.userId}})}};d(document).bind("ajaxComplete",function(i,g,h){if(/userinfopopup\.action/.test(h.url)){d.each(d(".vcard"),function(n,p){var m=d(p);var k=m.closest(".contents");var l=k.find(".profile-macro").first();var o=k.find(".actions").first();if(l.hasClass("hipchat-status-applied")||!o.length){return}l.addClass("hipchat-status-applied");if(f){o.addClass("hipchat-chatbar-support");o.append(Confluence.Templates.HipChat.Presence.chatBar());o.find(".ajs-menu-bar").addClass("aui-buttons");o.find(".ajs-button > a").addClass("aui-button");o.find(".user-popup-more").addClass("aui-button");o.find(".user-popup-more > span > span").addClass("aui-icon aui-icon-small aui-iconfont-more").text("")}var q=d(".userLogoLink",m).attr("data-username");var j=c+encodeURIComponent(q);d.getJSON(j,e(k)).fail(function(t){if(t.status===404){try{var r=JSON.parse(t.responseText);if(r.userId){AJS.trigger("analyticsEvent",{name:"hipchat.presence.user.unknown",data:{userId:r.userId}})}}catch(s){}}})})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:hipChatSpaceDiscovery', location = 'discovery/spacetoroom/spaceDiscoveryData.js' */
define("confluence/hipchat/spacetoroom/hipchat/discovery",[],function(){var a="com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin";return{isSpaceAdmin:function(){return AJS.Meta.get("is-space-admin")===true},hasSpaceConfiguration:function(){return AJS.Meta.get("has-space-config")===true},pluginKey:function(){return a}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:hipChatSpaceDiscovery', location = 'discovery/spacetoroom/spaceDiscovery.js' */
require(["jquery","confluence/hipchat/integration/hipchat/discovery","confluence/hipchat/spacetoroom/hipchat/discovery","confluence/hipchat/integration/hipchat/discovery/popup"],function(c,d,b,a){c(function(){var f=AJS.contextPath()+"/spaces/hipchat2.action?key="+encodeURIComponent(AJS.Meta.get("space-key"));var e=c("#space-tools-menu-trigger");if(e.length){a.show({featureKey:"hipChatSpaceIntegration",pluginKey:b.pluginKey(),analytics:"notifications.hipchat.space.discovery",template:Confluence.Templates.Hipchat.Discovery.spaceIntegrationDialog,name:"hipchat-space-integration-dialog",target:e,shouldShow:function(){return d.isLinked()&&b.isSpaceAdmin()&&!b.hasSpaceConfiguration()},onAccept:function(){window.location.assign(f)},fixed:true});a.show({featureKey:"hipChatServerIntegration",pluginKey:b.pluginKey(),analytics:"notifications.hipchat.space.link",template:Confluence.Templates.Hipchat.Discovery.spaceLinkDialog,name:"hipchat-space-link-dialog",target:e,shouldShow:function(){return !d.isLinked()&&d.isConditionsMet()&&!d.isAdmin()&&b.isSpaceAdmin()},onAccept:function(){window.location.assign(f)},fixed:true})}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:hipChatSpaceDiscovery', location = 'discovery/spacetoroom/spaceDiscovery.soy' */
// This file was automatically generated from spaceDiscovery.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Hipchat.Discovery.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Hipchat == 'undefined') { Confluence.Templates.Hipchat = {}; }
if (typeof Confluence.Templates.Hipchat.Discovery == 'undefined') { Confluence.Templates.Hipchat.Discovery = {}; }


Confluence.Templates.Hipchat.Discovery.spaceIntegrationDialog = function(opt_data, opt_ignored) {
  return '<h2>' + soy.$$escapeHtml("Send messages to a HipChat room") + '</h2><p>' + soy.$$escapeHtml("Send notifications for new pages, blog posts or space changes directly to a room in HipChat.") + '</p><br/><button class="aui-button" id="hipchat-integration-discovery-open">' + soy.$$escapeHtml("Add HipChat notifications") + '</button><a href="#" style="padding-left: 20px" id="hipchat-integration-discovery-dismiss">' + soy.$$escapeHtml("Not now") + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Hipchat.Discovery.spaceIntegrationDialog.soyTemplateName = 'Confluence.Templates.Hipchat.Discovery.spaceIntegrationDialog';
}


Confluence.Templates.Hipchat.Discovery.spaceLinkDialog = function(opt_data, opt_ignored) {
  return '<h2>' + soy.$$escapeHtml("Connect your Confluence site to HipChat") + '</h2><p>' + soy.$$escapeHtml("Set up and send notifications to HipChat rooms.") + '</p><br/><button class="aui-button" id="hipchat-integration-discovery-open">' + soy.$$escapeHtml("Integrate with HipChat") + '</button><a href="#" style="padding-left: 20px" id="hipchat-integration-discovery-dismiss">' + soy.$$escapeHtml("Not now") + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Hipchat.Discovery.spaceLinkDialog.soyTemplateName = 'Confluence.Templates.Hipchat.Discovery.spaceLinkDialog';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:blueprint-first-time-tooltip-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/first-time-tooptip.js' */
AJS.bind("sidebar.finished-loading",function(){var a=AJS.Meta.get("blueprint-index-popup-key");AJS.debug("Index key for "+a);if(a){Confluence.Blueprint.showIndexPagePopup(a)}});Confluence.Blueprint=AJS.$.extend(Confluence.Blueprint,{showIndexPagePopup:function(b){var d=function(i){return function(l,j,k){l.html(Confluence.Templates.Blueprints.sidebarIndexPagePopup({indexPageTitle:i.toLowerCase()}));k()}};var a=AJS.$(AJS.$("li.blueprint."+b)[0]);var h=a.text();var g=AJS.$(".icon",a);var f="blueprintIndexSidebarPopup";var c=AJS.InlineDialog(g.is(":visible")?g:AJS.$(".acs-nav-sections .quick-links-section"),f,d(h),{addActiveClass:false,hideDelay:null,noBind:true});AJS.$(document).bind("showLayer",function(i){var j=f+".inline-dialog-check";AJS.$("body").unbind("click."+j)});c.show();var e=function(i){AJS.$(document).on("click","#dismiss-index-popup",function(){i.hide();return false})}(c);AJS.bind("quickedit.success",function(){c.hide()})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:blueprint-first-time-tooltip-resources', location = 'com/atlassian/confluence/plugins/createcontent/soy/sidebar-index-page-popup.soy' */
// This file was automatically generated from sidebar-index-page-popup.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Blueprints.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Blueprints == 'undefined') { Confluence.Templates.Blueprints = {}; }


Confluence.Templates.Blueprints.sidebarIndexPagePopup = function(opt_data, opt_ignored) {
  return '<h2>' + soy.$$escapeHtml(AJS.format("Find your {0} here",opt_data.indexPageTitle)) + '</h2><p>' + soy.$$escapeHtml(AJS.format("You\x27\x27ve created a {0} page. A shortcut in your sidebar has been added where you can find other {0} in this space.",opt_data.indexPageTitle)) + '</p><br/><form>' + aui.buttons.button({text: "Dismiss", id: 'dismiss-index-popup'}) + '</form>';
};
if (goog.DEBUG) {
  Confluence.Templates.Blueprints.sidebarIndexPagePopup.soyTemplateName = 'Confluence.Templates.Blueprints.sidebarIndexPagePopup';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/create-from-template-macro.js' */
AJS.toInit(function(b){var a=b(".create-from-template-button");a.each(function(){var d=b(this);if(d.attr("aria-disabled")=="true"){var c={live:true,gravity:"n",title:"data-tooltip",delayIn:250,delayOut:0};d.tooltip(c)}else{d.click(function(){d.addClass("launching-dialog");Confluence.Blueprint.loadDialogAndOpenTemplate(d.data());return false})}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-resources', location = 'com/atlassian/confluence/plugins/createcontent/soy/create-from-template-macro.soy' */
// This file was automatically generated from create-from-template-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Blueprints.CreateFromTemplate.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Blueprints == 'undefined') { Confluence.Templates.Blueprints = {}; }
if (typeof Confluence.Templates.Blueprints.CreateFromTemplate == 'undefined') { Confluence.Templates.Blueprints.CreateFromTemplate = {}; }


Confluence.Templates.Blueprints.CreateFromTemplate.macroTemplate = function(opt_data, opt_ignored) {
  return '<a class=\'aui-button create-from-template-button\'' + ((! opt_data.hasCreatePermission) ? 'aria-disabled=\'true\' data-tooltip="' + soy.$$escapeHtml("Sorry, you don\x27t have permission to create content. Contact your space administrator to request access.") + '"' : '') + 'data-space-key=\'' + soy.$$escapeHtml(opt_data.spaceKey) + '\' href=\'' + soy.$$escapeHtml(opt_data.createContentUrl) + '\'' + ((opt_data.title) ? 'data-title=\'' + soy.$$escapeHtml(opt_data.title) + '\'' : '') + ((opt_data.templateId) ? 'data-template-id=\'' + soy.$$escapeHtml(opt_data.templateId) + '\'' : '') + ((opt_data.contentBlueprintId) ? 'data-content-blueprint-id=\'' + soy.$$escapeHtml(opt_data.contentBlueprintId) + '\'' : '') + '>' + soy.$$escapeHtml(opt_data.buttonLabel) + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Blueprints.CreateFromTemplate.macroTemplate.soyTemplateName = 'Confluence.Templates.Blueprints.CreateFromTemplate.macroTemplate';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.contributors:contributors-web-resources', location = 'com/atlassian/confluence/contributors/scripts/contributors.js' */
require(["ajs","underscore"],function(a,b){a.toInit(function(c){c("div.contributors-macro-ajax-container").each(function(){var e=c(this);var d=c.parseJSON(b.unescape(e.find(".contributors-macro-parameters")[0].innerHTML));e.text("Generating contributors information...");c.ajax({dataType:"json",url:Confluence.getContextPath()+"/rest/com.atlassian.confluence.contributors/1.0/contributors",data:d,success:function(f){if(f.errorMessage){e.text(f.errorMessage)}else{e.html(Confluence.ContributorsMacro.renderContent(f));e.find(".show-hidden-contributors").click(function(){e.find(".hidden-contributor").removeClass("hidden");c(this).parent().remove();return false})}},error:function(h,f,g){e.text("Failed to retrieve contributors information"+": "+g)}})})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.contributors:contributors-web-resources', location = 'com/atlassian/confluence/contributors/templates/contributors-macro.soy' */
// This file was automatically generated from contributors-macro.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.ContributorsMacro.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.ContributorsMacro == 'undefined') { Confluence.ContributorsMacro = {}; }


Confluence.ContributorsMacro.ajaxContainer = function(opt_data, opt_ignored) {
  return '<div class="contributors-macro-ajax-container"><div style="display; none;" class="contributors-macro-parameters">' + soy.$$escapeHtml(opt_data.macroParameters) + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.ContributorsMacro.ajaxContainer.soyTemplateName = 'Confluence.ContributorsMacro.ajaxContainer';
}


Confluence.ContributorsMacro.renderContent = function(opt_data, opt_ignored) {
  return '<div class="plugin-contributors">' + ((opt_data.layoutStyle == 'FLAT') ? Confluence.ContributorsMacro.flatLayout(opt_data) : (opt_data.layoutStyle == 'LIST') ? Confluence.ContributorsMacro.listLayout(opt_data) : '<span>Unknown layout style</span>') + '</div>';
};
if (goog.DEBUG) {
  Confluence.ContributorsMacro.renderContent.soyTemplateName = 'Confluence.ContributorsMacro.renderContent';
}


Confluence.ContributorsMacro.flatLayout = function(opt_data, opt_ignored) {
  return '<div class="plugin-contributors"><span><span>' + Confluence.ContributorsMacro.flatContributorsList({contributors: opt_data.visibleContributors, showCount: opt_data.showCount, showTime: opt_data.showTime}) + ((opt_data.hiddenContributors.length > 0) ? ',' : '') + '</span>' + ((opt_data.hiddenContributors.length > 0) ? '<span class="hidden hidden-contributor">' + Confluence.ContributorsMacro.flatContributorsList({contributors: opt_data.hiddenContributors, showCount: opt_data.showCount, showTime: opt_data.showTime}) + '</span><span><a href="#" class="show-hidden-contributors" title="' + soy.$$escapeHtml(AJS.format("{0} more...",opt_data.hiddenContributors.length)) + '">...</a></span>' : '') + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.ContributorsMacro.flatLayout.soyTemplateName = 'Confluence.ContributorsMacro.flatLayout';
}


Confluence.ContributorsMacro.listLayout = function(opt_data, opt_ignored) {
  var output = '<div class="plugin-contributors"><ul class="contributors-list">';
  var contributorList39 = opt_data.visibleContributors;
  var contributorListLen39 = contributorList39.length;
  for (var contributorIndex39 = 0; contributorIndex39 < contributorListLen39; contributorIndex39++) {
    var contributorData39 = contributorList39[contributorIndex39];
    output += '<li>' + Confluence.ContributorsMacro.contributor({contributor: contributorData39, showCount: opt_data.showCount, showTime: opt_data.showTime}) + '</li>';
  }
  if (opt_data.hiddenContributors.length > 0) {
    output += '<li><a href="#" class="show-hidden-contributors" title="' + soy.$$escapeHtml(AJS.format("{0} more...",opt_data.hiddenContributors.length)) + '">...</a></li>';
    var contributorList52 = opt_data.hiddenContributors;
    var contributorListLen52 = contributorList52.length;
    for (var contributorIndex52 = 0; contributorIndex52 < contributorListLen52; contributorIndex52++) {
      var contributorData52 = contributorList52[contributorIndex52];
      output += '<li class="hidden hidden-contributor">' + Confluence.ContributorsMacro.contributor({contributor: contributorData52, showCount: opt_data.showCount, showTime: opt_data.showTime}) + '</li>';
    }
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.ContributorsMacro.listLayout.soyTemplateName = 'Confluence.ContributorsMacro.listLayout';
}


Confluence.ContributorsMacro.flatContributorsList = function(opt_data, opt_ignored) {
  var output = '';
  var contributorList62 = opt_data.contributors;
  var contributorListLen62 = contributorList62.length;
  for (var contributorIndex62 = 0; contributorIndex62 < contributorListLen62; contributorIndex62++) {
    var contributorData62 = contributorList62[contributorIndex62];
    output += ((! (contributorIndex62 == 0)) ? ',' : '') + Confluence.ContributorsMacro.contributor({contributor: contributorData62, showCount: opt_data.showCount, showTime: opt_data.showTime});
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.ContributorsMacro.flatContributorsList.soyTemplateName = 'Confluence.ContributorsMacro.flatContributorsList';
}


Confluence.ContributorsMacro.contributor = function(opt_data, opt_ignored) {
  return Confluence.Templates.User.usernameLink({username: opt_data.contributor.idString, fullName: opt_data.contributor.fullNameString, canView: false}) + ' ' + ((opt_data.showCount) ? soy.$$escapeHtml(opt_data.contributor.totalCount) : '') + ' ' + ((opt_data.showTime) ? '(' + soy.$$escapeHtml(opt_data.contributor.relativeLastActiveTimeStr) + ')' : '');
};
if (goog.DEBUG) {
  Confluence.ContributorsMacro.contributor.soyTemplateName = 'Confluence.ContributorsMacro.contributor';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.issue-status-plugin:issue-status-resources', location = 'templates/status.soy' */
// This file was automatically generated from status.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace JIRA.Template.Util.Issue.Status.
 */

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Template == 'undefined') { JIRA.Template = {}; }
if (typeof JIRA.Template.Util == 'undefined') { JIRA.Template.Util = {}; }
if (typeof JIRA.Template.Util.Issue == 'undefined') { JIRA.Template.Util.Issue = {}; }
if (typeof JIRA.Template.Util.Issue.Status == 'undefined') { JIRA.Template.Util.Issue.Status = {}; }


JIRA.Template.Util.Issue.Status.issueStatusResolver = function(opt_data, opt_ignored) {
  return '' + ((! opt_data.issueStatus) ? '<span class="aui-icon aui-icon-small aui-iconfont-help jira-issue-status-render-error" title="' + soy.$$escapeHtml("No issue status information was provided") + '"></span>' : (opt_data.issueStatus.statusCategory) ? JIRA.Template.Util.Issue.Status.issueStatus(opt_data) : JIRA.Template.Util.Issue.Status.iconStatus({name: opt_data.issueStatus.name, iconUrl: opt_data.issueStatus.iconUrl, description: opt_data.issueStatus.description, isCompact: opt_data.isCompact}));
};
if (goog.DEBUG) {
  JIRA.Template.Util.Issue.Status.issueStatusResolver.soyTemplateName = 'JIRA.Template.Util.Issue.Status.issueStatusResolver';
}


JIRA.Template.Util.Issue.Status.iconStatus = function(opt_data, opt_ignored) {
  return '<img src="' + soy.$$escapeHtml(opt_data.iconUrl) + '" width="16" height="16" alt="' + soy.$$escapeHtml(opt_data.name) + '" title="' + soy.$$escapeHtml(opt_data.name) + ((opt_data.description) ? ' - ' + soy.$$escapeHtml(opt_data.description) : '') + '" class="jira-issue-status-icon">' + ((! opt_data.isCompact) ? ' ' + soy.$$escapeHtml(opt_data.name) : '');
};
if (goog.DEBUG) {
  JIRA.Template.Util.Issue.Status.iconStatus.soyTemplateName = 'JIRA.Template.Util.Issue.Status.iconStatus';
}


JIRA.Template.Util.Issue.Status.issueStatus = function(opt_data, opt_ignored) {
  return '' + JIRA.Template.Util.Issue.Status.statusLozenge({name: opt_data.issueStatus.name, categoryKey: opt_data.issueStatus.statusCategory.key, colorName: opt_data.issueStatus.statusCategory.colorName, description: opt_data.issueStatus.description, isSubtle: opt_data.isSubtle, isCompact: opt_data.isCompact, maxWidth: opt_data.maxWidth});
};
if (goog.DEBUG) {
  JIRA.Template.Util.Issue.Status.issueStatus.soyTemplateName = 'JIRA.Template.Util.Issue.Status.issueStatus';
}


JIRA.Template.Util.Issue.Status.statusLozenge = function(opt_data, opt_ignored) {
  var output = '';
  var maxWidth__soy46 = opt_data.maxWidth ? opt_data.maxWidth : 'medium';
  var tooltipContent__soy47 = '<span class="jira-issue-status-tooltip-title">' + soy.$$escapeHtml(opt_data.name) + '</span>' + ((opt_data.description) ? '<br><span class="jira-issue-status-tooltip-desc">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '');
  output += '<span class=" jira-issue-status-lozenge aui-lozenge ' + JIRA.Template.Util.Issue.Status.statusLozengeClasses(opt_data) + ((opt_data.isSubtle && ! opt_data.isCompact) ? ' aui-lozenge-subtle' : '') + ((opt_data.isCompact) ? ' jira-issue-status-lozenge-compact' : '') + ' jira-issue-status-lozenge-max-width-' + soy.$$escapeHtml(maxWidth__soy46) + '" data-tooltip="' + soy.$$escapeHtml(tooltipContent__soy47) + '">' + soy.$$escapeHtml(opt_data.name) + '</span>';
  return output;
};
if (goog.DEBUG) {
  JIRA.Template.Util.Issue.Status.statusLozenge.soyTemplateName = 'JIRA.Template.Util.Issue.Status.statusLozenge';
}


JIRA.Template.Util.Issue.Status.statusLozengeClasses = function(opt_data, opt_ignored) {
  return 'jira-issue-status-lozenge-' + soy.$$escapeHtml(opt_data.colorName ? opt_data.colorName : 'medium-gray') + ' ' + ((opt_data.categoryKey) ? 'jira-issue-status-lozenge-' + soy.$$escapeHtml(opt_data.categoryKey) : '');
};
if (goog.DEBUG) {
  JIRA.Template.Util.Issue.Status.statusLozengeClasses.soyTemplateName = 'JIRA.Template.Util.Issue.Status.statusLozengeClasses';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.issue-status-plugin:issue-status-resources', location = '/js/issue-status-plugin.js' */
AJS.$(function(){if(AJS.$.fn.tooltip){AJS.$(".jira-issue-status-lozenge[data-tooltip]").tooltip({aria:true,gravity:AJS.$.fn.tipsy.autoWE,delayIn:100,html:true,live:true,title:"data-tooltip",className:"jira-issue-status-tooltip"})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-jira-metadata:confluence-jira-metadata-resources', location = 'soy/jira-metadata.soy' */
// This file was automatically generated from jira-metadata.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Metadata.JIRA.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Metadata == 'undefined') { Confluence.Templates.Metadata = {}; }
if (typeof Confluence.Templates.Metadata.JIRA == 'undefined') { Confluence.Templates.Metadata.JIRA = {}; }


Confluence.Templates.Metadata.JIRA.metadata = function(opt_data, opt_ignored) {
  var output = '<div id="jira-metadata-dialog" class="rendered-content"><h2 class="title">' + soy.$$escapeHtml("JIRA links") + '</h2><div class="items-section">';
  var groupList6 = opt_data.groups;
  var groupListLen6 = groupList6.length;
  for (var groupIndex6 = 0; groupIndex6 < groupListLen6; groupIndex6++) {
    var groupData6 = groupList6[groupIndex6];
    if (groupData6.items.length) {
      switch (groupData6.type) {
        case 'ISSUES':
          output += Confluence.Templates.Metadata.JIRA.renderGroup({items: groupData6.items, headingText: "Issues", type: groupData6.type, links: groupData6.links});
          break;
        case 'SPRINTS':
          output += Confluence.Templates.Metadata.JIRA.renderGroup({items: groupData6.items, headingText: "Sprints", type: groupData6.type, links: groupData6.links});
          break;
        case 'VERSIONS':
          output += Confluence.Templates.Metadata.JIRA.renderGroup({items: groupData6.items, headingText: "Versions", type: groupData6.type, links: groupData6.links});
          break;
        case 'EPICS':
          output += Confluence.Templates.Metadata.JIRA.renderGroup({items: groupData6.items, headingText: "Epics", type: groupData6.type, links: groupData6.links});
          break;
      }
    }
  }
  output += '</div>' + Confluence.Templates.Metadata.JIRA.renderAuthPrompts({appLinks: opt_data.unauthorisedAppLinks}) + Confluence.Templates.Metadata.JIRA.renderJiraErrors(opt_data) + '</div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Metadata.JIRA.metadata.soyTemplateName = 'Confluence.Templates.Metadata.JIRA.metadata';
}


Confluence.Templates.Metadata.JIRA.featureDiscovery = function(opt_data, opt_ignored) {
  return '<div id="jira-metadata-feature-discovery"><h2>' + soy.$$escapeHtml("View related JIRA items here") + '</h2><p>' + soy.$$escapeHtml("Now you can see which epics, sprints, versions and issues relate to this page.") + '</p><div class="aui-toolbar2" role="toolbar"><div class="aui-toolbar2-inner">' + aui.buttons.button({text: "Show me", extraClasses: 'showme'}) + aui.buttons.button({text: "Don\x27t show again", type: 'link', extraClasses: 'close'}) + '</div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Metadata.JIRA.featureDiscovery.soyTemplateName = 'Confluence.Templates.Metadata.JIRA.featureDiscovery';
}


Confluence.Templates.Metadata.JIRA.nometadata = function(opt_data, opt_ignored) {
  return '<div id="jira-metadata-dialog" class="rendered-content">' + aui.message.warning({content: '<p>' + soy.$$escapeHtml("JIRA links cannot be displayed. Either you do not have correct JIRA permissions or the links have been removed.") + '</p>'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Metadata.JIRA.nometadata.soyTemplateName = 'Confluence.Templates.Metadata.JIRA.nometadata';
}


Confluence.Templates.Metadata.JIRA.renderAuthPrompts = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.appLinks.length) {
    var param66 = '';
    if (opt_data.appLinks.length == 1) {
      var appLink__soy69 = opt_data.appLinks[0];
      param66 += '<p>' + soy.$$filterNoAutoescape(AJS.format("{0}Login \x26amp; Approve{1} to retrieve data from {2}",'<a class="jira-metadata-auth-link" href="#" data-href="' + appLink__soy69.authorisationUrl + '">','</a>',appLink__soy69.htmlSafeName)) + '</p>';
    } else {
      param66 += '<p>' + soy.$$escapeHtml("Authenticate to retrieve data from the following instances:") + '</p>';
      var appLinkList78 = opt_data.appLinks;
      var appLinkListLen78 = appLinkList78.length;
      for (var appLinkIndex78 = 0; appLinkIndex78 < appLinkListLen78; appLinkIndex78++) {
        var appLinkData78 = appLinkList78[appLinkIndex78];
        param66 += '<div><a class="jira-metadata-auth-link" href="#" data-href="' + soy.$$escapeHtml(appLinkData78.authorisationUrl) + '">' + soy.$$escapeHtml(appLinkData78.name) + '</a></div>';
      }
    }
    output += aui.message.hint({content: param66});
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Metadata.JIRA.renderAuthPrompts.soyTemplateName = 'Confluence.Templates.Metadata.JIRA.renderAuthPrompts';
}


Confluence.Templates.Metadata.JIRA.renderGroup = function(opt_data, opt_ignored) {
  var output = '<div class="jira-metadata-section ' + soy.$$escapeHtml(opt_data.type) + '-section"><div class="section-label"><span class="icon"></span><span>' + soy.$$escapeHtml(opt_data.headingText) + '</span></div><ul class="jira-metadata-list jira-' + soy.$$escapeHtml(opt_data.type) + '-list">';
  var itemList94 = opt_data.items;
  var itemListLen94 = itemList94.length;
  for (var itemIndex94 = 0; itemIndex94 < itemListLen94; itemIndex94++) {
    var itemData94 = itemList94[itemIndex94];
    output += '<li class="jira-metadata-item"><span class="item-label"><a href="' + soy.$$escapeHtml("") + '/plugins/servlet/jira-metadata/redirect?u=' + soy.$$escapeUri(itemData94.url) + '&t=' + soy.$$escapeHtml(opt_data.type) + '" title="' + soy.$$escapeHtml(itemData94.name) + '">' + soy.$$escapeHtml(itemData94.name) + '</a>' + ((itemData94.status) ? '&nbsp;' + ((itemData94.status.statusCategory) ? JIRA.Template.Util.Issue.Status.issueStatusResolver({issueStatus: itemData94.status, isSubtle: true}) : '<span class="item-status">(' + soy.$$escapeHtml(itemData94.status.name) + ')</span>') : '') + '</span>' + ((itemData94.description != '') ? '<span class="item-subtext">' + soy.$$escapeHtml(itemData94.description) + '</span>' : '') + '</li>';
  }
  output += '</ul><ul class="jira-metadata-list ' + soy.$$escapeHtml(opt_data.type) + '-more-link">';
  var linkList130 = opt_data.links;
  var linkListLen130 = linkList130.length;
  for (var linkIndex130 = 0; linkIndex130 < linkListLen130; linkIndex130++) {
    var linkData130 = linkList130[linkIndex130];
    output += '<li class="jira-metadata-item"><a href="' + soy.$$escapeHtml("") + '/plugins/servlet/jira-metadata/redirect?u=' + soy.$$escapeUri(linkData130.url) + '&t=' + soy.$$escapeHtml(opt_data.type) + '&more">' + soy.$$escapeHtml(AJS.format("View {0} more in {1}",linkData130.numItems,linkData130.appName)) + '</a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Metadata.JIRA.renderGroup.soyTemplateName = 'Confluence.Templates.Metadata.JIRA.renderGroup';
}


Confluence.Templates.Metadata.JIRA.loadingMetadata = function(opt_data, opt_ignored) {
  return '<div id="jira-metadata-dialog"><h2 class="title">' + soy.$$escapeHtml("JIRA links") + '</h2><div class="spinner-container"><div class="spinner"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Metadata.JIRA.loadingMetadata.soyTemplateName = 'Confluence.Templates.Metadata.JIRA.loadingMetadata';
}


Confluence.Templates.Metadata.JIRA.renderJiraErrors = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.errors.length == 1) {
    var error__soy150 = opt_data.errors[0];
    output += aui.message.warning({content: '<p>' + soy.$$escapeHtml("Unable to retrieve JIRA metadata.") + ' ' + soy.$$escapeHtml(error__soy150.errorMessage) + '</p>'});
  } else if (opt_data.errors.length > 1) {
    var param159 = '<p>' + soy.$$escapeHtml("Unable to retrieve JIRA metadata. The following errors occurred:") + '</p><ul>';
    var errorList163 = opt_data.errors;
    var errorListLen163 = errorList163.length;
    for (var errorIndex163 = 0; errorIndex163 < errorListLen163; errorIndex163++) {
      var errorData163 = errorList163[errorIndex163];
      param159 += '<li>' + soy.$$escapeHtml(errorData163.errorMessage) + '</li>';
    }
    param159 += '</ul>';
    output += aui.message.warning({content: param159});
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Metadata.JIRA.renderJiraErrors.soyTemplateName = 'Confluence.Templates.Metadata.JIRA.renderJiraErrors';
}


Confluence.Templates.Metadata.JIRA.unknownError = function(opt_data, opt_ignored) {
  return '<div id="jira-metadata-dialog" class="rendered-content">' + aui.message.warning({content: '<p>' + soy.$$escapeHtml("Unable to retrieve JIRA metadata. Could not connect to Confluence") + '</p>'}) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Metadata.JIRA.unknownError.soyTemplateName = 'Confluence.Templates.Metadata.JIRA.unknownError';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-jira-metadata:confluence-jira-metadata-resources', location = '/js/jira-metadata.js' */
AJS.toInit(function(h){var i="com.atlassian.confluence.plugins.confluence-jira-metadata";var s=false;var o;var l;var q="jira-metadata-dialog";var g=h("#content-metadata-jira");var t;var e="jira-metadata-discovery";var r=AJS.Meta.get("jira-metadata-count");var k="linked-issues-dropdown";if(r>0){p(r,AJS.Meta.get("jira-metadata-count-incomplete"))}else{if(r==-1){h.ajax({url:AJS.contextPath()+"/rest/jira-metadata/1.0/metadata/aggregate?pageId="+AJS.Meta.get("page-id"),type:"GET",dataType:"json",contentType:"application/json",cache:false,success:function(u){if(u.count>0){p(u.count,u.incomplete)}}})}}function p(v,u){f(v,u);g.removeClass("hidden");if(b()){o=AJS.InlineDialog(g,q,function(x,w,y){AJS.trigger("analytics",{name:"confluence.jira.metadata.expanded"});if(!l||!s){l=x;y();a(x)}else{y()}return false},{hideDelay:null});g.click(function(){if(h("#"+q).is(":visible")){o.hide()}})}if(g&&j()){m();g.one("click",function(){Confluence.FeatureDiscovery.forPlugin(i).markDiscovered(k)})}}function f(v,u){if(!u){h("#content-metadata-jira > span").text(v==1?"1 JIRA link":AJS.format("{0} JIRA links",v))}}function b(){return !g.attr("href")}function m(){t=AJS.InlineDialog(g,e,function(v,u,w){v.html(Confluence.Templates.Metadata.JIRA.featureDiscovery());v.find(".showme").on("click",function(){Confluence.FeatureDiscovery.forPlugin(i).markDiscovered(k);t.hide();o.show()});v.find(".close").on("click",function(){Confluence.FeatureDiscovery.forPlugin(i).markDiscovered(k);t.hide()});w()},{noBind:true,closeOthers:false,hideDelay:null});t.show();Confluence.FeatureDiscovery.forPlugin(i).addDiscoveryView(k)}function j(){return !AJS.Meta.get("blueprint-index-popup-key")&&Confluence.FeatureDiscovery.forPlugin(i).shouldShow(k)}function a(){d();l.html(Confluence.Templates.Metadata.JIRA.loadingMetadata());l.find(".spinner").spin("medium");h.ajax({url:AJS.contextPath()+"/rest/jira-metadata/1.0/metadata?pageId="+AJS.Meta.get("page-id"),type:"GET",dataType:"json",contentType:"application/json",error:function(u){c();l.html(Confluence.Templates.Metadata.JIRA.unknownError())},success:function(u){c();s=true;f(u.count,false);var v;if(u.count===0&&!(u.unauthorisedAppLinks&&u.unauthorisedAppLinks.length>0)&&u.errors.length==0){AJS.trigger("analytics",{name:"confluence.jira.metadata.error.no-metadata"});v=Confluence.Templates.Metadata.JIRA.nometadata()}else{v=Confluence.Templates.Metadata.JIRA.metadata(u)}l.html(v);setTimeout(function(){l.find("#"+q).addClass("show")},0);n()},complete:function(){h("#"+q+" .icon-close").click(function(u){u.stopPropagation();h(this).closest(".closable").remove()})}})}function n(){h(".jira-metadata-auth-link").click(function(u){u.preventDefault();AppLinks.authenticateRemoteCredentials(h(this).data("href"),a,function(){})})}function d(){if(l&&l.height()>0){l.css("height",l.height())}}function c(){l&&l.css("height","")}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.playsql.requirementyogi:requirement-view', location = 'js/requirement-view.js' */
AJS.$(function(f){window.RY=window.RY||{};var k=window.RY;function e(t){var r=[];var s=t?f(".requirement-macro"):f(".requirement-macro.requirement-needs-excerpt");if(k.isDebug&&console){console.clear&&console.clear();AJS.log("=== Beginning of Requirement Yogi - RY.isDebug=true; RY.extractAndSendRequirements(true);")}s.each(function(){var H=f(this);var P=H.attr("data-requirement-key");if(k.isDebug){AJS.log("RY Creating excerpt of:",H)}var y=null;var F=a(H);var v=H.closest("h1, h2, h3, h4, h5, h6");var B=H.closest("td, th");var L=H.closest("p");var E=H.closest("li");var K=H.parent();var C=[];var G=[];if(F!=null){var x=[],D=[],I=[],z;for(var w in F){z=F[w];if(z.text&&z.text.charAt(0)=="-"){z.text=f.trim(z.text.substr(1))}var A=z.ignore==false&&z.text;var u=z.ignore==true;var J=z.text&&z.text!=P;var O=!!w;if(z.useAsTitle){I.push(z.text)}if(!z.definedInMacro){if(A||!u&&J){x.push(z.text)}if(J){D.push(z.text)}}if(A||!u&&O&&J){C.push({type:"AUTO",key:w,value:z.text})}if(!z.ignoreDependencies&&z.dependencies){if(k.isDebug&&G==undefined){AJS.error("Dependencies is null in "+z.text,z)}G=(G||[]).concat(z.dependencies)}}if(I.length){y=I.join(" - ");m(C,H.closest("tr"))}else{if(x.length){y=x.join(" - ");m(C,H.closest("tr"))}else{if(D.length){y=D.join(" - ");m(C,H.closest("tr"))}}}}if(y==null&&v.length>0){var N=b(v);y=n(N,P);m(C,N)}if(y==null&&B.length>0){y=n(B.next(),P);m(C,B.next())}if(y==null&&L.length>0){y=n(L,P);m(C,L)}if(y==null&&E.length>0){y=n(E,P);m(C,E)}if(y==null&&K.length>0){y=n(K,P);m(C,K)}var M={key:P,spaceKey:AJS.Meta.get("space-key"),htmlExcerpt:y,properties:C,dependencies:G};r.push(M)});if(r.length>0){if(k.isDebug){AJS.log("Sending excerpts among "+f(".requirement-macro").size()+" .requirement-macro (including "+f(".requirement-macro.requirement-needs-excerpt").size()+" needing an excerpt and force="+t+"): "+JSON.stringify(r))}f.ajax({url:AJS.contextPath()+"/rest/reqs/1/requirement2/"+AJS.Meta.get("space-key"),type:"PUT",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(r)}).success(function(){if(k.isDebug){AJS.log("RY: Success")}}).fail(function(u){AJS.error("RY: Failure "+u.status+"-"+u.statusText+": "+u.responseText)})}else{if(k.isDebug){AJS.log("No excerpt found among "+f(".requirement-macro").size()+" .requirement-macro (including "+f(".requirement-macro.requirement-needs-excerpt").size()+" needing an excerpt and force="+t+")")}}}var c=4;function i(){if(f(".jira-issue .issue-placeholder").size()==0||c==0){e()}else{c--;window.setTimeout(i,1000)}}window.RY.extractAndSendRequirements=e;i();var h=false;function a(t,y){var C={},v=t.closest("tr");if(v.size()==0){return null}var z=f(".requirement-property-macro.whole-doc.ignore-by-default").size()>0;var B=f(".requirement-property-macro.whole-doc.ignore-dependencies-by-default").size()>0;var A=v.closest("table");var r=A.find("tr").first().find("> th").size()==v.find("> td, > th").size();if(!r&&!h){h=true;if(k.isDebug){AJS.log("RY isFirstRowUsedForTitles:",r,"'> * > tr:first-child > th'="+A.find("> * > tr:first-child > th").size(),"'> td, > th'="+v.find("> td, > th").size())}else{AJS.log("Requirement Yogi: The first row is not used for titles. Type the following command to get more details: RY.isDebug = true; RY.extractAndSendRequirements(true);")}var u=A.find("> *:first-child > tr:first-child > td");if(u.size()>0&&u.find(".requirement-property-macro").size()>0){var x=u.filter("[data-highlight-colour='grey']");function s(E,D){if(E.length>D){return E.substr(0,D-30)+"..."}return E}var w=s(v.text(),80);require(["aui/flag"],function(D){D({type:"info",title:"Requirement Yogi",close:"manual",body:"The requirements were successfully seen on the page, but the header row of the table wasn't used"+(x.size()>0?" (even though "+x.size()+" of them are grey)":"")+'. If you need to include it, edit the page and click "Header row". Excerpt: <i>'+AJS.escapeHtml(w)+"</i>"})})}}v.find("> th, > td").each(function(){var J=f(this);if(k.isDebug){AJS.log("RY Proceeding with cell",J.index(),J.parent().index(),J.closest("tbody, thead, table")[0].nodeName,J)}var E=n(J,y);var M=J.index();var N=r?A.find("tr").first().find("> th").eq(M):f();var L=AJS.escapeHtml(f.trim(N.text())).substr(0,200);var I=false;var F=false;var H=z?true:undefined;var D=B?true:undefined;var K=N.find(".requirement-property-macro");K.each(function(){var R=f(this);var P=AJS.escapeHtml(R.attr("data-property"));var Q=AJS.escapeHtml(R.attr("data-value"));var S=R.attr("data-title")=="true";var T=R.attr("data-ignore")=="true";var O=R.attr("data-ignore-dependencies")=="true";if(P&&Q){C[P]={text:Q,useAsTitle:false,ignore:false,ignoreDependencies:true,definedInMacro:true}}else{H=false;if(R.attr("data-property")){L=AJS.escapeHtml(R.attr("data-property"));F=true}if(S){I=true}if(T){H=true}if(O){D=true}}if(k.isDebug){AJS.log("RY property (name, value, title, ryIgnore, ryIgnoreDependencies): ",P,Q,S,T,O)}});var G=J.find(".requirement-link-macro").map(function(){var O=f(this);var Q=O.attr("data-space-key")||AJS.Meta.get("space-key");var P=O.attr("data-requirement-key");return{relationship:L,spaceKey:Q,key:P,baseline:null}}).toArray();if(C[L]){if(k.isDebug&&C[L].dependencies==undefined){AJS.error("result[columnTitle].dependencies is undefined in "+L,C)}C[L].text+=" - "+E;C[L].useAsTitle=C[L].useAsTitle||I;C[L].ignore=C[L].ignore&&H;C[L].ignoreDependencies=C[L].ignoreDependencies&&D;C[L].dependencies=(C[L].dependencies||[]).concat(G)}else{C[L]={text:E,useAsTitle:I,ignore:H,ignoreDependencies:D,dependencies:G}}if(k.isDebug){AJS.log("RY Finished with cell",C[L].text,C[L].useAsTitle,C[L].ignore,C[L].ignoreDependencies)}});return C}function n(s,t){if(s.length==0){return null}s=s.clone();s.find(".jira-issue").before("[").after("]").find(".aui-lozenge:last").before(" - ");s.find(".requirement-macro").remove();s.find("li").before(" CONST1_CR-&nbsp;");s.find("p").before(" CONST1_CR");s.find("br").before(" CONST1_CR");s.find("tr").before(" CONST1_CR");s.find("td,th").before(" ");s.find(".expand-content.expand-hidden").remove();s.find("a, img").each(function(){var v=undefined;switch(this.nodeName){case"A":v="href";break;case"IMG":v="src";break;default:return}var u=this[v];if(!u){return}this.setAttribute(v,u)});var r=f.trim(d(s[0],{A:{mode:"html",attributes:["href"]},IMG:{mode:"html",attributes:["src"]},"*":{mode:"text"}}));if(t&&r.indexOf(t)==0){r=f.trim(r.substr(t.length))}r=r.replace(/(^CONST1_CR|CONST1_CR$)/g,"");r=r.replace(/CONST1_CR\s*CONST1_CR/g,"CONST1_CR");r=r.replace(/CONST1_CR/g,"<br>\n");return r}function d(u,r){if(!u){return""}var v,s,t=u.nodeType,A=u.nodeName,y="";if(t){if(t===1||t===9||t===11){var x=r[A]||r["*"];if(x){if(x.mode=="html"){y+="<"+A.toLowerCase();var B=u.attributes;for(var v=0;v<B.length;v++){var z=B[v].name;var w=B[v].value;if(!x.attributes||x.attributes.indexOf(z)!=-1){y+=" "+z+'="'+AJS.escapeHtml(w)+'"'}}y+=">";y+=d(u.childNodes,r);y+="</"+A.toLowerCase()+">"}else{for(var v=0;(s=u.childNodes[v]);v++){y+=d(s,r)}}}}else{if(t===3||t===4){return AJS.escapeHtml(u.nodeValue)}}}else{for(var v=0;(s=u[v]);v++){y+=d(s,r)}}return y}function m(t,r){if(r){var s=r.find(".requirement-property-macro").add(f(".requirement-property-macro.whole-doc"));s.each(function(){var w=f(this);var v=f.trim(w.attr("data-property"));var u=f.trim(w.attr("data-value"));if(v&&u){t.push({type:"AUTO",key:AJS.escapeHtml(v),value:AJS.escapeHtml(u)})}})}}function b(r){var t=f("<div>"),u=true,v=false,s;switch(r[0].nodeName){case"H1":s="h1";break;case"H2":s="h1, h2";break;case"H3":s="h1, h2, h3";break;case"H4":s="h1, h2, h3, h4";break;case"H5":s="h1, h2, h3, h4, h5";break;case"H6":s="h1, h2, h3, h4, h5, h6";break;default:return r}r.parent().children().each(function(){var w=f(this);if(w.is(r)){u=false}else{if(!u&&w.is(s)){v=true}}if(!u&&!v){t.append(w.clone())}});return t}window.RY=window.RY||{};var k=window.RY;k.InlinePopup=k.InlinePopup||{loading:false,dialog:undefined,openDialog:function(u){if(k.InlineCreationDialog.dialog){return}var v=u.attr("data-requirement-key"),x=u.attr("data-space-key")||AJS.Meta.get("space-key"),w=u.attr("data-requirement-baseline"),t=u.hasClass("requirement-macro");var y=f("a.requirement-detail-popup-title");if(y.is(":visible")){var r=y.attr("data-requirement-key");var s=y.attr("data-space-key");if(r==v&&s==x){return}k.InlinePopup.closeAnyPopup()}k.InlinePopup.dialog=AJS.InlineDialog(u,"requirement-detail",function(A,z,B){if(k.InlinePopup.loading){B();return}if(u.hasClass("ry-error")){A.html(u.attr("data-error-message"));B();return}if(u.hasClass("error-duplicate")){A.html(PlaySQL.Requirements.errorDuplicate({}));B();return}if(!v){A.text("Error while displaying the requirement");B();return}k.InlinePopup.loading=true;f.ajax({url:AJS.contextPath()+"/rest/reqs/1/requirement2/"+x+"/"+v+"?"+AJS.$.param({expand:"references",v:w||""}),type:"GET",contentType:"application/json; charset=utf-8"}).success(function(E){k.InlinePopup.loading=false;var C=AJS.Meta.get("page-id");var D=AJS.Meta.get("space-key");C=C!="0"?C:undefined;if(E.references.length==1&&E.references[0].pageId==C){E.references=[]}A.html(PlaySQL.Requirements.detailPopup({requirement:E,currentPageId:C,spaceKey:D,isOriginal:t}));B()}).fail(function(){k.InlinePopup.loading=false})},{showDelay:0,width:500,cacheContent:false,useLiveEvents:false,noBind:true,hideCallback:function(){k.InlinePopup.dialog=undefined}});k.InlinePopup.dialog.show()},closeAnyPopup:function(){k.InlinePopup.dialog&&k.InlinePopup.dialog.remove();f("#inline-dialog-requirement-detail").remove();k.InlinePopup.dialog=undefined}};k.InlinePopup.timeoutId=undefined;k.InlinePopup.popupDelay=700;f(document).on("mouseenter mouseleave",".requirement-link-macro, .requirement-macro",function(s){var r=f(this);if(k.InlinePopup.timeoutId){window.clearTimeout(k.InlinePopup.timeoutId);k.InlinePopup.timeoutId=undefined}if(s.type!="mouseleave"){k.InlinePopup.timeoutId=window.setTimeout(function(){k.InlinePopup.openDialog(r);if(k.InlinePopup.popupDelay>=300){k.InlinePopup.popupDelay=k.InlinePopup.popupDelay-200}},k.InlinePopup.popupDelay)}});window.setTimeout(function(){if(f(".requirement-macro, .requirement-link-macro").size()>0){f.ajax({url:AJS.contextPath()+"/rest/feature-discovery/latest/com.playsql.requirementyogi/requirement-macro?newPeriod=2000000",type:"get",dataType:"json"}).success(function(r){if(r&&r.isNew){k.InlinePopup.popupDelay=0}})}},500);if(window.location.hash&&window.location.hash.indexOf("#req")==0){var p=/^#req-link-([a-zA-Z0-9]+)-(.+)-[0-9]*$/;var g=p.exec(window.location.hash);if(g){var l=g[1];var j=g[2];f(".requirement-link-macro[data-requirement-key='"+j+"'][data-space-key='"+l+"']").addClass("active-anchor")}else{var q=/^#req-(.+)$/;g=q.exec(window.location.hash);if(g){var j=g[1];f(".requirement-macro[data-requirement-key='"+j+"']").addClass("active-anchor")}}}var o=f(".ry-tooltipable");o&&o.tooltip&&o.tooltip({delayIn:0});f(".space-requirement-index a.delete-requirement").click(function(u){var t=f(this),r=t.attr("data-key"),s=t.attr("data-space-key");if(!r){return}u.preventDefault();f.ajax({url:AJS.contextPath()+"/rest/reqs/1/requirement2/"+s+"/"+r,type:"DELETE",contentType:"application/json; charset=utf-8"}).success(function(){t.closest("tr").remove()})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.playsql.requirementyogi:requirement-view', location = 'js/requirement-view.soy' */
// This file was automatically generated from requirement-view.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace PlaySQL.Requirements.
 */

if (typeof PlaySQL == 'undefined') { var PlaySQL = {}; }
if (typeof PlaySQL.Requirements == 'undefined') { PlaySQL.Requirements = {}; }


PlaySQL.Requirements.detailPopup = function(opt_data, opt_ignored) {
  var output = '<div class="identification"><a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.requirement.genericUrl) + '" data-requirement-key="' + soy.$$escapeHtml(opt_data.requirement.key) + '" class="requirement-detail-popup-title aui-label">' + soy.$$escapeHtml(opt_data.requirement.key) + '</a>' + ((opt_data.isOriginal) ? '&nbsp;' + ((opt_data.requirement.baseline) ? (opt_data.requirement.baselineDetails) ? '<span class="aui-lozenge aui-lozenge-success">Archived</span>&nbsp;in baseline ' + soy.$$escapeHtml(opt_data.requirement.baseline) + '-<a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.requirement.baselineDetails.pageUrl) + '#">' + soy.$$escapeHtml(opt_data.requirement.baselineDetails.name) + '</a>' : '<span class="aui-lozenge aui-lozenge-success">Archived</span>&nbsp;in baseline ' + soy.$$escapeHtml(opt_data.requirement.baseline) : '<span class="aui-lozenge aui-lozenge-success">Original definition</span>') : '&nbsp;<span class="aui-lozenge aui-lozenge-moved">Link</span>&nbsp;to&nbsp;<a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.requirement.page.url) + '">' + soy.$$escapeHtml(opt_data.requirement.page.title) + '</a>' + ((opt_data.spaceKey != opt_data.requirement.spaceKey) ? ' in space \'' + soy.$$escapeHtml(opt_data.requirement.spaceKey) + '\'' : '') + ((opt_data.requirement.baseline) ? (opt_data.requirement.baselineDetails) ? '&nbsp;as of baseline ' + soy.$$escapeHtml(opt_data.requirement.baseline) + '-<a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.requirement.baselineDetails.pageUrl) + '#">' + soy.$$escapeHtml(opt_data.requirement.baselineDetails.name) + '</a>' : '&nbsp;as of baseline ' + soy.$$escapeHtml(opt_data.requirement.baseline) : '')) + '</div><div class="quote">&#8220;</div>' + ((opt_data.requirement.htmlExcerpt) ? '<p>' + soy.$$filterNoAutoescape(opt_data.requirement.htmlExcerpt) + '</p>' : '<p> </p>');
  if (opt_data.requirement.properties.length != 0) {
    output += '<ul>';
    var propertyList70 = opt_data.requirement.properties;
    var propertyListLen70 = propertyList70.length;
    for (var propertyIndex70 = 0; propertyIndex70 < propertyListLen70; propertyIndex70++) {
      var propertyData70 = propertyList70[propertyIndex70];
      output += (propertyData70.display) ? '<li>' + ((propertyData70.searchUrl) ? '<a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(propertyData70.searchUrl) + '" target="_blank">' + soy.$$filterNoAutoescape(propertyData70.key) + '</a>' : soy.$$filterNoAutoescape(propertyData70.key)) + ': ' + soy.$$filterNoAutoescape(propertyData70.value) + '</li>' : '';
    }
    output += '</ul>';
  }
  if (opt_data.requirement.references.length != 0 || opt_data.requirement.issues.length != 0 || opt_data.requirement.dependencies.length != 0 || opt_data.requirement.reverseDependencies.length != 0) {
    output += '<p>See also:</p><ul class="ry-detail-links"><li><span class="aui-lozenge aui-lozenge-success">Original definition</span>&nbsp;<a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.requirement.page.url) + '">' + soy.$$escapeHtml(opt_data.requirement.page.title) + '</a></li>';
    var linkList100 = opt_data.requirement.dependencies;
    var linkListLen100 = linkList100.length;
    for (var linkIndex100 = 0; linkIndex100 < linkListLen100; linkIndex100++) {
      var linkData100 = linkList100[linkIndex100];
      output += '<li><span class="aui-lozenge aui-lozenge-default" title="cites">DEPENDENCY &gt;</span> (' + soy.$$escapeHtml(linkData100.relationship) + ') &nbsp;<a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(linkData100.url) + '">' + soy.$$escapeHtml(linkData100.key) + '</a>' + ((opt_data.spaceKey != linkData100.spaceKey) ? ' in space \'' + soy.$$escapeHtml(linkData100.spaceKey) + '\'' : '') + '</li>';
    }
    var linkList116 = opt_data.requirement.reverseDependencies;
    var linkListLen116 = linkList116.length;
    for (var linkIndex116 = 0; linkIndex116 < linkListLen116; linkIndex116++) {
      var linkData116 = linkList116[linkIndex116];
      output += '<li><span class="aui-lozenge aui-lozenge-default" title="Is cited by">&lt; DEPENDENCY</span> (' + soy.$$escapeHtml(linkData116.relationship) + ') &nbsp;<a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(linkData116.url) + '">' + soy.$$escapeHtml(linkData116.key) + '</a>' + ((opt_data.spaceKey != linkData116.spaceKey) ? ' in space \'' + soy.$$escapeHtml(linkData116.spaceKey) + '\'' : '') + '</li>';
    }
    var linkList132 = opt_data.requirement.references;
    var linkListLen132 = linkList132.length;
    for (var linkIndex132 = 0; linkIndex132 < linkListLen132; linkIndex132++) {
      var linkData132 = linkList132[linkIndex132];
      output += (! linkData132.dependencyId) ? '<li>' + ((linkData132.pageId == opt_data.currentPageId) ? '<span class="aui-lozenge aui-lozenge-moved">This page</span>' : '<span class="aui-lozenge aui-lozenge-moved">Link</span>') + '&nbsp;<a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(linkData132.url) + '">' + soy.$$escapeHtml(linkData132.title) + '</a></li>' : '';
    }
    var linkList148 = opt_data.requirement.issues;
    var linkListLen148 = linkList148.length;
    for (var linkIndex148 = 0; linkIndex148 < linkListLen148; linkIndex148++) {
      var linkData148 = linkList148[linkIndex148];
      output += '<li><span class="aui-lozenge aui-lozenge-new">JIRA</span> (' + soy.$$escapeHtml(linkData148.relationship) + ') &nbsp;<a href="' + soy.$$escapeHtml(linkData148.url) + '">' + soy.$$escapeHtml(linkData148.issueKey) + '</a> ' + soy.$$escapeHtml(linkData148.title) + '</li>';
    }
    output += '</ul>';
  }
  output += (opt_data.requirement.baselineDetails) ? '<p><a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.requirement.searchForVersionsUrl) + '">See all versions of this requirement</a></p>' : '';
  return output;
};
if (goog.DEBUG) {
  PlaySQL.Requirements.detailPopup.soyTemplateName = 'PlaySQL.Requirements.detailPopup';
}


PlaySQL.Requirements.detailRte = function(opt_data, opt_ignored) {
  var output = '<div id="property-panel-requirement-detail">' + ((! opt_data.isOriginal) ? '<div class="quote">&#8220;</div><p>' + soy.$$escapeHtml(opt_data.requirement.htmlExcerpt) + '</p>' : '');
  if (opt_data.requirement.references.length != 0 || opt_data.requirement.issues.length != 0) {
    output += '<p>See also:</p><ul><li><a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.requirement.page.url) + '">' + soy.$$escapeHtml(opt_data.requirement.page.title) + '</a> (Original definition)</li>';
    var linkList181 = opt_data.requirement.references;
    var linkListLen181 = linkList181.length;
    for (var linkIndex181 = 0; linkIndex181 < linkListLen181; linkIndex181++) {
      var linkData181 = linkList181[linkIndex181];
      output += '<li><a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(linkData181.url) + '">' + soy.$$escapeHtml(linkData181.title) + '</a>&nbsp;' + ((linkData181.pageId == opt_data.currentPageId) ? '(This page)' : '(Link)') + '</li>';
    }
    var linkList195 = opt_data.requirement.issues;
    var linkListLen195 = linkList195.length;
    for (var linkIndex195 = 0; linkIndex195 < linkListLen195; linkIndex195++) {
      var linkData195 = linkList195[linkIndex195];
      output += '<li><a href="' + soy.$$escapeHtml(linkData195.url) + '">' + soy.$$escapeHtml(linkData195.issueKey) + '</a> ' + soy.$$escapeHtml(linkData195.title) + ' <span class="aui-lozenge aui-lozenge-new">JIRA</span> (' + soy.$$escapeHtml(linkData195.relationship) + ')</li>';
    }
    output += '</ul>';
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  PlaySQL.Requirements.detailRte.soyTemplateName = 'PlaySQL.Requirements.detailRte';
}


PlaySQL.Requirements.inlineActionForm = function(opt_data, opt_ignored) {
  var output = '<form action="#" method="post" id="create-inline-requirement-form" class="aui top-label"><div class="dialog-header hidden"><div class="title left-position"><h2 id="create-dialog-header">' + soy.$$escapeHtml("Define a new key") + '</h2></div><br class="clear" /></div><span id="req-type-loading"><span class="aui-icon aui-icon-wait"></span>' + soy.$$escapeHtml("Loading\u2026") + '</span><div class="dialog-content hidden"><div class="field-group hidden"><label for="req-key">' + soy.$$escapeHtml("Key") + '<span class="aui-icon icon-required"> required</span></label><input id="req-key" class="text long-field" value="' + soy.$$escapeHtml(opt_data.requirementKey) + '" maxlength="255" /></div><div class="field-group"><label for="req-type">' + soy.$$escapeHtml("Type") + '<span class="aui-icon icon-required"> required</span></label><select class="select long-field" id="req-type" name="reqtype" title="Type"><option value="" data-ceoid="inline">Inline</option><option value="" data-ceoid="new">New...</option></select><div class="description"><a href="#" class="refresh-types">' + soy.$$escapeHtml("Refresh") + '</a></div><div class="description create-inline-requirement-explanation">' + soy.$$escapeHtml("\x22Inline\x22 is the same as editing the page and inserting with [ Alt + Shift + R ].") + '</div></div><div class="new-type-group hidden"><div class="field-group"><label for="type-name">' + soy.$$escapeHtml("Type Name") + '<span class="aui-icon icon-required"> required</span></label><input id="type-name" class="text long-field" value="' + soy.$$escapeHtml(opt_data.newTypeSuggestion) + '" maxlength="255" /></div><div class="field-group"><label for="type-name">' + soy.$$escapeHtml("Type Color") + '</label><select class="select long-field" id="type-color" name="type-color"><option value="transparent">[ None ]</option><option value="#14892c">Green</option><option value="#d04437">Red</option><option value="#205081">Blue</option><option value="#f15c75">Pink</option><option value="#815b3a">Brown</option><option value="#654982">Violet</option><option value="#f6c342">Yellow</option><option value="#4a6785">Slate</option></select><div class="description">More formatting options are available in the index page</div></div></div><div class="field-group description-parent hidden">';
  var inlineRef__soy230 = '<span class="req-key-reference">REQ-001</span>';
  output += '<label for="description">' + soy.$$filterNoAutoescape(AJS.format("Description of {0}",inlineRef__soy230)) + '<span class="aui-icon icon-required"> required</span></label><textarea class="textarea long-field" id="description"></textarea></div><div class="checkbox for-all-on-page-group hidden"><input class="checkbox" type="checkbox" name="apply-in-page" id="apply-in-page" checked="on" disabled="on"><label for="apply-in-page">Make links for every "<span class="req-key-reference">REQ-001</span>" on this page.</label></div><div class="checkbox for-all-in-space-group"><input class="checkbox" type="checkbox" name="apply-in-space" id="apply-in-space" checked="on"><label for="apply-in-space">Make links for every "<span class="req-key-reference">REQ-001</span>" in this space.</label></div><div class="checkbox transform-all-similar-group hidden"><input class="checkbox" type="checkbox" name="transform-all-similar" id="transform-all-similar" data-pattern="The regex to look for"><label for="transform-all-similar">Create similar definitions for all <span id="pattern" title="It\'s a regex.">"REQ-"</span><a href="#" class="edit-pattern"><span class="aui-icon aui-icon-small aui-iconfont-edit-small playsql-tipsy">(Edit the pattern)</span></a>&nbsp; on this page (about <span id="pattern-count">0</span> other occurrences). &nbsp;<span id="warn-key-is-no-match" class="hidden">Note: The key doesn\'t match your pattern.</span></label></div></div><div class="buttons-group"><div id="form-message" class="error"></div><input class="aui-button submit" type="submit" value="' + soy.$$escapeHtml("Create") + '" /><a class="cancel" href="#">' + soy.$$escapeHtml("Cancel") + '</a></div></form>';
  return output;
};
if (goog.DEBUG) {
  PlaySQL.Requirements.inlineActionForm.soyTemplateName = 'PlaySQL.Requirements.inlineActionForm';
}


PlaySQL.Requirements.inlineActionFormForDuplicates = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="situation" value="already-exists" />' + ((opt_data.requirement.page) ? '<p>The requirement ' + soy.$$escapeHtml(opt_data.requirement.key) + ' already exists on&nbsp;<a href="' + soy.$$escapeHtml(opt_data.contextPath) + soy.$$escapeHtml(opt_data.requirement.page.url) + '">' + soy.$$escapeHtml(opt_data.requirement.page.title) + '</a>.</p>' : '<p>The requirement ' + soy.$$escapeHtml(opt_data.requirement.key) + ' already exists&nbsp; (<a href="' + soy.$$escapeHtml(opt_data.contextPath) + soy.$$escapeHtml(opt_data.requirement.genericUrl) + '">link</a>).</p>') + '<p>Do you want to create a link?</p>';
};
if (goog.DEBUG) {
  PlaySQL.Requirements.inlineActionFormForDuplicates.soyTemplateName = 'PlaySQL.Requirements.inlineActionFormForDuplicates';
}


PlaySQL.Requirements.colorDropdownItem = function(opt_data, opt_ignored) {
  return '' + ((opt_data.color == 'transparent') ? '<span>' + soy.$$escapeHtml(opt_data.name) + '</span>' : '<span style="color: ' + soy.$$escapeHtml(opt_data.color) + '; font-weight: bold;">' + soy.$$escapeHtml(opt_data.name) + '</span>');
};
if (goog.DEBUG) {
  PlaySQL.Requirements.colorDropdownItem.soyTemplateName = 'PlaySQL.Requirements.colorDropdownItem';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.playsql.requirementyogi:requirement-view', location = 'js/requirement-view-inline-actions.js' */
window.RY=window.RY||{};RY=window.RY;AJS.$(function(a){var b="com.playsql.requirementyogi:to-req-yogi";Confluence&&Confluence.HighlightAction&&Confluence.HighlightAction.registerButtonHandler(b,{onClick:function(c){RY.InlineCreationDialog.showCreateReqDialog(c)},shouldDisplay:function(d){var c=Confluence.HighlightAction.WORKING_AREA.MAINCONTENT_ONLY.apply(this,arguments);if(!c){return false}var f=d.toString();var e=/^[a-zA-Z0-9_.-]+$/.test(a.trim(f));return e}})});RY.InlineCreationDialog=RY.InlineCreationDialog||(function(d){var k=360;var l=500;var a=/[._-]/;var r;var n={hideDelay:null,maxHeight:l};var g,m;function p(s){RY.InlineCreationDialog.removeDialog();m=s;g=d.trim(m.text);var t={preHideCallback:function(){var x=d(document.activeElement);var y=x.is("#inline-dialog-create-requirement-yogi-dialog .select2-drop-mask, #inline-dialog-create-requirement-yogi-dialog .select2-drop");return !y},width:k,hideCallback:function(){RY.InlineCreationDialog.dialog=undefined}};var w="Type "+g;var u=g.split(/[_.-]/);if(u.length>1){w=u[0]}var v=function(y,x,z){d(y).html(PlaySQL.Requirements.inlineActionForm({requirementKey:m.text,newTypeSuggestion:w}));z();i();return false};RY.InlineCreationDialog.dialog=c(m,"create-requirement-yogi-dialog",t,v)}function c(w,y,t,x){var s=d("<div>");e(w.area.average,s);var v=t.hideCallback;t.hideCallback=function(){s.remove();v&&v()};var u=Confluence.ScrollingInlineDialog(s,y,x,d.extend({},n,t));u.show();return u}function e(t,s){Confluence.DocThemeUtils.appendAbsolutePositionedElement(s);s.css({top:t.top,height:t.height,left:t.left,width:t.width,"z-index":-9999,position:"absolute"}).addClass("create-requirement-yogi-dialog-target")}function j(s){var s=s.clone();s.find("p, li, td, th, img, div, h1, h2, h3, h4, h5, h6, br").prepend("\n");return s.text()}function i(){var s=d("#create-inline-requirement-form");r=j(d(m.containingElement).closest(".wiki-content"));window.setTimeout(function(){var y=s.find("#req-type");var x=s.find("#type-name");y.focus();y.change(function(){var C=d(this).find(":selected");var D=C.val();var B=C.attr("data-ceoid");f()});x.change(function(){f()});f();var A=s.find("#type-color");A.auiSelect2&&A.auiSelect2({formatResult:function t(B){if(!B.id){return B.text}return PlaySQL.Requirements.colorDropdownItem({color:B.id,name:B.text})},escapeMarkup:function(B){return B}});var w=function(){var B=A.val();s.find(".new-type-group").css("border-left-color",B)};A.change(w);w();s.on("click",".cancel",RY.InlineCreationDialog.removeDialog);s.on("click",".refresh-types",function(){u(true)});s.on("click",".edit-pattern",function(C){C.stopPropagation&&C.stopPropagation();C.preventDefault();s.find("#pattern").html(d("<input>",{placeholder:"Enter a regex pattern",title:"If using a regex, please end it with .*",id:"custom-pattern",name:"custom-pattern",value:s.find("#transform-all-similar").attr("data-pattern")}));var B=s.find("#custom-pattern");B.on("keyup change",function(){window.setTimeout(function(){var F=B.val();var D=h(F);var G=q(g,D);var H=q(r,D);var E=s.find(".transform-all-similar-group");E.find("input").attr("data-pattern",F);E.find("#pattern-count").text(H<1?0:H-1);E.find("#warn-key-is-no-match").toggleClass("hidden",G>0)},0)});window.setTimeout(function(){s.find("#transform-all-similar").attr("checked","true");s.find(".edit-pattern").remove()},0);return false});s.submit(function(K){K.preventDefault();function M(Q,R){d("#create-inline-requirement-form #form-message").text("");d.ajax({url:AJS.contextPath()+"/rest/reqs/1/types/"+encodeURI(AJS.Meta.get("space-key"))+"/createAndReplace",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(Q)}).success(function(S){R(S)}).fail(function(T){var S=T&&T.responseText||"";if(S.length>101){S=S.substr(0,100)+"..."}if(!S){S="The request couldn't be sent. Please try again later."}d("#create-inline-requirement-form #form-message").text(S)})}var D=AJS.Meta.get("page-id");var E=s.find("[name=situation]").val();if(E=="already-exists"){M({reqKey:g,sourceCeoId:D,applyToAllSimilarOccurrences:false,applyToAllSpace:false,defineInlineAsALink:true},function(Q){if(Q.replacements.length==0){s.find("#form-message").text("No replacement was performed. Can you edit this page?")}else{b(D,Q.replacements,null);RY.InlineCreationDialog.removeDialog()}})}else{var O=y.find(":selected");var B=O.val();var G=O.attr("data-ceoid");var P=O.attr("data-formatting");var N=s.find("#type-name").val();var F=s.find("#type-color").val();var J=s.find("#description").val();var H=s.find("#transform-all-similar");var I=s.find("#apply-in-space");var L=h(H.attr("data-pattern"));var C=F&&F!="transparent"?F+"; bold;":undefined;if(G=="inline"){M({reqKey:g,typeName:N,sourceCeoId:D,applyToAllSimilarOccurrences:N&&H.is(":checked")||false,pattern:L,applyToAllSpace:I.is(":checked"),defineInline:true,description:J,formatting:null},function(Q){if(Q.replacements.length==0){s.find("#form-message").text("No replacement was performed. Can you edit this page?")}else{b(D,Q.replacements,null);RY.InlineCreationDialog.removeDialog()}})}else{if(G=="new"){M({reqKey:g,typeName:N,sourceCeoId:D,targetCeoId:null,applyToAllSimilarOccurrences:N&&H.is(":checked")||false,pattern:L,applyToAllSpace:I.is(":checked"),defineInline:false,description:J,formatting:C},function(R){var Q=R.targetPageUrl;if(Q){window.location.href=AJS.contextPath()+Q}else{s.find("#form-message").text("No replacement was performed. Can you edit this page?")}})}else{N=B;C=P;M({reqKey:g,typeName:N,sourceCeoId:D,targetCeoId:G,applyToAllSimilarOccurrences:N&&H.is(":checked")||false,pattern:L,applyToAllSpace:I.is(":checked"),defineInline:false,description:J,formatting:C},function(Q){b(D,Q.replacements,C);RY.InlineCreationDialog.removeDialog()})}}}return false});var v=undefined;var z=false;function u(B){s.find("#req-type option[value != '']").remove();d.ajax({url:AJS.contextPath()+"/rest/reqs/1/types/"+encodeURI(AJS.Meta.get("space-key"))+"?"+d.param({refresh:B}),type:"GET",contentType:"application/json; charset=utf-8"}).success(function(E){if(v){return}var H=s.find("#req-type");var M=s.find("#req-type option:last");var C=s.find("#req-type-loading");if(v===false){C.addClass("hidden")}z=true;var G=null;var I=[];var D=[];for(var F=0;F<E.length;F++){var L=E[F].name;if(I.indexOf(L)!=-1){D.push(L)}else{I.push(L)}}for(var F=0;F<E.length;F++){var K=E[F];var J=K.name;if(D.indexOf(K.name)!=-1){J+=" on "+K.ceoTitle}d("<option>",{value:K.name,"data-ceoid":K.ceoId,"data-formatting":K.formatting,text:J}).insertBefore(M);if(g.indexOf(K.name)!=-1&&a.test(g.charAt(K.name.length))){G=K.name}}if(G){H.val(G).change()}else{f()}H.focus()}).fail(function(){var C=s.find("#req-type-loading");C.addClass("hidden")})}u(false);d.ajax({url:AJS.contextPath()+"/rest/reqs/1/requirement2/"+encodeURI(AJS.Meta.get("space-key"))+"/"+encodeURI(g),type:"GET",contentType:"application/json; charset=utf-8"}).success(function(B){v=true;s.find(".dialog-content").html(PlaySQL.Requirements.inlineActionFormForDuplicates({contextPath:AJS.contextPath(),requirement:B})).removeClass("hidden");s.find("#req-type-loading").remove()}).fail(function(){v=false;s.find(".dialog-content").removeClass("hidden");if(z){s.find("#req-type-loading").remove()}})},0)}function h(t){var s=/[\\\(\[*\.\?]/;if(!s.test(t)){t="\\w*"+t.replace(/[\.]/g,"\\$1")+"\\w*"}return t}function q(x,v){if(!v||!x){return 0}var u=new RegExp("\\b"+v+"\\b","g");var s=x.match(u);if(!s){return 0}var w=0;for(var t=0;t<s.length;t++){if(/[a-zA-Z0-9_.-]*/.test(s[t])){w++}}return w}function b(v,y,t){var u=null;for(var B=0;B<y.length;B++){if(y[B].pageId!=v){continue}if(u!=null){window.location.reload();return}u=y[B]}if(u==null){AJS.log("Replacing references: ",y);throw"No replacement found"}var x=u.action=="MAKE_REFERENCE";var w=document.createElement("a");w.setAttribute("data-requirement-key",u.key);w.setAttribute("id",(x?"req-link-":"req-")+u.key+(x?"-":""));w.setAttribute("href",AJS.contextPath()+u.url);if(u.spaceKey){w.setAttribute("data-space-key",u.spaceKey)}var C=x?"reuqirement-link-macro":"requirement-macro";var A=true;if(t){var s="";var z=t.split(/; ?/);for(var B in z){if(B==0){s+="color: "+z[B]+"; "}else{switch(d.trim(z[B])){case"bold":s+="font-weight: bold; ";break;case"italic":s+="font-style: italic; ";break;case"underlined":s+="text-decoration: underline; ";break;case"noborder":A=false;break}}}w.setAttribute("style",s)}if(A){C+=" aui-label"}w.setAttribute("class",C);m.range.surroundContents(w)}function f(){var s=d("#create-inline-requirement-form");var D=s.find(".create-inline-requirement-explanation");var u=s.find("#req-type");var E=u.find(":selected");var C=s.find("#type-name");var F=s.find(".new-type-group");var A=s.find(".description-parent");var z=E.val();var v=E.attr("data-ceoid");var x=d.trim(g);var y;if(v=="new"){y=o(x,C.val())}else{if(v=="inline"){y=o(x)}else{y=o(x,z)}}var t=q(r,h(y));D.toggleClass("hidden",!(v=="inline"));F.toggleClass("hidden",!(v=="new"));A.toggleClass("hidden",!(v!="inline"));d(".for-all-on-page-group").toggleClass("hidden",!(q(r,h(x))));d(".for-all-in-space-group").removeClass("hidden");var w=s.find(".transform-all-similar-group");w.removeClass("hidden");w.find("input").attr("data-pattern",y);var B=w.find("#pattern > input").val(y);if(B.size()==0){w.find("#pattern").text('"'+y+'"')}w.find("#pattern-count").text(t-1);s.find(".req-key-reference").text(x)}function o(u,v){var w;if(v){var s=u.indexOf(v);var t=u.charAt(s+v.length);if(a.test(t)){w=v+t}else{w=v}}else{w=u.replace(/^([A-Za-z0-9]+[^A-Za-z0-9]?).*$/,"$1")}return w}return{showCreateReqDialog:p,transformInline:function(){var v=window.getSelection();if(!v){throw"No selection in current window."}var t=v.getRangeAt(0);if(!t){throw"No selection range in current window."}if(t.collapsed){throw"Selection is empty. Can't create a requirement."}var u=Confluence.HighlightAction.RangeHelper.getRangeOption(t);var s=Confluence.HighlightAction.RangeHelper.getUserSelectionRange;Confluence.HighlightAction.RangeHelper.getUserSelectionRange=function(){return false};this.showCreateReqDialog(u);window.setTimeout(function(){Confluence.HighlightAction.RangeHelper.getUserSelectionRange=s},1500)},dialog:undefined,removeDialog:function(){RY.InlineCreationDialog.dialog&&RY.InlineCreationDialog.dialog.remove();d("#inline-dialog-create-requirement-yogi-dialog").remove();RY.InlineCreationDialog.dialog=undefined}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-jira-content:confluence-jira-content-loader', location = 'com/atlassian/confluence/plugins/createjiracontent/js/page-helper.js' */
AJS.toInit(function(d){var c="com.atlassian.confluence.plugins.confluence-jira-content:create-JIRA-issue-summary";var g="wr!com.atlassian.confluence.plugins.confluence-jira-content:confluence-jira-content-resources";var b="Loading\u2026";var e=false;var j=d("div.jira-issues-created");if(j.length>0){if(window.history&&window.history.replaceState){var h=window.location.href;var i=h.substr(0,h.indexOf("JIRAIssuesCreated")-1);window.history.replaceState({},document.title,i)}var a=j.find("#jira-content-message-panel-error-warning");var f=j.find("#jira-content-message-panel-view-more-link");f.click(function(k){k.preventDefault();f.hide();a.show()});if(j.hasClass("success")){setTimeout(function(){j.hide()},10000)}}Confluence&&Confluence.HighlightAction&&Confluence.HighlightAction.registerButtonHandler(c,{onClick:function(l){var k;if(!e){var m=function(o,n,p){o.html('<span class="aui-icon aui-icon-wait"></span> '+b);p();return false};k=d("<div>");Confluence.CreateJiraContent.Dialogs.appendDialogTarget(l.area.average,k);dialog=Confluence.ScrollingInlineDialog(k,"create-issue-loading-dialog",m,{});dialog.show();e=true}WRM.require(g).done(function(){if(Confluence.CreateJiraContent.FeatureDiscovery.shouldShowFeatureDiscovery()){Confluence.CreateJiraContent.Dialogs.showFeatureDiscoveryDialog(l)}else{Confluence.CreateJiraContent.Dialogs.showCreateIssueDialog(l)}if(typeof k!=="undefined"){k.remove()}})},shouldDisplay:Confluence.HighlightAction.WORKING_AREA.MAINCONTENT_ONLY});Confluence.CreateJiraContent={Dialogs:{}};Confluence.CreateJiraContent.Dialogs.appendDialogTarget=function(l,k){Confluence.DocThemeUtils.appendAbsolutePositionedElement(k);k.css({top:l.top,height:l.height,left:l.left,width:l.width,"z-index":-9999,position:"absolute"}).addClass("confluence-jira-content-dialog-target")}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-fixed-headers:utils', location = '/js/utils/dom.js' */
define("confluence/fh/utils/dom",["jquery","ajs","exports"],function(j,p,i){var q,d,a,n;function k(r){if(k.done&&!r){return}var s="#main .aui-page-panel-outer-content";d=j(s).length!==0?j(s):j("#main");a=j("#header");n=j("#main-header");k.done=true}function f(){var r=p.Meta.get("content-type");if(r==="page"||r==="blogpost"){j(tinymce.activeEditor.getWin().document).find("body#tinymce").addClass("page-edit")}}function o(){k();n.css({width:d.outerWidth()-(parseInt(d.css("padding-left"))+parseInt(d.css("padding-right")))})}function c(){k();var r=parseInt(n.css("top"))+n.outerHeight();if(isNaN(r)||r===c.lastValue){return}c.lastValue=r;p.trigger("sticky-table-headers.change.options",{fixedOffset:r,cacheHeaderHeight:true})}function e(t,r,s){if(s){e[s]=e[s]||{};if(r===e[s].lastValue){return}e[s].lastValue=r}t.css({transform:"translateY("+r+"px)","-webkit-transform":"translateY("+r+"px)","-ms-transform":"translateY("+r+"px)"})}function m(u,r,s){var t={};s.forEach(function(v){t[v]=u.css(v)});r.css(t)}var l={mt:"margin-top",mr:"margin-right",ml:"margin-left",mb:"margin-bottom",pt:"padding-top",pr:"padding-right",pl:"padding-left",pb:"padding-bottom",ff:"font-family",fsi:"font-size",fst:"font-style",fw:"font-weight",td:"text-decoration",ls:"letter-spacing",ta:"text-align",c:"color"};l.margin=[l.mt,l.mr,l.ml,l.mb];l.padding=[l.pt,l.pr,l.pl,l.pb];l.font=[l.ff,l.fsi,l.fst,l.fw];function b(){k();if(q){return q}q=j('<div id="main-header-placeholder"></div>');var t=j("#title-text"),s=t.find("a"),r=t.clone().removeAttr("id"),u=r.find("a");m(n,q,l.margin.concat(l.padding));q.css({height:n.outerHeight()});m(t,r,l.font.concat(l.td,l.ls,l.ta,l.pr,l.pb,l.pl,l.mr,l.mb,l.ml));r.css({paddingTop:parseInt(t.css("padding-top"))+Math.round(t.offset().top-n.offset().top)});m(s,u,l.font.concat(l.margin,l.padding,l.font,l.c,l.td,l.ls,l.ta));q.append(r);return q}function g(){q&&q.remove()}function h(t){t=typeof(t)==="string"?t:j(this).attr("href");if(!t){return}k();var s=a.outerHeight();var r=j(t.replace(/(!|\"|\$|%|&|'|\(|\)|\*|\+|,|\.|\/|\:|;|<|=|>|\?|@|\[|\\|\]|\^|`|\{|\||\}|~)/g,"\\$1"));if(r.length){window.scrollTo(0,r.offset().top-s);if(history&&"pushState" in history){history.pushState({},document.title,window.location.pathname+window.location.search+t);return false}}}i.forceInitialize=function(){k(true)};i.addClassToPage=f;i.adjustMainHeaderSize=o;i.updateTableStickyHeaderOption=c;i.translateVertical=e;i.createMainHeaderPlaceHolder=b;i.removeMainHeaderPlaceHolder=g;i.scrollIfAnchor=h});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-fixed-headers:handlers', location = '/js/handlers/page-view-handler.js' */
define("confluence/fh/handlers/page-view-handler",["confluence/fh/utils/dom","jquery","ajs","exports"],function(z,i,m,G){var E,s,D,n,v,d,C,h,e,w,F,r=false,l=false,f=false,j=0,u=0,g=0,y=50,b=100,q="by-hover",t="by-scroll",B="by-other",a=B,o=false;function c(H){if(c.done&&!H){return}E=i("#header");s=i("#main .aui-page-panel-outer-content");s.length===0&&(s=i("#main"));D=i("#main-header");n=i("#action-menu-link");v=z.createMainHeaderPlaceHolder();d=i(".ia-splitter-left .ia-fixed-sidebar");C=D.prop("style");h=s.prop("style");e=Math.round(E.offset().top);w=E.height();F=Math.round(D.offset().top)-w-(parseInt(s.css("padding-top"))+parseInt(D.css("margin-top")));c.done=true}var x=function(){c();var I=i(window).scrollTop();var K=I>e;if(K&&parseInt(d.css("top"))<w){d.css({top:w+"px"})}if(!r&&K){r=true;E.addClass("fixed-header");s.css({marginTop:w+"px"})}else{if(!K){E.removeClass("fixed-header");h.removeProperty("margin-top");r=false}}var O=I>F;if(!l&&O){l=true;D.find("#title-text").hide();D.css({position:"fixed",width:s.outerWidth()-(parseInt(s.css("padding-left"))+parseInt(s.css("padding-right"))),right:0,top:w+"px",marginTop:0,paddingTop:parseInt(s.css("padding-top"))+parseInt(D.css("margin-top")),paddingBottom:parseInt(s.css("padding-top"))+parseInt(D.css("margin-top")),paddingLeft:s.css("padding-left"),paddingRight:s.css("padding-right"),zIndex:b});D.before(z.createMainHeaderPlaceHolder())}else{if(!O){["position","width","right","top","margin-top","padding-top","padding-bottom","padding-left","padding-right","z-index"].forEach(function(P){C.removeProperty(P)});D.removeClass("overlay-header");D.find("#title-text").show();l=false;f=false;z.removeMainHeaderPlaceHolder()}}var M,L,J=D.outerHeight(),H=j-I,N=parseInt(D.css("top"))+H;if(I<=0){g=0;u=0;M=w}else{if(l&&H>0){if(N>w){g=w;u=0;M=w;L=b}else{g+=Math.abs(H);if(g>=y||I<=J){u-=Math.abs(H);M=N;L=b}}if(I>J+y&&!f){D.addClass("overlay-header");f=true}a=t}else{if(l&&H<0){if(N<w-J){g=0;u=J;M=w-J;L=0}else{u+=Math.abs(H);M=N}}}}if(L!==undefined&&M!==undefined){D.css({top:M+"px",zIndex:L})}else{if(M!==undefined){D.css({top:M+"px"})}}if(o){z.translateVertical(n,u,n.attr("id"))}z.updateTableStickyHeaderOption();j=I};function A(){if(!l||u===0){return}u=0;D.addClass("overlay-header");D.css({top:w+"px",zIndex:b});if(o){z.translateVertical(n,u,n.attr("id"))}z.updateTableStickyHeaderOption()}function p(){c();A();a=q}function k(){c();A();m.bind("quick-edit.viewport.saved",function(){E.removeAttr("style");z.removeMainHeaderPlaceHolder()});i(window).off("scroll",x).off("resize.confluence-fixed-headers-responsive");m.trigger("analyticsEvent",{name:"view.edit.transition.edit.button.clicked",data:{method:a}})}G.forceInitialize=function(){c(true)};G.onScrollHandler=x;G.onHoverActionMenuLinkHandler=p;G.onClickEditPageLinkHandler=k;G.isKeepDotDotDotButton=o;G.__getShowMainHeaderBy=function(){return a};G.__getFixedHeader=function(){return r};G.__getFixedMainHeader=function(){return l};G.__setFixedHeader=function(H){r=H};G.__setFixedMainHeader=function(H){l=H};G.__setMainHeaderOverlay=function(H){f=H};G.__setScrollPosition=function(H){j=H};G.__setMovingDistance=function(H){u=H}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-fixed-headers:confluence-fixed-headers-view-content-resources', location = '/js/confluence-fixed-headers.js' */
require(["confluence/fh/utils/dom","confluence/fh/handlers/page-view-handler","ajs","jquery"],function(d,b,a,c){a.toInit(function(){if(!a.Meta.get("content-type")){return}if(c("#main-content style").length>0){return}var e=c("#header"),l=c("#main-header"),i=c("#main"),g=c("#content"),k=c("#editPageLink"),m=c("#action-menu-link");var n=["inline-dialog-notifications-miniview","inline-dialog-confluence-watch","inline-dialog-shareContentPopup","inline-dialog-ap-inline-dialog-content-confstats-connect-dev__confstats-live-watcher","inline-dialog-jira-metadata-dialog"];var j=function(){var p=c('.aui-dropdown2[aria-hidden="false"]');p.length&&c('.aui-dropdown2-trigger[aria-owns="'+p.attr("id")+'"]').trigger("aui-button-invoke");var o=c(".aui-inline-dialog:visible");if(o.length){o=o.filter(function(){var s=c(this);var r=s.attr("id");return s.hasClass("non-persistence-dialog")||n.indexOf(r)!==-1});o.css({display:"none"});var q=".aui-button.active, .aui-nav-imagelink.active";e.find(q).removeClass("active");l.find(q).removeClass("active");document.activeElement.blur()}};var h=new MutationObserver(function(o){d.adjustMainHeaderSize()});h.observe(i[0],{attributes:true,attributeFilter:["style"]});var f=new MutationObserver(function(o){g.css("padding-right")==="0px"&&g.css({paddingRight:"28px"})});f.observe(g[0],{attributes:true,attributeFilter:["style"]});c(window).on("resize.confluence-fixed-headers-responsive",a.debounce(d.adjustMainHeaderSize,100)).on("scroll",b.onScrollHandler).scroll(a.debounceImmediate(j,250));if(b.isKeepDotDotDotButton){i.addClass("floating-action-menu");m.on("hover",b.onHoverActionMenuLinkHandler)}k.click(function(){f&&f.disconnect();b.onClickEditPageLinkHandler()});setTimeout(function(){d.scrollIfAnchor(window.location.hash)});c("body").on("click",'a[href^="#"]',d.scrollIfAnchor)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-like:content-like-resources', location = '/com/atlassian/confluence/plugins/like/js/like-namespace.js' */
define("confluence-like/like-namespace",["confluence/legacy"],function(a){return a.Likes||{}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-like/like-namespace","Confluence.Likes");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-like:content-like-resources', location = '/com/atlassian/confluence/plugins/like/js/like.js' */
define("confluence-like/like",["ajs","confluence/legacy","jquery","confluence/meta"],function(d,h,c,g){function o(b){return d.contextPath()+"/rest/likes/1.0/content/"+b+"/likes"}function r(){return 0<(g.get("remote-user")||"").length&&!1!==g.get("remote-user-has-licensed-access")}function p(b,a,e){var c=g.get("remote-user")||"",a=h.Likes.LikeSummaryFactory.getLikeSummary(b.likes,a,c);if(!a.key&&i()&&("page"==b.content_type||"blogpost"==b.content_type))a.text="Be the first to like this";c=[];
c.push(a.text);c=c.concat(a.args);(a=d.format.apply(d,c))&&0<a.length?e.html(a):e.empty();a&&(e.find(".likes").click(m.showLikeUsers),h.Binder.userHover(),"comment"==b.content_type&&e.prepend("<span class='comment-action-separator'>\u2022</span><span class='aui-icon aui-icon-small aui-iconfont-like-small'></span>"))}function l(b,a,e){var n=g.get("remote-user")||"";if(void 0===b)throw Error("type is required");if(void 0===a)throw Error("contentId is required");if(void 0===e)throw Error("contentType is required");
return function(){if("object"!==typeof this||!this.nodeType||1!==this.nodeType||"A"!==this.nodeName)throw Error("this handler should be bound to a DOM anchor element");var f=c(this),h=arguments.callee,i=f.next(".like-summary");c.ajax({type:b===j?"POST":"DELETE",url:o(a),contentType:"application/json",data:{"atlassian-token":g.get("atlassian-token")},dataType:"json",timeout:5E3}).fail(function(){var a=i.siblings(".like-error"),c;c=b===j?"Like failed":"Unlike failed";
0===a.length?i.after('<span class="like-error" title="'+c+'"></span>'):a.attr("title",c)}).success(function(){i.attr("data-liked",b===j);i.parent().find(".like-error").remove()});f.unbind("click",h).bind("click",b===j?l(q,a,e):l(j,a,e)).find(".like-button-text").html(b===j?"Unlike":"Like");k[a]=k[a]||{content_type:e,likes:[]};b===j?k[a].likes.push({user:{name:n}}):k[a].likes=c.grep(k[a].likes,function(a){return a.user.name!=n});b===j&&d.trigger("analytics",
{name:"confluence."+e+".like.create",data:{pageID:g.get("page-id")}});p(k[a],a,i);return!1}}var j=0,q=1,f,k={},i=r,s=c.Deferred(),m={getLikesCache:function(){return s.promise()},showLikeUsers:function(b){b&&b.preventDefault();b=c(this).data("content-id");f&&(f.remove(),f=void 0);f=new d.Dialog(400,365,"likes-dialog");f.addHeader("People who like this");f.addPanel("Panel 1","<div class='spinner-container'></div>");f.addCancel("Close",function(a){a.remove();f=
void 0});f.getCurrentPanel().setPadding(0);var a=f,e=f.show,n=d.dim;d.dim=function(){};try{e.apply(a,[])}finally{d.dim=n}c.ajax({type:"GET",url:o(b),data:{expand:"user",max:50},dataType:"json"}).done(function(a){if(f.popup.element.is(":visible")){a.showFollowActions=r();f.getCurrentPanel().html(h.Templates.Likes.likesDialog(a));c("#likes-dialog").find(".likes-dialog-follow-button").click(function(){var a=c(this);c.ajax({type:"PUT",url:d.contextPath()+"/rest/likes/1.0/user/"+g.get("remote-user")+"/following?username="+
a.data("username"),contentType:"application/json",dataType:"json"}).done(function(){a.replaceWith("Following")})})}})},appendAction:function(b){var b=b.find(".comment-actions-primary"),a=b.find("li[class~='comment-date']"),e=c(h.Templates.Likes.commentLikeSection({showLikeButton:i()}));0===a.length?b.find("li:last-child").after(e):a.before(e)},reload:function(b){c.each(b,function(a,b){var d=c("#comment-"+a).find(".like-summary");p(b,a,d);k[a]=b});!i()&&c("#page-comments").find(".like-summary:empty").each(function(){c(this).closest(".comment-action-like").hide()});
c("#page-comments .comment").each(function(){m.updateComment(c(this),b)});s.resolve(k)},updateComment:function(b,a){var e=b.attr("id");if(!e)return!0;var f=(/^comment-(\d+)$/.exec(e)||[])[1];if(!f)throw Error('Expecting ID attribute of comment to be in format "comment-XXX", found: '+e);e=a[f]&&g.get("remote-user")&&0<c.grep(a[f].likes,function(a){return a.user.name==g.get("remote-user")}).length;b.find(".like-button").click(e?l(q,f,"comment"):l(j,f,"comment")).find(".like-button-text").html(e?"Unlike":
"Like")},init:function(){var b=c(h.Templates.Likes.likeSection({showLikeButton:i()}));g.get("page-id")&&c.ajax({type:"GET",url:o(g.get("page-id")),data:{commentLikes:!0},dataType:"json"}).done(function(a){if(g.get("remote-user")){var e=0<c.grep(a.likes,function(a){return a.user.name==g.get("remote-user")}).length,f=a.content_type;b.find(".like-button").click(e?l(q,g.get("page-id"),f):l(j,g.get("page-id"),f)).find(".like-button-text").html(e?"Unlike":"Like")}e=
b.find(".like-summary");p(a,a.content_id,e);""==e.html()&&!i()&&b.hide();c("<div id='likes-and-labels-container' />").insertBefore("#labels-section").append(b).append(c("#labels-section"));k[a.content_id]=a;m.reload(a.commentLikes)});m.appendAction(c("#page-comments"))}};return m});
require("confluence/module-exporter").safeRequire("confluence-like/like",function(d){var h=require("confluence/legacy"),c=require("ajs");h.Likes.getLikesCache=d.getLikesCache;c.PageGadget||window.parent.AJS&&window.parent.AJS.PageGadget||(c.toInit(d.init),h.Likes.showLikeUsers=d.showLikeUsers,h.Likes.appendAction=d.appendAction,h.Likes.reload=d.reload,h.Likes.updateComment=d.updateComment)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-like:content-like-resources', location = '/com/atlassian/confluence/plugins/like/js/like-summary-factory.js' */
define("confluence-like/like-summary-factory",["ajs","confluence/templates","jquery"],function(a,g,h){var i={"likes.summary.you":"You like this","likes.summary.1.promoted":"{0} likes this","likes.summary.2.promoted":"{0} and {1} like this","likes.summary.3.promoted":"{0}, {1} and {2} like this","likes.summary.1.non-promoted":"{0} likes this","likes.summary.x.non-promoted":"\u003ca href=\"\" {1}\u003e{0} people\u003c/a\u003e like this",
"likes.summary.you.1.promoted":"You and {0} like this","likes.summary.you.2.promoted":"You, {0} and {1} like this","likes.summary.you.3.promoted":"You, {0}, {1} and {2} like this","likes.summary.you.1.non-promoted":"You and {0} like this","likes.summary.you.x.non-promoted":"You and \u003ca href=\"\" {1}\u003e{0} others\u003c/a\u003e like this","likes.summary.1.promoted.1.non-promoted":"{0} and {1} like this",
"likes.summary.1.promoted.x.non-promoted":"{0} and \u003ca href=\"\" {2}\u003e{1} others\u003c/a\u003e like this","likes.summary.2.promoted.1.non-promoted":"{0}, {1} and {2} like this","likes.summary.2.promoted.x.non-promoted":"{0}, {1} and \u003ca href=\"\" {3}\u003e{2} others\u003c/a\u003e like this","likes.summary.3.promoted.1.non-promoted":"{0}, {1}, {2} and {3} like this","likes.summary.3.promoted.x.non-promoted":"{0}, {1}, {2} and \u003ca href=\"\" {4}\u003e{3} others\u003c/a\u003e like this","likes.summary.you.1.promoted.1.non-promoted":"You, {0} and {1} like this",
"likes.summary.you.1.promoted.x.non-promoted":"You, {0} and \u003ca href=\"\" {2}\u003e{1} others\u003c/a\u003e like this","likes.summary.you.2.promoted.1.non-promoted":"You, {0}, {1} and {2} like this","likes.summary.you.2.promoted.x.non-promoted":"You, {0}, {1} and \u003ca href=\"\" {3}\u003e{2} others\u003c/a\u003e like this","likes.summary.you.3.promoted.1.non-promoted":"You, {0}, {1}, {2} and {3} like this","likes.summary.you.3.promoted.x.non-promoted":"You, {0}, {1}, {2} and \u003ca href=\"\" {4}\u003e{3} others\u003c/a\u003e like this"};
return{getLikeSummary:function(a,c,k){if(!a||0===a.length)return{key:"",text:""};if(!c)throw Error("contentId is required.");var j,e=[],f=[];h.each(a,function(a,b){b.user&&b.user.name==k?j=b:3>e.length&&b.user.followedByRemoteUser?e.push(b):f.push(b)});var a=["likes.summary"],d=[];null!=j&&a.push(".you");0<e.length&&(a.push("."),a.push(e.length),a.push(".promoted"),h.each(e,function(a,b){d.push(g.Likes.userLink(b))}));1===f.length?(a.push(".1.non-promoted"),d.push(g.Likes.userLink(f[0]))):1<f.length&&
(a.push(".x.non-promoted"),d.push(f.length),d.push('class="likes" data-content-id="'+c+'"'));c=a.join("");return{key:c,args:0===d.length?void 0:d,text:c in i?i[c]:""}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-like/like-summary-factory","Confluence.Likes.LikeSummaryFactory");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-like:content-like-resources', location = '/templates/com/atlassian/confluence/plugins/like/soy/like.soy' */
// This file was automatically generated from like.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Likes.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Likes == 'undefined') { Confluence.Templates.Likes = {}; }


Confluence.Templates.Likes.likeButton = function(opt_data, opt_ignored) {
  return '<a href="" class="like-button">' + ((opt_data.useIcon) ? '<span class="aui-icon aui-icon-small aui-iconfont-like"></span>' : '') + '<span class="like-button-text">' + soy.$$escapeHtml("Like") + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Likes.likeButton.soyTemplateName = 'Confluence.Templates.Likes.likeButton';
}


Confluence.Templates.Likes.likeSection = function(opt_data, opt_ignored) {
  return '<div id="likes-section">' + ((opt_data.showLikeButton) ? Confluence.Templates.Likes.likeButton({useIcon: true}) : '') + '<span class="like-summary"></span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Likes.likeSection.soyTemplateName = 'Confluence.Templates.Likes.likeSection';
}


Confluence.Templates.Likes.commentLikeSection = function(opt_data, opt_ignored) {
  return '<li class="comment-action-like">' + ((opt_data.showLikeButton) ? Confluence.Templates.Likes.likeButton({useIcon: false}) : '') + '<span class="like-summary"></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Likes.commentLikeSection.soyTemplateName = 'Confluence.Templates.Likes.commentLikeSection';
}


Confluence.Templates.Likes.likesDialog = function(opt_data, opt_ignored) {
  var output = '<div id="likes-dialog-body"><ol>';
  var likeList26 = opt_data.likes;
  var likeListLen26 = likeList26.length;
  for (var likeIndex26 = 0; likeIndex26 < likeListLen26; likeIndex26++) {
    var likeData26 = likeList26[likeIndex26];
    output += '<li><div class="avatar-container"><a href="' + soy.$$escapeHtml(likeData26.user.url) + '"><img class="like-user-avatar" src="' + soy.$$escapeHtml(likeData26.user.avatarUrl) + '"></a></div><div class="like-user"><a class="like-user-link" href="' + soy.$$escapeHtml(likeData26.user.url) + '">' + soy.$$escapeHtml(likeData26.user.fullName) + '</a></div>' + ((opt_data.showFollowActions) ? '<div class="follow-button-container aui-toolbar"><ul class="toolbar-group"><li class="toolbar-item">' + ((likeData26.user.followedByRemoteUser) ? soy.$$escapeHtml("Following") : '<button data-username="' + soy.$$escapeHtml(likeData26.user.name) + '" class="likes-dialog-follow-button toolbar-trigger">' + soy.$$escapeHtml("Follow") + '</button>') + '</li></ul></div>' : '') + '</li>';
  }
  output += '</ol></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Likes.likesDialog.soyTemplateName = 'Confluence.Templates.Likes.likesDialog';
}


Confluence.Templates.Likes.userLink = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml(opt_data.user.url) + '" class="confluence-userlink" data-username="' + soy.$$escapeHtml(opt_data.user.name) + '">' + soy.$$escapeHtml(opt_data.user.fullName) + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Likes.userLink.soyTemplateName = 'Confluence.Templates.Likes.userLink';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:shared-templates', location = '/includes/soy/user.soy' */
// This file was automatically generated from user.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.User.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.User == 'undefined') { Confluence.Templates.User = {}; }


Confluence.Templates.User.userLinkUrl = function(opt_data, opt_ignored) {
  return soy.$$escapeHtml("") + '/display/~' + soy.$$escapeUri(opt_data.username);
};
if (goog.DEBUG) {
  Confluence.Templates.User.userLinkUrl.soyTemplateName = 'Confluence.Templates.User.userLinkUrl';
}


Confluence.Templates.User.logo = function(opt_data, opt_ignored) {
  return '' + ((opt_data.profilePictureInfo['default'] && opt_data.username == opt_data.currentUsername) ? '<a ' + ((opt_data.canView) ? ' ' + ((! opt_data.disableUserHover) ? 'class="userLogoLink"' : '') + ' data-username="' + soy.$$escapeHtml(opt_data.username) + '"' : '') + ' href="' + soy.$$escapeHtml("") + '/users/profile/editmyprofilepicture.action" title="' + soy.$$escapeHtml("Add a picture of yourself") + '"><img class="userLogo logo defaultLogo" src="' + soy.$$escapeHtml("/s/en_GB/6211/3938a2601e8fc8d1decf2078567a8651fae8f539.10/_") + '/images/icons/profilepics/add_profile_pic.png" alt="' + soy.$$escapeHtml("User icon") + ': ' + soy.$$escapeHtml("Add a picture of yourself") + '"></a>' : (opt_data.profilePictureInfo.anonymous) ? '<img class="userLogo logo anonymous" src="' + soy.$$escapeHtml("/s/en_GB/6211/3938a2601e8fc8d1decf2078567a8651fae8f539.10/_") + '/images/icons/profilepics/anonymous.png" alt="' + soy.$$escapeHtml("User icon") + ': ' + soy.$$escapeHtml("Anonymous") + '" title="' + soy.$$escapeHtml("Anonymous") + '">' : (opt_data.canView) ? '<a ' + ((! opt_data.disableUserHover) ? 'class="userLogoLink"' : '') + ' data-username="' + soy.$$escapeHtml(opt_data.username) + '" href="' + Confluence.Templates.User.userLinkUrl(opt_data) + '"><img class="userLogo logo" src="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.profilePictureInfo.downloadPath) + '" alt="' + soy.$$escapeHtml("User icon") + ': ' + soy.$$escapeHtml(opt_data.username) + '" title="' + soy.$$escapeHtml(opt_data.username) + '"></a>' : '<img class="userLogo logo anonymous" src="' + soy.$$escapeHtml("/s/en_GB/6211/3938a2601e8fc8d1decf2078567a8651fae8f539.10/_") + '/images/icons/profilepics/anonymous.png" alt="' + soy.$$escapeHtml("User icon") + ': ' + soy.$$escapeHtml(opt_data.username) + '" title="' + soy.$$escapeHtml(opt_data.username) + '">');
};
if (goog.DEBUG) {
  Confluence.Templates.User.logo.soyTemplateName = 'Confluence.Templates.User.logo';
}


Confluence.Templates.User.usernameLink = function(opt_data, opt_ignored) {
  return '' + ((opt_data.username && opt_data.username != '') ? '<a href="' + Confluence.Templates.User.userLinkUrl(opt_data) + '"' + ((opt_data.canView) ? 'class="url fn confluence-userlink" data-username="' + soy.$$escapeHtml(opt_data.username) + '"' : 'class="url fn"') + '>' + ((opt_data.fullName && opt_data.fullName != '') ? soy.$$escapeHtml(opt_data.fullName) : soy.$$escapeHtml(opt_data.username)) + '</a>' : soy.$$escapeHtml("Anonymous"));
};
if (goog.DEBUG) {
  Confluence.Templates.User.usernameLink.soyTemplateName = 'Confluence.Templates.User.usernameLink';
}


Confluence.Templates.User.fullNameOrAnonymous = function(opt_data, opt_ignored) {
  return '' + ((opt_data.user && opt_data.user.fullName) ? soy.$$escapeHtml(opt_data.user.fullName) : soy.$$escapeHtml("Anonymous"));
};
if (goog.DEBUG) {
  Confluence.Templates.User.fullNameOrAnonymous.soyTemplateName = 'Confluence.Templates.User.fullNameOrAnonymous';
}


Confluence.Templates.User.usernameOrAnonymous = function(opt_data, opt_ignored) {
  return '' + ((opt_data.user && opt_data.user.name) ? soy.$$escapeHtml(opt_data.user.name) : soy.$$escapeHtml("Anonymous"));
};
if (goog.DEBUG) {
  Confluence.Templates.User.usernameOrAnonymous.soyTemplateName = 'Confluence.Templates.User.usernameOrAnonymous';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:shared-templates', location = '/includes/soy/icons.soy' */
// This file was automatically generated from icons.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Icons.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Icons == 'undefined') { Confluence.Templates.Icons = {}; }


Confluence.Templates.Icons.contentIcon = function(opt_data, opt_ignored) {
  return '' + ((opt_data.content.type == 'trackback') ? '<a' + ((opt_data.linkColour) ? ' ' + soy.$$escapeHtml(opt_data.linkColour) : '') + ' href="' + soy.$$escapeHtml(opt_data.linkHref) + '" class="icon icon-trackback" title="' + soy.$$escapeHtml("Track back") + '">' + soy.$$escapeHtml("Track back") + ':</a>' : '<a' + ((opt_data.linkColour) ? ' ' + soy.$$escapeHtml(opt_data.linkColour) : '') + ' href="' + soy.$$escapeHtml(opt_data.linkHref) + '" class="icon ' + soy.$$escapeHtml(opt_data.iconCss) + '" title="' + soy.$$escapeHtml(opt_data.iconTitle) + '">' + soy.$$escapeHtml(opt_data.iconTitle) + '</a>');
};
if (goog.DEBUG) {
  Confluence.Templates.Icons.contentIcon.soyTemplateName = 'Confluence.Templates.Icons.contentIcon';
}


Confluence.Templates.Icons.contentIconFont = function(opt_data, opt_ignored) {
  return '' + ((opt_data.content.type == 'trackback') ? '<a' + ((opt_data.linkColour) ? ' ' + soy.$$escapeHtml(opt_data.linkColour) : '') + ' href="' + soy.$$escapeHtml(opt_data.linkHref) + '" class="icon icon-trackback" title="' + soy.$$escapeHtml("Track back") + '">' + soy.$$escapeHtml("Track back") + ':</a>' : '<a' + ((opt_data.linkColour) ? ' ' + soy.$$escapeHtml(opt_data.linkColour) : '') + ' href="' + soy.$$escapeHtml(opt_data.linkHref) + '" title="' + soy.$$escapeHtml(opt_data.iconTitle) + '"><span class="icon ' + soy.$$escapeHtml(opt_data.iconCss) + '">' + soy.$$escapeHtml(opt_data.iconTitle) + '</span></a>');
};
if (goog.DEBUG) {
  Confluence.Templates.Icons.contentIconFont.soyTemplateName = 'Confluence.Templates.Icons.contentIconFont';
}


Confluence.Templates.Icons.iconSpan = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<span class="icon' + ((opt_data.type) ? ' icon-' + soy.$$escapeHtml(opt_data.type) : '') + ' ' + ((opt_data.additionalClasses) ? soy.$$escapeHtml(opt_data.additionalClasses) : '') + '">' + ((opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '') + '</span>';
};
if (goog.DEBUG) {
  Confluence.Templates.Icons.iconSpan.soyTemplateName = 'Confluence.Templates.Icons.iconSpan';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:shared-templates', location = '/includes/soy/captcha.soy' */
// This file was automatically generated from captcha.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Captcha.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Captcha == 'undefined') { Confluence.Templates.Captcha = {}; }


Confluence.Templates.Captcha.form = function(opt_data, opt_ignored) {
  var output = '<div class="captcha field-group"><label id="captcha-response-label" for="captcha-response"><span class="assistive">' + soy.$$escapeHtml("If you are unable to use this CAPTCHA please \x3ca href\x3d\x22administrators.action\x22 tabindex\x3d\x225\x22\x3econtact your administrator\x3c/a\x3e for assistance.") + '</span></label>' + Confluence.Templates.Captcha.image(opt_data) + '<input type="text" id="captcha-response" name="captchaResponse" value="" class="text" placeholder="' + soy.$$escapeHtml("Type the word above") + '">';
  if (opt_data.captchaErrors && opt_data.captchaErrors.length) {
    var errorList13 = opt_data.captchaErrors;
    var errorListLen13 = errorList13.length;
    for (var errorIndex13 = 0; errorIndex13 < errorListLen13; errorIndex13++) {
      var errorData13 = errorList13[errorIndex13];
      output += aui.message.warning({content: errorData13});
    }
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Captcha.form.soyTemplateName = 'Confluence.Templates.Captcha.form';
}


Confluence.Templates.Captcha.image = function(opt_data, opt_ignored) {
  return '<img src="' + soy.$$escapeHtml("") + '/jcaptcha?id=' + soy.$$escapeHtml(opt_data.captchaId) + '" class="captcha-image" alt="' + soy.$$escapeHtml("CAPTCHA image") + '"><input type="hidden" name="captchaId" value="' + soy.$$escapeHtml(opt_data.captchaId) + '" placeholder="' + soy.$$escapeHtml("Type the word above") + '">';
};
if (goog.DEBUG) {
  Confluence.Templates.Captcha.image.soyTemplateName = 'Confluence.Templates.Captcha.image';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:shared-templates', location = '/includes/soy/notifications.soy' */
// This file was automatically generated from notifications.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Notifications.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Notifications == 'undefined') { Confluence.Templates.Notifications = {}; }


Confluence.Templates.Notifications.notLoggedIn = function(opt_data, opt_ignored) {
  return '' + ((! opt_data.isUserAuthenticated) ? '<div id="anonymous-warning" class="aui-message warning closeable">' + soy.$$filterNoAutoescape("You are not logged in. Any changes you make will be marked as \x3cspan class\x3d\x22smalltext\x22\x3eanonymous\x3c/span\x3e.") + ((! opt_data.isExternalUserManagementEnabled) ? ' ' + soy.$$filterNoAutoescape(AJS.format("You may want to \x3ca href\x3d\x22{0}\x22\x3eLog In\x3c/a\x3e if you already have an account.",opt_data.loginURL)) : '') + '</div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Notifications.notLoggedIn.soyTemplateName = 'Confluence.Templates.Notifications.notLoggedIn';
}


Confluence.Templates.Notifications.actionErrors = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.actionErrors.length > 0) {
    output += '<div class="aui-message aui-message-error ' + ((opt_data.closeable) ? 'closeable' : '') + '"><p class="title">' + soy.$$escapeHtml("The following error(s) occurred:") + '</p><span class="aui-icon icon-error"></span><ul>';
    var errorHtmlList24 = opt_data.actionErrors;
    var errorHtmlListLen24 = errorHtmlList24.length;
    for (var errorHtmlIndex24 = 0; errorHtmlIndex24 < errorHtmlListLen24; errorHtmlIndex24++) {
      var errorHtmlData24 = errorHtmlList24[errorHtmlIndex24];
      output += '<li>' + soy.$$filterNoAutoescape(errorHtmlData24) + '</li>';
    }
    output += '</ul></div>';
  }
  output += '<div id="action-messages"></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Notifications.actionErrors.soyTemplateName = 'Confluence.Templates.Notifications.actionErrors';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api', location = 'browser-metrics.js' */
(function(){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.0.0
 */
var j,y,e,r,p,x,F,G,u,q,H,K,J,s,i,f,m,D,v,n,L,B,O,l,z,h,g,C,o,d,w,c,Q,I,a,E,b,M,N,t,P;(function(){function aL(a3){return typeof a3==="function"||typeof a3==="object"&&a3!==null}function aj(a3){return typeof a3==="function"}function a1(a3){return typeof a3==="object"&&a3!==null}var aY;if(!Array.isArray){aY=function(a3){return Object.prototype.toString.call(a3)==="[object Array]"}}else{aY=Array.isArray}var aD=aY;var ao=Date.now||function(){return new Date().getTime()};function ar(){}var W=Object.create||function(a3){if(arguments.length>1){throw new Error("Second argument not supported")}if(typeof a3!=="object"){throw new TypeError("Argument must be an object")}ar.prototype=a3;return new ar()};var aW=0;var af=function aJ(a4,a3){aV[aW]=a4;aV[aW+1]=a3;aW+=2;if(aW===2){T()}};var aC=typeof window!=="undefined"?window:{};var am=aC.MutationObserver||aC.WebKitMutationObserver;var ae=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function aG(){return function(){process.nextTick(aX)}}function aR(){var a5=0;var a3=new am(aX);var a4=document.createTextNode("");a3.observe(a4,{characterData:true});return function(){a4.data=a5=++a5%2}}function aH(){var a3=new MessageChannel();a3.port1.onmessage=aX;return function(){a3.port2.postMessage(0)}}function aN(){return function(){setTimeout(aX,1)}}var aV=new Array(1000);function aX(){for(var a4=0;a4<aW;a4+=2){var a5=aV[a4];var a3=aV[a4+1];a5(a3);aV[a4]=undefined;aV[a4+1]=undefined}aW=0}var T;if(typeof process!=="undefined"&&{}.toString.call(process)==="[object process]"){T=aG()}else{if(am){T=aR()}else{if(ae){T=aH()}else{T=aN()}}}function ah(){}var at=void 0;var aO=1;var au=2;var aU=new a0();function aS(){return new TypeError("You cannot resolve a promise with itself")}function aB(){return new TypeError("A promises callback cannot return that same promise.")}function aK(a4){try{return a4.then}catch(a3){aU.error=a3;return aU}}function V(a7,a5,a4,a3){try{a7.call(a5,a4,a3)}catch(a6){return a6}}function aM(a5,a3,a4){af(function(a8){var a7=false;var a6=V(a4,a3,function(a9){if(a7){return}a7=true;if(a3!==a9){ac(a8,a9)}else{ab(a8,a9)}},function(a9){if(a7){return}a7=true;aA(a8,a9)},"Settle: "+(a8._label||" unknown promise"));if(!a7&&a6){a7=true;aA(a8,a6)}},a5)}function X(a4,a3){if(a3._state===aO){ab(a4,a3._result)}else{if(a4._state===au){aA(a4,a3._result)}else{a2(a3,undefined,function(a5){ac(a4,a5)},function(a5){aA(a4,a5)})}}}function Y(a5,a3){if(a3.constructor===a5.constructor){X(a5,a3)}else{var a4=aK(a3);if(a4===aU){aA(a5,aU.error)}else{if(a4===undefined){ab(a5,a3)}else{if(aj(a4)){aM(a5,a3,a4)}else{ab(a5,a3)}}}}}function ac(a4,a3){if(a4===a3){aA(a4,aS())}else{if(aL(a3)){Y(a4,a3)}else{ab(a4,a3)}}}function aF(a3){if(a3._onerror){a3._onerror(a3._result)}aa(a3)}function ab(a4,a3){if(a4._state!==at){return}a4._result=a3;a4._state=aO;if(a4._subscribers.length===0){}else{af(aa,a4)}}function aA(a4,a3){if(a4._state!==at){return}a4._state=au;a4._result=a3;af(aF,a4)}function a2(a3,a8,a7,a6){var a5=a3._subscribers;var a4=a5.length;a3._onerror=null;a5[a4]=a8;a5[a4+aO]=a7;a5[a4+au]=a6;if(a4===0&&a3._state){af(aa,a3)}}function aa(a7){var a6=a7._subscribers;var a3=a7._state;if(a6.length===0){return}var a9,a8,a5=a7._result;for(var a4=0;a4<a6.length;a4+=3){a9=a6[a4];a8=a6[a4+a3];if(a9){aQ(a3,a9,a8,a5)}else{a8(a5)}}a7._subscribers.length=0}function a0(){this.error=null}var ai=new a0();function az(a5,a3){try{return a5(a3)}catch(a4){ai.error=a4;return ai}}function aQ(a9,bb,a8,a5){var a3=aj(a8),a7,a6,ba,a4;if(a3){a7=az(a8,a5);if(a7===ai){a4=true;a6=a7.error;a7=null}else{ba=true}if(bb===a7){aA(bb,aB());return}}else{a7=a5;ba=true}if(bb._state!==at){}else{if(a3&&ba){ac(bb,a7)}else{if(a4){aA(bb,a6)}else{if(a9===aO){ab(bb,a7)}else{if(a9===au){aA(bb,a7)}}}}}}function Z(a7,a6){try{a6(function a3(a8){ac(a7,a8)},function a5(a8){aA(a7,a8)})}catch(a4){aA(a7,a4)}}function aZ(a5,a3,a4){if(a5===aO){return{state:"fulfilled",value:a4}}else{return{state:"rejected",reason:a4}}}function aT(a5,a3,a6,a4){this._instanceConstructor=a5;this.promise=new a5(ah,a4);this._abortOnReject=a6;if(this._validateInput(a3)){this._input=a3;this.length=a3.length;this._remaining=a3.length;this._init();if(this.length===0){ab(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){ab(this.promise,this._result)}}}else{aA(this.promise,this._validationError())}}aT.prototype._validateInput=function(a3){return aD(a3)};aT.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")};aT.prototype._init=function(){this._result=new Array(this.length)};var aE=aT;aT.prototype._enumerate=function(){var a5=this.length;var a6=this.promise;var a3=this._input;for(var a4=0;a6._state===at&&a4<a5;a4++){this._eachEntry(a3[a4],a4)}};aT.prototype._eachEntry=function(a4,a3){var a5=this._instanceConstructor;if(a1(a4)){if(a4.constructor===a5&&a4._state!==at){a4._onerror=null;this._settledAt(a4._state,a3,a4._result)}else{this._willSettleAt(a5.resolve(a4),a3)}}else{this._remaining--;this._result[a3]=this._makeResult(aO,a3,a4)}};aT.prototype._settledAt=function(a5,a3,a4){var a6=this.promise;if(a6._state===at){this._remaining--;if(this._abortOnReject&&a5===au){aA(a6,a4)}else{this._result[a3]=this._makeResult(a5,a3,a4)}}if(this._remaining===0){ab(a6,this._result)}};aT.prototype._makeResult=function(a5,a3,a4){return a4};aT.prototype._willSettleAt=function(a4,a3){var a5=this;a2(a4,undefined,function(a6){a5._settledAt(aO,a3,a6)},function(a6){a5._settledAt(au,a3,a6)})};var ap=function an(a3,a4){return new aE(this,a3,true,a4).promise};var av=function ad(a3,a4){var ba=this;var a9=new ba(ah,a4);if(!aD(a3)){aA(a9,new TypeError("You must pass an array to race."));return a9}var a6=a3.length;function a8(bb){ac(a9,bb)}function a7(bb){aA(a9,bb)}for(var a5=0;a9._state===at&&a5<a6;a5++){a2(ba.resolve(a3[a5]),undefined,a8,a7)}return a9};var al=function aq(a4,a3){var a6=this;if(a4&&typeof a4==="object"&&a4.constructor===a6){return a4}var a5=new a6(ah,a3);ac(a5,a4);return a5};var S=function ax(a4,a3){var a6=this;var a5=new a6(ah,a3);aA(a5,a4);return a5};var ay=0;function aP(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ag(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var aI=U;function U(a3){this._id=ay++;this._state=undefined;this._result=undefined;this._subscribers=[];if(ah!==a3){if(!aj(a3)){aP()}if(!(this instanceof U)){ag()}Z(this,a3)}}U.all=ap;U.race=av;U.resolve=al;U.reject=S;U.prototype={constructor:U,then:function(a7,a6){var a4=this;var a5=a4._state;if(a5===aO&&!a7||a5===au&&!a6){return this}var a9=new this.constructor(ah);var a3=a4._result;if(a5){var a8=arguments[a5-1];af(function(){aQ(a5,a9,a8,a3)})}else{a2(a4,a9,a7,a6)}return a9},"catch":function(a3){return this.then(null,a3)}};var ak=function R(){var a4;if(typeof global!=="undefined"){a4=global}else{if(typeof window!=="undefined"&&window.document){a4=window}else{a4=self}}var a3="Promise" in a4&&"resolve" in a4.Promise&&"reject" in a4.Promise&&"all" in a4.Promise&&"race" in a4.Promise&&function(){var a5;new a4.Promise(function(a6){a5=a6});return aj(a5)}();if(!a3){a4.Promise=aI}};var aw={Promise:aI,polyfill:ak};if(true){j=function(){return aw}()}else{if(typeof module!=="undefined"&&module.exports){module.exports=aw}else{if(typeof this!=="undefined"){this["ES6Promise"]=aw}}}}.call(this));y=function(S){var R=S.Promise;return R}(j);e=function(){return window}();r=function(T){var S=T.HTMLElement.prototype;var R=S.matches||S.msMatchesSelector||S.webkitMatchesSelector||S.mozMatchesSelector||S.oMatchesSelector;return R}(e);p=function k(R){var S=false;return function(){if(!S){S=true;setTimeout(function(){S=false;R()},1)}}};x=function(R,U){function T(X){this.callback=X;this.elements=[]}T.prototype={observe:function(ae,am){function Y(an){al.push(an);X()}function ak(ap){var ao=ap.target;if(!ao){return}var an=ao.parentNode;if(!af(an)){return}if(aj&&W(aj,ao)){return}if(!ah||ah.target!==an){ag.push(ah=V(an))}if(an){if(!ah.addedNodes){ah.addedNodes=[]}ah.addedNodes.push(ao)}else{if(!ah.removedNodes){ah.removedNodes=[]}ah.removedNodes.push(ao)}aj=ao}function ad(an){return am.attributes&&(am.subtree||an===ae)}function af(an){return am.childList&&(am.subtree||an===ae)}var ab=this;var aj;var ah;var al=[];var ag=[];var X=R(function(){var an=al.length;for(var ao=0;ao<an;ao++){ak(al[ao])}ab.callback(ag);al=[];ag=[];aj=undefined;ah=undefined});var ai={};var aa=[];var ac=R(function(){var an=aa.length;ab.callback(aa);aa.splice(0,an)});var Z={target:ae,options:am,insertHandler:Y,removeHandler:Y,attributeHandler:function(at){var aq=at.target;if(!ad(aq)){return}var ao=at.attrName;var ap=at.prevValue;var ar=at.newValue;var an=V(aq,"attributes");an.attributeName=ao;if(am.attributeOldValue){an.oldValue=ai[ao]||ap||null}aa.push(an);if(am.attributeOldValue){ai[ao]=ar}ac()}};this.elements.push(Z);if(am.childList){ae.addEventListener("DOMNodeInserted",Z.insertHandler);ae.addEventListener("DOMNodeRemoved",Z.removeHandler)}if(am.attributes){ae.addEventListener("DOMAttrModified",Z.attributeHandler)}return this},disconnect:function(){this.elements.forEach(function(X){X.target.removeEventListener("DOMNodeInserted",X.insertHandler);X.target.removeEventListener("DOMNodeRemoved",X.removeHandler);X.target.removeEventListener("DOMAttrModified",X.attributeHandler)});this.elements=[];return this}};function V(Y,X){return{addedNodes:null,attributeName:null,attributeNamespace:null,nextSibling:null,oldValue:null,previousSibling:null,removedNodes:null,target:Y,type:X||"childList"}}var S=U.HTMLElement.prototype.contains;function W(X,Y){if(X.nodeType!==1){return false}return X.contains?X.contains(Y):S.call(X,Y)}return T}(p,e);F=function(S,R){return R.MutationObserver||R.WebkitMutationObserver||R.MozMutationObserver||S}(x,e);G=function(){function R(){this._items={};this.length=0}R.prototype.add=function(T,S){if(!this._items.hasOwnProperty(T)){this.length++;this._items[T]=[]}this._items[T].push(S)};R.prototype.remove=function(V,T){var S,U=false;if(this._items.hasOwnProperty(V)){if(arguments.length===1){delete this._items[V];U=true}else{S=this._items[V].indexOf(T);if(S>-1){this._items[V].splice(S,1);if(this._items[V].length===0){delete this._items[V]}U=true}}}return U};R.prototype.get=function(S){if(this._items.hasOwnProperty(S)){return this._items[S]}return[]};R.prototype.forEach=function(T){var S=this._items;Object.keys(S).forEach(function(U){T(S[U],U)})};return R}();u=function(aa,ab,T,V,X){var Z,U=false,W;W=new V();function S(ac,ad){if(!U){Z.observe(X.document,{attributes:true,childList:true,subtree:true});U=true}W.add(ac,ad)}function Y(ac,ad){W.remove.apply(W,arguments);if(W.length===0){Z.disconnect();U=false}}Z=new T(function(ac){ac.forEach(function(ae){var ad=ae.type==="childList"&&ae.addedNodes&&ae.addedNodes.length>0;var af=ae.type==="attributes";if(!ad&&!af){return}W.forEach(function(ah,ag){if(ae.target.querySelector(ag)||ab.call(ae.target,ag)){ah.forEach(function(ai){ai()});Y(ag)}})})});function R(ad){var ae;if(!ad.forEach){ad=[ad]}var ac=new aa(function(ai,ah){var aj=[];var af=[];ad.forEach(function(ak){var am;var al;if(!X.document.querySelector(ak)){am=new aa(function(an){S(ak,an);al=function(){Y(ak,an)}});aj.push(am);af.push(al)}});function ag(){af.forEach(function(ak){ak()})}aa.all(aj).then(ag).then(ai,ah);ae=function(){ag();ah()}});ac.dismiss=ae;return ac}return R}(y,r,F,G,e);q=function(aa,ab,S,U,X){var Z,T=false,W;W=new U();function R(ac,ad){if(!T){Z.observe(X.document,{childList:true,subtree:true});T=true}W.add(ac,ad)}function Y(ac,ad){W.remove.apply(W,arguments);if(W.length===0){Z.disconnect();T=false}}Z=new S(function(ac){ac.forEach(function(ad){var ae=ad.type==="childList"&&ad.removedNodes&&ad.removedNodes.length>0;if(ae){W.forEach(function(ai,af){var aj;for(var ah=0;ah<ad.removedNodes.length;ah++){aj=ad.removedNodes[ah];if(aj.querySelector&&(aj.querySelector(af)||ab.call(aj,af))){for(var ag=0;ag<ai.length;ag++){ai[ag]()}Y(af)}}})}})});function V(ad){var ae;if(!ad.forEach){ad=[ad]}var ac=new aa(function(ai,ah){var aj=[];var af=[];ad.forEach(function(ak){var am;var al;if(X.document.querySelector(ak)){am=new aa(function(an){R(ak,an);al=function(){Y(ak,an)}});aj.push(am);af.push(al)}});function ag(){af.forEach(function(ak){ak()})}aa.all(aj).then(ag).then(ai,ah);ae=function(){ag();ah()}});ac.dismiss=ae;return ac}return V}(y,r,F,G,e);H=function(){var S={};var T={};var R=function(U,W,V){if(!T.hasOwnProperty(U)){T[U]=[]}if(W){T[U].push({callback:W,once:V})}};S.on=function(U,V){R(U,V,false)};S.one=function(U,V){R(U,V,true)};S.trigger=function(U,V){var W=[];(T[U]||[]).forEach(function(X){X.callback.apply(undefined,[V]);if(!X.once){W.push(X)}});if(W.length===0){delete T[U]}else{T[U]=W}};return S}();K=function(R){return function S(){return R.performance&&R.performance.navigation&&R.performance.timing&&typeof R.performance.timing.navigationStart!=="undefined"}}(e);J=function(S){function R(U,T){return new S(function(W){var X;function V(){var Y=U();if(Y!==undefined){clearInterval(X);W(Y)}}X=setInterval(V,T);V()})}return R}(y);s=function(V,Y,W,T){var U=["unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"];function R(){var Z=V.performance.timing.loadEventEnd>0;var aa={};if(Z){U.forEach(function ab(ac){var ad=V.performance.timing[ac];var ae=ad>0;if(ae){aa[ac]=ad-V.performance.timing.navigationStart}});return aa}}var X;function S(){if(!Y()){return W.reject("The navigation timing API is required to produce a report for this navigation.")}if(typeof X==="undefined"){X=T(R,250)}return X}return S}(e,K,y,J);i=function(T,S,U){function R(V){return S().then(function(){var W=V.isInitial?T.performance.timing.navigationStart:V.start;return{readyForUser:Math.round(V.end-W)}})}return R}(e,s,y);f=function(S){return function R(T){return S(T).then(function(U){var V;var X=T.threshold;var W=T.threshold*4;if(U.readyForUser<X){V=1}else{if(U.readyForUser<W){V=0.5}else{V=0}}return{apdex:V}})}}(i);m=function(V,U,Y){function X(){return T().then(function(Z){return{firstPaint:Math.round(Z)}},function(){return{}})}function R(){return V.chrome&&V.chrome.loadTimes}function W(){return typeof V.performance.timing.msFirstPaint!=="undefined"}function S(){if(R()&&V.chrome.loadTimes().firstPaintTime>0){return V.chrome.loadTimes().firstPaintTime*1000-V.performance.timing.navigationStart}else{if(W()&&V.performance.timing.msFirstPaint>0){return V.performance.timing.msFirstPaint-V.performance.timing.navigationStart}}}function T(){if(R()||W()){return U(S,250)}else{return Y.reject("The browser does not have a first paint metric")}}return X}(e,J,y);D=function A(R){return{isInitial:R.isInitial}};v=function(T,U){var V="browser-metrics-journey";function S(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(Y){var X=T.Math.random()*16|0;var W=Y==="x"?X:X&3|8;return W.toString(16)})}function R(){if(typeof T.sessionStorage==="undefined"){return U.reject("sessionStorage is required to produce a report for this navigation.")}if(T.sessionStorage.getItem(V)===null){T.sessionStorage.setItem(V,S())}return U.resolve({journeyId:T.sessionStorage.getItem(V)})}return R}(e,y);n=function(){function R(S){return{key:S.key}}return R}();L=function(S,T){function R(V){var U={};if(V.isInitial&&T()){U.navigationType=S.performance.navigation.type}return U}return R}(e,K);B=function(S,U,T){function R(W){var V={};if(W.isInitial){if(!U()){return T.reject("The navigation timing API is required to produce a report for this navigation.")}if(S.performance.navigation.redirectCount>0){V.redirectCount=S.performance.navigation.redirectCount}}return T.resolve(V)}return R}(e,K,y);O=function(R){function S(U){var T=R.document.createElement("a");T.href=U;return T.href}return S}(e);l=function(V,S,U){function R(){var W=U.document.querySelectorAll("script[src][async]");return Array.prototype.map.call(W,function(X){return V(X.src)})}function T(){var W=R();function X(Z){return U.performance.getEntriesByType("resource").filter(function ab(ac){return ac.initiatorType==="link"||ac.initiatorType==="script"}).filter(function aa(ac){return ac.responseEnd<Z.domContentLoadedEventStart}).filter(function Y(ac){return ac.initiatorType!=="script"||W.indexOf(ac.name)===-1})}return S().then(X)}return T}(O,s,e);z=function(T,U,S){function R(W){if(!W.isInitial){return{}}return S().then(function V(ac){var ab=ac.map(function Y(ae){return ae.responseEnd}).map(function aa(ae){return Math.round(ae)}).reduce(function Z(af,ae){return Math.max(af,ae)},0);var ad=ac.map(function X(ae){return ae.duration}).map(function aa(ae){return Math.round(ae)});return{resourceLoadedEnd:ab,resourceDurations:JSON.stringify(ad)}})}return R}(e,y,l);h=function(){function R(S){return{threshold:S.threshold}}return R}();g=function(R){function S(T){if(!T.isInitial){return{}}return R()}return S}(s);C=function(R){function S(){return{userAgent:R.navigator.userAgent}}return S}(e);o=function(Y,ab,Z,V,T,aa,ac,S,ad,X,U,W){var R=[Y,ab,Z,V,T,aa,ac,S,ad,X,U,W];return{get:function(){return R.concat()},add:function(ae){R.push(ae)}}}(f,m,D,v,n,L,i,B,z,h,g,C);d=function(){var R=Object.prototype.hasOwnProperty;function S(){var W={};var V,X;for(var T=0,U=arguments.length;T<U;T++){V=arguments[T];for(X in V){if(R.call(V,X)){W[X]=V[X]}}}return W}return S}();w=function(S){var R=S.document.readyState!=="loading";if(!R){S.document.addEventListener("DOMContentLoaded",function(){S.setTimeout(function(){R=true},0)})}function T(){return R}return T}(e);c=function(S,W,ab,Z,R,aa,U){var Y={};function X(ad,ac){if(!Array.isArray(ad)){ad=[ad]}return ad.map(function(ae){if(typeof ae==="string"){ae={selector:ae}}return aa(ac,ae)})}function V(ad){var ac;ac=ad.map(function(af){var ae;if(af.requireUpdate){ae=new W(af.selector);ab.one("start",function(){ae.dismiss()})}else{ae=Z.resolve()}return ae.then(function(){var ag=new S(af.selector);ab.one("start",function(){ag.dismiss()});return ag})});return Z.all(ac)}Y.start=function(ad){var af;var ae="isInitial" in ad?ad.isInitial:U()===false;var ac="threshold" in ad?ad.threshold:1000;ab.trigger("start",{key:ad.key,isInitial:ae,threshold:ac});if(ad.ready){af=X(ad.ready,{requireUpdate:!ae});V(af).then(function(){Y.end({key:ad.key})})}};Y.end=function(ac){ab.trigger("end",{key:ac.key})};Y.addReporter=function T(ac){R.add(ac)};return Y}(u,q,H,y,o,d,w);Q=function(R){return R.AJS||(R.AJS={})}(e);I=function(R){R.EventQueue=R.EventQueue||[];function S(T,U){R.EventQueue.push({name:T,properties:U})}return S}(Q);a=function(S){function R(T){(S.console.error||S.console.log).call(S.console,T.stack||T)}return R}(e);E=function(Z,V,W,U,X,R){function S(aa){return V.all([aa]).then(function(ab){return ab[0]})}function Y(aa){return S(aa).then(null,function(){return{}})}function T(ac){var ad=R.get().map(function ab(af){var ae;try{ae=af(ac)}catch(ag){X(ag);ae={}}return Y(ae)});return V.all(ad).then(function aa(ae){return W.apply(undefined,ae)})}return T}(J,y,d,e,a,o);b=function(S){var R;if(S.performance&&S.performance.now){R=function(){return S.performance.timing.navigationStart+S.performance.now()}}else{R=S.Date.now.bind(S.Date)}return R}(e);M=function(V,S,T){function R(W){if(!(this instanceof R)){return new R(W)}this.isInitial="isInitial" in W?W.isInitial:false;this.start=T();this.end=null;this.key=W.key;this.threshold=W.threshold}function U(W){var X;W.on("start",function(Y){X=new R(Y)});W.on("end",function(Y){if(X&&X.key===Y.key){X.end=T();S(X).then(function(Z){V("browser.metrics.navigation",Z)});X=null}})}return U}(I,E,b);N=function(R){return R.WRM||(R.WRM={})}(e);t=function(R){var W="com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api.feature-data-provider",S;function V(X){return !!(X&&X.constructor&&X.call&&X.apply)}function U(X,Y){if(R&&R.data&&R.data.claim&&V(R.data.claim)){return R.data.claim(X)}else{if(R&&R.data&&V(R.data)){return R.data(X)}else{return Y}}}function T(){if(S===undefined){S=U(W,true)}return S}return T}(N);P=function(U,T,R,S){if(!S()){return{start:function(){},end:function(){}}}T(R);return U}(c,M,H,t);window["browser-metrics"]=P;if(window.define){window.define("internal/browser-metrics",[],function(){return P})}}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api', location = 'main.js' */
define("internal/browser-metrics-plugin/lib/window",["require","exports"],function(b,a){return window});define("internal/browser-metrics-plugin/lib/jquery",["require","exports","./window"],function(b,a,c){var d;try{d=c.require("jquery")}catch(f){d=c.jQuery}return d});define("internal/browser-metrics-plugin/reporters/experiments",["require","exports","../lib/jquery","../lib/window"],function(a,d,f,i){var h=i.AJS.contextPath()+"/experimental/main.js";function c(){return Array.prototype.slice.call(i.document.getElementsByTagName("script"))}function j(){return(i.GROW&&i.GROW.experimentId)||[]}function e(){var m=f.Deferred();f(function n(){var o=c().some(function p(q){return q.getAttribute("src")===h});m.resolve(o)});return m.promise()}var g=e().pipe(function l(n){var m={};if(n){m.experiments=JSON.stringify(j())}return m});var b=function k(){return g};return b});define("internal/browser-metrics-plugin/lib/wrm",["require","exports","./window"],function(c,b,d){var a;a=d.require("wrm");return a});define("internal/browser-metrics-plugin/reporters/rack",["require","exports","../lib/wrm"],function(f,e,d){var g=false;var h;function c(){if(g===false){h=d.data.claim("com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api.rack-data-provider");g=true}return typeof h==="undefined"?null:h}var b=function a(){return{rack:c()}};return b});define("internal/browser-metrics-plugin/main",["require","exports","./reporters/experiments","./reporters/rack","internal/browser-metrics"],function(d,b,c,a,e){e.addReporter(c);e.addReporter(a)});require(["internal/browser-metrics-plugin/main"]);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:viewcontent', location = '/js/viewcontent.js' */
require(["internal/browser-metrics","ajs","jquery","confluence-browser-metrics/spa-transitions","confluence-browser-metrics/defer-js","confluence-browser-metrics/server-duration","confluence-browser-metrics/bigpipe-reporter"],function(g,h,c,e,f,b,d){function i(j){if(!c(j.target).hasClass("full-load")){g.start({key:"confluence."+j.data.type+".edit.quick-view",ready:".active-richtext"})}}function a(){g.addReporter(e);g.addReporter(f);g.addReporter(b);g.addReporter(d);var j=h.Meta.get("content-type");if(j){g.start({key:"confluence."+j+".view",ready:".wiki-content",isInitial:true});c("#editPageLink").on("click",{type:j},i)}}h.toInit(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:server-duration', location = '/js/server-duration.js' */
define("confluence-browser-metrics/server-duration",["internal/browser-metrics","jquery"],function(c,d){var b=d.Deferred();d(function(){var e=JSON.parse(d("#confluence-server-performance").html());if(e!==null&&e.serverDuration){b.resolve(e)}else{b.resolve({})}});var a=function(e){if(e.isInitial){return b.promise()}else{return{}}};return a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:bigpipe-reporter', location = '/js/bigpipe-reporter.js' */
define("confluence-browser-metrics/bigpipe-reporter",["jquery"],function(c){var a=c.Deferred();c(function(){if(typeof(AJS.BigPipe)!=="undefined"&&AJS.BigPipe.metrics){a.resolve(AJS.BigPipe.metrics)}else{a.resolve({})}});var b=function(d){if(d.isInitial){return a.promise()}else{return{}}};return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:spa-transitions', location = '/js/spa-transitions.js' */
define("confluence-browser-metrics/spa-transitions",["jquery","ajs","confluence/storage-manager"],function(c,i,k){var d=c.Deferred();var l="page-page";var j="dashboard-page";var a=k("confluence","spa-transition");i.toInit(function(){c(document).on("click","a",g);var n=null;if(a.doesContain(l)){n=l}else{if(a.doesContain(j)){n=j}}if(n){d.resolve({"confluence-spa-transition":n});a.removeItem(n)}else{d.resolve({})}});function g(o){var n=c(this).attr("href");if(n&&e(o)&&b(n)){a.setItemQuietly(h()?j:l,true,300)}return true}function e(n){return n.which===1&&!n.metaKey&&!n.ctrlKey&&!n.shiftKey}function b(n){return(n.indexOf("/display/")!==-1||n.indexOf("/viewpage.action")!==-1)&&(n.indexOf("~")===-1||m(n))}function m(n){return(n.indexOf("/",n.indexOf("~")+1)!==-1)&&n.slice(-1)!=="/"}function h(){return c("body").hasClass("dashboard")}var f=function(n){if(n.isInitial){return d.promise()}else{return{}}};return f});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:defer-js', location = '/js/defer-js.js' */
define("confluence-browser-metrics/defer-js",["confluence/dark-features","jquery"],function(a,c){return function b(d){if(d.isInitial&&a.isEnabled("defer.js.enable")&&c("#doctheme-anchor").length===0){return{deferJs:"true"}}else{return{}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.ext.newcode-macro-plugin:syntaxhighlighter-init', location = 'sh/asyncLoader.js' */
define("confluence/code-macro/async-loader",["jquery","wrm","underscore"],function(c,a,b){return function(){b.defer(function(){var h=c(".codeHeader .collapse-source");d(h);var i=c("#content").find("pre.syntaxhighlighter-pre");if(i.length>0){var g="wr!com.atlassian.confluence.ext.newcode-macro-plugin:sh-theme-";var f=["wrc!code-macro"];i.each(function(){f.push(g+c(this).data("theme").toLowerCase())});a.require(f).done(function(){window.SyntaxHighlighter.highlight();e(h)})}});function d(f){f.hide();b.forEach(f,function(g){c(g).next(".collapse-spinner-wrapper").spin()})}function e(f){f.show();f.next(".collapse-spinner-wrapper").remove()}}});require("confluence/module-exporter").safeRequire("confluence/code-macro/async-loader",function(a){AJS.toInit(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-banner:page-banner-common-resources', location = 'js/page-banner.js' */
AJS.toInit(function(e){d();AJS.bind("system-content-metadata.toggled-restrictions",function(i,k){var j=e("#content-metadata-page-restrictions");var g="";j.removeClass();var h=k.hasRestrictions&&!(k.hasExplicitRestrictions||k.hasInheritedRestrictions);if(k.hasExplicitRestrictions||h){j.addClass("aui-icon aui-icon-small aui-iconfont-locked restricted");g="Restrictions apply"}else{if(k.hasInheritedRestrictions){j.addClass("aui-icon aui-icon-small aui-iconfont-unlocked restricted");g="Restrictions apply"}else{j.addClass("aui-icon aui-icon-small aui-iconfont-unlocked");g=k.hasAnyExplicitRestrictions?"Restrictions apply":"Unrestricted"}}j.attr("title",g);a(j);d()});AJS.bind("breadcrumbs.expanded",f);e("#page-metadata-banner").css("visibility","visible");b();e("#content-metadata-page-restrictions").click(function(g){g.preventDefault();AJS.trigger("system-content-metadata.open-restrictions-dialog")});function d(){if(e("#system-content-items").children(":not(.hidden)").length==0){e("#system-content-items").addClass("hidden")}else{e("#system-content-items").removeClass("hidden")}}function f(){e("#page-metadata-banner").hide()}function b(){var g=e("#system-content-items a:not(.tipsy-disabled), .page-metadata-item a:not(.tipsy-disabled), .page-metadata-modification-info a.last-modified:not(tipsy-disabled)");a(g);g.click(function(h){c(e(h.target).closest("a"))});e(window).on("click scroll resize",c)}function a(g){e(g).tooltip({live:true,gravity:e("#com-atlassian-confluence").hasClass("theme-documentation view-blog-post")?"nw":"n",title:"title",delayIn:500})}function c(g){e(".tipsy").remove();if(g){var h=e(g).data("tipsy");if(h){h.hoverState="out"}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-banner:page-banner-common-resources', location = 'js/page-banner-analytics.js' */
AJS.toInit(function(c){function b(){if(!AJS.Confluence.Analytics||!AJS.Confluence.Analytics.setAnalyticsSource){AJS.log("WARNING: Could not initialise analytics for the page banner: AJS.Confluence.Analytics.setAnalyticsSource is not defined.");return}var e=AJS.Confluence.Analytics.setAnalyticsSource;var f=c("#breadcrumbs > li");e(f.filter(":not(#ellipsis)").find("a"),"breadcrumbs");e(f.filter(".hidden-crumb").find("a"),"breadcrumbs-expanded");e(f.filter(":last").find("a"),"breadcrumbs-parent");var d=c("#com-atlassian-confluence").hasClass("theme-documentation")?"breadcrumbs-homepage":"breadcrumbs-collector";e(f.filter(".first").find("a"),d)}function a(e,d,g){var f=null;e.mouseover(function(){f=setTimeout(g,d)});e.mouseout(function(){clearTimeout(f)})}AJS.bind("breadcrumbs.expanded",function(){AJS.trigger("analyticsEvent",{name:"breadcrumbs-expanded"})});b()});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-banner:soy-resources', location = 'soy/page-banner.soy' */
// This file was automatically generated from page-banner.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.PageBanner.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.PageBanner == 'undefined') { Confluence.Templates.PageBanner = {}; }


Confluence.Templates.PageBanner.banner = function(opt_data, opt_ignored) {
  var output = '<div id="page-metadata-banner"><ul class="banner">' + Confluence.Templates.PageBanner.renderSystemContentItems(opt_data);
  var itemList6 = opt_data.pageBannerItems;
  var itemListLen6 = itemList6.length;
  for (var itemIndex6 = 0; itemIndex6 < itemListLen6; itemIndex6++) {
    var itemData6 = itemList6[itemIndex6];
    output += Confluence.Templates.PageBanner.renderPageBannerItem(itemData6);
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.PageBanner.banner.soyTemplateName = 'Confluence.Templates.PageBanner.banner';
}


Confluence.Templates.PageBanner.renderSystemContentItems = function(opt_data, opt_ignored) {
  var output = '<li id="system-content-items" class="noprint">';
  var itemList12 = opt_data.systemContentItems;
  var itemListLen12 = itemList12.length;
  for (var itemIndex12 = 0; itemIndex12 < itemListLen12; itemIndex12++) {
    var itemData12 = itemList12[itemIndex12];
    output += Confluence.Templates.PageBanner.itemAnchor(soy.$$augmentMap(itemData12, {isSystemContentItem: true}));
  }
  output += '</li>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.PageBanner.renderSystemContentItems.soyTemplateName = 'Confluence.Templates.PageBanner.renderSystemContentItems';
}


Confluence.Templates.PageBanner.renderPageBannerItem = function(opt_data, opt_ignored) {
  return '<li class="page-metadata-item noprint ' + ((opt_data.isAuiButton) ? 'has-button' : '') + '" ' + ((opt_data.linkId) ? ' id="' + soy.$$escapeHtml(opt_data.linkId) + '-wrapper"' : '') + '>' + Confluence.Templates.PageBanner.itemAnchor(soy.$$augmentMap(opt_data, {isSystemContentItem: false})) + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageBanner.renderPageBannerItem.soyTemplateName = 'Confluence.Templates.PageBanner.renderPageBannerItem';
}


Confluence.Templates.PageBanner.itemAnchor = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml(opt_data.href) + '" title="' + soy.$$escapeHtml(opt_data.tooltip) + '" ' + ((opt_data.linkId) ? 'id="' + soy.$$escapeHtml(opt_data.linkId) + '"' : '') + ' ' + ((opt_data.styleClasses) ? 'class="' + soy.$$escapeHtml(opt_data.styleClasses) + '"' : '') + '>' + Confluence.Templates.PageBanner.itemIcon(opt_data) + ((! opt_data.isSystemContentItem) ? '<span>' + soy.$$escapeHtml(opt_data.label) + '</span>' : '') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.PageBanner.itemAnchor.soyTemplateName = 'Confluence.Templates.PageBanner.itemAnchor';
}


Confluence.Templates.PageBanner.itemIcon = function(opt_data, opt_ignored) {
  return '' + ((opt_data.icon) ? '<img class="page-banner-item-icon" src="' + soy.$$escapeHtml(opt_data.icon.url) + '" style="height: ' + soy.$$escapeHtml(opt_data.icon.height) + 'px; width: ' + soy.$$escapeHtml(opt_data.icon.width) + 'px;"/>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.PageBanner.itemIcon.soyTemplateName = 'Confluence.Templates.PageBanner.itemIcon';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:view-comment', location = '/includes/js/comments.js' */
define("confluence/comments",["ajs","jquery","confluence/storage-manager"],function(b,g,h){function f(){return confirm("Are you sure you want to delete the comment?")?(this.href+="&confirm=yes",!0):!1}return{binder:{bindRemoveConfirmation:function(a){g("#comment-"+a+" .comment-action-remove a").click(f)}},initialiser:function(a){var d=h("confluence","comments");if(a("#comments-section").length){a("#comments-section .comment:odd").addClass("odd");a(".comment-action-remove a").click(f);var e=
a("#addcomment.comment-text"),c=a("#comments-text-editor textarea");c.focus(function(){e.addClass("active")}).blur(function(){a.trim(c.val()).length||e.removeClass("active")}).bind("reset.default-text",function(){e.removeClass("active")});a("form[name='textcommentform']").submit(function(){var d=c.val();return!a.trim(d)?(alert("Comment text is empty. Cannot create empty comments."),!1):!0});a("#add-comment-rte").click(function(){c.hasClass("placeholded")||d.setItem("text-comment",a.trim(c.val()))});a("#addcomment #rte").length&&
b.bind("init.rte",function(a,b){var c=d.getItem("text-comment");c&&(b.editor.setContent(c),d.setItem("text-comment",""))})}}}});require("confluence/module-exporter").safeRequire("confluence/comments",function(b){require("confluence/legacy").Comments=b.binder;require("ajs").toInit(b.initialiser)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-alignment', location = 'js/aui/internal/alignment.js' */
(function(A){AJS.Alignment=A(window.Tether);if(typeof window.define==="function"){define("aui/internal/alignment",["aui/internal/tether"],function(){return AJS.Alignment})}})(function(E){var C="data-aui-alignment";var J="data-aui-alignment-static";var H="aui-alignment";var A="aui-alignment-side-";var K="aui-alignment-snap-";var D="right middle";var I={"top left":{el:"bottom left",target:"top left"},"top center":{el:"bottom center",target:"top center"},"top right":{el:"bottom right",target:"top right"},"right top":{el:"top left",target:"top right"},"right middle":{el:"middle left",target:"middle right"},"right bottom":{el:"bottom left",target:"bottom right"},"bottom left":{el:"top left",target:"bottom left"},"bottom center":{el:"top center",target:"bottom center"},"bottom right":{el:"top right",target:"bottom right"},"left top":{el:"top right",target:"top left"},"left middle":{el:"middle right",target:"middle left"},"left bottom":{el:"bottom right",target:"bottom left"}};function G(Q,P,M){var N=A+P;var O=K+M;Q.className+=" "+N+" "+O}function B(M){var N=(M.getAttribute(C)||D).split(" ");return{side:N[0],snap:N[1]}}function F(N,M){return I[N+" "+M]||I[D]}function L(O,P){var R=B(O);var Q=F(R.side,R.snap);var N=O.hasAttribute(J);var M=new E({enabled:false,element:O,target:P,attachment:Q.el,targetAttachment:Q.target,classPrefix:H,constraints:[{to:"window",attachment:N===true?"none":"together"}]});G(O,R.side,R.snap);this._auiTether=M}L.prototype={destroy:function(){this._auiTether.destroy();return this},disable:function(){this._auiTether.disable();return this},enable:function(){this._auiTether.enable();return this}};return L});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-trigger', location = 'js/aui/trigger.js' */
(function(A){define("aui/trigger",[],function(){return A(AJS.$,window.skate)})})(function(E,B){function D(G,H){var F=E(H).closest("a[href]",G);return !!F.length&&F[0]!==G}function C(F){return document.getElementById(F.getAttribute("aria-controls"))}function A(G,H){if(G.isEnabled()){var F=C(G);if(F&&F.message){F.message(H)}}}B("data-aui-trigger",{type:B.types.ATTR,insert:function(F){E(F).on({click:function(G){if(!D(F,G.target)){A(F,G);G.preventDefault()}},"mouseenter mouseleave focus blur":function(G){A(F,G)}})},prototype:{disable:function(){this.setAttribute("aria-disabled","true")},enable:function(){this.setAttribute("aria-disabled","false")},isEnabled:function(){return this.getAttribute("aria-disabled")!=="true"}}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-trigger', location = 'soy/trigger.soy' */
// This file was automatically generated from trigger.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace aui.trigger.
 */

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.trigger == 'undefined') { aui.trigger = {}; }


aui.trigger.trigger = function(opt_data, opt_ignored) {
  return '<' + soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a') + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ' class="' + aui.renderExtraClasses(opt_data) + '" aria-owns="' + soy.$$escapeHtml(opt_data.menu.id) + '" aria-controls="' + soy.$$escapeHtml(opt_data.menu.id) + '" aria-haspopup="true"' + ((opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '') + ((opt_data.container) ? ' data-container="' + soy.$$escapeHtml(opt_data.container) + '"' : '') + (((! opt_data.tagName || opt_data.tagName == 'a') && (! opt_data.extraAttributes || Object.prototype.toString.call(opt_data.extraAttributes) === '[object Object]' && ! opt_data.extraAttributes.href && ! opt_data.extraAttributes.tabindex)) ? ' tabindex="0"' : '') + ' data-aui-trigger' + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + ((opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '') + ((! (opt_data.showIcon == false)) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.iconClasses ? opt_data.iconClasses : 'aui-icon-dropdown') + '">' + ((opt_data.iconText) ? soy.$$escapeHtml(opt_data.iconText) : '') + '</span>' : '') + '</' + soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a') + '>';
};
if (goog.DEBUG) {
  aui.trigger.trigger.soyTemplateName = 'aui.trigger.trigger';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-inline-dialog2', location = 'js/aui/inline-dialog2.js' */
(function(A){define("aui/inline-dialog2",["./internal/alignment","./trigger"],function(B){return A(B,AJS.layer,window.skate)})})(function(J,C,E){var I=1000;function K(M){return document.querySelector('[aria-controls="'+M.id+'"]')}function F(N,O){var M=K(N);if(M){O(M)}}function G(M,O){var N=M.getAttribute("data-aui-responds-to")==="hover";if(N){O(M)}}function L(N,M){if(!N._auiAlignment){N._auiAlignment=new J(N,M)}}function B(N,M){L(N,M);N._auiAlignment.enable()}function A(N,M){L(N,M);N._auiAlignment.disable()}E("aui-inline-dialog2",{type:E.types.TAG,ready:function(M){F(M,function(N){N.setAttribute("aria-expanded",M.isVisible());N.setAttribute("aria-haspopup","true")});G(M,function(){M.mouseInside=false;M.addEventListener("mouseenter",function(){M.mouseInside=true;M.message({type:"mouseenter"})});M.addEventListener("mouseleave",function(){M.mouseInside=false;M.message({type:"mouseleave"})})})},remove:function(M){if(M._auiAlignment){M._auiAlignment.destroy()}},prototype:{remove:function(){C(this).remove()},show:function(){var M=this;C(this).show();F(this,function(N){B(M,N);N.setAttribute("aria-expanded","true")});return this},hide:function(){var M=this;C(this).hide();F(this,function(N){A(M,N);N.setAttribute("aria-expanded","false")});return this},isVisible:function(){return C(this).isVisible()},message:function(M){D(this,M);return this}}});function D(O,Q){var N={toggle:["click"],hover:["mouseenter","mouseleave","focus","blur"]};var M=O.getAttribute("data-aui-responds-to");var P=N[M];if(P&&P.indexOf(Q.type)>-1){H[Q.type](O,Q)}}var H={click:function(M){if(M.isVisible()){if(!C(M).isPersistent()){M.hide()}}else{M.show()}},mouseenter:function(M){if(!M.isVisible()){M.show()}if(M._clearMouseleaveTimeout){M._clearMouseleaveTimeout()}},mouseleave:function(M){if(C(M).isPersistent()||!M.isVisible()){return }if(M._clearMouseleaveTimeout){M._clearMouseleaveTimeout()}var N=setTimeout(function(){if(!M.mouseInside){M.hide()}},I);M._clearMouseleaveTimeout=function(){clearTimeout(N);M._clearMouseleaveTimeout=null}},focus:function(M){if(!M.isVisible()){M.show()}},blur:function(M){if(!C(M).isPersistent()&&M.isVisible()){M.hide()}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-inline-dialog2', location = 'soy/inline-dialog2.soy' */
// This file was automatically generated from inline-dialog2.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace aui.inlineDialog2.
 */

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.inlineDialog2 == 'undefined') { aui.inlineDialog2 = {}; }


aui.inlineDialog2.inlineDialog2 = function(opt_data, opt_ignored) {
  return '<aui-inline-dialog2 ' + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + '  class="aui-layer aui-inline-dialog' + aui.renderExtraClasses(opt_data) + '" data-aui-alignment="' + soy.$$escapeHtml(opt_data.alignment ? opt_data.alignment : '') + '" data-aui-responds-to="' + soy.$$escapeHtml(opt_data.respondsTo ? opt_data.respondsTo : '') + '" aria-hidden="true"' + aui.renderExtraAttributes(opt_data) + '>' + aui.inlineDialog2.inlineDialog2Content(opt_data) + '</aui-inline-dialog2>';
};
if (goog.DEBUG) {
  aui.inlineDialog2.inlineDialog2.soyTemplateName = 'aui.inlineDialog2.inlineDialog2';
}


aui.inlineDialog2.inlineDialog2Content = function(opt_data, opt_ignored) {
  return '<div class="aui-inline-dialog-contents">' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</div>';
};
if (goog.DEBUG) {
  aui.inlineDialog2.inlineDialog2Content.soyTemplateName = 'aui.inlineDialog2.inlineDialog2Content';
}


aui.inlineDialog2.trigger = function(opt_data, opt_ignored) {
  return '' + aui.trigger.trigger(soy.$$augmentMap(opt_data, {showIcon: opt_data.showIcon ? opt_data.showIcon : false}));
};
if (goog.DEBUG) {
  aui.inlineDialog2.trigger.soyTemplateName = 'aui.inlineDialog2.trigger';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.comalatech.workflow:newui-resources', location = 'templates/dist/cml-workflows-content.js' */
(function e(b,g,d){function c(m,j){if(!g[m]){if(!b[m]){var i=typeof require=="function"&&require;if(!j&&i){return i(m,!0)}if(a){return a(m,!0)}var k=new Error("Cannot find module '"+m+"'");throw k.code="MODULE_NOT_FOUND",k}var h=g[m]={exports:{}};b[m][0].call(h.exports,function(l){var o=b[m][1][l];return c(o?o:l)},h,h.exports,e,b,g,d)}return g[m].exports}var a=typeof require=="function"&&require;for(var f=0;f<d.length;f++){c(d[f])}return c})({1:[function(b,c,a){var d=b("comala-ext"),f=b("./views/inline-dialog-controller");AJS.toInit(function(){var g=new d.Application({baseUrl:AJS.contextPath()+"/plugins/servlet/comalaworkflows/"+AJS.params.pageId,contextParams:{darkFeatureEnabled:AJS.DarkFeatures.isEnabled("comalatech.workflows.new-ui"),publishedView:AJS.params.publishedView,content_id:AJS.params.pageId,}});g.on("start",function(){if(AJS.params.remoteUser!=""){var k=AJS.$("<span></span>").attr({id:"cw-status-lozenge","class":"cw-state"});k.append(this.iframe("/state/content",{width:0,height:0,css:"cw-state-iframe"}));if(AJS.$("#title-text").length){AJS.$("#title-text").append(k)}else{AJS.$("#cw-action-buttons").before(k)}}var j=this.iframe("/actions/content",{width:0,height:0,css:"cw-actions-iframe"});AJS.$("#cw-action-buttons").parents("li").addClass("cw-action-buttons").append(j);AJS.$("#cw-action-buttons .aui-icon").removeClass("cml-icon-prod-workflows").addClass("button-spinner").spin();if(AJS.DarkFeatures.isEnabled("comalatech.workflows.new-ui")){AJS.$("#workflow-page-message").hide();AJS.$("#main-content").before(this.iframe("/top/content",{width:"100%",height:0,css:"cw-top-iframe"}))}var i;var h=this;d.require("events",function(l){l.on("cw:state.new",function(m){i=new f({id:"cw-status-dialog",trigger:"#cw-status-lozenge",type:"iframe",content:h.getBaseUrl()+h.addContextParams("/overview/content"),width:400,align:"bottom center",respondsTo:"hover",liveEvents:true,preload:false,padding:0,properties:{events:l}})});l.on("cw:layout.load",function(m){if(m.action=="actions"){AJS.$("#cw-action-buttons").hide();AJS.$("#cw-action-buttons .aui-icon").spinStop()}});l.on("cw:layout.load",function(m){if(m.action=="actions"){AJS.$("#cw-action-buttons").hide();AJS.$("#cw-action-buttons .aui-icon").spinStop()}});AJS.$("body").on("click",function(){l.trigger("cw:focus",{action:"parent"})});l.on("cw:focus",function(m){if(m&&m.action){if(m.action!=="overview"&&m.action!=="date"&&i){i.close()}}});AJS.$(document).delegate("iframe.adhoworkflows","awp.refresh",function(){if(i){i.reload()}l.trigger("cw:model.reload")})})});g.start()})},{"./views/inline-dialog-controller":31,"comala-ext":2}],2:[function(c,d,b){var a=c("components/core"),f=c("comala"),g=c("hbsfy/runtime");g.registerHelper("getText",function(i,h){return AJS.I18n.getText.apply(AJS.I18n,arguments)});d.exports=_.extend(a,f,{resize:function(j,l,i){var k,h,m;if(_.isObject(j)){k=j.height;h=j.width}else{k=j}if(!_.isNumber(k)){k=AJS.$("html").outerHeight(true)}if(_.isNumber(l)&&l>0){k+=l;if(_.isNumber(h)){h+=l}}m={height:k+"px"};if(_.isNumber(h)){m.width=h+"px"}if(i){AJS.$(window.frameElement).animate(m,"fast")}else{AJS.$(window.frameElement).css(m)}},Application:c("./components/application"),Controller:c("./components/controller"),analytics:c("./components/analytics"),dialog:c("./components/dialog"),params:c("./components/params"),util:c("./components/util"),View:Backbone.View.extend({constructor:function(h,i){this.properties=h&&h.properties?h.properties:{};if(i&&i.properties){this.properties=_.extend(i.properties,this.properties)}Backbone.View.prototype.constructor.apply(this,arguments)}}),DialogView:c("./views/dialog")})},{"./components/analytics":3,"./components/application":4,"./components/controller":5,"./components/dialog":7,"./components/params":8,"./components/util":10,"./views/dialog":13,comala:22,"components/core":6,"hbsfy/runtime":30}],3:[function(b,c,a){c.exports=(function(){var d="1.0",i="",h="";var k=function(l,m){if(l){this.UAKey=l;(function(q,t,w,v,u,p,n){q.GoogleAnalyticsObject=u;q[u]=q[u]||function(){(q[u].q=q[u].q||[]).push(arguments)},q[u].l=1*new Date();p=t.createElement(w),n=t.getElementsByTagName(w)[0];p.async=1;p.src=v;n.parentNode.insertBefore(p,n)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");if(m){ga("create",this.UAKey,"auto",{name:m});this.trackName(m)}else{ga("create",this.UAKey,"auto")}}};var j=function(l){if(this.UAKey){if(l){ga(this.trackName()+"send","pageview",l)}else{ga(this.trackName()+"send","pageview")}}};var f=function(m,o,l,n){if(this.UAKey){if(arguments.length===4){ga(this.trackName()+"send","event",m,o,l,n)}else{if(arguments.length===3){ga(this.trackName()+"send","event",m,o,l)}else{ga(this.trackName()+"send","event",m,o)}}}};var g=function(l){if(arguments.length>0){this.prefix=l+"."}else{return this.prefix}return this};return{init:k,trackPage:j,trackEvent:f,trackName:g,VERSION:d}})()},{}],4:[function(b,c,a){var f=b("views/main");if(self===top){var d=_.extend(b("./core"),{params:b("./params")});c.exports=Backbone.View.extend({baseUrl:"",moreContextParams:{},initialize:function(g){if(g&&g.baseUrl){this.baseUrl=g.baseUrl}if(g&&g.contextParams){this.moreContextParams=g.contextParams}this.on("before:start",this.onBeforeStart,this);this.on("start",this.onStart,this);d.add("messages",b("views/messages"))},start:function(){AJS.toInit(_.bind(function(){this._prepareContextParams();this.trigger("before:start");this.trigger("start")},this))},onBeforeStart:function(){},onStart:function(){},iframe:function(h,g){var i=AJS.$("<iframe/>",{src:this.baseUrl+this.addContextParams(h),id:g.id||null,width:_.isUndefined(g.width)?"100%":g.width,height:_.isUndefined(g.height)?"100%":g.height,frameborder:0,scrolling:"no","class":"cml-iframe"+(g.css?" "+g.css:""),ALLOWTRANSPARENCY:"true"});return i},addContextParams:function(g){return d.params.serialize(g)},getBaseUrl:function(){return this.baseUrl},_prepareContextParams:function(){d.params=_.extend(d.params,{cp:AJS.contextPath(),xdm_e:AJS.params.baseUrl,loc:AJS.params.userLocale||AJS.params.actionLocale,user:AJS.params.remoteUser},this._getPlatformContextParams(),this.moreContextParams)},_getPlatformContextParams:function(){var g={UAKey:AJS.params.workflowStatsUAKey,ConfVersion:AJS.params.versionNumber};if(AJS.params.contentId){g.content_id=AJS.params.contentId}if(AJS.params.contentType){g.content_type=AJS.params.contentType}if(AJS.params.spaceKey){g.space_key=AJS.params.spaceKey}if(AJS.params.pageId){g.page_id=AJS.params.pageId}return g}})}else{var d=_.extend(b("./core"),{analytics:b("./analytics"),params:b("./params"),util:b("./util"),Router:b("./router")});c.exports=Marionette.Application.extend({appOptions:["namespace","baseUrl","routes","controller"],initialize:function(h){var g=this;this.mergeOptions(h,this.appOptions);this._setContextParams();this.mainView=new f();d.analytics.init(d.params.UAKey,this.namespace)},onStart:function(){AJS.toInit(_.bind(function(){this.mainView.setElement("body");this.controller.setMainView(this.mainView);this.router=new d.Router({appRoutes:this.routes,controller:this.controller});this.mainView.on("cw:link",function(h){this.router.navigate(h,{trigger:true,replace:true})},this);this.mainView.on("cw:back",function(h){this.router.back()},this);if(Backbone.history&&!Backbone.history.started){if(!(window.history&&history.pushState)){Backbone.history.start({pushState:false,silent:true,root:this.getRootPath()});var g=window.location.pathname.substr(Backbone.history.options.root.length);Backbone.history.navigate(g,{trigger:true})}else{Backbone.history.start({pushState:true,root:this.getRootPath()})}}},this))},getRootPath:function(){return d.params.cp+this.baseUrl},_setContextParams:function(){var g=d.util.getQueryParams();d.params=_.extend(d.params,g,{baseUrl:g.xdm_e})}})}},{"./analytics":3,"./core":6,"./params":8,"./router":9,"./util":10,"views/main":16,"views/messages":17}],5:[function(b,c,a){if(self===top){c.exports={}}else{c.exports=Marionette.Object.extend({body:function(d){this.mainView.body(d)},setMainView:function(d){this.mainView=d}})}},{}],6:[function(b,c,a){c.exports={require:function(g,i,f){var d=this._exports();var h=[];g=_.isArray(g)?g:[g];_(g).each(function(j){var k=d[j];if(_.isFunction(k)){k=k();d[j]=k}h.push(k)},this);i.apply(f,h)},_exports:function(){if(window.comalaExports){return window.comalaExports}if(window.parent&&window.parent.comalaExports){return window.parent.comalaExports}else{window.comalaExports={events:function(){return _.extend({},Backbone.Events)}};return window.comalaExports}},add:function(f,d){this._exports()[f]=d},remove:function(d){delete this._exports()[d]}}},{}],7:[function(b,c,a){var d=b("./core");d.params=b("./params");c.exports=(function(){var h={size:"large",key:"",closeOnEscape:true,chrome:false,id:"cmlDialog",closeOnOutsideClick:true,src:""};var f=function(j,l){if(l.src){var k=$("<iframe/>").attr(l);j.empty().append(k)}else{console.error("params.src missing for dialog iframe content")}};var i=function(k){var j={width:800,height:190};if(k.size&&!(k.width||k.height)){switch(k.size){case"xlarge":j.width=980;break;case"medium":j.width=600;break;case"small":j.width=400;break}}return j};var g=function(){return(window.AP!=null&(typeof AP!=="undefined"))};return{create:function(n){if(g()){var j=_.extend(_.pick(h,"key","size","width","height","chrome","closeOnEscape","header","submitText","cancelText","customData"),_.pick(n,"key","size","width","height","chrome","closeOnEscape","header","submitText","cancelText","customData"));j=_.extend(j,i(n));AP.require("dialog",function(o){o.create(j)})}else{if(window.parent&&window.parent.comalaExports){var m=window.parent.AJS;var j=_.extend(_.pick(h,"id","width","height","closeOnOutsideClick"),_.pick(n,"id","width","height","closeOnOutsideClick"));j=_.extend(j,i(n));m.$("#"+j.id).remove();var k=new m.Dialog(j);k.show();var l=m.$("#"+j.id);f(l,{id:j.id+"-dialog",src:d.params.serialize(n.src),width:"100%",height:"190px",frameborder:0});if(n.customData){k.customData=n.customData}d.add("dialog",k)}}return this},getCustomData:function(){var j;if(g()){AP.require("dialog",function(k){j=k.customData})}else{d.require("dialog",function(k){j=k.customData})}return j},close:function(){if(g()){AP.require("dialog",function(j){j.close()})}else{d.require("dialog",function(j){j.hide()})}},onSubmit:function(k,j){if(g()){AP.require("dialog",function(l){l.onDialogMessage("submit",k);if(j){l.close()}})}},onCancel:function(k,j){if(g()){AP.require("dialog",function(l){l.onDialogMessage("cancel",k)})}},resize:function(j){if(g()){}else{d.require("dialog",function(k){if(window.parent&&window.parent.comalaExports&&k.id){window.parent.AJS.$("#"+k.id).css({height:j+"px","margin-top":-(j/2)});window.parent.AJS.$("#"+k.id+"-dialog").attr("height",j).css("height",j+"px")}})}}}})()},{"./core":6,"./params":8}],8:[function(b,c,a){c.exports={serialize:function(d){var f=[];d+=((d.indexOf("?")===-1)?"?":"&")+AJS.$.param(_.omit(this,"serialize"));return d}}},{}],9:[function(b,c,a){c.exports=Marionette.AppRouter.extend({history:[],onRoute:function(f,g,d){this.history.push({name:f,args:d,fragment:Backbone.history.fragment})},back:function(){if(this._go(-1)){this.history.pop();this.history.pop()}},_go:function(d){if(this.history.length>=(d*-1)){var f=this.history[this.history.length+d-1];var g=f.fragment;this.navigate(g,{trigger:true,replace:false});return true}return false},})},{}],10:[function(b,c,a){c.exports={getQueryParams:function(d){var i={},h,g,f=/[?&]?([^=]+)=([^&]*)/g;if(arguments.length===0){var d=document.location.search}d=d.split("+").join(" ");while(h=f.exec(d)){g=decodeURIComponent(h[2]);if(g==="true"){g=true}else{if(g==="false"){g=false}else{if(g==="undefined"){g=undefined}}}i[decodeURIComponent(h[1])]=g}return i}}},{}],11:[function(b,c,a){c.exports=Backbone.View.extend({constructor:function(d,f){this.properties=d&&d.properties?d.properties:{};if(f&&f.properties){this.properties=_.extend(_.clone(f.properties),this.properties)}Backbone.View.prototype.constructor.apply(this,arguments)}})},{}],12:[function(b,c,a){c.exports=Backbone.View.extend({tagName:"button",className:"aui-button cml-button",attributes:{type:"button"},events:{click:"click"},initialize:function(d){this.options=d;this.render()},render:function(){if(this.options.label){this.$el.html(this.options.label)}if(this.options.type){this.$el.addClass(this.options.type)}return this.el},disableButton:function(d){this.$el.attr("disabled",d)},click:function(){this.trigger("click")}})},{}],13:[function(b,d,a){var c=b("./abstract.js");var f=b("./button.js");d.exports=c.extend({className:"aui-dialog cml-dialog is-loading",template:b("hbs/dialog.hbs"),actions:[],initialize:function(){this.render();this.setup();_.defer(_.bind(this.afterSetup,this))},render:function(){this.$el.html(this.template());this.$title=this.$(".cml-dialog__title");this.$body=this.$(".cml-dialog__content");this.$actions=this.$(".cml-dialog__actions");this.$hint=this.$(".cml-dialog__hint");return this.el},beforeSetup:function(){},setup:function(){},afterSetup:function(){},action:function(g){var h=new f({label:g.label,type:g.type});this.$actions.append(h.render());h.on("click",function(){h.disableButton(true);g.onClick.call()});this.actions.push({label:g.label.toLowerCase(),view:h})},clearActions:function(){_(this.actions).each(function(g){g.view.remove()});this.actions=[]},getAction:function(g){var h=_.findWhere(this.actions,{label:g.toLowerCase()});if(!h){return}return h.view},enableAction:function(g){this.getAction(g).disableButton(false)},disableAction:function(g){this.getAction(g).disableButton(true)},loading:function(){this.$el.addClass("is-loading")},stopLoading:function(){this.$el.removeClass("is-loading")}})},{"./abstract.js":11,"./button.js":12,"hbs/dialog.hbs":18}],14:[function(c,d,b){var a=c("views/loader");d.exports=Backbone.View.extend({template:c("hbs/inline-dialog.hbs"),version:parseFloat(AJS.version).toFixed(2),defaults:{type:"content",width:300,padding:10,trigger:null,respondsTo:"toggle",liveEvents:false,align:"right middle",persistent:false,preload:false,content:"",opened:false,loader:true},loader:null,properties:{iframe:false,content:"",width:300,id:null,},statemodel:new Backbone.Model({load:0,open:0}),initialize:function(f){this.options=_.extend(this.defaults,_.pick(f,Object.keys(this.defaults)));this.trigger=AJS.$(this.options.trigger);_.bindAll(this,"render","deferredSetup","onOpen","onBeforeOpen","onClose","getOffsetX","getOffsetY");if(this.trigger.length){this.setup()}else{AJS.$(document).bind("DOMSubtreeModified",this.deferredSetup)}return this},setup:function(){this.properties=this.getProperties();var g=(this.options.type=="ajax")?this.options.content:this.render;var f=this.getDialogOptions();this.dialog=AJS.InlineDialog(this.trigger,this.id,g,f);AJS.$(document).bind("showLayer",this.onOpen);if(this.options.preload||this.options.opened){this.preload()}},deferredSetup:function(f){if(AJS.$(this.options.trigger).length){AJS.$(document).unbind("DOMSubtreeModified",this.deferredSetup);this.trigger=AJS.$(this.options.trigger);this.setup()}},getProperties:function(){return{iframe:(this.options.type=="iframe"),content:this.options.content,width:this.options.width,id:this.id}},getDialogOptions:function(){var g=this.getGravity(this.options.align);var f={gravity:g,onHover:(this.options.respondsTo=="hover"),useLiveEvents:this.options.liveEvents,persistent:this.options.persistent,closeOnTriggerClick:(this.options.respondsTo=="toggle"),width:this.options.width,initCallback:this.onBeforeOpen,hideCallback:this.onClose};if(this.version>=5.5){f.offsetX=this.getOffsetX;f.offsetY=this.getOffsetY}else{f.offsetX=this.getOffsetX();f.offsetY=this.getOffsetY()}return f},render:function(g,f,h){if(!this.statemodel.get("load")){this.$el=g.parent();g.css({padding:this.options.padding});g.html(this.template(this.properties));h();if(this.options.loader&&!this.loader){this.loader=new a({el:g,width:this.options.width})}this.startLoading()}else{h()}return false},open:function(f){if(this.dialog){this.dialog.show(f)}return this},close:function(f){if(this.dialog){this.dialog.hide(f)}return this},preload:function(f){this.open(f);if(!this.options.opened){this.close(f)}return this},startLoading:function(){if(this.loader){this.loader.spin()}this.statemodel.set("load",-1)},stopLoading:function(f){if(this.loader){this.loader.stop()}this.statemodel.set("load",1)},getGravity:function(){var f=this.options.align.split(" ");switch(f[0]){case"right":return"w";break;case"left":return"e";break;case"bottom":return"n";break;case"top":return"s";break}},getOffsetY:function(g,j,m,i){var l=this.options.align.split(" ");var k=j&&j.target?j.target:this.trigger;var f=g?g.outerHeight():10;var h=k.outerHeight();if((l[0]=="right"||l[0]=="left")&&l[1]!=="top"){var h=f-k.outerHeight();if(l[1]=="middle"){h=h/2}h=h*-1}return h},getOffsetX:function(g,k,o,f){var m=this.options.align.split(" ");var n=k&&k.target?k.target:this.trigger;var i=g?g.outerWidth():this.options.width+2;var l=n.outerWidth();if((m[0]=="top"||m[0]=="bottom")&&m[1]!="right"){l=i-n.outerWidth();if(m[1]=="center"){l=l/2}var h=AJS.$(".ia-fixed-sidebar").width()+10;var j=n.offset();if(_.isObject(j)&&j.left<(l+h)){l=j.left-h}l=l*-1}return l},onBeforeOpen:function(f){this.statemodel.set("open",-1);this.$el.addClass("active")},onOpen:function(g,f,h){if(f=="inlineDialog"&&h.id==this.id&&this.$el.is(":visible")){this.statemodel.set("open",1)}},onClose:function(f){this.statemodel.set("open",0);this.$el.removeClass("active")},remove:function(f){AJS.$(document).unbind("showLayer",this.onOpen);Backbone.View.prototype.remove.apply(this,arguments)}})},{"hbs/inline-dialog.hbs":19,"views/loader":15}],15:[function(b,c,a){c.exports=Backbone.View.extend({template:b("hbs/loader.hbs"),spinning:false,defaults:{width:100,height:50,style:"block",text:"loading..."},initialize:function(d){this.options=_.extend(this.defaults,d);if(this.options.width){this.$el.css("min-width",this.options.width)}else{this.$el.css("min-width",this.$el.width())}if(this.options.height){this.$el.css("min-height",this.options.height)}else{this.$el.css("min-height",this.$el.height())}this.render();return this},render:function(){this.$el.append(this.template(this.options))},spin:function(){this.$el.find(".cml-loading").show();this.$el.find(".cml-loading__icon").spin();this.spinning=true},stop:function(){this.$el.find(".cml-loading").hide();this.$el.find(".cml-loading__icon").spinStop();this.spinning=false},})},{"hbs/loader.hbs":20}],16:[function(b,c,a){c.exports=Backbone.View.extend({events:{"click .cw-link":"link","click .cw-back":"back"},body:function(d){this.$el.empty().append(d)},link:function(f){var d=this.$(f.currentTarget).attr("href");if(d){this.trigger("cw:link",d)}f.preventDefault()},back:function(d){this.trigger("cw:back");d.preventDefault()}})},{}],17:[function(b,c,a){var d=Backbone.View.extend({className:"cml-message-wrapper",defaultOpt:{fadeout:true,delay:4000},render:function(){return this.el},generic:function(f){this._show("generic",f)},error:function(f){this._show("error",f)},warning:function(f){this._show("warning",f)},_show:function(g,f){if(AJS.$("."+this.className).length===0){AJS.$("body").append(this.render());this.setElement(AJS.$("."+this.className))}f=this._message(g,f);if(f.fadeout){_.delay(_.bind(function(h){this._hide(h)},this),f.delay,f.id)}this.$el.css("z-index",99999)},_hide:function(f){this.$("#"+f).fadeOut(250,function(){AJS.$(this).remove()})},_message:function(g,f){f=this._messageOptions(f);if(g){AJS.messages[g]("."+this.className,f)}return f},_messageOptions:function(g){var f=_.pick(g,"title","body","closeable","insert","shadowed","fadeout","delay","duration");return _.extend(this.defaultOpt,{id:"cml-message-item-"+_.random(0,256)},f)}});c.exports=new d()},{}],18:[function(c,d,a){var b=c("hbsfy/runtime");d.exports=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(m,i,f,k){var h,l=i.helperMissing,j="function",g=this.escapeExpression;return'<div class="dialog-components">\n    <div class="dialog-title">\n        <h2 class="cml-dialog__title">\n            '+g(((h=(h=i.header||(m!=null?m.header:m))!=null?h:l),(typeof h===j?h.call(m,{name:"header",hash:{},data:k}):h)))+'\n        </h2>\n    </div>\n    <div class="dialog-page-body">\n        <div class="cml-dialog__loader">\n            <span class="aui-icon aui-icon-wait"></span> Comala Workflows...\n        </div>\n        <div class="cml-dialog__content">'+g(((h=(h=i.body||(m!=null?m.body:m))!=null?h:l),(typeof h===j?h.call(m,{name:"body",hash:{},data:k}):h)))+'</div>\n    </div>\n    <div class="dialog-button-panel">\n        <div class="cml-dialog__hint"></div>\n        <div class="cml-dialog__actions"></div>\n    </div>\n\n</div>'},useData:true})},{"hbsfy/runtime":30}],19:[function(c,d,a){var b=c("hbsfy/runtime");d.exports=b.template({"1":function(m,i,f,k){var h,l=i.helperMissing,j="function",g=this.escapeExpression;return'\n    <iframe id="'+g(((h=(h=i.id||(m!=null?m.id:m))!=null?h:l),(typeof h===j?h.call(m,{name:"id",hash:{},data:k}):h)))+'-iframe" src="'+g(((h=(h=i.content||(m!=null?m.content:m))!=null?h:l),(typeof h===j?h.call(m,{name:"content",hash:{},data:k}):h)))+'" width="'+g(((h=(h=i.width||(m!=null?m.width:m))!=null?h:l),(typeof h===j?h.call(m,{name:"width",hash:{},data:k}):h)))+'" height="0" frameborder="0" scrolling="no" class="cml-iframe" ALLOWTRANSPARENCY="true"></iframe>\n\n'},"3":function(j,h,f,i){var g;return"\n    "+this.escapeExpression(((g=(g=h.content||(j!=null?j.content:j))!=null?g:h.helperMissing),(typeof g==="function"?g.call(j,{name:"content",hash:{},data:i}):g)))+"\n\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(j,h,f,i){var g;return((g=h["if"].call(j,(j!=null?j.iframe:j),{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))!=null?g:"")},useData:true})},{"hbsfy/runtime":30}],20:[function(c,d,a){var b=c("hbsfy/runtime");d.exports=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(m,i,f,k){var h,l=i.helperMissing,j="function",g=this.escapeExpression;return'<div class="cml-loading cml-loading-'+g(((h=(h=i.type||(m!=null?m.type:m))!=null?h:l),(typeof h===j?h.call(m,{name:"type",hash:{},data:k}):h)))+" cml-loading-"+g(((h=(h=i.style||(m!=null?m.style:m))!=null?h:l),(typeof h===j?h.call(m,{name:"style",hash:{},data:k}):h)))+'">\n    <div class="cml-loading__content">\n        <span class="cml-loading__icon"></span>\n        <span class="cml-loading__label">'+g(((h=(h=i.text||(m!=null?m.text:m))!=null?h:l),(typeof h===j?h.call(m,{name:"text",hash:{},data:k}):h)))+"</span>\n    </div>\n</div>\n"},useData:true})},{"hbsfy/runtime":30}],21:[function(b,c,a){c.exports=function(f){var d=f||"comalaExports";return{require:function(i,k,h){var g=this._exports();var j=[];i=_.isArray(i)?i:[i];_(i).each(function(l){var m=g[l];if(_.isFunction(m)){m=m();g[l]=m}j.push(m)},this);k.apply(h,j)},_exports:function(){if(window[d]){return window[d]}if(window.parent&&window.parent[d]){return window.parent[d]}else{window[d]={events:function(){return _.extend({},Backbone.Events)}};return window[d]}},add:function(h,g){this._exports()[h]=g},remove:function(g){delete this._exports()[g]},resize:function(g){var h=g?g:AJS.$("body").outerHeight(true);h+=50;if(parent.document){AJS.$("iframe",parent.document).attr("height",h+"px")}},getQueryParams:function(g){var j={},i,h=/[?&]?([^=]+)=([^&]*)/g;g=g.split("+").join(" ");while(i=h.exec(g)){j[decodeURIComponent(i[1])]=decodeURIComponent(i[2])}return j},noAMD:function(h){var g=null;if(typeof define==="function"){g=define.amd;define.amd=null;h();define.amd=g}else{h()}},View:Backbone.View.extend({constructor:function(g,h){this.properties=g&&g.properties?g.properties:{};if(h&&h.properties){this.properties=_.extend(_.clone(h.properties),this.properties)}Backbone.View.prototype.constructor.apply(this,arguments)}})}}},{}],22:[function(b,c,a){c.exports=b("comala-ns")()},{"comala-ns":21}],23:[function(b,c,a){(function(f){var d=b("./handlebars/base");var h=b("./handlebars/safe-string")["default"];var j=b("./handlebars/exception")["default"];var l=b("./handlebars/utils");var i=b("./handlebars/runtime");var k=function(){var o=new d.HandlebarsEnvironment();l.extend(o,d);o.SafeString=h;o.Exception=j;o.Utils=l;o.escapeExpression=l.escapeExpression;o.VM=i;o.template=function(p){return i.template(p,o)};return o};var g=k();g.create=k;var m=typeof f!=="undefined"?f:window,n=m.Handlebars;g.noConflict=function(){if(m.Handlebars===g){m.Handlebars=n}};g["default"]=g;a["default"]=g}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./handlebars/base":24,"./handlebars/exception":25,"./handlebars/runtime":26,"./handlebars/safe-string":27,"./handlebars/utils":28}],24:[function(g,f,l){var n=g("./utils");var k=g("./exception")["default"];var r="3.0.1";l.VERSION=r;var b=6;l.COMPILER_REVISION=b;var h={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};l.REVISION_CHANGES=h;var m=n.isArray,d=n.isFunction,c=n.toString,a="[object Object]";function j(t,s){this.helpers=t||{};this.partials=s||{};o(this)}l.HandlebarsEnvironment=j;j.prototype={constructor:j,logger:p,log:i,registerHelper:function(s,t){if(c.call(s)===a){if(t){throw new k("Arg not supported with multiple helpers")}n.extend(this.helpers,s)}else{this.helpers[s]=t}},unregisterHelper:function(s){delete this.helpers[s]},registerPartial:function(t,s){if(c.call(t)===a){n.extend(this.partials,t)}else{if(typeof s==="undefined"){throw new k("Attempting to register a partial as undefined")}this.partials[t]=s}},unregisterPartial:function(s){delete this.partials[s]}};function o(s){s.registerHelper("helperMissing",function(){if(arguments.length===1){return undefined}else{throw new k("Missing helper: '"+arguments[arguments.length-1].name+"'")}});s.registerHelper("blockHelperMissing",function(v,u){var t=u.inverse,w=u.fn;if(v===true){return w(this)}else{if(v===false||v==null){return t(this)}else{if(m(v)){if(v.length>0){if(u.ids){u.ids=[u.name]}return s.helpers.each(v,u)}else{return t(this)}}else{if(u.data&&u.ids){var x=q(u.data);x.contextPath=n.appendContextPath(u.data.contextPath,u.name);u={data:x}}return w(v,u)}}}});s.registerHelper("each",function(t,E){if(!E){throw new k("Must pass iterator to #each")}var C=E.fn,x=E.inverse;var z=0,B="",y;var u;if(E.data&&E.ids){u=n.appendContextPath(E.data.contextPath,E.ids[0])+"."}if(d(t)){t=t.call(this)}if(E.data){y=q(E.data)}function v(G,F,H){if(y){y.key=G;y.index=F;y.first=F===0;y.last=!!H;if(u){y.contextPath=u+G}}B=B+C(t[G],{data:y,blockParams:n.blockParams([t[G],G],[u+G,null])})}if(t&&typeof t==="object"){if(m(t)){for(var w=t.length;z<w;z++){v(z,z,z===t.length-1)}}else{var A;for(var D in t){if(t.hasOwnProperty(D)){if(A){v(A,z-1)}A=D;z++}}if(A){v(A,z-1,true)}}}if(z===0){B=x(this)}return B});s.registerHelper("if",function(u,t){if(d(u)){u=u.call(this)}if((!t.hash.includeZero&&!u)||n.isEmpty(u)){return t.inverse(this)}else{return t.fn(this)}});s.registerHelper("unless",function(u,t){return s.helpers["if"].call(this,u,{fn:t.inverse,inverse:t.fn,hash:t.hash})});s.registerHelper("with",function(u,t){if(d(u)){u=u.call(this)}var v=t.fn;if(!n.isEmpty(u)){if(t.data&&t.ids){var w=q(t.data);w.contextPath=n.appendContextPath(t.data.contextPath,t.ids[0]);t={data:w}}return v(u,t)}else{return t.inverse(this)}});s.registerHelper("log",function(u,t){var v=t.data&&t.data.level!=null?parseInt(t.data.level,10):1;s.log(v,u)});s.registerHelper("lookup",function(u,t){return u&&u[t]})}var p={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(u,s){if(typeof console!=="undefined"&&p.level<=u){var t=p.methodMap[u];(console[t]||console.log).call(console,s)}}};l.logger=p;var i=p.log;l.log=i;var q=function(s){var t=n.extend({},s);t._parent=s;return t};l.createFrame=q},{"./exception":25,"./utils":28}],25:[function(b,d,a){var f=["description","fileName","lineNumber","message","name","number","stack"];function c(l,k){var m=k&&k.loc,h,j;if(m){h=m.start.line;j=m.start.column;l+=" - "+h+":"+j}var i=Error.prototype.constructor.call(this,l);for(var g=0;g<f.length;g++){this[f[g]]=i[f[g]]}if(m){this.lineNumber=h;this.column=j}}c.prototype=new Error();a["default"]=c},{}],26:[function(f,d,j){var l=f("./utils");var i=f("./exception")["default"];var c=f("./base").COMPILER_REVISION;var h=f("./base").REVISION_CHANGES;var p=f("./base").createFrame;function b(s){var r=s&&s[0]||1,u=c;if(r!==u){if(r<u){var q=h[u],t=h[r];throw new i("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+q+") or downgrade your runtime to an older version ("+t+").")}else{throw new i("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+s[1]+").")}}}j.checkRevision=b;function n(q,u){if(!u){throw new i("No environment passed to template")}if(!q||!q.main){throw new i("Unknown template object: "+typeof q)}u.VM.checkRevision(q.compiler);var t=function(y,B,z){if(z.hash){B=l.extend({},B,z.hash)}y=u.VM.resolvePartial.call(this,y,B,z);var v=u.VM.invokePartial.call(this,y,B,z);if(v==null&&u.compile){z.partials[z.name]=u.compile(y,q.compilerOptions,u);v=z.partials[z.name](B,z)}if(v!=null){if(z.indent){var x=v.split("\n");for(var A=0,w=x.length;A<w;A++){if(!x[A]&&A+1===w){break}x[A]=z.indent+x[A]}v=x.join("\n")}return v}else{throw new i("The partial "+z.name+" could not be compiled when running in runtime-only mode")}};var r={strict:function(w,v){if(!(v in w)){throw new i('"'+v+'" not defined in '+w)}return w[v]},lookup:function(y,w){var v=y.length;for(var x=0;x<v;x++){if(y[x]&&y[x][w]!=null){return y[x][w]}}},lambda:function(w,v){return typeof w==="function"?w.call(v):w},escapeExpression:l.escapeExpression,invokePartial:t,fn:function(v){return q[v]},programs:[],program:function(x,A,w,z,B){var v=this.programs[x],y=this.fn(x);if(A||B||z||w){v=k(this,x,y,A,w,z,B)}else{if(!v){v=this.programs[x]=k(this,x,y)}}return v},data:function(v,w){while(v&&w--){v=v._parent}return v},merge:function(x,w){var v=x||w;if(x&&w&&(x!==w)){v=l.extend({},w,x)}return v},noop:u.VM.noop,compilerInfo:q.compiler};var s=function(w,v){v=v||{};var y=v.data;s._setup(v);if(!v.partial&&q.useData){y=m(w,y)}var z,x=q.useBlockParams?[]:undefined;if(q.useDepths){z=v.depths?[w].concat(v.depths):[w]}return q.main.call(r,w,r.helpers,r.partials,y,x,z)};s.isTop=true;s._setup=function(v){if(!v.partial){r.helpers=r.merge(v.helpers,u.helpers);if(q.usePartial){r.partials=r.merge(v.partials,u.partials)}}else{r.helpers=v.helpers;r.partials=v.partials}};s._child=function(v,x,w,y){if(q.useBlockParams&&!w){throw new i("must pass block params")}if(q.useDepths&&!y){throw new i("must pass parent depths")}return k(r,v,q[v],x,0,w,y)};return s}j.template=n;function k(q,s,t,v,r,u,x){var w=function(z,y){y=y||{};return t.call(q,z,q.helpers,q.partials,y.data||v,u&&[y.blockParams].concat(u),x&&[z].concat(x))};w.program=s;w.depth=x?x.length:0;w.blockParams=r||0;return w}j.program=k;function g(q,s,r){if(!q){q=r.partials[r.name]}else{if(!q.call&&!r.name){r.name=q;q=r.partials[q]}}return q}j.resolvePartial=g;function a(q,s,r){r.partial=true;if(q===undefined){throw new i("The partial "+r.name+" could not be found")}else{if(q instanceof Function){return q(s,r)}}}j.invokePartial=a;function o(){return""}j.noop=o;function m(q,r){if(!r||!("root" in r)){r=r?p(r):{};r.root=q}return r}},{"./base":24,"./exception":25,"./utils":28}],27:[function(b,c,a){function d(f){this.string=f}d.prototype.toString=d.prototype.toHTML=function(){return""+this.string};a["default"]=d},{}],28:[function(g,d,i){var p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var a=/[&<>"'`]/g;var h=/[&<>"'`]/;function q(r){return p[r]}function n(t){for(var s=1;s<arguments.length;s++){for(var r in arguments[s]){if(Object.prototype.hasOwnProperty.call(arguments[s],r)){t[r]=arguments[s][r]}}}return t}i.extend=n;var c=Object.prototype.toString;i.toString=c;var b=function(r){return typeof r==="function"};if(b(/x/)){b=function(r){return typeof r==="function"&&c.call(r)==="[object Function]"}}var b;i.isFunction=b;var l=Array.isArray||function(r){return(r&&typeof r==="object")?c.call(r)==="[object Array]":false};i.isArray=l;function o(u,t){for(var s=0,r=u.length;s<r;s++){if(u[s]===t){return s}}return -1}i.indexOf=o;function k(r){if(typeof r!=="string"){if(r&&r.toHTML){return r.toHTML()}else{if(r==null){return""}else{if(!r){return r+""}}}r=""+r}if(!h.test(r)){return r}return r.replace(a,q)}i.escapeExpression=k;function j(r){if(!r&&r!==0){return true}else{if(l(r)&&r.length===0){return true}else{return false}}}i.isEmpty=j;function m(s,r){s.path=r;return s}i.blockParams=m;function f(r,s){return(r?r+".":"")+s}i.appendContextPath=f},{}],29:[function(b,c,a){c.exports=b("./dist/cjs/handlebars.runtime")["default"]},{"./dist/cjs/handlebars.runtime":23}],30:[function(b,c,a){c.exports=b("handlebars/runtime")["default"]},{"handlebars/runtime":29}],31:[function(b,c,a){var d=b("comala");var f=b("views/inline-dialog");c.exports=d.View.extend({defaults:{type:"content",content:"",width:300,padding:10,trigger:null,respondsTo:"toggle",liveEvents:false,align:"right middle",persistent:false,preload:false,loader:true,action:""},properties:{},action:null,dispatcher:null,initialize:function(i){this.options=_.extend(this.defaults,_.pick(i,Object.keys(this.defaults)));this.dialog=new f(i);this.properties.statemodel=this.dialog.statemodel;if(this.options.action){this.action=this.options.action}else{if(this.options.type=="iframe"){var h=this.options.content.split("?");var g=/(\w+)\/(\w+)$/.exec(h[0]);this.action=g[1]}else{this.action=this.id}}this.properties.statemodel.on("change:open",this.onOpenClose,this);this.properties.events.on("cw:layout.load",this.onLoad,this);return this.dialog},open:function(g){this.dialog.open(g);return this},close:function(g){this.dialog.close(g);return this},reload:function(){if(this.loaded()){this.dialog.startLoading()}return this},loaded:function(){return this.properties.statemodel.get("load")>0},onOpenClose:function(h,g,i){switch(g){case 0:this.onClose(i);break;case 1:this.onOpen(i);break;case -1:break}},onOpen:function(g){this.properties.events.trigger("cw:"+this.action+".opened")},onClose:function(g){this.properties.events.trigger("cw:"+this.action+".closed")},onLoad:function(g){if(g.action==this.action){this.dialog.stopLoading(g)}},remove:function(){this.properties.statemodel.off("change:open",this.onOpenClose,this);this.properties.events.off("cw:layout.load",this.onLoad,this);Backbone.View.prototype.remove.apply(this,arguments)}})},{comala:22,"views/inline-dialog":14}]},{},[1]);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.aui.staging:confluence-flags', location = 'flag/confluence-flag.js' */
define("confluence/flag",["ajs","jquery"],function(f,d){function h(a){var b=d('<span class="aui-icon icon-close" role="button" tabindex="0"></span>');b.click(function(){g(a)});b.keypress(function(b){if(b.which===f.keyCode.ENTER||b.which===f.keyCode.SPACE)g(a),b.preventDefault()});return a.find(".aui-message").append(b)[0]}function g(a){var b=a.get(0);b.setAttribute("aria-hidden","true");a=a.parent();i(a);b.dispatchEvent(new CustomEvent("aui-flag-close",{bubbles:!0}));return b}function i(a){a.hasClass("aui-flag-stack")&&
a.children('.aui-flag:not([aria-hidden="true"])').length&&(a.children(".aui-flag-stack-top-item").removeClass("aui-flag-stack-top-item"),a.children('.aui-flag:not([aria-hidden="true"])').last().addClass("aui-flag-stack-top-item"))}var j={body:"",close:"manual",title:"",type:"info",fifo:!1};return function(a){var a=d.extend({},j,a),b,c=a,c=f.template('<div class="aui-flag {extraClasses}"><div class="aui-message aui-message-{type} {type} {closeable} shadowed"><p class="title"><strong>{title}</strong></p>{body}<\!-- .aui-message --\></div></div>').fill({"body:html":c.body||
"",closeable:"never"===c.close?"":"closeable",title:c.title||"",type:c.type,extraClasses:c.extraClasses||""}).toString();b=d(c);b[0].close=function(){g(b)};"auto"===a.close?(h(b),b.find(".aui-message").addClass("aui-will-close"),setTimeout(function(){b[0].close()},5E3)):"manual"===a.close&&h(b);d("#aui-flag-container").find(".aui-flag").get().forEach(function(a){a.getAttribute("aria-hidden")==="true"&&d(a).remove()});c=d("#aui-flag-container");c.length||(c=d('<div id="aui-flag-container"></div>'),
d("body").prepend(c));if(a.stack){var e=d('[data-aui-flag-stack="'+a.stack+'"]');e.length||(e=d('<div data-aui-flag-stack="'+a.stack+'" class="aui-flag-stack"></div>'),e.appendTo(c));e.find('[aria-hidden="false"]').length||e.detach().appendTo(c);a.fifo?b.appendTo(e):b.prependTo(e);i(e)}else b.appendTo(c);f._internal.animation.recomputeStyle(b);a=b.attr("aria-hidden","false")[0];a.dispatchEvent(new CustomEvent("aui-flag-show",{bubbles:!0}));return a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.aui.staging:confluence-flags', location = 'flag/confluence-flag-scroll.js' */
define("confluence/flag-scroll",["jquery","ajs","confluence/meta","document"],function(c,j,k,l){function f(){var a=c("#"+g);if(a.find('.aui-flag[aria-hidden="false"]').length){var b;b=0;h?b=c("#header").height()+d:(b=e.scrollTop(),b=b<=i-d?i-Math.max(b,0):d);a.css("top",b)}}var d=20,i=71,g="aui-flag-container",h=!1,e;return function(a){e=(h=a("body").hasClass("theme-documentation"))?a("#splitter-content"):a(window);e.on("scroll",f);l.addEventListener("aui-flag-show",f);j.bind("rte-ready",function(){"page"===
k.get("content-type")&&a("#"+g).find('.aui-flag[aria-hidden="false"]').each(function(){this.close()})})}});require("confluence/module-exporter").safeRequire("confluence/flag-scroll",function(c){require("ajs").toInit(c)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-page', location = 'soy/comments.soy' */
// This file was automatically generated from comments.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Comments.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Comments == 'undefined') { Confluence.Templates.Comments = {}; }


Confluence.Templates.Comments.displayReplyEditorLoadingContainer = function(opt_data, opt_ignored) {
  return '<ol class="comment-threads"><li class="comment-thread">' + Confluence.Templates.Comments.displayCommentEditorCommon({comment: {ownerId: opt_data.contentId, parentId: opt_data.parentCommentId}, commenter: opt_data.commenter, state: 'loading', mode: 'reply'}) + '</li></ol>';
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.displayReplyEditorLoadingContainer.soyTemplateName = 'Confluence.Templates.Comments.displayReplyEditorLoadingContainer';
}


Confluence.Templates.Comments.displayTopLevelCommentEditorPlaceholder = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Comments.displayCommentEditorCommon({comment: {ownerId: opt_data.contentId}, commenter: opt_data.commenter, state: 'placeholder', mode: 'add'});
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.displayTopLevelCommentEditorPlaceholder.soyTemplateName = 'Confluence.Templates.Comments.displayTopLevelCommentEditorPlaceholder';
}


Confluence.Templates.Comments.displayEditEditorContainer = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Comments.displayCommentEditorCommon({comment: {ownerId: opt_data.contentId, id: opt_data.commentId}, commenter: opt_data.commenter, state: 'placeholder', mode: 'edit'});
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.displayEditEditorContainer.soyTemplateName = 'Confluence.Templates.Comments.displayEditEditorContainer';
}


Confluence.Templates.Comments.editorLoadErrorMessage = function(opt_data, opt_ignored) {
  return '<p>' + soy.$$escapeHtml(opt_data.message) + '</p><p><a href="' + soy.$$escapeHtml(opt_data.fallbackUrl) + '">' + soy.$$escapeHtml("Try again") + '</a></p>';
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.editorLoadErrorMessage.soyTemplateName = 'Confluence.Templates.Comments.editorLoadErrorMessage';
}


Confluence.Templates.Comments.displayCommentEditorCommon = function(opt_data, opt_ignored) {
  var output = '<div class="quick-comment-container comment ' + soy.$$escapeHtml(opt_data.mode) + '">' + Confluence.Templates.Comments.userLogo({userInfo: opt_data.commenter}) + '<div class="quick-comment-body"><div class="quick-comment-loading-container" style="display:' + ((opt_data.state == 'loading') ? 'block' : 'none') + ';"></div><div id="editor-messages"></div><div id="all-messages"></div><form style="display:' + ((opt_data.state == 'loading') ? 'none' : 'block') + ';" class="quick-comment-form aui" method="post" ';
  switch (opt_data.mode) {
    case 'add':
      output += 'name="inlinecommentform" action="' + soy.$$escapeHtml("") + '/pages/doaddcomment.action?pageId=' + soy.$$escapeHtml(opt_data.comment.ownerId) + '"';
      break;
    case 'edit':
      output += 'name="editcommentform" action="' + soy.$$escapeHtml("") + '/pages/doeditcomment.action?pageId=' + soy.$$escapeHtml(opt_data.comment.ownerId) + '&commentId=' + soy.$$escapeHtml(opt_data.comment.id) + '"';
      break;
    case 'reply':
      output += 'name="threadedcommentform"  action="' + soy.$$escapeHtml("") + '/pages/doaddcomment.action?pageId=' + soy.$$escapeHtml(opt_data.comment.ownerId) + '&parentId=' + soy.$$escapeHtml(opt_data.comment.parentId) + '"';
      break;
  }
  output += ' >' + ((opt_data.mode == 'add') ? '<div title="' + soy.$$escapeHtml("Add a Comment") + '" class="quick-comment-prompt"><span>' + soy.$$escapeHtml("Write a comment\u2026") + '</span></div>' : '') + '</form></div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.displayCommentEditorCommon.soyTemplateName = 'Confluence.Templates.Comments.displayCommentEditorCommon';
}


Confluence.Templates.Comments.userLogo = function(opt_data, opt_ignored) {
  return '<p class="comment-user-logo">' + ((opt_data.userInfo.userName == null) ? '<img class="userLogo logo anonymous" src="' + soy.$$escapeHtml("/s/en_GB/6211/3938a2601e8fc8d1decf2078567a8651fae8f539.10/_") + '/images/icons/profilepics/anonymous.png" alt="' + soy.$$escapeHtml("User icon") + ': ' + soy.$$escapeHtml("Anonymous") + '" title="' + soy.$$escapeHtml("Anonymous") + '">' : (opt_data.userInfo.profilePicture.isDefault) ? '<a class="userLogoLink" data-username="' + soy.$$escapeHtml(opt_data.userInfo.userName) + '" href="' + soy.$$escapeHtml("") + '/users/profile/editmyprofilepicture.action" title="' + soy.$$escapeHtml("Add a picture of yourself") + '"><img class="userLogo logo defaultLogo" src="' + soy.$$escapeHtml("/s/en_GB/6211/3938a2601e8fc8d1decf2078567a8651fae8f539.10/_") + '/images/icons/profilepics/add_profile_pic.png" alt="' + soy.$$escapeHtml("User icon") + ': ' + soy.$$escapeHtml("Add a picture of yourself") + '"></a>' : '<a class="userLogoLink" data-username="' + soy.$$escapeHtml(opt_data.userInfo.userName) + '" href="' + Confluence.Templates.User.userLinkUrl({username: opt_data.userInfo.userName}) + '"><img class="userLogo logo" src="' + soy.$$escapeHtml(opt_data.userInfo.profilePicture.path) + '" alt="' + soy.$$escapeHtml("User icon") + ': ' + soy.$$escapeHtml(opt_data.userInfo.userName) + '" title="' + soy.$$escapeHtml(opt_data.userInfo.userName) + '"></a>') + '</p>';
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.userLogo.soyTemplateName = 'Confluence.Templates.Comments.userLogo';
}


Confluence.Templates.Comments.displayComment = function(opt_data, opt_ignored) {
  return '' + ((opt_data.comment.parentId == 0 && opt_data.firstReply) ? '<div id="comments-section" class="pageSection group"><div class="section-header"><h2 id="comments-section-title" class="section-title">' + soy.$$escapeHtml("1 Comment") + '</h2>' + Confluence.Templates.Comments.commentThread({comment: opt_data.comment, commenter: opt_data.commenter, highlight: opt_data.highlight, topLevel: true}) + '</div></div>' : (opt_data.firstReply) ? Confluence.Templates.Comments.commentThread({comment: opt_data.comment, commenter: opt_data.commenter, highlight: opt_data.highlight, topLevel: false}) : Confluence.Templates.Comments.commentThreadItem({comment: opt_data.comment, commenter: opt_data.commenter, highlight: true}));
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.displayComment.soyTemplateName = 'Confluence.Templates.Comments.displayComment';
}


Confluence.Templates.Comments.commentThread = function(opt_data, opt_ignored) {
  return '<ol class="comment-threads' + ((opt_data.topLevel) ? ' top-level" id="page-comments' : '') + '">' + Confluence.Templates.Comments.commentThreadItem(opt_data) + '</ol>';
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.commentThread.soyTemplateName = 'Confluence.Templates.Comments.commentThread';
}


Confluence.Templates.Comments.commentThreadItem = function(opt_data, opt_ignored) {
  return '<li id="comment-thread-' + soy.$$escapeHtml(opt_data.comment.id) + '" class="comment-thread">' + Confluence.Templates.Comments.commentView(opt_data) + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.commentThreadItem.soyTemplateName = 'Confluence.Templates.Comments.commentThreadItem';
}


Confluence.Templates.Comments.commentView = function(opt_data, opt_ignored) {
  return '<div class="comment' + ((opt_data.highlight == true) ? ' focused' : '') + '" id="comment-' + soy.$$escapeHtml(opt_data.comment.id) + '">' + Confluence.Templates.Comments.userLogo({userInfo: opt_data.commenter}) + '<div class="comment-header"><h4 class="author">' + ((opt_data.commenter.userName == null) ? soy.$$escapeHtml("Anonymous") : '<a href="' + soy.$$escapeHtml("") + '/display/~' + soy.$$escapeUri(opt_data.commenter.userName) + '" class="url fn confluence-userlink" data-username="' + soy.$$escapeHtml(opt_data.commenter.userName) + '">' + soy.$$escapeHtml(opt_data.commenter.displayName) + '</a>') + '</h4></div><div class="comment-body"><div class="comment-content wiki-content">' + soy.$$filterNoAutoescape(opt_data.comment.html) + '</div><div class="comment-actions">' + Confluence.Templates.Comments.displayCommentActions({section: 'secondary', actions: opt_data.comment.secondaryActions, commentId: opt_data.comment.id}) + Confluence.Templates.Comments.displayCommentActions({section: 'primary', actions: opt_data.comment.primaryActions, commentId: opt_data.comment.id}) + '</div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.commentView.soyTemplateName = 'Confluence.Templates.Comments.commentView';
}


Confluence.Templates.Comments.displayCommentActions = function(opt_data, opt_ignored) {
  var output = '<ul class="comment-actions-' + soy.$$escapeHtml(opt_data.section) + '">';
  if (opt_data.actions != null) {
    var itemList211 = opt_data.actions;
    var itemListLen211 = itemList211.length;
    for (var itemIndex211 = 0; itemIndex211 < itemListLen211; itemIndex211++) {
      var itemData211 = itemList211[itemIndex211];
      output += '<li ' + ((itemData211.style != null) ? ' class="' + soy.$$escapeHtml(itemData211.style) + '"' : '') + '><a ' + ((itemData211.tooltip != null) ? ' title="' + soy.$$escapeHtml(itemData211.tooltip) + '"' : '') + ' href="' + soy.$$escapeHtml(itemData211.url) + '" ' + ((itemData211.id) ? ' id="' + soy.$$escapeHtml(itemData211.id) + '-' + soy.$$escapeHtml(opt_data.commentId) + '"' : '') + '><span>' + soy.$$escapeHtml(itemData211.label) + '</span></a></li>\n';
    }
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Comments.displayCommentActions.soyTemplateName = 'Confluence.Templates.Comments.displayCommentActions';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-page', location = 'jscripts/comment-display-manager.js' */
define("confluence-quick-edit/comment-display-manager",["ajs","confluence/legacy","confluence/templates","jquery"],function(g,j,h,c){var i={_updateCommentSectionTitle:function(){var a=c("#comments-section-title");if(0!==a.length){var b=this.commentCount();1===b?a.text("1 Comment"):a.text(g.format("{0} Comments",b))}},addComment:function(a,b,f,d){a={comment:b,commenter:a,highlight:f,context:{contextPath:g.Meta.get("context-path"),staticResourceUrlPrefix:g.Meta.get("static-resource-url-prefix")}};
if(this.hasComments()){if(0==b.parentId)a.firstReply=!1,f=c("#comments-section .comment-threads.top-level");else{var f=c("#comment-thread-"+b.parentId),e=f.children(".commentThreads");e.length?(a.firstReply=!1,f=e):a.firstReply=!0}d||this.clearFocus();d=c(h.Comments.displayComment(a));d.addClass("fadeInComment");f.append(d);this._updateCommentSectionTitle()}else a.firstReply=!0,d=c(h.Comments.displayComment(a)),d.addClass("fadeInComment"),c("#comments-section").prepend(d);j.Comments.bindRemoveConfirmation(b.id);
b=this.getCommentNode(b.id);b.scrollToElement();return b},addOrUpdateComment:function(a,b,c,d){var e=this.getCommentNode(b.id);return e?(e.find(".comment-content").html(b.html),d||this.clearFocus(),c&&e.addClass("focused"),e.addClass("fadeInComment"),e.scrollToElement(),e):this.addComment.apply(this,arguments)},isVisible:function(){return!c("#page-comments").hasClass("hidden")},hasComments:function(){return 0<this.commentCount()},commentCount:function(){return c("#comments-section .comment").not(".quick-comment-container").length},
clearFocus:function(){c(".comment").removeClass("focused")},getCommentNode:function(a){a=c("#comment-"+a);return a.length?a:null},getParentId:function(a){a=i.getCommentNode(a);return null!=a&&(a=a.closest("div.comment"),a.length)?(a=a.attr("id"),a=/\d+/.exec(a),parseInt(a)):0}};return i});require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/comment-display-manager","Confluence.CommentDisplayManager");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-page', location = 'jscripts/scroll-util.js' */
define("confluence-quick-edit/scroll-util",["window","document","jquery"],function(a,c,e){return{scrollToElement:function(){this.scrollWindowToElement()||this.scrollOverflowContainerToElement();return this},scrollWindowToElement:function(){function b(){return"pageYOffset"in a?a.pageYOffset:c.documentElement.scrollTop}var f=b(),d;if("number"===typeof a.innerWidth)d=a.innerHeight;else if(c.documentElement&&c.documentElement.clientWidth)d=c.documentElement.clientHeight;else return this[0].scrollIntoView(!1),
!0;var g=this.offset().top,h=this.height();return g+h+40>f+d?(this[0].scrollIntoView(!1),a.scrollBy(0,40),f!=b()):!0},scrollOverflowContainerToElement:function(){var b=null;this.parents().each(function(){var a=e(this).css("overflow");if("auto"==a||"scroll"==a)return b=e(this),!1});if(!b)return!1;var a=b.height(),d=this.offset().top,c=this.height(),a=a-(d+c+40);0>a&&(b[0].scrollTop-=a);return!0}}});require("confluence/module-exporter").safeRequire("confluence-quick-edit/scroll-util",function(a){require("jquery").fn.extend(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickreload:quick-reload-resources', location = 'main/quick-reload.soy' */
// This file was automatically generated from quick-reload.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace QuickReload.Templates.
 */

if (typeof QuickReload == 'undefined') { var QuickReload = {}; }
if (typeof QuickReload.Templates == 'undefined') { QuickReload.Templates = {}; }


QuickReload.Templates.pageEdit = function(opt_data, opt_ignored) {
  return '' + QuickReload.Templates.container({content: '<div class="qr-notice-authors">' + QuickReload.Templates.noticeHeader({users: opt_data.pageEditors}) + '</div><div class="qr-notice-summary">' + aui.buttons.button({text: "Reload page", type: 'text', extraClasses: 'qr-notice-show aui-button-text'}) + QuickReload.Templates.summaryText({users: opt_data.pageEditors}) + '</div>'});
};
if (goog.DEBUG) {
  QuickReload.Templates.pageEdit.soyTemplateName = 'QuickReload.Templates.pageEdit';
}


QuickReload.Templates.pageComment = function(opt_data, opt_ignored) {
  return '' + QuickReload.Templates.container({content: '<div class="qr-notice-authors">' + QuickReload.Templates.noticeHeader({users: opt_data.commentUsers}) + ((opt_data.commentUsers.length == 1) ? '<span class="qr-notice-text">"' + soy.$$escapeHtml(opt_data.noticeText) + '"</span>' : '') + '</div><div class="qr-notice-summary">' + aui.buttons.button({text: '' + ((opt_data.commentUsers.length > 1) ? soy.$$escapeHtml("Show all") : soy.$$escapeHtml("Show")), type: 'text', extraClasses: 'qr-notice-show aui-button-text'}) + QuickReload.Templates.summaryText({users: opt_data.commentUsers}) + '</div>'});
};
if (goog.DEBUG) {
  QuickReload.Templates.pageComment.soyTemplateName = 'QuickReload.Templates.pageComment';
}


QuickReload.Templates.inlineComment = function(opt_data, opt_ignored) {
  return '' + QuickReload.Templates.container({content: '<div class="qr-notice-authors">' + QuickReload.Templates.noticeHeader({users: opt_data.user}) + '<span class="qr-notice-text">"' + soy.$$escapeHtml(opt_data.noticeText) + '"</span></div><div class="qr-notice-summary">' + aui.buttons.button({text: '' + ((opt_data.reloadRequired) ? soy.$$escapeHtml("Reload page") : soy.$$escapeHtml("Show")), type: 'text', extraClasses: 'qr-notice-show aui-button-text', extraAttributes: ['data-reload-required', opt_data.reloadRequired]}) + QuickReload.Templates.summaryText({users: opt_data.user}) + '</div>'});
};
if (goog.DEBUG) {
  QuickReload.Templates.inlineComment.soyTemplateName = 'QuickReload.Templates.inlineComment';
}


QuickReload.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="qr-container">' + soy.$$filterNoAutoescape(opt_data.content) + '</div>';
};
if (goog.DEBUG) {
  QuickReload.Templates.container.soyTemplateName = 'QuickReload.Templates.container';
}


QuickReload.Templates.noticeHeader = function(opt_data, opt_ignored) {
  var output = '';
  var userList68 = opt_data.users;
  var userListLen68 = userList68.length;
  for (var userIndex68 = 0; userIndex68 < userListLen68; userIndex68++) {
    var userData68 = userList68[userIndex68];
    output += (userIndex68 < 8) ? aui.avatar.avatar({size: 'small', avatarImageUrl: userData68.profilePicture.path, title: userData68.displayName != '' ? userData68.displayName : "Anonymous", extraClasses: 'qr-author-avatar'}) : '';
  }
  return output;
};
if (goog.DEBUG) {
  QuickReload.Templates.noticeHeader.soyTemplateName = 'QuickReload.Templates.noticeHeader';
}


QuickReload.Templates.summaryText = function(opt_data, opt_ignored) {
  var output = '';
  var lastModifier__soy78 = opt_data.users[0];
  var others__soy79 = opt_data.users.length - 1;
  output += '<span class="qr-notice-summary-text">' + soy.$$escapeHtml("by") + ' ' + Confluence.Templates.User.usernameLink({canView: false, username: lastModifier__soy78.userName, fullName: lastModifier__soy78.displayName != '' ? lastModifier__soy78.displayName : "Anonymous"}) + ((others__soy79 == 1) ? ' ' + soy.$$escapeHtml("and 1 other") : '') + ((others__soy79 > 1) ? ' ' + soy.$$escapeHtml(AJS.format("and {0} others",others__soy79)) : '') + '</span>';
  return output;
};
if (goog.DEBUG) {
  QuickReload.Templates.summaryText.soyTemplateName = 'QuickReload.Templates.summaryText';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickreload:quick-reload-resources', location = 'utils/quick-reload-timer.js' */
define("confluence-quick-reload/utils/quick-reload-timer",["jquery","underscore"],function(c,d){function a(b,a){this.options=c.extend({min:3E4,max:36E5,inactivity:12E4},a);d.bindAll(this,"start","stop","_now","_timeSinceLastSeen","_setActive","_setActivityTrigger","_clamp","_intervalMultiplier");this.callback=b;this._timer=null;this._setActivityTrigger(this._setActive)}a.prototype.start=function(b){this.lastSeenTimestamp=this._now();this.stop();b&&this.callback();var a=function(){this.callback();
c.call(this)},c=function(){this.stop();this._timer=setTimeout(d.bind(a,this),this.options.min*this._intervalMultiplier())};c.call(this)};a.prototype.stop=function(){null!==this._timer&&(clearTimeout(this._timer),this._timer=null)};a.prototype._setActive=function(){if(null!==this._timer){var b=this._timeSinceLastSeen()>this.options.inactivity;this.lastSeenTimestamp=this._now();b&&this.start(!0)}};a.prototype._setActivityTrigger=function(b){document.addEventListener("visibilitychange",function(){document.hidden||
b()},!1);c(window).focus(b);c("body").click(b);c(window).scroll(b)};a.prototype._now=function(){return(new Date).getTime()};a.prototype._timeSinceLastSeen=function(){return this._now()+1-this.lastSeenTimestamp};a.prototype._clamp=function(b,a,c){a=Math.max(Math.min(a,c),b);return isNaN(a)?b:a};a.prototype._intervalMultiplier=function(){var a=(document.hidden?3:1)*Math.ceil(this._timeSinceLastSeen()/this.options.inactivity);return this._clamp(1,this.options.max/this.options.min,a)};return a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickreload:quick-reload-resources', location = 'utils/quick-reload-count.js' */
define("confluence-quick-reload/utils/quick-reload-count",function(){function a(){this.count=0}var b=document.title;a.prototype.getCount=function(){return this.count};a.prototype.setCount=function(a){this.count=a;this._displayCount()};a.prototype._displayCount=function(){document.title=(0<this.count?"("+this.count+") ":"")+b};return new a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickreload:quick-reload-resources', location = 'handlers/quick-reload-comments.js' */
define("confluence-quick-reload/handlers/quick-reload-comments","ajs underscore jquery confluence/flag confluence-quick-reload/utils/quick-reload-count confluence/legacy".split(" "),function(i,c,e,k,g,d){function h(c){return c.comment.id}var a,f=[];return{results:[],property:"comments",ignoreOnce:function(c){f.push(c)},filterNewResults:function(d,a){if(a.length===0)return a;var b=c.map(d,h);return c.filter(a,function(a){if(a.comment.isInlineComment)return false;a=h(a);if(c.contains(b,a))return false;
a=e.inArray(a,f);if(a>=0){f.splice(a,1);return false}return true})},render:function(f){g.setCount(g.getCount()+f.length);var f={close:"manual",type:"info",extraClasses:"qr-flag",fifo:true,stack:"quickreload"},j=this.results.length>1?i.format("{0} New comments",this.results.length):"New comment",b;b=c.clone(this.results);b.reverse();b=c.uniq(b,function(a){return a.commenter.userName});b=c.map(b,function(a){return a.commenter});var l=e("<div>").html(this.results[this.results.length-
1].comment.html).text();b=QuickReload.Templates.pageComment({commentUsers:b,noticeText:l});if(a===void 0||a.getAttribute("aria-hidden")==="true"){a=new k(e.extend({},{body:b,title:j},f));e(a).on("click",".qr-notice-show",c.bind(function(){var b=this.results;if(d&&d.CommentDisplayManager){d.CommentDisplayManager.clearFocus();c.map(b,function(a){var b=d.CommentDisplayManager.getCommentNode(h(a))!==null,a=d.CommentDisplayManager.addOrUpdateComment(a.commenter,a.comment,true,true);if(d.Likes&&!b){d.Likes.appendAction(e(a));
d.Likes.updateComment(e(a),{})}});d.CommentDisplayManager._updateCommentSectionTitle()}a.close()},this));e(a).on("aui-flag-close",c.bind(function(){g.setCount(g.getCount()-this.results.length);this.results=[]},this))}else{e(a).find(".qr-container").replaceWith(b);e(a).find(".title").text(j)}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickreload:quick-reload-resources', location = 'handlers/quick-reload-inline-comments.js' */
define("confluence-quick-reload/handlers/quick-reload-inline-comments",["underscore","jquery","ajs","confluence/flag","confluence-quick-reload/utils/quick-reload-count"],function(b,f,h,q,l){function o(a,d,b,e,c){a=QuickReload.Templates.inlineComment({user:[a.commenter],noticeText:a&&a.comment&&f("<div>").text(a.comment.html).text(),reloadRequired:d});c=1<c?"New inline comments":"New inline comment";c=new q(f.extend({},{title:c,body:a},{close:"manual",
type:"info",extraClasses:"qr-flag",fifo:!0,stack:"quickreload"}));f(c).find(".qr-notice-show").click(b);d||f(c).find(".qr-notice-show").click(c.close);f(c).on("aui-flag-close",e)}function n(a){return 0===a.comment.parentId}function i(a){return n(a)?a.comment.id:a.comment.parentId}return{results:[],property:"comments",filterNewResults:function(a,d){d=b.clone(d);d=b.filter(d,function(a){return a.comment.isInlineComment&&a.commenter.userName!==h.Meta.get("remote-user")});if(0<d.length)var f=b.map(a,
i),e=b.filter(d,n),c=b.filter(d,function(a){return!n(a)}),g=b.map(e,i),j=b.map(c,i),k=b.difference(j,g),p=[],c=b.filter(c,function(a){return-1!==k.indexOf(a.comment.parentId)&&-1===p.indexOf(a.comment.parentId)?(p.push(a.comment.parentId),!0):!1}),e=e.concat(c),d=b.filter(e,function(a){return-1===f.indexOf(i(a))});return d},render:function(a){l.setCount(l.getCount()+a.length);b.each(a,function(a){var m=i(a),e=function(){h.trigger("qr:show-new-thread",m)},c=function(){var a=h.Meta.Links.canonical(),
b=-1===a.indexOf("?")?"?":"&";window.location=a+b+"focusedCommentId="+m+"#comment-"+m},g=function(){this.results=b.filter(this.results,function(a){return i(a)!==m});l.setCount(l.getCount()-1)},g=b.bind(g,this),j=this.results.length;if(n(a)){var k=new f.Deferred;k.fail(function(a){o(a,!0,c,g,j)});k.done(function(a){o(a,!1,e,g,j)});h.trigger("qr:add-new-highlight",[a,k])}else o(a,!1,e,g,j)},this)}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickreload:quick-reload-resources', location = 'handlers/quick-reload-page.js' */
define("confluence-quick-reload/handlers/quick-reload-page",["underscore","jquery","ajs","confluence/flag","confluence-quick-reload/utils/quick-reload-count"],function(d,a,g,i,e){var c;return{results:[],property:"page",filterNewResults:function(c,a){return 0<a.length&&"string"!==typeof a[0]?a:[]},render:function(f){e.setCount(e.getCount()+f.length);var f={close:"manual",type:"info",extraClasses:"qr-flag",fifo:!0,stack:"quickreload"},h=1<this.results.length?g.format("{0} new edits",this.results.length):
"New page edits",b;b=d.clone(this.results);b.reverse();b=d.uniq(b,function(a){return a.editor.userName});b=d.map(b,function(a){return a.editor});b=QuickReload.Templates.pageEdit({pageEditors:b});void 0===c||"true"===c.getAttribute("aria-hidden")?(c=new i(a.extend({},{body:b,title:h},f)),a(c).on("click",".qr-notice-show",function(){a(this).prop("disabled",!0).prepend('<span class="aui-icon aui-icon-wait"></span>&nbsp;');window.location.reload()}),a(c).on("aui-flag-close",d.bind(function(){e.setCount(e.getCount()-
this.results.length);this.results=[]},this))):(a(c).find(".qr-container").replaceWith(b),a(c).find(".title").text(h))}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickreload:quick-reload-resources', location = 'main/quick-reload-manager.js' */
define("confluence-quick-reload/main/quick-reload-manager",["underscore","jquery","ajs","confluence-quick-reload/utils/quick-reload-timer"],function(h,f,g,i){function a(){this._isEnabled=!1;this.handlers=[];this.lastFetchTime=f('meta[name="confluence-request-time"]').attr("content")||(new Date).getTime();this._timer=null;h.bindAll(this,"addHandler","removeHandler","update","enable","disable","_onUpdateSuccess","_onUpdateError")}a.prototype.addHandler=function(d){for(var a=!1,e=0;e<this.handlers.length;e++)this.handlers[e]===
d&&(a=!0);!0!==a&&this.handlers.push(d)};a.prototype.removeHandler=function(d){if(d)for(var a=0;a<this.handlers.length;a++)if(this.handlers[a]===d){this.handlers.splice(a,1);break}};a.prototype.update=function(){f("body").hasClass("contenteditor")?this.disable():f.ajax({type:"GET",url:g.contextPath()+"/rest/quickreload/latest/"+g.Meta.get("page-id")+"?since="+encodeURIComponent(this.lastFetchTime),dataType:"json"}).done(this._onUpdateSuccess).fail(this._onUpdateError)};a.prototype.enable=function(){null===
this._timer&&(this._timer=new i(this.update));this._timer.start();this._isEnabled=!0};a.prototype.disable=function(){null!==this._timer&&this._timer.stop();this._isEnabled=!1};a.prototype.isEnabled=function(){return this._isEnabled};a.prototype._onUpdateSuccess=function(a,f,e){204!==e.status&&(this.lastFetchTime=a.time,h.map(this.handlers,function(c){var b=a[c.property];Array.isArray(b)||(b=[b]);b=c.filterNewResults(c.results,b);0<b.length&&(c.results=c.results.concat(b),c.render(b))},this))};a.prototype._onUpdateError=
function(a){a=a||{};if(a={404:"not found - the plugin has been probably been removed or disabled from Confluence",500:"generic server error",503:"service unavailable",504:"gateway timeout"}[a.status])this.disable(),g.log('Quick comment reload plugin has been disabled in this page due to a server error: "'+a+'". Please refresh the page to get it back.')};return new a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickreload:quick-reload-bootstrap', location = 'main/quick-reload-main.js' */
require("ajs confluence-quick-reload/main/quick-reload-manager confluence-quick-reload/handlers/quick-reload-comments confluence-quick-reload/handlers/quick-reload-inline-comments confluence-quick-reload/handlers/quick-reload-page confluence/legacy".split(" "),function(b,a,c,d,e,f){b.toInit(function(){if(!(b.DarkFeatures.isEnabled("quickreload.disabled")||!f.CommentDisplayManager||b.Meta.get("page-id")===void 0)){a.addHandler(c);a.addHandler(d);a.addHandler(e);a.enable();b.bind("page.commentAddedOrUpdated",
function(b,a){c.ignoreOnce(a.commentId)})}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-content-report-plugin:resources', location = 'com/atlassian/confluence/plugins/content_report/js/tablesorter-date-parser.js' */
(function(A){A(function(){A.tablesorter.addParser({id:"dateAttributeParser",is:function(B,D,C){return A(C).is(".content-report-table-macro .modified")
},format:function(B,D,C,E){return A(C).attr("data-sortable-date")
},type:"numeric"})
})
})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-content-report-plugin:resources', location = 'com/atlassian/confluence/plugins/content_report/soy/content-report-table.soy' */
// This file was automatically generated from content-report-table.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Plugins.ContentReport.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Plugins == 'undefined') { Confluence.Templates.Plugins = {}; }
if (typeof Confluence.Templates.Plugins.ContentReport == 'undefined') { Confluence.Templates.Plugins.ContentReport = {}; }


Confluence.Templates.Plugins.ContentReport.contentReportTable = function(opt_data, opt_ignored) {
  var output = '';
  var hasSocialColumn__soy3 = opt_data.showCommentsCount || opt_data.showLikesCount;
  if (opt_data.results.length == 0 && opt_data.blueprintKey) {
    output += '<div class="blueprint-blank-experience ' + soy.$$escapeHtml(opt_data.blueprintKey) + '"><div class="content"><h2>' + soy.$$escapeHtml(opt_data.blankTitle) + '</h2><p>' + soy.$$escapeHtml(opt_data.blankDescription) + '</p></div>' + ((opt_data.createButtonLabel) ? '<p><button class="create-from-template-button aui-button aui-button-primary" data-space-key="' + soy.$$escapeHtml(opt_data.dataSpaceKey) + '" data-content-blueprint-id="' + soy.$$escapeHtml(opt_data.contentBlueprintId) + '" href="' + soy.$$escapeHtml(opt_data.createContentUrl) + '" >' + soy.$$escapeHtml(opt_data.createButtonLabel) + '</button></p>' : '') + '</div>';
  } else {
    output += '<table class="aui content-report-table-macro' + ((hasSocialColumn__soy3) ? ' with-extra-columns' : '') + '"' + ((opt_data.analyticsKey) ? ' data-analytics-key="' + soy.$$escapeHtml(opt_data.analyticsKey) + '"' : '') + '><thead><tr><th>' + soy.$$escapeHtml("Title") + '</th><th>' + soy.$$escapeHtml("Creator") + '</th><th>' + soy.$$escapeHtml("Modified") + '</th></tr></thead><tbody>';
    var resultList43 = opt_data.results;
    var resultListLen43 = resultList43.length;
    if (resultListLen43 > 0) {
      for (var resultIndex43 = 0; resultIndex43 < resultListLen43; resultIndex43++) {
        var resultData43 = resultList43[resultIndex43];
        output += '<tr><td class="title"><a href="' + soy.$$escapeHtml(resultData43.urlPath) + '">' + soy.$$escapeHtml(resultData43.title) + '</a></td><td class="creator">' + Confluence.Templates.User.usernameLink({canView: opt_data.canViewProfiles, username: resultData43.creatorName, fullName: resultData43.creatorFullName, contextPath: opt_data.contextPath}) + '</td><td class="modified" data-sortable-date="' + soy.$$escapeHtml(resultData43.sortableDate) + '">' + soy.$$escapeHtml(resultData43.friendlyModificationDate) + '</td>' + ((hasSocialColumn__soy3) ? '<td class="social">' + ((opt_data.showCommentsCount && resultData43.commentCount != 0) ? '<span class="icon icon-comment"></span> <span class="count">' + soy.$$escapeHtml(resultData43.commentCount) + '</span>' : '') + ((opt_data.showLikesCount && resultData43.likeCount != 0) ? '<span class="icon icon-like"></span> <span class="count">' + soy.$$escapeHtml(resultData43.likeCount) + '</span>' : '') + '</td>' : '') + '</tr>';
      }
    } else {
      output += '<tr><td colspan="3">' + soy.$$escapeHtml("No content found.") + '</td></tr>';
    }
    output += '</tbody></table>' + ((opt_data.searchMoreResultsLinkUrl) ? '<div class="more-results"><a href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.searchMoreResultsLinkUrl) + '">' + soy.$$escapeHtml("Find more results") + '</a></div>' : '');
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Plugins.ContentReport.contentReportTable.soyTemplateName = 'Confluence.Templates.Plugins.ContentReport.contentReportTable';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-content-report-plugin:resources', location = 'com/atlassian/confluence/plugins/content_report/js/content-report-analytics.js' */
AJS.$(function(A){A(".content-report-table-macro").on("click",".title a",function(D){var B=A(D.delegateTarget).data("analytics-key");
if(B){var C="content-report-table-macro.content-click."+B;
AJS.trigger("analytics",{name:C})
}})
});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-experimental-table-sortable', location = 'js-vendor/jquery/jquery.tablesorter.js' */
/*
 * TableSorter 2.10.8 - Client-side table sorting with ease!
 * @requires jQuery v1.2.6+
 *
 * Copyright (c) 2007 Christian Bach
 * Examples and docs at: http://tablesorter.com
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 * @type jQuery
 * @name tablesorter
 * @cat Plugins/Tablesorter
 * @author Christian Bach/christian.bach@polyester.se
 * @contributor Rob Garrison/https://github.com/Mottie/tablesorter
 */
!(function(B){B.extend({tablesorter:new function(){var C=this;C.version="2.10.8";C.parsers=[];C.widgets=[];C.defaults={theme:"default",widthFixed:false,showProcessing:false,headerTemplate:"{content}",onRenderTemplate:null,onRenderHeader:null,cancelSelection:true,dateFormat:"mmddyyyy",sortMultiSortKey:"shiftKey",sortResetKey:"ctrlKey",usNumberFormat:true,delayInit:false,serverSideSorting:false,headers:{},ignoreCase:true,sortForce:null,sortList:[],sortAppend:null,sortInitialOrder:"asc",sortLocaleCompare:false,sortReset:false,sortRestart:false,emptyTo:"bottom",stringTo:"max",textExtraction:"simple",textSorter:null,widgets:[],widgetOptions:{zebra:["even","odd"]},initWidgets:true,initialized:null,tableClass:"tablesorter",cssAsc:"tablesorter-headerAsc",cssChildRow:"tablesorter-childRow",cssDesc:"tablesorter-headerDesc",cssHeader:"tablesorter-header",cssHeaderRow:"tablesorter-headerRow",cssIcon:"tablesorter-icon",cssInfoBlock:"tablesorter-infoOnly",cssProcessing:"tablesorter-processing",selectorHeaders:"> thead th, > thead td",selectorSort:"th, td",selectorRemove:".remove-me",debug:false,headerList:[],empties:{},strings:{},parsers:[]};function O(Y){if(typeof console!=="undefined"&&typeof console.log!=="undefined"){console.log(Y)}else{alert(Y)}}function I(Y,Z){O(Y+" ("+(new Date().getTime()-Z.getTime())+"ms)")}C.log=O;C.benchmark=I;function F(b,a,Y){if(!a){return""}var e=b.config,Z=e.textExtraction,d="";if(Z==="simple"){if(e.supportsTextContent){d=a.textContent}else{d=B(a).text()}}else{if(typeof Z==="function"){d=Z(a,b,Y)}else{if(typeof Z==="object"&&Z.hasOwnProperty(Y)){d=Z[Y](a,b,Y)}else{d=e.supportsTextContent?a.textContent:B(a).text()}}}return B.trim(d)}function J(e,g,c,b){var d,Z=C.parsers.length,Y=false,a="",f=true;while(a===""&&f){c++;if(g[c]){Y=g[c].cells[b];a=F(e,Y,b);if(e.config.debug){O("Checking if value was empty on row "+c+", column: "+b+': "'+a+'"')}}else{f=false}}while(--Z>=0){d=C.parsers[Z];if(d&&d.id!=="text"&&d.is&&d.is(a,e,Y)){return d}}return C.getParserById("text")}function K(k){var j=k.config,d=j.$tbodies=j.$table.children("tbody:not(."+j.cssInfoBlock+")"),m,g,b,e,f,Y,a,Z="";if(d.length===0){return j.debug?O("*Empty table!* Not building a parser cache"):""}m=d[0].rows;if(m[0]){g=[];b=m[0].cells.length;for(e=0;e<b;e++){f=j.$headers.filter(":not([colspan])");f=f.add(j.$headers.filter('[colspan="1"]')).filter('[data-column="'+e+'"]:last');Y=j.headers[e];a=C.getParserById(C.getData(f,Y,"sorter"));j.empties[e]=C.getData(f,Y,"empty")||j.emptyTo||(j.emptyToBottom?"bottom":"top");j.strings[e]=C.getData(f,Y,"string")||j.stringTo||"max";if(!a){a=J(k,m,-1,e)}if(j.debug){Z+="column:"+e+"; parser:"+a.id+"; string:"+j.strings[e]+"; empty: "+j.empties[e]+"\n"}g.push(a)}}if(j.debug){O(Z)}j.parsers=g}function X(q){var l=q.tBodies,d=q.config,n,Y,o=d.parsers,r,p,f,e,a,g,h,m,Z=[];d.cache={};if(!o){return d.debug?O("*Empty table!* Not building a cache"):""}if(d.debug){m=new Date()}if(d.showProcessing){C.isProcessing(q,true)}for(a=0;a<l.length;a++){d.cache[a]={row:[],normalized:[]};if(!B(l[a]).hasClass(d.cssInfoBlock)){n=(l[a]&&l[a].rows.length)||0;Y=(l[a].rows[0]&&l[a].rows[0].cells.length)||0;for(f=0;f<n;++f){g=B(l[a].rows[f]);h=[];if(g.hasClass(d.cssChildRow)){d.cache[a].row[d.cache[a].row.length-1]=d.cache[a].row[d.cache[a].row.length-1].add(g);continue}d.cache[a].row.push(g);for(e=0;e<Y;++e){r=F(q,g[0].cells[e],e);p=o[e].format(r,q,g[0].cells[e],e);h.push(p);if((o[e].type||"").toLowerCase()==="numeric"){Z[e]=Math.max(Math.abs(p)||0,Z[e]||0)}}h.push(d.cache[a].normalized.length);d.cache[a].normalized.push(h)}d.cache[a].colMax=Z}}if(d.showProcessing){C.isProcessing(q)}if(d.debug){I("Building cache for "+n+" rows",m)}}function V(u,s){var v=u.config,w=u.tBodies,d=[],g=v.cache,f,h,a,e,x,Z,t,q,p,o,Y,m;if(!g[0]){return }if(v.debug){m=new Date()}for(p=0;p<w.length;p++){x=B(w[p]);if(x.length&&!x.hasClass(v.cssInfoBlock)){Z=C.processTbody(u,x,true);f=g[p].row;h=g[p].normalized;a=h.length;e=a?(h[0].length-1):0;for(t=0;t<a;t++){Y=h[t][e];d.push(f[Y]);if(!v.appender||!v.removeRows){o=f[Y].length;for(q=0;q<o;q++){Z.append(f[Y][q])}}}C.processTbody(u,Z,false)}}if(v.appender){v.appender(u,d)}if(v.debug){I("Rebuilt table",m)}if(!s){C.applyWidget(u)}B(u).trigger("sortEnd",u)}function Q(u){var r=[],a={},q=0,h=B(u).find("thead:eq(0), tfoot").children("tr"),f,e,d,b,o,s,p,Y,n,g,m,Z;for(f=0;f<h.length;f++){s=h[f].cells;for(e=0;e<s.length;e++){o=s[e];p=o.parentNode.rowIndex;Y=p+"-"+o.cellIndex;n=o.rowSpan||1;g=o.colSpan||1;if(typeof (r[p])==="undefined"){r[p]=[]}for(d=0;d<r[p].length+1;d++){if(typeof (r[p][d])==="undefined"){m=d;break}}a[Y]=m;q=Math.max(m,q);B(o).attr({"data-column":m});for(d=p;d<p+n;d++){if(typeof (r[d])==="undefined"){r[d]=[]}Z=r[d];for(b=m;b<m+g;b++){Z[b]="x"}}}}u.config.columns=q;return a}function H(Y){return(/^d/i.test(Y)||Y===1)}function S(j){var a=Q(j),Y,b,e,d,k,g,Z,f=j.config;f.headerList=[];f.headerContent=[];if(f.debug){Z=new Date()}d=f.cssIcon?'<i class="'+f.cssIcon+'"></i>':"";f.$headers=B(j).find(f.selectorHeaders).each(function(c){b=B(this);Y=f.headers[c];f.headerContent[c]=this.innerHTML;k=f.headerTemplate.replace(/\{content\}/g,this.innerHTML).replace(/\{icon\}/g,d);if(f.onRenderTemplate){e=f.onRenderTemplate.apply(b,[c,k]);if(e&&typeof e==="string"){k=e}}this.innerHTML='<div class="tablesorter-header-inner">'+k+"</div>";if(f.onRenderHeader){f.onRenderHeader.apply(b,[c])}this.column=a[this.parentNode.rowIndex+"-"+this.cellIndex];this.order=H(C.getData(b,Y,"sortInitialOrder")||f.sortInitialOrder)?[1,0,2]:[0,1,2];this.count=-1;this.lockedOrder=false;g=C.getData(b,Y,"lockedOrder")||false;if(typeof g!=="undefined"&&g!==false){this.order=this.lockedOrder=H(g)?[1,1,1]:[0,0,0]}b.addClass(f.cssHeader);f.headerList[c]=this;b.parent().addClass(f.cssHeaderRow);b.attr("tabindex",0)});L(j);if(f.debug){I("Built headers:",Z);O(f.$headers)}}function P(Z,Y,b){var a=Z.config;a.$table.find(a.selectorRemove).remove();K(Z);X(Z);W(a.$table,Y,b)}function L(Z){var Y,a=Z.config;a.$headers.each(function(b,c){Y=C.getData(c,a.headers[b],"sorter")==="false";c.sortDisabled=Y;B(c)[Y?"addClass":"removeClass"]("sorter-false")})}function D(k){var e,b,Z,Y,h=k.config,g=h.sortList,d=[h.cssAsc,h.cssDesc],a=B(k).find("tfoot tr").children().removeClass(d.join(" "));h.$headers.removeClass(d.join(" "));Y=g.length;for(b=0;b<Y;b++){if(g[b][1]!==2){e=h.$headers.not(".sorter-false").filter('[data-column="'+g[b][0]+'"]'+(Y===1?":last":""));if(e.length){for(Z=0;Z<e.length;Z++){if(!e[Z].sortDisabled){e.eq(Z).addClass(d[g[b][1]]);if(a.length){a.filter('[data-column="'+g[b][0]+'"]').eq(Z).addClass(d[g[b][1]])}}}}}}}function N(a){if(a.config.widthFixed&&B(a).find("colgroup").length===0){var Y=B("<colgroup>"),Z=B(a).width();B(a.tBodies[0]).find("tr:first").children("td").each(function(){Y.append(B("<col>").css("width",parseInt((B(this).width()/Z)*1000,10)/10+"%"))});B(a).prepend(Y)}}function T(b,d){var a,Z,e,f=b.config,Y=d||f.sortList;f.sortList=[];B.each(Y,function(g,c){a=[parseInt(c[0],10),parseInt(c[1],10)];e=f.headerList[a[0]];if(e){f.sortList.push(a);Z=B.inArray(a[1],e.order);e.count=Z>=0?Z:a[1]%(f.sortReset?3:2)}})}function M(Z,Y){return(Z&&Z[Y])?Z[Y].type||"":""}function U(n,m,f){var l,d,b,Y,p,h=n.config,Z=!f[h.sortMultiSortKey],g=B(n);g.trigger("sortStart",n);m.count=f[h.sortResetKey]?2:(m.count+1)%(h.sortReset?3:2);if(h.sortRestart){d=m;h.$headers.each(function(){if(this!==d&&(Z||!B(this).is("."+h.cssDesc+",."+h.cssAsc))){this.count=-1}})}d=m.column;if(Z){h.sortList=[];if(h.sortForce!==null){l=h.sortForce;for(b=0;b<l.length;b++){if(l[b][0]!==d){h.sortList.push(l[b])}}}Y=m.order[m.count];if(Y<2){h.sortList.push([d,Y]);if(m.colSpan>1){for(b=1;b<m.colSpan;b++){h.sortList.push([d+b,Y])}}}}else{if(h.sortAppend&&h.sortList.length>1){if(C.isValueInArray(h.sortAppend[0][0],h.sortList)){h.sortList.pop()}}if(C.isValueInArray(d,h.sortList)){for(b=0;b<h.sortList.length;b++){p=h.sortList[b];Y=h.headerList[p[0]];if(p[0]===d){p[1]=Y.order[Y.count];if(p[1]===2){h.sortList.splice(b,1);Y.count=-1}}}}else{Y=m.order[m.count];if(Y<2){h.sortList.push([d,Y]);if(m.colSpan>1){for(b=1;b<m.colSpan;b++){h.sortList.push([d+b,Y])}}}}}if(h.sortAppend!==null){l=h.sortAppend;for(b=0;b<l.length;b++){if(l[b][0]!==d){h.sortList.push(l[b])}}}g.trigger("sortBegin",n);setTimeout(function(){D(n);R(n);V(n)},1)}function R(p){var d=0,h=p.config,j=h.sortList,e=j.length,a=p.tBodies.length,r,n,g,o,f,Y,Z,q,b,m;if(h.serverSideSorting||!h.cache[0]){return }if(h.debug){r=new Date()}for(g=0;g<a;g++){f=h.cache[g].colMax;Y=h.cache[g].normalized;Z=Y.length;m=(Y&&Y[0])?Y[0].length-1:0;Y.sort(function(i,c){for(n=0;n<e;n++){o=j[n][0];b=j[n][1];q=/n/i.test(M(h.parsers,o))?"Numeric":"Text";q+=b===0?"":"Desc";if(/Numeric/.test(q)&&h.strings[o]){if(typeof (h.string[h.strings[o]])==="boolean"){d=(b===0?1:-1)*(h.string[h.strings[o]]?-1:1)}else{d=(h.strings[o])?h.string[h.strings[o]]||0:0}}var k=B.tablesorter["sort"+q](p,i[o],c[o],o,f[o],d);if(k){return k}}return i[m]-c[m]})}if(h.debug){I("Sorting on "+j.toString()+" and dir "+b+" time",r)}}function G(Y,Z){Y.trigger("updateComplete");if(typeof Z==="function"){Z(Y[0])}}function W(Z,Y,a){if(Y!==false&&!Z[0].isProcessing){Z.trigger("sorton",[Z[0].config.sortList,function(){G(Z,a)}])}else{G(Z,a)}}function E(Z){var d=Z.config,a=d.$table,Y,b;d.$headers.find(d.selectorSort).add(d.$headers.filter(d.selectorSort)).unbind("mousedown.tablesorter mouseup.tablesorter sort.tablesorter keypress.tablesorter").bind("mousedown.tablesorter mouseup.tablesorter sort.tablesorter keypress.tablesorter",function(g,h){if(((g.which||g.button)!==1&&!/sort|keypress/.test(g.type))||(g.type==="keypress"&&g.which!==13)){return false}if(g.type==="mouseup"&&h!==true&&(new Date().getTime()-b>250)){return false}if(g.type==="mousedown"){b=new Date().getTime();return g.target.tagName==="INPUT"?"":!d.cancelSelection}if(d.delayInit&&!d.cache){X(Z)}var f=/TH|TD/.test(this.tagName)?B(this):B(this).parents("th, td").filter(":first"),c=f[0];if(!c.sortDisabled){U(Z,c,g)}});if(d.cancelSelection){d.$headers.attr("unselectable","on").bind("selectstart",false).css({"user-select":"none",MozUserSelect:"none"})}a.unbind("sortReset update updateRows updateCell updateAll addRows sorton appendCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave ".split(" ").join(".tablesorter ")).bind("sortReset.tablesorter",function(c){c.stopPropagation();d.sortList=[];D(Z);R(Z);V(Z)}).bind("updateAll.tablesorter",function(f,c,g){f.stopPropagation();C.refreshWidgets(Z,true,true);C.restoreHeaders(Z);S(Z);E(Z);P(Z,c,g)}).bind("update.tablesorter updateRows.tablesorter",function(f,c,g){f.stopPropagation();L(Z);P(Z,c,g)}).bind("updateCell.tablesorter",function(h,k,i,m){h.stopPropagation();a.find(d.selectorRemove).remove();var f,o,j,c=a.find("tbody"),n=c.index(B(k).parents("tbody").filter(":first")),g=B(k).parents("tr").filter(":first");k=B(k)[0];if(c.length&&n>=0){o=c.eq(n).find("tr").index(g);j=k.cellIndex;f=d.cache[n].normalized[o].length-1;d.cache[n].row[Z.config.cache[n].normalized[o][f]]=g;d.cache[n].normalized[o][j]=d.parsers[j].format(F(Z,k,j),Z,k,j);W(a,i,m)}}).bind("addRows.tablesorter",function(g,j,h,k){g.stopPropagation();var f,o=j.filter("tr").length,m=[],c=j[0].cells.length,n=a.find("tbody").index(j.parents("tbody").filter(":first"));if(!d.parsers){K(Z)}for(f=0;f<o;f++){for(Y=0;Y<c;Y++){m[Y]=d.parsers[Y].format(F(Z,j[f].cells[Y],Y),Z,j[f].cells[Y],Y)}m.push(d.cache[n].row.length);d.cache[n].row.push([j[f]]);d.cache[n].normalized.push(m);m=[]}W(a,h,k)}).bind("sorton.tablesorter",function(f,c,h,g){f.stopPropagation();a.trigger("sortStart",this);T(Z,c);D(Z);a.trigger("sortBegin",this);R(Z);V(Z,g);if(typeof h==="function"){h(Z)}}).bind("appendCache.tablesorter",function(c,g,f){c.stopPropagation();V(Z,f);if(typeof g==="function"){g(Z)}}).bind("applyWidgetId.tablesorter",function(c,f){c.stopPropagation();C.getWidgetById(f).format(Z,d,d.widgetOptions)}).bind("applyWidgets.tablesorter",function(c,f){c.stopPropagation();C.applyWidget(Z,f)}).bind("refreshWidgets.tablesorter",function(g,f,c){g.stopPropagation();C.refreshWidgets(Z,f,c)}).bind("destroy.tablesorter",function(g,h,f){g.stopPropagation();C.destroy(Z,h,f)})}C.construct=function(Y){return this.each(function(){if(!this.tHead||this.tBodies.length===0||this.hasInitialized===true){return(this.config&&this.config.debug)?O("stopping initialization! No thead, tbody or tablesorter has already been initialized"):""}var d=B(this),b=this,e,a="",Z=B.metadata;b.hasInitialized=false;b.isProcessing=true;b.config={};e=B.extend(true,b.config,C.defaults,Y);B.data(b,"tablesorter",e);if(e.debug){B.data(b,"startoveralltimer",new Date())}e.supportsTextContent=B("<span>x</span>")[0].textContent==="x";e.supportsDataObject=parseFloat(B.fn.jquery)>=1.4;e.string={max:1,min:-1,"max+":1,"max-":-1,zero:0,none:0,"null":0,top:true,bottom:false};if(!/tablesorter\-/.test(d.attr("class"))){a=(e.theme!==""?" tablesorter-"+e.theme:"")}e.$table=d.addClass(e.tableClass+a);e.$tbodies=d.children("tbody:not(."+e.cssInfoBlock+")");S(b);N(b);K(b);if(!e.delayInit){X(b)}E(b);if(e.supportsDataObject&&typeof d.data().sortlist!=="undefined"){e.sortList=d.data().sortlist}else{if(Z&&(d.metadata()&&d.metadata().sortlist)){e.sortList=d.metadata().sortlist}}C.applyWidget(b,true);if(e.sortList.length>0){d.trigger("sorton",[e.sortList,{},!e.initWidgets])}else{if(e.initWidgets){C.applyWidget(b)}}if(e.showProcessing){d.unbind("sortBegin.tablesorter sortEnd.tablesorter").bind("sortBegin.tablesorter sortEnd.tablesorter",function(c){C.isProcessing(b,c.type==="sortBegin")})}b.hasInitialized=true;b.isProcessing=false;if(e.debug){C.benchmark("Overall initialization time",B.data(b,"startoveralltimer"))}d.trigger("tablesorter-initialized",b);if(typeof e.initialized==="function"){e.initialized(b)}})};C.isProcessing=function(b,Z,a){b=B(b);var d=b[0].config,Y=a||b.find("."+d.cssHeader);if(Z){if(d.sortList.length>0){Y=Y.filter(function(){return this.sortDisabled?false:C.isValueInArray(parseFloat(B(this).attr("data-column")),d.sortList)})}Y.addClass(d.cssProcessing)}else{Y.removeClass(d.cssProcessing)}};C.processTbody=function(a,Y,Z){var b;if(Z){a.isProcessing=true;Y.before('<span class="tablesorter-savemyplace"/>');b=(B.fn.detach)?Y.detach():Y.remove();return b}b=B(a).find("span.tablesorter-savemyplace");Y.insertAfter(b);b.remove();a.isProcessing=false};C.clearTableBody=function(Y){B(Y)[0].config.$tbodies.empty()};C.restoreHeaders=function(Y){var Z=Y.config;Z.$table.find(Z.selectorHeaders).each(function(a){if(B(this).find(".tablesorter-header-inner").length){B(this).html(Z.headerContent[a])}})};C.destroy=function(d,Z,g){d=B(d)[0];if(!d.hasInitialized){return }C.refreshWidgets(d,true,true);var f=B(d),e=d.config,Y=f.find("thead:first"),a=Y.find("tr."+e.cssHeaderRow).removeClass(e.cssHeaderRow),b=f.find("tfoot:first > tr").children("th, td");Y.find("tr").not(a).remove();f.removeData("tablesorter").unbind("sortReset update updateAll updateRows updateCell addRows sorton appendCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave keypress sortBegin sortEnd ".split(" ").join(".tablesorter "));e.$headers.add(b).removeClass(e.cssHeader+" "+e.cssAsc+" "+e.cssDesc).removeAttr("data-column");a.find(e.selectorSort).unbind("mousedown.tablesorter mouseup.tablesorter keypress.tablesorter");C.restoreHeaders(d);if(Z!==false){f.removeClass(e.tableClass+" tablesorter-"+e.theme)}d.hasInitialized=false;if(typeof g==="function"){g(d)}};C.regex=[/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,/^0x[0-9a-f]+$/i];C.sortText=function(s,m,l,d){if(m===l){return 0}var k=s.config,j=k.string[(k.empties[d]||k.emptyTo)],Y=C.regex,p,f,h,q,Z,o,g,n;if(m===""&&j!==0){return typeof j==="boolean"?(j?-1:1):-j||-1}if(l===""&&j!==0){return typeof j==="boolean"?(j?1:-1):j||1}if(typeof k.textSorter==="function"){return k.textSorter(m,l,s,d)}p=m.replace(Y[0],"\\0$1\\0").replace(/\\0$/,"").replace(/^\\0/,"").split("\\0");h=l.replace(Y[0],"\\0$1\\0").replace(/\\0$/,"").replace(/^\\0/,"").split("\\0");f=parseInt(m.match(Y[2]),16)||(p.length!==1&&m.match(Y[1])&&Date.parse(m));q=parseInt(l.match(Y[2]),16)||(f&&l.match(Y[1])&&Date.parse(l))||null;if(q){if(f<q){return -1}if(f>q){return 1}}n=Math.max(p.length,h.length);for(g=0;g<n;g++){Z=isNaN(p[g])?p[g]||0:parseFloat(p[g])||0;o=isNaN(h[g])?h[g]||0:parseFloat(h[g])||0;if(isNaN(Z)!==isNaN(o)){return(isNaN(Z))?1:-1}if(typeof Z!==typeof o){Z+="";o+=""}if(Z<o){return -1}if(Z>o){return 1}}return 0};C.sortTextDesc=function(f,Z,Y,d){if(Z===Y){return 0}var h=f.config,g=h.string[(h.empties[d]||h.emptyTo)];if(Z===""&&g!==0){return typeof g==="boolean"?(g?-1:1):g||1}if(Y===""&&g!==0){return typeof g==="boolean"?(g?1:-1):-g||-1}if(typeof h.textSorter==="function"){return h.textSorter(Y,Z,f,d)}return C.sortText(f,Y,Z)};C.getTextValue=function(Z,e,c){if(e){var b,Y=Z?Z.length:0,f=e+c;for(b=0;b<Y;b++){f+=Z.charCodeAt(b)}return c*f}return 0};C.sortNumeric=function(g,Z,Y,f,j,i){if(Z===Y){return 0}var k=g.config,h=k.string[(k.empties[f]||k.emptyTo)];if(Z===""&&h!==0){return typeof h==="boolean"?(h?-1:1):-h||-1}if(Y===""&&h!==0){return typeof h==="boolean"?(h?1:-1):h||1}if(isNaN(Z)){Z=C.getTextValue(Z,j,i)}if(isNaN(Y)){Y=C.getTextValue(Y,j,i)}return Z-Y};C.sortNumericDesc=function(g,Z,Y,f,j,i){if(Z===Y){return 0}var k=g.config,h=k.string[(k.empties[f]||k.emptyTo)];if(Z===""&&h!==0){return typeof h==="boolean"?(h?-1:1):h||1}if(Y===""&&h!==0){return typeof h==="boolean"?(h?1:-1):-h||-1}if(isNaN(Z)){Z=C.getTextValue(Z,j,i)}if(isNaN(Y)){Y=C.getTextValue(Y,j,i)}return Y-Z};C.characterEquivalents={a:"\u00e1\u00e0\u00e2\u00e3\u00e4\u0105\u00e5",A:"\u00c1\u00c0\u00c2\u00c3\u00c4\u0104\u00c5",c:"\u00e7\u0107\u010d",C:"\u00c7\u0106\u010c",e:"\u00e9\u00e8\u00ea\u00eb\u011b\u0119",E:"\u00c9\u00c8\u00ca\u00cb\u011a\u0118",i:"\u00ed\u00ec\u0130\u00ee\u00ef\u0131",I:"\u00cd\u00cc\u0130\u00ce\u00cf",o:"\u00f3\u00f2\u00f4\u00f5\u00f6",O:"\u00d3\u00d2\u00d4\u00d5\u00d6",ss:"\u00df",SS:"\u1e9e",u:"\u00fa\u00f9\u00fb\u00fc\u016f",U:"\u00da\u00d9\u00db\u00dc\u016e"};C.replaceAccents=function(b){var Z,c="[",Y=C.characterEquivalents;if(!C.characterRegex){C.characterRegexArray={};for(Z in Y){if(typeof Z==="string"){c+=Y[Z];C.characterRegexArray[Z]=new RegExp("["+Y[Z]+"]","g")}}C.characterRegex=new RegExp(c+"]")}if(C.characterRegex.test(b)){for(Z in Y){if(typeof Z==="string"){b=b.replace(C.characterRegexArray[Z],Z)}}}return b};C.isValueInArray=function(b,Z){var c,Y=Z.length;for(c=0;c<Y;c++){if(Z[c][0]===b){return true}}return false};C.addParser=function(c){var b,Z=C.parsers.length,Y=true;for(b=0;b<Z;b++){if(C.parsers[b].id.toLowerCase()===c.id.toLowerCase()){Y=false}}if(Y){C.parsers.push(c)}};C.getParserById=function(Z){var a,Y=C.parsers.length;for(a=0;a<Y;a++){if(C.parsers[a].id.toLowerCase()===(Z.toString()).toLowerCase()){return C.parsers[a]}}return false};C.addWidget=function(Y){C.widgets.push(Y)};C.getWidgetById=function(a){var b,Z,Y=C.widgets.length;for(b=0;b<Y;b++){Z=C.widgets[b];if(Z&&Z.hasOwnProperty("id")&&Z.id.toLowerCase()===a.toLowerCase()){return Z}}};C.applyWidget=function(h,g){h=B(h)[0];var b=h.config,d=b.widgetOptions,e=[],Z,a,f,Y;if(b.debug){Z=new Date()}if(b.widgets.length){b.widgets=B.grep(b.widgets,function(i,c){return B.inArray(i,b.widgets)===c});B.each(b.widgets||[],function(c,j){Y=C.getWidgetById(j);if(Y&&Y.id){if(!Y.priority){Y.priority=10}e[c]=Y}});e.sort(function(i,c){return i.priority<c.priority?-1:i.priority===c.priority?0:1});B.each(e,function(j,c){if(c){if(g){if(c.hasOwnProperty("options")){d=h.config.widgetOptions=B.extend(true,{},c.options,d)}if(c.hasOwnProperty("init")){c.init(h,c,b,d)}}else{if(!g&&c.hasOwnProperty("format")){c.format(h,b,d,false)}}}})}if(b.debug){f=b.widgets.length;I("Completed "+(g===true?"initializing ":"applying ")+f+" widget"+(f!==1?"s":""),Z)}};C.refreshWidgets=function(f,e,Y){f=B(f)[0];var d,g=f.config,b=g.widgets,a=C.widgets,Z=a.length;for(d=0;d<Z;d++){if(a[d]&&a[d].id&&(e||B.inArray(a[d].id,b)<0)){if(g.debug){O("Refeshing widgets: Removing "+a[d].id)}if(a[d].hasOwnProperty("remove")){a[d].remove(f,g,g.widgetOptions)}}}if(Y!==true){C.applyWidget(f,e)}};C.getData=function(d,c,b){var e="",Z=B(d),Y,a;if(!Z.length){return""}Y=B.metadata?Z.metadata():false;a=" "+(Z.attr("class")||"");if(typeof Z.data(b)!=="undefined"||typeof Z.data(b.toLowerCase())!=="undefined"){e+=Z.data(b)||Z.data(b.toLowerCase())}else{if(Y&&typeof Y[b]!=="undefined"){e+=Y[b]}else{if(c&&typeof c[b]!=="undefined"){e+=c[b]}else{if(a!==" "&&a.match(" "+b+"-")){e=a.match(new RegExp("\\s"+b+"-([\\w-]+)"))[1]||""}}}}return B.trim(e)};C.formatFloat=function(a,b){if(typeof a!=="string"||a===""){return a}var Z,Y=b&&b.config?b.config.usNumberFormat!==false:typeof b!=="undefined"?b:true;if(Y){a=a.replace(/,/g,"")}else{a=a.replace(/[\s|\.]/g,"").replace(/,/g,".")}if(/^\s*\([.\d]+\)/.test(a)){a=a.replace(/^\s*\(/,"-").replace(/\)/,"")}Z=parseFloat(a);return isNaN(Z)?B.trim(a):Z};C.isDigit=function(Y){return isNaN(Y)?(/^[\-+(]?\d+[)]?$/).test(Y.toString().replace(/[,.'"\s]/g,"")):true}}()});var A=B.tablesorter;B.fn.extend({tablesorter:A.construct});A.addParser({id:"text",is:function(){return true},format:function(C,D){var E=D.config;if(C){C=B.trim(E.ignoreCase?C.toLocaleLowerCase():C);C=E.sortLocaleCompare?A.replaceAccents(C):C}return C},type:"text"});A.addParser({id:"digit",is:function(C){return A.isDigit(C)},format:function(C,D){var E=A.formatFloat((C||"").replace(/[^\w,. \-()]/g,""),D);return C&&typeof E==="number"?E:C?B.trim(C&&D.config.ignoreCase?C.toLocaleLowerCase():C):C},type:"numeric"});A.addParser({id:"currency",is:function(C){return(/^\(?\d+[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]|[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+\)?$/).test((C||"").replace(/[,. ]/g,""))},format:function(C,D){var E=A.formatFloat((C||"").replace(/[^\w,. \-()]/g,""),D);return C&&typeof E==="number"?E:C?B.trim(C&&D.config.ignoreCase?C.toLocaleLowerCase():C):C},type:"numeric"});A.addParser({id:"ipAddress",is:function(C){return(/^\d{1,3}[\.]\d{1,3}[\.]\d{1,3}[\.]\d{1,3}$/).test(C)},format:function(F,H){var E,D=F?F.split("."):"",G="",C=D.length;for(E=0;E<C;E++){G+=("00"+D[E]).slice(-3)}return F?A.formatFloat(G,H):F},type:"numeric"});A.addParser({id:"url",is:function(C){return(/^(https?|ftp|file):\/\//).test(C)},format:function(C){return C?B.trim(C.replace(/(https?|ftp|file):\/\//,"")):C},type:"text"});A.addParser({id:"isoDate",is:function(C){return(/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}/).test(C)},format:function(C,D){return C?A.formatFloat((C!=="")?(new Date(C.replace(/-/g,"/")).getTime()||""):"",D):C},type:"numeric"});A.addParser({id:"percent",is:function(C){return(/(\d\s*?%|%\s*?\d)/).test(C)&&C.length<15},format:function(C,D){return C?A.formatFloat(C.replace(/%/g,""),D):C},type:"numeric"});A.addParser({id:"usLongDate",is:function(C){return(/^[A-Z]{3,10}\.?\s+\d{1,2},?\s+(\d{4})(\s+\d{1,2}:\d{2}(:\d{2})?(\s+[AP]M)?)?$/i).test(C)||(/^\d{1,2}\s+[A-Z]{3,10}\s+\d{4}/i).test(C)},format:function(C,D){return C?A.formatFloat((new Date(C.replace(/(\S)([AP]M)$/i,"$1 $2")).getTime()||""),D):C},type:"numeric"});A.addParser({id:"shortDate",is:function(C){return(/(^\d{1,2}[\/\s]\d{1,2}[\/\s]\d{4})|(^\d{4}[\/\s]\d{1,2}[\/\s]\d{1,2})/).test((C||"").replace(/\s+/g," ").replace(/[\-.,]/g,"/"))},format:function(F,G,C,D){if(F){var I=G.config,E=I.headerList[D],H=E.dateFormat||A.getData(E,I.headers[D],"dateFormat")||I.dateFormat;F=F.replace(/\s+/g," ").replace(/[\-.,]/g,"/");if(H==="mmddyyyy"){F=F.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$1/$2")}else{if(H==="ddmmyyyy"){F=F.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$2/$1")}else{if(H==="yyyymmdd"){F=F.replace(/(\d{4})[\/\s](\d{1,2})[\/\s](\d{1,2})/,"$1/$2/$3")}}}}return F?A.formatFloat((new Date(F).getTime()||""),G):F},type:"numeric"});A.addParser({id:"time",is:function(C){return(/^(([0-2]?\d:[0-5]\d)|([0-1]?\d:[0-5]\d\s?([AP]M)))$/i).test(C)},format:function(C,D){return C?A.formatFloat((new Date("2000/01/01 "+C.replace(/(\S)([AP]M)$/i,"$1 $2")).getTime()||""),D):C},type:"numeric"});A.addParser({id:"metadata",is:function(){return false},format:function(D,E,C){var G=E.config,F=(!G.parserMetadataName)?"sortValue":G.parserMetadataName;return B(C).metadata()[F]},type:"numeric"});A.addWidget({id:"zebra",priority:90,format:function(N,K,M){var D,H,J,O,I,E,G,F,C=new RegExp(K.cssChildRow,"i"),L=K.$tbodies;if(K.debug){E=new Date()}for(G=0;G<L.length;G++){D=L.eq(G);F=D.children("tr").length;if(F>1){O=0;H=D.children("tr:visible");H.each(function(){J=B(this);if(!C.test(this.className)){O++}I=(O%2===0);J.removeClass(M.zebra[I?1:0]).addClass(M.zebra[I?0:1])})}}if(K.debug){A.benchmark("Applying Zebra widget",E)}},remove:function(H,I,F){var E,D,C=I.$tbodies,G=(F.zebra||["even","odd"]).join(" ");for(E=0;E<C.length;E++){D=B.tablesorter.processTbody(H,C.eq(E),true);D.children().removeClass(G);B.tablesorter.processTbody(H,D,false)}}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-experimental-table-sortable', location = 'js/aui-experimental-tables-sortable.js' */
(function(){var B={sortMultiSortKey:"",headers:{},debug:false};function A(D){var C=B;D.find("th").each(function(F,G){var E=AJS.$(G);C.headers[F]={};if(E.hasClass("aui-table-column-unsortable")){C.headers[F].sorter=false}else{E.attr("tabindex","0");E.wrapInner("<span class='aui-table-header-content'/>");if(E.hasClass("aui-table-column-issue-key")){C.headers[F].sorter="issue-key"}}});D.tablesorter(C)}AJS.tablessortable={setup:function(){AJS.$.tablesorter.addParser({id:"issue-key",is:function(){return false},format:function(G){var C=G.split("-");var D=C[0];var F=C[1];var I="..........";var H="000000";var E=(D+I).slice(0,I.length);E+=(H+F).slice(-H.length);return E},type:"text"});AJS.$.tablesorter.addParser({id:"textSortAttributeParser",is:function(C,E,D){return D.hasAttribute("data-sort-value")&&(!D.hasAttribute("data-sort-type")||D.getAttribute("data-sort-type")==="text")},format:function(C,E,D,F){return D.getAttribute("data-sort-value")},type:"text"});AJS.$.tablesorter.addParser({id:"numericSortAttributeParser",is:function(C,E,D){return D.getAttribute("data-sort-type")==="numeric"&&D.hasAttribute("data-sort-value")},format:function(C,E,D,F){return D.getAttribute("data-sort-value")},type:"numeric"});AJS.$(".aui-table-sortable").each(function(){A(AJS.$(this))})},setTableSortable:function(C){A(C)}};AJS.$(AJS.tablessortable.setup)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-sortable-tables:sortable-table-resources', location = 'js/SortableTables.js' */
define("confluence-sortable-tables/sortable-tables",["jquery","ajs","document"],function(b,g,h){function i(){var a=g.Meta.get("date.format"),b;a&&0!==a.length&&(a=a.toLowerCase()[0],"m"===a?b="mmddyyyy":"d"===a?b="ddmmyyyy":"y"===a&&(b="yyyymmdd"));return b}var f;return{init:function(){f=b("table").filter(function(){var a=b(this),e=a.find("td, th"),d=this.rows.length&&b(this.rows[0].cells),c;if("false"===a.attr("data-sortable")||-1<this.className.indexOf("tablesorter"))return!1;c=b.Event("makeSortable.SortableTables");
a.trigger(c);if(c.isDefaultPrevented()||!d||0===d.length)return!1;c=0;for(var f=e.length;c<f;c++)if(a=e[c],1!=a.rowSpan||1!=a.colSpan)return!1;return b(this.rows[0]).find("table").length||d.filter("th").length!==d.length||d.hasClass("nohighlight")?!1:this.rows[1]})},enable:function(){f.each(function(){if(-1<this.className.indexOf("tablesorter")||b(this).find("> :first-child").is("thead"))return!0;var a=this.removeChild(this.tBodies[0]),e=b(a.children),e=Array.prototype.shift.call(e),d=h.createDocumentFragment(),
c=h.createElement("thead");d.appendChild(c);c.appendChild(e);d.appendChild(a);this.appendChild(d)});f.tablesorter({cssHeader:"sortableHeader",delayInit:!0,textExtraction:function(a){return g.trim(b(a).text())},dateFormat:i()})},refresh:function(){this.init();this.enable()}}});require("confluence/module-exporter").safeRequire("confluence-sortable-tables/sortable-tables",function(b){require("ajs").toInit(function(){b.init();setTimeout(b.enable,100)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources', location = '/js/doctheme-utils.js' */
Confluence.DocThemeUtils=Confluence.DocThemeUtils||(function(f){var e;function c(){return(a().length)?true:false}function a(){if(!e){e=f("#splitter-content")}return e}function g(i){var h=f(i);f(i).appendTo(c()?a():f("body"));return h}function b(){return c()?a().scrollTop():f(document).scrollTop()}function d(){return c()?a().scrollLeft():f(document).scrollLeft()}return{isDocTheme:c,appendAbsolutePositionedElement:g,getMainContentScrollTop:b,getMainContentScrollLeft:d,getDocThemeContentElement:a}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources', location = '/js/scrolling-inline-dialog.js' */
Confluence.ScrollingInlineDialog=function(a,d,c,b){var g=Confluence.DocThemeUtils.getDocThemeContentElement();var e=Confluence.DocThemeUtils.isDocTheme();b=b||{};if(!b.container&&e){b.container=g}var f=function(k,s,J,z){var v;var L="auto";var G;var p=-7;var q;var w;var u=e?g.width():AJS.$(window).width();var K=s.target.position();K.top+=e?g.scrollTop():0;K.left+=e?g.scrollLeft():0;var i=s.target.outerWidth();var m=K.left+i/2;var C=e?g.scrollTop()+AJS.$(window).height()-AJS.$("#footer").outerHeight():(window.pageYOffset||document.documentElement.scrollTop)+AJS.$(window).height();var n=10;var o=20;G=K.top+s.target.outerHeight()+z.offsetY;var H=k.find(".arrow").outerWidth();var j=k.outerWidth();var D=s.target.outerWidth();if(z.centerOnHighlight){if(j>D){v=K.left-(j-D)/2;q=m-v-H/2}else{v=K.left+z.offsetX;q=(j-H)/2}}else{v=K.left+z.offsetX;if(j>D){q=m-v-H/2}else{q=(j-H)/2}}q=(q<0)?0:q;var h=(e)?(K.top-g.scrollTop()):(K.top-(window.pageYOffset||document.documentElement.scrollTop));var A=z.maxHeight||0;var t=k.height();var r=h>Math.max(t,A);var l=(G+k.height())<C;w=(!l&&r)||z.onTop;z.onTop=w;var y=u-(v+j+n);if(w){G=K.top-t-8;p=t}if(w===false&&l===false){var x=(G+t)-C;var E=e?g.scrollTop()+x+AJS.$("#footer").outerHeight():(window.pageYOffset||document.documentElement.scrollTop)+x+o;var F=e?g:AJS.$("html, body");F.stop().animate({scrollTop:E},500)}if(z.isRelativeToMouse){if(y<0){L=n;v="auto";q=J.x-(AJS.$(window).width()-z.width)}else{v=J.x-20;q=J.x-v}}else{if(y<0){L=n;v="auto";var I=u-L;var B=I-j;q=m-B-H/2}}return{displayAbove:w,popupCss:{left:v,right:L,top:G},arrowCss:{position:"absolute",left:q,right:"auto",top:p}}};if(!b.calculatePositions){b.calculatePositions=f}return AJS.InlineDialog.call(this,a,d,c,b)};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources', location = '/js/highlight-panel.js' */
Confluence.HighlightAction=(function(f){var d={};var c;var b={MAINCONTENT_AND_COMMENT:function(o){return Confluence.HighlightAction.RangeHelper.isSelectionInsideContent(f(".wiki-content"),o)},MAINCONTENT_ONLY:function(o){c=c||f(".wiki-content").first();return Confluence.HighlightAction.RangeHelper.isSelectionInsideContent(c,o)},COMMENT_ONLY:function(o){return Confluence.HighlightAction.RangeHelper.isSelectionInsideContent(f(".comment-content"),o)}};function a(p,q){var o={onClick:function(){},shouldDisplay:b.MAINCONTENT_AND_COMMENT};d[p]=f.extend(o,q)}function l(o){var p=d[o];if(!p){p=function(){AJS.logError("The button with key "+o+" doesn't have a registered handler")}}return p}function e(p){var o=Confluence.getContextPath()+"/rest/highlighting/1.0/insert-storage-fragment";return f.ajax({type:"POST",contentType:"application/json",url:o,data:JSON.stringify(p)})}function g(o){var p=Confluence.getContextPath()+"/rest/highlighting/1.0/insert-storage-column-table";return f.ajax({type:"POST",contentType:"application/json",url:p,data:JSON.stringify(o)})}function k(q,p,r){var o=i(r);o.tableColumnIndex=p;o.cellModifications=q;return o}function h(o,q){var p=i(q);p.xmlModification=o[0].xmlInsertion;return p}function j(o,q){var p=i(q);p.xmlModification=o;return p}function m(){if(window.getSelection){window.getSelection().empty&&window.getSelection().empty();window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges()}else{window.document.selection&&window.document.selection.empty()}}function i(p){var o={};o.pageId=p.pageId;o.selectedText=p.selectedText;o.index=p.index;o.numMatches=p.numMatches;o.lastFetchTime=n();return o}function n(){return f("meta[name='confluence-request-time']").attr("content")}return{registerButtonHandler:a,getButtonHandler:l,insertContentAtSelectionEnd:e,insertContentsInTableColumnCells:g,createTableInsertionBean:k,createInsertionBean:h,createXMLModificationBean:j,clearTextSelection:m,WORKING_AREA:b}})(AJS.$);Confluence.HighlightAction.RangeHelper=(function(h){function j(p){return{area:c(p),text:k(p),html:n(p),containingElement:d(p),range:p}}function c(q){var r=Confluence.DocThemeUtils.getMainContentScrollTop();var s=Confluence.DocThemeUtils.getMainContentScrollLeft();var w=q.getClientRects();if(!w.length&&q.parentElement()){var x=h(q.parentElement());var p=x.offset();w=[{top:p.top-((Confluence.DocThemeUtils.isDocTheme())?0:r),left:p.left-((Confluence.DocThemeUtils.isDocTheme())?0:s),bottom:p.top+x.height(),right:p.left+x.width()}]}var z=g(q,w);var u=function(E,D){var C={};C.top=E.top;C.left=E.left+s;C.bottom=D.bottom;if(E.left>=D.right){C.right=E.right}else{C.right=D.right}C.right=C.right+s;C.top=C.top+r;C.bottom=C.bottom+r;C.width=C.right-C.left;C.height=C.bottom-C.top;return C};var t=function(D){var C={};C.width=D.right-D.left;C.height=D.bottom-D.top;C.left=D.left+s;C.right=D.right+s;C.top=D.top+r;C.bottom=D.bottom+r;return C};var B=function(C){if(Confluence.DocThemeUtils.isDocTheme()){var D=Confluence.DocThemeUtils.getDocThemeContentElement().offset();C.left=C.left-D.left;C.right=C.right-D.left;C.top=C.top-D.top;C.bottom=C.bottom-D.top}return C};var A=B(u(z.first,z.last));var v=B(t(z.first));if(Confluence.HighlightAction.debug){var y=h("<div>").attr("id","highlight-actions-debug-helper");Confluence.DocThemeUtils.appendAbsolutePositionedElement(y).css(h.extend({position:"absolute",outline:"1px solid red"},A))}return{first:v,average:A}}function k(q){var p=(q.text!=undefined)?q.text:q.toString();return i(p)}function n(p){return(p.cloneContents)?h("<div>").append(p.cloneContents()).html():p.htmlText}function d(q){if(q.commonAncestorContainer){var p=q.commonAncestorContainer;if(p.nodeType==3){return p.parentNode}return p}else{if(q.parentElement){return q.parentElement()}}}function g(r,q){var p={};p.first=q[0];p.last=q[q.length-1];if(r.endOffset!=="undefined"){if(r.endOffset==0&&q.length>1){p.last=q[q.length-2]}}return p}function e(){if(window.getSelection&&window.getSelection().isCollapsed){return false}if(document.selection&&(document.selection.type=="None"||document.selection.createRange().htmlText=="")){return false}var s;if(window.getSelection){var p=window.getSelection();s=p.getRangeAt(p.rangeCount-1)}else{if(document.selection){s=document.selection.createRange()}}if(/^\s*$/.test(k(s))){var q=n(s);if(!q){return false}var r=q.toLowerCase().indexOf("<img ")!=-1;if(!r){return false}}if(!m(h(".wiki-content"),s)){return false}return s}function m(p,s){var q=d(s);var r=function(){var t=false;h.each(p,function(u,v){if(v===q||h.contains(v,q)){t=true;return false}});return t};return r()}function b(r,q){var p=k(o(r,q));var t=h.trim(k(q));var s=a(t,r);p=p.replace(/\s*$/,"");return{pageId:AJS.Meta.get("page-id"),selectedText:t,index:h.inArray(p.length-t.length,s),numMatches:s.length}}function f(p){if(document.createRange){return p.text()}else{range=document.body.createTextRange();range.moveToElementText(p.get(0));return range.text}}function o(r,q){var p;if(document.createRange){p=document.createRange();p.setStart(r.get(0),0);p.setEnd(q.endContainer,q.originalEndOffset)}else{p=document.body.createTextRange();p.moveToElementText(r.get(0));p.setEndPoint("EndToEnd",q)}return p}function a(u,s){var q=f(s);q=l(u,s.clone(),q);q=i(q);var t=0;var r=-1;var p=[];while((r=q.indexOf(u,t))>-1){p.push(r);t=r+1}return p}function l(u,t,r){var s=t.find('.user-mention, a[href^="/"]');t.find('.conf-macro[data-hasbody="false"]').each(function(){if(h(this).text().indexOf(u)>-1){s=s.add(this)}});if(s.length>0){var p=u.replace(/\S/g," ");var q=new RegExp(u.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");s.each(function(){var v=h(this).text();h(this).text(v.replace(q,p))});return f(t)}return r}function i(p){return p.replace(/\u00a0/g,"\u0020")}return{getRangeOption:j,getUserSelectionRange:e,getSelectionRects:c,getSelectionText:k,getSelectionHTML:n,getContainingElement:d,getFirstAndLastSelectionRect:g,isSelectionInsideContent:m,computeSearchTextObject:b}})(AJS.$);AJS.toInit(function(f){var i=f(".wiki-content").first();var g={ELEMENT_NODE:1,TEXT_NODE:3};var k={IMAGE:"IMG"};var a=f("<div>").attr("id","action-dialog-target");var d;var j="selection-action-panel";var b;var e;function o(){var r=Confluence.getContextPath()+"/rest/highlighting/1.0/panel-items";var q=AJS.Meta.get("page-id");if(q!=undefined){r=r+"?pageId="+q}var s=f.get(r,function(t){if(t.length){m(t)}});h(s)}function m(v){var y=c();var q=29;var z=false;var B=v.length*q;var A=Confluence.HighlightPanel.Templates.panelContent({webItems:v});var x=false;var s=function(D,C,E){if(!x){D.append(A);D.find(".aui-button").tooltip({gravity:"s"});l(D.parent());D.find("button").click(function(H){var F=f(this).attr("data-key");var I=Confluence.HighlightAction.getButtonHandler(F);z=true;d.hide();var G=Confluence.HighlightAction.RangeHelper.getRangeOption(b);if(f.trim(G.text)!==""){G.searchText=Confluence.HighlightAction.RangeHelper.computeSearchTextObject(i,b)}I.onClick(G)})}E();x=true;return false};var w=function(C){var D=false;C.find("button").each(function(E){var G=f(this);var F=G.attr("data-key");var I=Confluence.HighlightAction.getButtonHandler(F);var H=I.shouldDisplay(b);G.css("display",H?"inline-block":"none");D=D||H});if(!D){d.hide()}else{C.find(".contents").width("auto")}};var r=function(){Confluence.HighlightAction.Analytics.sendAnalyticsForOpeningHighlightOptionPanel();w(this.popup);y.bindHideEvents();a.show()};var u=function(){y.unbindHideEvents();a.hide()};var t={centerOnHighlight:true,onTop:true,fadeTime:0,width:B,persistent:true,initCallback:r,hideCallback:u};d=Confluence.ScrollingInlineDialog(a,j,s,t)}function l(q){q.children().attr("unselectable","on").on("selectstart",false)}function h(s){var q;var r=0;var t=1000;f(document).on("mouseup",function(u){s.done(function(w){if(!(w&&w.length>0)){return}var v=f(u.target);if(v.closest(".aui-inline-dialog").length!==0){return}setTimeout(function(){clearTimeout(q);var x=t;if(f(d[0]).is(":visible")){x=r}q=setTimeout(function(){n()},x)},r)})});s.done(function(){AJS.bind("quickedit.success",function(){d.hide()})})}function n(){b=Confluence.HighlightAction.RangeHelper.getUserSelectionRange();var q=function(t){return f.trim(t.toString())!==""};b.originalEndOffset=b.endOffset;if(!b||!q(b)){d.hide();return}var s=Confluence.HighlightAction.RangeHelper.getSelectionRects(b);if(!s){return}var r=p(s);if(r||!f(d[0]).is(":visible")){f(d[0]).hide();d.show()}}function c(){var t=function(){v();s()};var w=function(){q();y()};var r=false;var x=j+".inline-dialog-check";var v=function(){if(!r){f("body").bind("click."+x,function(A){var z=f(A.target);if(z.closest("#inline-dialog-"+j+" .contents").length===0){if(!b){d.hide()}}});r=true}};var q=function(){if(r){f("body").unbind("click."+x)}r=false};var u=function(z){if(z.keyCode===27){d.hide()}};var s=function(){f(document).on("keydown",u)};var y=function(){f(document).off("keydown",u)};return{bindHideEvents:t,unbindHideEvents:w}}function p(r){Confluence.DocThemeUtils.appendAbsolutePositionedElement(a);var q=false;if(!e||r.first.top!=e.first.top||r.first.height!=e.first.height||r.first.left!=e.first.left||r.first.width!=e.first.width){a.css({top:r.first.top,height:r.first.height,left:r.first.left,width:r.first.width});e=r;q=true}return q}o()});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources', location = '/js/quote-in-comment.js' */
AJS.toInit(function(f){var a=true;var h=false;var d="com.atlassian.confluence.plugins.confluence-highlight-actions:quote-comment";function b(l){var k=l.getBody().createTextRange();k.moveToElementText(l.getBody());k.collapse(false);k.select()}function e(){var k=40;if(Confluence.DocThemeUtils.isDocTheme()){var l=Confluence.DocThemeUtils.getDocThemeContentElement();var m=l.scrollTop()-f("#header").height()+f("#rte-toolbar").offset().top;l.scrollTop(m-k)}else{var m=f("#rte-toolbar").offset().top;f(document).scrollTop(m-k)}}function j(l,m){var n="<p><br/></p>";if(f.browser.msie&&!h){b(l);n="<p></p>"}var k="<blockquote><p>"+m.html+"</p></blockquote>"+n;l.execCommand("mceInsertContent",false,k);h=false}function i(k){Confluence.HighlightAction.clearTextSelection();setTimeout(function(){var l=AJS&&AJS.Rte&&AJS.Rte.getEditor&&AJS.Rte.getEditor();if(l){Confluence.HighlightAction.Analytics.sendAnalyticsForQuoteInComment();e();j(l,k)}else{Confluence.HighlightAction.Analytics.sendAnalyticsForQuoteInComment(a);h=true;var m=function(){j(AJS.Rte.getEditor(),k);AJS.unbind("quickedit.visible",m)};AJS.bind("quickedit.visible",m);c(g(k.containingElement))}},0)}function g(k){var l=f(k).closest("div.comment");return l}function c(k){if(!k.length>0){f(".quick-comment-prompt").click()}else{k.find(".comment-actions .action-reply-comment").click()}}Confluence&&Confluence.HighlightAction&&Confluence.HighlightAction.registerButtonHandler(d,{onClick:i,shouldDisplay:Confluence.HighlightAction.WORKING_AREA.MAINCONTENT_AND_COMMENT})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources', location = '/js/highlight-analytics.js' */
Confluence.HighlightAction.Analytics=(function(c){var b="confluence.highlight.actions.open";var e="confluence.quote.in.comment.insert";var g="confluence.quote.in.comment.append";function d(h,i){AJS.trigger("analytics",{name:h,data:i})}function a(){d(b)}function f(h){if(h){d(e)}else{d(g)}}return{sendAnalyticsForOpeningHighlightOptionPanel:a,sendAnalyticsForQuoteInComment:f}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources', location = '/soy/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.HighlightPanel.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.HighlightPanel == 'undefined') { Confluence.HighlightPanel = {}; }
if (typeof Confluence.HighlightPanel.Templates == 'undefined') { Confluence.HighlightPanel.Templates = {}; }


Confluence.HighlightPanel.Templates.panelContent = function(opt_data, opt_ignored) {
  var output = '';
  var webItemList3 = opt_data.webItems;
  var webItemListLen3 = webItemList3.length;
  for (var webItemIndex3 = 0; webItemIndex3 < webItemListLen3; webItemIndex3++) {
    var webItemData3 = webItemList3[webItemIndex3];
    output += '<button data-key="' + soy.$$escapeHtml(webItemData3.key) + '" class="aui-button aui-button-compact aui-button-subtle" title="' + soy.$$escapeHtml(webItemData3.label) + '"><span class="aui-icon aui-icon-small ' + soy.$$escapeHtml(webItemData3.styleClass) + '"/></button>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.HighlightPanel.Templates.panelContent.soyTemplateName = 'Confluence.HighlightPanel.Templates.panelContent';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.expand-macro:expand-macro-core', location = 'com/atlassian/confluence/plugins/expand/js/expand-macro-core.js' */
(function(){var a=function(b){this.$=b;this.createToggleFunction=function(e){var d=this.$;return function c(i){if(typeof e!="undefined"&&!e(i)){return}var f=d(this),g=d(".expand-control-icon",f),h=d(".expand-content",f.closest(".expand-container")).first();var j;if(h.hasClass("expand-hidden")){h.css("display","block");h.animate({opacity:1});j="expand"}else{h.animate({opacity:0},{complete:function(){h.hide()}});j="collapse"}h.toggleClass("expand-hidden");g.toggleClass("expanded");AJS.trigger("analyticsEvent",{name:"confluence.expand-macro.expand-click",data:{userAction:j}})}};this.getExpandElements=function(c){return this.$(".expand-control",c)}};Confluence=Confluence||{};Confluence.Plugins=Confluence.Plugins||{};Confluence.Plugins.ExpandMacro={bind:function(b,c,g,f){var e=new a(b);var d=e.getExpandElements(c);d.length&&d.bind(g,e.createToggleFunction(f))}}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.expand-macro:expand-macro-desktop-resources', location = 'com/atlassian/confluence/plugins/expand/js/expand-macro.js' */
AJS.toInit(function(a){Confluence.Plugins.ExpandMacro.bind(a,a("body"),"click keyup",function(b){return !(b.type=="keyup"&&b.keyCode!=13)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-business-blueprints:sharelinks-urlmacro-resources', location = 'com/atlassian/confluence/plugins/sharelinksurlmacro/soy/sharelinks-urlmacro-templates.soy' */
// This file was automatically generated from sharelinks-urlmacro-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Blueprints.SharelinksUrlMacro.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Blueprints == 'undefined') { Confluence.Blueprints = {}; }
if (typeof Confluence.Blueprints.SharelinksUrlMacro == 'undefined') { Confluence.Blueprints.SharelinksUrlMacro = {}; }


Confluence.Blueprints.SharelinksUrlMacro.bookmarkletLink = function(opt_data, opt_ignored) {
  return '<a class="aui-button sharelinks-urlmacro-button" href="' + Confluence.Blueprints.SharelinksUrlMacro.bookmarkletScript(opt_data) + '"><span>' + soy.$$escapeHtml("Share on Confluence") + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Blueprints.SharelinksUrlMacro.bookmarkletLink.soyTemplateName = 'Confluence.Blueprints.SharelinksUrlMacro.bookmarkletLink';
}


Confluence.Blueprints.SharelinksUrlMacro.bookmarkletScript = function(opt_data, opt_ignored) {
  return 'javascript:(function(){var screenWidth=screen.width,screenHeight=screen.height,popupWidth=640,popupHeight=580,popupLeft=0,popupTop=0; if(screenWidth>popupWidth){popupLeft=Math.round((screenWidth/2)-(popupWidth/2));}if(screenHeight>popupHeight){popupTop=Math.round((screenHeight/2)-(popupHeight/2));}window.open(\'' + soy.$$filterNoAutoescape(opt_data.bookmarkletActionURL) + '?bookmarkedURL=\'+encodeURIComponent(window.location.href), \'\',\'left=\'+popupLeft+\',top=\'+popupTop+\',width=\'+popupWidth+\',height=\'+popupHeight+\',personalbar=0,toolbar=0,scrollbars=1,resizable=1\');}());';
};
if (goog.DEBUG) {
  Confluence.Blueprints.SharelinksUrlMacro.bookmarkletScript.soyTemplateName = 'Confluence.Blueprints.SharelinksUrlMacro.bookmarkletScript';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-business-blueprints:sharelinks-urlmacro-resources', location = 'com/atlassian/confluence/plugins/sharelinksurlmacro/js/sharelinks-urlmacro.js' */
AJS.toInit(function(a){a(".sharelinks-urlmacro-button").click(function(){alert("Drag this link to your toolbar");return false})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jsUri', location = '/includes/js/third-party/jsUri.js' */
(function(){function g(a){a=decodeURIComponent(a);return a=a.replace("+"," ")}function h(a){var c,b,f,e,d=[];if("undefined"===typeof a||null===a||""===a)return d;0===a.indexOf("?")&&(a=a.substring(1));c=a.toString().split(/[&;]/);for(a=0;a<c.length;a++)b=c[a],f=b.split("="),e=f[0],b=-1===b.indexOf("=")?null:null===f[1]?"":f[1],d.push([e,b]);return d}function d(a){var c=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(a||
""),b={};"source protocol authority userInfo user password host port relative path directory file query anchor".split(" ").forEach(function(a,e){b[a]=c[e]||""});this.uriParts=b;this.queryPairs=h(this.uriParts.query);this.hasAuthorityPrefixUserPref=null}Array.prototype.forEach||(Array.prototype.forEach=function(a,c){for(var b=0,f=this.length;b<f;++b)a.call(c||this,this[b],b,this)});"protocol userInfo host port path anchor".split(" ").forEach(function(a){d.prototype[a]=function(c){typeof c!=="undefined"&&
(this.uriParts[a]=c);return this.uriParts[a]}});d.prototype.hasAuthorityPrefix=function(a){if(typeof a!=="undefined")this.hasAuthorityPrefixUserPref=a;return this.hasAuthorityPrefixUserPref===null?this.uriParts.source.indexOf("//")!==-1:this.hasAuthorityPrefixUserPref};d.prototype.query=function(a){var c="",b;if(typeof a!=="undefined")this.queryPairs=h(a);for(a=0;a<this.queryPairs.length;a++){b=this.queryPairs[a];c.length>0&&(c=c+"&");c=b[1]===null?c+b[0]:c+b.join("=")}return c.length>0?"?"+c:c};
d.prototype.getQueryParamValue=function(a){var c,b;for(b=0;b<this.queryPairs.length;b++){c=this.queryPairs[b];if(g(a)===g(c[0]))return c[1]}};d.prototype.getQueryParamValues=function(a){var c=[],b,f;for(b=0;b<this.queryPairs.length;b++){f=this.queryPairs[b];g(a)===g(f[0])&&c.push(f[1])}return c};d.prototype.deleteQueryParam=function(a,c){var b=[],f,e,d,h;for(f=0;f<this.queryPairs.length;f++){e=this.queryPairs[f];d=g(e[0])===g(a);h=g(e[1])===g(c);(arguments.length===1&&!d||arguments.length===2&&!d&&
!h)&&b.push(e)}this.queryPairs=b;return this};d.prototype.addQueryParam=function(a,c,b){if(arguments.length===3&&b!==-1){b=Math.min(b,this.queryPairs.length);this.queryPairs.splice(b,0,[a,c])}else arguments.length>0&&this.queryPairs.push([a,c]);return this};d.prototype.replaceQueryParam=function(a,c,b){var d=-1,e,h;if(arguments.length===3){for(e=0;e<this.queryPairs.length;e++){h=this.queryPairs[e];if(g(h[0])===g(a)&&decodeURIComponent(h[1])===g(b)){d=e;break}}this.deleteQueryParam(a,b).addQueryParam(a,
c,d)}else{for(e=0;e<this.queryPairs.length;e++){h=this.queryPairs[e];if(g(h[0])===g(a)){d=e;break}}this.deleteQueryParam(a);this.addQueryParam(a,c,d)}return this};"protocol hasAuthorityPrefix userInfo host port path query anchor".split(" ").forEach(function(a){var c="set"+a.charAt(0).toUpperCase()+a.slice(1);d.prototype[c]=function(b){this[a](b);return this}});d.prototype.scheme=function(){var a="";if(this.protocol()){a=a+this.protocol();this.protocol().indexOf(":")!==this.protocol().length-1&&(a=
a+":");a=a+"//"}else this.hasAuthorityPrefix()&&this.host()&&(a=a+"//");return a};d.prototype.origin=function(){var a=this.scheme();if(this.userInfo()&&this.host()){a=a+this.userInfo();this.userInfo().indexOf("@")!==this.userInfo().length-1&&(a=a+"@")}if(this.host()){a=a+this.host();this.port()&&(a=a+(":"+this.port()))}return a};d.prototype.toString=function(){var a=this.origin();if(this.path())a=a+this.path();else if(this.host()&&(this.query().toString()||this.anchor()))a=a+"/";if(this.query().toString()){this.query().toString().indexOf("?")!==
0&&(a=a+"?");a=a+this.query().toString()}if(this.anchor()){this.anchor().indexOf("#")!==0&&(a=a+"#");a=a+this.anchor()}return a};d.prototype.clone=function(){return new d(this.toString())};define("confluence/jsUri",function(){return d})})(this);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-resources', location = 'js/inline-tasks.js' */
(function(g){function f(n){var i,o;if(n.offsetX===undefined){var m=0,l=0,k=n.target,j;do{if(k.scrollTop!=0||k.scrollLeft!=0){j=k}m+=k.offsetLeft;l+=k.offsetTop;k=k.offsetParent}while(k&&k!=k.offsetParent);i=n.pageX+(j?j.scrollLeft:0)-m;o=n.pageY+(j?j.scrollTop:0)-l}else{i=n.offsetX;o=n.offsetY}return i>=3&&i<=14&&o>=3&&o<=14}function e(i){return i.currentTarget===i.target}function d(j){var i="page";if(j.closest("table.tasks-report").length){i="report"}else{if(j.closest("#task-container").length){i="mytasks"}else{if(j.closest("ul.inline-task-list").length){i="task"}}}return i}function h(l,j){var i=l.attr("data-inline-task-id");var k=l.find(j).first();if(k.closest("li").attr("data-inline-task-id")===i){return k}else{return g()}}function c(j){var k=""+j.getFullYear();var l=""+(j.getMonth()+1);var i=""+j.getDate();if(l.length<2){l="0"+l}if(i.length<2){i="0"+i}return[k,l,i].join("-")}var a=false;g(window).bind("beforeunload",function(){a=true});var b=[];g(document).delegate("ul.inline-task-list > li[data-inline-task-id]",{click:function(n){if(e(n)&&f(n)){var l=g(n.target).toggleClass("checked"),i=l.hasClass("checked")?"CHECKED":"UNCHECKED",k=l.data("inline-task-id"),o=l.closest("ul").attr("data-inline-tasks-content-id")||AJS.params.pageId,j=AJS.contextPath()+"/rest/inlinetasks/1/task/"+o+"/"+k+"/";l.prop("disabled",true);var m=l.closest("tr");m.attr("aria-disabled",true);b.push(k);AJS.trigger("inline-tasks.status-update.start",{status:i,taskId:k,taskListQueue:b});g.ajax({type:"POST",url:j,data:{status:i,trigger:"VIEW_PAGE",atl_token:AJS.Meta.get("atl-token")},dataType:"text",timeout:30000,error:function(q,s,p){if(a||s==="timeout"){return}AJS.logError("Inline Task #"+k+" was not persisted to "+i+" because of "+p+" (status: "+s+")");l.toggleClass("checked");var r;if(q.status===403){r=new Confluence.InlineTasks.Notice({textMessage:"Oops! You can\'t update this task because you are not allowed to edit the page it appears on.",className:"forbidden-notice"})}else{r=new Confluence.InlineTasks.Notice()}r.show()},success:function(){var p={dueDate:h(l,"time").attr("datetime"),completionDate:c(new Date()),mode:"view",assigneeUsername:h(l,".user-mention").attr("data-username"),context:d(l)};if(i==="CHECKED"){AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.completed",data:p})}}}).always(function(){l.prop("disabled",false);var p=l.closest("tr");p.attr("aria-disabled",false);b.splice(AJS.indexOf(b,k),1);AJS.trigger("inline-tasks.status-update.complete",{status:i,taskId:k,taskListQueue:b})})}},mousemove:function(i){if(e(i)){if(f(i)){g(i.target).addClass("hover")}else{g(i.target).removeClass("hover")}}},mouseout:function(i){if(e(i)){g(i.target).removeClass("hover")}},mousedown:function(i){if(e(i)&&f(i)){g(i.target).addClass("task-active")}},mouseup:function(i){if(e(i)&&f(i)){g(i.target).removeClass("task-active")}}});g("ul.inline-task-list li:not(.checked) time.date-upcoming").tooltip({title:function(){return "This task is due in less than a week"},live:true});g("ul.inline-task-list li:not(.checked) time.date-past").tooltip({title:function(){return "This task is overdue"},live:true});g("span.emptycompletedate").tooltip({title:function(){return "A completion date wasn\'t recorded for this task"},live:true});g(document).on("click","time",function(){var j=g(this);var i={date:j.attr("datetime"),mode:"view",context:d(j)};AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.clicked",data:i})})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-resources', location = 'js/inline-tasks-alert.js' */
Confluence.InlineTasks=Confluence.InlineTasks||{};(function(b){var a=function(c){this.settings=b.extend({},a.DEFAULTS,c);this.template=Confluence.InlineTasks.Templates;b("#inline-tasks-notice").remove();var d=b(this.template.notice(this.settings));d.hide().appendTo("body");d.find(".notice-close").click(function(){d.hide()});this.$notice=d};a.DEFAULTS={textMessage:"Oops! Your task change couldn\'t be saved. \u003cbr/\u003eThere could be a few reasons for this.",className:"general-notice"};a.prototype.show=function(){this.$notice.show();return this};a.prototype.hide=function(){this.$notice.hide();return this};Confluence.InlineTasks.Notice=a}(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-resources', location = 'templates/inline-tasks.soy' */
// This file was automatically generated from inline-tasks.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.InlineTasks.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.InlineTasks == 'undefined') { Confluence.InlineTasks = {}; }
if (typeof Confluence.InlineTasks.Templates == 'undefined') { Confluence.InlineTasks.Templates = {}; }


Confluence.InlineTasks.Templates.notice = function(opt_data, opt_ignored) {
  return '<div class="aui-message error' + ((opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '') + '" id="inline-tasks-notice">' + soy.$$filterNoAutoescape(opt_data.textMessage) + '&nbsp;&nbsp;<a href="#" class="notice-close">' + soy.$$escapeHtml("Dismiss") + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.InlineTasks.Templates.notice.soyTemplateName = 'Confluence.InlineTasks.Templates.notice';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-resources', location = 'js/inline-tasks-focus.js' */
AJS.$(document).ready(function(f){var d="focusedTaskId";var a=require("confluence/jsUri");var c=new a(window.location.href);var g=c.getQueryParamValue(d);if(g){var b=$("li[data-inline-task-id="+g+"]");if(b.length){b.addClass("focused");window.scrollTo(b.offset().left,(b.offset().top-($(window).height()/2)))}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:sortable-table-server-side', location = 'js/jquery.tablesorter.serveronly.js' */
(function(a){a.extend({tablesorterServerOnly:new function(){this.defaults={classNameDisableSorting:"aui-table-column-unsortable",classNameHeaderDesc:"tablesorter-headerDesc",classNameHeaderAsc:"tablesorter-headerAsc",reverseSort:false,sortColumn:"",onInit:function(){},onSort:function(){},events:{clickHeader:"click.sortServerOnly",refreshHeader:"refreshHeader.sortServerOnly",simulateClickHeader:"simulateClickHeader.sortServerOnly"}};var b=this;var d={updateCurrentHeaderSort:function(e,f){d.resetHeadersSort(e,f);f.$headers.each(function(){var h=a(this),g=h.attr("data-column-name");var i=f.reverseSort;if(g===f.sortColumn){i?h.addClass(f.classNameHeaderDesc):h.addClass(f.classNameHeaderAsc)}})},resetHeadersSort:function(e,f){f.$headers.removeClass(f.classNameHeaderDesc).removeClass(f.classNameHeaderAsc)},prepareHTMLHeader:function(e,f){f.$headers.not("."+f.classNameDisableSorting).attr("unselectable","on").bind("selectstart",false).addClass("tablesorter-header").wrapInner("<span class='aui-table-header-content'/>")},bindEvents:function(f,g){var e=a(f);e.on(g.events.refreshHeader,function(){d.updateCurrentHeaderSort(f,g)});e.on(g.events.simulateClickHeader,function(i,j,h){g.reverseSort=h;g.sortColumn=j})}};var c=function(f,g){var e=a(f);g.$table=e;g.$headers=e.find("thead th");g.$tbodies=e.find("tbody");d.prepareHTMLHeader(f,g);d.updateCurrentHeaderSort(f,g);if(typeof g.onInit==="function"){g.onInit.apply(f,[g])}g.$headers.on(g.events.clickHeader,function(){var h=a(this);if(h.hasClass(g.classNameDisableSorting)){return false}var i=h.attr("data-column-name");if(i===g.sortColumn){g.reverseSort=!g.reverseSort}else{g.reverseSort=false}g.sortColumn=i;if(typeof g.onSort==="function"){g.onSort.apply(f,[g])}return false});d.bindEvents(f,g)};b.construct=function(e){return this.each(function(){var f=this,g=a.extend(true,{},a.tablesorterServerOnly.defaults,e);if(this.config&&f.hasInitialized&&a.tablesorter){a.tablesorter.destroy(f,false,function(){c(f,g)})}else{c(f,g)}})}}()});a.fn.extend({tablesorterServerOnly:a.tablesorterServerOnly.construct})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:sortable-table-server-side', location = 'js/tasks-table-sortable.js' */
(function(a){var b=function(d){this.ajaxUrl=d.ajaxUrl;this.restUrlPagination=d.restUrlPagination;this.$wrapper=d.$wrapper;this.table=d.table;this.$table=a(this.table);this.analyticEventKey=d.analyticEventKey;this.sortColumnDefault=d.sortColumnDefault||"duedate";this.sortReverseSortDefault=d.sortReverseSortDefault||false;this.reportParametersDefault=d.reportParametersDefault;this.pageIndex=d.pageIndex||0;this.pageSize=d.pageSize||10;this.pageTotal=d.pageTotal||0;this.pageLimit=d.pageLimit||7;this.adaptive=d.adaptive;this.columns=d.columns;this.templates=d.templates;this.onRenderEmptyTable=d.onRenderEmptyTable;this.onBusySorting=d.onBusySorting};b.getColumnNameFromSortBy=function(e){var d={"due date":"duedate","page title":"location",assignee:"assignee"};return d[e]?d[e]:"duedate"};b.getSortByFromColumnName=function(d){var e={duedate:"due date",location:"page title"};return e[d]?e[d]:d};b.prototype.updateOptions=function(d){a.extend(this,d);this.$table=a(this.table)};b.prototype.getCurrentPageIndex=function(){var e=this.$wrapper.find(".macro-auto-pagination").last();var d=parseInt(e.attr("data-initial-page-index"),10);return isNaN(d)?0:d};b.prototype.renderPagination=function(e,g){var d=this;if(!e){e=d.$table}if(!g){g=d.reportParametersDefault}this.$wrapper.find(".macro-auto-pagination").remove();if(!(d.pageTotal>1)){return}c.UI.Components.Pagination.build({scope:e,pageSize:d.pageSize,totalPages:d.pageTotal,pageLimit:d.pageLimit,path:d.restUrlPagination,adaptive:d.adaptive,currentPage:d.pageIndex,data:{reportParameters:JSON.stringify(g)},success:function f(h,j){var k={task:h,columns:d.columns};var i=d.templates.tasksReportLine(k);j.append(i)}})};b.prototype.toggleBusyState=function(d){this.$wrapper.attr("data-loading",d);if(d){this.$wrapper.find(".task-blanket").show()}else{this.$wrapper.find(".task-blanket").hide()}if(typeof this.onBusySorting==="function"){this.onBusySorting.apply(this,[d])}};b.prototype.renderTable=function(e){var d=this;var f=_.map(e,function(g){return d.templates.tasksReportLine({task:g,columns:d.columns})}).join("");d.$table.find("tbody").html(f)};b.prototype._triggerAnalyticsSorting=function(){var d=this.analyticEventKey;var e={column:this.sortColumn,direction:this.reverseSort?"desc":"asc"};AJS.trigger("analyticsEvent",{name:d,data:e})};b.prototype._buildAjaxData=function(e){var d={url:this.ajaxUrl,cache:false,dataType:"json",data:{pageIndex:this.pageIndex,pageSize:this.pageSize,reportParameters:JSON.stringify(e)}};return d};b.prototype.init=function(){var d=this;d.sortColumn=d.sortColumnDefault;d.reverseSort=d.sortReverseSortDefault;this.$table.tablesorterServerOnly({sortColumn:d.sortColumn,reverseSort:d.reverseSort,onInit:function(){var e=a(this);e.addClass("aui-table-sortable")},onSort:function(i){var h=this,f=a(h);d.pageIndex=d.getCurrentPageIndex();d.sortColumn=i.sortColumn;d.reverseSort=i.reverseSort;d.toggleBusyState(true);var g=a.extend({},d.reportParametersDefault,{sortColumn:b.getSortByFromColumnName(d.sortColumn),reverseSort:d.reverseSort});var e=d._buildAjaxData(g);a.ajax(e).done(function(j){d.pageIndex=d.getCurrentPageIndex();d.pageTotal=j.totalPages;if(d.pageIndex===0&&d.pageTotal===0){if(typeof d.onRenderEmptyTable==="function"){d.$wrapper.find(".macro-auto-pagination").remove();f.remove();d.onRenderEmptyTable.apply(d)}return}d.renderTable(j.detailLines);d.renderPagination(null,g);f.trigger("refreshHeader.sortServerOnly");d._triggerAnalyticsSorting()}).fail(function(){var j=new c.InlineTasks.Notice({textMessage:"We can\'t sort your tasks right now. Refresh the page to try again.",className:"forbidden-notice"});j.show()}).always(function(){d.toggleBusyState(false)})}})};var c=window.Confluence||{};c.InlineTasks=c.InlineTasks||{};c.InlineTasks.TasksTableSortable=b})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:common', location = '/js/namespace.js' */
window.Confluence||(window.Confluence={});window.Confluence.UI||(window.Confluence.UI={});window.Confluence.UI.Components||(window.Confluence.UI.Components={});window.Confluence.UI.Components.Pagination||(window.Confluence.UI.Components.Pagination={});window.Confluence.UI.Components.SpacePagePicker||(window.Confluence.UI.Components.SpacePagePicker={});window.Confluence.UI.Components.PagePicker||(window.Confluence.UI.Components.PagePicker={});define("confluence-ui-components/js/page-picker",function(){return window.Confluence.UI.Components.PagePicker});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:common', location = '/js/internal/dark-features.js' */
define("confluence-ui-components/dark-features",["ajs"],function(a){return a.DarkFeatures});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:pagination', location = '/js/pagination.js' */
(function(e,c){var d=function(j,k,i){var h=j.find("a").attr("aria-disabled",i);if(i){h.attr("disabled","disabled")}else{h.removeAttr("disabled");var g=e(".aui-nav-selected",j).data("index")+1;j.find(".aui-nav-next > a").attr("aria-disabled",g==k);j.find(".aui-nav-previous > a").attr("aria-disabled",g==1)}};var b={scope:null,success:null,data:null,path:"",url:"#",pageLimit:7,currentPage:0,adaptive:false,totalPages:0,pageSize:0};var f=function(i,j,k){var g=Math.floor(k/2);var h=j-1;if(!k||j<=k||i-g<0){return 0}if(i+g>h){return j-k}return i-g};var a=function(l){var k=l.totalPages,j=l.currentPage,m=l.pageLimit,h=l.adaptive,g;if(m){if(h){k=j+m}g=m}else{g=k}var i=f(j,k,m);return Confluence.UI.Components.Pagination.Templates.paginationFooter({currentPage:j||0,startPage:i,itemsToRender:g,totalPages:k,pageSize:l.pageSize,url:l.url||"#"})};c.build=function(j){var h=_.extend({},b,j);if(typeof h.success!=="function"){h.success=function(){}}var k=a(h);h.scope.after(k);var i=h.scope.next();var g=i.data("initial-page-index");i.on("click","a",function(p){var o=e(this),r=o.parents("ol").prev(),n=r.is("table")?r:r.find("table");var l=n.data("pageIndex")||g,q=o.parent("li");if(q.hasClass("aui-nav-selected")||q.find("> a[aria-disabled=true]").length){return}if(q.hasClass("aui-nav-next")){l++}else{if(q.hasClass("aui-nav-previous")){l--}else{l=q.data("index")}}d(i,h.totalPages,true);var m=e.extend({},{pageSize:h.pageSize,pageIndex:l},h.data);e.getJSON(Confluence.getContextPath()+h.path,m).done(function(t){l=t.currentPage;var s=n.find("tbody");s.find("tr").remove();n.data("pageIndex",l);_.each(t.detailLines,function(v){h.success(v,s)});AJS.trigger("ui.components.pagination.updated",[t,h]);var u=e.extend({},h,{totalPages:t.totalPages,adaptive:t.adaptive,currentPage:l});i.html(a(u));d(i,u.totalPages,false)}).fail(function(){d(i,h.totalPages,false)});p.preventDefault()})}})(AJS.$,window.Confluence.UI.Components.Pagination);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:pagination', location = '/soy/pagination.soy' */
// This file was automatically generated from pagination.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.Pagination.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.Pagination == 'undefined') { Confluence.UI.Components.Pagination = {}; }
if (typeof Confluence.UI.Components.Pagination.Templates == 'undefined') { Confluence.UI.Components.Pagination.Templates = {}; }


Confluence.UI.Components.Pagination.Templates.paginationFooter = function(opt_data, opt_ignored) {
  var output = '<ol class="aui-nav aui-nav-pagination macro-auto-pagination" data-page-size="' + soy.$$escapeHtml(opt_data.pageSize) + '" data-initial-page-index="' + soy.$$escapeHtml(opt_data.currentPage) + '"><li class="aui-nav-previous"><a ' + ((opt_data.currentPage == 0) ? 'aria-disabled="true"' : 'href="#"') + '>' + soy.$$escapeHtml("Prev") + '</a></li>';
  var startIdx__soy16 = opt_data.startPage + 1;
  var currentIdx__soy17 = opt_data.currentPage + 1;
  var endIdx__soy18 = startIdx__soy16 + opt_data.itemsToRender;
  var totalRange__soy19 = opt_data.totalPages + 1;
  var indexInit20 = startIdx__soy16;
  var indexLimit20 = endIdx__soy18 < totalRange__soy19 ? endIdx__soy18 : totalRange__soy19;
  for (var index20 = indexInit20; index20 < indexLimit20; index20++) {
    output += (index20 == currentIdx__soy17) ? '<li class="aui-nav-selected" data-index="' + soy.$$escapeHtml(index20 - 1) + '">' + soy.$$escapeHtml(index20) + '</li>' : '<li data-index="' + soy.$$escapeHtml(index20 - 1) + '"><a href="#">' + soy.$$escapeHtml(index20) + '</a></li>';
  }
  output += '<li class="aui-nav-next"><a ' + ((currentIdx__soy17 == opt_data.totalPages) ? 'aria-disabled="true"' : 'href="' + soy.$$escapeHtml(opt_data.url) + '"') + '>' + soy.$$escapeHtml("Next") + '</a></li></ol>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.Pagination.Templates.paginationFooter.soyTemplateName = 'Confluence.UI.Components.Pagination.Templates.paginationFooter';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:blank-placeholder-box', location = 'soy/blank-placeholder-box.soy' */
// This file was automatically generated from blank-placeholder-box.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.BlankPlaceholderBox.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.BlankPlaceholderBox == 'undefined') { Confluence.UI.Components.BlankPlaceholderBox = {}; }
if (typeof Confluence.UI.Components.BlankPlaceholderBox.Templates == 'undefined') { Confluence.UI.Components.BlankPlaceholderBox.Templates = {}; }


Confluence.UI.Components.BlankPlaceholderBox.Templates.blankBox = function(opt_data, opt_ignored) {
  return '<div class="blank-placeholder-box ' + ((opt_data.customClass) ? soy.$$escapeHtml(opt_data.customClass) : '') + '"><div class="content"><h2>' + soy.$$escapeHtml(opt_data.blankTitle) + '</h2><p>' + soy.$$escapeHtml(opt_data.blankDescription) + '</p></div>' + ((opt_data.customHtml) ? soy.$$filterNoAutoescape(opt_data.customHtml) : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.BlankPlaceholderBox.Templates.blankBox.soyTemplateName = 'Confluence.UI.Components.BlankPlaceholderBox.Templates.blankBox';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:tasks-report-resources', location = 'templates/tasks-report.soy' */
// This file was automatically generated from tasks-report.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.InlineTasks.Report.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.InlineTasks == 'undefined') { Confluence.InlineTasks = {}; }
if (typeof Confluence.InlineTasks.Report == 'undefined') { Confluence.InlineTasks.Report = {}; }
if (typeof Confluence.InlineTasks.Report.Templates == 'undefined') { Confluence.InlineTasks.Report.Templates = {}; }


Confluence.InlineTasks.Report.Templates.tasksReport = function(opt_data, opt_ignored) {
  var output = '<div class="table-wrapper" data-loading="false"><div class="task-blanket"></div><input type="hidden" name="reportParameters" value="' + soy.$$escapeHtml(opt_data.reportParameters) + '" /><table class="aui aui-table-interactive tasks-report" data-sortable="false" data-total-pages="' + soy.$$escapeHtml(opt_data.totalPages) + '" data-page-size="' + soy.$$escapeHtml(opt_data.pageSize) + '" data-adaptive="' + soy.$$escapeHtml(opt_data.adaptive) + '" data-page-limit="' + soy.$$escapeHtml(opt_data.pageLimit) + '"><thead><tr class="tablesorter-headerRow">';
  var headingList14 = opt_data.headings;
  var headingListLen14 = headingList14.length;
  for (var headingIndex14 = 0; headingIndex14 < headingListLen14; headingIndex14++) {
    var headingData14 = headingList14[headingIndex14];
    output += '<th class="header-' + soy.$$escapeHtml(headingData14) + ((headingData14 == 'description') ? ' aui-table-column-unsortable' : '') + '" data-column-name="' + soy.$$escapeHtml(headingData14) + '">' + soy.$$escapeHtml(opt_data.headingTexts[headingData14]) + '</th>';
  }
  output += '</tr></thead><tbody>';
  if (opt_data.tasks.length) {
    var taskList29 = opt_data.tasks;
    var taskListLen29 = taskList29.length;
    for (var taskIndex29 = 0; taskIndex29 < taskListLen29; taskIndex29++) {
      var taskData29 = taskList29[taskIndex29];
      output += Confluence.InlineTasks.Report.Templates.tasksReportLine({task: taskData29, columns: opt_data.headings});
    }
  } else {
    output += '<tr><td colspan="' + soy.$$escapeHtml(opt_data.headings.length) + '">' + soy.$$escapeHtml("Create a task list in a Confluence page to keep track of things you need to do.") + '</td></tr>';
  }
  output += '</tbody></table></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.InlineTasks.Report.Templates.tasksReport.soyTemplateName = 'Confluence.InlineTasks.Report.Templates.tasksReport';
}


Confluence.InlineTasks.Report.Templates.tasksFeatureDiscoveryNotification = function(opt_data, opt_ignored) {
  return '<h2>' + soy.$$escapeHtml("Hey! Did you know...") + '</h2><p>' + soy.$$escapeHtml("You can view the tasks you created, or assigned to you, in the tasks tabs of your profile.") + '</p>';
};
if (goog.DEBUG) {
  Confluence.InlineTasks.Report.Templates.tasksFeatureDiscoveryNotification.soyTemplateName = 'Confluence.InlineTasks.Report.Templates.tasksFeatureDiscoveryNotification';
}


Confluence.InlineTasks.Report.Templates.tasksReportLine = function(opt_data, opt_ignored) {
  var output = '<tr data-task-id="' + soy.$$escapeHtml(opt_data.task.taskId) + '" aria-disabled="false">';
  var columnList51 = opt_data.columns;
  var columnListLen51 = columnList51.length;
  for (var columnIndex51 = 0; columnIndex51 < columnListLen51; columnIndex51++) {
    var columnData51 = columnList51[columnIndex51];
    if (columnData51 == 'duedate') {
      output += '<td class=\'tasks-report-date\'>' + ((opt_data.task.dueDate) ? soy.$$escapeHtml(opt_data.task.dueDate) : '') + '</td>';
    } else if (columnData51 == 'description') {
      output += '<td>' + soy.$$filterNoAutoescape(opt_data.task.taskHtml) + '</td>';
    } else if (columnData51 == 'assignee') {
      output += '<td class=\'tasks-report-assignee\'>' + ((opt_data.task.assigneeUserName) ? Confluence.Templates.User.usernameLink({username: opt_data.task.assigneeUserName, fullName: opt_data.task.assigneeFullName, canView: false}) : '') + '</td>';
    } else if (columnData51 == 'location') {
      output += '<td><a class=\'task-location\' href="' + soy.$$escapeHtml("") + soy.$$escapeHtml(opt_data.task.pageUrl) + '">' + soy.$$escapeHtml(opt_data.task.pageTitle) + '</a></td>';
    } else if (columnData51 == 'completedate') {
      output += '<td class=\'tasks-report-date\'>' + ((opt_data.task.completeDate) ? soy.$$escapeHtml(opt_data.task.completeDate) : (opt_data.task.taskCompleted) ? '<span class="emptycompletedate">--</span>' : '') + '</td>';
    } else if (columnData51 == 'labels') {
      output += '<td>';
      var labelList90 = opt_data.task.labels;
      var labelListLen90 = labelList90.length;
      for (var labelIndex90 = 0; labelIndex90 < labelListLen90; labelIndex90++) {
        var labelData90 = labelList90[labelIndex90];
        output += aui.labels.label({text: labelData90});
      }
      output += '</td>';
    }
  }
  output += '</tr>';
  return output;
};
if (goog.DEBUG) {
  Confluence.InlineTasks.Report.Templates.tasksReportLine.soyTemplateName = 'Confluence.InlineTasks.Report.Templates.tasksReportLine';
}


Confluence.InlineTasks.Report.Templates.taskReportBrowserWarning = function(opt_data, opt_ignored) {
  var param98 = '<p>' + soy.$$escapeHtml("Unable to show this task report.") + '</p>';
  var messageList102 = opt_data.messages;
  var messageListLen102 = messageList102.length;
  for (var messageIndex102 = 0; messageIndex102 < messageListLen102; messageIndex102++) {
    var messageData102 = messageList102[messageIndex102];
    param98 += '<p>' + soy.$$escapeHtml(messageData102) + '</p>';
  }
  var output = '' + aui.message.warning({content: param98});
  return output;
};
if (goog.DEBUG) {
  Confluence.InlineTasks.Report.Templates.taskReportBrowserWarning.soyTemplateName = 'Confluence.InlineTasks.Report.Templates.taskReportBrowserWarning';
}


Confluence.InlineTasks.Report.Templates.taskReportWarning = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '<p>' + soy.$$escapeHtml("Unable to show the task report. Edit this page to resolve the issues.") + '</p>'});
};
if (goog.DEBUG) {
  Confluence.InlineTasks.Report.Templates.taskReportWarning.soyTemplateName = 'Confluence.InlineTasks.Report.Templates.taskReportWarning';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:tasks-report-resources', location = 'js/tasks-report-blank-exp.js' */
(function(b){Confluence.InlineTasks=Confluence.InlineTasks||{};Confluence.InlineTasks.TasksReport=Confluence.InlineTasks.TasksReport||{};var a={"blank.complete.title":"Task report","blank.complete.desc":"Get going, no tasks completed yet.","blank.incomplete.title":"Task report","blank.incomplete.desc":"Looking good, no incomplete tasks."};Confluence.InlineTasks.TasksReport.renderBlankExperiences=function(g,c){if(!c){c="incomplete"}var f=a["blank."+c+".title"],e=a["blank."+c+".desc"];var d=Confluence.UI.Components.BlankPlaceholderBox.Templates.blankBox({blankTitle:f,blankDescription:e,customClass:c+" tasks-report-blank"});g.html(d)}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:tasks-report-resources', location = 'js/tasks-report.js' */
AJS.$(function(c){var b="/rest/inlinetasks/1/task-report/",a=Confluence.InlineTasks.Report.Templates,e=Confluence.InlineTasks.TasksTableSortable;var d=c(".tasks-report").parent();_.each(d,function(i){var l=c(i),n=l.find("table.tasks-report"),m=n.data("page-size"),k=n.data("total-pages"),f=n.data("page-limit"),q=n.data("adaptive"),p=l.find("input[name=reportParameters]").val(),g=JSON.parse(p);var o=function(r,s){c(r).attr("aria-disabled",s)};AJS.bind("inline-tasks.status-update.start",function(t,s){if(s.taskListQueue.length>0){var r=c("li[data-inline-task-id="+s.taskId+"]").closest(".tasks-report").siblings(".macro-auto-pagination");o(r,true);r=r.find("li a");r.on("click.taskreport.pagination",function(u){u.preventDefault();u.stopPropagation()})}});AJS.bind("inline-tasks.status-update.complete",function(s,r){if(r.taskListQueue.length===0){o(".macro-auto-pagination",false);c(".macro-auto-pagination li a").off("click.taskreport.pagination")}});var j=n.closest(".table-wrapper");var h=new e({$wrapper:j,table:n[0],sortReverseSortDefault:g.reverseSort,sortColumnDefault:e.getColumnNameFromSortBy(g.sortColumn),reportParametersDefault:g,pageIndex:0,pageSize:m,pageTotal:k,adaptive:q,pageLimit:f,templates:a,columns:g.columns,onRenderEmptyTable:function(){Confluence.InlineTasks.TasksReport.renderBlankExperiences(j,g.status)},analyticEventKey:"confluence-spaces.tasks.report.sorted",restUrlPagination:b,ajaxUrl:Confluence.getContextPath()+b});h.init();if(q||k>1){h.renderPagination()}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-help-tips:common', location = 'js/help-tip.js' */
(function(f){function b(){return false}function d(){return true}var l=0,g=new Date().getTime();var k=AJS.contextPath()+"/rest/helptips/1.0/tips";function h(n){n=""+(n||"");return n.replace(/\./g,"-")}function j(o,n){if(AJS.EventQueue&&n&&n.attributes.id){var q={};var p=h(n.attributes.id);q.name="helptips."+p+"."+o;q.properties={};AJS.EventQueue.push(q)}}function c(){return"c"+g+(l++)}var a={dismissedTipIds:[],loaded:f.Deferred(),url:function(){return k},sync:function(o,n){o||(o="get");n||(n=null);return f.ajax(this.url(),{type:o,context:this,dataType:"json",contentType:"application/json",data:n&&JSON.stringify(n),processData:false}).promise()},fetch:function(){var n=this.sync();n.done(function(o){f.merge(this.dismissedTipIds,o);this.loaded.resolve()});return n.promise()},show:function(n){this.loaded.done(n)},dismiss:function(n){var o=n.attributes.id;if(!o){n._dismissed=true}else{this.dismissedTipIds.push(o);this.sync("post",{id:o})}},undismiss:function(n){var o=n.attributes.id;if(!o){n._dismissed=false}else{this.dismissedTipIds.splice(f.inArray(o,this.dismissedTipIds),1);this.sync("delete",{id:o})}},isDismissed:function(n){var o=n.attributes.id;return(o)?f.inArray(o,this.dismissedTipIds)>=0:n._dismissed}};var e=AJS.HelpTip=function(n){var o;this.attributes=f.extend({},n);this.attributes.id||(this.attributes.id=false);if(this.attributes.body){this.attributes.bodyHtml=this.attributes.body;delete this.attributes.body}this.cid=c();o=this.attributes.anchor;delete this.attributes.anchor;this.view=o?new i(this,o):new m(this);this.view.$el.addClass("aui-help-tip")};AJS.HelpTip.Manager=a;f.extend(e.prototype,{show:function(){var n=this;AJS.HelpTip.Manager.show(function(){if(!n.isDismissed()){if(AJS.Popups&&AJS.Popups.DisplayController){AJS.Popups.DisplayController.request({name:n.id,weight:1000,show:function(){n.view.show()}})}else{n.view.show()}j("shown",n)}})},dismiss:function(){var n=h(arguments[0]||"programmatically");this.view.dismiss();if(!this.isDismissed()){AJS.HelpTip.Manager.dismiss(this);j("dismissed."+n,this)}},isVisible:function(){return this.view.$el.is(":visible")},isDismissed:function(){return AJS.HelpTip.Manager.isDismissed(this)}});var i=function(o,n){this.initialize(o,n)};f.extend(i.prototype,{initialize:function(r,q){var o=this;var s=q.prop("ownerDocument");var p=s!=window.document;if(p){var n=f("iframe").filter(function(){return this.contentDocument==s});n.contents().scroll(function(){var v=f(this).contents().find("body").scrollTop();var w=n.offset().top;var u=o.popup.data("offset-top");var t=o.popup.find(".arrow").height();o.popup.css("top",u-v);o.popup.toggle(v<=u-w-t&&v+n.height()-t+w-o.popup.height()>=u)})}this.model=r;this.beforeHide=b;this.dismissButton=f(AJS.Templates.HelpTip.tipDismiss());this.dismissButton.click(function(t){r.dismiss("close-button");t.preventDefault()});this.popup=AJS.InlineDialog(q,r.cid,function(v,u,t){v.html(AJS.Templates.HelpTip.tipContent(r.attributes));v.find(".helptip-body").after(o.dismissButton);v.unbind("mouseover mouseout");v.find(".helptip-link").click(function(){j("learn-more.clicked",r)});t()},{container:"body",noBind:true,preHideCallback:function(){return o.beforeHide()},calculatePositions:function(t,y,z,x){var w=AJS.InlineDialog.opts.calculatePositions(t,y,z,x);if(p){var v=t.find(".arrow").height();var u=n.contents().find("body").scrollTop();w.popupCss.top=n.offset().top+(q.offset().top-u)+q.height()+v;w.popupCss.left=q.offset().left;n.contents().scroll()}t.data("offset-top",w.popupCss.top);return w}});this.popup.refresh();this._popupHide=this.popup.hide;this.popup.hide=b;this.$el=f(this.popup[0]);AJS.$(document).bind("showLayer",function(v,u,t){if(u==="inlineDialog"&&t.id===r.cid){AJS.InlineDialog.current=null;AJS.$(document.body).unbind("click."+r.cid+".inline-dialog-check");t._validateClickToClose=b;t.hide=b}})},show:function(){var n=this.popup,o=function(p){if(!n.has(p.target).length){n.shadow.remove();n.remove()}};n.show()},dismiss:function(){this.beforeHide=d;this._popupHide()}});var m=function(n){this.initialize(n)};f.extend(m.prototype,{initialize:function(){this.$el=f("<div />")},show:f.noop,dismiss:f.noop});if(AJS.Meta.get("remote-user")){a.fetch()}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-help-tips:common', location = 'templates/help-tip.soy' */
// This file was automatically generated from help-tip.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace AJS.Templates.HelpTip.
 */

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Templates == 'undefined') { AJS.Templates = {}; }
if (typeof AJS.Templates.HelpTip == 'undefined') { AJS.Templates.HelpTip = {}; }


AJS.Templates.HelpTip.tipContent = function(opt_data, opt_ignored) {
  return ((opt_data.title) ? '<h4 class="helptip-title">' + soy.$$escapeHtml(opt_data.title) + '</h4>' : '') + '<div class="helptip-body">' + soy.$$filterNoAutoescape(opt_data.bodyHtml) + '</div>' + ((opt_data.url) ? '<a class="helptip-link" href="' + soy.$$escapeHtml(opt_data.url) + '" target="_blank">' + soy.$$escapeHtml("Learn more") + '</a>' : '');
};
if (goog.DEBUG) {
  AJS.Templates.HelpTip.tipContent.soyTemplateName = 'AJS.Templates.HelpTip.tipContent';
}


AJS.Templates.HelpTip.tipDismiss = function(opt_data, opt_ignored) {
  return '<button class="helptip-dismiss aui-button" type="button">' + soy.$$escapeHtml("Dismiss") + '</button>';
};
if (goog.DEBUG) {
  AJS.Templates.HelpTip.tipDismiss.soyTemplateName = 'AJS.Templates.HelpTip.tipDismiss';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:tasks-feature-discovery-resources', location = 'js/tasks-discovery.js' */
(function(d){var c="com.atlassian.confluence.plugins.confluence-jira-metadata";var b="inline-tasks-flag";function a(){if(!!AJS.HelpTip){var e={id:null,body:Confluence.InlineTasks.Report.Templates.tasksFeatureDiscoveryNotification(),anchor:d("#user-menu-link")};var f=new AJS.HelpTip(e);AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.feature.discovery.shown"});f.show();Confluence.FeatureDiscovery.forPlugin(c).markDiscovered(b)}}d(function(){if(d("meta[name=show-task-feature-discovery-flag]").length>0&&Confluence.FeatureDiscovery.forPlugin(c).shouldShow(b)){a()}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:plupload', location = 'js/plupload.js' */
(function(){function x(){this.returnValue=!1}function y(){this.cancelBubble=!0}var z=0,p=[],u={},v={},t={},w={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},A=/[<>&\"\']/g,q=window.setTimeout,m={},h,j="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/java-archive,jar,application/java-archive,war,application/java-archive,ear,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.template,xltx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,audio/mpeg,mpga mpega mp2 mp3,audio/mp3,mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/xml,xml,text/javascript,js,text/css,css,text/rtf,rtf,text/x-java-source,java,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,text/csv,csv,text/plain,asc txt text diff log,application/octet-stream,exe".split(/,/),
k,n,o;for(k=0;k<j.length;k+=2){o=j[k+1].split(/ /);for(n=0;n<o.length;n++){v[o[n]]=j[k];var r=t[j[k]]||[];r.push(o[n]);t[j[k]]=r}}j=navigator;k=j.userAgent;o=j.vendor;r=(n=/WebKit/.test(k))&&-1!==o.indexOf("Apple");o=window.opera&&window.opera.buildNumber;var j={windows:-1!==navigator.platform.indexOf("Win"),ie:!n&&!o&&/MSIE/gi.test(k)&&/Explorer/gi.test(j.appName),webkit:n,gecko:!n&&/Gecko/.test(k),safari:r,opera:!!o},c={VERSION:"@@version@@",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,
GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:v,mineTypeToExtensionsMap:t,ua:j,extend:function(a){c.each(arguments,function(b,g){0<g&&c.each(b,function(b,c){a[c]=b})});return a},getElement:function(a){return a&&1===a.nodeType?a:document.getElementById(a)},cleanName:function(a){var b,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,
"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);a=a.replace(/\s+/g,"_");return a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(a,b){b.name=a;p[a]=b;p.push(b);return b},guid:function(){var a=(new Date).getTime().toString(32),b;for(b=0;5>b;b++)a+=Math.floor(65535*Math.random()).toString(32);return(c.guidPrefix||
"p")+a+(z++).toString(32)},buildUrl:function(a,b){var g="";c.each(b,function(a,b){g+=(g?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)});g&&(a+=(0<a.indexOf("?")?"&":"?")+g);return a},each:function(a,b){var c,f;if(a)if(c=a.length,void 0===c)for(f in a){if(a.hasOwnProperty(f)&&!1===b(a[f],f))break}else for(f=0;f<c&&!1!==b(a[f],f);f++);},formatSize:function(a){return void 0===a||/\D/.test(a)?c.translate("N/A"):1073741824<a?Math.round(a/1073741824,1)+" GB":1048576<a?Math.round(a/1048576,1)+
" MB":1024<a?Math.round(a/1024,1)+" KB":a+" b"},getPos:function(a,b){function c(a){var b,e=0;b=0;a&&(b=a.getBoundingClientRect(),a="CSS1Compat"===h.compatMode?h.documentElement:h.body,e=b.left+a.scrollLeft,b=b.top+a.scrollTop);return{x:e,y:b}}var f=0,d=0,e,h=document,b=b||h.body;if(a&&a.getBoundingClientRect&&0<navigator.userAgent.indexOf("MSIE")&&8!==h.documentMode)return f=c(a),d=c(b),{x:f.x-d.x,y:f.y-d.y};for(e=a;e&&e!=b&&e.nodeType;)f+=e.offsetLeft||0,d+=e.offsetTop||0,e=e.offsetParent;for(e=
a.parentNode;e&&e!=b&&e.nodeType;)f-=e.scrollLeft||0,d-=e.scrollTop||0,e=e.parentNode;return{x:f,y:d}},getSize:function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}},parseSize:function(a){var b;"string"==typeof a&&(a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),b=a[2],a=+a[1],"g"==b&&(a*=1073741824),"m"==b&&(a*=1048576),"k"==b&&(a*=1024));return a},xmlEncode:function(a){return a?(""+a).replace(A,function(a){return w[a]?"&"+w[a]+";":a}):a},toArray:function(a){var b,
c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},addI18n:function(a){return c.extend(u,a)},translate:function(a){return u[a]||a},isEmptyObj:function(a){if(void 0===a)return!0;for(var b in a)return!1;return!0},hasClass:function(a,b){return""==a.className?!1:RegExp("(^|\\s+)"+b+"(\\s+|$)").test(a.className)},addClass:function(a,b){c.hasClass(a,b)||(a.className=""==a.className?b:a.className.replace(/\s+$/,"")+" "+b)},removeClass:function(a,b){a.className=a.className.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)"),
function(a,b,c){return" "===b&&" "===c?" ":""})},getStyle:function(a,b){if(a.currentStyle)return a.currentStyle[b];if(window.getComputedStyle)return window.getComputedStyle(a,null)[b]},addEvent:function(a,b,g,f){var d,b=b.toLowerCase();void 0===h&&(h="Plupload_"+c.guid());a.addEventListener?(d=g,a.addEventListener(b,d,!1)):a.attachEvent&&(d=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=x;a.stopPropagation=y;g(a)},a.attachEvent("on"+b,d));void 0===a[h]&&(a[h]=c.guid());
m.hasOwnProperty(a[h])||(m[a[h]]={});a=m[a[h]];a.hasOwnProperty(b)||(a[b]=[]);a[b].push({func:d,orig:g,key:f})},removeEvent:function(a,b,g){var f,d;"function"==typeof g?f=g:d=g;b=b.toLowerCase();if(a[h]&&m[a[h]]&&m[a[h]][b]){for(var g=m[a[h]][b],e=g.length-1;0<=e;e--)if(g[e].key===d||g[e].orig===f)if(a.detachEvent?a.detachEvent("on"+b,g[e].func):a.removeEventListener&&a.removeEventListener(b,g[e].func,!1),g[e].orig=null,g[e].func=null,g.splice(e,1),void 0!==f)break;g.length||delete m[a[h]][b];if(c.isEmptyObj(m[a[h]])){delete m[a[h]];
try{delete a[h]}catch(k){a[h]=void 0}}}},removeAllEvents:function(a,b){void 0!==a[h]&&a[h]&&c.each(m[a[h]],function(g,f){c.removeEvent(a,f,b)})},Uploader:function(a){function b(){var a,b=0,d;if(this.state==c.STARTED){for(d=0;d<e.length;d++)!a&&e[d].status==c.QUEUED?(a=e[d],a.status=c.UPLOADING,this.trigger("BeforeUpload",a)&&this.trigger("UploadFile",a)):b++;b==e.length&&(this.stop(),this.trigger("UploadComplete",e))}}function g(){var a,b;d.reset();for(a=0;a<e.length;a++)b=e[a],void 0!==b.size?(d.size+=
b.size,d.loaded+=b.loaded):d.size=void 0,b.status==c.DONE?d.uploaded++:b.status==c.FAILED?d.failed++:d.queued++;void 0===d.size?d.percent=0<e.length?Math.ceil(100*(d.uploaded/e.length)):0:(d.bytesPerSec=Math.ceil(d.loaded/((+new Date-h||1)/1E3)),d.percent=0<d.size?Math.ceil(100*(d.loaded/d.size)):0)}var f={},d,e=[],h;d=new c.QueueProgress;a=c.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},a);c.extend(this,{state:c.STOPPED,runtime:"",features:{},files:e,settings:a,
total:d,id:c.guid(),init:function(){function f(){var a=s[k++],b,e,d;if(a){b=a.getFeatures();if(e=i.settings.required_features){e=e.split(",");for(d=0;d<e.length;d++)if(!b[e[d]]){f();return}}a.init(i,function(c){c&&c.success?(i.features=b,i.runtime=a.name,i.trigger("Init",{runtime:a.name}),i.trigger("PostInit"),i.refresh()):f()})}else i.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}var i=this,l,s,k=0,j;"function"==typeof a.preinit?a.preinit(i):c.each(a.preinit,function(a,
b){i.bind(b,a)});a.page_url=a.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");/^(\w+:\/\/|\/)/.test(a.url)||(a.url=a.page_url+a.url);a.chunk_size=c.parseSize(a.chunk_size);a.max_file_size=c.parseSize(a.max_file_size);i.bind("FilesAdded",function(b,d){b.trigger("Started",d);var f,g,l=0,h;if((f=a.filters)&&f.length){h=[];c.each(f,function(a){c.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?h.push("\\.*"):h.push("\\."+a.replace(RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,
"\\$&")+"]","g"),"\\$&"))})});h=RegExp(h.join("|")+"$","i")}for(f=0;f<d.length;f++){g=d[f];g.loaded=0;g.percent=0;g.status=c.QUEUED;if(h&&!h.test(g.name))b.trigger("Error",{code:c.FILE_EXTENSION_ERROR,message:c.translate("File extension error."),file:g});else if(g.size!==void 0&&g.size>a.max_file_size)b.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:g});else{e.push(g);l++}}if(l)q(function(){i.trigger("QueueChanged");i.refresh()},1);else return false});a.unique_names&&
i.bind("UploadFile",function(a,b){var c=b.name.match(/\.([^.]+)$/),d="tmp";c&&(d=c[1]);b.target_name=b.id+"."+d});i.bind("UploadProgress",function(a,b){b.percent=b.size>0?Math.ceil(b.loaded/b.size*100):100;g()});i.bind("StateChanged",function(a){if(a.state==c.STARTED)h=+new Date;else if(a.state==c.STOPPED)for(l=a.files.length-1;l>=0;l--)if(a.files[l].status==c.UPLOADING){a.files[l].status=c.QUEUED;g()}});i.bind("QueueChanged",g);i.bind("Error",function(a,e){if(e.file){e.file.status=c.FAILED;g();a.state==
c.STARTED&&(d.queued||q(function(){b.call(i)},1))}});i.bind("FileUploaded",function(a,d){d.status=c.DONE;d.loaded=d.size;a.trigger("UploadProgress",d);q(function(){b.call(i)},1)});if(a.runtimes){s=[];j=a.runtimes.split(/\s?,\s?/);for(l=0;l<j.length;l++)p[j[l]]&&s.push(p[j[l]])}else s=p;f();"function"==typeof a.init?a.init(i):c.each(a.init,function(a,b){i.bind(b,a)})},refresh:function(){this.trigger("Refresh")},start:function(){this.state!=c.STARTED&&(this.state=c.STARTED,this.trigger("StateChanged"),
b.call(this))},stop:function(){this.state!=c.STOPPED&&(this.state=c.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},getFile:function(a){var b;for(b=e.length-1;0<=b;b--)if(e[b].id===a)return e[b]},removeFile:function(a){var b;for(b=e.length-1;0<=b;b--)if(e[b].id===a.id)return this.splice(b,1)[0]},splice:function(a,b){var f;f=e.splice(void 0===a?0:a,void 0===b?e.length:b);this.trigger("FilesRemoved",f);this.trigger("QueueChanged");f[0].status==c.UPLOADING&&this.state==c.STARTED&&
this.trigger("CancelUpload");if(!d.queued){var g=this;q(function(){g.trigger("UploadComplete")})}return f},trigger:function(a){var b=f[a.toLowerCase()],c,d;if(b){d=Array.prototype.slice.call(arguments);d[0]=this;for(c=0;c<b.length;c++)if(!1===b[c].func.apply(b[c].scope,d))return!1}return!0},hasEventListener:function(a){return!!f[a.toLowerCase()]},bind:function(a,b,c){var d,a=a.toLowerCase();d=f[a]||[];d.push({func:b,scope:c||this});f[a]=d},unbind:function(a,b){var a=a.toLowerCase(),c=f[a],d;if(c){if(void 0!==
b)for(d=c.length-1;0<=d;d--){if(c[d].func===b){c.splice(d,1);break}}else c=[];c.length||delete f[a]}},unbindAll:function(){var a=this;c.each(f,function(b,c){a.unbind(c)})},destroy:function(){this.trigger("Destroy");this.unbindAll()}})},File:function(a,b,c){this.id=a;this.name=b;this.size=c;this.status=this.percent=this.loaded=0},Runtime:function(){this.getFeatures=function(){};this.init=function(){}},QueueProgress:function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=
0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}},runtimes:{}};window.plupload=c})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:plupload', location = 'js/plupload.html5.js' */
(function(s,j,e,p){function G(e,f,k,g){var b,a,c,q,m=this;var d=y[e.id],r=function(d){b=j.createElement("canvas");b.style.display="none";j.body.appendChild(b);a=b.getContext("2d");c=new Image;c.onerror=c.onabort=function(){g({success:!1})};c.onload=function(){var r,t,j,o;f.width||(f.width=c.width);f.height||(f.height=c.height);q=Math.min(f.width/c.width,f.height/c.height);if(1>q||1===q&&"image/jpeg"===k){r=Math.round(c.width*q);t=Math.round(c.height*q);b.width=r;b.height=t;a.drawImage(c,0,0,r,t);
if("image/jpeg"===k){if(j=new w(atob(d.substring(d.indexOf("base64,")+7))),j.headers&&j.headers.length&&(o=new H,o.init(j.get("exif")[0])&&(o.setExif("PixelXDimension",r),o.setExif("PixelYDimension",t),j.set("exif",o.getBinary()),m.hasEventListener("ExifData")&&m.trigger("ExifData",e,o.EXIF()),m.hasEventListener("GpsData")&&m.trigger("GpsData",e,o.GPS()))),f.quality)try{d=b.toDataURL(k,f.quality/100)}catch(s){d=b.toDataURL(k)}}else d=b.toDataURL(k);d=d.substring(d.indexOf("base64,")+7);d=atob(d);
j&&(j.headers&&j.headers.length)&&(d=j.restore(d),j.purge());b.parentNode.removeChild(b);g({success:!0,data:d})}else g({success:!1})};c.src=d},t;"FileReader"in s?(t=new FileReader,t.readAsDataURL(d),t.onload=function(){r(t.result)}):r(d.getAsDataURL())}function C(){function e(b,a){var c=k?0:-8*(a-1),q=0,m;for(m=0;m<a;m++)q|=g.charCodeAt(b+m)<<Math.abs(c+8*m);return q}function f(b,a,c){c=3===arguments.length?c:g.length-a-1;g=g.substr(0,a)+b+g.substr(c+a)}var k=!1,g;return{II:function(b){if(b===p)return k;
k=b},init:function(b){k=!1;g=b},SEGMENT:function(b,a,c){switch(arguments.length){case 1:return g.substr(b,g.length-b-1);case 2:return g.substr(b,a);case 3:f(c,b,a);break;default:return g}},BYTE:function(b){return e(b,1)},SHORT:function(b){return e(b,2)},LONG:function(b,a){if(a===p)return e(b,4);var c="",q=k?0:-24,m;for(m=0;4>m;m++)c+=String.fromCharCode(a>>Math.abs(q+8*m)&255);f(c,b,4)},SLONG:function(b){b=e(b,4);return 2147483647<b?b-4294967296:b},STRING:function(b,a){for(var c="",a=a+b;b<a;b++)c+=
String.fromCharCode(e(b,1));return c}}}function w(e){var f={65505:{app:"EXIF",name:"APP1",signature:"Exif\x00"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\x00"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\x00"}},k=[],g,b,a=p,c=0;g=new C;g.init(e);if(65496===g.SHORT(0)){b=2;for(e=Math.min(1048576,e.length);b<=e;)if(a=g.SHORT(b),65488<=a&&65495>=a)b+=2;else{if(65498===a||65497===a)break;c=g.SHORT(b+2)+2;f[a]&&g.STRING(b+4,f[a].signature.length)===f[a].signature&&k.push({hex:a,app:f[a].app.toUpperCase(),
name:f[a].name.toUpperCase(),start:b,length:c,segment:g.SEGMENT(b,c)});b+=c}g.init(null);return{headers:k,restore:function(a){g.init(a);var c=new w(a);if(!c.headers)return!1;for(a=c.headers.length;0<a;a--){var d=c.headers[a-1];g.SEGMENT(d.start,d.length,"")}c.purge();b=65504==g.SHORT(2)?4+g.SHORT(4):2;a=0;for(c=k.length;a<c;a++)g.SEGMENT(b,0,k[a].segment),b+=k[a].length;return g.SEGMENT()},get:function(a){for(var c=[],d=0,b=k.length;d<b;d++)k[d].app===a.toUpperCase()&&c.push(k[d].segment);return c},
set:function(a,c){var d=[];"string"===typeof c?d.push(c):d=c;for(var b=ii=0,e=k.length;b<e&&!(k[b].app===a.toUpperCase()&&(k[b].segment=d[ii],k[b].length=d[ii].length,ii++),ii>=d.length);b++);},purge:function(){k=[];g.init(null)}}}}function H(){function e(a,c){var q=f.SHORT(a),m,d,k,h,l,j=[],n={};for(m=0;m<q;m++)if(l=a+12*m+2,k=c[f.SHORT(l)],k!==p){d=f.SHORT(l+=2);h=f.LONG(l+=2);l+=4;j=[];switch(d){case 1:case 7:4<h&&(l=f.LONG(l)+g.tiffHeader);for(d=0;d<h;d++)j[d]=f.BYTE(l+d);break;case 2:4<h&&(l=
f.LONG(l)+g.tiffHeader);n[k]=f.STRING(l,h-1);continue;case 3:2<h&&(l=f.LONG(l)+g.tiffHeader);for(d=0;d<h;d++)j[d]=f.SHORT(l+2*d);break;case 4:1<h&&(l=f.LONG(l)+g.tiffHeader);for(d=0;d<h;d++)j[d]=f.LONG(l+4*d);break;case 5:l=f.LONG(l)+g.tiffHeader;for(d=0;d<h;d++)j[d]=f.LONG(l+4*d)/f.LONG(l+4*d+4);break;case 9:l=f.LONG(l)+g.tiffHeader;for(d=0;d<h;d++)j[d]=f.SLONG(l+4*d);break;case 10:l=f.LONG(l)+g.tiffHeader;for(d=0;d<h;d++)j[d]=f.SLONG(l+4*d)/f.SLONG(l+4*d+4);break;default:continue}h=1==h?j[0]:j;
n[k]=b.hasOwnProperty(k)&&"object"!=typeof h?b[k][h]:h}return n}var f,k,g={},b;f=new C;k={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",
41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{"0":"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};b={ColorSpace:{1:"sRGB","0":"Uncalibrated"},MeteringMode:{"0":"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",
13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{"0":"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",
16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",
79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{"0":"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{"0":"Auto white balance",1:"Manual white balance"},SceneCaptureType:{"0":"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},
Contrast:{"0":"Normal",1:"Soft",2:"Hard"},Saturation:{"0":"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{"0":"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};return{init:function(a){g={tiffHeader:10};if(a===p||!a.length)return!1;f.init(a);return 65505===f.SHORT(0)&&"EXIF\x00"===f.STRING(4,5).toUpperCase()?(a=p,a=g.tiffHeader,f.II(18761==f.SHORT(a)),42!==f.SHORT(a+=2)?a=!1:(g.IFD0=g.tiffHeader+f.LONG(a+
2),a=e(g.IFD0,k.tiff),g.exifIFD="ExifIFDPointer"in a?g.tiffHeader+a.ExifIFDPointer:p,g.gpsIFD="GPSInfoIFDPointer"in a?g.tiffHeader+a.GPSInfoIFDPointer:p,a=!0),a):!1},EXIF:function(){var a;a=e(g.exifIFD,k.exif);a.ExifVersion&&(a.ExifVersion=String.fromCharCode(a.ExifVersion[0],a.ExifVersion[1],a.ExifVersion[2],a.ExifVersion[3]));return a},GPS:function(){var a;a=e(g.gpsIFD,k.gps);a.GPSVersionID&&(a.GPSVersionID=a.GPSVersionID.join("."));return a},setExif:function(a,c){if("PixelXDimension"!==a&&"PixelYDimension"!==
a)return!1;var b;b=a;var e,d,h,j=0;if("string"===typeof b)for(hex in e=k.exif,e)if(e[hex]===b){b=hex;break}e=g.exifIFD;d=f.SHORT(e);for(i=0;i<d;i++)if(h=e+12*i+2,f.SHORT(h)==b){j=h+8;break}j?(f.LONG(j,c),b=!0):b=!1;return b},getBinary:function(){return f.SEGMENT()}}}var y={},F;e.runtimes.Html5=e.addRuntime("html5",{getFeatures:function(){var h,f,k,g,b,a;f=k=b=a=!1;s.XMLHttpRequest&&(h=new XMLHttpRequest,k=!!h.upload,f=!(!h.sendAsBinary&&!h.upload));f&&(g=!!(h.sendAsBinary||s.Uint8Array&&s.ArrayBuffer),
b=!(!File||!File.prototype.getAsDataURL&&!s.FileReader||!g),a=!(!File||!File.prototype.mozSlice&&!File.prototype.webkitSlice&&!File.prototype.slice));F=e.ua.safari&&e.ua.windows&&navigator.userAgent&&0<navigator.userAgent.indexOf("Version/4");h=f;f=j.createElement("div");return{html5:h,dragdrop:"draggable"in f||"ondragstart"in f&&"ondrop"in f,jpgresize:b,pngresize:b,multipart:b||!!s.FileReader||!!s.FormData,canSendBinary:g,cantSendBlobInFormData:!(!e.ua.gecko||!s.FormData||!s.FileReader||FileReader.prototype.readAsArrayBuffer),
progress:k,chunks:a,multi_selection:!(e.ua.safari&&e.ua.windows),triggerDialog:e.ua.gecko&&s.FormData||e.ua.webkit||e.ua.windows}},init:function(h,f){function k(a){var c,b,g=[],d,f={};for(b=0;b<a.length;b++)c=a[b],f[c.name]||(f[c.name]=!0,d=e.guid(),y[d]=c,d=new e.File(d,c.fileName||c.name,c.fileSize||c.size),d.nativeFile=c,g.push(d));g.length&&h.trigger("FilesAdded",g)}var g,b;g=this.getFeatures();g.html5?(h.upload=function(a){k(a)},h.bind("Init",function(a){var c,b,g=[],d,f,t=a.settings.filters,
l,s;d=j.body;var n;c=j.createElement("div");c.id=a.id+"_html5_container";e.extend(c.style,{position:"absolute",background:h.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:h.settings.shim_bgcolor?"":0});c.className="plupload html5";h.settings.container&&(d=j.getElementById(h.settings.container),"static"===e.getStyle(d,"position")&&(d.style.position="relative"));d.appendChild(c);d=0;a:for(;d<t.length;d++){l=t[d].extensions.split(/,/);for(f=0;f<
l.length;f++){if("*"===l[f]){g=[];break a}(s=e.mimeTypes[l[f]])&&g.push(s)}}c.innerHTML='<input id="'+h.id+'_html5"  style="font-size:999px" type="file" accept="'+g.join(",")+'" '+(h.settings.multi_selection&&h.features.multi_selection?'multiple="multiple"':"")+" />";c.scrollTop=100;n=j.getElementById(h.id+"_html5");h.settings.inputFileClazz&&(n.className+=" "+h.settings.inputFileClazz);a.features.triggerDialog?e.extend(n.style,{position:"absolute",width:"100%",height:"100%"}):e.extend(n.style,{cssFloat:"right",
styleFloat:"right"});var p=function(){k(this.files);if(navigator.appVersion.indexOf("MSIE10")===-1){n=this.cloneNode(true);n.onchange=p;this.parentNode.replaceChild(n,this)}else this.value=""};n.onchange=p;if(b="string"===typeof a.settings.browse_button?j.getElementById(a.settings.browse_button):a.settings.browse_button){var o=a.settings.browse_button_hover,B=a.settings.browse_button_active;c=a.features.triggerDialog?b:c;o&&(e.addEvent(c,"mouseover",function(){e.addClass(b,o)},a.id),e.addEvent(c,
"mouseout",function(){e.removeClass(b,o)},a.id));B&&(e.addEvent(c,"mousedown",function(){e.addClass(b,B)},a.id),e.addEvent(j.body,"mouseup",function(){e.removeClass(b,B)},a.id));a.features.triggerDialog&&e.addEvent(b,"click",function(c){j.getElementById(a.id+"_html5").click();c.preventDefault()},a.id)}}),h.bind("PostInit",function(){var a=e.getElement(h.settings.drop_element),c,b=!1;a&&(F?(e.addEvent(a,"dragenter",function(){var c,d;c=j.getElementById(h.id+"_drop");c||(c=j.createElement("input"),
c.setAttribute("type","file"),c.setAttribute("id",h.id+"_drop"),c.setAttribute("multiple","multiple"),e.addEvent(c,"change",function(){k(this.files);e.removeEvent(c,"change",h.id);c.parentNode.removeChild(c)},h.id),a.appendChild(c),b=!0);e.getPos(a,j.getElementById(h.settings.container));d=e.getSize(a);"static"===e.getStyle(a,"position")&&e.extend(a.style,{position:"relative"});e.extend(c.style,{position:"absolute",display:"block",top:0,left:0,width:d.w+"px",height:d.h+"px",opacity:0})},h.id),e.addEvent(a,
"dragleave",function(){b||(c&&c.parentElement.removeChild(c),c=null);b=!1})):(e.addEvent(a,"dragover",function(a){a.preventDefault()},h.id),e.addEvent(a,"drop",function(a){if(!$(".disable-attachment-uploader").length){var b=a.dataTransfer;b&&b.files&&k(b.files)}c&&c.parentElement.removeChild(c);c=null;a.preventDefault();h.settings.stop_propagation&&(a.cancelBubble?a.cancelBubble=!0:a.stopPropagation())},h.id)))}),h.bind("Refresh",function(a){var c,b,f;if(c=j.getElementById(h.settings.browse_button))b=
e.getPos(c,j.getElementById(a.settings.container)),f=e.getSize(c),a=j.getElementById(h.id+"_html5_container"),e.extend(a.style,{top:b.y+"px",left:b.x+"px",width:f.w+"px",height:f.h+"px"}),h.features.triggerDialog&&("static"===e.getStyle(c,"position")&&e.extend(c.style,{position:"relative"}),b=parseInt(e.getStyle(c,"z-index"),10),isNaN(b)&&(b=0),e.extend(c.style,{zIndex:b}),e.extend(a.style,{zIndex:b-1}))}),h.bind("CancelUpload",function(){b&&b.abort&&b.abort()}),h.bind("UploadFile",function(a,c){function f(d){function k(){function f(d){var h=
0,m="----pluploadboundary"+e.guid(),n,r="";b=new XMLHttpRequest;b.upload&&(b.upload.onprogress=function(b){c.loaded=Math.min(c.size,q+b.loaded-h);a.trigger("UploadProgress",c)});b.onreadystatechange=function(){var f,g;if(b.readyState==4){try{f=b.status}catch(h){f=0}if(f>=400)a.trigger("Error",{code:e.HTTP_ERROR,message:e.translate("HTTP Error."),file:c,status:f,response:b.responseText||""});else{if(p){g={chunk:j,chunks:p,response:b.responseText,status:f};a.trigger("ChunkUploaded",c,g);q=q+z;if(g.cancelled){c.status=
e.FAILED;return}c.loaded=Math.min(c.size,(j+1)*u)}else c.loaded=c.size;a.trigger("UploadProgress",c);d=o=n=r=null;if(!p||++j>=p){c.status=e.DONE;a.trigger("FileUploaded",c,{response:b.responseText,status:f})}else k()}}};if(a.settings.multipart&&g.multipart){x.name=c.target_name||c.name;b.open("post",D,!0);e.each(a.settings.headers,function(a,c){b.setRequestHeader(c,a)});if("string"!==typeof d&&s.FormData){n=new FormData;e.each(e.extend(x,a.settings.multipart_params),function(a,b){n.append(b,a)});
n.append(a.settings.file_data_name,d);b.send(n);return}if("string"===typeof d){b.setRequestHeader("Content-Type","multipart/form-data; boundary="+m);e.each(e.extend(x,a.settings.multipart_params),function(a,b){r=r+("--"+m+'\r\nContent-Disposition: form-data; name="'+b+'"\r\n\r\n');r=r+(unescape(encodeURIComponent(a))+"\r\n")});y=e.mimeTypes[c.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";r+="--"+m+'\r\nContent-Disposition: form-data; name="'+a.settings.file_data_name+
'"; filename="'+unescape(encodeURIComponent(c.name))+'"\r\nContent-Type: '+y+"\r\n\r\n"+d+"\r\n--"+m+"--\r\n";h=r.length-d.length;d=r;if(b.sendAsBinary)b.sendAsBinary(d);else if(g.canSendBinary){for(var w=new Uint8Array(d.length),v=0;v<d.length;v++)w[v]=d.charCodeAt(v)&255;b.send(w.buffer)}return}}D=e.buildUrl(a.settings.url,e.extend(x,a.settings.multipart_params));b.open("post",D,!0);b.setRequestHeader("Content-Type","application/octet-stream");d.encoding&&b.setRequestHeader("Content-Encoding",d.encoding);
e.each(a.settings.headers,function(a,c){b.setRequestHeader(c,a)});b.send(d.getData?d.getData():d)}var o,p,x,u,z,y,D=a.settings.url;if(!(c.status==e.DONE||c.status==e.FAILED||a.state==e.STOPPED)){x={name:c.target_name||c.name};if(h.chunk_size&&c.size>h.chunk_size&&(g.chunks||"string"==typeof d)){u=h.chunk_size;p=Math.ceil(c.size/u);z=Math.min(u,c.size-j*u);if("string"==typeof d)o=d.substring(j*u,j*u+z);else{var v=d,A=j*u,E=j*u+z,w;if(File.prototype.slice)try{v.slice(),o=v.slice(A,E)}catch(C){o=v.slice(A,
E-A)}else o=(w=File.prototype.webkitSlice||File.prototype.mozSlice)?w.call(v,A,E):null}x.chunk=j;x.chunks=p}else z=c.size,o=d;"string"!==typeof o&&n&&g.cantSendBlobInFormData&&g.chunks&&a.settings.chunk_size?(n.onload=function(){f(n.result)},n.readAsBinaryString(o)):f(o)}}var j=0,q=0,n="FileReader"in s?new FileReader:null;k()}var h=a.settings,d;d=y[c.id];g.jpgresize&&a.settings.resize&&/\.(png|jpg|jpeg)$/i.test(c.name)?G.call(a,c,a.settings.resize,/\.png$/i.test(c.name)?"image/png":"image/jpeg",function(a){a.success?
(c.size=a.data.length,f(a.data)):f(d)}):f(d)}),h.bind("Destroy",function(a){var b,f,g=j.body,d={inputContainer:a.id+"_html5_container",inputFile:a.id+"_html5",browseButton:a.settings.browse_button,dropElm:a.settings.drop_element};for(b in d)(f=j.getElementById(d[b]))&&e.removeAllEvents(f,a.id);e.removeAllEvents(j.body,a.id);a.settings.container&&(g=j.getElementById(a.settings.container));g.removeChild(j.getElementById(d.inputContainer))}),f({success:!0})):f({success:!1})}})})(window,document,plupload);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-position', location = 'js-vendor/jquery/jquery-ui/jquery.ui.position.js' */
/*
 * jQuery UI Position 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 *
 * MODIFIED BY ATLASSIAN (fraction support detection removed)
 */
(function(G,H){G.ui=G.ui||{};var D=/left|center|right/,E=/top|center|bottom/,A="center",F={},B=G.fn.position,C=G.fn.offset;G.fn.position=function(J){if(!J||!J.of){return B.apply(this,arguments)}J=G.extend({},J);var N=G(J.of),M=N[0],P=(J.collision||"flip").split(" "),O=J.offset?J.offset.split(" "):[0,0],L,I,K;if(M.nodeType===9){L=N.width();I=N.height();K={top:0,left:0}}else{if(M.setTimeout){L=N.width();I=N.height();K={top:N.scrollTop(),left:N.scrollLeft()}}else{if(M.preventDefault){J.at="left top";L=I=0;K={top:J.of.pageY,left:J.of.pageX}}else{L=N.outerWidth();I=N.outerHeight();K=N.offset()}}}G.each(["my","at"],function(){var Q=(J[this]||"").split(" ");if(Q.length===1){Q=D.test(Q[0])?Q.concat([A]):E.test(Q[0])?[A].concat(Q):[A,A]}Q[0]=D.test(Q[0])?Q[0]:A;Q[1]=E.test(Q[1])?Q[1]:A;J[this]=Q});if(P.length===1){P[1]=P[0]}O[0]=parseInt(O[0],10)||0;if(O.length===1){O[1]=O[0]}O[1]=parseInt(O[1],10)||0;if(J.at[0]==="right"){K.left+=L}else{if(J.at[0]===A){K.left+=L/2}}if(J.at[1]==="bottom"){K.top+=I}else{if(J.at[1]===A){K.top+=I/2}}K.left+=O[0];K.top+=O[1];return this.each(function(){var T=G(this),V=T.outerWidth(),S=T.outerHeight(),U=parseInt(G.curCSS(this,"marginLeft",true))||0,R=parseInt(G.curCSS(this,"marginTop",true))||0,X=V+U+(parseInt(G.curCSS(this,"marginRight",true))||0),Y=S+R+(parseInt(G.curCSS(this,"marginBottom",true))||0),W=G.extend({},K),Q;if(J.my[0]==="right"){W.left-=V}else{if(J.my[0]===A){W.left-=V/2}}if(J.my[1]==="bottom"){W.top-=S}else{if(J.my[1]===A){W.top-=S/2}}Q={left:W.left-U,top:W.top-R};G.each(["left","top"],function(a,Z){if(G.ui.position[P[a]]){G.ui.position[P[a]][Z](W,{targetWidth:L,targetHeight:I,elemWidth:V,elemHeight:S,collisionPosition:Q,collisionWidth:X,collisionHeight:Y,offset:O,my:J.my,at:J.at})}});if(G.fn.bgiframe){T.bgiframe()}T.offset(G.extend(W,{using:J.using}))})};G.ui.position={fit:{left:function(I,J){var L=G(window),K=J.collisionPosition.left+J.collisionWidth-L.width()-L.scrollLeft();I.left=K>0?I.left-K:Math.max(I.left-J.collisionPosition.left,I.left)},top:function(I,J){var L=G(window),K=J.collisionPosition.top+J.collisionHeight-L.height()-L.scrollTop();I.top=K>0?I.top-K:Math.max(I.top-J.collisionPosition.top,I.top)}},flip:{left:function(J,L){if(L.at[0]===A){return }var N=G(window),M=L.collisionPosition.left+L.collisionWidth-N.width()-N.scrollLeft(),I=L.my[0]==="left"?-L.elemWidth:L.my[0]==="right"?L.elemWidth:0,K=L.at[0]==="left"?L.targetWidth:-L.targetWidth,O=-2*L.offset[0];J.left+=L.collisionPosition.left<0?I+K+O:M>0?I+K+O:0},top:function(J,L){if(L.at[1]===A){return }var N=G(window),M=L.collisionPosition.top+L.collisionHeight-N.height()-N.scrollTop(),I=L.my[1]==="top"?-L.elemHeight:L.my[1]==="bottom"?L.elemHeight:0,K=L.at[1]==="top"?L.targetHeight:-L.targetHeight,O=-2*L.offset[1];J.top+=L.collisionPosition.top<0?I+K+O:M>0?I+K+O:0}}};if(!G.offset.setOffset){G.offset.setOffset=function(M,J){if(/static/.test(G.curCSS(M,"position"))){M.style.position="relative"}var L=G(M),O=L.offset(),I=parseInt(G.curCSS(M,"top",true),10)||0,N=parseInt(G.curCSS(M,"left",true),10)||0,K={top:(J.top-O.top)+I,left:(J.left-O.left)+N};if("using" in J){J.using.call(M,K)}else{L.css(K)}};G.fn.offset=function(I){var J=this[0];if(!J||!J.ownerDocument){return null}if(I){if(G.isFunction(I)){return this.each(function(K){G(this).offset(I.call(this,K,G(this).offset()))})}return this.each(function(){G.offset.setOffset(this,I)})}return C.call(this)}}if(!G.curCSS){G.curCSS=G.css}}(jQuery));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-experimental-progress-indicator', location = 'js/aui-experimental-progress-indicator.js' */
(function(){function A(B,D,C){AJS._internal.animation.recomputeStyle(B);B.css("width",C*100+"%");D.attr("data-value",C)}AJS.progressBars={update:function(G,M){var C=AJS.$(G).first();var F=C.children(".aui-progress-indicator-value");var L=F.attr("data-value")||0;var K="aui-progress-indicator-after-update";var I="aui-progress-indicator-before-update";var D="transitionend webkitTransitionEnd";var E=!C.attr("data-value");if(E){F.css("width",0)}if(typeof M==="number"&&M<=1&&M>=0){C.trigger(I,[L,M]);var H=document.body||document.documentElement;var B=H.style;var J="transition";if(typeof B.transition==="string"||typeof B.WebkitTransition==="string"){F.one(D,function(){C.trigger(K,[L,M])});A(F,C,M)}else{A(F,C,M);C.trigger(K,[L,M])}}return C},setIndeterminate:function(D){var C=AJS.$(D).first();var B=C.children(".aui-progress-indicator-value");C.removeAttr("data-value");AJS._internal.animation.recomputeStyle(C);B.css("width","100%")}}}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/drag-and-drop-utils.js' */
define("confluence-drag-and-drop/drag-and-drop-utils",["jquery","window","ajs"],function(c,d,f){return{defaultMimeType:"application/octet-stream",base:/^\w+:\/\/[^\/?#]+/.exec(location.href),bindDragEnter:function(a,b){if(a.addEventListener)(b=this.isFireFox35OrLater()?this.firefox35DragEnterAndOverCallbackWrapper(b):b)&&a.addEventListener("dragenter",b,!1);else if(a.attachEvent){var e=this.ieDragEnterAndDragOverCallbackWrapper(b);a.attachEvent("ondragenter",e);c(d).unload(function(){a.detachEvent("ondragenter",
e)})}},bindDragOver:function(a,b){if(a.addEventListener)this.isFireFox35OrLater()?b=this.firefox35DragEnterAndOverCallbackWrapper(b):c.browser.safari&&(b=this.safariDragOverCallbackWrapper(b)),b&&a.addEventListener("dragover",b,!1);else if(a.attachEvent){var e=this.ieDragEnterAndDragOverCallbackWrapper(b);a.attachEvent("ondragover",e);c(d).unload(function(){a.detachEvent("ondragover",e)})}},bindDragLeave:function(a,b){b&&(c.browser.safari||this.isFireFox35OrLater()||tinymce.isIE11?a.addEventListener("dragleave",
b,!1):c.browser.msie?(a.attachEvent("ondragleave",b),c(d).unload(function(){a.detachEvent("ondragleave",b)})):c.browser.mozilla&&a.addEventListener("dragexit",b,!1))},bindDrop:function(a,b){if(c.browser.mozilla){var e=this.isFireFox35OrLater()?"drop":"dragdrop";a.addEventListener(e,this.mozillaDropCallbackWrapper(b),!1)}else if(c.browser.msie){if(b){var g=function(a){b(a);f.DragAndDropUtils.stopPropagation(a)};a.attachEvent("ondrop",g);c(d).unload(function(){a.detachEvent("ondrop",g)})}}else c.browser.safari&&
b&&a.addEventListener("drop",function(a){b(a);f.DragAndDropUtils.stopPropagation(a)},!1)},niceSize:function(a){for(var b=" B; kB; MB; GB; TB; PB; EB; ZB; YB".split(";"),c=0,d=b.length;c<d;c++)if(a<Math.pow(2,10*(c+1)))return(!c?a:(a/Math.pow(2,10*c)).toFixed(2))+b[c];return(a/Math.pow(2,10*(c+1))).toFixed(2)+b[b.length-1]},ieDragEnterAndDragOverCallbackWrapper:function(a){return function(b){if(b=b||d.event)a&&a(b),c.browser.msie&&(b.returnValue=!1)}},safariDragOverCallbackWrapper:function(a){return function(b){if((b=
b||d.event)&&"file"!==b.target.type)a&&a(b),-1!=c.inArray("public.file-url",b.dataTransfer.types)&&b.preventDefault()}},mozillaDropCallbackWrapper:function(a){return function(b){b&&(a&&a(b),b.preventDefault(),f.DragAndDropUtils.isFireFox35OrLater()?f.DragAndDropUtils.firefox35FileDataInEvent(b)&&b.stopPropagation():b.stopPropagation())}},firefox35DragEnterAndOverCallbackWrapper:function(a){return function(b){b&&(a&&a(b),f.DragAndDropUtils.firefox35FileDataInEvent(b)&&b.preventDefault())}},firefox35FileDataInEvent:function(a){return-1!=
c.inArray("application/x-moz-file",a.dataTransfer.types)},stopPropagation:function(a){if(a=a||d.event)a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},preventDefault:function(a){if(a=a||d.event)a.preventDefault?a.preventDefault():a.returnValue=!1},isFireFox35OrLater:function(){return!this.isFireFox30()&&-1!=c.browser.version.indexOf("1.9.")},isFireFox30:function(){return-1!=c.browser.version.indexOf("1.9.0")},enableDropZoneOn:function(a,b){if(!a)throw Error("Cannot enable drop zone on invalid container. Received: "+
a);b=b||f.DragAndDrop.defaultDropHandler;this.bindDragEnter(a);this.bindDragOver(a);this.bindDragLeave(a);this.bindDrop(a,b)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/drag-and-drop-utils","AJS.DragAndDropUtils");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/default-drop-handler.js' */
define("confluence-drag-and-drop/default-drop-handler","ajs document confluence/meta jquery confluence/legacy underscore plupload window".split(" "),function(a,h,j,f,k,p,l,q){var m={initialise:function(){function n(){var a=f(".aui-blanket:visible");return a.length&&a.css("visibility")!=="hidden"&&!f("#drag-and-drop-progress-dialog:visible").length}function m(){for(;e.files.length;)e.removeFile(e.files[0])}var d,i=h.getElementById("fileuploadShim");if(!i){i=h.createElement("div");i.setAttribute("id",
"fileuploadShim");h.body.appendChild(i)}var e=new l.Uploader({runtimes:"html5",dragdrop:true,drop_element:f("body")[0],browse_button:i.getAttribute("id"),multipart:false,stop_propagation:true,max_file_size:+j.get("global-settings-attachment-max-size")}),o=function(){d=a.Editor&&a.Editor.isVisible()&&k.EditorUploadProgressDialog?k.EditorUploadProgressDialog:new a.DragAndDropProgressDialog};d=null;e.init();a.DragAndDrop.defaultDropHandler=null;e.bind("FilesAdded",function(g,b){function r(a,b){!d&&o();
for(var c=0;c<b.length;c++){var g=b[c];g.status!==l.FAILED&&d.render({workId:g.id,status:g.status,file:g})}e.start()}if(n())m();else if(a.Editor&&a.Editor.isVisible()){var c=p.reject(b,function(a){return a.status===l.FAILED});k.Uploader&&k.Uploader.trigger("FilesAdded",c)}else a.UploadUtils.filterFiles(g,b,r)});e.bind("BeforeUpload",function(g,b){if(!a.Editor||!a.Editor.isVisible()){var e=a.DragAndDropUtils.base+a.contextPath()+"/plugins/drag-and-drop/upload.action",c=j.get("page-id"),c=c!=0?{pageId:c}:
{draftId:j.get("draft-id")},f=b.name.substr(b.name.lastIndexOf(".")+1);c.filename=b.name;c.size=b.size;c.mimeType=l.mimeTypes[f.toLowerCase()]||a.DragAndDropUtils.defaultMimeType;c.spaceKey=j.get("space-key");c.atl_token=j.get("atl-token");g.settings.url=l.buildUrl(e,c);d.cancelListeners.push(function(b,c){var e=g.getFile(c.workId);e&&g.removeFile(e);d.renderInfo(c.workId,"File was manually removed from the queue.")});d.show()}});e.bind("UploadProgress",function(a,b){d.renderUpdateToBytesUploaded(b.id,
b.loaded,b.size);d.hideCloseButton()});e.bind("FileUploaded",function(e,b,f){f.status===0?d.renderError(b.id,"The server is not responding. Please check that it is running."):d.renderComplete(b.id)});e.bind("Error",function(e,b){if(n())m();else if(a.Editor&&a.Editor.isVisible())k.Uploader&&k.Uploader.trigger("Error",b);else{var h,c;if(b.response){try{h=f.parseJSON(b.response);c=h.actionErrors[0]}catch(i){c=i.name==="SyntaxError"?"Invalid response received from the server.":b.message}d.renderError(b.file.id,
c);a.trigger("analyticsEvent",{name:"confluence.default-drop.upload.error.server-unknown"})}else{c=b.message;if(b.code===l.FILE_SIZE_ERROR){c=a.format("is too big to upload. Files must be less than {0}.",a.DragAndDropUtils.niceSize(j.get("global-settings-attachment-max-size")));a.trigger("analyticsEvent",{name:"confluence.default-drop.upload.error.file-size"})}else if(b.code===a.UploadUtils.ErrorCode.FILE_IS_A_FOLDER_ERROR){c="might be a folder or an unsupported file type.";a.trigger("analyticsEvent",{name:"confluence.default-drop.upload.error.file-type"})}!d&&
o();d.render({workId:b.file.id,status:b.file.status,file:b.file,errorMessage:c});if(!d.isVisible()){d.show();d.showCloseButton()}}}});e.bind("UploadComplete",function(){if(!e.total.queued&&d){d.showCloseButton();d.hasErrors()||setTimeout(function(){d.hide();d.clearRenderOutput();q.location.reload()},1E3)}})},bind:function(){function a(){f(h).unbind("dragenter",a);m.initialise()}f(h).bind("dragenter",a)}};return m});
require("confluence/module-exporter").safeRequire("confluence-drag-and-drop/default-drop-handler",function(a){require("ajs").toInit(a.bind)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/observable-array-list.js' */
define("confluence-drag-and-drop/observable-array-list",["ajs","jquery"],function(g,f){var e=function(){this._data=[];this._pushObservers=[]};e.prototype={push:function(a){this._data.push(a);this._notifyPushObservers(a)},length:function(){return this._data.length},remove:function(a,b){return this._remove.call(this._data,a,b)},_remove:function(a,b){var c=this.slice((b||a)+1||this.length);this.length=0>a?this.length+a:a;return this.push.apply(this,c)},shift:function(){return this._data.shift()},removeByPredicate:function(a){for(var b=
[],c=this._data.length,d=0;d<c;d++)a(this._data[d])||b.push(this._data[d]);this._data=b;return c-this._data.length},addPushObserver:function(a){if(f.isFunction(a))this._pushObservers.push(a);else throw Error("Attempting to add an observer that is not a function: "+a);},_notifyPushObservers:function(a){for(var b=0,c=this._pushObservers.length;b<c;b++)this._pushObservers[b](a)}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/observable-array-list","AJS.ObservableArrayList");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/upload-progress-dialog.js' */
define("confluence-drag-and-drop/upload-progress-dialog",["ajs","plupload","jquery","document"],function(b,g,c,i){var h=function(a){var d=this,e={header:"Attach files",width:600,height:400};this._options=c.extend({},e,a);this.id="drag-and-drop-progress-dialog";this._dialog=new b.Dialog(this._options.width,this._options.height,this.id);this._dialog.addHeader(this._options.header).addPanel("Panel 1",b.DragAndDrop.Templates.uploadFileStatusContainer()).addButton("Done",
function(){d.hide();d.clearRenderOutput()},"all-file-uploads-complete");this._dialog.getCurrentPanel().setPadding(0);this._$closeButton=this.find(".all-file-uploads-complete");c(i).keydown(function(a){if(27===a.which)return d._$closeButton.prop("disabled")||(d.hide(),d.clearRenderOutput()),b.stopEvent(a)});this._$container=this.find("#upload-statuses");this._workIdsOfFilesInProgress=[];this.cancelListeners=[];this.onShowListeners=[];this._hidden=!0;this.hasErrorMessage=!1};h.prototype={show:function(){this._hidden&&
(this._dialog.show(),this._hidden=!1,c.each(this.onShowListeners,function(a,c){c()}));this.hideCloseButton()},hide:function(){this._hidden||(this._dialog.hide(),this._hidden=!0)},isVisible:function(){return!this._hidden},_getProgressElementId:function(a){return"file-"+a+"-progress"},render:function(a){this._workIdsOfFilesInProgress.push(a.workId);var d=this._getProgressElementId(a.workId);this._$container.append(b.DragAndDrop.Templates.fileStatus({filename:a.file.name,progressElementId:d,workId:a.workId,
showCancel:a.status==g.QUEUED}));b.progressBars.update("#"+d,0);a.status==g.QUEUED?c("#file-upload-cancel-"+a.workId).click(function(b){return function(d){c.each(b,function(c,b){b(d,a)})}}(this.cancelListeners)):this.renderError(a.workId,a.errorMessage)},renderError:function(a,d){if(-1==c.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);var e=c("#file-status-block-"+a),f=b.escapeEntities(e.attr("data-filename"));e.html(aui.message.warning({content:d,titleContent:f}));
this.hasErrorMessage=!0},renderInfo:function(a,d){if(-1==c.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);var e=c("#file-status-block-"+a),f=b.escapeEntities(e.attr("data-filename"));e.html(aui.message.info({content:d,titleContent:f}));this.hasErrorMessage=!0},hasErrors:function(){return this.hasErrorMessage},renderUpdateToBytesUploaded:function(a,d,e){if(-1==c.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);var f=
b.DragAndDropUtils.niceSize(d),g=c("#file-"+a+"-uploaded");g.length?g.text(f):c("#file-upload-progress-text-"+a).html(b.DragAndDrop.Templates.uploadFileStatusProgressMessage({fileId:a,uploadedSizeNice:f,totalSizeNice:b.DragAndDropUtils.niceSize(e)}));b.progressBars.update("#"+this._getProgressElementId(a),d/e)},renderComplete:function(a){if(-1==c.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);c("#cancel-or-success-placeholder-"+a).html(b.DragAndDrop.Templates.uploadFileStatusSuccessIcon())},
renderCancelled:function(a){if(-1==c.inArray(a,this._workIdsOfFilesInProgress))throw Error("No file status found with id: "+a);b.progressBars.setIndeterminate("#"+this._getProgressElementId(a));c("#file-upload-progress-text-"+a).html("Cancelled.");c("#cancel-or-success-placeholder-"+a).hide()},clearRenderOutput:function(){this.showCloseButton();this._$container.empty();this._workIdsOfFilesInProgress=[];this.hasErrorMessage=!1},hideCloseButton:function(){this._$closeButton.hide()},
showCloseButton:function(){this._$closeButton.show()},find:function(a){return this._dialog.getCurPanel().page.body.parent().find(a)}};return h});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/upload-progress-dialog","AJS.DragAndDropProgressDialog");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'templates/drag-and-drop.soy' */
// This file was automatically generated from drag-and-drop.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace AJS.DragAndDrop.Templates.
 */

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.DragAndDrop == 'undefined') { AJS.DragAndDrop = {}; }
if (typeof AJS.DragAndDrop.Templates == 'undefined') { AJS.DragAndDrop.Templates = {}; }


AJS.DragAndDrop.Templates.fileStatus = function(opt_data, opt_ignored) {
  return '<li id="file-status-block-' + soy.$$escapeHtml(opt_data.workId) + '" data-filename="' + soy.$$escapeHtml(opt_data.filename) + '"><div class="aui-group aui-group-split file-status-item"><div class="aui-item"><label>' + soy.$$escapeHtml(opt_data.filename) + '</label></div><div class="aui-item"><div id="file-upload-progress-text-' + soy.$$escapeHtml(opt_data.workId) + '" class="file-upload-progress-text">' + soy.$$escapeHtml("Waiting...") + '</div></div></div><div class="file-upload-progress-block"><div class="aui-progress-indicator" id="' + soy.$$escapeHtml(opt_data.progressElementId) + '"><span class="aui-progress-indicator-value"></span></div>' + ((opt_data.showCancel) ? '<div id="cancel-or-success-placeholder-' + soy.$$escapeHtml(opt_data.workId) + '" class="cancel-or-success-placeholder ui-state-default"><span id="file-upload-cancel-' + soy.$$escapeHtml(opt_data.workId) + '" class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml("Cancel Upload") + '">' + soy.$$escapeHtml("Cancel") + '</span></div>' : '') + '</div></li>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.fileStatus.soyTemplateName = 'AJS.DragAndDrop.Templates.fileStatus';
}


AJS.DragAndDrop.Templates.uploadFileStatusContainer = function(opt_data, opt_ignored) {
  return '<ul id="upload-statuses"></ul>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.uploadFileStatusContainer.soyTemplateName = 'AJS.DragAndDrop.Templates.uploadFileStatusContainer';
}


AJS.DragAndDrop.Templates.uploadFileStatusSuccessIcon = function(opt_data, opt_ignored) {
  return '<span class=\'aui-icon aui-icon-small aui-iconfont-success\'></span>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.uploadFileStatusSuccessIcon.soyTemplateName = 'AJS.DragAndDrop.Templates.uploadFileStatusSuccessIcon';
}


AJS.DragAndDrop.Templates.uploadFileStatusProgressMessage = function(opt_data, opt_ignored) {
  return '<span id="file-' + soy.$$escapeHtml(opt_data.fileId) + '-uploaded">' + soy.$$escapeHtml(opt_data.uploadedSizeNice) + '</span> ' + soy.$$escapeHtml("of") + ' ' + soy.$$escapeHtml(opt_data.totalSizeNice);
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.uploadFileStatusProgressMessage.soyTemplateName = 'AJS.DragAndDrop.Templates.uploadFileStatusProgressMessage';
}


AJS.DragAndDrop.Templates.dropZone = function(opt_data, opt_ignored) {
  return '<div class="attachments-drop-zone"><div class="drop-zone-image"></div><div class="drop-zone-text">' + soy.$$escapeHtml("Drop files here to attach them") + '</div></div>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.dropZone.soyTemplateName = 'AJS.DragAndDrop.Templates.dropZone';
}


AJS.DragAndDrop.Templates.dragOverlay = function(opt_data, opt_ignored) {
  return '<div id="dragOverlay"><div class="overlay-blanket"></div><div class="overlay-center"><p>' + soy.$$escapeHtml("Drop files to insert them into the page") + '</p></div><span class="overlay-baseline"></span><div class="overlay-drop-zone"></div></div>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.dragOverlay.soyTemplateName = 'AJS.DragAndDrop.Templates.dragOverlay';
}


AJS.DragAndDrop.Templates.dragAndDropTip = function(opt_data, opt_ignored) {
  return '<div class="attach-tip-discovery"><span class="img"></span><div class="text"><strong>' + soy.$$escapeHtml("Tip:") + ' </strong><p>' + soy.$$escapeHtml("Drop files straight into your page to insert them directly.") + '</p><div><a class="close-tip" href="#">' + soy.$$escapeHtml("Ok, got it!") + '</a></div></div></div>';
};
if (goog.DEBUG) {
  AJS.DragAndDrop.Templates.dragAndDropTip.soyTemplateName = 'AJS.DragAndDrop.Templates.dragAndDropTip';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:support', location = 'js/upload-utils.js' */
define("confluence-drag-and-drop/upload-utils",["ajs"],function(h){return{ErrorCode:{FILE_IS_A_FOLDER_ERROR:-602},filterFiles:function(d,a,g){for(var e=[],b=0,c=0;c<a.length;c++)if(4096>=a[c].nativeFile.size){var f=new FileReader;f.onload=function(){b++;e.push(this.currentFile);b===a.length&&g(d,e)};f.onerror=function(){d.removeFile(this.currentFile);d.trigger("Error",{code:h.UploadUtils.ErrorCode.FILE_IS_A_FOLDER_ERROR,message:"File is a folder",file:this.currentFile});b++;b===a.length&&g(d,e)};
f.currentFile=a[c];f.readAsText(a[c].nativeFile)}else b++,e.push(a[c]),b===a.length&&g(d,e)}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-drag-and-drop/upload-utils","AJS.UploadUtils");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:util-resource', location = 'util/utils.js' */
define("confluence/ic/util/utils",["jquery","underscore","ajs","backbone","exports"],function(w,R,u,x,F){var m={INLINE_COMMENTS:u.DarkFeatures.isEnabled("confluence-inline-comments"),RESOLVED_INLINE_COMMENTS:u.DarkFeatures.isEnabled("confluence-inline-comments-resolved"),RICH_TEXT_EDITOR:u.DarkFeatures.isEnabled("confluence-inline-comments-rich-editor"),DANGLING_COMMENT:u.DarkFeatures.isEnabled("confluence-inline-comments-dangling-comment")},t=["dateautocomplete","confluencemacrobrowser","propertypanel","jiraconnector","dfe"],n=["autoresize","confluenceleavecomment"],r=["code"];var a,C,q;function O(){return R.clone(m)}function N(){return R.clone(t)}function j(){return R.clone(n)}function d(U,T){var W;if(!U||!T){return}var S=w(U.containingElement);if(!S.is(".inline-comment-marker.valid")){S=w("<div/>").append(U.html).find(".inline-comment-marker.valid")}if(S.length>0&&f(S)){var V=S.first().data("ref");W=T.findWhere({markerRef:V});return W}}function f(S){return S.filter(function(){return w(this).text().length>0}).length>0}function h(S){return u.contextPath()+"/pages/viewpage.action?pageId="+u.Meta.get("latest-page-id")+"&focusedCommentId="+S+"#comment-"+S}function s(Y,X,S){var V=X.match(/(focusedCommentId|replyToComment)=(\d+)/);if(V==null){return}var U=V[1]==="replyToComment";var W=parseInt(V[2],10);var T=Y.findWhere({id:W});if(T!=null){o(Y,T,S,U)}else{w.ajax({url:u.contextPath()+"/rest/inlinecomments/1.0/comments/replies/"+W+"/commentId"}).done(function(Z){T=Y.findWhere({id:Z});o(Y,T,S,U)})}}function o(V,U,S,T){if(U!=null){if(U.isResolved()){new S({collection:V,focusCommentId:U.get("id")}).render()}else{if(!U.isDangling()){x.trigger("ic:view",U,"permalink",{isReplyComment:T})}}}}function K(){if(u.Meta.get("current-user-avatar-url")){return u.contextPath()+u.Meta.get("current-user-avatar-url")}return u.Meta.get("static-resource-url-prefix")+"/images/icons/profilepics/anonymous.png"}function P(){return u.Meta.get("user-display-name")||u.Meta.get("current-user-fullname")}function b(U){if(typeof U.selectionStart==="number"){var S=U.value.length;U.selectionStart=S;U.selectionEnd=S}else{if(typeof U.createTextRange!=null){U.focus();var T=U.createTextRange();T.collapse(false);T.select()}}}function L(S){b(S);window.setTimeout(function(){b(S)},1)}function E(X,W){var U="webkitAnimationEnd oanimationend msAnimationEnd animationend";var T=X.$wikiContent;var S=w.Deferred();if(W){var Y=w(".inline-comment-marker.active");T.addClass("ic-fade-in-animation");T.one(U,function(){w(this).removeClass("ic-fade-in-animation")});X.$el.addClass("ic-slide-in");X.$el.one(U,function(){w(this).removeClass("ic-slide-in");Y.addClass("ic-highlight-pulse");Y.one(U,function(){Y.removeClass("ic-highlight-pulse")})});S.resolve()}else{T.bind(U,function(Z){if(Z.originalEvent.animationName=="ic-fade-out-animation"){X.$wikiContent.removeClass("ic-fade-out-animation");X.$wikiContent.css("opacity","0.5")}else{if(Z.originalEvent.animationName=="ic-fade-in-animation"){X.$wikiContent.css("opacity","1");X.$wikiContent.removeClass("ic-fade-in-animation");X.$wikiContent.unbind(U)}}});T.addClass("ic-fade-out-animation");X.$el.addClass("ic-slide-out");var V=function(){X.$el.removeClass("ic-slide-out");X._emptySidebar();y().css("padding-right","0");T.addClass("ic-fade-in-animation");T.css("position","static");S.resolve();X.$el.off(U,V)};X.$el.on(U,V)}return S.promise()}function k(S){var T=w(S).closest("a");if(!T.length){T=w(S).find("a")}return T}function A(S){S.each(function(){var T=k(this);T.length&&T.off("mousemove")})}function Q(){return document.body.style.animation!==undefined||document.body.style.webkitAnimation!==undefined}function c(T){var S=T.parents(".expand-content.expand-hidden");S.each(function(U){w(this).siblings(".expand-control").click()})}function v(T){var S=u.Rte&&u.Rte.getEditor();if(T===true){if(M()&&S&&S.isDirty()){return confirm("Your comment will be lost.")}}else{if(S&&S.isDirty()&&Confluence.Editor&&!Confluence.Editor.getContentType){return confirm("Your comment will be lost.")}}return true}function M(){return !!w(".ic-sidebar #wysiwygTextarea_ifr").length}function G(){return u.Meta.get("use-keyboard-shortcuts")&&Confluence.KeyboardShortcuts&&Confluence.KeyboardShortcuts.enabled}function p(S){S.$("button.ic-action-hide").tooltip({gravity:"se"});S.$("#ic-nav-next").tooltip({gravity:"s"});S.$("#ic-nav-previous").tooltip({gravity:"s"})}function B(W){if(J()){W.css("padding-bottom","20px");return}var U=W.height();var V=W.offset().top;var T=V+U;var X=this.getPageContainer().offset().top;var S=T-X;this.getPageContainer().css({"min-height":S+"px"})}function z(W){W=W.closest(".ic-display-comment-view");var V=this;var T=w(".confluence-embedded-image, .confluence-embedded-file img",W);var U=T.length;var S=0;if(U>0){T.off("load").one("load",function(){if(++S===U){V.recalculateContentHeight(W)}}).each(function(){if(this.complete){w(this).load()}})}}function J(){if(q===undefined){q=!!D().length}return q}function y(){if(a===undefined){a=w("#content")}return a}function D(){if(C===undefined){C=w("#splitter-content")}return C}function g(S,T){if(T&&!T.is(":visible")){return}if(S){if(this.isDocTheme()){this.getSplitterContent().scrollTop(T.offset().top-S)}else{window.scrollTo(0,T.offset().top-S)}}}function e(T){var S=w.Deferred();w.ajax({url:u.contextPath()+"/rest/api/content/"+T+"?expand=body.editor",type:"GET",dataType:"json",contentType:"application/json; charset=utf-8"}).then(function(U){var V=U.body.editor.value;S.resolve(V)}).fail(function(U,W,V){S.reject(U,W,V)});return S.promise()}function I(S){var T=S.closest(".conf-macro");return(T.data("hasbody")===false||S.find('.conf-macro[data-hasbody="false"]').length>0)||r.indexOf(T.data("macro-name"))!=-1}function i(S){return S.closest(".user-mention").length>0||S.find(".user-mention").length>0}function l(S){return S.closest("a[href^='/']:not('.user-mention')").length>0||S.find("a[href^='/']:not('.user-mention')").length>0}function H(){var S={isDefault:true,path:u.Meta.get("static-resource-url-prefix")+"/images/icons/profilepics/default.png"};if(u.Meta.get("current-user-avatar-url")!=="/images/icons/profilepics/default.png"){S={isDefault:false,path:u.contextPath()+u.Meta.get("current-user-avatar-url")}}var T=u.Meta.get("remote-user");return{userName:T==""?null:T,displayName:u.Meta.get("current-user-fullname"),profilePicture:S}}F.overlappedSelection=d;F.focusedCommentUrl=h;F.showFocusedComment=s;F.getAuthorAvatarUrl=K;F.moveCaretToEnd=L;F.animateSidebar=E;F.getDarkFeatures=O;F.getInlineLinks=k;F.removeInlineLinksDialog=A;F.isAnimationSupported=Q;F.showHighlightContent=c;F.getUnsupportedRtePlugins=N;F.getSupportedRtePlugins=j;F.confirmProcess=v;F.getAuthorDisplayName=P;F.isKeyboardShortcutsEnable=G;F.addSidebarHeadingTooltip=p;F.hasEditorInSidebar=M;F.recalculateContentHeight=B;F.resizeContentAfterLoadingImages=z;F.isDocTheme=J;F.getPageContainer=y;F.getSplitterContent=D;F.scrollToCommentAfterToggleSideBar=g;F.getEditorFormat=e;F.containUnsupportedMacro=I;F.containInternalLink=i;F.containUserMetion=l;F.getCurrentUserInfo=H});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:util-resource', location = 'util/text-highlighter.js' */
define("confluence/ic/util/text-highlighter",["jquery"],function(c){var a="ic-current-selection";function b(){c.textHighlighter.createWrapper=function(d){return c("<span></span>").addClass(d.highlightedClass)};this.$el=c("#content .wiki-content").first();if(this.$el.length>0){this.$el.textHighlighter({highlightedClass:a})}}b.prototype.highlight=function(e){if(this.$el.length===0){return}var d=c(this.$el.getHighlighter().doHighlight(e));return this.$el.getHighlighter().serializeHighlights(d)};b.prototype.removeHighlight=function(){if(this.$el.length===0){return}this.$el.getHighlighter().removeHighlights();return this};b.prototype.deserializeHighlights=function(d,e){if(this.$el.length===0){return}var f='<span class="inline-comment-marker" data-ref="'+e+'"></span>';return this.$el.getHighlighter().deserializeHighlights(d,f)};return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:models', location = '/model/comment.js' */
define("confluence/ic/model/comment",["jquery","underscore","backbone","ajs","confluence/ic/util/utils","confluence/ic/model/reply-collection"],function(d,b,g,a,c,f){var e=g.Model.extend({defaults:{authorDisplayName:c.getAuthorDisplayName(),authorUserName:a.Meta.get("remote-user"),authorAvatarUrl:a.contextPath()+a.Meta.get("current-user-avatar-url"),body:"",originalSelection:"",containerId:a.Meta.get("latest-page-id"),parentCommentId:"0",lastFetchTime:d("meta[name=confluence-request-time]").attr("content"),hasDeletePermission:true,hasEditPermission:true,hasResolvePermission:true,resolveProperties:{resolved:false,resolvedTime:0},serializedHighlights:"",deleted:false},urlRoot:a.contextPath()+"/rest/inlinecomments/1.0/comments",initialize:function(h){h=h||{};this._setHighlights(h.markerRef);var i=this;this.replies=new f();this.replies.url=function(){return i.url()+"/replies"};if(c.getDarkFeatures().DANGLING_COMMENT&&a.Meta.get("page-id")===a.Meta.get("latest-page-id")){if(this.isDangling()&&!this.isResolved()){this.resolve(true,{wait:true,dangling:true,success:b.bind(function(){g.trigger("ic:open:dangled",this)},this),error:b.bind(function(){g.trigger("ic:resolve:dangled:failed",this)},this)})}}},validate:function(){if(!this.get("body")){return true}},resolve:function(h,i){i=i||{};this.save({},b.extend(i,{url:this.urlRoot+"/"+this.get("id")+"/resolve/"+h+"/dangling/"+(i.dangling===true)}))},isResolved:function(){return this.get("resolveProperties").resolved},isDangling:function(){return this.highlight===undefined},isDeleted:function(){return this.get("deleted")},_setHighlights:function(i){var h;if(i!==undefined){h=d("#content .wiki-content:first").find('.inline-comment-marker[data-ref="'+i+'"]')}else{h=d(".ic-current-selection")}if(h.length!==0){this.highlights=h;this.highlight=h.first()}else{this.highlights=undefined;this.highlight=undefined}},destroy:function(i){i=i?b.clone(i):{};var h=this;var k=i.success;var j=function(n,m){var l=m.error;m.error=function(o){if(l){l(n,o,m)}n.trigger("error",n,o,m)}};i.success=function(l){if(k){k(h,l,i)}};j(this,i);return this.sync("delete",this,i)}});return e});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:models', location = '/model/comment-collection.js' */
define("confluence/ic/model/comment-collection",["jquery","backbone","ajs","underscore","confluence/ic/model/comment"],function(d,f,a,b,e){var c=f.Collection.extend({model:e,initialize:function(){this.listenTo(this,"sort",this._removeCachedMarkers)},url:function(){var h=a.contextPath();var g=a.Meta.get("page-id");return h+"/rest/inlinecomments/1.0/comments?containerId="+g},getResolvedCount:function(){return this.getResolvedComments().length},getUnresolveCount:function(){return this.reject(function(g){return g.isResolved()===true&&g.isDeleted()===false}).length},getResolvedComments:function(){return this.filter(function(g){return g.isResolved()===true&&g.isDeleted()===false})},getResolvedCommentsDesc:function(){return b.sortBy(this.getResolvedComments(),function(g){return 0-g.get("resolveProperties").resolvedTime})},getNextCommentOnPage:function(){return this._getCommentAtRelativeOffset(1)},getPrevCommentOnPage:function(){return this._getCommentAtRelativeOffset(-1)},_getCommentAtRelativeOffset:function(j){var k=this.getCommentsOnPage();var g=this.findWhere({active:true});if(g===undefined||k.length<=1){return null}var i=b.pluck(k,"id");var h=b.indexOf(i,g.get("id"));return k[(h+j+k.length)%k.length]},getCommentsOnPage:function(){return this.filter(function(g){return((g.isResolved()===false)&&!g.isDangling()&&(g.isDeleted()===false))||g.get("active")===true})},getCommentsOnPageCount:function(){return this.getCommentsOnPage().length},getActiveIndexWithinPageComments:function(){var h=b.pluck(this.getCommentsOnPage(),"id");var g=this.findWhere({active:true});if(g===undefined){return null}var i=g.get("id");return b.indexOf(h,i)},comparator:function(h,g){if(this.markers===undefined){this.markers=d("#content .wiki-content:first").find(".inline-comment-marker")}if(h.highlight===undefined){return 1}if(g.highlight===undefined){return -1}return this.markers.index(h.highlight)-this.markers.index(g.highlight)},_removeCachedMarkers:function(){this.markers=undefined}});return c});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:models', location = '/model/reply.js' */
define("confluence/ic/model/reply",["jquery","backbone","ajs","confluence/ic/util/utils",],function(d,e,b,c){var a=e.Model.extend({defaults:{authorDisplayName:c.getAuthorDisplayName(),authorUserName:b.Meta.get("remote-user"),authorAvatarUrl:b.contextPath()+b.Meta.get("current-user-avatar-url"),body:"",commentId:"0",hasDeletePermission:true,hasEditPermission:!!b.Meta.get("remote-user")},urlRoot:function(){return b.contextPath()+"/rest/inlinecomments/1.0/comments/"+this.get("commentId")+"/replies"},sync:function(h,g,f){f=f||{};if(h==="create"){f.url=this.urlRoot()+"?containerId="+b.Meta.get("latest-page-id")}return e.sync.call(this,h,g,f)},validate:function(){if(!this.get("body")){return true}}});return a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:models', location = '/model/reply-collection.js' */
define("confluence/ic/model/reply-collection",["backbone","confluence/ic/model/reply"],function(c,a){var b=c.Collection.extend({model:a});return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:app', location = 'analytics/ic-analytics.js' */
define("confluence/ic/analytics",["ajs","underscore","backbone"],function(b,c,d){var a={};c.extend(a,d.Events);a.start=function(){if(this.running===true){return}this.running=true;this.send=function(e,f){b.trigger("analytics",{name:e,data:f})};this.listenTo(d,"ic:highlight-panel-click",function(){this.send("confluence.highlight.actions.comment.inline")});this.listenTo(d,"ic:view",function(f,e){this.send("confluence.comment.inline.view");if(e==="nav"){this.send("confluence.comment.inline.view.nav")}if(e==="permalink"){this.send("confluence.comment.inline.view.permalink")}});this.listenTo(d,"ic:overlap",function(){this.send("confluence.comment.inline.overlap")});this.listenTo(d,"ic:edit",function(){this.send("confluence.comment.inline.edit")});this.listenTo(d,"ic:persist",function(){this.send("confluence.comment.inline.create")});this.listenTo(d,"ic:sidebar:close",function(){this.send("confluence.comment.inline.sidebar.close")});this.listenTo(d,"ic:reply:persist",function(){this.send("confluence.comment.inline.reply")});this.listenTo(d,"ic:delete ic:reply:delete",function(){this.send("confluence.comment.inline.delete")});this.listenTo(d,"ic:resolved",function(){this.send("confluence.comment.inline.resolved")});this.listenTo(d,"ic:unresolved",function(){this.send("confluence.comment.inline.unresolved")});this.listenTo(d,"ic:resolved:view",function(f){var e={total:f};this.send("confluence.comment.inline.resolved.view",e)});this.listenTo(d,"ic:resolved:dismiss:recovery",function(){this.send("confluence.comment.inline.resolved.dismiss")});this.listenTo(d,"ic:resolved:show:recovery",function(){this.send("confluence.comment.inline.resolved.discovery")});this.listenTo(d,"ic:open:dangled",function(f){var e={commentId:f.get("id"),pageId:b.Meta.get("page-id")};this.send("confluence.comment.inline.open.dangled",e)});this.listenTo(d,"ic:editor:load:fail",function(){var e={pageId:b.Meta.get("page-id")};this.send("confluence.comment.inline.editor.load.fail",e)});this.listenTo(d,"ic:resolve:dangled:failed",function(f){var e={commentId:f.get("id"),pageId:b.Meta.get("page-id")};this.send("confluence.comment.inline.resolved.dangled.failed",e)})};a.stop=function(){this.running=false;this.stopListening()};return a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:app', location = '/app/app.js' */
define("confluence/ic/app/app",["jquery","backbone","ajs","confluence/ic/model/comment","confluence/ic/model/comment-collection","confluence/ic/analytics","exports"],function(e,h,c,f,d,b,a){function g(){b.start();var n=true;var i=new d();function l(){q().done(function(s){s.afterSyncCommentCollection();s.displayPermalinkedComment(i)})}e("body").on("click","#view-resolved-comments",function(s){s.preventDefault();q().done(function(t){t.createResolvedCommentListView()})});i.fetch({cache:false}).done(function(){if(i.getCommentsOnPageCount()>0){l()}if(i.getResolvedCount()>0){q().done(function(s){s.updateResolvedCommentCountInToolsMenu()})}else{e("#view-resolved-comments").hide()}});var k=window.location.search;if(k.indexOf("focusedCommentId")!==-1){l()}h.listenTo(h,"ic:resolved",function(){l()});var o=e("#view-resolved-comments>span");o.text("Resolved comments"+c.format(" ({0})",i.getResolvedCount()));var p=function(u,t){var v=i.get(t);var s=false;if(v===undefined){v=new f({id:t});s=true}v.fetch({success:function(w){w._setHighlights(w.get("markerRef"));if(s){i.add(w)}else{v.replies.isFetched=false}h.trigger("ic:view",v,"quickreload")}})};c.bind("qr:show-new-thread",function(t,s){q().done(function(){p(t,s)})});c.bind("qr:add-new-highlight",function(u,t,s){q().done(function(){c.trigger("qr:add-new-highlight-text",[t,s])})});var j;var r;function q(){if(n){n=false;if(j){return j.promise()}j=e.Deferred();WRM.require("wrc!inline-comments-load-sidebar").then(function(){var s=require("confluence/ic/app/loader");s.init(i);j.resolve(s)})}r=false;return j.promise()}var m="com.atlassian.confluence.plugins.confluence-inline-comments:create-inline-comment";if(Confluence&&Confluence.HighlightAction){Confluence.HighlightAction.registerButtonHandler(m,{onClick:function(s){q().done(function(t){if(r==false){r=true;t.loadSidebarOnClick(s)}})},shouldDisplay:Confluence.HighlightAction.WORKING_AREA.MAINCONTENT_ONLY})}}a.init=g});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:bootstrap', location = '/app/bootstrap.js' */
require(["jquery","ajs","confluence/ic/app/app"],function(c,a,b){if(a.Meta.get("page-id")&&(a.Meta.get("page-id")===a.Meta.get("latest-page-id"))){c(b.init)}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-core-resources', location = 'loader/profiles.js' */
define("confluence-editor/profiles",["jquery","ajs"],function(d,c){return{createProfileForCommentEditor:function(){return{plugins:"searchreplace confluenceimagedialog autocompletemacro confluencemacrobrowser confluenceleavecomment confluencewatch autoresize".split(" ")}},createProfileForPageEditor:function(a){var b="searchreplace confluencedrafts confluenceimagedialog autocompletemacro confluencemacrobrowser flextofullsize referrer".split(" ");c.Meta.getBoolean("shared-drafts")&&c.DarkFeatures.isEnabled("unpublished-changes-lozenge")&&
b.push("unpublishedchanges");a&&a.versionComment&&b.push("confluenceversioncomment");a&&a.notifyWatchers&&b.push("confluencenotifywatchers");return{plugins:b}},createProfileForTemplateEditor:function(){return{plugins:"searchreplace confluenceimagedialog autocompletemacro confluencemacrobrowser confluenceleavetemplate flextofullsize confluencetemplateeditor".split(" ")}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/profiles","AJS.Confluence.Editor._Profiles");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-edit-util', location = 'jscripts/util.js' */
define("confluence-quick-edit/util",["window","ajs"],function(c,d){return{generateUUID:function(){var a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},getBaseUrl:function(){var a=c.location.protocol.replace(/:$/,"")+"://"+c.location.host+"/"+c.location.pathname.replace(/^\//,""),b=c.location.search.replace(/^\?/,""),b=b.replace(/\&?focusedCommentId=\d+/,""),b=b.replace(/^\&/,"");return{url:a,search:b,addQueryParam:function(a,
b){this.search=this.search?this.search+"&"+a+"="+b:a+"="+b},toString:function(){return this.url+"?"+this.search}}},timeoutDeferred:function(a,b,c){"function"!==typeof b.reject&&d.log("WARNING: invalid, not rejectable object passed to AJS.Confluence.QuickEdit.Util.timeoutDeferred. You should use a Deferred object");setTimeout(function(){"pending"===b.state()&&(d.logError("Timeout: "+a),b.reject("timeout"))},c);return b}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/util","AJS.Confluence.QuickEdit.Util");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-edit-general', location = 'jscripts/quick-edit.js' */
define("confluence-quick-edit/quick-edit","ajs confluence/legacy jquery window document confluence-quick-edit/util wrm".split(" "),function(b,e,c,n,o,p,q){function r(){var a=new c.Deferred;b.Confluence.EditorLoader.load(function(){setTimeout(function(){a.resolve()},0)},function(){a.reject()});return a}var i={enableShortcut:function(){c("#editPageLink").addClass("full-load")},disableShortcut:function(){c("#editPageLink").removeClass("full-load")}},h=[],l={loadingContentTimeout:4E3,register:function(a){h.push(a)},
disableHandlers:function(){c.each(h,function(a,b){return b.disable()})},enableHandlers:function(){c.each(h,function(a,b){return b.enable()})},SaveBarBinder:{bind:function(a,b){a&&e.Editor.addSaveHandler(a);b&&e.Editor.addCancelHandler(b)}},activateEditor:function(a){function e(){function f(a){var b=new c.Deferred;q.require(a).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)});return b}var h,j=new c.Deferred;if(b.Rte&&b.Rte.getEditor()){b.debug("there is already an editor open");return j.reject("there is already an editor open")}if(!a.$container||
!a.$form){b.logError("activateEditor could not be initialsed: bad arguments",a);return j.reject("bad parameters")}h=b.Confluence.BlockAndBuffer.block(c(o));a.preActivate&&a.preActivate();i.disableShortcut();var m=a.timeoutResources||b.Confluence.EditorLoader.loadingTimeout,g=l.loadingContentTimeout,k=p.timeoutDeferred;c.when(k("resources",r(),m),k("fetch content",a.fetchContent||c.Deferred().resolve(),g),k("additional resources",a.additionalResources?f(a.additionalResources):c.Deferred().resolve(),
m)).done(function(e,f){var d={$container:a.$container,content:f,$form:a.$form,replayBufferedKeys:h};a.preInitialise&&a.preInitialise(d);c(".quick-comment-prompt",d.$container).hide();c(".quick-comment-body",d.$container).addClass("comment-body");var g=b.Confluence.EditorLoader.getPreloadContainer();if(d.content&&d.content.title){var k=d.content.title;g.find("#content-title").val(k)}d.$form.append(g.children());g.show();c("#editor-precursor").hide();c("#rte-savebar").find(".toolbar-split-left").hide();
var i=function(){d.editor=b.Rte.getEditor();d.$container.find(".quick-comment-loading-container").hide();d.$form.show();d.$form.addClass("fadeIn");var e=d.editor,f=d.content?d.content.editorContent:"",g=d.replayBufferedKeys;if(f){e.setContent(f);e.startContent=e.getContent({format:"raw",no_events:1});e.undoManager.clear()}g();e.undoManager.add();b.trigger("quickedit.success");b.trigger("quickedit.visible");b.trigger("add-bindings.keyboardshortcuts");b.trigger("active.dynamic.rte");c("div.aui-message.closeable").each(function(){var a=
c(this),d;if(!a.find(".icon-close").length){d=c('<span class="aui-icon icon-close" role="button" tabindex="0"></span>').click(function(){a.closeMessage()}).keypress(function(c){if(c.which===b.keyCode.ENTER||c.which===b.keyCode.SPACE){a.closeMessage();c.preventDefault()}});a.append(d)}});a.postInitialise&&a.postInitialise(d);l.SaveBarBinder.bind(a.saveHandler,a.cancelHandler);b.trigger("rte-quick-edit-ready");b.unbind("rte-ready",i);j.resolve()};b.bind("rte-ready",i);b.bind("rte-destroyed",a.postDeactivate||
function(){});b.Rte.BootstrapManager.initialise({plugins:a.plugins,toolbar:a.toolbar,excludePlugins:a.excludePlugins,isQuickEdit:true,onInitialise:a.onInitialise})}).fail(function(c){j.reject(c);b.logError("Error loading page quick edit. Falling back to normal edit URL...");b.trigger("analytics",{name:"rte.quick-edit.activate-editor.failed"});if(a.fallbackUrl){b.log("This parameter is deprecated. To be removed in the next major version (5.8 or 6.0). Please use the promise returned to bind custom action if the editor fails to load instead.");
n.location=a.fallbackUrl}});return j.promise()}if(a.closeAnyExistingEditor&&b.Rte&&b.Rte.getEditor()){var f=new c.Deferred;this.deactivateEditor().done(function(){e().done(function(){f.resolve()}).fail(function(a){f.reject(a)})}).fail(function(){b.debug("Could not deactivate current editor.");f.reject("Could not deactivate current editor.")});return f}return e()},deactivateEditor:function(){require("tinymce").execCommand("mceRemoveControl",true,"wysiwygTextarea");e.Editor.UI.toggleSavebarBusy(false);
var a=b.Confluence.EditorLoader.getPreloadContainer().empty();c(".editor-container").remove();c("#editor-precursor").remove();c("#anonymous-warning").remove();c(".quick-comment-prompt").show();c(".bottom-comment-panels").show();c("#editor-notification-container").empty();c(".action-reply-comment").removeAttr("reply-disabled");i.enableShortcut();e.Editor.removeAllSaveHandlers();e.Editor.removeAllCancelHandlers();return b.Confluence.EditorLoader.getEditorPreloadMarkup().done(function(c){a.append(c);
a.hide();(new b.Confluence.QuickEditCaptchaManager(a)).refreshCaptcha();b.trigger("rte-destroyed");b.unbind("rte-destroyed")})}};return l});require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/quick-edit","AJS.Confluence.QuickEdit");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-edit-general', location = 'jscripts/handlers/view.js' */
define("confluence-quick-edit/handlers/view",["jquery","ajs","window"],function(c,d,e){return function(){var a;sessionStorage.viewPort&&(a=JSON.parse(sessionStorage.viewPort));if(a&&a.pageId==d.params.pageId){var b;b=c("#main-content");var f=c("#header");b=-1!==a.blockIndex?b.children().first().children().eq(a.blockIndex).find(".innerCell").eq(a.columnIndex).children().eq(a.index):b.children().eq(a.index);e.scrollTo(0,b.offset().top+a.offset-f.outerHeight())}delete sessionStorage.viewPort}});
require("confluence/module-exporter").safeRequire("confluence-quick-edit/handlers/view",function(c){require("ajs").toInit(c)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-edit-general', location = 'jscripts/captcha-manager.js' */
define("confluence-quick-edit/captcha-manager",["jquery","ajs"],function(d,e){return function(f){function a(a){return d(f||"body").find(a)}return{refreshCaptcha:function(){var b=a("img.captcha-image");if(0<b.length){var c=Math.random();b.attr("src",e.contextPath()+"/jcaptcha?id="+c);a('input[name="captchaId"]').val(c);a('input[name="captchaResponse"]').val("")}},getCaptchaData:function(){return{id:a('input[name="captchaId"]').val(),response:a('input[name="captchaResponse"]').val()}}}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/captcha-manager","AJS.Confluence.QuickEditCaptchaManager");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-edit-general', location = 'jscripts/handlers/shortcut.js' */
define("confluence-quick-edit/handlers/shortcut",["ajs"],function(a){var d=!1;a.bind("initialize.keyboardshortcuts add-bindings.keyboardshortcuts",function(){d=!0});a.bind("remove-bindings.keyboardshortcuts",function(){d=!1});return{createShortcut:function(f,g){function b(){c=c||a.whenIType(f).moveToAndClick(g)}function e(){c&&c.unbind();c=null}var c;return{bind:function(){d&&b();a.bind("initialize.keyboardshortcuts",b);a.bind("add-bindings.keyboardshortcuts",b);a.bind("remove-bindings.keyboardshortcuts",
e)},unbind:function(){e();a.unbind("initialize.keyboardshortcuts",b);a.unbind("add-bindings.keyboardshortcuts",b);a.unbind("remove-bindings.keyboardshortcuts",e)}}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/handlers/shortcut","AJS.Confluence.QuickEdit.KeyboardShortcuts");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-edit-general', location = 'jscripts/handlers/page.js' */
define("confluence-quick-edit/handlers/page",["jquery","ajs","confluence/legacy","confluence-quick-edit/handlers/shortcut","window"],function(c,b,i,n,j){function m(a,b,f){var d={pageId:f,blockIndex:-1,columnIndex:-1,index:-1,offset:0,hasBlock:function(){return-1!==this.blockIndex}},k=!1,e=function(a,c){var f=a.offset();g(a)&&(d.index=c,d.offset=b-f.top,k=!0)},g=function(a){var c=a.offset();return c.top-8<=b&&c.top+a.height()>=b};1===a.children().length&&a.children().first().hasClass("contentLayout2")?
(a.children().first().children().each(function(a){!d.hasBlock()&&g(c(this))&&(d.blockIndex=a)}),d.hasBlock()&&(a=a.children().first().children().eq(d.blockIndex).find(".innerCell"),a.each(function(a){if(-1===d.columnIndex){var b=c(this).children().length;0<b&&(2>b?25<c(this).children().first().height()&&(d.columnIndex=a):d.columnIndex=a)}}),a.eq(d.columnIndex).children().each(function(a){k||e(c(this),a)}))):a.children().each(function(a){k||e(c(this),a)});return k?d:null}function o(a){var h=require("tinymce");
e.disable();b.populateParameters();if(b.DarkFeatures.isEnabled("confluence.view.edit.transition")){var f=c("#main-content"),d=c("#header"),k=c("#main-header"),d=j.pageYOffset+d.outerHeight()+k.outerHeight();g=m(f,d,b.params.pageId);b.trigger("quick-edit.viewport.saved");var l=function(){c(h.activeEditor.getWin().document).find("body#tinymce").addClass("page-edit");c("#content").css({paddingRight:0});b.unbind("quickedit.visible",l)};b.bind("quickedit.visible",l)}f=a.$form;d="page"===b.Meta.get("content-type")?
"doeditpage":"doeditblogpost";d=b.contextPath()+"/pages/"+d+".action?pageId="+i.getContentId();c(".ia-splitter-left").remove();try{c("#main").unwrap()}catch(s){}c("#rte").removeClass("editor-default").addClass("editor-fullheight");a.$container.children().remove();c(".editor-container").children().eq(0).unwrap();f.attr({"class":"editor aui",action:d,name:"editpageform",id:"editpageform",style:""});a.$container.append(f);a.$container.removeClass("view").addClass("edit");c("body").addClass("contenteditor edit")}
function p(a){require("tinymce");c("#editor-precursor").show();c("#rte-savebar").find(".toolbar-split-left").show();if(j.history.pushState){var h=c("#editPageLink").attr("href");h!=j.location.pathname+j.location.search&&(history.pushState({quickEdit:!0},"",h),b.trigger("rte-quick-edit-push-state",h))}else j.location.hash="editor",b.trigger("rte-quick-edit-push-hash");h=a.content;if(h.permissions)for(var f in h.permissions)c("#"+f).attr("value",h.permissions[f]);c("#originalVersion").val(a.content.pageVersion);
f=a.content.atlToken;b.Meta.set("atl-token",f);c('input[name="atl_token"]').val(f);b.trigger("analyticsEvent",{name:"quick-edit-success"});c("#navigation").remove();var d=new Date,e=function(c,b){if(d&&!("keydown"===b.type&&-1<[91,92,93,224,33,34,37,38,39,40,16,17,18,20,112,113,114,115,116,117,118,119,120,121,122,123].indexOf(b.keyCode))){var f=new Date-d;d=null;i.Analytics.publish("confluence.editor.transition.firstkeydown",{delay:f});a.editor.onKeyDown.remove(e);a.editor.onChange.remove(e)}};a.editor.onKeyDown.add(e);
a.editor.onChange.add(e)}function q(a){setTimeout(function(){if(g){var b;b=c(a.getBody());b=g.hasBlock()?b.children().first().children().eq(g.blockIndex).find(".innerCell").eq(g.columnIndex).children().eq(g.index):b.children().eq(g.index);a.getWin().scrollTo(0,b.offset().top+g.offset);c("#main").css("visibility","visible")}})}function r(){var a=new c.Deferred,e=c.ajax({url:b.contextPath()+"/rest/tinymce/1/content/"+i.getContentId()+".json",cache:!1});e.success(function(b){a.resolve(b)});e.error(function(){a.reject("error fetching content")});
return a}var l,g,e={editShortcut:n.createShortcut("e","#editPageLink"),activateEventHandler:function(a){if(!a.metaKey&&!a.shiftKey&&!a.ctrlKey&&!a.altKey&&!(2===a.which||3===a.which))a.preventDefault(),l&&"pending"===l.state()?b.debug("Editor is being activated. Ignoring handler..."):(l=e.activateEditor(),a=c("#editPageLink"),a.find(".aui-icon").css("visibility","hidden"),a.parent().spin({left:"10px"}))},enable:function(){if(c("body").is(".theme-default")){var a=c("#editPageLink");a.bind("click",
e.activateEventHandler);a.removeClass("full-load");e.editShortcut.bind();b.debug("QuickPageEdit enabled")}else b.debug("QuickPageEdit not enabled")},activateEditor:function(){var a=c("#content").find(".quick-comment-form"),e=function(){var a=require("tinymce").activeEditor.getWin(),d=c(a.document).find("#tinymce");if(a=m(d,a.pageYOffset,b.params.pageId))sessionStorage.viewPort=JSON.stringify(a)};return b.Confluence.QuickEdit.activateEditor({fetchContent:r(),$container:c("#content"),$form:a.length?
a:c('<form method="post"></form>'),preInitialise:o,postInitialise:p,saveHandler:function(){b.DarkFeatures.isEnabled("confluence.view.edit.transition")&&e();1<i.Editor.getNumConcurrentEditors()&&b.Confluence.Analytics.publish("rte.notification.concurrent-editing.save",{numEditors:i.Editor.getNumConcurrentEditors(),pageId:b.params.pageId,draftType:b.params.draftType})},cancelHandler:function(){b.DarkFeatures.isEnabled("confluence.view.edit.transition")&&e();1<i.Editor.getNumConcurrentEditors()&&b.Confluence.Analytics.publish("rte.notification.concurrent-editing.cancel",
{numEditors:i.Editor.getNumConcurrentEditors(),pageId:b.params.pageId,draftType:b.params.draftType})},plugins:b.Confluence.Editor._Profiles.createProfileForPageEditor({versionComment:!0,notifyWatchers:!0}).plugins,onInitialise:function(a){b.DarkFeatures.isEnabled("confluence.view.edit.transition")&&a.onLoad.add(q)}}).fail(function(){j.location=c("#editPageLink").attr("href")})},disable:function(){b.debug("QuickPageEdit disabled.");e.editShortcut.unbind();c("#editPageLink").unbind("click",e.activateEventHandler)}};
b.Confluence.QuickEdit.register(e);return{disable:e.disable}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/handlers/page","AJS.Confluence.QuickEdit.QuickEditPage");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-edit-general', location = 'jscripts/init.js' */
define("confluence-quick-edit/init",["ajs","jquery","window"],function(a,b,c){return function(){a.DarkFeatures.isEnabled("shipit25.quick.edit.defer")?a.debug("QuickComment: editor preload is disabled"):b(c).load(function(){a.debug("QuickComment: instigated background loading of the comment editor.");a.Confluence.EditorLoader.load()});a.Confluence.QuickEdit.enableHandlers();a.trigger("rte-quick-edit-enable-handlers")}});
require("confluence/module-exporter").safeRequire("confluence-quick-edit/init",function(a){var b=require("ajs");b.DarkFeatures.isEnabled("disable-quick-edit")?b.log("disable-quick-edit is turned on; run AJS.Confluence.EditorLoader.load() manually."):b.toInit(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-initial', location = 'jscripts/handlers/comment.js' */
define("confluence-quick-edit/handlers/comment",["ajs","confluence/legacy","jquery","aui/flag","confluence-quick-edit/util"],function(a,f,d,m,j){function l(a,c){var g=a.match(RegExp("[?&]"+c+"=(\\d+)"));return g&&1<g.length?parseInt(g[1]):0}d(function(){a.AppLinksInitialisationBinder=function(b){a.bind("init.rte",b)}});var e={timeout:8E3,showLoadingEditorErrorMessage:function(){a.trigger("rte-quick-comment-loading-failed");m({type:"error",title:"Error",
persistent:!1,body:"Error loading the comment editor. Please refresh the page to try again."})},preInitialise:function(){a.Confluence.QuickEdit.QuickEditPage.disable();a.Meta.set("content-type","comment");a.Meta.set("draft-type","");a.params.contentType="comment";a.params.draftType="";a.Meta.set("use-inline-tasks","false");d("#editor-precursor").children().eq(0).hide();d("#pagelayout-menu").parent().hide();d("#page-layout-2-group").hide();d("#rte-button-tasklist").remove();d("#rte-insert-tasklist").parent().remove()},
postInitialise:function(b){a.Rte.editorFocus(b.editor)},delegatingSaveCommentHandler:function(a){return a.asyncRenderSafe?e.ajaxSaveCommentHandler(a):e.reloadPageSaveCommentHandler(a)},reloadPageSaveCommentHandler:function(a){var c=j.getBaseUrl();c.addQueryParam("focusedCommentId",a.id);c.addQueryParam("refresh",+new Date);window.location.href=c.toString()+"#comment-"+a.id},ajaxSaveCommentHandler:function(b){var c={isDefault:!0,path:a.Meta.get("static-resource-url-prefix")+"/images/icons/profilepics/default.png"};
"/images/icons/profilepics/default.png"!==a.Meta.get("current-user-avatar-url")&&(c={isDefault:!1,path:a.contextPath()+a.Meta.get("current-user-avatar-url")});var g=a.Meta.get("remote-user"),d={userName:""==g?null:g,displayName:a.Meta.get("current-user-fullname"),profilePicture:c};e.cancelComment().done(function(){f.CommentDisplayManager.addOrUpdateComment(d,b,!0,!1);a.trigger("page.commentAddedOrUpdated",{commentId:b.id})})},cancelHandler:function(){a.Confluence.QuickEdit&&(a.Rte.Content.editorResetContentChanged(),
a.Confluence.QuickEdit.deactivateEditor())},createCommenterParam:function(b,c,d){return{userName:c||a.Meta.get("remote-user")||null,displayName:d||a.Meta.get("user-display-name"),profilePicture:{isDefault:b.hasClass("defaultLogo"),path:b.attr("src")}}},createSaveHandler:function(b,c){var g=j.generateUUID();return function(e){e.preventDefault();if(a.Rte.Content.isEmpty())a.Confluence.EditorNotification.notify("warning","Comment text is empty. Cannot create empty comments."),f.Editor.UI.toggleSavebarBusy(!1);else{var h=e=
0,i=a.Confluence.EditorLoader.getEditorForm();i.is("form")&&(h=i.attr("action"),e=l(h,"parentId"),h=l(h,"commentId"));var k=new a.Confluence.QuickEditCaptchaManager(i),i=function(a){c(a);k.refreshCaptcha()},j=d("#watchPage").is(":checked");0<h?f.Editor.CommentManager.updateComment(f.getContentId(),h,a.Rte.Content.getHtml(),j,k.getCaptchaData(),b,i):f.Editor.CommentManager.saveComment(f.getContentId(),e,a.Rte.Content.getHtml(),j,g,k.getCaptchaData(),b,i)}}},saveCommentErrorHandler:function(b){f.Editor.UI.toggleSavebarBusy(!1);
var c;c=b&&-1!=b.search(/captcha/i)?"The typed word did not match the text in the picture.":"Failed to save the comment. Please try again later.";a.logError("Error saving comment",b);a.Confluence.EditorNotification.notify("error",c)},cancelComment:function(){a.Rte.Content.editorResetContentChanged();return a.Confluence.QuickEdit.deactivateEditor()},proceedWithActivation:function(){var b=new d.Deferred,c=a.Rte&&a.Rte.getEditor();if(c)if(c.isDirty()&&!f.Editor.isEmpty())if(confirm("Your comment will be lost."))b=
e.cancelComment();else return b.reject();else b=e.cancelComment();else b.resolve();return b}};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/handlers/comment","AJS.Confluence.QuickEdit.QuickComment");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-initial', location = 'jscripts/handlers/comment/top-level.js' */
define("confluence-quick-edit/handlers/comment/top-level",["ajs","jquery","confluence-quick-edit/handlers/shortcut","confluence-quick-edit/handlers/comment","window"],function(b,a,e,c,f){function g(a){c.preInitialise(a)}function h(b){a("#comments-section").one("click",".quick-comment-prompt",d.activateEventHandler);a("#rte-savebar").scrollWindowToElement();c.postInitialise(b)}function i(){b.Confluence.EditorLoader.resourcesLoaded()||(b.trigger("analytics",{name:"rte.quick-edit.top-comment.spinner"}),
a(".quick-comment-prompt").hide(),a(".quick-comment-loading-container").fadeIn().spin("medium"))}function j(b){b.preventDefault();f.location=a("#add-comment-rte").attr("href")}var k=b.DarkFeatures.isEnabled("editor.slow.comment.disable"),d={commentShortcut:e.createShortcut("m",".quick-comment-prompt"),activateEventHandler:function(e){e.preventDefault();c.proceedWithActivation().done(function(){var d=c.createSaveHandler(c.delegatingSaveCommentHandler,c.saveCommentErrorHandler);return b.Confluence.QuickEdit.activateEditor({preActivate:i,
$container:a("form[name=inlinecommentform]").closest(".quick-comment-container"),$form:a("form[name=inlinecommentform]"),preInitialise:g,saveHandler:d,cancelHandler:c.cancelHandler,postInitialise:h,plugins:b.Confluence.Editor._Profiles.createProfileForCommentEditor().plugins,additionalResources:["wrc!comment-editor"],timeoutResources:c.timeout}).fail(function(){k?c.showLoadingEditorErrorMessage():f.location=a("#add-comment-rte").attr("href")})}).fail(function(){a("#comments-section").one("click",
".quick-comment-prompt",d.activateEventHandler)})},enable:function(){a("#comments-section").one("click",".quick-comment-prompt",d.activateEventHandler);a("#add-comment-rte").removeClass("full-load");this.commentShortcut.bind()},disable:function(){a("#comments-section").off("click",".quick-comment-prompt");this.commentShortcut.unbind()}};b.Confluence.QuickEdit.register(d);return{bindCommentAreaFallbackHandler:function(){a("#comments-section").delegate(".quick-comment-prompt","click",j)},cancelComment:function(){b.log("'AJS.Confluence.QuickEdit.QuickComment.TopLevel.cancelComment' is deprecated in 5.7, consider using 'AJS.Confluence.QuickEdit.QuickComment.cancelComment' instead.");
return b.Confluence.QuickEdit.QuickComment.cancelComment()}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/handlers/comment/top-level","AJS.Confluence.QuickEdit.QuickComment.TopLevel");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-initial', location = 'jscripts/handlers/comment/reply.js' */
define("confluence-quick-edit/handlers/comment/reply",["ajs","confluence/legacy","jquery"],function(a,g,b){function i(b){a.Confluence.QuickEdit.QuickComment.preInitialise(b);b.$container.scrollWindowToElement()}function j(b){a.Confluence.QuickEdit.QuickComment.postInitialise(b)}function h(b){var e=b.attr("id").match(/comment-(\d+)/),f=0;e?f=parseInt(e[1]):(a.trigger("analytics",{name:"rte.quick-edit.get-reply-parent.failed"}),a.logError("replyHandler: activateEventHandler - could not extract a parent comment Id from the comment id "+
b.attr("id")));return f}function k(){b(".comment.reply").closest(".comment-threads").remove()}var l=a.DarkFeatures.isEnabled("editor.slow.comment.disable"),d={activateEventHandler:function(d){d.preventDefault();d.stopPropagation();var e=this;if(b(e).attr("reply-disabled"))return!1;a.Confluence.QuickEdit.QuickComment.proceedWithActivation().done(function(){var f=b(e).closest("div.comment"),c=b(".quick-comment-container img.userLogo"),c=a.Confluence.QuickEdit.QuickComment.createCommenterParam(c),c=
{contentId:g.getContentId(),parentCommentId:h(f),commenter:c,context:{contextPath:a.Meta.get("context-path"),staticResourceUrlPrefix:a.Meta.get("static-resource-url-prefix")}},c=b(g.Templates.Comments.displayReplyEditorLoadingContainer(c)),d=b(".quick-comment-loading-container",c);d.hide();f.after(c);a.Confluence.EditorLoader.resourcesLoaded()?a.trigger("analytics",{name:"rte.quick-edit.reply-comment.no-spinner"}):(a.trigger("analytics",{name:"rte.quick-edit.reply-comment.spinner"}),f.after(c),d.fadeIn(),
d.spin("medium"),d[0].scrollIntoView());c=b(e).closest(".comment-thread").find(".quick-comment-container");a.Meta.set("form-name",b("form",c).attr("name"));a.Confluence.QuickEdit.activateEditor({$container:c,$form:b("form.quick-comment-form[name=threadedcommentform]"),preInitialise:i,postInitialise:j,saveHandler:a.Confluence.QuickEdit.QuickComment.createSaveHandler(a.Confluence.QuickEdit.QuickComment.delegatingSaveCommentHandler,a.Confluence.QuickEdit.QuickComment.saveCommentErrorHandler),cancelHandler:a.Confluence.QuickEdit.QuickComment.cancelHandler,
plugins:a.Confluence.Editor._Profiles.createProfileForCommentEditor().plugins,postDeactivate:k,additionalResources:["wrc!comment-editor"],timeoutResources:a.Confluence.QuickEdit.QuickComment.timeout}).fail(function(){l?a.Confluence.QuickEdit.QuickComment.showLoadingEditorErrorMessage():window.location=b("#reply-comment-"+h(f)).attr("href")});b(e).attr("reply-disabled",!0)})},enable:function(){b("#comments-section").delegate(".action-reply-comment","click",d.activateEventHandler)},disable:function(){b("#comments-section").undelegate(".action-reply-comment",
"click")}};a.Confluence.QuickEdit.register(d);return{cancelComment:function(){a.log("'AJS.Confluence.QuickEdit.QuickComment.Reply.cancelComment' is deprecated in 5.7, consider using 'AJS.Confluence.QuickEdit.QuickComment.cancelComment' instead.");return a.Confluence.QuickEdit.QuickComment.cancelComment()}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/handlers/comment/reply","AJS.Confluence.QuickEdit.QuickComment.Reply");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-initial', location = 'jscripts/handlers/comment/edit.js' */
define("confluence-quick-edit/handlers/comment/edit",["ajs","confluence-quick-edit/handlers/comment","jquery","confluence/legacy"],function(e,b,d,i){function j(a){b.preInitialise(a);a.$container.scrollWindowToElement()}function k(a){b.postInitialise(a)}function h(a){return(a=a.attr("id").match(/comment-(\d+)/))?parseInt(a[1]):0}function l(a){var b=new d.Deferred;d.ajax({url:e.contextPath()+"/rest/api/content/"+a+"?expand=body.editor",cache:!1}).done(function(a){!a||!a.body||!a.body.editor?b.reject("invalid response from loading comment rest endpoint"):
b.resolve({editorContent:a.body.editor.value})}).fail(function(){b.reject("error fetching content")});return b}function m(){var a=d(".comment.edit");a.prev(".comment").show();a.remove()}var n=e.DarkFeatures.isEnabled("editor.slow.comment.disable"),g={activateEventHandler:function(a){var g=this;a.preventDefault();a.stopPropagation();b.proceedWithActivation().done(function(){var a=d(g).closest("div.comment"),c;c=a.find(".author .confluence-userlink");var f=a.find(".comment-user-logo img.userLogo");
c=b.createCommenterParam(f,c.attr("data-username"),c.text());c={contentId:i.getContentId(),commentId:h(a),commenter:c,context:{contextPath:e.Meta.get("context-path"),staticResourceUrlPrefix:e.Meta.get("static-resource-url-prefix")},mode:"edit"};c=d(i.Templates.Comments.displayEditEditorContainer(c));f=d(".quick-comment-loading-container",c);a.hide();a.after(c);f.fadeIn().spin("medium");f[0].scrollIntoView();c=a.next(".quick-comment-container");e.Meta.set("form-name",d("form",c).attr("name"));e.Confluence.QuickEdit.activateEditor({$container:c,
$form:d("form.quick-comment-form[name=editcommentform]"),fetchContent:l(h(a)),preInitialise:j,postInitialise:k,saveHandler:b.createSaveHandler(b.delegatingSaveCommentHandler,b.saveCommentErrorHandler),cancelHandler:b.cancelHandler,plugins:e.Confluence.Editor._Profiles.createProfileForCommentEditor().plugins,postDeactivate:m,additionalResources:["wrc!comment-editor"],timeoutResources:b.timeout}).fail(function(){n?b.showLoadingEditorErrorMessage():window.location=d("#edit-comment-"+h(a)).attr("href")})})},
enable:function(){d("#comments-section").delegate(".comment-action-edit","click",g.activateEventHandler)},disable:function(){d("#comments-section").undelegate(".comment-action-edit","click")}};e.Confluence.QuickEdit.register(g);return{cancelComment:function(){e.log("'AJS.Confluence.QuickEdit.QuickComment.Edit.cancelComment' is deprecated in 5.7, consider using 'AJS.Confluence.QuickEdit.QuickComment.cancelComment' instead.");return b.cancelComment()}}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/handlers/comment/edit","AJS.Confluence.QuickEdit.QuickComment.Edit");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-initial', location = 'jscripts/editor-comment-manager.js' */
define("confluence-quick-edit/editor-comment-manager",["ajs","jquery","confluence/legacy"],function(d,e,j){return function(){function k(a,f,l,i,b,g,h){d.trigger("analytics",{name:"confluence.page.comment.create",data:{pageID:d.Meta.get("page-id")}});a={type:"POST",url:a,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{html:f,watch:l,uuid:i},dataType:"json",cache:!1,headers:{"X-Atlassian-Token":"no-check"},success:function(a){g(a)},error:function(a,c,b){c=c+": "+b;a.responseText&&
(c=c+" - "+a.responseText);h(c)},timeout:12E4};b&&b.id&&(a.headers["X-Atlassian-Captcha-Id"]=b.id,a.headers["X-Atlassian-Captcha-Response"]=b.response);e.ajax(a)}return{addComment:function(a,f,d,i,b,g,h,e,c){j.Editor.CommentManager.saveComment(a,f,d,function(a){j.CommentDisplayManager.addComment(h,a,g);e(a)},c)},saveComment:function(a,f,e,i,b,g,h,j){var c=null,c=f?d.contextPath()+"/rest/tinymce/1/content/"+a+"/comments/"+f+"/comment?actions=true":d.contextPath()+"/rest/tinymce/1/content/"+a+"/comment?actions=true";
k(c,e,i,b,g,h,j)},updateComment:function(a,f,e,i,b,g,h){a=d.contextPath()+"/rest/tinymce/1/content/"+a+"/comments/"+f+"?actions=true";k(a,e,i,null,b,g,h)}}}});require("confluence/module-exporter").safeRequire("confluence-quick-edit/editor-comment-manager",function(d){var e=require("confluence/legacy");require("ajs").bind("init.rte",function(){e.Editor.CommentManager=d()})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:editor-view-resources', location = 'jscripts/view-content/pushed-navigation-util.js' */
define("confluence-quick-edit/view-content/pushed-navigation-util",["ajs","jquery","window"],function(d,f,a){function c(){return d.Rte&&d.Rte.getEditor()&&!!f("#editpageform").length}var b=a.location.hash,e=a.location.search;return{isInEditPage:c,filterPreviewHashChange:function(){var g=c()||a.history.pushState||!(a.location.hash&&0===a.location.hash.indexOf("#!"))&&!(b&&0===b.indexOf("#!"));b=a.location.hash;return g},filterPreviewNavigationEvent:function(){var b=c()||!/[?&]preview=([^&]*)/.test(a.location.search)&&
!/[?&]preview=([^&]*)/.test(e);e=a.location.search;return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-quick-edit/view-content/pushed-navigation-util","Confluence.Editor.PushedNavUtil");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:editor-view-resources', location = 'jscripts/view-content/pushed-navigation.js' */
define("confluence-quick-edit/view-content/pushed-navigation","jquery underscore window confluence/legacy ajs confluence-quick-edit/view-content/pushed-navigation-util".split(" "),function(b,n,a,g,c,d){function e(){if(h){if(f.split("#")[0]!=a.location.href.split("#")[0]){b(a).unbind("popstate",k);a.location.reload()}}else f.split("#")[0]==a.location.href.split("#")[0]&&f.split("#")[1]!=="editor"||a.location.reload()}function i(){f=a.location.href}function l(){var b=g.Editor.Drafts.unloadMessage();
if(b){g.Editor.Drafts.unBindUnloadMessage();if(confirm(b+"\n\n"+"Press OK to continue, or Cancel to stay on the current page.")){c.trigger("analytics",{name:"rte.quick-edit.confirmation.leaving"});e()}else{c.trigger("analytics",{name:"rte.quick-edit.confirmation.staying"});if(h){j=true;a.history.forward()}else a.location.hash="editor";g.Editor.Drafts.bindUnloadMessage()}}else e()}function o(){d.isInEditPage()?a.location.hash!=="#editor"&&l():e()}function k(){j?j=false:d.isInEditPage()?l():e()}function m(a,b){return function(){n.every(b,
function(a){return a()})&&a()}}var h=!!a.history.pushState,j=false,f=a.location.href,p=[d.filterPreviewHashChange],q=[d.filterPreviewNavigationEvent];c.bind("rte-quick-edit-enable-handlers",function(){a.location.hash==="#editor"&&b("#editPageLink").click()});return function(){i();if(h){b(a).bind("popstate",m(k,q));b(a).bind("rte-quick-edit-push-state",i)}else{b(a).bind("hashchange",m(o,p));b(a).bind("rte-quick-edit-push-hash",i)}}});
require("confluence/module-exporter").safeRequire("confluence-quick-edit/view-content/pushed-navigation",function(b){require("ajs").toInit(function(){setTimeout(b,0)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/preview-support.js' */
define("cp/confluence/preview-support",["ajs"],function(a){var d=function(){var e=b.SELECTOR_STRINGS.IMAGE+", "+b.SELECTOR_STRINGS.LINK_IMAGE+", "+b.SELECTOR_STRINGS.EXTERNAL_IMAGE;if(b.isPDFSupported()){e+=", "+b.SELECTOR_STRINGS.PDF+", "+b.SELECTOR_STRINGS.LINK_PDF}return e};var c=function(){return b.SELECTOR_STRINGS.IMAGE+", "+b.SELECTOR_STRINGS.EXTERNAL_IMAGE+", "+b.SELECTOR_STRINGS.FILE+", "+b.SELECTOR_STRINGS.LINK_FILE+", "+b.SELECTOR_STRINGS.ATTACHMENT_MACRO};var b={SELECTOR_STRINGS:{IMAGE:"img.confluence-embedded-image[data-linked-resource-id]",EXTERNAL_IMAGE:"img.confluence-embedded-image.confluence-external-resource",PDF:"a.confluence-embedded-file[data-nice-type='PDF Document']",LINK_IMAGE:"a[data-linked-resource-type='attachment'][data-nice-type='Image']",LINK_PDF:"a[data-linked-resource-type='attachment'][data-nice-type='PDF Document']",FILE:"a.confluence-embedded-file",LINK_FILE:"a[data-linked-resource-type='attachment']",FILE_OVERLAY:"span.confluence-embedded-file-wrapper .overlay",ATTACHMENT_MACRO:".plugin_attachments_container a.previewAttachmentLink"},VIEW_MODE:{FULL:"full",COMMENT:"comment",SIMPLE:"simple"},isPDFSupported:function(){return a.DarkFeatures.isEnabled("pdf-preview")},getFileSelectorString:function(){if(a.DarkFeatures.isEnabled("previews.trigger-all-file-types")){return c()}else{return d()}}};return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/preview.js' */
define("cp/confluence/preview",["underscore","jquery","cp/confluence/preview-support","ajs","confluence/jsUri"],function(k,e,f,i,b){var j,l;e(document).ready(g);function g(){var o=e(f.getFileSelectorString());o.off("click.fb");e(document.body).off("click.filePreviews");e(document.body).on("click.filePreviews",f.getFileSelectorString(),n);e(document.body).on("click.filePreviews",f.SELECTOR_STRINGS.FILE_OVERLAY,h);e(window).on("popstate",function(){if(!l&&i.DarkFeatures.isEnabled("previews.sharing.pushstate")){a()}});a()}function n(o){if(!o.altKey&&!o.ctrlKey&&!o.metaKey&&!e(this).parent().closest("a, #draft-changes-dialog, #cp-annotations").length){o.preventDefault();m(this)}}function h(p){p.preventDefault();var o=e(p.target);var q=o.closest("span.confluence-embedded-file-wrapper");m(q.find(f.SELECTOR_STRINGS.IMAGE+","+f.SELECTOR_STRINGS.FILE),{autoShowAnnotationPanel:o.closest(".comment-count-overlay").length>0})}function m(r,q){if(!l){var t="confluence-previews-css";WRM.require("wr!com.atlassian.confluence.plugins.confluence-previews:"+t);var u=e.Deferred(),o=u.promise();var p=setInterval(function(){for(var w=0;w<document.styleSheets.length;w++){if(document.styleSheets[w].href&&document.styleSheets[w].href.indexOf(t)!==-1){s();return}if(document.styleSheets[w].imports&&document.all&&!window.atob){for(var v=0;v<document.styleSheets[w].imports.length;v++){if(document.styleSheets[w].imports[v].href.indexOf(t)!==-1){s();return}}}}},100);var s=function(){u.resolve();clearInterval(p)};l=e.when(WRM.require(["wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-js","wrc!file-viewer"]),o);l.done(function(){j=require("cp/confluence/file-preview-loader");d(r,q)});Confluence.PageLoadingIndicator(e("body")).showUntilResolved(l,"We were unable to load the file previewer")}else{l.done(k.partial(d,r,q))}return l}var d=function(q,p){p=p||{};var o=e("#content");var r=e(q).closest(".comment,.cq-content,.ic-content");if(!p.viewMode){if(!(o.hasClass("page")||o.hasClass("blogpost"))){p.viewMode=f.VIEW_MODE.SIMPLE}else{if(r.length){p.viewMode=f.VIEW_MODE.COMMENT}}}if(p.viewMode===f.VIEW_MODE.COMMENT){j.showPreviewerForComment(q,r,p)}else{if(p.viewMode===f.VIEW_MODE.SIMPLE){j.showPreviewerForSingleFile(q,p)}else{p.viewMode=f.VIEW_MODE.FULL;j.showPreviewer(q,p)}}};function a(){if(c()){var q=new b(window.location.href);var p=window.history.pushState&&i.DarkFeatures.isEnabled("previews.sharing.pushstate");if(q.getQueryParamValue("preview")&&!p){var r="#!/preview"+q.getQueryParamValue("preview");var o=decodeURIComponent(q.deleteQueryParam("preview").setAnchor(r).toString());if(window.history.replaceState){window.history.replaceState({},"",o)}else{window.location=o}}else{if(q.anchor().indexOf("!/preview")===0&&p){var o;if(q.getQueryParamValue("preview")){o=q.setAnchor("")}else{o=q.addQueryParam("preview",q.anchor().substr("!/preview".length,q.anchor().length)).setAnchor("")}window.history.replaceState({},"",o)}}m()}}function c(){var o=new b(window.location.href);return i.DarkFeatures.isEnabled("previews.sharing")&&(o.getQueryParamValue("preview")||(o.anchor()&&o.anchor().indexOf("!/preview")===0))}return{loadConfluencePreviews:m}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/jquery-previewer.js' */
require(["cp/confluence/preview","jquery"],function(b,a){a.fn.previewer=function(c){if(!a(this).length){return this}var d=a.extend({},c);return this.each(function(){var f=a(this);var e=f.closest("li");var g=d.src||f.attr("data-image-src")||f.attr("src");if(g){f.click(function(j){var i={src:g,type:d.type,thumbnail:g,title:d.title||e.attr("data-file-name")||g,rank:0,id:e.attr("data-attachment-id"),ownerId:e.attr("data-owner-id")};var h=b.loadConfluencePreviews([i],{source:d.from||"custom",viewMode:d.viewMode||"simple"});d.zindex&&h.done(function(){a("#cp-container").css({"z-index":d.zindex})})})}})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'org.randombits.confluence.toc:toc-plugin-analytics', location = 'net/customware/confluence/plugin/toc/analytics/analytics.js' */
AJS.toInit(function(){AJS.$(".toc-macro a").click(function(){AJS.trigger("analyticsEvent",{name:"confluence.toc-macro.heading-click"})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'org.randombits.confluence.toc:client-side-toc-resources', location = 'net/customware/confluence/plugin/toc/js/client-side-toc.js' */
require(["ajs"],function(a){a.toInit(function(f){function b(n){var m=f({});m.data("precedenceLevel",n);return m}function g(m){return f(m).data("precedenceLevel")}function i(n,m){f(n).data("precedenceLevel",m);return n}function h(n,m){return m===g(n)}function d(s,m,o){if(s.length===0){return f()}var n=s.map(g).reduce(function(u,t){return Math.min(u,t)});if(!h(s[0],n)){s.unshift(b(n))}var q=m.createTocLevelContainer();var r={subElements:[],currentItem:undefined,outline:undefined,flush:function(){if(this.subElements.length>0&&this.currentItem){d(this.subElements,m,this.outline).appendTo(this.currentItem);this.subElements=[]}},add:function(t){this.subElements.push(t)},resetItem:function(t){this.outline=(o||[]).slice(0);this.outline.push(t);this.currentItem=m.createTocItemContainer();this.currentItem.appendTo(q);return this.currentItem}};var p=0;s.forEach(function(t){if(h(t,n)){p++;r.flush();r.resetItem(p);if(t.textContent){c(t,r.outline.join(".")).appendTo(r.currentItem)}else{r.currentItem.addClass("toc-empty-item")}}else{r.add(t)}});r.flush();if(o.length===0&&m.decorateToc){m.decorateToc(q)}return q}function c(m,n){return f(Confluence.Plugins.TableOfContents.Client.tocItemBody({outline:n,linkHref:"#"+m.id,linkText:m.textContent}))}function l(m){return{createTocLevelContainer:function(){return this.createTocItemContainer()},createTocItemContainer:function(){return f(Confluence.Plugins.TableOfContents.Client.flatStyleTocItemContainer({cssClass:"toc-item-container"}))},decorateToc:function(o){function n(r,p){var s=r in m?m[r]:p;if(s){var q=f(Confluence.Plugins.TableOfContents.Client.flatStyleTocSeparator({separator:s}));q.appendTo(o)}}n("preseparator","[ ");f(o).find("span.toc-item-body").each(function(p,q){if(p>0){n("midseparator"," ] [ ")}f(q).appendTo(o)});n("postseparator"," ]");f(o).find(".toc-item-container").remove()}}}function e(m){return{createTocLevelContainer:function(){return f(Confluence.Plugins.TableOfContents.Client.listStyleTocLevelContainer({cssliststyle:m.cssliststyle,csslistindent:m.csslistindent}))},createTocItemContainer:function(){return f(Confluence.Plugins.TableOfContents.Client.listStyleTocItemContainer())}}}function j(m){var o;if(m.includeheaderregex){o=new RegExp(m.includeheaderregex)}var n;if(m.excludeheaderregex){n=new RegExp(m.excludeheaderregex)}return function(){var p=f(this).text();if(o&&!o.test(p)){return false}if(n&&n.test(p)){return false}return true}}function k(o,q){var m=q.headerelements;var r=m.split(",");var p=j(q);var n=f("#main-content").find(m).filter(p).each(function(){i(this,r.indexOf(this.nodeName))}).toArray();return d(n,o,[])}f(".client-side-toc-macro").each(function(){var o=f(this);var n=o.data()||{};var m;if(n.structure==="flat"){m=l(n)}else{m=e(n)}if(n.numberedoutline!==true){o.addClass("hidden-outline")}o.html(k(m,n))})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'org.randombits.confluence.toc:client-side-toc-resources', location = 'net/customware/confluence/plugin/toc/templates/client.soy' */
// This file was automatically generated from client.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Plugins.TableOfContents.Client.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Plugins == 'undefined') { Confluence.Plugins = {}; }
if (typeof Confluence.Plugins.TableOfContents == 'undefined') { Confluence.Plugins.TableOfContents = {}; }
if (typeof Confluence.Plugins.TableOfContents.Client == 'undefined') { Confluence.Plugins.TableOfContents.Client = {}; }


Confluence.Plugins.TableOfContents.Client.tocItemBody = function(opt_data, opt_ignored) {
  return '<span class="toc-item-body" data-outline="' + soy.$$escapeHtml(opt_data.outline) + '"><span class="toc-outline">' + soy.$$escapeHtml(opt_data.outline) + '</span><a href="' + soy.$$escapeHtml(opt_data.linkHref) + '" class="toc-link">' + soy.$$escapeHtml(opt_data.linkText) + '</a></span>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.tocItemBody.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.tocItemBody';
}


Confluence.Plugins.TableOfContents.Client.listStyleTocLevelContainer = function(opt_data, opt_ignored) {
  return '<ul style="' + ((opt_data.cssliststyle) ? ' list-style: ' + soy.$$escapeHtml(opt_data.cssliststyle) + ';' : '') + ((opt_data.csslistindent) ? ' padding-left: ' + soy.$$escapeHtml(opt_data.csslistindent) + ';' : '') + '"></ul>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.listStyleTocLevelContainer.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.listStyleTocLevelContainer';
}


Confluence.Plugins.TableOfContents.Client.listStyleTocItemContainer = function(opt_data, opt_ignored) {
  return '<li></li>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.listStyleTocItemContainer.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.listStyleTocItemContainer';
}


Confluence.Plugins.TableOfContents.Client.flatStyleTocItemContainer = function(opt_data, opt_ignored) {
  return '<span class="' + soy.$$escapeHtml(opt_data.cssClass) + '"></span>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.flatStyleTocItemContainer.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.flatStyleTocItemContainer';
}


Confluence.Plugins.TableOfContents.Client.flatStyleTocSeparator = function(opt_data, opt_ignored) {
  return '<span class="toc-separator">' + soy.$$escapeHtml(opt_data.separator) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Plugins.TableOfContents.Client.flatStyleTocSeparator.soyTemplateName = 'Confluence.Plugins.TableOfContents.Client.flatStyleTocSeparator';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mobile:mobile-switch-resources', location = 'js/mobile-switch.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mobile:mobile-switch-resources', location = 'com/atlassian/confluence/plugins/mobile/soy/mobile-switch.soy' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:files-upload-analytics', location = 'js/analytics/files-upload-analytics.js' */
define("conf/confluence-drag-and-drop/analytics/files-upload-analytics",["ajs","underscore"],function(d,e){return{triggerEvent:function(b,a,c){a&&a.length&&(a={multiple:1<a.length,number:a.length,isAllImage:void 0===c?this._isAllImages(a):c},d.trigger("analyticsEvent",{name:b,data:a}))},_isAllImages:function(b){return e.every(b,function(a){return a.nativeFile&&a.nativeFile.type&&0===a.nativeFile.type.indexOf("image/")})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:defaults', location = '/includes/js/defaults.js' */
define("confluence/defaults",[],function(){return{maxResults:50}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/defaults","Confluence.Defaults");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item.soy' */
// This file was automatically generated from file-item.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.fileDialogListItem = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-owner-id="' + soy.$$escapeHtml(opt_data.file.ownerId) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.tooltip) + '">' + ((opt_data.file.isImage) ? '<img class="thumbnail hidden" src="' + soy.$$escapeHtml(opt_data.file.nonceUrl) + '" ><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : (opt_data.file.isPreviewable) ? '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<i class="abs-icon select">Select</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedImageNameContent) + '</span>' + ((opt_data.highlightedParentTitleContent) ? '<span class="caption owner-title" title="' + soy.$$escapeHtml(opt_data.file.parentTitle) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedParentTitleContent) + '</span>' : '') + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItem.soyTemplateName = 'Confluence.Templates.File.fileDialogListItem';
}


Confluence.Templates.File.fileDialogListItemPlaceHolder = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + ((opt_data.file.isImage && opt_data.file.url) ? '<img class="thumbnail" src="' + soy.$$escapeHtml(opt_data.file.url) + '">' : '<span class="thumbnail"><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<div id="docs-progress-bar-' + soy.$$escapeHtml(opt_data.file.fileId) + '" class="aui-progress-indicator"><span class="aui-progress-indicator-value"></span></div><div class="overlay"></div><i class="aui-icon aui-icon-small aui-iconfont-close-dialog abs-icon cancel">Cancel</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$escapeHtml(opt_data.file.fileName) + '</span><span class="caption owner-title hidden" title=""></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItemPlaceHolder.soyTemplateName = 'Confluence.Templates.File.fileDialogListItemPlaceHolder';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-model.js' */
define("confluence-editor/files/file-item/file-item-model",["backbone","confluence/legacy","ajs","underscore","plupload"],function(f,d,c,g,e){return f.Model.extend({defaults:{id:-1,ownerId:-1,fileName:"",nonceUrl:"",isImage:!1,isFilePlaceHolder:!1,isSelect:!1,thumbnailUrl:"",downloadUrl:""},initialize:function(){var a=this;this._findDownloadUrl();this._findThumbnailUrl();this.set("fileName",this.getFileName());this.set("nonceUrl",this.getNonceUrl());this.set("isImage",this.isImage());this.set("isPreviewable",
this.isPreviewable());this.get("attachmentId")&&this.set("id",this.get("attachmentId"));this.get("isFilePlaceHolder")&&this.set("id",this.get("fileId"));this.listenTo(this,"change:link",function(){a.set("nonceUrl",a.getNonceUrl());a._findDownloadUrl()});this.set("iconAUIClass",this._parseFileNameToAuiIconClass(this.get("fileName")))},isImage:function(){return this.get("isImage")?!0:!!this.get("thumbnailUrl")},isPreviewable:function(){return"pdf document"===(this.get("niceType")||"").toLocaleLowerCase()||
this.isImage()},getFileName:function(){return this.get("fileName")||this.get("name")||""},getDestinationUrl:function(){return c.REST.wikiLink(this.attributes).destination},getNonceUrl:function(){var a=this.get("thumbnailUrl");if(0<=a.indexOf("modificationDate"))return a;var b=this.get("lastModifiedDate"),b=b?b.date:+new Date,b=encodeURIComponent(b);a&&(b=(a.indexOf("?")+1?"&":"?")+"nonce="+b,a+=b);return a},getRelativeUrl:function(a){if(!a)return a;0===a.indexOf(d.getBaseUrl())&&(a=a.replace(d.getBaseUrl(),
""),a=c.contextPath()+a);return a},_findThumbnailUrl:function(){!this.get("thumbnailUrl")&&this.get("thumbnailLink")&&this.set("thumbnailUrl",this.getRelativeUrl(this.get("thumbnailLink").href))},_findDownloadUrl:function(){var a=this.get("link");!this.get("downloadUrl")&&a&&(a=g.findWhere(a,{rel:"download"}).href,this.set("downloadUrl",this.getRelativeUrl(a)))},_getFileExtension:function(a){return a.substr(a.lastIndexOf(".")+1)},_parseFileNameToAuiIconClass:function(a){a="undefined"!==typeof e?e.mimeTypes[this._getFileExtension(a)]:
"";return c.Confluence.FileTypesUtils.getAUIIconFromMime(a)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-model","Confluence.Editor.FileDialog.FileItemModel");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-view.js' */
define("confluence-editor/files/file-item/file-item-view","backbone confluence/templates confluence/highlighter raphael underscore wrm jquery".split(" "),function(f,g,h,i,e,j,d){return f.View.extend({template:g.File.fileDialogListItem,model:null,initialize:function(a){var b=this;this.eventListener=a.eventListener;this.model=a.model;this.showContainerInfo=a.showContainerInfo;this.highlighter=a.highlighter;this.listenTo(this.model,"change:isSelect",function(){b.$el.toggleClass("selected",b.model.get("isSelect"))})},
render:function(){var a=this.highlighter||new h,b=this.model.get("space"),c=this.model.getFileName(),a={file:this.model.attributes,tooltip:this.showContainerInfo&&b?c+" ("+b.name+")":c,highlightedImageNameContent:a.highlight(c),highlightedParentTitleContent:this.showContainerInfo?a.highlight(this.model.attributes.parentTitle):null};this.$el=d(this.template(a));this.el=this.$el[0];this.delegateEvents();this.$el.find(".file-container").tooltip({aria:true});this.$el.attr("data-destination",this.model.getDestinationUrl());
this.model.get("isImage")?this._renderLoadingSpinner():this.$el.removeClass("loading");this.model.get("isPreviewable")&&this._renderPreviewButton();return this},_renderPreviewButton:function(){this.$(".zoom").on("click",e.bind(function(a){a.preventDefault();a={src:this.model.get("downloadUrl"),thumbnail:this.model.get("nonceUrl")||this.model.get("downloadUrl"),type:this.model.get("contentType"),rank:0,title:this.model.getFileName(),id:this.model.get("id"),ownerId:this.model.get("ownerId"),version:this.model.get("version")};
this._setupAndShowPreviewer(a)},this))},_setupAndShowPreviewer:function(a){var b={viewMode:"simple",openPreviewCallback:function(){d("#insert-image-dialog").hide();d(".aui-blanket").hide()},closePreviewCallback:function(){d("#insert-image-dialog").show();d(".aui-blanket").show()}},c=e.bind(function(a,b){this.loader=require("cp/confluence/file-preview-loader");var c=this.loader.setupPreviewForSingleFile([a],b);c.on("fv.open",b.openPreviewCallback);c.on("fv.close",b.closePreviewCallback);c.open();c.showFileWhere()},
this);this.dfd?this.dfd.done(e.partial(c,a,b)):this.dfd=j.require("wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-resources",e.partial(c,a,b))},_renderLoadingSpinner:function(){var a=this,b=this.$el.find(".image-preview-throbber").removeClass("hidden"),c=i.spinner(b[0],8,"#666"),d=this.$el.find("img").load(function(){c();b.remove();d.removeClass("hidden");a.$el.removeClass("loading")})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-view","Confluence.Editor.FileDialog.FileItemView");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-placeholder-view.js' */
define("confluence-editor/files/file-item/file-placeholder-view",["backbone","confluence/templates","underscore","ajs","jquery"],function(b,d,e,f,g){return b.View.extend({model:null,template:d.File.fileDialogListItemPlaceHolder,initialize:function(a){this.model=a.model;this.eventListener=a.eventListener;this.eventListener.on("file.placeholder.process",e.bind(this._setUploadInProgress,this))},events:{"click .cancel":"_cancelUpload"},render:function(){this.$el=g(this.template({file:this.model.attributes}));
this.el=this.$el[0];this.delegateEvents();return this},_setUploadInProgress:function(a,b){var c=this.$el.find("#docs-progress-bar-"+b||"");c.length&&(1===a&&this.$(".cancel").hide(),c.show(),f.progressBars.update(c,a))},_cancelUpload:function(){this.eventListener.trigger("uploadingfile.cancelled",this.model.get("fileId"))}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-placeholder-view","Confluence.Editor.FileDialog.FilePlaceHolderView");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-collection.js' */
define("confluence-editor/files/file-list/file-list-collection",["backbone","confluence-editor/files/file-item/file-item-model","underscore"],function(c,d,e){return c.Collection.extend({model:d,clearSelection:function(){this.each(function(a){a.get("isSelect")&&a.set("isSelect",!1)});this.trigger("clear.selection")},getAllSelectItems:function(){return this.filter(function(a){return a.get("isSelect")})},setSelection:function(a){e.each(a,function(a){return a.set("isSelect",!0)})},resetFiles:function(a){this.reset();
for(var b=0;b<a.length;b++)this.addFile(a[b])},addFile:function(a){a=this.add(a);this.trigger("add-file",a.at(a.length-1))},removeFile:function(a){this.remove(a);this.trigger("remove-file",a)},replaceFile:function(a,b){this.remove(a);this.add(b);this.trigger("replace-file",a,b)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-collection","Confluence.Editor.FileDialog.FileListCollection");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-view.js' */
define("confluence-editor/files/file-list/file-list-view","backbone confluence-editor/files/file-item/file-item-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-item/file-placeholder-view ajs jquery".split(" "),function(f,g,h,i,j,c){return f.View.extend({eventListener:null,events:{click:"_clearSelection","click li.attached-file":"_clickItem","dblclick li.attached-file":"_doubleClickItem"},initialize:function(a){var b=this;this.collection=a.collection;if(a.eventListener){this.eventListener=
a.eventListener;this.listenTo(this.eventListener,"uploadingfile.completed",this._addUploadedFile);this.listenTo(this.eventListener,"uploadingfile.cancelled",this._cancelUploadingFile)}this.listenTo(this.collection,"reset",this._clearFileList);this.listenTo(this.collection,"add-file",this._renderNewItem);this.listenTo(this.collection,"remove-file",this._removeItem);this.listenTo(this.collection,"replace-file",this._replaceItem);this.listenTo(this.collection,"change:isSelect",function(){this.context.setSelectItems(this.collection.getAllSelectItems())});
this.listenTo(this.collection,"change:link",function(a){b.collection.removeFile(a);b.collection.addFile(a)});this.updateDialogContext(a.context);this.updatePanelContext(a.panelContext)},_addUploadedFile:function(a,b){var d=this,e=j.contextPath()+"/rest/prototype/1/attachment/"+b+".json";c.get(e).done(function(b){var b=new h(b),c=d.collection.get(a);c||(c=d.collection.findWhere({fileName:b.get("fileName")}));c?d.collection.replaceFile(c,b):d.collection.addFile(b)})},_cancelUploadingFile:function(a){(a=
this.collection.get(a))&&(a.get("previousUploadedFile")?this.collection.replaceFile(a,a.get("previousUploadedFile")):this.collection.removeFile(a))},render:function(){return this},resetFileList:function(a,b){b=b||{};this.$el.find(".loading-message").addClass("hidden");this.$el.find(".no-files").remove();this.collection.resetFiles(a);this.collection.length===0&&this.$fileList.before(c("<p></p>").addClass("no-files").text(this.noFileMessage));b.shouldClearSelection&&this.collection.clearSelection();
this._checkError(b.errors);this.$el.sizeToFit()},_getViewFromModel:function(a){return a.get("isFilePlaceHolder")?(new i({model:a,eventListener:this.eventListener})).render():(new g({model:a,showContainerInfo:this.showContainerInfo,highlighter:this.highlighter,eventListener:this.eventListener})).render()},_renderNewItem:function(a){if(this.$fileList&&this.$fileList.length){var b=this._getViewFromModel(a);this.$fileList.prepend(b.el);a.get("isFilePlaceHolder")||a.set("isSelect",true)}},_removeItem:function(a){if(this.$fileList&&
this.$fileList.length)(a=this._getDomElementByFileName(a.get("fileName")))&&a.remove()},_replaceItem:function(a,b){if(this.$fileList&&this.$fileList.length){var c=this._getViewFromModel(b),e=this._getDomElementByFileName(a.get("fileName"));e&&e.length?e.replaceWith(c.el):this.$fileList.prepend(c.el);b.set("isSelect",true)}},_getDomElementByFileName:function(a){var b=null;this.$fileList.find("li").each(function(){var d=c(this);d.attr("data-file-name")===a&&(b=d)});return b},updatePanelContext:function(a){if(a){this.panelContext=
a;this.errors=this.panelContext.errors||[];this.$el=this.fileContainer=this.panelContext.fileContainer;this.el=this.$el[0];this.$fileList=this.$el.find(".file-list");this.delegateEvents();this.noFileMessage=this.panelContext.noFileMessage;this.showContainerInfo=this.panelContext.showContainerInfo;this.highlighter=this.panelContext.highlighter;this.displayErrors=this.panelContext.displayErrors}},updateDialogContext:function(a){if(a){this.context=a;this.contextOptions=this.context.options}},_checkError:function(a){(a=
a||[])&&a.length&&this.displayErrors(a)},_clearSelection:function(a){a=a&&c(a.target);if(!a||!a.hasClass("close-tip")){this.collection.clearSelection();this.$el.find(".current").removeClass("current")}},_clearFileList:function(){this.$fileList&&this.$fileList.empty()},_clickItem:function(a){a.stopPropagation();a.preventDefault();var b=c(a.target);if(!b.closest(".zoom").length){a.isTrigger||this.$fileList.find(".current").removeClass("current");a=b.closest("li").attr("data-attachment-id");(a=this.collection.get(a))&&
!a.get("isFilePlaceHolder")&&a.set("isSelect",!a.get("isSelect"))}},_doubleClickItem:function(a){var a=c(a.target).closest("li"),b=a.attr("data-attachment-id");if((b=this.collection.get(b))&&!b.get("isFilePlaceHolder")){a.click();this.context.insert()}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-view","Confluence.Editor.FileDialog.FileListView");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/base-panel/base-panel-view.js' */
define("confluence-editor/files/base-panel/base-panel-view",["backbone","ajs","jquery"],function(b,a,c){return b.View.extend({context:null,cssContainer:"",cssPanel:"",textErrorSearch:"Error searching for attachments from Confluence. The server may be unavailable.",textErrorRetrieving:"Error retrieving attachments from Confluence. The server may be unavailable.",textDefaultErrorMessage:"Could not upload the file to Confluence. The server may be unavailable.",textUploading:"Image uploading...",initialize:function(){},createPanel:function(d){this.context=
d;this.render();var a=this;if(d=this.context.getPanel(this.panelId))d.onselect=function(){a.context.clearSelection();a.focus&&a.focus()}},render:function(){return this},getPanelElement:function(){return c(this.cssPanel,this.context.baseElement)},getContainer:function(){return c(this.cssContainer)},getForm:function(){return c("form",this.getPanelElement())},clearContainer:function(){var a=this.getContainer();a.find(".loading-message").removeClass("hidden");a.find(".warning").addClass("hidden")},clearErrors:function(){this.messenger.clearMessages()},
displayErrors:function(a){this.uploader.displayErrors(a);this.getContainer().sizeToFit()},getNoFileContainer:function(){return this.getPanelElement().find(".no-files")},getFileListContainer:function(){return this.getPanelElement().find("ul.file-list")}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/base-panel/base-panel-view","Confluence.Editor.FileDialog.BasePanel",function(){var b=require("underscore"),a=require("backbone");require("confluence/legacy").Editor.FileDialog.eventListener=b.extend({},a.Events)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel.soy' */
// This file was automatically generated from attachments-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.uploadFileForm = function(opt_data, opt_ignored) {
  return '' + ((opt_data.hasAttachPermission) ? '<div id="upload-attachment">' + ((opt_data.isNonSupportDragDrop) ? '<form action="' + soy.$$escapeHtml("") + '/pages/attachfile.action" method="post" enctype="multipart/form-data">' : '<form>') + '<label id="upload-files-button" class="aui-button upload-files"><span class="file-upload-icon">' + soy.$$escapeHtml("Upload files") + '</span>&nbsp;&nbsp;' + soy.$$escapeHtml("Upload files") + ((opt_data.isNonSupportDragDrop) ? '<input name="file_0" type="file" class="upfile invisible">' : '') + '</label>' + ((opt_data.isNonSupportDragDrop) ? '<input type="hidden" name="minorEdit_0" value="true" /><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" />' : '') + '</form>' + ((opt_data.isNonSupportDragDrop) ? '<div class="upload-in-progress hidden">' + soy.$$escapeHtml("Image uploading...") + '</div>' : '') + '</div>' : '') + ((opt_data.hasAttachPermission) ? '<div class="divider"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.File.uploadFileForm.soyTemplateName = 'Confluence.Templates.File.uploadFileForm';
}


Confluence.Templates.File.attachedFilesPanel = function(opt_data, opt_ignored) {
  return '<div id="attached-files" class="scroll-wrapper">' + aui.message.warning({title: '', closeable: 'true', content: ''}) + '<div class="loading-message hidden">' + soy.$$escapeHtml("Loading\u2026") + '</div><ul class="file-list"></ul></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.attachedFilesPanel.soyTemplateName = 'Confluence.Templates.File.attachedFilesPanel';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel-view.js' */
define("confluence-editor/files/attachments-panel/attachments-panel-view","confluence-editor/files/file-list/file-list-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/legacy ajs confluence/meta underscore window jquery".split(" "),function(m,i,n,j,k,o,e,h,l,f,g){return j.extend({id:"attachments",panelId:"",cssPanel:".attachments-panel",cssContainer:"#attached-files",
textNoFileMessage:"There are no files attached to this page.",textPanelTitle:"Attached to this page",initialize:function(a){j.prototype.initialize.call(this);this.eventListener=a.eventListener;this.context=null;this.collection=new n;this.fileListView=new m({collection:this.collection,eventListener:this.eventListener});this.xhrCount=0},render:function(){var a=this;this.eventListener.trigger("AttachmentsPanelView.render",this);this.fileListView.updateDialogContext(this.context);
this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"attachments-panel");this.el=this.getPanelElement();this.$el=g(this.el);this.delegateEvents();this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:this.textNoFileMessage,showContainerInfo:false,errors:[],displayErrors:function(b){a.uploader.clearErrors();a.uploader.displayErrors(b)}});this.uploader=this.getUploaderController(this.context);this.messenger=this.uploader.getMessageHandler();this.collection.reset();
this._canAttachFiles()?this.refresh({shouldClearSelection:true}):this.refresh({errors:["You\'ll need to ask permission to insert files here."],shouldClearSelection:true});return this},getPanel:function(){return k.File.uploadFileForm({isNonSupportDragDrop:!this._hasXhrSupport(),atlToken:h.get("atl-token"),hasAttachPermission:this._canAttachFiles()})+k.File.attachedFilesPanel()},_overideUploaderClientForNonDragDropSupport:function(){var a=this;return{onUploadSuccess:function(b){for(var d=0;d<b.length;d++){var c=
b[d].id,f=a.collection.get(c);f&&a.collection.removeFile(f);c=e.contextPath()+"/rest/prototype/1/attachment/"+c+".json";g.get(c).done(function(b){b=new i(b);a.collection.addFile(b)})}},pack:function(){a.getContainer().sizeToFit()},getDefaultErrorMessage:function(){return a.textDefaultErrorMessage},getDefaultUploadingMessage:function(){return a.textUploading},displayErrors:function(b){this.getMessageHandler().displayMessages(b);a._showErrorIconInMessageBox();this.pack()}}},getUploaderController:function(){return o.AttachmentUploader({baseElement:this.getPanelElement()},
l.bind(this._overideUploaderClientForNonDragDropSupport,this))},refresh:function(a){var b=this,d=a.shouldClearSelection?this.getPanelElement().find(".loading-message"):false,c=this.xhrCount=this.xhrCount+1;e.getJSONWrap({url:this._getUrlREST(),messageHandler:this.messenger,loadingElement:d,errorMessage:this.textErrorRetrieving,successCallback:function(d){if(c===b.xhrCount){a.data=d;b._onSuccessLoadFiles(a)}},errorCallback:l.bind(this._onErrorLoadFiles,this)})},_onSuccessLoadFiles:function(a){this.fileListView.resetFileList(a.data.attachment?
a.data.attachment:a.data.images,a)},_onErrorLoadFiles:function(){this._showErrorIconInMessageBox()},_showErrorIconInMessageBox:function(){var a=this.messenger.getMessageContainer().find("ul");a.toggleClass("one-message",a.find("li").length===1);a.closest(".aui-message").append("<span class='aui-icon icon-warning'></span>")},setUploadInProgress:function(a,b){this.eventListener.trigger("file.placeholder.process",a,b)},attachmentUploaded:function(a,b){this.eventListener.trigger("uploadingfile.completed",
a,b)},attachmentUploadingCancelled:function(a){this.eventListener.trigger("uploadingfile.cancelled",a)},_hasXhrSupport:function(){var a,b;try{a=new XMLHttpRequest;b=!(!a.sendAsBinary&&!a.upload)&&!(g.browser.mozilla&&g.browser.version.indexOf("1.9.1")>-1)}catch(d){b=false}return b},addPreviewImage:function(a){var b=require("tinymce");if(f.File&&f.FileReader&&f.FileList&&f.Blob){var d=this,b=b.isIE?1048576:5242880;a.isImage=a.nativeFile&&a.nativeFile.type&&this._isImageType(a.nativeFile.type);if(a.isImage&&
a.nativeFile.size<b){var c=new FileReader;c.onload=function(){d._addFilePlaceHolderToCollection(a,c.result)};c.readAsDataURL(a.nativeFile)}else this._addFilePlaceHolderToCollection(a,null)}},_addFilePlaceHolderToCollection:function(a,b){var d=null,c=this.collection.findWhere({fileName:a.name});if(c){this.collection.removeFile(c);c.get("isFilePlaceHolder")?c.get("previousUploadedFile")&&(d=c.get("previousUploadedFile")):d=c}d=new i({isFilePlaceHolder:true,fileName:a.name,fileId:a.id,fileNative:a.nativeFile,
url:b?b:"",isImage:a.isImage,niceType:a.isImage?"Image":"",fileType:a.nativeFile.type,thumbnailUrl:b?b:"",previousUploadedFile:d});this.collection.addFile(d)},_isImageType:function(a){return e.Confluence.FileTypesUtils.isImage(a)},_canAttachFiles:function(){return h.getBoolean("can-attach-files")},_getUrlREST:function(){var a=parseInt(h.get("attachment-source-content-id"),10);return e.REST.makeUrl("content/"+a+"/attachments.json")},focus:function(){this.collection.clearSelection()}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/attachments-panel/attachments-panel-view","Confluence.Editor.FileDialog.AttachmentsPanelView");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel.soy' */
// This file was automatically generated from external-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.webPanel = function(opt_data, opt_ignored) {
  return '<div class="insert-web-image"><form id="insert-web-image-form" action="#" class="aui"><fieldset class="inline"><div class="web-image-input"><label for="insert-web-image-image-url" id="insert-web-image-image-url-label">' + soy.$$escapeHtml("Image URL:") + '</label><input type="text" class="text image-url" id="insert-web-image-image-url" name="insert-web-image-image-url"></div><input type="submit" class="image-preview aui-button" value="' + soy.$$escapeHtml("Preview") + '"></fieldset></form><p class="faraway image-preview-area"></p><p class="hidden image-preview-error">' + soy.$$escapeHtml("This image couldn\x27t be loaded for preview. Please check the URL.") + '</p><p class="hidden image-preview-throbber">&nbsp;</p></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.webPanel.soyTemplateName = 'Confluence.Templates.File.webPanel';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel-view.js' */
define("confluence-editor/files/external-panel/external-panel-view",["confluence-editor/files/base-panel/base-panel-view","confluence/templates","jquery","raphael","ajs"],function(c,e,d,f,g){return c.extend({id:"external",panelId:"",cssPanel:".web-image-panel",cssContainer:".insert-web-image",textPanelTitle:"Images from the web",template:e.File.searchPanel,events:{"submit form":"_submit","keyup input.image-url":"_checkAllowInsert","click input.image-url":"_checkAllowInsert",
"blur input.image-url":"_checkAllowInsert"},initialize:function(){c.prototype.initialize.call(this);this.context=null;this.token=0},render:function(){this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"web-image-panel");this.container=this.getContainer();this.preview=this.container.find(".image-preview-area");this.throbber=this.container.find(".image-preview-throbber");this.killSpinner=null;this.error=this.container.find(".image-preview-error")},focus:function(){this._getImageInput().focus();
this._checkAllowInsert()},getPanel:function(){this.$el=d(e.File.webPanel());this.el=this.$el[0];this.delegateEvents();return this.el},_getImageInput:function(){return d("input.image-url",this.context.baseElement)},_submit:function(b){b.preventDefault();b.stopPropagation();var a=this,b=this._getImageInput().val();if("http://"===b)return!1;this.token++;var c=this.token;this.preview.addClass("faraway").html("");this.throbber.removeClass("hidden");this.killSpinner||(this.killSpinner=f.spinner(this.throbber[0],
60,"#666"));this.error.addClass("hidden");d("<img>").load(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.preview.removeClass("faraway");a._checkAllowInsert()}}).error(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.error.removeClass("hidden");a._checkAllowInsert()}}).appendTo(this.preview).attr("src",b)},_checkAllowInsert:function(){var b=this.$el.find("input.image-url").val();this.context.setSelectItems(""!==
b&&"http://"!==b?b:[])}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/external-panel/external-panel-view","Confluence.Editor.FileDialog.ExternalPanelView");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel.soy' */
// This file was automatically generated from search-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.searchPanel = function(opt_data, opt_ignored) {
  return '<div class="search-panel-wrapper"><div id="search-image"><form class="aui search-form" id="search-image-form" action="#"><fieldset class="inline"><div class="search-input"><label for="search-image" class="assistive">' + soy.$$escapeHtml("Search") + '</label><input autofocus type="text" class="text search-image-text" size="50" autocomplete="off"></div><select class="search-space select" id="search-image-space-select"><option value="">' + soy.$$escapeHtml("All Spaces") + '</option><option value="' + soy.$$escapeHtml(opt_data.spaceKey) + '">' + soy.$$escapeHtml(opt_data.spaceName) + '</option></select><button type="submit" class="aui-button search-button">' + soy.$$escapeHtml("Search") + '</button></fieldset></form></div><div id="searched-images" class="scroll-wrapper"><div class="loading-message hidden">' + soy.$$escapeHtml("Searching\u2026") + '</div><ul class="file-list"></ul></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.searchPanel.soyTemplateName = 'Confluence.Templates.File.searchPanel';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel-view.js' */
define("confluence-editor/files/search-panel/search-panel-view","confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-view confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/meta confluence/defaults confluence/highlighter underscore ajs jquery".split(" "),function(l,g,h,d,i,e,j,k,f,c,b){return d.extend({id:"search",panelId:"",cssPanel:".search-panel",cssContainer:"#searched-images",
template:i.File.searchPanel,events:{"submit form":"_submit"},initialize:function(){d.prototype.initialize.call(this);this.context=null;this.collection=new h;this.fileListView=new g({collection:this.collection})},getPanel:function(){this.$el=b(this.template({spaceKey:e.get("space-key"),spaceName:e.get("space-name")}));this.el=this.$el[0];this.delegateEvents();return this.el},render:function(){this.fileListView.updateDialogContext(this.context);this.panelId=this.context.addPanel("Search on other pages",
this.getPanel(),"search-panel");this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:"No search results found.",showContainerInfo:true})},_submit:function(a){a.preventDefault();a.stopPropagation();if(this._getQuery()){this.clearContainer();this.collection.reset();this._loadImages().then(f.bind(this._onSuccessLoadFiles,this),f.bind(this._onErrorLoadFiles,this))}},_loadImages:function(){return b.ajax({type:"GET",dataType:"json",url:c.contextPath()+
c.REST.getBaseUrl()+"search.json",data:{spaceKey:this.getForm().find(".search-space").val(),query:this._getQuery(),search:"name",type:"attachment",attachmentType:[],groupResults:true,maxResultsPerGroup:50,searchParentName:true,pageSize:j.maxResults}})},_onSuccessLoadFiles:function(a){var b={result:[]};a.result&&a.result.length>0?b=a:a.group&&a.group[0]&&(b=a.group[0]);this.fileListView.highlighter=new k(this._getQuery().split(" "));this.fileListView.resetFileList(b.result,{shouldClearSelection:true})},
_onErrorLoadFiles:function(){var a=this.getContainer();a.find(".loading-message").addClass("hidden");a.append(b("<p class='warning'>"+b(this.textErrorSearch).text()+"</p>"))},_getSearchText:function(){return b("input.search-image-text",this.getForm())},_getQuery:function(){return this._getSearchText().val()||""},focus:function(){this.collection.clearSelection();this._getSearchText().focus()}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/search-panel/search-panel-view","Confluence.Editor.FileDialog.SearchPanelView");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog.soy' */
// This file was automatically generated from file-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-59/Display+Files+and+Images") + '" target="_blank">' + soy.$$escapeHtml("Help") + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.helpLink.soyTemplateName = 'Confluence.Templates.File.helpLink';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog-view.js' */
define("confluence-editor/files/file-dialog/file-dialog-view","backbone ajs confluence/templates underscore jquery document window".split(" "),function(j,d,l,f,e,i,m){return j.View.extend({dialogId:"insert-image-dialog",ESC_KEY_CODE:27,width:840,height:530,initialize:function(a){this.urlExternalImg="";this.selectItems=[];this.submitCallback=a.submitCallback;this.cancelCallback=a.cancelCallback;this.beforeShowListeners=a.beforeShowListeners;this.panelComponents=a.panelComponents},render:function(){this._createDialog();
this.clearSelection();e(i).on("keydown.insert-image",f.bind(this._onNavigationByKey,this));return this},_createDialog:function(){var a=new d.Dialog(this.width,this.height,this.dialogId),n="Insert files and images",b="Insert";this.dialog=a;a.addHeader(n);a.addButton(b,f.bind(this._submitDialog,this),"insert");a.addCancel("Close",f.bind(this._killDialog,this));this.el=a.popup.element;this.$el=e(this.el);this.baseElement=this.el;
this.$el.attr("data-tab-default","0");this.$insertButton=this.$el.find(".dialog-button-panel .insert");e("#"+this.dialogId+" .dialog-components .dialog-title").prepend(l.File.helpLink());this.$el.find(".dialog-button-panel").append(e("<div></div>").addClass("dialog-tip").html("Hint: type \"\u003cstrong\u003e!\u003c/strong\u003e\" in the Editor to insert attached images on the page."));this._createPanels();e(i).on("hideLayer",f.bind(function(c,b,d){if(b==="popup"&&d===a.popup){d.remove();this.teardown();typeof this.cancelCallback==="function"&&this.cancelCallback()}},
this));d.bind("remove.dialog",f.bind(function(a,b){b.dialog.id===this.dialog.id&&this.teardown()},this));a.show();return a},_createPanels:function(){var a=this;e.each(this.panelComponents,function(){this&&typeof this.createPanel==="function"&&this.createPanel(a)});d.debug(this.beforeShowListeners.length+" beforeShow listeners registered.");e.each(this.beforeShowListeners,function(){typeof this==="function"&&this()})},teardown:function(){e(i).unbind(".insert-image");e(".tipsy").remove();this.undelegateEvents()},
_killDialog:function(){this.dialog.remove();this.clearSelection();typeof this.cancelCallback==="function"&&this.cancelCallback()},_submitDialog:function(){var a={url:this.urlExternalImg,contentId:d.Meta.get("attachment-source-content-id"),selectItems:this.selectItems};this.dialog.remove();typeof this.submitCallback==="function"&&this.submitCallback(a)},setSelectItems:function(a){if(typeof a==="string"){this.urlExternalImg=a;this.selectItems=[]}else{this.urlExternalImg="";this.selectItems=a}a=this.selectItems.length>
0||this.urlExternalImg;if(this.$insertButton){this.$insertButton.prop("disabled",!a);this.$insertButton.attr("aria-disabled",!a)}},clearSelection:function(){this.setSelectItems([])},insert:function(){this.$insertButton&&(!this.$insertButton.is(":disabled")||!this.$insertButton.attr("aria-disabled"))&&this.$insertButton.click()},addPanel:function(a,d,b,c){var e=this.dialog.getPage(0).panel.length;this.dialog.addPanel(a,d,b,c);return e},getPanel:function(a){return this.dialog.getPanel(a)},_onNavigationByKey:function(a){if(!e("#"+
this.dialog.id).is(":hidden")){var f=this.dialog.getCurrentPanel().body,b=f.find(".attached-file");if(!(b.length===0||e(i.activeElement).is("input[type=text], select, button"))){var c=m.tinymce.VK;switch(a.which){case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:var k=a.which,g;g=b.filter(".current");g.length||(g=b.filter(".selected"));if(g.length){g=b.index(g);var j=b.length,h={};h[c.LEFT]=-1;h[c.RIGHT]=1;h[c.UP]=-4;h[c.DOWN]=4;c=g+(h[k]?h[k]:0);b=b.eq(c<0||c>=j?g:c)}else b=b.first();b.parent().find("li.attached-file.current").removeClass("current");
b.addClass("current");b.length&&f.find(".scroll-wrapper").simpleScrollTo(b);return d.stopEvent(a);case c.SPACEBAR:f.find("li.attached-file.current").click();return d.stopEvent(a);case c.ENTER:this.insert();return d.stopEvent(a)}}}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-dialog/file-dialog-view","Confluence.Editor.FileDialog.FileDialogView");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-resolver.js' */
define("confluence-ui-components/js/internal/space-resolver",["underscore","jquery","ajs"],function(i,b,h){var g={conf_all:"All spaces",conf_current:"Current space",conf_favorites:"Favourite spaces",conf_global:"Site spaces",conf_personal:"Personal spaces"};function e(j){var k=i.map(j,function(l){return"spaceKey="+encodeURI(l)});return k.join("&")}function f(k,l){var j=typeof l==="undefined";var m=i.escape(j?k:l);return{id:k,text:m,idOnly:j}}function a(m,p){var n={};var o=[];i.each(m,function(r){var q=d(r);if(q){n[r]=f(r,q)}else{o.push(r)}});var k;if(o.length){var l=h.contextPath()+"/rest/api/space?"+e(o);k=b.getJSON(l)}else{k=new b.Deferred();k.resolve({results:[]})}function j(r){var q=r.results;i.each(q,function(t){n[t.key]=f(t.key,t.name)});var s=i.map(m,function(t){return n[t]||f(t)});p(s)}k.done(j)}function d(j){return g[j]}var c=["conf_favorites","conf_global","conf_personal"];return{getSpaceDisplayItems:a,getSpaceCategoryDisplayName:d,getSpaceTypeKeys:function(){return c}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/space-picker.js' */
define("confluence-ui-components/js/space-picker",["underscore","ajs","jquery","confluence-ui-components/js/internal/space-resolver"],function(r,f,b,d){var a={data:null,suggestCategories:null};var p=function(s){return function(t){var u={id:t.spaceKey,text:t.spaceName};if(typeof s==="function"){return s(u)}return u}};var k;var c=function(s){return function(t,x){var w=b(t).val();if(w===""){return}var u=w.split(",");function v(y){if(!s.multiple){y=y[0]}x(y)}d.getSpaceDisplayItems(u,v)}};var e=function(t){var s;if(t.suggestCategories){var u={text:"Select a suggestion or type to search",children:r.map(t.suggestCategories,function(v){return{id:v,text:d.getSpaceCategoryDisplayName(v)}})}}return function(w){if(s){w.callback(s);return}function v(x){var y={results:[]};if(u){y.results.push(u)}if(x.length>0){y.results.push({text:"Suggested spaces",children:r.map(x,function(z){return{id:z.key,text:r.escape(z.name)}})})}s=y;w.callback(s)}b.getJSON(f.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(v).fail(function(){f.log("Couldn't fetch recent spaces");var x={results:[]};if(u){x.results.push(u)}w.callback(x)})}};var n=function(){return window.Select2.query.ajax({url:f.contextPath()+"/rest/quicknav/1/search?type=spacedesc&type=personalspacedesc",data:function(s){return{query:s,maxPerCategory:25}},quietMillis:250,results:function(u){var t=u.contentNameMatches;if(t.length<=1){return{results:[]}}else{var s=r.map(t[0],k);return{results:[{text:"Search results",children:s}]}}}})};function g(t){var s=n();var u=e(t);return function(v,x,w){if(v.term.length<2){return u(v)}else{if(typeof x==="function"){v.term=x(v.term)}k=p(w);return s(v)}}}function h(){var s=b(".select2-container-active").next("input");var t=s.val().trim();return(t!=="")?t.split(","):[]}function i(s){var t=r.intersection(s,d.getSpaceTypeKeys());return t.length>0}function j(s){return(typeof s.id!=="undefined")&&r.contains(d.getSpaceTypeKeys(),s.id)}function q(t,u,v){var s=[];t.forEach(function(w){if(w.children){var x=q(w.children,u,v);if(x.length){s.push(b.extend({},w,{children:x}))}}else{var y=j(w);if((u&&y)||(!u&&!y)){if(!r.contains(v,w.id)){s.push(w)}}}});return s}function m(t,v){if(!t.length||!v.length){return t}var u=i(v);var s=q(t,u,v);if(!s.length){s.push({text:"Can\'t filter by space types AND spaces",disabled:true})}return s}function o(s){var t=h();return m(s,t)}function l(t){t=r.extend({},a,t);var s={placeholder:"Select a space",formatResult:function(u,v,w){v.attr("title",b("<div/>").html(u.text).text());return b.fn.select2.defaults.formatResult.apply(this,arguments)},escapeMarkup:function(u){return u},multiple:t.multiple===true};if(t.disableMixedSpaceTypes){s.sortResults=o}if(t.data){return r.extend(s,{data:t.data})}else{return r.extend(s,{initSelection:c(t),query:g(t)})}}return{build:l,filterMixedTypesForValues:m}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-picker-legacy.js' */
window.Confluence.UI.Components.SpacePicker=require("confluence-ui-components/js/space-picker");AJS.deprecate.prop(window.Confluence.UI.Components.SpacePicker,"build",{sinceVersion:"1.4.22",extraInfo:"Use require('confluence-ui-components/js/space-picker')"});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/space-page-picker.js' */
(function(i,c){var t={conf_all:"All spaces",conf_favorites:"Favourite spaces",conf_global:"Site spaces",conf_personal:"Personal spaces",conf_current:"Current space"};var b={data:null,suggestCategories:null};var v="SPACE-PAGE-TRIGGER-VALUE";var f={placeholder:"Select a space or page",multiple:true,formatInputTooShort:function(){return "Start typing to search"},formatResult:function(G,I,L){if(G.children){I.addClass("space-page-picker-result-category");return i.fn.select2.defaults.formatResult.apply(this,arguments)}else{if(G.id){I.attr("title",G.text);I.addClass("space-page-picker-result-label-with-icon");var F=i("<span/>").addClass(G.className+" item-text").html(i.fn.select2.defaults.formatResult.apply(this,arguments));var K=(G.subText)?i("<span/>").addClass("space-name").html(G.subText):i("");var H=i("<span/>").attr(s(G.id),G.id).append(F).append(K);var J=i("<span/>").append(H);return J}else{I.addClass(G.className);return i.fn.select2.defaults.formatResult.apply(this,arguments)}}},formatSelection:function(G,H){H.addClass("space-page-picker-selected-item");H.attr("title",G.text);var F=i("<span/>").attr(s(G.id),G.id).addClass(G.className+" item-text").html(i.fn.select2.defaults.formatSelection.apply(this,arguments));H.append(F)},escapeMarkup:function(F){return F},formatResultCssClass:function(F){return(F.children||F.id)?"":"select2-result-space-page-separator"},containerCssClass:"space-page-picker-container",dropdownCssClass:"space-page-picker-drop"};var B=function(F,H){var G=F.data("select2").opts.manualInit;if(G===true){return}d(F.val(),F,H)};function r(H,G,F){var I=_.map(H,function(J){return G[J]});return(F)?I:((I.length>0)?I[0]:null)}var l=function(F){var G;if(F.suggestCategories){var H={text:"Suggested categories",children:_.map(F.suggestCategories,function(I){return o(I)})}}return function(J){if(G){J.callback(G);return}var I=[];G={results:[]};if(x(F)){var L=i.getJSON(AJS.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(function(M){var N=(H)?[H]:[];(M.length>0)&&N.push({text:"Suggested spaces",children:_.map(M,function(O){return m(O.key,_.escape(O.name),null,true)})});(N.length>0)&&(G.results=G.results.concat(N))}).fail(function(){AJS.debug("Couldn't fetch recent spaces");var M=(H)?[H]:[];(M.length>0)&&(G.results=G.results.concat(M))});I.push(L)}if(j(F)){var K=i.getJSON(AJS.contextPath()+"/rest/recentlyviewed/1.0/recent/pages",{noTrashedContent:true}).done(function(M){if(M.length>0){G.results.push({text:"Suggested pages",children:_.map(M,function(N){return h(N.id,_.escape(N.title),_.escape(N.space),"content-type-page",true)})})}}).fail(function(){AJS.debug("Couldn't fetch recent pages")});I.push(K)}i.when.apply(i,_.map(I,function(N){var M=i.Deferred();N.always(function(){M.resolve()});return M})).done(function(){if(G.results.length===0){G.results=[{text:"",children:[]}]}J.callback(G)})}};var w=function(F){var G="";if(!F||F.length===2&&F.indexOf("space")>=0&&F.indexOf("page")>=0){G="type=spacedesc&type=personalspacedesc&type=page"}else{if(F.length===1&&F[0]==="space"){G="type=spacedesc&type=personalspacedesc"}else{if(F.length===1&&F[0]==="page"){G="type=page"}else{return}}}return window.Select2.query.ajax({url:AJS.contextPath()+"/rest/quicknav/1/search?"+G,data:function(H,I){return{query:H,maxPerCategory:25}},quietMillis:250,results:function(K,O){var N=K.contentNameMatches;if(N.length<=1){return{results:[]}}else{var P=[];var I=function(Q){return E(Q.spaceKey,Q.spaceName,Q.id,Q.name,Q.className)};for(var L=0;L<N.length-1;L++){var M=[];for(var J=0;J<N[L].length;J++){var H=I(N[L][J]);if(H){M.push(H)}}if(M.length>0){P=P.concat(M);P.push({id:"",text:"",subText:"",className:"",disabled:true})}}return{results:[{text:"Search results",children:P}]}}}})};var p=function(G){var F=w(G.contentType);var H=l(G);return function(I){if(I.term.length<2){H(I)}else{F(I)}}};function s(F){return(F.indexOf("page:")===0)?"data-item-id":"data-item-key"}function m(F,I,G,H){G=(G)?G:((F.indexOf("~")===0)?"content-type-personalspacedesc":"content-type-spacedesc");return e("space",F,I,"",G,H)}function o(F){var G=t[F];return e("space-cat",F,G,"","content-type-space-category",G)}function h(J,I,F,G,H){return e("page",J,I,F,G,H)}function e(L,I,K,H,G,J){var F=y(L,I);K=(!K)?I:K;G=(J)?G:(G+" content-not-found");return{id:F,text:K,subText:H,className:G,disabled:(J?false:true)}}function C(F){return"space-cat:"+F}function a(F){return"space:"+F}function D(F){return"page:"+F}function E(J,G,K,H,I){var F;if(I==="content-type-spacedesc"||I==="content-type-personalspacedesc"){F=m(J,G,I,true)}else{if(I==="content-type-page"){F=h(K,H,G,I,true)}}return F}function y(){var F=Array.prototype.slice.apply(arguments);return F.join(":")}function x(F){return((!F.contentType||F.contentType.length===0||F.contentType.indexOf("space")>=0)&&F.showRecentlyViewedSpaces!==false)}function j(F){return((!F.contentType||F.contentType.length===0||F.contentType.indexOf("page")>=0)&&F.showRecentlyViewedPages!==false)}function n(G,F){var H=q("SpaceCat",G,F.inputSpaceCatId,(F.inputSpaceCatName)?F.inputSpaceCatName:F.inputSpaceCatId);return u(G,H.id,H.name)}function g(G,F){var H=q("Space",G,F.inputSpaceId,(F.inputSpaceName)?F.inputSpaceName:F.inputSpaceId);return u(G,H.id,H.name)}function z(G,F){var H=q("Page",G,F.inputPageId,(F.inputPageName)?F.inputPageName:F.inputPageId);return u(G,H.id,H.name)}function q(J,H,K,G){var F;if(!K){F=H.attr("id");if(!F){return null}K=F+J}if(!G){var I=H.attr("name")||F;G=I+J}return{id:K,name:G}}function u(G,I,F){var H=i("#"+I);if(H.length===0){H=i(Confluence.UI.Components.templates.hiddenField({id:I,name:F}));G.after(H)}return H}function k(G,I,H){if(!G){return}var F=_.filter(I,function(J){return J.indexOf(H)===0});F=_.map(F,function(J){return J.substring(H.length,J.length)});G.val(F.join(","))}function A(M,H,I,F){I=(I)?(_.isArray(I)?I:I.split(",")):[];F=(F)?F.split(","):[];var L=_.union(I,F);var G=_.map(L,function(O){return H+O});var J=M.val();var N=J?J.split(","):[];var K=_.union(N,G);if(K.length>0){M.val(K.join(","))}}c.build=function(G){var F=_.extend({},b,f,G);if(!G.data){F=_.extend({},{initSelection:B,query:p(F)},F)}var H=i(F.orgElement);if(!H||H.length!==1){return F}if(!H.val()&&!F.manualInit){H.val(v)}H.addClass("select2-input");return F};c.setValue=function(G,F){d(G,F,function(H){F.auiSelect2("data",H)})};function d(P,G,S){var U=G.data("select2").opts;var Q=U.placeholder||G.data("placeholder");var K=n(G,U);var M=g(G,U);var I=z(G,U);G.on("change",function(V){k(K,V.val,"space-cat:");k(M,V.val,"space:");k(I,V.val,"page:")});G.val("");var T=(G["0"].tagName==="SELECT")?(G.context.multiple):(U.multiple);var N=[];var R=[];var L=[];var F={};var H=(P)?P.split(","):[];H=_.filter(H,function(V){var W=V.split(":");if(W.length===2){return true}else{if(W.length<0||W.length>=3||(W.length===1&&(W[0]!==v&&W[0]!==Q))){AJS.debug("Error value: "+W)}}});P=H.join(",");G.val(P);A(G,"space-cat:",U.spaceCatKeys,(K)?K.val():"");A(G,"space:",U.spaceKeys,(M)?M.val():"");A(G,"page:",U.pageIds,(I)?I.val():"");P=G.val();H=(P)?P.split(","):[];k(K,H,"space-cat:");k(M,H,"space:");k(I,H,"page:");if(H.length===0){return}_.each(H,function(V,W){var Z=V.split(":");if(Z.length===2){var Y=Z[0];var X=Z[1];if(Y==="space-cat"){N.push(X)}else{if(Y==="space"){R.push(X)}else{if(Y==="page"){L.push(X)}}}}});_.each(N,function(V){F[C(V)]=o(V)});var O=[];if(R.length>0){var J=i.getJSON(AJS.contextPath()+"/rest/prototype/1/space",{spaceKey:R}).done(function(X){var V=[];_.each(X.space,function(Y){F[a(Y.key)]=m(Y.key,_.escape(Y.name),null,true);V.push(Y.key)});var W=_.difference(R,V);_.each(W,function(Y){F[a(Y)]=m(Y,Y,null,false)})}).fail(function(){AJS.debug("Couldn't resolve spaceKeys:",R);_.each(R,function(V){F[a(V)]=m(V,V,null,false)})});O.push(J)}_.each(L,function(V){var W=i.getJSON(AJS.contextPath()+"/rest/api/content/"+V,{expand:"space"}).done(function(X){F[D(X.id)]=h(X.id,_.escape(X.title),_.escape(X.space.name),"content-type-page",true)}).fail(function(){AJS.debug("Couldn't resolve pageId:",V);F[D(V)]=h(V,V,"","content-type-page",false)});O.push(W)});i.when.apply(i,_.map(O,function(W){var V=new i.Deferred();W.always(function(){V.resolve()});return V.promise()})).done(function(){S(r(H,F,T))})}}(AJS.$,window.Confluence.UI.Components.SpacePagePicker));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/soy/space-page-picker.soy' */
// This file was automatically generated from space-page-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.templates == 'undefined') { Confluence.UI.Components.templates = {}; }


Confluence.UI.Components.templates.hiddenField = function(opt_data, opt_ignored) {
  return '<input type="hidden" id="' + soy.$$escapeHtml(opt_data.id) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" />';
};
if (goog.DEBUG) {
  Confluence.UI.Components.templates.hiddenField.soyTemplateName = 'Confluence.UI.Components.templates.hiddenField';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/page-picker.js' */
(function(b,a){a.build=function(c){c.placeholder="Select a page";c.contentType=["page"];c.showRecentlyViewedSpaces=false;c.spaceCatKeys=[];c.spaceKeys=[];return window.Confluence.UI.Components.SpacePagePicker.build(c)}}(AJS.$,window.Confluence.UI.Components.PagePicker));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/label-picker.js' */
define("confluence-ui-components/js/label-picker",["ajs","confluence/legacy","jquery","underscore"],function(g,i,e,j){var a=/[;,\.\?&\[\(\)#\^\*@!<>\]]/g;function l(m){var n=j.uniq(m.match(a));return n.join(" ")}function b(m){return{id:m.name,text:m.name}}function c(m){if(!m||!m.length){return null}var n=j.map(m,b);return j.sortBy(n,function(o){return o.text.toLowerCase()})}function k(o){var n=o.contentNameMatches;var p=c(n[0]);var m=c(n[1]);if(p&&m){return[{text:"Suggested",children:p},{text:"Other",children:m}]}return p||m||[]}function f(m){return function(n){return e.extend({query:n,ignoreRelated:true,maxResults:10},m)}}var d={placeholder:"Add labels",multiple:true,minimumInputLength:1,maximumSelectionSize:20,tokenSeparators:[" ",","],formatInputTooShort:function(n,m){return "Start typing to search for a label"},formatSelectionTooBig:function(m){return g.format("You can only input {0} labels",m)},formatResult:function(m){return i.UI.Components.LabelPicker.templates.labelResult({label:{labelName:m.text,isNew:m.isNew}})},formatNoMatches:function(n){var m=l(n);if(m){return i.UI.Components.LabelPicker.templates.labelInvalid({inputValue:n,invalidCharacters:m})}return this.noMatches},createSearchChoice:function(n){if(!n){return null}var m=l(n);if(m){return null}return{id:n,text:n,isNew:true}},ajax:{data:f(),dataType:"json",url:i.getContextPath()+"/labels/autocompletelabel.action",results:function(m){return{results:k(m)}},quietMillis:300},dropdownCssClass:"labels-dropdown",containerCssClass:"labels-autocomplete",initSelection:function(m,p){var o=m.val().split(",");var n=j.map(o,function(q){return{id:q,text:q}});p(n)}};function h(n){var m=e.extend({},d,n);if(n&&n.queryOpts){m.ajax.data=f(n.queryOpts);delete m.queryOpts}if(!n||!n.noMatches){m.noMatches=m.placeholder}return m}return{build:h}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/label-picker-legacy.js' */
window.Confluence.UI.Components.LabelPicker=require("confluence-ui-components/js/label-picker");AJS.deprecate.prop(window.Confluence.UI.Components.LabelPicker,"build",{sinceVersion:"1.4.18",extraInfo:"Use require('confluence-ui-components/js/label-picker')"});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/soy/label-picker.soy' */
// This file was automatically generated from label-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.LabelPicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.LabelPicker == 'undefined') { Confluence.UI.Components.LabelPicker = {}; }
if (typeof Confluence.UI.Components.LabelPicker.templates == 'undefined') { Confluence.UI.Components.LabelPicker.templates = {}; }


Confluence.UI.Components.LabelPicker.templates.labelResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format("\x22{0}\x22 - add a new label",opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelResult.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelResult';
}


Confluence.UI.Components.LabelPicker.templates.labelInvalid = function(opt_data, opt_ignored) {
  var output = '';
  var inputValueHtml__soy9 = '<b>' + soy.$$escapeHtml(opt_data.inputValue) + '</b>';
  var invalidCharactersHtml__soy13 = '<b>' + soy.$$escapeHtml(opt_data.invalidCharacters) + '</b>';
  output += soy.$$filterNoAutoescape(AJS.format("{0} contains invalid characters {1}",inputValueHtml__soy9,invalidCharactersHtml__soy13));
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelInvalid.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelInvalid';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:include-exclude-picker', location = '/js/include-exclude-picker.js' */
define("confluence-ui-components/js/include-exclude-picker",["jquery","underscore"],function(d,j){var e="";function c(k){var l=k.charAt(0);if(j.contains(["-"],l)){e=l;k=k.substring(1)}else{e=""}return k}function h(k){var l=d.extend({},k);if(l.children){l.children=j.map(l.children,h)}else{l.id=e+l.id;l.text=e+l.text}return l}function b(k){return function(l){l=c(l);return k(l)}}function f(k){return function(m){var l=k?k(m):m;if(e){l.results=j.map(l.results,h)}return l}}function a(k){return function(l){return k(l,c,h)}}function g(k){var l=k.text.charAt(0);if(l==="-"){return"select2-search-choice-subtle"}return}function i(l){var k=d.extend({formatSelectionCssClass:g},l);if(k.query){k.query=a(k.query);return k}else{k.ajax=d.extend({},k.ajax);k.ajax.data=b(k.ajax.data);k.ajax.results=f(k.ajax.results);return k}}return{build:i}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/js/user-group-select2.js' */
define("confluence-ui-components/js/user-group-select2",["ajs","confluence/legacy","jquery"],function(a,d,b){function c(f){f=f||document.body;var e=function(){var g=b(".select2-drop-active > .select2-results");if(g.children(".select2-result-selectable").length===0&&g.children(".select2-disabled").length){g.append('<li class="select2-no-results">'+a.escapeHtml("No matches found")+"</li>")}};b("input.autocomplete-multiusergroup[data-autocomplete-bound != 'true']",f).each(function(){var g=b(this);g.attr("data-autocomplete-bound","true");var h=g.attr("data-include-groups");g.auiSelect2({multiple:true,minimumInputLength:2,formatInputTooShort:function(){return h?"Start typing to search for a user or group":"Start typing to search for a user"},ajax:{transport:function(l){var m=l.success;delete l.success;return b.ajax.apply(b.ajax,arguments).done(m).done(e)},data:function(l){return{"max-results":6,query:l}},dataType:"json",url:d.getContextPath()+"/rest/prototype/1/search/user"+(h?"-or-group":"")+".json",results:function(m){var l=[];b.each(m.result,function(){if(this.type=="user"){l.push({id:this.username,text:this.title,imgSrc:this.thumbnailLink.href,entity:this})}else{l.push({id:this.name,text:this.name,imgSrc:a.contextPath()+"/images/icons/avatar_group_48.png",entity:this})}});return{results:l}},quietMillis:300},formatResult:function(l){return d.UI.Components.UserGroupSelect2.avatarWithName({size:"small",displayName:l.text,userId:l.id,avatarImageUrl:l.imgSrc})},escapeMarkup:function(l){return l},formatSelection:function(l){return d.UI.Components.UserGroupSelect2.avatarWithName({size:"xsmall",displayName:l.text,userId:l.id,avatarImageUrl:l.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:true});if(!g.data("autofill-user")){return}var k=a.Meta.get("remote-user"),j=a.Meta.get("current-user-fullname"),i=a.Meta.get("current-user-avatar-url");if(k&&j&&i){g.auiSelect2("data",[{id:k,text:j,imgSrc:a.contextPath()+i}])}})}return{bind:c}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/soy/user-group-select2.soy' */
// This file was automatically generated from user-group-select2.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.UserGroupSelect2.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.UserGroupSelect2 == 'undefined') { Confluence.UI.Components.UserGroupSelect2 = {}; }


Confluence.UI.Components.UserGroupSelect2.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  Confluence.UI.Components.UserGroupSelect2.avatarWithName.soyTemplateName = 'Confluence.UI.Components.UserGroupSelect2.avatarWithName';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-component.soy' */
// This file was automatically generated from cql-component.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.Templates == 'undefined') { Confluence.UI.Components.CQL.Templates = {}; }


Confluence.UI.Components.CQL.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-container"><div class="cql-error-container"></div><div class="cql-fields"></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.Templates.container';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-field.soy' */
// This file was automatically generated from cql-filter-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQLFilters.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQLFilters == 'undefined') { Confluence.UI.Components.CQLFilters = {}; }
if (typeof Confluence.UI.Components.CQLFilters.Templates == 'undefined') { Confluence.UI.Components.CQLFilters.Templates = {}; }


Confluence.UI.Components.CQLFilters.Templates.baseFilterField = function(opt_data, opt_ignored) {
  var output = '<div class="cql-filter cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + ' cql-type-' + soy.$$escapeHtml(opt_data.field.uiSupport.valueType) + '">';
  var id__soy8 = 'cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + '-' + soy.$$escapeHtml(opt_data.counter);
  output += '<div class=\'cql-field-heading\'><label for="' + soy.$$escapeHtml(id__soy8) + '">' + soy.$$escapeHtml(opt_data.label) + ((! opt_data.field.fixed) ? '<span class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml("Remove filter") + '"></span>' : '') + '</label></div><div class=\'cql-filter-field-input-container\'><input type="text" class="cql-field-input text" id="' + soy.$$escapeHtml(id__soy8) + '"></div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQLFilters.Templates.baseFilterField.soyTemplateName = 'Confluence.UI.Components.CQLFilters.Templates.baseFilterField';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-select.soy' */
// This file was automatically generated from cql-filter-select.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.FilterSelect.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect == 'undefined') { Confluence.UI.Components.CQL.FilterSelect = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect.Templates == 'undefined') { Confluence.UI.Components.CQL.FilterSelect.Templates = {}; }


Confluence.UI.Components.CQL.FilterSelect.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-add-filter-container"><button type="button" class="aui-button aui-button-link">' + soy.$$escapeHtml("Add a filter") + '</button><div class="input-wrapper hidden"><input class="select2-input" type="text" /></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.FilterSelect.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.FilterSelect.Templates.container';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/date-picker.soy' */
// This file was automatically generated from date-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.DatePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.DatePicker == 'undefined') { Confluence.UI.Components.DatePicker = {}; }
if (typeof Confluence.UI.Components.DatePicker.templates == 'undefined') { Confluence.UI.Components.DatePicker.templates = {}; }


Confluence.UI.Components.DatePicker.templates.input = function(opt_data, opt_ignored) {
  return '<div class="aui-navgroup-vertical"><ul class="aui-nav"><li class="aui-nav-selected"><a data-value="">' + soy.$$escapeHtml("Any date") + '</a></li><li><a data-value="now(\'-1d\')">' + soy.$$escapeHtml("Last 24 hours") + '</a></li><li><a data-value="now(\'-1w\')">' + soy.$$escapeHtml("Last week") + '</a></li><li><a data-value="now(\'-1M\')">' + soy.$$escapeHtml("Last month") + '</a></li><li><a data-value="now(\'-1y\')">' + soy.$$escapeHtml("Last year") + '</a></li><li><a data-value="custom">' + soy.$$escapeHtml("Custom") + '</a><span class="absolute-date-pickers"><input class="from-date-picker text" type="date" /><span>&ndash;</span><input class="to-date-picker text" type="date" /></span></li></ul></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.DatePicker.templates.input.soyTemplateName = 'Confluence.UI.Components.DatePicker.templates.input';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-type-picker.soy' */
// This file was automatically generated from cql-type-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.TypePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker == 'undefined') { Confluence.UI.Components.CQL.TypePicker = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker.templates == 'undefined') { Confluence.UI.Components.CQL.TypePicker.templates = {}; }


Confluence.UI.Components.CQL.TypePicker.templates.suggestions = function(opt_data, opt_ignored) {
  var output = '<div class="aui-navgroup-vertical"><ul class="aui-nav">';
  var typeList4 = opt_data.types;
  var typeListLen4 = typeList4.length;
  for (var typeIndex4 = 0; typeIndex4 < typeListLen4; typeIndex4++) {
    var typeData4 = typeList4[typeIndex4];
    output += '<li ' + ((typeIndex4 == 0) ? ' class="aui-nav-selected"' : '') + '><a data-value="' + soy.$$escapeHtml(typeData4.type) + '">' + soy.$$escapeHtml(typeData4.label) + '</a></li>';
  }
  output += '<li><a data-value="custom">' + soy.$$escapeHtml("Custom") + '</a></li></ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.TypePicker.templates.suggestions.soyTemplateName = 'Confluence.UI.Components.CQL.TypePicker.templates.suggestions';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-space-field.soy' */
// This file was automatically generated from cql-space-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.SpaceField.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField == 'undefined') { Confluence.UI.Components.CQL.SpaceField = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField.templates == 'undefined') { Confluence.UI.Components.CQL.SpaceField.templates = {}; }


Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption = function(opt_data, opt_ignored) {
  return '<span><input type="checkbox" value="true" id="search-filter-include-archived" name="includeArchivedSpaces"><label for="search-filter-include-archived">Search archived spaces</label></span>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption.soyTemplateName = 'Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-special-spaces.js' */
define("confluence-ui-components/js/cql/internal/cql-special-spaces",["underscore"],function(c){var b={conf_current:"currentSpace()",conf_favorites:"favourite",conf_global:"global",conf_personal:"personal"};var f=c.invert(b);function d(g){if(g==="search-screen"){return c.omit(b,"conf_current")}return b}function a(g){return c.keys(d(g))}function e(g){return f[g]}return{getMap:d,getKeys:a,getUIValue:e}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ajax.js' */
define("confluence-ui-components/js/cql/internal/cql-ajax",["jquery","underscore","ajs"],function(d,c,b){var g;function f(){if(!g){g=d.Deferred();var i=function(k){var l=c.values(k);if(!l.length){throw Error("Unknown CQL field data returned from server - cannot initialise CQL fields.")}var j=c.union.apply(c,l);j=c.sortBy(j,"fieldName");g.resolve(j)};var h=function(){g.reject()};d.getJSON(b.contextPath()+"/rest/cql/fields?filter=withUiSupport").done(i).fail(h)}return g.promise()}function e(h){return d.getJSON(b.contextPath()+"/rest/cql/expressions?cql="+encodeURIComponent(h))}function a(){return d.getJSON(b.contextPath()+"/rest/cql/contenttypes")}return{getFields:f,parseClauses:e,getContentTypes:a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-date-picker",["ajs","jquery"],function(a,b){function c(k){var h=b(Confluence.UI.Components.DatePicker.templates.input());var d=h.find(".aui-nav li");var g=h.find(".absolute-date-pickers").hide();var f=h.find(".from-date-picker");var i=h.find(".to-date-picker");var e=function(){};this.onChange=function(l){e=l;f.change(l);i.change(l)};h.on("click",".aui-nav a",function(){var l=d.filter("li.aui-nav-selected");var m=b(this).closest("li");if(l[0]!=m[0]){d.not(m).removeClass("aui-nav-selected");m.addClass("aui-nav-selected");e()}if(b(this).data("value")==="custom"){g.slideDown("fast")}else{g.slideUp("fast")}});var j={overrideBrowserDefault:true};a.DatePicker(f,j);a.DatePicker(i,j);f.attr("placeholder","From");i.attr("placeholder","To");k.replaceWith(h);return{getSelectedOption:function(){var l=d.filter(".aui-nav-selected").find("a");return l.data("value")},selectOption:function(m){var l=d.find('a[data-value="'+m+'"]');l.click()},getFromDate:function(){return f.val()},getToDate:function(){return i.val()},setFromDate:function(l){f.val(l);d.find("a[data-value='custom']").click()},setToDate:function(l){i.val(l);d.find("a[data-value='custom']").click()}}}return{build:c}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-type-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-type-picker",["jquery","underscore","ajs","confluence-ui-components/js/cql/internal/cql-ajax","confluence-ui-components/js/include-exclude-picker","confluence/legacy","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(e,j,g,a,c,i,f){var b;var d=[];function k(l){d=j.map(l,function(m){return{id:m.type,text:m.label}})}function h(m){var r,l,o,q=[];if(!b){b=a.getContentTypes();b.done(k)}b.done(function(){if(m.length){var s=j.pluck(d,"id");q=[].concat(d);m.forEach(function(t){if(t.type!==""&&!j.contains(s,t.type)){q.push({id:t.type,text:t.label})}})}else{q=d}});var p={query:function(s,v,u){v(s.term);var t=window.Select2.query.local({results:j.map(q,u)});t(s)},initSelection:function(t,w){var s=t.val().split(",");var v="";var u=j.map(s,function(x){var y=x.charAt(0);if(y==="-"){v="-";return x.substring(1)}return x});b.done(function(){var x=j.filter(q,function(y){return j.contains(u,y.id)});w(j.map(x,function(y){return{id:v+y.id,text:v+y.text}}))})},multiple:true,placeholder:"All content types"};function n(s){r=s;if(g.trace){r.on("change",function(){g.trace("type.field.changed")})}if(m.length){var t=e(i.UI.Components.CQL.TypePicker.templates.suggestions({types:m}));l=t.find(".aui-nav li");r.before(t);t.on("click",".aui-nav a",function(){var x=e(this).closest("li");var w=l.filter(".aui-nav-selected");if(x[0]===w[0]){return}w.removeClass("aui-nav-selected");x.addClass("aui-nav-selected");var v=e(this).attr("data-value");if(v=="custom"){o.slideDown("fast")}else{o.hide()}var u=true;r.select2("val",[v],u)})}r.auiSelect2(c.build(p));if(m.length){o=r.closest(".cql-filter").find(".select2-container");o.hide()}}return{setupInput:n,setValues:function(s){if(l){if(s.length==1){var u=l.find('[data-value="'+s[0]+'"]').parent();l.not(u).removeClass("aui-nav-selected");u.addClass("aui-nav-selected")}else{if(s.length>1){var u=l.find('[data-value="custom"]').parent();l.not(u).removeClass("aui-nav-selected");u.addClass("aui-nav-selected");o.show()}}}var t=e.Deferred();b.done(function(){f.setValues(r,s).done(function(){t.resolve()})});return t}}}return{build:h}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-field-model.js' */
define("confluence-ui-components/js/cql/internal/cql-field-model",[],function(){function a(b){return b.uiSupport.label.translation}return{getLabel:a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-adjuster.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-adjuster",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(c,a){function b(f){var e=f.functionValues;if(!e||!e.length){return f}var d=[];c.each(e,function(g){if(g.functionName==="currentSpace"){d.push(a.getUIValue("currentSpace()"))}else{throw new Error(g.functionName+" is not a known function")}});f.values=d.concat(f.values);return f}return{convertFunctionValues:b}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-autocomplete-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field",["jquery","ajs","confluence/legacy","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(d,h,j,b,f){function k(m){var n=m.suggestedResults;var l=m.searchResults;if(!n.length){return l}if(!l.length){return n}return[{text:"Suggestions",children:n},{text:"Search results",children:l}]}function a(l){return{query:l,searchContext:JSON.stringify({spaceKey:h.Meta.get("space-key"),contentId:h.Meta.get("content-id")})}}var c={placeholder:"Start typing to search",multiple:true,tokenSeparators:[" ",","],createSearchChoice:function(l){if(!l){return null}return{id:l,text:"New result: "+l,isNew:true}},createSearchChoicePosition:"bottom",ajax:{data:a,results:function(l){return{results:k(l)}},quietMillis:300},initSelection:function(l,o){var n=l.val().split(",");var m=n.map(function(p){return{id:p,text:p}});o(m)}};function e(l){return l.indexOf("http://")===0||l.indexOf("https://")===0}function g(l){if(e(l)){return l}else{return j.getContextPath()+l}}function i(l){var m;return{setupInput:function(n){m=n;var p=d.extend({},c.ajax,{url:g(l.uiSupport.dataUri)});var o=d.extend({},c,{ajax:p});n.auiSelect2(o)},asCqlFunc:function(){var n=this.input.val().trim();if(!n){return undefined}return b.buildEqualityExpressionFromValuesString(this.fieldName,n)},setValues:function(n){return f.setValues(m,n.values)}}}return{build:i,_getUrl:g,_ajaxData:a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-content-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field",["jquery","confluence-ui-components/js/page-picker","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(c,f,a,b){function d(g){return"page:"+g}function e(){var g;return{setupInput:function(h){g=h;var i={multiple:this.fieldName!=="parent"};h.auiSelect2(f.build(i))},asCqlFunc:function(){var i=this.input.val().trim();if(!i){return undefined}var h=i.replace(/[a-z]+:/g,"");return a.buildEqualityExpressionFromValuesString(this.fieldName,h)},setValues:function(i){var h=i.values.map(d);return b.setValues(g,h)}}}return{build:e}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-suggestions.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions",["ajs"],function(b){var c=[{type:"",label:"All content"},{type:"page",label:"Pages"},{type:"blogpost",label:"Blog Posts"},{type:"attachment",label:"Attachments"},{type:"space",label:"Spaces"}];function a(){return c}return{getList:a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field",["confluence-ui-components/js/cql/internal/cql-type-picker","confluence-ui-components/dark-features","confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions"],function(a,b,c){function d(f){var e;return{setupInput:function(g,h){var i=[];if((h.environment==="search-screen"&&h.searchType=="all")||b.isEnabled("cql.force.full.search.mode")){i=c.getList()}e=a.build(i);e.setupInput(g)},setValues:function(g){return e.setValues(g.values)}}}return{build:d}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-date-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field",["ajs","underscore","confluence-ui-components/js/cql/internal/cql-date-picker"],function(b,c,a){function d(g){var h=g.fieldName;var f;function e(){var j=f.getFromDate();var i=f.getToDate();var l,k;if(j){l=h+' >= "'+j+'"'}if(i){k=h+' <= "'+i+'"'}if(l&&k){return l+" and "+k}return l||k||""}return{setupInput:function(i){f=a.build.call(this,i)},setValues:function(k){if(!f){b.warn("DatePicker not set yet, can't set values");return}var j=k.expressions;if(j.length<1||j.length>2){b.warn("Can't set date value with expressions.length: "+j.length);return}if(j.length===1&&j[0].functionValues.length===1&&j[0].functionValues[0].functionName==="now"){if(j[0].operator!==">="){b.warn("Unsupported date picker relative date operator: "+j[0].operator);return}var i=j[0].functionValues[0].parameters[0];f.selectOption("now('"+i+"')")}else{c.each(j,function(m){if(m.values.length===1){var l=m.values[0];if(m.operator===">="){f.setFromDate(l)}else{if(m.operator==="<="){f.setToDate(l)}}}})}},asCqlFunc:function(){if(!f){b.warn("DatePicker not set yet, can't get CQL");return}var i=f.getSelectedOption();if(!i){return""}if(i==="custom"){return e()}return h+" >= "+i}}}return{build:d}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-label-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field",["jquery","ajs","confluence-ui-components/js/label-picker","confluence-ui-components/js/include-exclude-picker","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(d,c,a,e,b){function f(){var g;return{setupInput:function(h){g=h;h.auiSelect2(e.build(a.build({noMatches:"No matching labels found"})))},setValues:function(h){return b.setValues(g,h.values)}}}return{build:f}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-space-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field",["jquery","confluence-ui-components/js/space-picker","confluence-ui-components/js/include-exclude-picker","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/cql/internal/cql-space-expression-adjuster","confluence-ui-components/js/cql/internal/cql-space-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper","confluence/legacy"],function(b,e,a,d,i,f,c,h){function g(){var j;return{setupInput:function(k,l){j=k;k.auiSelect2(a.build(e.build({multiple:true,suggestCategories:d.getKeys(l.environment),disableMixedSpaceTypes:true})));if(l.environment==="search-screen"){var m=b(h.UI.Components.CQL.SpaceField.templates.archivedSpacesOption());j.after(m);this.onChange=function(o){var n=m.find("#search-filter-include-archived");n.change(o);j.change(o)}}},asCqlFunc:function(){return f.buildExpressionFromValuesString(this.input.val())},setValues:function(k){i.convertFunctionValues(k);return c.setValues(j,k.values)}}}return{build:g}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-user-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field",["jquery","ajs","confluence-ui-components/js/user-group-select2"],function(c,b,a){function d(){var f;function e(h){var g=h[0].result[0];return{id:g.username,text:g.title,imgSrc:g.thumbnailLink.href}}return{setupInput:function(g){f=g;g.addClass("select2-input autocomplete-multiusergroup");a.bind(g.parent())},setValues:function(j){var h=j.values;if(!h||!h[0]){return}var i=h.map(function(k){return c.getJSON(b.contextPath()+"/rest/prototype/1/search/user.json?query="+encodeURI(k))});function g(){var l=i.length>1?arguments:[arguments];var k=l.map(e);f.auiSelect2("data",k)}return c.when.apply(c,i).done(g)}}}return{build:d}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-filter-field-configs.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs",["confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field","confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field","confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field","confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field","confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field","confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field","confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field"],function(b,h,a,g,c,f,e){var d={contentId:h,contentType:a,date:g,label:c,space:f,user:e};return{getConfig:function(j){var i=j.uiSupport;if(i.dataUri){return b.build(j)}if(d[i.valueType]){return d[i.valueType].build(j)}return{}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-field.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-field",["jquery","underscore","ajs","confluence-ui-components/js/cql/internal/cql-field-model","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs"],function(d,j,h,g,c,a){var e=window.Confluence.UI.Components.CQLFilters.Templates;var f=0;function b(n){var l=g.getLabel(n);var m=d(e.baseFilterField({label:l,field:n,counter:f++}));var k=m.find("input");m.data("fieldName",n.fieldName);return d.extend({input:k,element:m,onChange:function(o){k.change(o)}},n)}function i(p,o){var n=p.uiSupport;var r=n.valueType;var q=p.fieldName;if(!r){throw new Error("Can't create filter without valueType.")}if(!q){throw new Error("Can't create filter without fieldName.")}var m=a.getConfig(p);var k=b(p);k.asCql=j.bind(m.asCqlFunc||function(){return c.buildExpression(k,this.input.val())},k);var l=k.element.find("input");if(typeof m.setupInput==="function"){k.setupInput=m.setupInput;k.setupInput(l,o.context)}k.setValues=m.setValues||function(s){l.val(s.values.join(","))};k.element.find(".aui-iconfont-remove").click(function(){k.element.remove();o.removeField(k)});return k}return{build:i}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-select.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-select",["jquery","underscore","ajs","confluence-ui-components/js/cql/internal/cql-ajax","confluence-ui-components/js/cql/internal/cql-field-model"],function(f,c,a,e,b){var d=window.Confluence.UI.Components.CQL.FilterSelect.Templates;function g(t){var r=t.cqlContainer;var m=r.find(".cql-fields");var i=t.onSelection;if(!i){throw Error("An onSelection callback must be provided to the FilterSelect.")}var s=f(d.container());var n=s.children("button");var q=s.find(".input-wrapper");var p=s.find("input");function j(u){u.preventDefault();q.removeClass("hidden");n.hide();s.find(".select2-choice").mousedown()}n.click(j);function h(){q.addClass("hidden");n.show()}p.bind("select2-close",function(){a.debug("CQL Field selector closed");h();setTimeout(function(){a.log("Checking CQL Field selector focus");if(!f(document.activeElement).closest(".cql-filter").length){a.debug("Setting CQL Field selector focus");n.focus()}},1)});r.append(s);function o(u){if(!u.added){return}p.auiSelect2("val","");i(u.added);a.debug("CQL Field selection made");h()}function k(u){if(t.context.environment!=="search-screen"&&!a.DarkFeatures.isEnabled("cql.search.screen")){u=c.reject(u,function(w){return w.type==="date"})}u=c.reject(u,function(w){return c.contains(t.ignoredFields,w.fieldName)});function v(){if(!m[0]){throw new Error("Why no cql-container?")}var x=m.find(".cql-filter").map(function(){return f(this).data("fieldName")});var w=c.reject(u,function(y){return c.contains(x,y.fieldName)&&!c.contains(["label"],y.fieldName)});return{results:w,text:b.getLabel}}p.auiSelect2({id:"fieldName",data:v,formatResult:b.getLabel,formatSelection:b.getLabel,placeholder:"Add a filter"}).change(o)}function l(){a.log("Couldn't fetch CQL fields - unable to initialise CQL field picker")}e.getFields().done(k).fail(l);return p}return{build:g}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-builder",["jquery","underscore","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/cql/internal/cql-expression-builder"],function(d,c,b,a){function e(k){var l=k.trim();if(!l){return undefined}var g=l.split(",");var m=b.getKeys();var f=[];var j=[];c.each(g,function(n){if(n==="conf_current"){f.push("currentSpace()")}else{if(c.contains(m,n)){j.push(n)}else{f.push(n)}}});var h=[];if(j.length){var i=b.getMap();j=c.map(j,function(n){return i[n]});h.push(a.buildEqualityExpressionFromValuesArray("space.type",j))}if(f.length){h.push(a.buildEqualityExpressionFromValuesArray("space",f))}if(h.length===1){return h[0]}return"("+h.join(" or ")+")"}return{buildExpressionFromValuesString:e}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-expression-builder",["jquery","underscore"],function(e,j){function c(n){if(n==="currentSpace()"){return n}return'"'+a(n)+'"'}function a(n){return n.replace(/"/g,'\\"')}function i(n,p){var o=p.trim();if(!o){return undefined}return n+" ~ "+c(o)}function f(n){var o={"+":[],"-":[],"":[]};j.each(n,function(q){var p=q.charAt(0);if(p==="+"){o["+"].push(q.substring(1))}else{if(p==="-"){o["-"].push(q.substring(1))}else{o[""].push(q)}}});return o}function d(p,n){var o=j.map(n,function(q){return p+" = "+c(q)});return o.join(" AND ")}function m(s,p,n){if(p.length===0){return""}var q=j.map(p,c);var o;if(q.length===1){o=n?" = ":" != ";return s+o+q[0]}var r=q.join(",");o=n?" in ":" not in ";return s+o+"("+r+")"}function l(o,n){return m(o,n,false)}function h(o,n){return m(o,n,true)}function k(t,q){var r=f(q);var n=[];var s=d(t,r["+"]);if(s){n.push(s)}var o=h(t,r[""]);if(o){n.push(o)}var p=l(t,r["-"]);if(p){n.push(p)}return n.join(" AND ")}function b(q,o){var p=o.trim();if(!p){return undefined}var n=p.split(",");n=j.map(n,function(r){return r.trim()});return k(q,n)}function g(o,n){if(o.type==="equality"){return b(o.fieldName,n)}if(o.type==="text"){return i(o.fieldName,n)}throw new Error("buildExpression does not yet support type: "+o.type)}return{buildExpression:g,buildEqualityExpressionFromValuesString:b,buildEqualityExpressionFromValuesArray:k,makeValueMap:f,makePlusCql:d,makeMinusCql:l,makeRegularCql:h}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-type-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-space-type-expression-converter",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(b,a){function c(g,d){var e=b.clone(d);var f=b.map(g.values,a.getUIValue);return{field:e,values:f,negate:g.negate}}return{convert:c}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(b,d){function c(h,f){var g=b.filter(h,function(j){return j.field.fieldName==="space.type"});if(g.length===0){return h}if(g.length>1){throw Error("Only a single space.type expression is supported.")}var e=d.convert(g[0],f);var i=b.filter(h,function(j){return j.field.fieldName==="space"});h=b.difference(h,g);if(i.length){i[0]=a(i[0],e)}else{h.push(e)}return h}function a(f,e){f.values=f.values.concat(e.values);return f}return{aggregate:c,combineSpaceExpressions:a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-set-value-helper.js' */
define("confluence-ui-components/js/cql/internal/cql-set-value-helper",["jquery"],function(b){function a(f,c){var e=b.Deferred();f.on("change",function(){e.resolve()});var d=true;f.select2("val",c,d);return e}return{setValues:a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-date-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(a){function c(d){return{field:d.field,expressions:[d]}}function b(f){var d=[];var e={};f.forEach(function(h){var i=h.field.fieldName;if(h.field.type!=="date"){d.push(h)}else{if(!e[i]){var g=c(h);e[i]=g;d.push(g)}else{e[i].expressions.push(h)}}});return d}return{aggregate:b}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-converter",["underscore"],function(a){function b(d){d.values=a.map(d.values,function(e){return"-"+e})}function c(e){var d=$.extend({},e);if(d.field.type==="equality"){if(d.operator==="!="){d.operator="=";b(d)}else{if(d.operator==="notin"){d.operator="in";b(d)}}}return d}return{convert:c}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-negation-converter"],function(a,d){function b(i){var h=[];var g={};var f={};i.forEach(function(k){var l=k.field.fieldName;if(!a.contains(h,l)){h.push(l);g[l]=[];f[l]=[]}var j=d.convert(k);if(j.operator!==k.operator){f[l].push(j)}else{g[l].push(j)}});var e=[];h.forEach(function(k){var j=c(g[k],f[k]);e=e.concat(j)});return e}function c(g,e){if(!e.length){return g}var f=g[0];if(!f){f=e[0];e=a.rest(e)}e.forEach(function(h){f.values=f.values.concat(h.values)});if(f.operator==="="&&f.values.length>1){f.operator="in"}return[f].concat(a.rest(g))}return{aggregate:b}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ignored-field-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter",[],function(){function a(f,e,d){if(e){f=f.filter(function(g){if(e.indexOf(g.field.fieldName)>-1){return d}return !d})}return f}function c(e,d){return a(e,d,true)}function b(e,d){return a(e,d,false)}return{removeFieldsByName:b,getFieldsByName:c}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/cql-component.js' */
define("confluence-ui-components/js/cql/cql-component",["jquery","underscore","ajs","confluence-ui-components/js/cql/internal/cql-ajax","confluence-ui-components/js/cql/internal/cql-filter-field","confluence-ui-components/js/cql/internal/cql-filter-select","confluence-ui-components/js/cql/internal/cql-space-expression-aggregator","confluence-ui-components/js/cql/internal/cql-date-expression-aggregator","confluence-ui-components/js/cql/internal/cql-negation-aggregator","confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter"],function(c,m,i,a,f,n,d,b,h,l){var j=window.Confluence.UI.Components.CQL.Templates;function e(o){var p=[];m.each(o,function(q){q.forEach(function(s){if(!s){return}var r=s.asCql();if(r){p.push(r)}})});return p.join(" and ")}function g(o,p){return m.find(o,function(q){return q.fieldName===p})}function k(s){var p=s.context||{environment:"macro-browser"};var F=s.defaultFieldNames;if(!F){F=s.defaultFields?s.defaultFields.split(","):[]}var x=c(j.container());if(s.container){c(s.container).append(x)}var G=x.find(".cql-fields");var C;var H=s.value||s.defaultValue;if(H){C=a.parseClauses(H)}else{C=new c.Deferred();C.resolve()}var v={};var w={};var u=new c.Deferred();var I=s.onChange||function(){};function o(t){var K=t.fieldName;v[K]=m.without(v[K],t);if(v[K].length===0){delete v[K];I()}}var B={element:x,loading:u,context:s.context||{environment:"macro-browser",searchType:"content"},getValue:function(){return e(v)},getIgnoredFields:function(){return w},removeField:o,fieldArrays:v,fieldRegistry:v};function A(L){var K=f.build(L,B);K.onChange(I);var M=L.fieldName;v[M]=v[M]||[];v[M].push(K);x.trigger("cql-field-adding",K);var t=G.find(".cql-field-"+M+":last");if(t.length){t.after(K.element)}else{G.append(K.element)}return K}function E(K,t){t=t||0;var L=K.fieldName;return v[L]&&v[L][t]}var D;function z(O){var K=c.Deferred();if(!O){K.resolve();return K}var N={};function L(Q){var P=N[Q];if(typeof P==="number"){N[Q]=P+1}else{N[Q]=0}return N[Q]}var t=m.findWhere(D,{fieldName:"space"});O=d.aggregate(O,t);O=b.aggregate(O);O=h.aggregate(O);w=l.getFieldsByName(O,s.ignoredFields);O=l.removeFieldsByName(O,s.ignoredFields);var M=[];m.each(O,function(T){var U=T.field.fieldName;var S=g(D,U);var Q=L(U);var P=E(S,Q)||A(S);var R=P.setValues(T);if(R){M.push(R)}});c.when.apply(c,M).then(function(){K.resolve()});return K}function r(K){var L,t;if(K){var M=m.escape(K);L="We can\'t load your filters";t=i.format("Curses! We had trouble with \"{0}\". Try refreshing the page, but you may need to re-enter your macro parameters.",M)}else{L="We couldn\'t load the macro";t="If you refresh your page, we\'ll give it another shot."}i.messages.error(".cql-error-container",{title:L,body:t,closeable:true})}function J(t){var K;if(t.element.find(".aui-nav-selected").length!==0){return}if(t.element.find(".select2-container-multi").length!==0){K=t.element.find("input.select2-input");K.focus().click()}else{K=t.element.find("a.select2-choice.select2-default");if(!K.length){K=c(":input:visible",t.element).first()}if(!K.length){i.log("Unable to focus CQL field: "+t.fieldName)}K.focus().mousedown()}}function y(L){var K=c.extend({},L,{fixed:false});var t=A(K);J(t)}function q(t){D=t;F.forEach(function(M){var L=g(D,M);if(!L){throw Error("Unknown fieldname: "+M)}var K=c.extend({fixed:true},L);A(K)});n.build({onSelection:y,cqlContainer:x,context:p,ignoredFields:s.ignoredFields});C.done(function(K){z(K).done(function(){u.resolve()})}).fail(function(){if(p.environment==="search-screen"){i.log("Error parsing CQL param from search screen URL: "+s.value)}else{r(s.value)}u.resolve()})}a.getFields().done(q).fail(function(){r()});return B}return{build:k}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace CreateContent.avatar.
 */

if (typeof CreateContent == 'undefined') { var CreateContent = {}; }
if (typeof CreateContent.avatar == 'undefined') { CreateContent.avatar = {}; }


CreateContent.avatar.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  CreateContent.avatar.avatarWithName.soyTemplateName = 'CreateContent.avatar.avatarWithName';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-select2', location = 'user-select2/user-multiselect.js' */
Confluence.Binder.autocompleteMultiUser=function(b){b=b||document.body;var c=AJS.$;var a=function(){var d=c(".select2-drop-active > .select2-results");if(d.children(".select2-result-selectable").length===0&&d.children(".select2-disabled").length){d.append('<li class="select2-no-results">'+AJS.escapeHtml("No matches found")+"</li>")}};c("input.autocomplete-multiuser[data-autocomplete-bound != 'true']",b).each(function(){var d=c(this);d.auiSelect2({multiple:true,minimumInputLength:2,formatInputTooShort:function(){return "Start typing to search for a user"},ajax:{transport:function(h){var i=h.success;delete h.success;return c.ajax.apply(c.ajax,arguments).done(i).done(a)},data:function(h){return{"max-results":6,query:h}},dataType:"json",url:Confluence.getContextPath()+"/rest/prototype/1/search/user.json",results:function(i){var h=[];c.each(i.result,function(){h.push({id:this.username,text:this.title,imgSrc:this.thumbnailLink.href})});return{results:h}},quietMillis:300},formatResult:function(h){return CreateContent.avatar.avatarWithName({size:"small",displayName:h.text,userId:h.id,avatarImageUrl:h.imgSrc})},escapeMarkup:function(h){return h},formatSelection:function(h){return CreateContent.avatar.avatarWithName({size:"xsmall",displayName:h.text,userId:h.id,avatarImageUrl:h.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:true});if(!d.data("autofill-user")){return}var g=AJS.Meta.get("remote-user"),f=AJS.Meta.get("current-user-fullname"),e=AJS.Meta.get("current-user-avatar-url");if(g&&f&&e){d.auiSelect2("data",[{id:g,text:f,imgSrc:AJS.contextPath()+e}])}})};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-parameter-serializer.js' */
define("confluence-macro-browser/macro-parameter-serializer",["jquery"],function(h){function e(d){return d.replace(/\\/g,"\\\\").replace(/=/g,"\\=").replace(/[|]/g,"\\|")}return{serialize:function(d){var a=[],b;for(b in d)a.push(e(b)+"="+e(d[b]));return a.join("|")},deserialize:function(d){function a(f,d){for(var c=[],b=[],a,f=f||"",g=0,e=f.length;g<e;g++)a=f[g],"\\"==a?c.push(a+(g+1!=f.length?f[++g]:"")):a==d?(b.push(c.join("")),c=[]):c.push(a);b.push(c.join(""));return b}var b={};h.each(a(d||"",
"|"),function(d,e){var c=a(e,"=");2===c.length&&c[0]&&(b[c[0].replace(/\\(.)/g,"$1")]=c[1].replace(/\\(.)/g,"$1"))});return b}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-parameter-serializer","Confluence.MacroParameterSerializer");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-fields.js' */
define("confluence-macro-browser/macro-browser-fields",["ajs","jquery","underscore","confluence/legacy"],function(g,e,o,i){function n(j,h,l){return function(k,b){if(k.multiple)return j.string(k,b);var a=e(i.Templates.MacroBrowser.macroParameterSelect()),c=e("select",a),b=b||{};b.setValue=b.setValue||function(a){var b=!1;c.find("option").each(function(){if(this.value==a)return b=!0,!1});b?delete c.tempValue:(c.append(e("<option/>").attr("value",a).text(a+" ("+"Not found"+
")")),c.tempValue=a);try{c.val(a)}catch(m){g.logError(m)}c.change()};a=h(a,c,b);a.updateDependencies=l;a.getData=function(a){if(a.title&&a.spaceKey||a.pageId||a.draftId){var f=c.tempValue||c.val();b.fileTypes&&(a.fileTypes=b.fileTypes);var m=g.contextPath()+(a.draftId?"/json/draftattachmentsearch.action":"/json/attachmentsearch.action");e.getJSON(m,a,function(a){if(!a.error){e("option",c).remove();a=a.attachments;if(!a||!a.length){c.append(e("<option/>").attr("value","").html("No appropriate attachments"));
c.tempValue&&b.setValue(c.tempValue)}else{for(var d=0,m=a.length;d<m;d++)c.append(e("<option/>").attr("value",a[d].name).text(a[d].name));f=f||c.tempValue;b.setValue(f||a[0].name)}c.attr("style","")}})}else g.log("Not enough parameters to send attachmentsearch request")};return a}}return function(j){var h=function(b,a,c){var c=c||{},d=c.setValue||function(b){a.val(b)},e=c.getValue||function(){return a.val()};a.change(c.onchange||j.paramChanged);return{paramDiv:b,input:a,setValue:d,getValue:e}},l=
function(b,a,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++)j.fields[a[d]]&&j.fields[a[d]].dependencyUpdated(b,c)},k={updateDependencies:l,username:function(b,a){var a=a||{},c=b.multiple?"autocomplete-multiuser":"autocomplete-user",d=e(i.Templates.MacroBrowser.macroParameter()),f=e("input[type='text']",d);f.addClass(c).attr("data-none-message","Not found");b.required&&f.keyup(j.processRequiredParameters);b.multiple?(i.Binder.autocompleteMultiUser(d),a.setValue=
function(a){f.val(a);for(var a=a.split(","),b=[],c=[],d=0,h=a.length;d<h;d++)b.push(function(a){return e.getJSON(g.contextPath()+"/rest/prototype/1/user/non-system/"+a).done(function(a){a&&a.name&&c.push({id:a.name,text:a.displayName,imgSrc:a.avatarUrl})}).fail(function(b){g.logError("Cannot parse user data for macro browser field with: "+b);c.push({id:a,text:g.format("Unknown User ({0})",a),imgSrc:g.contextPath()+"/images/icons/profilepics/default.png"})})}(a[d]));e.when.apply(e,o.map(b,function(a){var b=
e.Deferred();a.always(function(){b.resolve()});return b.promise()})).done(function(){c.length&&f.auiSelect2("data",c)})}):(f.bind("selected.autocomplete-content",function(c,d){if(a.onselect)a.onselect(d.selection);else a.setValue?a.setValue(d.content.username):(l(b.name,a.dependencies,f.val()),"function"===typeof a.onchange&&a.onchange.apply(f))}),g.Confluence.Binder.autocompleteUserOrGroup(d));return h(d,f,a)},spacekey:function(b,a){if(b.multiple)return k.string(b,a);var a=a||{},c=e(i.Templates.MacroBrowser.macroParameter()),
d=e("input[type='text']",c);d.addClass("autocomplete-space").attr("data-template","{key}").attr("data-none-message","Not found");b.required&&d.keyup(j.processRequiredParameters);d.bind("selected.autocomplete-content",function(c,e){if(a.onselect)a.onselect(e.selection);else a.setValue?a.setValue(e.content.key):(l(b.name,a.dependencies,d.val()),"function"===typeof a.onchange&&a.onchange.apply(d))});g.Confluence.Binder.autocompleteSpace(c);return h(c,d)},attachment:n(k,
h,l),full_attachment:n(k,h,l),"confluence-content":function(b,a){if(b.multiple)return k.string(b,a);a=a||{};b.options=b.options||{};var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input[type='text']",c).attr("data-none-message","Not found").attr("data-template","");b.required&&d.keyup(j.processRequiredParameters);a.onchange=a.onchange||function(){var c=d.val();l(b.name,a.dependencies,c)};a.setValue=a.setValue||function(b){d.val(b);"function"===typeof a.onchange&&
a.onchange.apply(d)};d.bind("selected.autocomplete-content",function(c,e){var f="";"true"==b.options.includeDatePath&&"blogpost"===e.content.type&&(f=e.content.createdDate.date.split("-"),f="/"+f[0]+"/"+f[1]+"/"+f[2].substring(0,2)+"/");var h=e.content.space&&e.content.space.key,i=h&&h!=g.Meta.get("space-key");-1!==e.content.title.indexOf(":")&&(i=!0);f=(i?h+":":"")+f+e.content.title;d.val(f);if(a.onselect)a.onselect(e.selection);else a.setValue(f,d)});b.options.spaceKey&&("@self"===b.options.spaceKey.toLowerCase()&&
(b.options.spaceKey=g.Meta.get("space-key")),d.attr("data-spacekey",b.options.spaceKey));var f=b.options.type;if("string"===typeof f)if("page"==f)d.addClass("autocomplete-page"),g.Confluence.Binder.autocompletePage(c);else if("blogpost"==f)d.addClass("autocomplete-blogpost"),g.Confluence.Binder.autocompleteBlogpost(c);else{if("attachment"===f||"full_attachment"===f)d.addClass("autocomplete-attachment"),g.Confluence.Binder.autocompleteAttachment(c)}else d.addClass("autocomplete-confluence-content"),
g.Confluence.Binder.autocompleteConfluenceContent(c);return h(c,d,a)},string:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameter()),d=e("input",c);b.required&&d.keyup(j.processRequiredParameters);return h(c,d,a)},"boolean":function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterBoolean()),d=e("input",c),a=a||{};a.setValue=a.setValue||function(a){(/true/i.test(a)||/true/i.test(b.defaultValue)&&!/false/i.test(a))&&d.prop("checked",!0)};return h(c,d,a)},"enum":function(b,a){if(b.multiple)return k.string(b,
a);var c=e(i.Templates.MacroBrowser.macroParameterSelect()),d=e("select",c);!b.required&&!b.defaultValue&&d.append(e("<option/>").attr("value",""));e(b.enumValues).each(function(){d.append(e("<option/>").attr("value",this).html(""+this))});return h(c,d,a)},_hidden:function(b,a){var c=e(i.Templates.MacroBrowser.macroParameterHidden()).hide(),d=e("input",c);return h(c,d,a)}};return{Field:h,ParameterFields:k}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-fields");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-smartfields.js' */
define("confluence-macro-browser/macro-browser-smartfields",["ajs"],function(c){return function(f,d){var e=function(a){this.fileTypes=a};e.prototype.beforeParamsSet=function(a){!a.page&&(!a.date&&!a.space)&&("page"==c.params.contentType||"blogpost"==c.params.contentType?a.page=c.Editor.getCurrentTitle():"comment"==c.params.contentType&&(a.page=c.params.pageTitle));if(a.date){var b=a.date.split("/");a.page=["",b[2],b[0],b[1],a.page].join("/")}a.space&&(a.page=a.space+":"+a.page);return a};e.prototype.beforeParamsRetrieved=
function(a){if(a.page){var b=a.page.split(":");1<b.length&&(a.space=b[0],a.page=b[1]);b=a.page.split("/");1<b.length&&(a.date=[b[2],b[3],b[1]].join("/"),a.page=b[4]);(("page"==c.params.contentType||"blogpost"==c.params.contentType)&&a.page==c.Editor.getCurrentTitle()||"comment"==c.params.contentType&&a.page==c.params.pageTitle)&&delete a.page}return a};e.prototype.fields={attachment:function(a){a=d.attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,g){c.debug("attachment:dependencyUpdated called: "+
a+", "+g);var d=e.prototype.fields._parsePageLink(g);this.getData(d)};return a},full_attachment:function(a){a=d.full_attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,d){c.debug("attachment:dependencyUpdated called: "+a+", "+d);var f=e.prototype.fields._parsePageLink(d);this.getData(f)};return a},"confluence-content":function(a){return d["confluence-content"](a,{dependencies:["name"]})},_parsePageLink:function(a){var b={},a=a.split(":",2);b.spaceKey=2===a.length&&a[0]||c.Meta.get("space-key");
b.title=a[a.length-1];0===b.title.indexOf("/")&&(b.postingDay=b.title.substr(1,10),b.title=b.title.substr(12));b.title===c.Editor.getCurrentTitle()&&(b.title="");b.title||(c.params.newPage?b.draftId=c.Meta.get("content-id"):b.pageId=c.params.pageId);return b}};f.activateSmartFieldsAttachmentsOnPage=function(a,b){f.setMacroJsOverride(a,new e(b))}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-smartfields");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-utils.js' */
define("confluence-macro-browser/macro-browser-utils",["jquery"],function(a){return{makeDefaultKey:function(){return a.makeArray(arguments).join(".")}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-utils");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-cql.js' */
define("confluence-macro-browser/macro-browser-cql",["ajs","underscore","confluence/templates","confluence-ui-components/js/cql/cql-component","jquery"],function(i,g,m,n,d){function j(b){var a=b.param;return d.extend({},b,a.options,{defaultValue:a.defaultValue||a.options.defaultValue})}function k(b){return d(m.MacroBrowser.CQL.sections({hasRenderParameters:0<b.renderParams.length}))}return{build:function(b){var a=k(b),e=b.container;e.append(a);e.bind("cql-field-adding",function(b,c){c.element.addClass("macro-param-div");
c.element.find(".cql-field-input").addClass("macro-param-input")});e.addClass("loading");a.filter(".cql-render-heading").find("button").click(function(){var b=d(this),c=b.closest(".cql-render-heading").next(),a=c.is(":visible");a?c.slideUp(300):(c.removeClass("hidden").show(),c=d(".cql-render-heading").position().top,d(".macro-input-fields").animate({scrollTop:c},300));a=a?"Show":"Hide";
b.text(a)});var f,h={param:b.cqlParam,value:b.cqlValue,container:a.filter(".cql-filter-fields")},h=j(h);f=n.build(h);e.data("cqlComponent",f);var l=d.Deferred();f.loading.done(function(){var a=b.cqlParam.options.requiredFields;if(a){var c=a.split(",");g.each(f.fieldRegistry||f.fieldArrays,function(a){var d=!1;g.each(a,function(a){!d&&g.contains(c,a.fieldName)&&(b.flagRequiredParam(a.element),d=!0,a.onChange(b.paramChanged))})})}e.removeClass("loading");l.resolve()});return{elements:a,loading:l}},
_makeCqlComponentOptions:j,_renderCqlSections:k}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser-cql.soy' */
// This file was automatically generated from macro-browser-cql.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.CQL.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }
if (typeof Confluence.Templates.MacroBrowser.CQL == 'undefined') { Confluence.Templates.MacroBrowser.CQL = {}; }


Confluence.Templates.MacroBrowser.CQL.sections = function(opt_data, opt_ignored) {
  return '<div class="cql-filter-fields"></div>' + ((opt_data.hasRenderParameters) ? '<h4 class="cql-render-heading"><span>' + soy.$$escapeHtml("Options") + '</span>' + aui.buttons.button({type: 'link', text: "Show", extraAttributes: {type: 'button'}}) + '</h4><div class="cql-render-fields hidden"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.CQL.sections.soyTemplateName = 'Confluence.Templates.MacroBrowser.CQL.sections';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-editor.js' */
define("confluence-macro-browser/macro-browser-editor",["ajs","jquery","confluence/legacy","confluence-macro-browser/macro-browser-cql","underscore"],function(q,d,p,t,r){return function(k){function o(g){var a=d("#macro-insert-container").find(".macro-name").val(),b,c=k,e={},f;f={};for(var h=0,l=g.formDetails.parameters.length;h<l;h++){var i=g.formDetails.parameters[h],j;if(i.type&&"cql"===i.type.name)j=d(".macro-input-fields form").data("cqlComponent").getValue();else{j=d("#macro-param-"+i.name);
var n=j.val();"checkbox"==j.attr("type")&&(n=""+j.prop("checked"));j=n}if(j&&(i.shared&&(e[i.name]=j),i.hidden||!i.defaultValue||i.defaultValue!=j))f[i.name]=j}f[""]&&(b=f[""]);d.extend(f,c.unknownParams);(h=k.getMacroJsOverride(a))&&"function"===typeof h.beforeParamsRetrieved&&(f=h.beforeParamsRetrieved(f,g,e));return{name:a,bodyHtml:c.getMacroBody(),params:f,defaultParameterValue:b}}function u(g,a,b){var c=k,e,f=a.type.name;if(b){var h=b.fields&&b.fields[f];h&&"function"!==typeof h&&(h=h[a.name]);
"function"===typeof h&&(e=h.call(b,a))}e||(f in c.ParameterFields&&"function"===typeof c.ParameterFields[f]||(f="string"),e=c.ParameterFields[f](a));c.fields[a.name]=e;b=e.paramDiv;c=e.input;e="macro-param-"+a.name;b.attr("id","macro-param-div-"+a.name);c.addClass("macro-param-input").attr("id",e);a.hidden&&b.hide();c=g.pluginKey;a.displayName==k.Utils.makeDefaultKey(c,g.macroName,"param",a.name,"label")&&(a.displayName=a.name);a.description==k.Utils.makeDefaultKey(c,g.macroName,"param",a.name,"desc")&&
(a.description="");d("label",b).attr("for",e).text(a.displayName);a.required&&s(b);a.description&&b.append(p.Templates.MacroBrowser.macroParameterDesc({description:a.description}));return b}function s(d){var a=d.find("label"),b=a.text()+" *";a.text(b);d.addClass("required")}return{loadMacroInBrowser:function(g){if(!g||!g.formDetails)q.trigger("analytics",{name:"macro-browser.unknown-macro-error"}),alert("Could not load unknown macro in the macro browser.");else{var a=require("tinymce"),b=k,c=g.formDetails,
e=c.macroName,f=b.jsOverrides[e],h=b.settings.selectedMacro,l=a.confluence.macrobrowser.editedMacroDiv;if(f&&"function"===typeof f.opener)b.close(),f.opener({name:e});else{var a=c.parameters,i=r.find(a,function(a){return"cql"===a.type.name});d("#save-warning-span").addClass("hidden");d("#macro-insert-container .macro-name").val(e);var j=d("#macro-insert-container .macro-input-fields form");j.empty();var n=g.extendedDescription||g.description;if(i)c.documentationLink&&b.UI.setHelpLink(b.dialog,{href:c.documentationLink});
else if(n||c.documentationLink)n=d(p.Templates.MacroBrowser.macroDescription({descriptionHtml:n,documentationLink:c.documentationLink})),j.append(n);c.body&&("NONE"!=c.body.bodyType&&l&&d(l).hasClass("editor-inline-macro"))&&(l=g.pluginKey,c.body.label==k.Utils.makeDefaultKey(l,e,"body","label")&&(c.body.label=""),c.body.description==k.Utils.makeDefaultKey(l,e,"body","desc")&&(c.body.description=""),c=c.body,l=b.selectedMacroDefinition,n=k,e=d(p.Templates.MacroBrowser.macroBody()),l=l?l.body:n.settings.selectedText,
d("textarea",e).val(l||""),c.label&&d("label",e).text(c.label),c.description&&e.append(p.Templates.MacroBrowser.macroParameterDesc({description:c.description})),c.hidden&&e.hide(),e&&j.append(e));var m=h?d.extend({},h.params):{},o=j;i&&(a=r.without(a,i),i=t.build({cqlParam:i,renderParams:a,cqlValue:m.cql,container:j,flagRequiredParam:s,paramChanged:k.paramChanged}),delete m.cql,o=i.elements.filter(".cql-render-fields"),i.loading.done(function(){k.paramChanged();k.Preview.previewMacro(g,h);k.UI.focusOnMacroDetailsFirstInput()}));
d(a).each(function(){o.append(u(g,this,f))});f&&"function"===typeof f.beforeParamsSet&&(m=f.beforeParamsSet(m,!h));d(a).each(function(){var a;a=this.name==""?b.selectedMacroDefinition?b.selectedMacroDefinition.defaultParameterValue:this.defaultValue:m[this.name];a!=null?delete m[this.name]:d(this.aliases).each(function(){if(m[this]){a=m[this];delete m[this]}});if(a==null)a=this.defaultValue;a!=null&&b.fields[this.name].setValue(a)});b.unknownParams=m;d("a",j).click(function(){window.open(this.href,
"_blank").focus();return false});d("#macro-browser-dialog:visible").length||b.showBrowserDialog();a={};d.extend(!0,a,g);a.formDetails||(a.formDetails={});a.formDetails.body||(a.formDetails.body={});b.dialog.activeMetadata=a;a.formDetails.body.content=b.settings.selectedMacro?b.settings.selectedMacro.body:a.formDetails.body.bodyType&&"plain_text"===a.formDetails.body.bodyType.toLowerCase()?b.settings.selectedText:b.settings.selectedHtml}}},getMacroParametersFromForm:function(d){return o(d).params},
getMacroDefinitionFromForm:o,processRequiredParameters:function(){if(d(".macro-input-fields form").is(".loading"))return q.log("Form still loading - cannot processRequiredParameters"),!1;var g=0===d("#macro-insert-container .macro-param-div.required .macro-param-input").not(".select2-container").filter(function(){var a=d(this).val();return null===a||""===a}).length,a=g?"":"disabled",b=a?"addClass":"removeClass";d("#macro-browser-dialog button.ok").prop("disabled",a);d("#macro-browser-dialog .macro-preview-header .refresh-link").prop("disabled",
a)[b]("disabled");return g}}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-editor");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preview.js' */
define("confluence-macro-browser/macro-browser-preview",["jquery","ajs","confluence/legacy"],function(e,b,n){return function(d){function h(){return e("#macro-insert-container .macro-preview")}function l(){h().html("")}function i(b){b?(d.UI.showPreviewSpinner(!0),m.disable()):(d.UI.showPreviewSpinner(!1),m.enable())}var m={disable:function(){e("#macro-browser-preview-link").attr("disabled",!0).addClass("disabled")},enable:function(){e("#macro-browser-preview-link").removeAttr("disabled").removeClass("disabled")}};
return{previewMacro:function(j,f){var g=d;l();if(!d.Editor.processRequiredParameters())return b.trigger("analytics",{name:"macro-browser.missing-params-error"}),b.log("previewMacro: missing required params"),!1;"object"!==typeof f&&(f=d.Editor.getMacroDefinitionFromForm(j));var a=f.params,k=g.getMacroJsOverride(j.macroName);k&&"function"===typeof k.updateMacroParametersForPreview&&(a=k.updateMacroParametersForPreview(a));a[""]&&delete a[""];g={contentId:n.getContentId(),macroName:j.macroName,params:a,
body:g.getMacroBody(),defaultParameterValue:f.defaultParameterValue,successCallback:function(a){var c=h().find("iframe")[0],c=c.contentDocument||c.contentWindow.document;c.write(a);c.close();e(c).ready(function(){b.trigger("macro-browser.preview-ready")});e("div.error span.error",c).length&&b.logError("Error rendering macro definition : ");setTimeout(function(){i(!1)},1E3)},errorCallback:function(a){b.logError(a);i(!1)}};a=b.params.staticResourceUrlPrefix+"/blank.html";h().html('<iframe src="'+a+
'" frameborder="0" name="macro-browser-preview-frame" id="macro-preview-iframe"></iframe>');i(!0);d.Rest.fetchMacroPreviewData(g)},removePreviewContainer:l}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preview");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-model.js' */
define("confluence-macro-browser/macro-browser-model",["ajs"],function(h){return function(f){function g(a){a.title==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"label")&&(a.title=a.macroName.charAt(0).toUpperCase()+a.macroName.substring(1).replace(/-/g," "));a.description==f.Utils.makeDefaultKey(a.pluginKey,a.macroName,"desc")&&(a.description="");a.id="macro-"+(a.alternateId||a.macroName);var b=[a.macroName,a.title].concat(a.aliases||[]);a.keywordsNoDesc=b.join(",");var d=a.description&&a.description.replace(/,/g,
" ")||"";b.push(d);a.keywords=b.join(",");return a}return{loadMacros:function(a){if(a){var b=f;b.metadataList=[];b.aliasMap={};for(var d=0,i=a.length;d<i;d++){var c=a[d],c=g(c);if(c.aliases)for(var e=0,j=c.aliases.length;e<j;e++)c.aliases[e]=c.aliases[e].toLowerCase(),b.aliasMap[c.aliases[e]]=c.macroName.toLowerCase();b.metadataList.push(c)}b.metadataList.sort(function(a,b){return a.title.toLowerCase()>b.title.toLowerCase()?1:-1})}else h.log("AJS.MacroBrowser.loadModel - no macro data, aborting")},
transformMetaDataDefault:g}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-model");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-rest.js' */
define("confluence-macro-browser/macro-browser-rest",["jquery","ajs","wrm"],function(b,c,f){function d(a){c.logError(a)}var g=f.data.claim("confluence.macro.metadata.provider:macro-browser-metadata-resources.macro-meta-client-cache-key");return{loadMacroMetadata:function(a){a.data=a.data||{};a.data.macroMetadataClientCacheKey=g;return b.ajax({type:"GET",cache:!0,timeout:a.timeout||3E4,dataType:"json",url:(a.context||c.params.contextPath)+"/plugins/macrobrowser/browse-macros.action",data:a.data,success:a.successCallback,
error:a.errorCallback||d}).promise()},fetchMacroMetadataDetails:function(a){var e={id:a.id};a.alternateId&&(e.alternateId=a.alternateId);b.ajax({type:"GET",dataType:"json",url:(a.context||c.params.contextPath)+"/plugins/macrobrowser/browse-macros-details.action",data:e,success:a.successCallback,error:a.errorCallback||d})},fetchMacroPreviewData:function(a){if(!a.contentId||!a.macroName)return(a.errorCallback||d)("invalid parameters");b.ajax({type:"POST",contentType:"application/json; charset=utf-8",
url:(a.context||c.params.contextPath)+"/rest/tinymce/1/macro/preview",data:b.toJSON({contentId:a.contentId,macro:{name:a.macroName,body:a.body,params:a.params,defaultParameterValue:a.defaultParameterValue}}),dataType:"html",success:a.successCallback,error:a.errorCallback||d})}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-rest");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-UI.js' */
define("confluence-macro-browser/macro-browser-UI",["jquery","ajs","confluence/legacy"],function(f,b,j){return function(k){function m(a){return f(j.Templates.MacroBrowser.macroSummaryList({category:a}))}function o(a,d){var g=f(j.Templates.MacroBrowser.macroSummaryItem());if(a.icon){var e=(a.icon.relative?b.params.staticResourceUrlPrefix:"")+a.icon.location;!a.icon.relative&&f.browser.msie&&!window.location.href.indexOf("https")&&e.indexOf("https")?g.prepend("<span class='macro-icon-holder icon-"+
a.macroName+"'></span>"):g.prepend("<img src='"+e+"' alt='icon' width='"+a.icon.width+"' height='"+a.icon.height+"' title='"+a.title+"'/>")}else g.prepend("<span class='macro-icon-holder icon-"+a.macroName+"'></span>");f(".macro-title",g).text(a.title);f(".macro-desc",g).prepend(a.description);if("gadget"==a.macroName&&(e=a.gadgetUrl))e.match("^https?://.*")||(e=b.params.contextPath+"/"+e),f(".macro-title",g).after(j.Templates.MacroBrowser.gadgetLink({url:e}));g.click(function(b){d(b,a)});return g}
function p(a,d){var b;b=d?j.Templates.Dialog.helpLink(d):j.Templates.MacroBrowser.helpLink();a.getPage(a.curpage).element.find(".dialog-title").prepend(b)}return{createDialog:function(a){for(var d=a.macros,g=a.onClickMacroSummary,e={all:m("all")},h=0,q=d.length;h<q;h++){var i=d[h];if(i.hidden)if(k.isHiddenMacroShown(i))i.categories.push("hidden-macros");else continue;e.all.append(o(i,g).attr("id",i.id));for(var n=0,r=i.categories.length;n<r;n++){var l=i.categories[n];e[l]=e[l]||m(l);e[l].append(o(i,
g).attr("id",l+"-"+i.id))}}var c=b.ConfluenceDialog({width:a.width||865,height:a.height||530,id:"macro-browser-dialog",onSubmit:a.onSubmit,onCancel:a.onCancel});c.popup.element.on("keydown",".aui-button",function(a){a.stopPropagation()});c.getPage(0).element.attr("id","select-macro-page");c.addHeader(a.title);c.addPanel("All",e.all,"all","category-button-all");d=0;for(g=a.categories.length;d<g;d++)h=a.categories[d],c.addPanel(h.displayName,e[h.name]||m(h.name),
h.name,"category-button-"+h.name).getPanel(d).setPadding(0);c.addCancel("Cancel",a.onCancel);p(c);"VANILLA"==b.Meta.get("confluence-flavour")?c.addHelpText("<a href='{0}' id='marketplace-link'><span class='icon icon-marketplace'/>{1}</a>",[b.params.contextPath+"/plugins/servlet/upm/marketplace/featured?category=Macros&source=macro_browser","Find more macros..."]):c.addHelpText("Hint: type \"\u003cstrong\u003e{\u003c/strong\u003e\" in the Editor to insert macros on the page.");e=f(j.Templates.MacroBrowser.insertMacroPanel());
e.find("form").submit(function(a){k.complete();return b.stopEvent(a)});f("#macro-browser-preview-link",e).click(function(a){f(this).prop("disabled")||k.previewMacro(c.activeMetadata);return b.stopEvent(a)});c.addPage().addPanel("X",e,"macro-input-panel").addLink("Select macro",function(a){a.prevPage();a.searcher.focus()},"dialog-back-link").addButton("insert.name",function(){k.complete()},"ok").addCancel("Cancel",function(){return a.onCancel()}).getPanel(0).setPadding(0);
c.getPage(1).element.attr("id","macro-details-page");f("#macro-browser-dialog .dialog-button-panel .ok").before("<span id='save-warning-span' class='hidden'/>");c.searcher=j.DomFilterField({items:"#macro-browser-dialog .dialog-panel-body #category-all .macro-list-item",formId:"macro-browser-search-form",inputId:"macro-browser-search",searcher:function(a,b){var d=null;if(""!=b){c.getCurrentPanel()!=c.getPanel(0)&&c.gotoPanel(0);var e=k.searchSummaries(b),d={};f.each(e,function(){d[this.id]=this})}a.each(function(){!d||
this.id in d?f(this).show():f(this).hide()})},submitCallback:function(a,b){""!=b&&1===a.length&&a.click()}});c.page[0].header.append(c.searcher.form);c.page[0].ontabchange=function(a){a!=c.getPanel(0,0)&&c.searcher.reset()};e=f(j.Templates.MacroBrowser.missingUserMacroMetadataPanel({showAdminMessage:b.Meta.getBoolean("is-admin")}));c.addPage().addPanel("No macro metadata",e,"missing-metadata-panel").addLink("Back",function(a){a.gotoPage(0);
a.searcher.focus()},"dialog-back-link").addCancel("Cancel",function(){return a.onCancel()});c.gotoPage(2);c.addHeader("No macro metadata");c.gotoPanel(0,0);c.ready=!0;return c},showBrowserSpinner:function(a){var b=f("#macro-browser-dialog");a?b.spin("large"):b.spinStop()},showPreviewSpinner:function(a){var b=f("#macro-browser-preview");a?b.spin("large"):b.spinStop()},updateButtonText:function(a){var d=f("#macro-browser-dialog .dialog-button-panel .ok");
"edit"==a?d.text("Save"):d.text("Insert")},enableSaveButton:function(a){f("#macro-browser-dialog .dialog-button-panel .ok").prop("disabled",!a)},focusOnMacroDetailsFirstInput:function(){var a=f("#macro-insert-container").find(".macro-input-fields :input:visible:not(button,.select2-offscreen)").first();if(a.length){if(a.hasClass("select2-input")){var d=a.closest(".select2-container").parent().find(".select2-offscreen");if("function"!==typeof d.select2){b.log("select2Hidden is not a select2 hidden input, skipping focus attempt.");
return}d.select2("open");d.select2("close")}else a.focus();!k.selectedMacroDefinition&&""!==a.val()&&a.select()}else b.log("No input to focus")},setHelpLink:p}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-UI");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser.js' */
define("confluence-macro-browser/macro-browser","window jquery ajs confluence-macro-browser/macro-browser-utils confluence-macro-browser/macro-browser-editor confluence-macro-browser/macro-browser-fields confluence-macro-browser/macro-browser-model confluence-macro-browser/macro-browser-preview confluence-macro-browser/macro-browser-rest confluence-macro-browser/macro-browser-UI confluence-macro-browser/macro-browser-smartfields".split(" "),function(k,g,d,m,n,l,o,p,q,r,s){var a={},l=l(a);a.ParameterFields=
l.ParameterFields;a.Field=l.Field;s(a,a.ParameterFields);a.Utils=m;a.Editor=n(a);a.Preview=p(a);a.Model=o(a);a.Rest=q;a.UI=r(a);var h={},f,j=function(b,c){var e={id:b.macroName,successCallback:function(b){if(b&&b.details)b.details=a.Model.transformMetaDataDefault(b.details);a.Editor.loadMacroInBrowser(b.details,c);j.displayDetails();a.Preview.previewMacro(b.details)},errorCallback:function(){d.trigger("analytics",{name:"macro-browser.fetch-metadata-error"});k.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");
j.displayDetails()}};if(b.alternateId)e.alternateId=b.alternateId;j.setUI(c,b.title);a.Rest.fetchMacroMetadataDetails(e)};j.setUI=function(b,c){var e=b=="edit"?a.editTitle:a.insertTitle;g("#macro-insert-container").hide();a.UI.updateButtonText(b);a.UI.enableSaveButton(false);a.dialog.gotoPage(1).addHeader(e.replace(/\{0\}/,c));a.dialog.show();a.UI.showBrowserSpinner(true)};j.displayDetails=function(){a.UI.showBrowserSpinner(false);a.UI.enableSaveButton(false);g("#macro-insert-container").show();a.UI.focusOnMacroDetailsFirstInput()};
a.reset=function(){f&&f.resolve&&f.resolve();f=null;a.initMacroBrowserAfterRequest=null;a.initData=null;a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};h={};a.Macros=h};a.jsOverrides=h;a.Macros=h;a.getMacroJsOverride=function(a){return h[a]};a.setMacroJsOverride=function(a,c){h[a]=c;return h[a]};a.hasInit=false;a.metadataList=[];a.aliasMap={};a.fields={};a.processRequiredParameters=function(){return a.Editor.processRequiredParameters()};a.paramChanged=function(){a.Editor.processRequiredParameters()};
a.loadMacroInBrowser=function(b,c){a.Editor.loadMacroInBrowser(b,c)};a.getMacroDefinitionFromForm=function(b){a.Editor.getMacroDefinitionFromForm(b)};a.getMacroParametersFromForm=function(b){a.Editor.getMacroParametersFromForm(b)};a.previewMacro=function(b){a.Preview.previewMacro(b)};a.previewOnload=function(b){var c=h[a.dialog.activeMetadata.macroName];c&&c.postPreview&&c.postPreview(g("#macro-preview-iframe")[0],a.dialog.activeMetadata);d.Editor.disableFrame(b);g(b).click(function(a){if(a.target.tagName.toLowerCase()===
"a"){(a=g(a.target).attr("href"))&&(a.indexOf("#")!=0&&a.indexOf(k.location)==-1)&&k.open(a,"_blank").focus();return false}})};a.getMacroMetadata=function(b){for(var c=0,e=a.metadataList.length;c<e;c++){var d=a.metadataList[c];if(d.macroName==b)return d}return null};a.getMetadataPromise=function(){return f};a.open=function(b){if(!b){b={};d.log("No settings to open the macro browser.")}var c=b.selectedMacro;!c&&b.presetMacroMetadata&&(c={name:b.presetMacroMetadata.macroName});if(c&&c.name){var e=a.getMacroJsOverride(c.name);
if(e&&typeof e.opener=="function"){e.opener(c);return}}if(!a.hasInit){d.debug("init macro browser");a.UI.showBrowserSpinner(true);if(a.initData!==null&&g.isEmptyObject(a.initData)){d.trigger("analytics",{name:"macro-browser.init-reattempt"});d.logError("Macro browser preload failed. Trying again...");a.initMacroBrowserAfterRequest=b;a.preLoadMacro();return}if(a.initData)a.initBrowser();else{d.trigger("analytics",{name:"macro-browser.init-overlap"});d.debug("Waiting for macro browser preloading...");
a.initMacroBrowserAfterRequest=b;return}}a.openMacroBrowser(b)};a.openMacroBrowser=function(b){a.settings=b;a.selectedMacroDefinition=b.selectedMacro;var c=a.selectedMacroDefinition&&a.selectedMacroDefinition.name||b.presetMacroName;if(b.presetMacroName)b.presetMacroMetadata=a.getMacroMetadata(b.presetMacroName);var e=b.presetMacroMetadata;if(!e){var i=b.selectedMacro;if(i){var c=i.name.toLowerCase(),c=a.aliasMap[c]||c,f=h[c];if(f){typeof f.updateSelectedMacro=="function"&&f.updateSelectedMacro(i);
typeof f.getMacroDetailsFromSelectedMacro=="function"&&(e=f.getMacroDetailsFromSelectedMacro(a.metadataList,i))}e||(e=a.getMacroMetadata(c))}}i=g("#macro-browser-dialog").find("button.back");if(e){d.debug("Open macro browser to edit macro: "+e.macroName);i.hide();a.replicateSelectMacro(e,b.mode||"edit")}else if(c){i.show();a.dialog.overrideLastTab();a.dialog.gotoPage(2);a.showBrowserDialog()}else{i.show();if(b.selectedCategory){c=g("#select-macro-page .dialog-page-menu button").index(g("#category-button-"+
b.selectedCategory));c<0&&(c=0);a.dialog.overrideLastTab();a.dialog.gotoPanel(0,c)}else a.dialog.gotoPage(0);a.showBrowserDialog();a.dialog.searcher.focusAndSearch(b.searchText)}};a.showBrowserDialog=function(){a.dialog.show();a.UI.showBrowserSpinner(false)};a.complete=function(){if(g("#macro-browser-dialog .dialog-button-panel .ok").is(":visible:not(:disabled)")){var b=a.dialog.activeMetadata,c=h[b.macroName];c&&c.manipulateMarkup&&c.manipulateMarkup(b);b=a.Editor.getMacroDefinitionFromForm(b);a.close();
if(a.settings.onComplete)a.settings.onComplete(b)}};a.cancel=function(){a.close();if(typeof a.settings.onCancel=="function")a.settings.onCancel();return false};a.close=function(){this.unknownParams={};this.fields={};a.Preview.removePreviewContainer();this.dialog.hide()};a.replicateSelectMacro=function(a,c){j(a,c)};a.initBrowser=function(){var b=a.initData;if(!b.categories||!a.metadataList.length){d.trigger("analytics",{name:"macro-browser.init-browser-error"});k.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");
a.UI.showBrowserSpinner(false);return false}a.editTitle=b.editTitle;a.insertTitle=b.insertTitle;var c;b.categories=g.map(b.categories,function(a){if(a.name=="hidden-macros"){c=a;return null}return a});b.categories.sort(function(a,b){return a.displayName.toLowerCase()>b.displayName.toLowerCase()?1:-1});c&&d.params.showHiddenUserMacros&&b.categories.push(c);a.dialog=a.UI.createDialog({title:b.title,categories:b.categories,macros:a.metadataList,onClickMacroSummary:function(a,b){a.preventDefault();j(b,
"insert")},onSubmit:a.complete,onCancel:a.cancel});return a.hasInit=true};a.searchSummaries=function(b,c){c=g.extend({splitRegex:/[\s\-]+/},c);return d.filterBySearch(a.metadataList,b,c)};a.getMacroBody=function(){var b="";if(g("#macro-insert-container .macro-body-div textarea").length)b=g("#macro-insert-container .macro-body-div textarea").val();else if(a.selectedMacroDefinition){if(a.selectedMacroDefinition.body)b=a.selectedMacroDefinition.body}else if(a.dialog.activeMetadata)b=a.dialog.activeMetadata.formDetails.body.content;
return b};a.isHiddenMacroShown=function(a){return d.params.showHiddenUserMacros&&a.pluginKey=="_-user-macro-_"};a.hasRequiredParameters=function(a){return a.anyParameterRequired};a.setWhitelist=function(b){a.whitelist=b};a.preLoadMacro=function(){a.initData=null;if(f&&f.state()==="pending")return f;f=a.Rest.loadMacroMetadata({data:a.whitelist?{whitelist:a.whitelist}:{detailed:false},successCallback:function(b){a.initData=b;a.Model.loadMacros(b.macros);if(a.initMacroBrowserAfterRequest){a.initBrowser();
a.openMacroBrowser(a.initMacroBrowserAfterRequest)}},errorCallback:function(b){d.trigger("analytics",{name:"macro-browser.preload-error"});d.logError("Error requesting macro browser metadata:");d.logError(b);a.initData={}}})};return a});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-browser","AJS.MacroBrowser");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser.soy' */
// This file was automatically generated from macro-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }


Confluence.Templates.MacroBrowser.macroSummaryList = function(opt_data, opt_ignored) {
  return '<ol id="category-' + soy.$$escapeHtml(opt_data.category) + '" class="macro-list"></ol>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryList.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryList';
}


Confluence.Templates.MacroBrowser.macroSummaryItem = function(opt_data, opt_ignored) {
  return '<li class="macro-list-item"><h4 class="macro-title"></h4>' + Confluence.Templates.MacroBrowser.macroDescription({description: ''}) + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryItem.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryItem';
}


Confluence.Templates.MacroBrowser.macroDescription = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="macro-desc">' + ((opt_data.descriptionHtml) ? soy.$$filterNoAutoescape(opt_data.descriptionHtml) : '') + ((opt_data.documentationLink) ? ' <a href="' + soy.$$escapeHtml(opt_data.documentationLink) + '" class="macro-doco-link">' + soy.$$escapeHtml("Documentation") + '</a>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroDescription.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroDescription';
}


Confluence.Templates.MacroBrowser.insertMacroPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-insert-container"><input class="macro-name" type="hidden"/><div class="macro-input-fields dialog-panel"><form action="#" class="aui"></form></div><div class="macro-preview-container dialog-panel"><div class="macro-preview-header"><ul class="macro-preview-links"><li><a id="macro-browser-preview-link" class="refresh-link icon icon-refresh" href="#">' + soy.$$escapeHtml("Refresh") + '</a></li></ul><span>' + soy.$$escapeHtml("Preview") + '</span></div><div id="macro-browser-preview" class="macro-preview"></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.insertMacroPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.insertMacroPanel';
}


Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-missing-metadata-container"><p>' + "There is no metadata configured for this macro which means no configuration screen can be presented here." + '</p>' + ((opt_data.showAdminMessage) ? '<p>' + AJS.format("If this is a user macro then you can add metadata to the template using the \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3eUser Macro Administration\x3c/a\x3e console.","" + '/admin/usermacros.action') + '</p>' : '<p>' + "You must contact an administrator to configure metadata for this macro." + '</p>') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel';
}


Confluence.Templates.MacroBrowser.macroParameter = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><input type="text" class="text"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameter.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameter';
}


Confluence.Templates.MacroBrowser.macroParameterBoolean = function(opt_data, opt_ignored) {
  return '<div class="checkbox macro-param-div boolean-param"><input class="checkbox" type="checkbox" value="true"/><label></label></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterBoolean.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterBoolean';
}


Confluence.Templates.MacroBrowser.macroParameterSelect = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><select class="select"></select></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterSelect.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterSelect';
}


Confluence.Templates.MacroBrowser.macroParameterHidden = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><input type="hidden"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterHidden.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterHidden';
}


Confluence.Templates.MacroBrowser.macroParameterDesc = function(opt_data, opt_ignored) {
  return '<div class="macro-param-desc">' + soy.$$filterNoAutoescape(opt_data.description) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterDesc.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterDesc';
}


Confluence.Templates.MacroBrowser.macroBody = function(opt_data, opt_ignored) {
  return '<div class="macro-body-div"><label>' + soy.$$escapeHtml("Body text") + '</label><textarea class="monospaceInput textarea" type="text" rows="10"></textarea></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroBody.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroBody';
}


Confluence.Templates.MacroBrowser.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-59/Macros"});
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.helpLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.helpLink';
}


Confluence.Templates.MacroBrowser.gadgetLink = function(opt_data, opt_ignored) {
  return '<a class=\'macro-uri\' href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.url) + '" target=\'_blank\'>' + soy.$$escapeHtml("Gadget URL") + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.gadgetLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.gadgetLink';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preload.js' */
define("confluence-macro-browser/macro-browser-preload",["jquery","ajs","window"],function(a,b,c){return{macroBrowserPreload:function(){a(c).bind("render-content-loaded",function(c,d){a("#macro-preview-iframe").contents().find("body")[0]==d&&b.MacroBrowser.previewOnload(d)});b.MacroBrowser.preLoadMacro()}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preload",function(a){require("ajs").toInit(a.macroBrowserPreload)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:moment', location = '/includes/js/dist/moment.js' */
(function(){function R(a,b){return function(c){return k(a.call(this,c),b)}}function pa(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function S(){}function B(a){T(a);m(this,a)}function C(a){var a=U(a),b=a.year||0,c=a.month||0,d=a.week||0,f=a.day||0;this._milliseconds=+(a.millisecond||0)+1E3*(a.second||0)+6E4*(a.minute||0)+36E5*(a.hour||0);this._days=+f+7*d;this._months=+c+12*b;this._data={};this._bubble()}function m(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);b.hasOwnProperty("toString")&&
(a.toString=b.toString);b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf);return a}function s(a){return 0>a?Math.ceil(a):Math.floor(a)}function k(a,b,c){for(var d=Math.abs(a)+"";d.length<b;)d="0"+d;return(0<=a?c?"+":"":"-")+d}function D(a,b,c,d){var f=b._milliseconds,i=b._days,b=b._months,g,h;f&&a._d.setTime(+a._d+f*c);if(i||b)g=a.minute(),h=a.hour();i&&a.date(a.date()+i*c);b&&a.month(a.month()+b*c);f&&!d&&e.updateOffset(a);if(i||b)a.minute(g),a.hour(h)}function E(a){return"[object Array]"===Object.prototype.toString.call(a)}
function V(a,b,c){var d=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),e=0,g;for(g=0;g<d;g++)(c&&a[g]!==b[g]||!c&&h(a[g])!==h(b[g]))&&e++;return e+f}function l(a){if(a)var b=a.toLowerCase().replace(/(.)s$/,"$1"),a=qa[a]||ra[b]||b;return a}function U(a){var b={},c,d;for(d in a)a.hasOwnProperty(d)&&(c=l(d))&&(b[c]=a[d]);return b}function sa(a){var b,c;if(0===a.indexOf("week"))b=7,c="day";else if(0===a.indexOf("month"))b=12,c="month";else return;e[a]=function(d,f){var i,g,h=e.fn._lang[a],
j=[];"number"===typeof d&&(f=d,d=void 0);g=function(a){a=e().utc().set(c,a);return h.call(e.fn._lang,a,d||"")};if(null!=f)return g(f);for(i=0;i<b;i++)j.push(g(i));return j}}function h(a){var a=+a,b=0;0!==a&&isFinite(a)&&(b=0<=a?Math.floor(a):Math.ceil(a));return b}function F(a){return 0===a%4&&0!==a%100||0===a%400}function T(a){var b;if(a._a&&-2===a._pf.overflow){b=0>a._a[t]||11<a._a[t]?t:1>a._a[q]||a._a[q]>(new Date(Date.UTC(a._a[o],a._a[t]+1,0))).getUTCDate()?q:0>a._a[n]||23<a._a[n]?n:0>a._a[u]||
59<a._a[u]?u:0>a._a[x]||59<a._a[x]?x:0>a._a[y]||999<a._a[y]?y:-1;if(a._pf._overflowDayOfYear&&(b<o||b>q))b=q;a._pf.overflow=b}}function W(a){a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function X(a){null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&0>a._pf.overflow&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&
0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length));return a._isValid}function G(a){return a?a.toLowerCase().replace("_","-"):a}function H(a,b){return b._isUTC?e(a).zone(b._offset||0):e(a).local()}function p(a){var b=0,c,d,f,i,g=function(a){if(!v[a]&&Y)try{require("./lang/"+a)}catch(b){}return v[a]};if(!a)return e.fn._lang;if(!E(a)){if(d=g(a))return d;a=[a]}for(;b<a.length;){i=G(a[b]).split("-");c=i.length;for(f=(f=G(a[b+1]))?f.split("-"):null;0<c;){if(d=g(i.slice(0,c).join("-")))return d;if(f&&
f.length>=c&&V(i,f,!0)>=c-1)break;c--}b++}return e.fn._lang}function I(a,b){if(!a.isValid())return a.lang().invalidDate();b=Z(b,a.lang());if(!J[b]){var c=J,d=b,f=b,e=f.match($),g,h;g=0;for(h=e.length;g<h;g++)e[g]=r[e[g]]?r[e[g]]:e[g].match(/\[[\s\S]/)?e[g].replace(/^\[|\]$/g,""):e[g].replace(/\\/g,"");c[d]=function(a){var b="";for(g=0;g<h;g++)b+=e[g]instanceof Function?e[g].call(a,f):e[g];return b}}return J[b](a)}function Z(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(z.lastIndex=
0;0<=d&&z.test(a);)a=a.replace(z,c),z.lastIndex=0,d-=1;return a}function ta(a,b){var c=b._strict;switch(a){case "DDDD":return aa;case "YYYY":case "GGGG":case "gggg":return c?ua:va;case "YYYYYY":case "YYYYY":case "GGGGG":case "ggggg":return c?wa:xa;case "S":if(c)return ba;case "SS":if(c)return ca;case "SSS":case "DDD":return c?aa:ya;case "MMM":case "MMMM":case "dd":case "ddd":case "dddd":return za;case "a":case "A":return p(b._l)._meridiemParse;case "X":return Aa;case "Z":case "ZZ":return K;case "T":return Ba;
case "SSSS":return Ca;case "MM":case "DD":case "YY":case "GG":case "gg":case "HH":case "hh":case "mm":case "ss":case "ww":case "WW":return c?ca:da;case "M":case "D":case "d":case "H":case "h":case "m":case "s":case "w":case "W":case "e":case "E":return c?ba:da;default:var c=RegExp,d;d=a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return new c(d)}}function ea(a){var a=(a||"").match(K)||[],a=((a[a.length-
1]||[])+"").match(Da)||["-",0,0],b=+(60*a[1])+h(a[2]);return"+"===a[0]?-b:b}function L(a){var b,c=[],d,f,i,g,j;if(!a._d){d=new Date;d=a._useUTC?[d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()]:[d.getFullYear(),d.getMonth(),d.getDate()];a._w&&(null==a._a[q]&&null==a._a[t])&&(b=function(b){var c=parseInt(b,10);return b?3>b.length?68<c?1900+c:2E3+c:c:null==a._a[o]?e().weekYear():a._a[o]},f=a._w,null!=f.GG||null!=f.W||null!=f.E?b=fa(b(f.GG),f.W||1,f.E,4,1):(i=p(a._l),g=null!=f.d?ga(f.d,i):null!=f.e?
parseInt(f.e,10)+i._week.dow:0,j=parseInt(f.w,10)||1,null!=f.d&&g<i._week.dow&&j++,b=fa(b(f.gg),j,g,i._week.doy,i._week.dow)),a._a[o]=b.year,a._dayOfYear=b.dayOfYear);if(a._dayOfYear){b=null==a._a[o]?d[o]:a._a[o];if(a._dayOfYear>(F(b)?366:365))a._pf._overflowDayOfYear=!0;b=ha(b,0,a._dayOfYear);a._a[t]=b.getUTCMonth();a._a[q]=b.getUTCDate()}for(b=0;3>b&&null==a._a[b];++b)a._a[b]=c[b]=d[b];for(;7>b;b++)a._a[b]=c[b]=null==a._a[b]?2===b?1:0:a._a[b];c[n]+=h((a._tzm||0)/60);c[u]+=h((a._tzm||0)%60);a._d=
(a._useUTC?ha:Ea).apply(null,c)}}function M(a){a._a=[];a._pf.empty=!0;var b=p(a._l),c=""+a._i,d,f,e,g,j=c.length,k=0;f=Z(a._f,b).match($)||[];for(b=0;b<f.length;b++){e=f[b];if(d=(c.match(ta(e,a))||[])[0])g=c.substr(0,c.indexOf(d)),0<g.length&&a._pf.unusedInput.push(g),c=c.slice(c.indexOf(d)+d.length),k+=d.length;if(r[e]){d?a._pf.empty=!1:a._pf.unusedTokens.push(e);g=a;var m=void 0,l=g._a;switch(e){case "M":case "MM":null!=d&&(l[t]=h(d)-1);break;case "MMM":case "MMMM":m=p(g._l).monthsParse(d);null!=
m?l[t]=m:g._pf.invalidMonth=d;break;case "D":case "DD":null!=d&&(l[q]=h(d));break;case "DDD":case "DDDD":null!=d&&(g._dayOfYear=h(d));break;case "YY":l[o]=h(d)+(68<h(d)?1900:2E3);break;case "YYYY":case "YYYYY":case "YYYYYY":l[o]=h(d);break;case "a":case "A":g._isPm=p(g._l).isPM(d);break;case "H":case "HH":case "h":case "hh":l[n]=h(d);break;case "m":case "mm":l[u]=h(d);break;case "s":case "ss":l[x]=h(d);break;case "S":case "SS":case "SSS":case "SSSS":l[y]=h(1E3*("0."+d));break;case "X":g._d=new Date(1E3*
parseFloat(d));break;case "Z":case "ZZ":g._useUTC=!0;g._tzm=ea(d);break;case "w":case "ww":case "W":case "WW":case "d":case "dd":case "ddd":case "dddd":case "e":case "E":e=e.substr(0,1);case "gg":case "gggg":case "GG":case "GGGG":case "GGGGG":e=e.substr(0,2),d&&(g._w=g._w||{},g._w[e]=d)}}else a._strict&&!d&&a._pf.unusedTokens.push(e)}a._pf.charsLeftOver=j-k;0<c.length&&a._pf.unusedInput.push(c);a._isPm&&12>a._a[n]&&(a._a[n]+=12);!1===a._isPm&&12===a._a[n]&&(a._a[n]=0);L(a);T(a)}function Ea(a,b,c,
d,f,e,g){b=new Date(a,b,c,d,f,e,g);1970>a&&b.setFullYear(a);return b}function ha(a){var b=new Date(Date.UTC.apply(null,arguments));1970>a&&b.setUTCFullYear(a);return b}function ga(a,b){if("string"===typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!==typeof a)return null}else a=parseInt(a,10);return a}function Fa(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function A(a,b,c){b=c-b;c-=a.day();c>b&&(c-=7);c<b-7&&(c+=7);a=e(a).add("d",c);return{week:Math.ceil(a.dayOfYear()/7),year:a.year()}}function fa(a,
b,c,d,e){var i=(new Date(k(a,6,!0)+"-01-01")).getUTCDay(),b=7*(b-1)+((null!=c?c:e)-e)+(e-i+(i>d?7:0))+1;return{year:0<b?a:a-1,dayOfYear:0<b?b:(F(a-1)?366:365)+b}}function ia(a){var b=a._i,c=a._f;"undefined"===typeof a._pf&&W(a);if(null===b)return e.invalid({nullInput:!0});"string"===typeof b&&(a._i=b=p().preparse(b));if(e.isMoment(b))a=m({},b),a._d=new Date(+b._d);else if(c)if(E(c)){var b=a,d,f,i,g;if(0===b._f.length)b._pf.invalidFormat=!0,b._d=new Date(NaN);else{for(c=0;c<b._f.length;c++)if(g=0,
d=m({},b),W(d),d._f=b._f[c],M(d),X(d)&&(g+=d._pf.charsLeftOver,g+=10*d._pf.unusedTokens.length,d._pf.score=g,null==i||g<i))i=g,f=d;m(b,f||d)}}else M(a);else if(d=a,f=d._i,i=Ga.exec(f),void 0===f)d._d=new Date;else if(i)d._d=new Date(+i[1]);else if("string"===typeof f)if(i=d._i,b=Ha.exec(i)){d._pf.iso=!0;for(f=4;0<f;f--)if(b[f]){d._f=Ia[f-1]+(b[6]||" ");break}for(f=0;4>f;f++)if(ja[f][1].exec(i)){d._f+=ja[f][0];break}i.match(K)&&(d._f+="Z");M(d)}else d._d=new Date(i);else E(f)?(d._a=f.slice(0),L(d)):
"[object Date]"===Object.prototype.toString.call(f)||f instanceof Date?d._d=new Date(+f):"object"===typeof f?d._d||(f=U(d._i),d._a=[f.year,f.month,f.day,f.hour,f.minute,f.second,f.millisecond],L(d)):d._d=new Date(f);return new B(a)}function ka(a,b){e.fn[a]=e.fn[a+"s"]=function(a){var d=this._isUTC?"UTC":"";return null!=a?(this._d["set"+d+b](a),e.updateOffset(this),this):this._d["get"+d+b]()}}function Ja(a){e.duration.fn[a]=function(){return this._data[a]}}function la(a,b){e.duration.fn["as"+a]=function(){return+this/
b}}function N(a){var b=!1,c=e;"undefined"===typeof ender&&(a?(O.moment=function(){!b&&(console&&console.warn)&&(b=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release."));return c.apply(null,arguments)},m(O.moment,c)):O.moment=e)}for(var e,O=this,w=Math.round,j,o=0,t=1,q=2,n=3,u=4,x=5,y=6,v={},Y="undefined"!==typeof module&&module.exports&&"undefined"!==typeof require,Ga=/^\/?Date\((\-?\d+)/i,Ka=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,
La=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,$=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,z=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,da=/\d\d?/,ya=/\d{1,3}/,va=/\d{1,4}/,xa=/[+\-]?\d{1,6}/,Ca=/\d+/,za=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,
K=/Z|[\+\-]\d\d:?\d\d/gi,Ba=/T/i,Aa=/[\+\-]?\d+(\.\d{1,3})?/,ba=/\d/,ca=/\d\d/,aa=/\d{3}/,ua=/\d{4}/,wa=/[+\-]?\d{6}/,Ha=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ia=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],ja=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Da=/([\+\-]|\d\d)/gi,P=["Date","Hours","Minutes","Seconds","Milliseconds"],
Q={Milliseconds:1,Seconds:1E3,Minutes:6E4,Hours:36E5,Days:864E5,Months:2592E6,Years:31536E6},qa={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},ra={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},J={},ma="DDD w W M D d".split(" "),na="MDHhmswW".split(""),r={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,
a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return k(this.year()%100,2)},YYYY:function(){return k(this.year(),4)},YYYYY:function(){return k(this.year(),
5)},YYYYYY:function(){var a=this.year();return(0<=a?"+":"-")+k(Math.abs(a),6)},gg:function(){return k(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return k(this.weekYear(),5)},GG:function(){return k(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return k(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},
A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return h(this.milliseconds()/100)},SS:function(){return k(h(this.milliseconds()/10),2)},SSS:function(){return k(this.milliseconds(),3)},SSSS:function(){return k(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";0>a&&(a=-a,b="-");return b+k(h(a/60),2)+":"+
k(h(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";0>a&&(a=-a,b="-");return b+k(h(a/60),2)+k(h(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},oa=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ma.length;)j=ma.pop(),r[j+"o"]=pa(r[j],j);for(;na.length;)j=na.pop(),r[j+j]=R(r[j],2);r.DDDD=R(r.DDD,3);m(S.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"===typeof b?
this[c]=b:this["_"+c]=b},_months:"January February March April May June July August September October November December".split(" "),months:function(a){return this._months[a.month()]},_monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c;this._monthsParse||(this._monthsParse=[]);for(b=0;12>b;b++)if(this._monthsParse[b]||(c=e.utc([2E3,b]),c="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),
this._monthsParse[b]=RegExp(c.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c;this._weekdaysParse||
(this._weekdaysParse=[]);for(b=0;7>b;b++)if(this._weekdaysParse[b]||(c=e([2E3,1]).day(b),c="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=RegExp(c.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,
function(a){return a.slice(1)}),this._longDateFormat[a]=b);return b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return 11<a?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"===typeof c?c.apply(b):c},_relativeTime:{future:"in %s",
past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"===typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[0<a?"future":"past"];return"function"===typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},
postformat:function(a){return a},week:function(a){return A(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});e=function(a,b,c,d){"boolean"===typeof c&&(d=c,c=void 0);return ia({_i:a,_f:b,_l:c,_strict:d,_isUTC:!1})};e.utc=function(a,b,c,d){"boolean"===typeof c&&(d=c,c=void 0);return ia({_useUTC:!0,_isUTC:!0,_l:c,_i:a,_f:b,_strict:d}).utc()};e.unix=function(a){return e(1E3*a)};e.duration=function(a,b){var c=a,d=
null,f;if(e.isDuration(a))c={ms:a._milliseconds,d:a._days,M:a._months};else if("number"===typeof a)c={},b?c[b]=a:c.milliseconds=a;else if(d=Ka.exec(a))f="-"===d[1]?-1:1,c={y:0,d:h(d[q])*f,h:h(d[n])*f,m:h(d[u])*f,s:h(d[x])*f,ms:h(d[y])*f};else if(d=La.exec(a))f="-"===d[1]?-1:1,c=function(a){a=a&&parseFloat(a.replace(",","."));return(isNaN(a)?0:a)*f},c={y:c(d[2]),M:c(d[3]),d:c(d[4]),h:c(d[5]),m:c(d[6]),s:c(d[7]),w:c(d[8])};d=new C(c);e.isDuration(a)&&a.hasOwnProperty("_lang")&&(d._lang=a._lang);return d};
e.version="2.5.0";e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";e.updateOffset=function(){};e.lang=function(a,b){if(!a)return e.fn._lang._abbr;if(b){var c=G(a);b.abbr=c;v[c]||(v[c]=new S);v[c].set(b)}else null===b?(delete v[a],a="en"):v[a]||p(a);return(e.duration.fn._lang=e.fn._lang=p(a))._abbr};e.langData=function(a){a&&(a._lang&&a._lang._abbr)&&(a=a._lang._abbr);return p(a)};e.isMoment=function(a){return a instanceof B};e.isDuration=function(a){return a instanceof C};for(j=oa.length-1;0<=j;--j)sa(oa[j]);
e.normalizeUnits=function(a){return l(a)};e.invalid=function(a){var b=e.utc(NaN);null!=a?m(b._pf,a):b._pf.userInvalidated=!0;return b};e.parseZone=function(a){return e(a).parseZone()};m(e.fn=B.prototype,{clone:function(){return e(this)},valueOf:function(){return+this._d+6E4*(this._offset||0)},unix:function(){return Math.floor(+this/1E3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var a=
e(this).utc();return 0<a.year()&&9999>=a.year()?I(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):I(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){return[this.year(),this.month(),this.date(),this.hours(),this.minutes(),this.seconds(),this.milliseconds()]},isValid:function(){return X(this)},isDSTShifted:function(){return this._a?this.isValid()&&0<V(this._a,(this._isUTC?e.utc(this._a):e(this._a)).toArray()):!1},parsingFlags:function(){return m({},this._pf)},invalidAt:function(){return this._pf.overflow},
utc:function(){return this.zone(0)},local:function(){this.zone(0);this._isUTC=!1;return this},format:function(a){a=I(this,a||e.defaultFormat);return this.lang().postformat(a)},add:function(a,b){var c;c="string"===typeof a?e.duration(+b,a):e.duration(a,b);D(this,c,1);return this},subtract:function(a,b){var c;c="string"===typeof a?e.duration(+b,a):e.duration(a,b);D(this,c,-1);return this},diff:function(a,b,c){var a=H(a,this),d=6E4*(this.zone()-a.zone()),f,b=l(b);"year"===b||"month"===b?(f=432E5*(this.daysInMonth()+
a.daysInMonth()),d=12*(this.year()-a.year())+(this.month()-a.month()),d+=(this-e(this).startOf("month")-(a-e(a).startOf("month")))/f,d-=6E4*(this.zone()-e(this).startOf("month").zone()-(a.zone()-e(a).startOf("month").zone()))/f,"year"===b&&(d/=12)):(f=this-a,d="second"===b?f/1E3:"minute"===b?f/6E4:"hour"===b?f/36E5:"day"===b?(f-d)/864E5:"week"===b?(f-d)/6048E5:f);return c?d:s(d)},from:function(a,b){return e.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(e(),
a)},calendar:function(){var a=H(e(),this).startOf("day"),a=this.diff(a,"days",!0);return this.format(this.lang().calendar(-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse",this))},isLeapYear:function(){return F(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=ga(a,this.lang()),this.add({d:a-
b})):b},month:function(a){var b=this._isUTC?"UTC":"",c;if(null!=a){if("string"===typeof a&&(a=this.lang().monthsParse(a),"number"!==typeof a))return this;c=this.date();this.date(1);this._d["set"+b+"Month"](a);this.date(Math.min(c,this.daysInMonth()));e.updateOffset(this);return this}return this._d["get"+b+"Month"]()},startOf:function(a){a=l(a);switch(a){case "year":this.month(0);case "month":this.date(1);case "week":case "isoWeek":case "day":this.hours(0);case "hour":this.minutes(0);case "minute":this.seconds(0);
case "second":this.milliseconds(0)}"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1);return this},endOf:function(a){a=l(a);return this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){b="undefined"!==typeof b?b:"millisecond";return+this.clone().startOf(b)>+e(a).startOf(b)},isBefore:function(a,b){b="undefined"!==typeof b?b:"millisecond";return+this.clone().startOf(b)<+e(a).startOf(b)},isSame:function(a,b){b=b||"ms";return+this.clone().startOf(b)===+H(a,this).startOf(b)},
min:function(a){a=e.apply(null,arguments);return a<this?this:a},max:function(a){a=e.apply(null,arguments);return a>this?this:a},zone:function(a){var b=this._offset||0;if(null!=a)"string"===typeof a&&(a=ea(a)),16>Math.abs(a)&&(a*=60),this._offset=a,this._isUTC=!0,b!==a&&D(this,e.duration(b-a,"m"),1,!0);else return this._isUTC?b:this._d.getTimezoneOffset();return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){this._tzm?
this.zone(this._tzm):"string"===typeof this._i&&this.zone(this._i);return this},hasAlignedHourOffset:function(a){a=a?e(a).zone():0;return 0===(this.zone()-a)%60},daysInMonth:function(){var a=this.year(),b=this.month();return(new Date(Date.UTC(a,b+1,0))).getUTCDate()},dayOfYear:function(a){var b=w((e(this).startOf("day")-e(this).startOf("year"))/864E5)+1;return null==a?b:this.add("d",a-b)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(a){var b=A(this,this.lang()._week.dow,
this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=A(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=A(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},get:function(a){a=
l(a);return this[a]()},set:function(a,b){a=l(a);if("function"===typeof this[a])this[a](b);return this},lang:function(a){if(void 0===a)return this._lang;this._lang=p(a);return this}});for(j=0;j<P.length;j++)ka(P[j].toLowerCase().replace(/s$/,""),P[j]);ka("year","FullYear");e.fn.days=e.fn.day;e.fn.months=e.fn.month;e.fn.weeks=e.fn.week;e.fn.isoWeeks=e.fn.isoWeek;e.fn.toJSON=e.fn.toISOString;m(e.duration.fn=C.prototype,{_bubble:function(){var a=this._milliseconds,b=this._days,c=this._months,d=this._data;
d.milliseconds=a%1E3;a=s(a/1E3);d.seconds=a%60;a=s(a/60);d.minutes=a%60;a=s(a/60);d.hours=a%24;b+=s(a/24);d.days=b%30;c+=s(b/30);d.months=c%12;b=s(c/12);d.years=b},weeks:function(){return s(this.days()/7)},valueOf:function(){return this._milliseconds+864E5*this._days+2592E6*(this._months%12)+31536E6*h(this._months/12)},humanize:function(a){var b=+this,c;c=!a;var d=this.lang(),e=w(Math.abs(b)/1E3),i=w(e/60),g=w(i/60),h=w(g/24),j=w(h/365),e=45>e&&["s",e]||1===i&&["m"]||45>i&&["mm",i]||1===g&&["h"]||
22>g&&["hh",g]||1===h&&["d"]||25>=h&&["dd",h]||45>=h&&["M"]||345>h&&["MM",w(h/30)]||1===j&&["y"]||["yy",j];e[2]=c;e[3]=0<b;e[4]=d;c=Fa.apply({},e);a&&(c=this.lang().pastFuture(b,c));return this.lang().postformat(c)},add:function(a,b){var c=e.duration(a,b);this._milliseconds+=c._milliseconds;this._days+=c._days;this._months+=c._months;this._bubble();return this},subtract:function(a,b){var c=e.duration(a,b);this._milliseconds-=c._milliseconds;this._days-=c._days;this._months-=c._months;this._bubble();
return this},get:function(a){a=l(a);return this[a.toLowerCase()+"s"]()},as:function(a){a=l(a);return this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:e.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),h=Math.abs(this.seconds()+this.milliseconds()/1E3);return!this.asSeconds()?"P0D":(0>this.asSeconds()?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||h?"T":"")+(d?d+"H":
"")+(e?e+"M":"")+(h?h+"S":"")}});for(j in Q)Q.hasOwnProperty(j)&&(la(j,Q[j]),Ja(j.toLowerCase()));la("Weeks",6048E5);e.duration.fn.asMonths=function(){return(+this-31536E6*this.years())/2592E6+12*this.years()};e.lang("en",{ordinal:function(a){var b=a%10,b=1===h(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});Y?(module.exports=e,N(!0)):"function"===typeof define&&define.amd?define("moment",function(a,b,c){c.config&&(c.config()&&!0!==c.config().noGlobal)&&N(void 0===c.config().noGlobal);
return e}):N()}).call(this);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:moment', location = '/includes/js/amd/shim/moment-amd.js' */
define("moment",function(){return moment});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.js' */
define("confluence-editor/editor/page-editor","ajs confluence/legacy jquery document window confluence/meta".split(" "),function(c,d,b,k,F,g){function u(a){b("#editpageform").find("input[name='atl_token']").val(a);g.set("atl-token",a);g.set("atlassian-token",a);b("#atlassian-token").attr("content",a)}var v=c.DarkFeatures.isEnabled("editor.ajax.save")&&!c.DarkFeatures.isEnabled("editor.ajax.save.disable")&&g.get("remote-user")!=="",o=[],l=[],m=[],w=false,j=1,p,H=function(a){var b=true;p&&p.close();
for(var c=0;c<l.length;c++){l[c](a)===false&&(b=false);if(a.isImmediatePropagationStopped())break}if(!b||a.isDefaultPrevented()||a.isPropagationStopped())return false;a.preventDefault();x(a).done(y).fail(G)},G=function(a){require(["aui/flag"],function(a){p=a({type:"error",body:"Unable to communicate with server. Saving is not possible at the moment."})});a&&c.trigger("analytics",{name:"editor.save.error."+a.origin+"."+a.cause,data:{message:a.message}});d.Editor.UI.toggleSavebarBusy(false)},x=function(){var a=b.Deferred();
a.resolve();return a.promise()},y=function(){b(d.Editor.getCurrentForm()).submit()};c.bind("rte-ready",function(){d.Editor.UI.saveButton.bind("click",H)});var I=function(){var a;for(a=0;a<o.length;a++)d.Editor.UI.cancelButton.click(o[a]);var c=b(d.Editor.getCurrentForm());for(a=0;a<m.length;a++)c.submit(m[a]);b.unbind("init.rte",this)},z=function(a,d,e,f){f.push(e);if(c.Rte&&c.Rte.BootstrapManager&&c.Rte.BootstrapManager.isInitComplete())a.bind(d,e);else if(!w){w=true;b.bind("init.rte",I)}},q=function(a,
b,d){var f=null;c.Rte&&(c.Rte.BootstrapManager&&c.Rte.BootstrapManager.isInitComplete())&&(f=function(a,b,c){a.unbind(b,c)});for(var n=d.pop();n;){f&&f(a,b,n);n=d.pop()}},A=function(a){if(i!==a){i&&i.clear();a.start(d.Editor.heartbeat);i=a}},i,B=g.getNumber("heartbeat-interval")||3E4,r,C;r={start:function(a){c.debug("Changing heartbeat to the normal scheduler");C=setInterval(a,B)},clear:function(){clearInterval(C)}};var D,E=Math.max(B/5,5E3),s,t;D={start:function(a){c.debug("Changing heartbeat to the recovery scheduler");
t=0;var b=function(){a();var c=E*Math.pow(2,t);s=setTimeout(b,Math.min(c,3E5));t++};s=setTimeout(b,E)},clear:function(){clearTimeout(s)}};return{bookmark:"",MODE_RICHTEXT:"richtext",MODE_SOURCE:"source",MODE_PREVIEW:"preview",PREVIEW_OUTPUT_TYPE:"PREVIEW",currentEditMode:null,contentHasChangedSinceLastSave:false,sourceInitialValue:false,isSubmitting:false,isCancelling:false,overrideBeforeSave:function(a){x=a},overrideSave:function(a){y=a},getNumConcurrentEditors:function(){return j},addCancelHandler:function(a){z(d.Editor.UI.cancelButton,
"click",a,o)},addSaveHandler:function(a){l.push(a)},addSubmitHandler:function(a){z(b(d.Editor.getCurrentForm()),"submit",a,m)},removeAllCancelHandlers:function(){q(d.Editor.UI.cancelButton,"click",o)},removeAllSaveHandlers:function(){q(d.Editor.UI.saveButton,"click",l)},removeAllSubmitHandlers:function(){q(b(d.Editor.getCurrentForm()),"submit",m)},hasContentChanged:function(){return!this.inRichTextMode()&&!this.contentHasChangedSinceLastSave?false:this.editorHasContentChanged()},editorHasContentChanged:function(){if(c.Rte.getEditor()==
null){c.debug("Confluence.Editor: editorHasContentChanged - No active editor present. Returning false.");return false}return c.Rte.Content.editorHasContentChanged()},isEmpty:function(){var a=b(c.Rte.getEditor().getContent()).text();return!b.trim(a)},getResumeDraftUrl:function(){var a=[];a.push(c.contextPath());a.push("/pages/"+(c.params.newPage?"create":"edit")+c.params.draftType+".action");a.push("?useDraft=true");a.push("&pageId="+c.params.pageId);a.push("&contentChanged="+this.hasContentChanged());
this.getCurrentForm().spaceKey&&a.push("&spaceKey="+g.get("space-key"));return a.join("")},getCurrentTitle:function(){return b("#content-title")&&b("#content-title").val()},contentFormSubmit:function(){d.Editor.Drafts.unBindUnloadMessage();b(".editable-title #content-title").prop("disabled",true);return true},heartbeat:function(){var a={dataType:"json",contentId:d.Editor.Drafts.isNewContent()?c.params.draftId:c.params.pageId,draftType:c.params.draftType,spaceKey:c.params.spaceKey},h=g.getBoolean("shared-drafts"),
e=g.get("content-type")==="page"||g.get("content-type")==="blogpost",f=c.params.pageId!=="0";!e||!f&&!h?c.safe.post(c.params.contextPath+"/json/heartbeat.action",{},function(a){a&&a.atlToken&&u(a.atlToken);c.trigger("rte.heartbeat",a)},"json").fail(function(a){(a.status>=500||a.status===0)&&d.Editor.heartbeatType.recovery();c.trigger("rte.heartbeat-error",a)}):c.safe.post(c.params.contextPath+"/json/startheartbeatactivity.action",a,function(a){if(!a||!a.atlToken||!(a.activityResponses instanceof Array)){c.trigger("rte.heartbeat-error",
"Invalid server response");c.logError("Unexpected server response for heartbeat:");c.log(a)}else{var h=a.activityResponses;u(a.atlToken);d.Editor.heartbeatType.normal();c.trigger("rte.heartbeat",h);j=(h.length||0)+1;if(j>1){var e=!v?b("#other-users-span"):b("#reliable-other-users-span").length===0?b("<span id='reliable-other-users-span'></span>"):b("#reliable-other-users-span");e.empty();for(var f=0;f<j-1;++f){f>0&&e.append(", ");var g=h[f];e.append(c("a").attr("href",c.params.contextPath+"/display/~"+
encodeURIComponent(g.userName)).text(g.fullName));g.lastEditMessage!=null&&e.append(" ").append(c("span").addClass("smalltext").text(g.lastEditMessage))}v&&b("#reliable-other-users-span").length===0&&e.html().trim()!==""&&d.Editor.SafeSave.Message.handleMessage("heartBeat",{type:"info",message:c.format("This page is also being edited by {0}. Your changes will be merged with theirs when you save.","<span id='reliable-other-users-span'>"+e.html()+"</span>")});c.isVisible("#heartbeat-div")||c.Confluence.Analytics.publish("rte.notification.concurrent-editing",
{numEditors:j,pageId:c.params.pageId,draftType:c.params.draftType})}c.setVisible("#heartbeat-div",j>1);b(k).trigger("resize.resizeplugin");c.trigger("editor-heartbeat",a)}},"json").fail(function(a,b,h){(a.status>=500||a.status===0)&&d.Editor.heartbeatType.recovery();if(a.status===403||a.status===401)c.logError("Heartbeat error: Unauthorized");else{c.logError("Server error on heartbeat request:");c.log(h)}c.trigger("rte.heartbeat-error",a)})},heartbeatType:{normal:function(){A(r)},recovery:function(){A(D)},
reset:function(){i&&i.clear();i=r;i.start(d.Editor.heartbeat)}},disableFrame:function(a){b("form",a).each(function(){b(this).unbind();this.onsubmit=function(){return false}});b("a",a).each(function(){b(this).attr("target","_top").unbind()});b("input, img",a).each(function(){b(this).unbind()})},previewFrameOnload:function(a,h){var e=require("tinymce");d.Editor.setMode(d.Editor.MODE_PREVIEW);e.activeEditor.setProgressState(false);d.Editor.disableFrame(a);var f=b("#main",a)[0];if(g.get("content-type")!=
"comment"&&b(f).find("#main-header").length===0){var n=b("#title-heading"),i=n.attr("class");b(f).prepend('<div id="preview-header"><div id="title-heading" class="'+i+'">'+n.html()+"</div></div>")}b("a",a).attr("target","_parent");if(b(c.Rte.getEditor().getBody()).hasClass("resizable")){var j=b(h||"#previewArea iframe"),o=0,l=0,m,p=j.height();f&&function J(){var a=b(f).outerHeight(true);if(o!=a){a!=j.height()&&j.height(0).height(Math.max(a,p));o=a;l=0}else l++;l<500&&(m=setTimeout(J,500))}();b(k).one("mode-changed.resize-editor",
function(a,b){b!=d.Editor.MODE_PREVIEW&&m&&clearTimeout(m)})}else if(e.isIE||e.isOpera){e=b(F).height();n=b("#header-precursor").height()+b("#header").height()+b("#editor-precursor").height();i=b("#savebar-container").height();b("#preview iframe").height(e-n-i-4);b("#content.edit").height("auto")}},showRichText:function(a){var h=require("tinymce");c.setVisible("#wysiwyg",a);b(".toolbar-group-preview").toggleClass("assistive",!a);b(".toolbar-group-edit").toggleClass("assistive",a);b("#main").toggleClass("active-richtext",
a);h.isGecko&&a&&c.Rte.fixEditorFocus(d.Editor.bookmark)},showPreview:function(a){if(g.get("content-type")!=="comment"){var d=b("#content-title");if(d.hasClass("placeholded")){b("#preview-title-text").text("");b("#title-text").text("")}else{b("#preview-title-text").text(d.val());b("#title-text").text(d.val())}}c.setVisible("#preview",a);b(".toolbar-group-preview").toggleClass("assistive",a);b(".toolbar-group-edit").toggleClass("assistive",!a);b("#main").toggleClass("active-preview",a);b("#full-height-container").length&&
b("#full-height-container").toggleClass("active-preview",a)},showSource:function(a){a?this.showSourceArea():this.hideSourceArea();b("#main")[a?"addClass":"removeClass"]("active-source")},setMode:function(a){c.debug("Set mode: "+a);if(a==d.Editor.MODE_RICHTEXT){this.showRichText(true);this.showPreview(false);this.showSource(false)}else if(a==d.Editor.MODE_SOURCE){this.showSource(true);this.showRichText(false);this.showPreview(false)}else if(a==d.Editor.MODE_PREVIEW){this.showPreview(true);this.showRichText(false);
this.showSource(false);d.Editor.UI.spinner.removeClass("aui-icon-wait")}setTimeout(function(){var a=b(".toolbar-group-preview");a.height(0);a.height();a.height("auto")},1);this.currentEditMode=a;b(k).trigger("mode-changed",[a])},getContentId:function(){return d.getContentId()},addErrorMessage:function(a,d,e){var f=b("#"+a),e=e?"#all-messages":"#editor-messages";f.length?f.empty():f=b("<div></div>").attr("id",a).appendTo(e);c.messages.error(f,{closeable:true,body:d})},changeMode:function(a,h){var e=
require("tinymce");c.debug("Change mode: "+a);h=h||{};if(this.inRichTextMode()&&!c.Rte.BootstrapManager.isInitComplete()||this.currentEditMode==a)return false;var f=this.currentEditMode;c.trigger("rte-changeMode",a);if(a==d.Editor.MODE_PREVIEW){var i=c.Rte.getEditor();f==d.Editor.MODE_SOURCE&&d.Editor.transferSourceToEditor();if(e.isGecko&&f==d.Editor.MODE_RICHTEXT&&!d.Editor.bookmark)d.Editor.bookmark=e.activeEditor.selection.getBookmark();this.currentEditMode=a;e={contentId:d.getContentId(),contentType:g.get("content-type"),
spaceKey:g.get("space-key"),xHtml:i.getContent(),outputType:d.Editor.PREVIEW_OUTPUT_TYPE};c.safe.ajax({type:"POST",url:c.params.contextPath+"/pages/rendercontent.action",data:e,success:d.Editor.replysetPreviewArea,timeout:2E4,error:function(){c.trigger("rte-preview-action-selected");d.Editor.addErrorMessage("preview-error","There was an error loading preview. Please try again later.");d.Editor.currentEditMode=f;h.errorCallback&&h.errorCallback()}})}else this.setMode(a);a==d.Editor.MODE_RICHTEXT&&b(k).trigger("resize.resizeplugin");
return false},replysetPreviewArea:function(a){var d=require("tinymce");c.trigger("rte-preview-action-selected");b("#preview-error").remove();var e=c.params.staticResourceUrlPrefix+"/blank.html";d.activeEditor.setProgressState(true);b("#previewArea").html('<iframe id="editor-preview-iframe" src="'+e+'" scrolling="yes" frameborder="0"></iframe>');d=b("#previewArea iframe")[0];d=d.contentDocument||d.contentWindow.document;d.write(a);d.close()},inRichTextMode:function(){return this.currentEditMode==d.Editor.MODE_RICHTEXT},
isNewPage:function(){return b("#createpageform, #createpagetemplate").length>0},onInit:function(){var a=require("tinymce");d.Editor.setMode(d.Editor.MODE_RICHTEXT);a.activeEditor.onClick.add(function(){var a=d.Editor.UI.postingDatePicker;a&&a.hide()})},contentChangeHandler:function(){this.contentHasChangedSinceLastSave=true},getCurrentForm:function(){return require("tinymce").activeEditor.formElement},transferSourceToEditor:function(){var a=d.Editor;if(a.sourceInitialValue){var b=a.getSourceAreaVal();
if(b!=a.sourceInitialValue){var c=require("tinymce").activeEditor;c.setContent(b);c.setDirty(b)}}a.sourceInitialValue=false},hideSourceArea:function(){b("#editor-html-source-container").addClass("hidden");this.setToolBarInactive(false);this.transferSourceToEditor();b("#rte-button-source-mode").removeClass("active");b("#rte-button-publish").unbind("click.source-save")},showSourceArea:function(){var a=require("tinymce");b("#editor-html-source-container").removeClass("hidden");this.setSourceAreaHeight();
this.setToolBarInactive(true);this.sourceInitialValue=a.activeEditor.getContent();this.setSourceAreaVal(this.sourceInitialValue);b("#rte-button-source-mode").addClass("active");b("#rte-button-publish").bind("click.source-save",d.Editor.transferSourceToEditor)},getSourceAreaVal:function(){return b("#editor-html-source").val()},setSourceAreaVal:function(a){b("#editor-html-source").val(a)},setSourceAreaHeight:function(){var a=c.Rte.getTinyMceEditorMinHeight();c.debug("HTML source height= "+a);var d=
b("#editor-html-source")[0].scrollHeight;if(d>a){a=d;c.debug("ACTUAL HEIGHT "+d)}b("#editor-html-source-container").height(a+"px")},setToolBarInactive:function(a){b("#rte-toolbar").toggleClass("disabled",a)},isVisible:function(){return b("#wysiwyg:visible").length>0||b("#editor-html-source-container:visible").length>0||b("#preview:visible").length>0}}});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor",function(c){var d=require("confluence/legacy"),b=require("jquery"),k=require("ajs");d.Editor=b.extend(d.Editor||{},c);k.toInit(function(){k.bind("init.rte",d.Editor.onInit)});k.Editor=d.Editor});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-ui.js' */
define("confluence-editor/editor/page-editor-ui","jquery confluence/templates ajs confluence/legacy window moment document".split(" "),function(d,i,b,c,j,p,g){return function(){var a={},h=function(b){for(var c=0;c<a.buttons.length;c++)m(b,a.buttons[c])},m=function(a,b){b&&(a?b.removeAttr("aria-disabled"):b.attr("aria-disabled","true"))},n=function(a){return a.length&&a.attr("aria-disabled")!=="true"},k=function(){return b.Meta.get("new-page")},o=function(){var a="";k()||(a="Edit"+
" - ");return a};a.spinner=d("#rte-spinner");var e;e=i.Editor.Page.saveButton({contentType:b.Meta.get("content-type")});d("#rte-button-publish").replaceWith(e);e=d("#rte-button-publish");a.saveButton=e;a.overwriteButton=d("#rte-button-overwrite");a.editButton=d("#rte-button-edit");a.previewButton=d("#rte-button-preview");a.cancelButton=d("#rte-button-cancel");a.watchPageCheckbox=d("#watchPage");a.watchPageToolbarGroup=d(".toolbar-group-watch-page");a.buttons=[a.saveButton,a.overwriteButton,a.editButton,
a.previewButton,a.cancelButton];a.setButtonsState=h;a.setButtonState=m;a.isButtonEnabled=n;a.registerFormButton=function(b,c){a[b]=c;a.buttons.push(c)};a.postingDatePicker=null;a.isFormEnabled=function(){for(var b=0;b<a.buttons.length;b++)if(n(a.buttons[b]))return true;return false};a.toggleSavebarBusy=function(b){if(b){if(!a.isFormEnabled())return false;a.spinner.addClass("aui-icon-wait");h(false)}else{a.spinner.removeClass("aui-icon-wait");h(true)}return true};a.init=function(){c.Editor.addSaveHandler(function(b){if(a.isButtonEnabled(a.saveButton))a.toggleSavebarBusy(true);
else{b.stopImmediatePropagation();b.preventDefault()}});b.trigger("rte.init.ui");c.Editor.isNewPage()&&d("#content-title").focus().select();c.Editor.addCancelHandler(function(){c.Editor.getNumConcurrentEditors()>1&&b.Confluence.Analytics.publish("rte.notification.concurrent-editing.cancel",{numEditors:c.Editor.getNumConcurrentEditors(),pageId:b.params.pageId,draftType:b.params.draftType})});b.Meta.get("content-type")==="comment"&&c.Editor.addSaveHandler(function(){if(b.Rte.Content.isEmpty()){b.Confluence.EditorNotification.notify("warning",
"Comment text is empty. Cannot create empty comments.");a.toggleSavebarBusy(false);return false}});(b.Meta.get("content-type")==="comment"||b.Meta.get("content-type")==="template")&&c.Editor.addCancelHandler(function(d){if(a.isFormEnabled()&&c.Editor.hasContentChanged()&&!c.Editor.isEmpty()){var l=b.Meta.get("content-type")==="comment"?"Your comment will be lost.":"Your unsaved template changes will be lost.";if(!j.confirm(l)){d.stopImmediatePropagation();return false}}});c.Editor.addSaveHandler(function(){c.Editor.getNumConcurrentEditors()>
1&&b.Confluence.Analytics.publish("rte.notification.concurrent-editing.save",{numEditors:c.Editor.getNumConcurrentEditors(),pageId:b.params.pageId,draftType:b.params.draftType})});c.Editor.addSubmitHandler(function(a){return c.Editor.contentFormSubmit(a)});this.currentEditMode=this.MODE_RICHTEXT;a.editButton.click(function(d){var l=require("tinymce");if(a.isFormEnabled()){c.Editor.changeMode(c.Editor.MODE_RICHTEXT);setTimeout(function(){b.Rte.getEditor().focus();l.isGecko&&c.Editor.bookmark&&b.Rte.getEditor().selection.moveToBookmark(c.Editor.bookmark)},
0);a.cancelButton.enable()}d.preventDefault()});a.previewButton.click(function(b){var d=require("tinymce");if(a.isFormEnabled()&&c.Editor.currentEditMode!==c.Editor.MODE_PREVIEW){h(false);a.spinner.addClass("aui-icon-wait");if(d.isGecko&&!c.Editor.bookmark)c.Editor.bookmark=d.activeEditor.selection.getBookmark();c.Editor.changeMode(c.Editor.MODE_PREVIEW,{errorCallback:function(){h(true);a.spinner.removeClass("aui-icon-wait")}});a.cancelButton.disable()}b.preventDefault()});d("#editor-html-source").change(c.Editor.setSourceAreaHeight).keyup(c.Editor.setSourceAreaHeight);
d("#rte-button-labels").bind("updateLabel",function(){var a=+b.Meta.get("num-labels")||0,c="Labels";a===1?c=b.format("{0} Label",a):a>1&&(c=b.format("{0} Labels",a));d("#rte-button-labels").attr("data-tooltip",c)});var f=d("#PostingDate");if(f.length){f.attr("max",p().format("YYYY-MM-DD"));a.postingDatePicker=f.datePicker({overrideBrowserDefault:true});a.postingDatePicker.hide()}d("#wysiwygTextarea_parent .mceProgress, #wysiwygTextarea_parent .mceBlocker").on("click",
function(){b.Rte.getEditor().focus()});d(j).bind("render-content-loaded",function(b,e){var f=d("#previewArea iframe");if(f.contents().find("body")[0]==e){c.Editor.previewFrameOnload(e,f);a.setButtonsState(true);f.focus();j.focus();d(g).trigger("iframeAppended",f)}});if(b.Meta.get("heartbeat")){c.Editor.heartbeat();c.Editor.heartbeatType.normal()}b.bind("watchpage.pageoperation",function(){a.toggleWatchPage(false)});b.bind("unwatchpage.pageoperation",function(){a.toggleWatchPage(true)});if(k()&&b.Meta.get("form-name")===
"inlinecommentform")g.title="Edit"+g.title;var e=g.title;if(k()&&d.trim(d("input#content-title").val()))g.title=o()+d("input#content-title").val()+" - "+b.Meta.get("space-name")+" - "+b.Meta.get("site-title");d("input#content-title").on("change input",function(){if(b.Meta.get("content-type")!=="template"){var a=o();g.title=d.trim(this.value)?a+this.value+" - "+b.Meta.get("space-name")+" - "+b.Meta.get("site-title"):e}});b.trigger("init.rte-control")};a.toggleWatchPage=function(c){if(c&&
b.Meta.get("content-type")==="comment"){a.watchPageToolbarGroup.show();if(a.watchPageCheckbox.length)a.watchPageCheckbox[0].checked=false}else a.watchPageToolbarGroup.hide()};return a}});require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-ui",function(d){var i=require("confluence/legacy");require("ajs").bind("init.rte",function(){var b=d();i.Editor.UI=b;b.init()})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'tinymce3/plugins/insertwiki/insert-wiki-markup.soy' */
// This file was automatically generated from insert-wiki-markup.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.InsertWiki.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.InsertWiki == 'undefined') { Confluence.Templates.InsertWiki = {}; }


Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><textarea class=\'monospaceInput textarea originalDefault\' id=\'insert-wiki-textarea\' name=\'wikitext\'/></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog';
}


Confluence.Templates.InsertWiki.previewWikiIframeContent = function(opt_data, opt_ignored) {
  return '<!DOCTYPE html><html class="insert-wiki-markup-dialog"><head></head><body class="wiki-content previewWiki"></body></html>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.previewWikiIframeContent.soyTemplateName = 'Confluence.Templates.InsertWiki.previewWikiIframeContent';
}


Confluence.Templates.InsertWiki.wikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<p id="insert-wiki-info-title">' + soy.$$escapeHtml("Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page.") + '</p><form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><h3 class="wiki-title"><span id="insert-wiki-insert-title">' + soy.$$escapeHtml("Insert") + '</span><span id="insert-wiki-preview-title">' + soy.$$escapeHtml("Preview") + '</span></h3><textarea class=\'monospaceInput textarea\' id=\'insert-wiki-textarea\' name=\'wikitext\'/><!-- --><div class=\'example-container\' id=\'insert-wiki-textarea-preview\'></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiMarkupDialog';
}


Confluence.Templates.InsertWiki.wikiErrorSubDialog = function(opt_data, opt_ignored) {
  return '<p class=\'warning\'>' + soy.$$escapeHtml(opt_data.warningMessage) + '</p><p class=\'exception-report\'><span class=\'exceptionMessage\'>' + soy.$$escapeHtml(opt_data.exceptionMessage) + '</span></p>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiErrorSubDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiErrorSubDialog';
}


Confluence.Templates.InsertWiki.wikiParserSelector = function(opt_data, opt_ignored) {
  var output = '<span class="wiki-parser-selector"><form action="#" method="post" id="d" class="aui"><select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector"><option value="' + soy.$$escapeHtml(opt_data.DEFAULT.val) + '">' + soy.$$escapeHtml(opt_data.DEFAULT.label) + '</option>';
  var wikiLangList26 = soy.$$getMapKeys(opt_data.WIKI);
  var wikiLangListLen26 = wikiLangList26.length;
  for (var wikiLangIndex26 = 0; wikiLangIndex26 < wikiLangListLen26; wikiLangIndex26++) {
    var wikiLangData26 = wikiLangList26[wikiLangIndex26];
    output += (opt_data.WIKI[wikiLangData26].val != opt_data.DEFAULT.val) ? '<option value="' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].val) + '">' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].label) + '</option>' : '';
  }
  output += '</select></form></span>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiParserSelector.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiParserSelector';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" class="aui-button aui-button-primary" type="submit" name="confirm" value="Save"' + ((opt_data.contentType == 'blogpost') ? 'title="' + soy.$$escapeHtml("Publish your blog post") + '"' : (opt_data.contentType == 'page') ? 'title="' + soy.$$escapeHtml("Save your page") + '"' : 'title="' + soy.$$escapeHtml("Save") + '"') + 'tabindex="101">' + ((opt_data.contentType == 'blogpost') ? '<span class="trigger-text">' + soy.$$escapeHtml("Publish") + '</span>' : '<span class="trigger-text">' + soy.$$escapeHtml("Save") + '</span>') + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'insert-image-dialog/insert-image-dialog.js' */
define("confluence-editor/insert-image-dialog/insert-image-dialog",["jquery","ajs","underscore","confluence/legacy"],function(c,f,e,h){var g={beforeShowListeners:[],panelComponent:[],sizeToFit:function(){this.each(function(){var a=this,b=c(this).parent(),d=b.height();b.children().each(function(){this!==a&&c(this).is(":visible")&&(d-=c(this).outerHeight())});b=c(this).outerHeight()-c(this).height();c(this).css("height",Math.max(0,d-b)+"px")});return this},defaultInsertImageDialog:function(){f.Rte.BookmarkManager.storeBookmark();
g.insertImageDialog(function(a){var b=require("tinymce");f.Rte.BookmarkManager.restoreBookmark();var d={};if(a.url)d={url:a.url,filename:a.url,contentId:a.contentId},b.confluence.ImageUtils.insertFromProperties(d);else{var i=!0,h=1<a.selectItems.length;e.each(a.selectItems,function(a){a.isImage()?(d={filename:a.getFileName(),contentId:a.get("ownerId")},b.confluence.ImageUtils.insertFromProperties(d,h)):(i=!1,f.MacroBrowser.getMacroMetadata("view-file")?g._insertFilePlaceholderToEditor(a):g._insertLinkToEditor(a))});
require(["conf/confluence-drag-and-drop/analytics/files-upload-analytics"],function(b){b.triggerEvent("confluence.insert-files-dialog.insert",a.selectItems,i)})}c("#comments-section").length&&f.Rte.fixEditorFocus()},function(){f.Rte.BookmarkManager.restoreBookmark()})},findPanelComponentById:function(a){for(var b=h.Editor.ImageDialog.panelComponent,d=0,c=b.length;d<c;d++)if(b[d].id==a)return b[d]},insertImageDialog:function(a,b){var d=new h.Editor.FileDialog.FileDialogView({submitCallback:a,cancelCallback:b,
beforeShowListeners:g.beforeShowListeners,panelComponents:g.panelComponent});d.render();return d},_insertLinkToEditor:function(a){var b=h.Link.fromREST(a.attributes);b.attrs["data-linked-resource-container-id"]=a.get("ownerId");b.attrs.href=a.get("downloadUrl");b.insert()},_insertFilePlaceholderToEditor:function(a){var b={name:a.get("fileName"),page:a.get("parentTitle"),space:a.get("space")?a.get("space").key:"",date:a.get("datePath"),ownerId:a.get("ownerId")};require(["confluence-editor/utils/attachments-insert-utils"],
function(a){a.insertFilePlaceholder(b)})}};return g});
require("confluence/module-exporter").safeRequire("confluence-editor/insert-image-dialog/insert-image-dialog",function(c){var f=require("jquery"),e=require("confluence/legacy");f.fn.sizeToFit=c.sizeToFit;e.Editor.ImageDialog=c;e.Editor.defaultInsertImageDialog=c.defaultInsertImageDialog;e.Editor.ImageDialog.findPanelComponentById=c.findPanelComponentById;e.Editor.insertImageDialog=c.insertImageDialog;e.Editor.ImageDialog._insertLinkToEditor=c._insertLinkToEditor;e.Editor.ImageDialog._insertFilePlaceholderToEditor=
c._insertFilePlaceholderToEditor});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'panel-components/panel-components-init.js' */
define("confluence-editor/panel-components/panel-components-init",["confluence/legacy","ajs"],function(a,d){return function(){if(a.Editor&&a.Editor.ImageDialog&&a.Editor.ImageDialog.panelComponent){var b=a.Editor.FileDialog.eventListener,e=a.Editor.FileDialog.ExternalPanelView,f=a.Editor.FileDialog.SearchPanelView,g=a.Editor.FileDialog.AttachmentsPanelView,c=a.Editor.ImageDialog.panelComponent;"template"!==d.Meta.get("content-type")&&(b=new g({eventListener:b}),c.push(b));c.push(new e);c.push(new f)}}});
require("confluence/module-exporter").safeRequire("confluence-editor/panel-components/panel-components-init",function(a){require("ajs").toInit(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'drafts/page-editor-drafts.js' */
define("confluence-editor/page-editor-drafts",["jquery","ajs","confluence/legacy"],function(d,a,b){var k=!1,j=!1,l=""!==a.Meta.get("remote-user"),m=a.DarkFeatures.isEnabled("editor.ajax.save")&&!a.DarkFeatures.isEnabled("editor.ajax.save.disable"),h=function(a,c,b){d("<input>").attr({type:"hidden",name:a,value:c}).appendTo(b)};return{isDraftSaved:function(){return k},isDraftManuallySaved:function(){return j},isDraftBlank:function(){return a.Rte.Content.isEmpty()&&!d.trim(b.Editor.getCurrentTitle())},
isNewContent:function(){return a.Rte.getEditor()&&0==a.Meta.get("page-id")&&0<a.Meta.get("draft-id")},unloadMessage:function(){var d=function(){b.Editor.Drafts.isDraftBlank()?b.Editor.Drafts.discardDraft(a.Meta.get("draft-id")):b.Editor.Drafts.save({skipErrorHandler:!0})};if("undefined"!==typeof seleniumAlert)d();else if(b.Editor.hasContentChanged()||b.Editor.Drafts.isDraftSaved()&&!b.Editor.Drafts.isDraftManuallySaved())return d(),"A draft will be saved. You can resume editing this draft the next time you open the editor or view all your drafts in your profile."},bindUnloadMessage:function(){d(window).bind("beforeunload.editor",
b.Editor.Drafts.unloadMessage)},unBindUnloadMessage:function(){d(window).unbind("beforeunload.editor")},useDraft:function(){var e=a.Meta.get("existing-draft-id");b.Editor.Drafts.unBindUnloadMessage();var c=b.Editor.getCurrentForm();h("useDraft","true",c);h("contentChanged",""+b.Editor.hasContentChanged(),c);h("pageId",a.params.pageId,c);d("#draftId",b.Editor.getCurrentForm()).val(e);c.spaceKey||h("spaceKey",a.Meta.get("space-key"),c);c.action=a.contextPath()+"/pages/"+(a.params.newPage?"create":"edit")+
a.params.draftType+".action";c.submit()},discardDraft:function(b){a.safe.ajax({url:a.contextPath()+"/json/deletedraft.action",type:"GET",dataType:"json",data:{draftId:b},success:function(b){if(b.actionErrors){for(var e=["<ul>"],b=b.actionErrors,f=0;f<b.length;f++)a.log("error: "+b[f]),e.push("<li>"+b[f]+"</li>");e.push("</ul>");a.messages.error("#editor-messages",{title:"Error",body:"There were errors discarding your draft: "+e.join("\n")})}else d("#draft-messages").remove(),a.messages.success("#editor-messages",
{body:"Your draft has been discarded."})},error:function(b){a.messages.error({title:"Error",body:b.errors||"An unknown error has occurred. Please check your logs."})}})},save:function(e){e=e||{};if(b.Editor.isSubmitting||!b.Editor.hasContentChanged()&&!e.forceSave)a.debug("skipping draft save");else{a.debug("preparing to save editor draft");var c=d("#content-title"),h=d("#newSpaceKey"),f=d("#originalVersion"),n=b.Editor.inRichTextMode(),c={draftId:a.Meta.get("draft-id"),pageId:a.params.pageId,type:a.params.draftType,
title:c.hasClass("placeholded")?"":c.val(),spaceKey:h.length?h.val():encodeURIComponent(a.Meta.get("space-key")),content:a.Rte.getEditor().getContent()};f.length&&(c.pageVersion=parseInt(f.val(),10));d.ajax({type:"POST",url:a.params.contextPath+"/rest/tinymce/1/drafts",data:d.toJSON(c),contentType:"application/json",dataType:"text json",success:function(c){if(c!=null&&(!(l&&c.draftId===0)||!m)){b.Editor.contentHasChangedSinceLastSave=false;n&&a.Rte.Content.editorResetContentChanged();k=true;j=!!e.manualSave;
a.Meta.set("draft-id",c.draftId+"");d("#draftId",b.Editor.getCurrentForm()).val(c.draftId);d("#draft-error").remove();if(!a.Meta.get("synchrony-dark-enabled")){var h=d("#draft-status"),g;if(!(g=c.time)){var i=new Date;g=i.getHours();var i=i.getMinutes(),f=g>11?"PM":"AM";g=g%12;g=(g==0?"12":g)+":"+(i<10?"0":"")+i+" "+f}i=j?a.format("Draft saved at {0}",g):a.format("Draft autosaved at {0}",g);f=a.params.newPage?i:"<a id='view-diff-link-heartbeat' class='view-diff-link' href='#'>"+i+"</a>";
h.attr("data-tooltip",i);h.html(f)}+a.Meta.get("content-id")||a.Meta.set("content-id",c.pageId+"");if(d.isFunction(e.onSuccessHandler))e.onSuccessHandler(c);b.Editor.Drafts.lastSaveTime=g;a.trigger("rte-draft-saved",{draftId:c.draftId})}},error:function(c,f){if(!e.skipErrorHandler){b.Editor.addErrorMessage("draft-error",b.Editor.Drafts.lastSaveTime?a.format("Error saving draft. Last draft saved at {0}",b.Editor.Drafts.lastSaveTime):"Error saving draft. No draft has been saved.",true);if(d.isFunction(e.onErrorHandler))e.onErrorHandler(f)}},
timeout:3E4})}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/page-editor-drafts","Confluence.Editor.Drafts");
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-permissions.js' */
define("confluence-editor/editor/page-editor-permissions",["ajs","jquery"],function(b,d){var c={updateEditPageRestrictions:function(c,a,e,g){var f=d("#rte-button-restrictions"),i=f.find(".icon"),h="";c||a?(i.removeClass("icon-restricted icon-restricted-inherited icon-unrestricted").addClass(c?"icon-restricted":"icon-restricted-inherited"),h="Restrictions apply"):(i.removeClass("icon-restricted icon-restricted-inherited icon-unrestricted").addClass("icon-unrestricted"),h=e?"Restrictions apply":
"Unrestricted");f.attr("data-tooltip",h);f.data("explicit-restrictions",c);f.data("inherited-restrictions",a);f.data("restrictionsHash",g)},handleHeartbeat:function(j,a){if("undefined"!==typeof a.restrictionsHash){var e=d("#rte-button-restrictions");if(e.data("restrictionsHash")!==a.restrictionsHash)if(d("#update-page-restrictions-dialog").is(":visible")&&b.PagePermissions.updateRestrictionsDialog)b.PagePermissions.updateRestrictionsDialog(),e.data("restrictionsHash",a.restrictionsHash);
else{var g=""!==a.restrictionsHash,f=a.hasViewRestrictions,e=!!e.data("inherited-restrictions");c.updateEditPageRestrictions(f,e,g,a.restrictionsHash)}}},init:function(){b.bind("editor-heartbeat",c.handleHeartbeat);b.bind("edit-page-restrictions-updated",function(b,a){c.updateEditPageRestrictions(a.hasExplicitRestrictions,a.hasInheritedRestrictions,a.hasAnyExplicitRestrictions,a.restrictionsHash)})}};return c});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-permissions",function(b){var d=require("ajs"),c=require("jquery");d.PagePermissions=d.PagePermissions||{};c.extend(d.PagePermissions,{updateEditPageRestrictions:b.updateEditPageRestrictions});d.toInit(b.init)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/js/draft-changes.js' */
define("confluence/draft-changes",["jquery","ajs","window","confluence/legacy"],function(f,a,l,c){return{init:function(){var e,k=function(e){var c="Are you sure you want to discard this draft?";return confirm(c)?(a.safe.ajax({url:a.contextPath()+"/json/deletedraft.action",type:"GET",dataType:"json",data:{draftId:e},success:function(d){if(d.actionErrors){for(var c=["<ul>"],d=d.actionErrors,b=0;b<d.length;b++)a.log("error: "+d[b]),c.push("<li>"+d[b]+"</li>");c.push("</ul>");a.messages.error("#errors",
{title:"Error",body:"There were errors discarding your draft."+" "+c.join("\n")})}else c=f("#draft-"+e),d=c.closest("table"),b=d.closest(".drafts-container"),c.remove(),0===d.find("tbody tr").length&&b.append('<span id="no-drafts-message">'+"No drafts found."+"</span>")},error:function(c){a.messages.error({title:"Error",body:c.errors||"An unknown error has occurred. Please check your logs."})}}),!0):!1};f("body").on("click",".view-diff-link",function(m){var j=
this.id,d=f(this);if(!e){var h="view-diff-link-notification"===j;e=new a.Dialog(860,530,"view-diff-draft-dialog");var b="Unpublished Changes for \'{0}\'";e.addHeader(b.replace(/\{0\}/,""));b=f(c.Templates.DraftChanges.dialogContent());e.addPanel("Diff",b);h&&(e.addButton("Edit",function(){e.hide();c.Editor&&c.Editor.Drafts?c.Editor.Drafts.useDraft():l.location=f(this).attr("data-href")},"resume-diff-link"),e.addButton("Discard",function(){if(a.DarkFeatures.isEnabled("editor.ajax.save")&&
!a.DarkFeatures.isEnabled("editor.ajax.save.disable")&&""!==a.Meta.get("remote-user"))c.Editor.SafeSave.Draft.discardDraft(a.params.pageId,a.Meta.get("existing-draft-id")).done(c.Editor.SafeSave.Draft.onSuccessDiscardDraft).fail(c.Editor.SafeSave.Draft.onErrorDiscardDraft),e.hide();else if(c.Editor&&c.Editor.Drafts)e.hide(),c.Editor.Drafts.discardDraft(a.Meta.get("existing-draft-id")),a.Confluence.Analytics.publish("rte.notification.draft.discard");else{var b=f(this).data("draftid");k(b)&&e.hide()}},
"discard-diff-link"));e.addCancel("Close",function(){e.hide();return false});b.removeClass("hidden")}e.addHeader("Loading");f("#diff-view").html("<tr><td id='draft-changes-waiting-icon'>Loading...</td></tr>");var i,b=d.attr("class"),g=/draftPageId:([^ ]*)/.exec(b),d=g?g[1]:a.Meta.get("page-id"),h=(g=/username:([^ ]*)/.exec(b))?g[1]:a.Meta.get("remote-user");i=(g=/draftId:([^ ]*)/.exec(b))?g[1]:null;a.safe.ajax({url:a.contextPath()+"/draftchanges/viewdraftchanges.action",
type:"GET",dataType:"json",data:{pageId:d,username:h},success:function(b){if(b.actionErrors){for(var d="",b=b.actionErrors,g=0;g<b.length;g++)a.log("error: "+b[g]),d=d+"<div>"+b[g]+"</div>";f("#diff-view").html(d)}else f("#diff-view").html(b.htmlDiff),d=a.format("Unpublished Changes for \'\'{0}\'\'",a.escapeHtml(b.title)),e.addHeader(d),e.popup.element.find(".dialog-title").prepend(c.Templates.DraftChanges.helpLink()),d=a.contextPath(),f(".resume-diff-link").attr("data-href",d+"/pages/resumedraft.action?draftId="+
i),f(".discard-diff-link").data("draftid",i),a.setVisible("#merge-warning",b.isMergeRequired)},error:function(a){a=a.errors||"An unknown error has occurred. Please check your logs";f("#diff-view").html(a)}});e.show();a.trigger("analytics",{name:"confluence.editor.view-diff-dialog.open",data:{elementTriggerId:j}});return a.stopEvent(m)});f("#draft-space-list").on("click",".discard-draft-link",function(c){c.preventDefault();a.Confluence.Analytics.publish("confluence.draft-list.discard");c=f(this).data("draftid");
k(c)}).on("click",".resume-draft-link",function(){a.Confluence.Analytics.publish("confluence.draft-list.resume")})}}});require("confluence/module-exporter").safeRequire("confluence/draft-changes",function(f){require("ajs").toInit(f.init)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/soy/draft-changes-dialog.soy' */
// This file was automatically generated from draft-changes-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.DraftChanges.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.DraftChanges == 'undefined') { Confluence.Templates.DraftChanges = {}; }


Confluence.Templates.DraftChanges.dialogContent = function(opt_data, opt_ignored) {
  return '<div id="draft-changes-dialog" class="hidden"><div id="diff-view" class="wiki-content"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.dialogContent.soyTemplateName = 'Confluence.Templates.DraftChanges.dialogContent';
}


Confluence.Templates.DraftChanges.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-59/Drafts#viewchange"});
};
if (goog.DEBUG) {
  Confluence.Templates.DraftChanges.helpLink.soyTemplateName = 'Confluence.Templates.DraftChanges.helpLink';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'net.customware.confluence.plugin.linking:add-page-title-limit', location = 'js/add-page.js' */
(function(a){var b={};function c(e){if(b[e]){return b[e].exports}var d=b[e]={exports:{},id:e,loaded:false};a[e].call(d.exports,d,d.exports,c);d.loaded=true;return d.exports}c.m=a;c.c=b;c.p="";return c(0)})([function(b,a){AJS.toInit(function(){var f=function f(i,g){var h=AJS.MacroBrowser.ParameterFields.string(i,g);h.input.attr("maxlength",255);return h};var e={fields:{string:{name:function d(h,g){return f(h,g)},href:function c(h,g){return f(h,g)}},"confluence-content":{name:function d(h,g){return f(h,g)}}}};AJS.MacroBrowser.setMacroJsOverride("add-page",e);AJS.MacroBrowser.setMacroJsOverride("link-page",e);AJS.MacroBrowser.setMacroJsOverride("link-window",e)})}]);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/store-1.3.1.js' */
(function(){var l={},h=window,k=h.document,c="localStorage",n="globalStorage",d="__storejs__",g;l.disabled=false;l.set=function(e,o){};l.get=function(e){};l.remove=function(e){};l.clear=function(){};l.transact=function(e,o){var p=l.get(e);if(typeof p=="undefined"){p={}}o(p);l.set(e,p)};l.serialize=function(e){return JSON.stringify(e)};l.deserialize=function(e){if(typeof e!="string"){return undefined}return JSON.parse(e)};function b(){try{return(c in h&&h[c])}catch(e){return false}}function m(){try{return(n in h&&h[n]&&h[n][h.location.hostname])}catch(e){return false}}if(b()){g=h[c];l.set=function(e,o){if(o===undefined){return l.remove(e)}g.setItem(e,l.serialize(o))};l.get=function(e){return l.deserialize(g.getItem(e))};l.remove=function(e){g.removeItem(e)};l.clear=function(){g.clear()}}else{if(m()){g=h[n][h.location.hostname];l.set=function(e,o){if(o===undefined){return l.remove(e)}g[e]=l.serialize(o)};l.get=function(e){return l.deserialize(g[e]&&g[e].value)};l.remove=function(e){delete g[e]};l.clear=function(){for(var e in g){delete g[e]}}}else{if(k.documentElement.addBehavior){var j,f;try{f=new ActiveXObject("htmlfile");f.open();f.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>');f.close();j=f.w.frames[0].document;g=j.createElement("div")}catch(i){g=k.createElement("div");j=k.body}function a(e){return function(){var p=Array.prototype.slice.call(arguments,0);p.unshift(g);j.appendChild(g);g.addBehavior("#default#userData");g.load(c);var o=e.apply(l,p);j.removeChild(g);return o}}l.set=a(function(p,e,o){if(o===undefined){return l.remove(e)}p.setAttribute(e,l.serialize(o));p.save(c)});l.get=a(function(o,e){return l.deserialize(o.getAttribute(e))});l.remove=a(function(o,e){o.removeAttribute(e);o.save(c)});l.clear=a(function(q){var o=q.XMLDocument.documentElement.attributes;q.load(c);for(var p=0,e;e=o[p];p++){q.removeAttribute(e.name)}q.save(c)})}}}try{l.set(d,d);if(l.get(d)!=d){l.disabled=true}l.remove(d)}catch(i){l.disabled=true}if(typeof module!="undefined"){module.exports=l}else{if(typeof define==="function"&&define.amd){define(l)}else{this.store=l}}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/page-visibility.js' */
define("atlassian/analytics/page-visibility",function(){var a=(document.hidden!==undefined);var b={supported:a,isHidden:function(){return a?document.hidden:false}};return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/user-activity-xhr-header.js' */
define("atlassian/analytics/user-activity-xhr-header",["atlassian/analytics/page-visibility"],function(c){var e="x-atlassian-mau-ignore";var d=XMLHttpRequest.prototype.send;var a=window.fetch;var b=false;return{install:function(){if(!b&&c.supported){XMLHttpRequest.prototype.send=function(){if(c.isHidden()){this.setRequestHeader(e,c.isHidden())}d.apply(this,arguments)};if(a){window.fetch=function(f,h){var g=h||{};if(c.isHidden()){if(!g.headers){g.headers=new Headers()}g.headers.append(e,c.isHidden())}return a.call(this,f,g)}}b=true}},uninstall:function(){if(b){XMLHttpRequest.prototype.send=d;if(a){window.fetch=a}}b=false}}});require("atlassian/analytics/user-activity-xhr-header").install();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/atlassian-analytics.js' */
(function(c){var n=AJS.$.ajax;var i="atlassian-analytics";var h=typeof AJS.contextPath=="function"?AJS.contextPath():typeof AJS.Confluence!="undefined"?AJS.Confluence.getContextPath():window.contextPath!=null?window.contextPath:"";var m=null;var j=null;var e=null;var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(x){var w=Math.random()*16|0,u=x=="x"?w:(w&3|8);return u.toString(16)});var q=function(){var u="unknown";if(document.body.id=="jira"){u="jira"}else{if(document.body.id=="com-atlassian-confluence"){u="confluence"}}j=i+"."+u;e=j+".lock"};var d=function(){if(store.get(e)){return false}store.set(e,o);return(store.get(e)===o)};var r=function(){store.set(e,null)};var g=function(){var v=[],x,y,u,w;if(AJS.EventQueue.length==0){return}v=store.get(j)||v;for(u=0,w=AJS.EventQueue.length;u<w;++u){y=AJS.EventQueue[u];if(y.name){x={name:y.name,properties:y.properties,time:y.time||0};v.push(x)}}AJS.EventQueue.length=0;store.set(j,v)};var s=0;var a=function(u){return Math.min(5000*Math.pow(2,u),5*60*1000)};var f=function(){var x;function v(){setTimeout(f,a(s=0))}function u(){setTimeout(f,a(++s))}if(!d()){return v()}g();x=store.get(j);if(!x||!x.length){r();return v()}store.remove(j);r();if(!l(x)){return v()}var y=new Date().getTime();for(var w=0;w<x.length;w++){if(x[w].time>0){x[w].timeDelta=x[w].time-y}else{x[w].timeDelta=w-x.length}delete x[w].time}m=n({type:"POST",url:h+"/rest/analytics/1.0/publish/bulk",data:JSON.stringify(x),contentType:"application/json",dataType:"json"});m.fail(function(){AJS.EventQueue.concat(x);g();u()});m.done(function(){v()})};var l=function(w){for(var v=w.length-1;v>=0;v--){var y="";var x=w[v];var u=x.properties;if(typeof x.name==="undefined"){y="you must provide a name for the event."}else{if(typeof u!=="undefined"&&u!==null){if(u.constructor!==Object){y="properties must be an object with key value pairs."}else{b(u)}}}if(y!==""){AJS.log("WARN: Invalid analytics event detected and ignored, "+y+"\nEvent: "+JSON.stringify(x));w.splice(v,1)}}return w.length};var b=function(w){for(var v in w){if(w.hasOwnProperty(v)){var u=w[v];if(typeof u!=="undefined"&&u!==null&&u.toString){w[v]=u.toString()}else{w[v]=""}}}};var k=function(){if(m&&!(m.state()==="resolved"||m.state()==="rejected")){m.abort()}};AJS.EventQueue=AJS.EventQueue||[];var p=Array.prototype.push;AJS.EventQueue.push=function(u){u.time=new Date().getTime();p.call(AJS.EventQueue,u)};AJS.toInit(function(){q();setTimeout(f,500);t()});c(window).unload(function(){k();g()});AJS.Analytics={triggerPrivacyPolicySafeEvent:function(u,v){AJS.log("WARN: 'triggerPrivacyPolicySafeEvent' has been deprecated");AJS.EventQueue.push({name:u,properties:v})}};AJS.bind("analytics",function(u,v){AJS.EventQueue.push({name:v.name,properties:v.data})});AJS.bind("analyticsEvent",function(u,v){AJS.EventQueue.push({name:v.name,properties:v.data})});var t=function(){if(window.location.pathname.indexOf("/secure/admin/ViewApplicationProperties")>-1){AJS.$("[data-property-id='analytics-enabled']").remove()}else{if(window.location.pathname.indexOf("/secure/admin/EditApplicationProperties")>-1){var v=AJS.$(":contains(Enable Atlassian analytics)");if(v.size()>0){var u=v[v.size()-2];if(u){u.remove()}}}}}}(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.analytics.analytics-client:policy-update', location = 'js/policy-update.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:application-header-administration-cog-resource', location = 'header/cog.js' */
var NavLinks=(function(a){a.ApplicationHeader=function(b){b.Cog=(function(){var c=function(){var d=AJS.$("#system-admin-menu-content");if(d.length>0){return d}var e=AJS.$("#admin-menu-link-content");if(e.length>0){return e}return AJS.$("#bamboo\\.global\\.header-admin\\.menu")};return{getDropdown:c}}());return b}(a.ApplicationHeader||{});return a}(NavLinks||{}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminshortcuts.soy' */
// This file was automatically generated from adminshortcuts.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace navlinks.templates.adminshortcuts.
 */

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.adminshortcuts == 'undefined') { navlinks.templates.adminshortcuts = {}; }


navlinks.templates.adminshortcuts.section = function(opt_data, opt_ignored) {
  var param5 = '<ul class="aui-list-truncate">';
  var linkList7 = opt_data.links;
  var linkListLen7 = linkList7.length;
  for (var linkIndex7 = 0; linkIndex7 < linkListLen7; linkIndex7++) {
    var linkData7 = linkList7[linkIndex7];
    param5 += '<li><a href="' + soy.$$escapeHtml(linkData7.link) + '">' + soy.$$escapeHtml(linkData7.label) + '</a></li>';
  }
  param5 += '</ul>';
  var output = '' + aui.dropdown2.section({id: 'nl-remote-admin-section', label: "Other applications", content: param5});
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.adminshortcuts.section.soyTemplateName = 'navlinks.templates.adminshortcuts.section';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminnavlinks.js' */
var NavLinks=(function(a){a.AdminShortcuts=(function(){var c=function(){return AJS.$.ajax({url:AJS.contextPath()+"/rest/menu/latest/admin",cache:false,dataType:"json"})};var b=function(){AJS.$("#nl-remote-admin-section").on("click","a",function(){NL.trackEvent("remoteAdminItemSelected",NL.getCurrentApplication(),$(this).attr("href"))})};return{render:function(){c().done(function(e){e=_.reject(e,function(f){return f.local===true});if(e.length){var d=navlinks.templates.adminshortcuts.section({links:e});a.ApplicationHeader.Cog.getDropdown().append(d);b()}})}}}());return a}(NavLinks||{}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts', location = 'adminshortcuts/adminshortcuts-cdn.js' */
AJS.toInit(function(){if(AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("rotp.admin.shortcuts")){NavLinks.AdminShortcuts.render()}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.soy' */
// This file was automatically generated from projectshortcuts.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace navlinks.templates.projectshortcuts.
 */

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.projectshortcuts == 'undefined') { navlinks.templates.projectshortcuts = {}; }


navlinks.templates.projectshortcuts.dialogContent = function(opt_data, opt_ignored) {
  return '' + ((opt_data.localShortcuts && opt_data.localShortcuts.length > 0) ? navlinks.templates.projectshortcuts.dialogContentShortcuts({shortcuts: opt_data.localShortcuts, listClass: 'projectshortcut-links'}) : '') + ((opt_data.remoteShortcuts != null) ? (opt_data.remoteShortcuts.length > 0) ? '<h2 class="projectshortcuts-heading">Related Links</h2>' + navlinks.templates.projectshortcuts.dialogContentShortcuts(soy.$$augmentMap(opt_data.remoteShortcuts, {shortcuts: opt_data.remoteShortcuts, listClass: 'projectshortcut-links'})) : '' : navlinks.templates.projectshortcuts.dialogLoading(null));
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.dialogContent.soyTemplateName = 'navlinks.templates.projectshortcuts.dialogContent';
}


navlinks.templates.projectshortcuts.headingWrapper = function(opt_data, opt_ignored) {
  return '<div class="project-dialog-header-wrapper"><div class="project-header"><img class="project-img" src="' + soy.$$escapeHtml(opt_data.logoUrl) + '"><h2 class="dialog-title">' + soy.$$escapeHtml(opt_data.title) + '</h2></div><div class="project-content-wrapper">' + soy.$$filterNoAutoescape(opt_data.contentHtml) + '</div></div>';
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.headingWrapper.soyTemplateName = 'navlinks.templates.projectshortcuts.headingWrapper';
}


navlinks.templates.projectshortcuts.dialogContentShortcuts = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<ul' + ((opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '') + '>';
  var shortcutList35 = opt_data.shortcuts;
  var shortcutListLen35 = shortcutList35.length;
  for (var shortcutIndex35 = 0; shortcutIndex35 < shortcutListLen35; shortcutIndex35++) {
    var shortcutData35 = shortcutList35[shortcutIndex35];
    output += '<li' + ((shortcutIndex35 == shortcutListLen35 - 1) ? ' class="last"' : '') + '>' + navlinks.templates.projectshortcuts.dialogContentShortcut(shortcutData35) + '</li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.dialogContentShortcuts.soyTemplateName = 'navlinks.templates.projectshortcuts.dialogContentShortcuts';
}


navlinks.templates.projectshortcuts.dialogContentShortcut = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml(opt_data.link) + '"' + ((opt_data.tooltip) ? ' title="' + soy.$$escapeHtml(opt_data.tooltip) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.label) + '</a>';
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.dialogContentShortcut.soyTemplateName = 'navlinks.templates.projectshortcuts.dialogContentShortcut';
}


navlinks.templates.projectshortcuts.dialogLoading = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="projectshortcuts-loading">' + ((opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '') + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.dialogLoading.soyTemplateName = 'navlinks.templates.projectshortcuts.dialogLoading';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.js' */
(function(e,g){var i,k={},m="key",b="name",j="entity-type";function f(s){var n=e(this),o=n.data(m),q=n.data(b),p=n.data(j);if(typeof o==="undefined"){return}s.preventDefault();i=new AJS.Dialog({width:600,keypressListener:function(u){if(u.which==jQuery.ui.keyCode.ESCAPE){i.remove()}},id:"project-shortcuts-dialog"}).addCancel("Close",function(){i.remove()}).addPanel("",navlinks.templates.projectshortcuts.headingWrapper({title:q,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogLoading({text:"Retrieving links"})})).show();c(i);if(!k[o]){k[o]={entity:{title:q},localShortcuts:null,remoteShortcuts:null};d(AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+o,{entityType:p}).done(t);d(AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+o,{entityType:p}).done(r).fail(function(){var u=i.getCurrentPanel().body.find(".project-content-wrapper");u.find(".projectshortcuts-loading").remove();AJS.messages.error(u,{body:"Could not retrieve remote project shortcuts",closeable:false});c(i)})}else{l(k[o])}function t(u){k[o].localShortcuts=u.shortcuts;l(k[o])}function r(u){k[o].remoteShortcuts=u.shortcuts;l(k[o])}}function h(){return e(".project-shortcut-dialog-trigger img").attr("src")}function l(n){if(n.localShortcuts){i.getCurrentPanel().html(navlinks.templates.projectshortcuts.headingWrapper({title:n.entity.title,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogContent(n)}));c(i)}}function a(p){var o=210;if(!p||p.length<=o){return p}var n=o;while(n>0&&p.charAt(n)!=" "){n--}if(n==0){n=o}p=p.substring(0,n);if(p.length>=n){p=p+"..."}return p}function c(n){var q=n.popup.element,p=q.find(".dialog-panel-body"),o=q.find(".dialog-components");p.height("auto");q.height(o.outerHeight()-1);e(".aui-shadow").remove()}function d(n,o){return e.ajax({url:n,cache:false,data:o,dataType:"json"})}e(document).on("click",".project-shortcut-dialog-trigger",f)}(jQuery,window.NL=(window.NL||{})));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:atlassian-ui-popup-display-controller', location = 'popups/DisplayController.js' */
AJS.Popups=AJS.Popups||{};AJS.Popups.DisplayController=function(){var c=[];var a=false;var b=false;AJS.toInit(function(){setTimeout(function(){AJS.Popups.DisplayController.render()},0)});return{request:function(d){c.push(d);if(a&&b===false){this.render()}},render:function(){c.sort(function(e,d){return e.weight-d.weight});a=true;if(c.length!==0){b=true;c[0].show()}}}}();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jira-issues-view-mode-resources', location = 'amd/confluence-shim.js' */
define("confluence/jim/confluence-shim",function(){return window.Confluence});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jira-issues-view-mode-resources', location = 'util/retry-caller.js' */
define("confluence/jim/util/retry-caller",["ajs","jquery","underscore"],function(b,d,c){var a=function(g,p){p=p||{};var h=p.args;var j=(typeof p.tester==="function")?p.tester:function(){return true};var i=p.delays||[0.1,0.3,0.5,0.7,1];var l=i.length;var e=p.name||"";var k=d.Deferred(),o=k.promise();var f=p.context||k;var n=0;var m=function(){if(n===l){return k.rejectWith(f,[f,"exceed-maximum-called-times",""])}var r=i[n++];var q=function(){d.when(g.apply(f,h)).then(function(){if(j.apply(f,arguments)){m()}else{k.resolveWith(f,arguments)}},function(){k.rejectWith(f,arguments)})};c.delay(q,r)};m();return o};return a});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jira-issues-view-mode-resources', location = 'jira/jira-issues-view-mode/fetching-job.js' */
define("confluence/jim/jira/jira-issues-view-mode/fetching-job",["jquery","ajs","confluence/jim/confluence-shim","confluence/jim/util/retry-caller"],function(d,b,e,a){var c=function(f){this.clientId=f.clientId;var g=1000;this.TICK_RETRIES=[0,1*g,1*g,2*g,3*g,5*g,8*g,13*g,13*g,13*g];this.RETRY_HTTP_CODE=202};c.prototype.startJob=function(){return this.fetchSingeJiraServer()};c.prototype.fetchSingeJiraServer=function(){var f=b.contextPath()+"/rest/jiraanywhere/1.0/jira/clientId/{0}";var g=d.ajax({type:"GET",url:b.format(f,this.clientId),cache:true});g.clientId=this.clientId;return g};c.prototype.startJobWithRetry=function(){return a(this.startJob,{name:this.clientId,delays:this.TICK_RETRIES,context:this,tester:function(g,f,h){return h&&h.status===this.RETRY_HTTP_CODE}})};return c});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jira-issues-view-mode-resources', location = 'jira/jira-issues-view-mode/lazy-loading.js' */
define("confluence/jim/jira/jira-issues-view-mode/lazy-loading",["jquery","ajs","underscore","confluence/jim/jira/jira-issues-view-mode/fetching-job"],function(c,f,j,a){var h=null;var e={renderUISingleJIMFromMacroHTML:function(l,k){j.each(l,function(o,n){var m=k.filter("[data-issue-key="+n+"]");m.each(function(p,q){c(q).replaceWith(o[p])})})},renderUISingleJIMInErrorCase:function(l,n){var m="Data cannot be retrieved due to an unexpected error.";l.find(".summary").text(m+" "+n);l.find(".jira-status").remove();l.find(".issue-placeholder").remove();l.find(".aui-icon-wait").remove();var k="aui-message aui-message-warning jim-error-message jim-error-message-single ";l.removeClass("jira-issue").addClass(k)}};var i={handleSuccessAjax:function(m,l,n){var k=h.filter("[data-client-id="+n.clientId+"]");e.renderUISingleJIMFromMacroHTML(m.htmlMacro,k)},handleErrorAjaxCB:function(m,l){var k=h.filter("[data-client-id="+m.clientId+"]");e.renderUISingleJIMInErrorCase(k,l)}};var d={findAllClientIdInPageContent:function(){var k=j.map(h,function(m){var l=c(m).attr("data-client-id");if(l){return l}});return j.uniq(k)},collectFetchingJobs:function(){var l=d.findAllClientIdInPageContent();var k=[];j.each(l,function(m){var n=new a({clientId:m});k.push(n)});return k}};var b={loadOneByOneJiraServerStrategy:function(){var k=d.collectFetchingJobs();var n=k.length;var m=c.Deferred();var l=0;k.forEach(function(o){o.startJobWithRetry().done(i.handleSuccessAjax).fail(function(r,p,q){i.handleErrorAjaxCB(r,q)}).always(function(){if(++l===n){m.resolve()}})});return m.promise()}};var g={init:function(){h=c(".wiki-content .jira-issue[data-client-id]");return b.loadOneByOneJiraServerStrategy()}};return g});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jira-issues-view-mode-resources', location = 'jira/jira-issues-view-mode/fix-ui.js' */
define("confluence/jim/jira/jira-issues-view-mode/fix-ui",["jquery","ajs"],function(c,a){var b={fixBreakIconInOldConf:function(){var d=b.compareVersion(a.version,"5.4.4")<=0;if(!d){return}c(".jim-error-message").each(function(){var f=c(this);var e=f;if(f.hasClass("jim-error-message-table")){e=f.find(".aui-message")}e.addClass("warning").prepend('<span class="aui-icon icon-warning"></span>')})},compareVersion:function(j,h){if(typeof j!=="string"||typeof h!=="string"){return false}var f=j.split(".");var e=h.split(".");var g=0;var d=Math.max(f.length,e.length);for(;g<d;g++){if((f[g]&&!e[g]&&parseInt(f[g])>0)||(parseInt(f[g])>parseInt(e[g]))){return 1}else{if((e[g]&&!f[g]&&parseInt(e[g])>0)||(parseInt(f[g])<parseInt(e[g]))){return -1}}}return 0}};return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jira-issues-view-mode-resources', location = 'jira/jira-issues-view-mode/main.js' */
require(["ajs","jquery","confluence/jim/jira/jira-issues-view-mode/lazy-loading","confluence/jim/jira/jira-issues-view-mode/fix-ui"],function(b,d,c,a){d(document).ready(function(){c.init().done(function(){a.fixBreakIconInOldConf()})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:lodash-amd', location = 'applinks/internal/lib/lodash-amd-global.js' */
define("applinks/lib/lodash",function(){if(!window._){throw"lodash not found"}return window._});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/jquery-amd.js' */
define("applinks/lib/jquery",function(){return window.jQuery});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/aui-amd.js' */
define("applinks/lib/aui",function(){var b=window.AJS;if(!b){throw"window.AJS not defined, cannot load AUI"}var a=b.version.split(".");b.versionDetails={major:parseInt(a[0]),minor:parseInt(a[1]),bugfix:parseInt(a[2])};return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/wrm-amd.js' */
define("applinks/lib/wrm",function(){return window.WRM});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/skate-amd.js' */
define("applinks/lib/skate",function(){return window.skate});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/context.js' */
define("applinks/common/context",["applinks/lib/wrm","applinks/common/modules"],function(a,c){var b=a.data.claim(c.dataFqn("applinks-util-js","applinks-context"));return{currentUser:function(){return b.currentUser},hostApplication:function(){return b.hostApplication},validateCurrentUser:function(){if(!this.currentUser()){throw"No user context"}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/events.js' */
define("applinks/common/events",function(){var a="applinks.event.";return{PREREADY:a+".preready",READY:a+".ready",APPLINKS_LOADED:a+".loaded",APPLINKS_UPDATED:a+".updated",Legacy:{MESSAGE_BOX_DISPLAYED:a+".message-box-displayed"}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/modules.js' */
define("applinks/common/modules",function(){return{PLUGIN_KEY:"com.atlassian.applinks.applinks-plugin",fqn:function(a){return this.PLUGIN_KEY+":"+a},dataFqn:function(a,b){return this.fqn(a)+"."+b}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/features.js' */
define("applinks/common/features",["applinks/lib/wrm","applinks/lib/lodash","applinks/common/modules","applinks/common/context","applinks/common/rest"],function(a,j,g,e,c){var f=a.data.claim(g.dataFqn("applinks-util-js","applinks-features"));var d=a.data.claim(g.dataFqn("applinks-util-js","applinks-discovered-features"));function b(k){return j.contains(d,k.toLowerCase())}function h(k){j.extend(f,k)}function i(k){k.forEach(function(l){if(!b(l)){d.push(l.toLowerCase())}})}return{BITBUCKET_REBRAND:"BITBUCKET_REBRAND",V3_UI_OPT_IN:"V3_UI_OPT_IN",V3_UI:"V3_UI",getEnabledFeatures:function(){return f},isEnabled:function(k){return f[k]},enable:function(k){e.validateCurrentUser();c.V3.features(k).put().fail(function(l){throw"Feature request failed: "+l.statusCode+": "+l.responseText}).done(function(l){h(l)})},getDiscoveredFeatures:function(){return d},isDiscovered:b,discover:function(k){e.validateCurrentUser();c.V3.featureDiscovery(k).put().fail(function(l){throw"Feature discovery request failed: "+l.status+": "+l.responseText}).done(function(l){i(l)})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/products.js' */
define("applinks/common/products",function(){return{BAMBOO:"bamboo",BITBUCKET:"stash",CONFLUENCE:"confluence",FECRU:"fecru",JIRA:"jira",REFAPP:"refapp",STASH:"stash"}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/rest.js' */
define("applinks/common/rest",["applinks/lib/jquery","applinks/lib/aui","applinks/lib/lodash"],function(c,g,h){var d={dataType:"json",contentType:"application/json"};function i(j){this.url=j}i.prototype.get=function(){return c.get(this._requestSettings())};i.prototype.put=function(k){var j=this._requestSettings();j.type="PUT";if(k){j.data=k}return c.ajax(j)};i.prototype._requestSettings=function(){var j=this;return h.defaults({url:j.url},d)};function a(j){if(!j){throw"version undefined"}this.baseUrl=g.contextPath()+"/rest/applinks/"+j+"/"}a.prototype._withPath=function(j){return this.baseUrl+j};function f(){this.module=new a("1.0")}function e(){this.module=new a("2.0")}function b(){this.module=new a("3.0")}b.prototype.featureDiscovery=function(j){if(!j){throw"feature key not defined"}return new i(this.module._withPath("feature-discovery/"+j))};b.prototype.features=function(j){if(!j){throw"feature name not defined"}return new i(this.module._withPath("features/"+featureKey))};return{V1:new f(),V2:new e(),V3:new b()}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/common/rest-service.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks"}});var ApplinksEvents=require("applinks/common/events");AppLinks.Event=AJS.$.extend(window.AppLinks.Event,ApplinksEvents);if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(a){AJS.toInit(a)}}AppLinks.initialisationBinder(function(){var b=AJS.$;AppLinks=b.extend(window.AppLinks||{},{failure:function(e){if(e.status==401){window.location.reload()}else{var c=AppLinks.parseError(e);var d=b(".page-error");if(d.length>0){d.html(c).fadeIn("slow")}else{alert("REST request failed: "+c)}}},jsonRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"json",contentType:"application/json; charset=utf-8",cache:false,success:g,error:c})},xmlRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"xml",contentType:"application/xml; charset=utf-8",cache:false,success:g,error:c})},parseError:function(f){var c;try{c=JSON.parse(f.responseText)}catch(d){if(f.statusText){return c=f.statusText}else{return f}}if(c.message){if(b.isArray(c.message)){return c.message.join(" ")}return c.message}else{return f.statusText}},put:function(d,e,f,c){return AppLinks.jsonRequest(d,"PUT",e,f,c)},post:function(d,e,f,c){return AppLinks.jsonRequest(d,"POST",e,f,c)},update:function(d,e,c){AppLinks.put(AppLinks.self_link(d),d,e,c)},get:function(d,e,c){return AppLinks.jsonRequest(d,"GET",null,e,c)},getXml:function(d,e,c){return AppLinks.xmlRequest(d,"GET",null,e,c)},self_link:function(e){for(var c=0,f=e.link.length;c<f;c++){var d=e.link[c];if(d.rel=="self"){return d.href}}throw"No self-link found"},del:function(f,e,d){var c;if(typeof(f)=="string"){c=f}else{c=AppLinks.self_link(f)}return AppLinks.jsonRequest(c,"DELETE",null,e,d)},SPI:b.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",OAUTH_REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks-oauth/",OAUTH_BASE_URL:AJS.contextPath()+"/rest/applinks-oauth/1.0",setApiVersion:function(c){AppLinks.SPI.API_VERSION=c;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(c){AppLinks.SPI.BASE_URL=c},setOAuthBaseUrl:function(c){AppLinks.SPI.OAUTH_BASE_URL=c},getRemoteRestBaseUrl:function(c){return c+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(c){return c+"/plugins/servlet"},getAllLinks:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(c,e,d)},getAllLinksWithAuthInfo:function(e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(c,e,d)},getApplicationLinkState:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinkstates/id/"+f;return AppLinks.get(c,e,d)},getLinksOfType:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+e;return AppLinks.get(c,f,d)},tryToFetchManifest:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(e);return AppLinks.get(c,f,d)},getManifestFor:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/manifest/"+f+".json";return AppLinks.get(c,e,d)},getLocalManifest:function(e,d){var c=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(c,e,d)},getRemoteManifest:function(e,f,d){var c=AppLinks.SPI.getRemoteRestBaseUrl(e)+"/manifest.json";return AppLinks.get(c,f,d)},getRemoteOAuthConsumerInfo:function(e,f,d){var c=AppLinks.SPI.getRemotePluginServletBaseUrl(e)+"/oauth/consumer-info";return AppLinks.getXml(c,f,d)},createStaticUrlAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+f;return AppLinks.post(c,null,e,d)},createLink:function(j,h,l,d,i,k,f,m,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:l,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f};return AppLinks.post(c,g,m,e)},createLinkWithOrphanedTrust:function(j,h,m,d,i,k,f,l,n,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:m,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f,orphanedTrust:l};return AppLinks.post(c,g,n,e)},verifyTwoWayLinkDetails:function(c,i,j,f,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var g={username:j,password:f,remoteUrl:c,rpcUrl:i};return AppLinks.post(d,g,h,e)},getApplicationLinkInfo:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+e;return AppLinks.get(c,f,d)},deleteLink:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+g.id;if(c){d+="?reciprocate=true"}return AppLinks.del(d,f,e)},makePrimary:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+e.id;return AppLinks.post(c,null,d)},relocate:function(h,f,c,g,e){var d=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+h.id+"?newUrl="+encodeURIComponent(f)+"&nowarning="+(c?"true":"false");return AppLinks.post(d,null,g,e)},legacyUpgrade:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+f.id;return AppLinks.post(c,null,e,d)},ualUpgrade:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+g.id;return AppLinks.post(d,c,f,e)},getEntityTypesForApplicationType:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/type/entity/"+f;return AppLinks.get(c,e,d)},getLocalEntitiesWithLinksToApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+c+".json";return AppLinks.get(d,f,e)},getEntityLinksForApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/"+c+".json";AppLinks.get(d,f,e)},getEntityLinksForApplicationUsingAnonymousAccess:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+c+".json";return AppLinks.get(d,f,e)},createNonUalEntityLink:function(l,g,d,f,j,e,k,i){var c=AppLinks.SPI.BASE_URL+"/entitylink/"+l+"/"+g+"?reciprocate=false";var h={applicationId:d,typeId:f,key:j,name:e,isPrimary:false};return AppLinks.put(c,h,k,i)},createEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?reciprocate=";e+=(c?"true":"false");return AppLinks.put(e,d,i,f)},getConfiguredEntityLinks:function(f,e,g,d){var c=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+f+"/"+e+".json";return AppLinks.get(c,g,d)},deleteEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?typeId="+d.typeId+"&key="+d.key+"&applicationId="+d.applicationId+"&reciprocate="+c;return AppLinks.del(e,i,f)},makePrimaryEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+g+"/"+f+"?typeId="+c.typeId+"&key="+c.key+"&applicationId="+c.applicationId;return AppLinks.post(d,null,h,e)},canDeleteAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+f;return AppLinks.get(c,e,d)},canDeleteEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+c.applicationId+"/"+g+"/"+f+"/"+c.typeId+"/"+c.key;return AppLinks.get(d,h,e)},canCreateReciprocateEntityLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+f;return AppLinks.get(c,e,d)},processPermissionCode:function(d){var c={noPermission:function(){},missing:function(){},credentialsRequired:function(e){},authenticationFailed:function(e){},noAuthentication:function(e){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(e){},updateView:function(g,f,e){}};if(!d){d={}}d=b.extend(c,d);return function(f){var e=f.code;if(e=="NO_PERMISSION"){d.noPermission()}else{if(e=="MISSING"){d.missing()}else{if(e=="CREDENTIALS_REQUIRED"){d.credentialsRequired(f.url)}else{if(e=="AUTHENTICATION_FAILED"){d.authenticationFailed(f.url)}else{if(e=="NO_AUTHENTICATION"){d.noAuthentication(f.url)}else{if(e=="NO_AUTHENTICATION_CONFIGURED"){d.noAuthenticationConfigured()}else{if(e=="NO_CONNECTION"){d.noConnection()}else{if(e=="ALLOWED"){d.allowed()}else{d.unrecognisedCode(f.code)}}}}}}}}}},addAuthenticationTrigger:function(e,c,d){if(!d){d={}}if(typeof d.onSuccess=="undefined"){d.onSuccess=function(){location.reload()}}if(typeof d.onFailure=="undefined"){d.onFailure=function(){return true}}b(e).unbind("click");b(e).click(function(){if(d.before){d.before()}AppLinks.authenticateRemoteCredentials(c,d.onSuccess,d.onFailure)})},deleteOrphanedTrust:function(g,e,f,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+e+"/"+g;return AppLinks.del(c,f,d)},getOrphanedTrust:function(e,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(c,e,d)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+f;return AppLinks.get(c,e,d)},createApplicationLink:function(f,d,i,j,c,k,g){var e=AppLinks.SPI.BASE_URL+"/applicationlink";var h={id:f,name:d,rpcUrl:i,displayUrl:j,typeId:c};return AppLinks.put(e,h,k,g)},createConsumer:function(e,n,d,m,i,l,g,p,h,k,o,f){var c=AppLinks.SPI.OAUTH_BASE_URL+"/applicationlink/"+e+"/authentication/consumer";var j={key:n,name:d,description:m,sharedSecret:i,publicKey:l,outgoing:k,twoLOAllowed:g,executingTwoLOUser:p,twoLOImpersonationAllowed:h};return AppLinks.put(c,j,o,f)},createConsumerAutoConfigure:function(j,i,f,c,h,e){var d=AppLinks.SPI.OAUTH_BASE_URL+"/applicationlink/"+j+"/authentication/consumer?autoConfigure=true";var g={twoLOAllowed:i,executingTwoLOUser:f,twoLOImpersonationAllowed:c};return AppLinks.put(d,g,h,e)},registerProvider:function(i,h,e,g,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+i+"/authentication/provider";var f={config:e,provider:h};return AppLinks.put(c,f,g,d)},enableFeature:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/features/"+e;return AppLinks.put(c,{},f,d)},disableFeature:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/features/"+e;return AppLinks.del(c,f,d)}},(window.AppLinks&&window.AppLinks.SPI)||{})});var a="applinks";AppLinks.UI={showInfoBox:function(c){b(".aui-message.success").remove();AppLinks.UI.createMessage("success",c,"page-info")},hideInfoBox:function(){b(".aui-message.success").remove()},showErrorBox:function(c){AppLinks.UI.createMessage("error",c,"page-error")},hideErrorBox:function(){b(".aui-message.error").remove()},showWarningBox:function(d){if(b.isArray(d)&&d.length>0){var c=b("<ul></ul>");b(d).each(function(f){c.append(b("<li/>",{text:d[f]}))});var e=b('<div class="page-warning"></div>').append(c);AppLinks.UI.createMessage("warning",e.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",d,"page-warning")}},hideWarningBox:function(){b(".aui-message.warning").remove()},shortenString:function(d,c){if(d.length>c){d=d.substring(0,c)+"..."}return d},createMessage:function(d,e,c){var f=b('<div class="'+c+'">');f.html(e);AJS.messages[d](".applinks-message-bar",{title:"",body:f.wrap("<div></div>").parent().html(),closeable:true});b(document).trigger(AppLinks.Event.Legacy.MESSAGE_BOX_DISPLAYED)},displayValidationErrorMessages:function(c,f,e){if(b.isArray(e)){b(e).each(function(j,h){var k=b('<div class="error applinks-error">');k.text(h);b(f).find("."+c).append(k)})}else{if(typeof e!="undefined"){var g=b('<div class="error applinks-error">');g.text(e.toString());b(f).find("."+c).append(g)}}},displayValidationError:function(c,d,e){return function(j){if(j.status==401){window.location.reload();return}b(".applinks-error").remove();b(".loading").remove();var h=j.responseText;var i=b.parseJSON(h);var g=i.message;if(typeof i.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(c,d,g)}else{var f=i.fields;b(f).each(function(k){var l=b('<div class="error applinks-error" id="'+f[k]+'-error">');l.text(g[k]);if(b(d).find("."+f[k]).length>0){l.insertAfter(b(d).find("."+f[k]))}else{l.insertAfter(b(d).find("."+c).append(l))}})}b(d).find("."+c).addClass("fully-populated-errors");if(e){e()}}},addProtocolToURL:function(c){var f=b.trim(c);var e=f.toLowerCase();var d=false;if(e.length>=7){if(e.substring(0,7).indexOf("http")!=-1){d=true}}if(!d){f="http://"+f}return f},prettyJoin:function(d,g,f){if(!f){f=AppLinks.I18n.getText("applinks.and")}var c=d.length;var e="";b.each(d,function(h,i){if(h==(c-1)&&c>1){e+=" "+f+"  "+g(i)}else{e+=g(i);if(h+2<c){e+=", "}}});return e},showLoadingIcon:function(c){b('<span class="loading">&nbsp;</span>').insertAfter(c)},hideLoadingIcon:function(c){b(c).next(".loading").remove()},findUrl:function(f){var e=undefined;var g=f.toLowerCase();var d=g.indexOf("http:");if(d==-1){d=g.indexOf("https:")}if(d>-1){var c=g.indexOf(" ",d);if(c==-1){c=g.length}e=f.substring(d,c)}return e},findApplicationType:function(c){c=c.toLowerCase();if(c.indexOf("jira")!=-1){return"jira"}else{if(c.indexOf("fisheye")!=-1){return"fecru"}else{if(c.indexOf("confluence")!=-1){return"confluence"}else{if(c.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(c){return c.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(c){var d={"<":"&lt;",'"':"&quot;","&":"&amp;"};return c.replace(/[<"&]/g,function(e){return d[e]})},refreshOrphanedTrust:function(){var c=function(d){b("tr.orphaned-trust-row").each(function(){var j=b(this);var k=j.attr("data-id");var g=j.attr("data-type");var f=false;for(var e=0;e<d.orphanedTrust.length;e++){var h=d.orphanedTrust[e];if(k==h.id&&g==h.type){f=true;break}}if(!f){j.remove();if(d.orphanedTrust.length==0){b(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(c)},removeCssClass:function(c,d){b(c).removeClass(function(f,h){var g=h.split(" ");var e="";b.each(g,function(i,j){if(j.indexOf(d)!=-1){e=j}});return e})}};(function(){var c=b({});b.each(["bind","unbind","trigger"],function(d,e){AppLinks.UI[e]=function(){return c[e].apply(c,arguments)}})})();AppLinks.I18n={interpolate:function(d,c){if(c){if(!b.isArray(c)){c=[new String(c)]}c.unshift(d);d=AJS.format.apply(AJS,c)}return d},getTextWithPrefix:function(c,d){return AppLinks.I18n.interpolate(appLinksI18n.entries[a+"."+c],d)},getText:function(c,d){return AppLinks.I18n.interpolate(AppLinks.I18n.resolveValue(c),d)},getApplicationTypeName:function(c){return appLinksI18n.entries["applinks.application.type."+c]},getEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type."+c]},getPluralizedEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type.plural."+c]},getAuthenticationTypeName:function(c){return appLinksI18n.entries["applinks.auth.provider."+c]},resolveValue:function(c){var d=appLinksI18n.entries[c];return typeof d=="undefined"?c:d}};AppLinks.Docs={createDocLink:function(d,e,c){if(!c){c=""}else{c=" "+c}return b("<a/>",{"class":"ual-help-link"+c,href:AppLinks.Docs.getDocHref(d,e),target:"_blank","data-help-link-key":d,text:AppLinks.I18n.getText("applinks.help"),title:AppLinks.I18n.getText("applinks.help")})},getDocHref:function(d,e){var c=AppLinks.Docs.resolveValue("applinks.docs.root")+"/"+AppLinks.Docs.resolveValue(d);if(e){c+="#"+AppLinks.Docs.resolveValue(e)}return c},resolveValue:function(c){var d=applinksDocs.entries[c];return typeof d=="undefined"?c:d}};b(document).trigger(AppLinks.Event.PREREADY);b(document).trigger(AppLinks.Event.READY)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/component/autocomplete.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=AJS("var","&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/component/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY,function(){(function(d){d.fn.wizard=function(v){var u={width:500,height:350,onshow:function(w,x){return true},aftershow:function(){return true},oncancel:function(){return true},onsubmit:function(){return true},aftersubmit:function(){return true},onnext:function(){return true},onprevious:function(){return true},cancelLabel:AppLinks.I18n.getText("applinks.cancel"),submitLabel:AppLinks.I18n.getText("applinks.create"),nextLabel:AppLinks.I18n.getText("applinks.next"),previousLabel:AppLinks.I18n.getText("applinks.previous"),id:""};if(!v){v={}}v=d.extend(u,v);var t=this;this.each(function(){var D=d(this);var w=new AJS.Dialog(v.width,v.height,v.id);var L=q(w,v.onshow,v.aftershow);var K=c(w,v.oncancel);var z=h(w,v.onsubmit,v.aftersubmit);var M=a(w,v.onprevious);var I=m(w,v.onnext);var G=k(w);var B=o(w);var C=g(w);var H=l(w);var J=s(w);var E=n(w);if(v.showButtonId){d("#"+v.showButtonId).click(L)}var y=f(D);for(var A=0;A<y.length;A++){var F=y[A];j(w,F);if(F.className){w.addHeader(F.title,F.className+"-header")}else{w.addHeader(F.title)}if(A!=0&&d(F.div).attr("previous")!="false"){w.addButton(v.previousLabel,M,"applinks-previous-button")}if(A<y.length-1&&d(F.div).attr("submit")!="true"&&d(F.div).attr("next")!="false"){w.addButton(v.nextLabel,I,"applinks-next-button")}if(d(F.div).attr("submit")=="true"){w.addButton(v.submitLabel,z,"wizard-submit")}if(!w.getPage(A).buttonpanel){w.addButton("",null);d(w.getPage(A).buttonpanel).empty();var x=d('<a class="button-panel-button applinks-cancel-link">'+v.cancelLabel+"</a>");w.getPage(A).buttonpanel.append(x);x.click(K)}else{var x=d('<a class="button-panel-link button-panel-cancel-link applinks-cancel-link">'+v.cancelLabel+"</a>");d(w.getPage(A).buttonpanel).append(x);x.click(K)}if(A<y.length-1){w.addPage()}}t={dialog:w,nextPage:I,prevPage:M,submit:z,cancel:K,show:L,disableNextBtn:G,enableNextBtn:B,disableSubmitBtn:C,enableSubmitBtn:H,disablePreviousBtn:J,enablePreviousBtn:E};w.gotoPage(0);w.gotoPanel(0)});return t};function s(t){return function(){b(r(t,"applinks-previous-button"))}}function n(t){return function(){i(r(t,"applinks-previous-button"))}}function k(t){return function(){b(r(t,"applinks-next-button"))}}function o(t){return function(){i(r(t,"applinks-next-button"))}}function g(t){return function(v){var u=r(t,"wizard-submit");b(u);if(typeof(v)=="undefined"||v){d('<span class="loading">&nbsp;</span>').insertBefore(u)}else{u.parent().find(".loading").remove()}}}function l(t){return function(){var u=r(t,"wizard-submit");i(u);u.parent().find(".loading").remove()}}function r(u,t){return d(u.getPage(u.curpage).buttonpanel).find("."+t)}function p(t){d(t.popup.element).find("form").each(function(){this.reset()})}function i(t){t.attr("disabled",false)}function b(t){t.attr("disabled",true)}function q(t,u,v){return function(w){if(u(t,w)!==false){t.gotoPage(0);t.gotoPanel(0);d(document).unbind("keydown.ual.dialog");d(document).bind("keydown.ual.dialog",e(t));t.show();v()}}}function c(t,u){return function(){if(u(t)!==false){t.hide();p(t)}}}function a(t,u){return function(){if(u(t)!==false){t.prevPage()}}}function m(t,u){return function(){if(u(t)!==false){t.nextPage()}}}function e(t){return function(u){if(u.keyCode===27){p(t);d(document).unbind("keydown.ual.dialog")}}}function h(u,v,t){return function(){if(v(u)!==false){t(u);p(u)}}}function j(v,w){var u=d("> div[panel]",w.div);if(u.length>0){u.each(function(y,z){var x=v.addPanel(z.title,null,z.className,"menu-"+z.id);x.getCurrentPanel().body.append(u[y])})}else{var t=v.addPanel(w.title);t.getCurrentPanel().body.append(w.div)}}function f(v){var u=d(" > div",v);var t=[];u.each(function(x){var w=d(this);t[x]={title:w.attr("title")||null,className:w.attr("class"),div:w}});return t}})(jQuery)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/feature/applinks-wizard/applinkwizard.js' */
(function(a){AppLinks.Wizard={getWizard:function(){return a("#create-application-link-container").data("wizard")},initAuthenticationUI:function(d){var h=a(d);var f=h.find(".create-reciprocal-link");var c=h.find(".ual-arrow");var l=h.find(".two-way-link-details");var j=h.find(".reciprocal-link-description");var b=h.find(".no-reciprocal-link-description");f.click(function(){if(f.is(":checked")){c.removeClass("no-background");l.show();j.show();b.hide()}else{c.addClass("no-background");l.hide();j.hide();b.show()}});var i=h.find(".same-user-radio-btn");var k=h.find(".different-user-radio-btn");var e=h.find(".different-userbase-image");var g=h.find(".same-userbase-image");i.click(function(){e.addClass("different-userbase-image-grey");g.removeClass("same-userbase-image-grey")});k.click(function(){g.addClass("same-userbase-image-grey");e.removeClass("different-userbase-image-grey")})},initNonUALUI:function(e){var c=a(e);var b=c.find(".application-types");for(var d=0;d<nonAppLinksApplicationTypes.length;d++){a('<option value="'+nonAppLinksApplicationTypes[d].typeId+'">'+nonAppLinksApplicationTypes[d].label+"</option>").appendTo(b)}},fetchManifest:function(e,h,d,b){var i=h.find("#application-url");if(i.val()==""){var c=h.find("#application-types");if(c.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(i);return false}var g=function(j){e.enableSubmitBtn();e.enablePreviousBtn();e.cancel();AppLinks.UI.listApplicationLinks(j.applicationLink.id,"new",j)};AppLinks.SPI.createStaticUrlAppLink(c.val(),g,null);return true}var f=AppLinks.UI.addProtocolToURL(i.val());AppLinks.UI.showLoadingIcon(i);var g=function(l){var k=l;e.enableNextBtn();h.find(".loading").remove();h.find(".reciprocal-rpc-url").val(a("#baseUrl").val());if(typeof l.typeId!="undefined"){AppLinks.Wizard.handleUALManifest(k,h);e.dialog.gotoPage(2);h.find(".reciprocal-link-username").focus();if(d){d(k)}}else{if(l.code=="applinks.warning.redirected.host"&&!i.data("hasWarnedAboutRedirection")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("hasWarnedAboutRedirection","true");var m=function(){a(i).removeData("hasWarnedAboutRedirection");a(i).unbind("change",m)};i.bind("change",m)}else{if(l.code=="applinks.warning.unknown.host"&&!i.data("forceWhenHostIsOffline")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("forceWhenHostIsOffline","true");var j=function(){a(i).removeData("forceWhenHostIsOffline");a(i).unbind("change",j)};i.bind("change",j)}else{if(k.code=="applinks.warning.unknown.host"||k.code=="applinks.warning.redirected.host"){delete k.warning;delete k.code}AppLinks.Wizard.handleNonUALManifest(k,f,h);e.dialog.gotoPage(1);h.find(".application-name").focus();if(b){b(k)}}}}};e.disableNextBtn();AppLinks.SPI.tryToFetchManifest(f,g,AppLinks.UI.displayValidationError("manifest-validation-errors",h,function(){e.enableNextBtn()}));return f},handleUALManifest:function(f,e){var c=a(e);c.find(".remote-app-image").removeClass(function(j,l){var k=l.split(" ");var i="";a.each(k,function(m,n){if(n.indexOf("application-type-image-")!=-1){i=n}});return i});c.find(".remote-app-image").addClass("application-type-image-"+f.typeId);c.find(".link-to-app-type").html(AppLinks.I18n.getText("applinks.create.title.link.to",AppLinks.I18n.getApplicationTypeName(f.typeId)));c.find(".remote-app-name").text(AppLinks.UI.shortenString(f.name,20));c.find(".create-reciprocal-link").attr("checked",true);c.find("#reciprocal-link-back-to-server").html(AppLinks.I18n.getText("applinks.create.link.back.to.server",AJS.escapeHtml(f.name)));var d=["administrator",AJS.escapeHtml(f.name),'<a target="_blank" href="'+AppLinks.Docs.getDocHref("applinks.docs.adding.application.link")+'">',"</a>"];if(f.applinksVersion!=undefined){var h=f.applinksVersion.split(".");var b=parseInt(h[0]);var g=parseInt(h[1]);if((f.typeId=="jira"||f.typeId=="confluence")&&(b==3&&g<10)){d[0]="system administrator"}}c.find(".reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.link",d));c.find(".no-reciprocal-link-description").hide();c.find(".no-reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.no.link",AJS.escapeHtml(f.name)));c.find(".reciprocal-link-username").val("");c.find(".reciprocal-link-password").val("");c.find(".ual-arrow").removeClass("no-background");c.find(".two-way-link-details").show();c.find(".reciprocal-link-description").show();c.find(".no-reciprocal-link-description").hide()},handleNonUALManifest:function(d,e,c){var b=a(c);b.find(".application-name").val("");b.find(".application-types option:first-child").attr("selected","selected");b.find(".non-ual-application-url").text(e);if(d.warning){b.find(".create-non-ual-warning").show();b.find(".create-non-ual-warning").html(d.warning)}else{b.find(".create-non-ual-warning").hide()}},checkReciprocalLinkFormThreeStepMode:function(c,d,g,j,f){var h=a(c);if(h.find(".create-reciprocal-link").is(":checked")){var k=a.trim(h.find(".reciprocal-rpc-url").val());if(k==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(h.find(".reciprocal-rpc-url"));if(f){f()}return}var e=h.find(".reciprocal-link-username");var b=h.find(".reciprocal-link-password");if(e.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(e);if(f){f()}return false}var i=function(l){h.find(".same-user-description").find("input").attr("checked",true);h.find(".trust-radio-btn").attr("checked",true);h.find(".same-user-radio-btn").click();g(l)};k=AppLinks.UI.addProtocolToURL(k);AppLinks.SPI.verifyTwoWayLinkDetails(j,k,e.val(),b.val(),i,AppLinks.UI.displayValidationError("two-way-link-errors",c,f));return false}else{d();return false}},checkReciprocalLinkFormTwoStepMode:function(f,h,b,i){var c=a(f);var g=a.trim(c.find(".reciprocal-rpc-url").val());if(g==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(c.find(".reciprocal-rpc-url"));if(i){i()}return}var d=c.find(".reciprocal-link-username");var e=c.find(".reciprocal-link-password");if(d.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(d);if(i){i()}return false}g=AppLinks.UI.addProtocolToURL(g);AppLinks.SPI.verifyTwoWayLinkDetails(h,g,d.val(),e.val(),b,AppLinks.UI.displayValidationError("two-way-link-errors",f,i));return false}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/common/urls.js' */
(function(){AppLinks.Urls={generateUrl:function(b,a){var c=b;if(typeof a=="undefined"){return c}else{AJS.$.each(a,function(d,e){if(c.indexOf("?")<0){c=c+"?"}else{c=c+"&"}c=c+d+"="+encodeURIComponent(JSON.stringify(e))});return c}}};AppLinks.Urls.Local={admin:function(b){var a=AJS.contextPath()+"/plugins/servlet/applinks/listApplicationLinks";return AppLinks.Urls.generateUrl(a,b)}};AppLinks.Urls.Remote={admin:function(b,e,d){var c=e==="confluence"?"/admin/listapplicationlinks.action":"/plugins/servlet/applinks/listApplicationLinks";var a=b+c;return AppLinks.Urls.generateUrl(a,d)}}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/help-link-analytics.js' */
(function(a){a(function(){AJS.$("body").on("click",".ual-help-link",function(){AJS.trigger("analyticsEvent",{name:"applinks.view.documentation",data:{linkKey:a(this).attr("data-help-link-key")}})})})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-oauth-ui', location = 'js/oauth-dialog.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){(function(a){AppLinks.OAuthCallback=function(){};AppLinks.OAuthCallback.prototype.success=function(){this.aouthWindow.close();this.onSuccess()};AppLinks.OAuthCallback.prototype.failure=function(){this.aouthWindow.close();this.onFailure()};AppLinks.OAuthCallback.prototype.show=function(b,d,c){this.onSuccess=d;this.onFailure=c;this.aouthWindow=window.open(b,"com_atlassian_applinks_authentication")};oauthCallback=new AppLinks.OAuthCallback();AppLinks.authenticateRemoteCredentials=function(b,d,c){a(".applinks-error").remove();oauthCallback.show(b,d,c)}})(AJS.$)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:common-resources', location = 'templates/extra/jira/common.js' */
AJS.JiraIssues={Remote:{}};var appLinksI18n={entries:{}};jQuery(document).ready(function(){AJS.JiraIssues=jQuery.extend(AJS.JiraIssues||{},{bindOAuthLink:function(c,f){var e={onSuccess:function(){f()},onFailure:function(){}};var d=c.attr("href");c.click(function(g){AppLinks.authenticateRemoteCredentials(d,e.onSuccess,e.onFailure);g.preventDefault()})},getOAuthRealm:function(f){var d=f.getResponseHeader("WWW-Authenticate")||"";var c=/OAuth realm\=\"([^\"]+)\"/;var e=c.exec(d);if(e){return e[1]}else{return null}}});jQuery("a.static-oauth-init").each(function(){AJS.JiraIssues.bindOAuthLink(jQuery(this),function(){window.location.reload()})});jQuery("a.anonymous-init").each(function(f,e){var c=encodeURIComponent(window.location.pathname.replace(Confluence.getContextPath(),""));var d=Confluence.getContextPath()+"/login.action?os_destination="+c;AJS.$(e).attr("href",d)});var a=function(j){var e=AJS.JiraIssues.Remote[j];var h="";for(var g=0;g<e.length;g++){h=h+(e[g].key+(g<e.length-1?",":""))}var d=function(l){var i="issuekey in ("+l+")";var m="/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery="+encodeURIComponent(i)+"&returnMax=true";var k=contextPath+"/plugins/servlet/issue-retriever?appId="+j+"&url="+encodeURIComponent(m)+"&columns=summary&columns=type&columns=resolution&columns=status";return k};var f=function(k){var i=AJS.$("item",k);i.each(function(){var u=AJS.$("link",this).text();var v=AJS.$("key",this).text();var r=AJS.$("summary",this).text();var s=AJS.$("type",this);var m=AJS.$("resolution",this);var w=m.attr("id")!="-1";var o=AJS.$("status",this);var n=AJS.$(".unknown-jira-issue."+v);for(var p=0;p<n.length;p++){var t=AJS.$("<a style=\"background-image: url('"+s.attr("iconUrl")+'\')" href="'+u+'"></a>');t.text(v);var l=AJS.$('<span class="jira-status"></span>');l.text(o.text().toUpperCase());var q=AJS.$('<span class="jira-issue'+(w?" resolved":"")+'" ></span>');q.append(t);q.append(document.createTextNode(" - "+r+" - "));q.append(l);AJS.$(n[p]).replaceWith(q)}})};var c=d(h);AJS.$.ajax({url:c,success:f,error:function(l){if(l.status==401){var k=AJS.JiraIssues.getOAuthRealm(l);if(k){var i={};AJS.$(e).each(function(){if(!i[this.key]){i[this.key]=true;var m=AJS.$('<span class="oauth-msg"> - <a class="oauth-init" href="'+k+'">'+"Authenticate"+"</a> "+"to see issue details"+"</span>");AJS.$(".unknown-jira-issue."+this.key).addClass("single-issue-oauth").append(m)}});AJS.JiraIssues.bindOAuthLink(AJS.$(".single-issue-oauth a.oauth-init"),function(){window.location.reload()})}}else{if(l.status==400&&e.length>1){AJS.$(e).each(function(){var m=this.key;var n=d(m);AJS.$.ajax({url:n,success:f,error:function(p){var o=AJS.$(".unknown-jira-issue."+m);o.removeClass("single-issue-oauth");AJS.$(".oauth-msg",o).remove();o.addClass("jira-error")}})})}}}})};AJS.$(".unknown-jira-issue").each(function(e,f){var d=AJS.$(f);var g=d.attr("data-app-link");var c=d.attr("data-key");AJS.JiraIssues.Remote[g]=AJS.JiraIssues.Remote[g]||[];AJS.JiraIssues.Remote[g].push({key:c})});for(var b in AJS.JiraIssues.Remote){a(b)}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:refresh-resources', location = '/jira/refresh.js' */
(function(b){var c={REFRESH_STATE_STARTED:1,REFRESH_STATE_DONE:2,REFRESH_STATE_FAILED:3,refreshs:[],sortables:[],init:function(){a.getAll().each(function(){c.registerRefresh(this.getRefresh())});b.each(this.refreshs,function(e,f){var g=a.get(f.id);g.getRefreshButton().bind("click",f,c.handleRefreshClick);g.getRefreshLink().bind("click",f,c.handleRefreshClick)});d.getAll().each(function(){c.registerSort(this.getSortable())});b.each(this.sortables,function(f,e){var g=d.get(e.id);g.getHeadersTable().bind("click",e,c.onHeaderClick)})},onHeaderClick:function(j){refeshId=j.data.id;var h="ASC";if(b(this).hasClass("tablesorter-headerAsc")){h="DESC"}var f=b(this).find(".jim-table-header-content").text();var m=b("#refresh-wiki-"+refeshId);var i=m.data("wikimarkup");var g=m.data("pageid");var l=b("#refresh-"+refeshId);var k=new c.Refresh(refeshId,i,g,l.html());var n=a.get(refeshId);n.updateRefreshVisibility(c.REFRESH_STATE_STARTED);c.processRefresh(k,f,h)},replaceRefresh:function(g,e){var f=a.get(g);f.updateRefreshVisibility(c.REFRESH_STATE_DONE);b.each(this.refreshs,function(l,m){if(m.id===g){c.refreshs.splice(l,1);var n=a.get(e);var j=n.getRefresh();c.registerRefresh(j);c.sortables.splice(l,1);var h=d.get(e);var k=h.getSortable();c.registerSort(k);n.getRefreshButton().bind("click",j,c.handleRefreshClick);n.getRefreshLink().bind("click",j,c.handleRefreshClick);h.getHeadersTable().bind("click",k,c.onHeaderClick)}})},registerRefresh:function(e){if(!(e instanceof c.Refresh)){throw "Refresh object must be an instance of RefreshMacro.Refresh"}c.refreshs.push(e)},registerSort:function(e){if(!(e instanceof c.Sortable)){throw "Refresh object must be an instance of RefreshMacro.Refresh"}c.sortables.push(e)},handleRefreshClick:function(h){var f=h.data;var g=a.get(f.id);g.getMacroPanel().html(f.loadingMsg);g.updateRefreshVisibility(c.REFRESH_STATE_STARTED);c.processRefresh(f)},processRefresh:function(g,f,e){var h={};if(arguments.length==1){h={pageId:g.pageId,wikiMarkup:g.wiki}}else{if(arguments.length==3){h={pageId:g.pageId,wikiMarkup:g.wiki,columnName:f,order:e}}}AJS.$.ajax({type:"POST",dataType:"html",url:Confluence.getContextPath()+"/plugins/servlet/jiraRefreshRenderer",data:h,success:function(j){var i=b(j).attr("id");if(i){i=i.replace("refresh-module-","");a.get(g.id).getContentModule().replaceWith(j);new c.CallbackSupport(g).callback(i)}else{new c.CallbackSupport(g).errorHandler(j)}},error:function(j,k,i){new c.CallbackSupport(g).errorHandler(i)}})}};c.Refresh=function(f,e){this.id=f;this.wiki=e;this.pageId=arguments.length>2?arguments[2]:null;this.loadingMsg=arguments.length>3?arguments[3]:null};c.CallbackSupport=function(e){this.refresh=e;this.module=b("#refresh-module-"+e.id)};c.CallbackSupport.prototype={errorHandler:function(f){var g=a.get(this.refresh.id);var e="Refresh didn\'t work. Try again or click an issue to see it in JIRA.";g.getErrorMessagePanel().html(e);g.updateRefreshVisibility(c.REFRESH_STATE_FAILED)},callback:function(e){c.replaceRefresh(this.refresh.id,e)}};var a=function(){if(arguments.length==1){this.id=arguments[0]}};var d=function(){if(arguments.length==1){this.id=arguments[0]}};a.prototype.getRefresh=function(){return new c.Refresh(this.id,this.getWikiMarkup(),this.getPageId(),this.getMacroPanel().html())};d.prototype.getSortable=function(){return new c.Sortable(this.id,b("#refresh-page-id-"+this.id).val(),b("#refresh-"+this.id).html())};a.get=function(f){var e=b("#refresh-"+f);if(!e){return null}return new a(f)};d.get=function(f){var e=b("#refresh-"+f);if(!e){return null}return new d(f)};c.Sortable=function(g,e,f){this.id=g;this.pageId=e;this.loadingMsg=f};d.getAll=function(){return b("div.refresh-macro").map(function(){var e=this.id.replace("refresh-","");return d.get(e)})};a.getAll=function(){return b("div.refresh-macro").map(function(){var e=this.id.replace("refresh-","");return a.get(e)})};a.prototype.getErrorMessagePanel=function(){return b("#error-message-"+this.id)};a.prototype.removeDarkLayer=function(){b("#jim-dark-layout-"+this.id).remove()};a.prototype.displayDarkLayer=function(){var f=b("#refresh-module-"+this.id);var e=f.position();b("<div />",{id:"jim-dark-layout-"+this.id,"class":"jim-sortable-dark-layout",css:{top:e.top+"px",left:e.left+"px",width:f.width()+"px",height:f.height()+"px"}}).appendTo(f.parent())};a.prototype.getMacroPanel=function(){return b("#refresh-"+this.id)};d.prototype.getMacroPanel=function(){return b("#refresh-"+this.id).val()};a.prototype.getContentModule=function(){return b("#refresh-module-"+this.id)};a.prototype.getPageId=function(){return b("#refresh-wiki-"+this.id).data("pageid")};d.prototype.getPageId=function(){return b("#refresh-wiki-"+this.id).data("pageid")};a.prototype.getWikiMarkup=function(){return b("#refresh-wiki-"+this.id).data("wikimarkup")};a.prototype.getRefreshButton=function(){return b("#refresh-issues-button-"+this.id)};d.prototype.getHeadersTable=function(){return b("#jira-issues-"+this.id+" .jira-tablesorter-header")};a.prototype.getRefreshLink=function(){return b("#refresh-issues-link-"+this.id)};a.prototype.getJiraIssuesArea=function(){return b("#jira-issues-"+this.id)};a.prototype.getIssuesCountArea=function(){return b("#total-issues-count-"+this.id)};a.prototype.updateRefreshVisibility=function(e){if(e===c.REFRESH_STATE_STARTED){this.displayDarkLayer();this.getErrorMessagePanel().addClass("hidden")}else{if(e===c.REFRESH_STATE_FAILED){this.getRefreshButton().show();this.getRefreshLink().show();this.removeDarkLayer();this.getErrorMessagePanel().removeClass("hidden")}else{if(e===c.REFRESH_STATE_DONE){this.removeDarkLayer()}}}};b(function(){c.init()})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:web-resources', location = 'templates/extra/jira/jiraIssues.js' */
jQuery(document).ready(function(){var a=jQuery.extend(window.JiraIssues||{},{ADG_ENABLED:AJS.Meta.getNumber("build-number")>=4000,ADG_FONT_SIZE_OVER_FLEXIGRID_FONT_SIZE_RATIO:14/11,fixMenusShowingUnderWidgetInIE:function(){if(jQuery.browser.msie){jQuery("ul.ajs-menu-bar li.ajs-menu-item").each(function(){jQuery(this).hover(function(){jQuery("div.ajs-drop-down",jQuery(this)).parents().each(function(){var c=jQuery(this);var b=c.css("position");if(b&&b!="auto"){c.addClass("ajs-menu-bar-z-index-fix-for-ie")}})},function(){jQuery("div.ajs-drop-down",jQuery(this)).parents().removeClass("ajs-menu-bar-z-index-fix-for-ie")})})}},onSuccessFunction:function(d){if(!jQuery("fieldset input[name='height']",d).length){var b=jQuery(".bDiv table[id^='jiraissues_table']",d)[0];var e=b.grid;var c=b.clientHeight+jQuery(".hDiv",d)[0].clientHeight;jQuery(".bDiv",d).css("height",c+"px");e.options.height=c;e.fixHeight(c)}},onErrorFunction:function(h,c,b,n,f){var o=jQuery("#"+c);var g=b+": ";if(n.status=="200"){g+=f}else{g+=n.responseText}var i=n.getResponseHeader("WWW-Authenticate")||"";if(n.status=="401"&&i.indexOf("OAuth")!=-1){var m=/OAuth realm\=\"([^\"]+)\"/;var e=m.exec(i);if(e){o.empty();a.bigMessageFunction(c,'<a class="oauth-init" href="'+e[1]+'">'+"Authenticate"+"</a> "+"to retrieve your issues"+"</span>");jQuery(".bmDiv",h).css({"z-index":2});var j={onSuccess:function(){window.location.reload()},onFailure:function(){}};var l=jQuery(".oauth-init",o.parent());var d=l.attr("href");l.click(function(p){AppLinks.authenticateRemoteCredentials(d,j.onSuccess,j.onFailure);p.preventDefault()});AJS.$(".gBlock").remove()}}else{if(n.status=="400"){a.bigMessageFunction(c,"The JIRA server was not able to process the search. This may indicate a problem with the syntax of this macro. Alternatively, if this table is requesting specific issue keys, you may not have permission to view one of these issues. ")}else{var k=jQuery("iframe.jiraissues_errorMsgSandbox",h);k.load(function(){var r=this.contentWindow||this.contentDocument;var q=jQuery((r.document?r.document:r).body);jQuery("a",q).each(function(){this.target="_top"});jQuery(".pPageStat",h).empty().text(q.text());var p=jQuery("div.bmDiv",h)[0];k.removeClass("hidden");k.css({height:p.clientHeight+"px",width:p.clientWidth+"px"})});k[0].src=jQuery("fieldset input[name='retrieverUrlHtml']",h).val();a.bigMessageFunction(c,k)}}jQuery(h).find(".pReload").removeClass("loading");o[0].grid.loading=false;jQuery(h).find(".pButton").each(function(){jQuery(this).removeClass("pBtnOver");jQuery(this).css({cursor:"default",opacity:"0.3"})});jQuery(h).find("span.pcontrol input").attr("readonly","true")},onReloadFunction:function(b,d,c){jQuery(".bmDiv",d).remove();jQuery(".bmDistance",d).remove();c.onSubmit=function(){a.reloadOnSubmitFunction(b,c);return true}},reloadOnSubmitFunction:function(b,c){c.params=[{name:"useCache",value:false}];c.onSubmit=function(){a.onSubmitFunction(b,c);return true}},onSubmitFunction:function(b,c){c.params=[{name:"useCache",value:b}]},showTrustWarningsFunction:function(d,c){var b=jQuery(d).children(".trusted_warnings");if(c.trustedMessage){b.find("td:last").html(c.trustedMessage);b.css("display","block")}else{b.css("display","none")}},preProcessFunction:function(e,b,d,c,f){if(d){a.showTrustWarningsFunction(e,c)}if(c.total==0){jQuery(".pPageStat",e).html(f);a.bigMessageFunction(b,f);jQuery(".pReload",e).removeClass("loading");return}},bigMessageFunction:function(e,f){var d=jQuery("<div></div>");var b=jQuery("<div></div>");d.addClass("bmDistance");b.addClass("bmDiv");if(typeof f=="string"){b.html("<p><strong>"+f+"</strong></p>")}else{f.appendTo(b)}var c=jQuery("#"+e);c.after(b).after(d)},getParamsFrom:function(c){var b={};c.children("input").each(function(){b[jQuery(this).attr("name")]=jQuery(this).attr("value")});return b},initializeColumnWidth:function(f,p){var d={},m=function(i){return a.ADG_ENABLED?Math.round(i*a.ADG_FONT_SIZE_OVER_FLEXIGRID_FONT_SIZE_RATIO):i};if(!(p&&p.length)){return d}var h=37,n=11,k=f.width()-(h+(p.length*n)),j=false,q=false,o=0,c=m(140);for(var l=0,e=p.length;l<e;l++){var g=p[l].name;switch(g){case"summary":j=true;o++;break;case"description":q=true;o++;break;case"type":o++;d[g]=30;k-=30;break;case"priority":o++;d[g]=50;k-=50;break;case"status":o++;d[g]=m(100);k-=m(100);break;case"key":o++;d[g]=m(90);k-=m(90);break;case"comments":case"attachments":case"version":case"component":case"resolution":o++;d[g]=m(80);k-=m(80);break;default:d[g]=c}}if(j||q){k-=(c*(p.length-o));var b=250;if(j&&q){d.summary=Math.max(k/2,b);d.description=Math.max(k/2,b)}else{if(j){d.summary=Math.max(k,b)}else{d.description=Math.max(k,b)}}}else{if(!j&&!q&&(p.length>o)){c=k/(p.length-o);for(l=0;l<e;l++){if(!{resolution:true,key:true,type:true,priority:true,status:true}[p[l]]){d[p[l]]=c}}}}return d}});a.fixMenusShowingUnderWidgetInIE();jQuery(".jiraissues_table").each(function(f,j){var k=jQuery(j),h=k.children("fieldset"),e=a.getParamsFrom(h),c="jiraissues_table_"+f;k.append('<table id="'+c+'" style="display:none"></table>');k.css("width",e.width);var d=[];h.children(".columns").each(function(l){var m=jQuery(this).hasClass("nowrap");d[l]={display:this.name,name:this.value,nowrap:m,sortable:true,align:"left"}});var b=a.initializeColumnWidth(k,d);jQuery.each(d,function(l,m){m.width=b[m.name]});var g=jQuery("<div></div>");jQuery("<a></a>").attr({rel:"nofollow",href:e.clickableUrl}).text(e.title).appendTo(g);jQuery("#"+c).flexigrid({url:e.retrieverUrlHtml,method:"GET",dataType:"json",colModel:d,sortname:e.sortField,sortorder:e.sortOrder,usepager:true,title:g.html(),page:parseInt(e.requestedPage,10),useRp:false,rp:parseInt(e.resultsPerPage,10),showTableToggleBtn:true,height:(function(){return e.height?parseInt(e.height,10):480})(),onSuccess:function(){a.onSuccessFunction(j)},onSubmit:function(){a.onSubmitFunction(e.useCache,this);return true},preProcess:function(i){a.preProcessFunction(j,c,e.showTrustWarnings,i,e.nomsg);return i},onError:function(m,l,i){a.onErrorFunction(j,c,e.jiraissuesError,m,l,i)},onReload:function(){a.onReloadFunction(e.useCache,j,this);return true},errormsg:e.errormsg,pagestat:e.pagestat,procmsg:e.procmsg,nomsg:e.nomsg})});jQuery(".jiraissues_count").each(function(b,d){var c=jQuery(d);jQuery.ajax({cache:false,type:"GET",url:c.find(".url").text(),data:{useCache:c.find(".use-cache").text(),rp:c.find(".rp").text(),showCount:"true"},success:function(f){var e=c.find(".result");if(f>1){e.text(AJS.format("{0} issues",f))}else{e.text(AJS.format("{0} issue",f))}e.removeClass("hidden");jQuery(".calculating, .error, .data",c).remove()},error:function(h){var f=jQuery(".error",c).removeClass("hidden"),g=h.getResponseHeader("WWW-Authenticate")||"",j=false;if(h.status===401&&g.indexOf("OAuth")!=-1){var e=/OAuth realm\=\"([^\"]+)\"/,i=e.exec(g);if(i){f.empty().append(AJS.$("<a/>",{href:i[1],"class":"oauth-init"}).text("Authenticate").click(function(){AppLinks.authenticateRemoteCredentials(i[1],function(){window.location.reload()},function(){});return false})).append(AJS.$("<span/>",{text:" "+"to retrieve your issues"}));j=true}}if(!j){f.text(AJS.format(f.text(),h.status))}jQuery(".calculating, .result, .data",c).remove()}})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:app-resources', location = 'templates/recently.soy' */
// This file was automatically generated from recently.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace RY.Templates.
 */

if (typeof RY == 'undefined') { var RY = {}; }
if (typeof RY.Templates == 'undefined') { RY.Templates = {}; }


RY.Templates.body = function(opt_data, opt_ignored) {
  return '<div id="recently-viewed" class="aui-group"><div class="aui-item"><div class="top"><div class="filter"><form class="aui"><input class="filter-input text" type="text" placeholder="' + soy.$$escapeHtmlAttribute("Filter") + '"></form></div></div><div class="pages"></div></div></div>';
};
if (goog.DEBUG) {
  RY.Templates.body.soyTemplateName = 'RY.Templates.body';
}


RY.Templates.pageCollection = function(opt_data, opt_ignored) {
  return '<div class="groups"></div><div class="empty"></div>';
};
if (goog.DEBUG) {
  RY.Templates.pageCollection.soyTemplateName = 'RY.Templates.pageCollection';
}


RY.Templates.pageGroup = function(opt_data, opt_ignored) {
  return '<h3>' + soy.$$escapeHtml(opt_data.title) + '</h3><ul/>';
};
if (goog.DEBUG) {
  RY.Templates.pageGroup.soyTemplateName = 'RY.Templates.pageGroup';
}


RY.Templates.pageItem = function(opt_data, opt_ignored) {
  return '<div class="page-icon"><a href=' + soy.$$escapeHtmlAttributeNospace(soy.$$filterNormalizeUri(opt_data.href)) + ' class="icon icon-' + soy.$$escapeHtmlAttribute(opt_data.type) + '"></a></div><div class="page-title"><a class="ellipsis" href=' + soy.$$escapeHtmlAttributeNospace(soy.$$filterNormalizeUri(opt_data.href)) + '>' + soy.$$escapeHtml(opt_data.title) + ' - ' + soy.$$escapeHtml(opt_data.space) + '</a></div>';
};
if (goog.DEBUG) {
  RY.Templates.pageItem.soyTemplateName = 'RY.Templates.pageItem';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:app-resources', location = 'js/util.js' */
var RY=RY||{};(function(){var b=new Date();var c=new Date(b).getTime();var a=new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime();var d=new Date(b.getFullYear(),b.getMonth(),b.getDate()-1).getTime();RY.util=RY.Util={analytics:{trackDialogOpen:function(){AJS.trigger("analytics",{name:"recently-viewed-dialog-open"})},trackPageOpen:function(){AJS.trigger("analytics",{name:"recently-viewed-page-open"})}},quote:function(e){return(e).replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},diffInDays:function(g,f){var e=1000*60*60*24;return Math.floor((g-f)/e)},daysSince:function(e){if(e>=a){return 0}else{if(e>=d){return 1}else{return RY.util.diffInDays(c,e)}}},wait:function(h,j,f){var i,k,e;var g=function(){k=setTimeout(function(){h.apply(f,e)},j)};return function(){e=arguments;var l=new Date();if(i&&l-i<j){clearTimeout(k)}g();i=l}}}}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:app-resources', location = 'js/page-storage.js' */
var RY=RY||{};RY.RecentPageStorage=function(h){var f="com.atlassian.confluence.plugins.recently.viewed.pages.v1";var d=100;var c={};var b=function(){var i=function(k,l){if(k==="lastSeen"&&_.isString(l)){if(AJS.$.browser.msie){l=l.replace(/\-/g,"/");l=l.replace(/T.*$/,"")}return new Date(l).getTime()}else{return l}};try{c=JSON.parse(h.getItem(f),i)||{}}catch(j){c={}}return c};var g=function(){var i=_.values(c);var k=i.length-d;if(k>0){var j=_.sortBy(i,function(l){return l.lastSeen});_.times(k,function(){var l=j.shift();delete c[l.id]})}};var e=function(){g();try{h.setItem(f,JSON.stringify(c))}catch(i){}};this.addCurrentPage=function(i){if(!(i.id&&i.title)){return}b();a(i);e()};var a=function(i){var j=c[i.id];if(!j){c[i.id]=j={}}j=_.extend(j,i);j.lastSeen=new Date().getTime();j.count=j.count+1||1};this.getPages=function(){return _.values(b())}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:app-resources', location = 'js/filter.js' */
var RY=RY||{};RY.FilterView=Backbone.View.extend({className:"filter",events:{"input .filter-input":"onInput","keyup .filter-input":"onInput","keydown .filter-input":"onKeydown"},initialize:function(){_.bindAll(this,"render","onInput","onKeydown","search");this.navigationEvents=this.options.navigationEvents;this.onInput=RY.util.wait(this.onInput,100,this)},render:function(){this.$input=this.$(".filter-input");return this},onInput:function(a){if(a&&_.contains([37,38,39,40],a.which)){return}this.search()},onKeydown:function(a){switch(a.which){case 13:this.navigationEvents.trigger("select");a.preventDefault();a.stopPropagation();break;case 38:this.navigationEvents.trigger("previous");a.preventDefault();break;case 40:this.navigationEvents.trigger("next");a.preventDefault();break}},search:function(){var a=this.$input.val();this.collection.search(a)}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:app-resources', location = 'js/page-model.js' */
var RY=RY||{};(function(){var a;if(typeof ConfluenceMobile!="undefined"){a=ConfluenceMobile.AppData.get("confluence-context-path")}else{a=AJS.contextPath()}RY.Page=Backbone.Model.extend({href:function(){return a+this.get("url")},daysSinceLastSeen:function(){return RY.util.daysSince(this.get("lastSeen"))}});RY.PageCollection=Backbone.Collection.extend({model:RY.Page,url:a+"/rest/recentlyviewed/1.0/recent",search:function(c){var b;if(this._queryLength(c)===0){b=this.models}else{var d=c.match(/[^\s-]+/g);b=this.filter(function(g){var h=g.get("title");var f=g.get("space");var e=(h+f).toLowerCase();return _.all(d,function(i){return e.indexOf(i.toLowerCase())!==-1})})}this.trigger("filter",b,c);return b},_queryLength:function(b){if(!String.prototype.trim){return AJS.$.trim(b).length}return b.trim().length},comparator:function(b){return -(b.get("lastSeen"))}})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:app-resources', location = 'js/page.js' */
var RY=RY||{};RY.PageView=Backbone.View.extend({tagName:"li",className:"ry-page",template:RY.Templates.pageItem,initialize:function(){_.bindAll(this,"hide","show","render")},hide:function(){this.$el.hide().removeClass("shown")},show:function(){this.$el.show().addClass("shown")},render:function(){var a=this.model.toJSON();a.href=this.model.href();this.$el.html(this.template(a));return this}});RY.PageGroupView=Backbone.View.extend({className:"group",template:RY.Templates.pageGroup,initialize:function(){_.bindAll(this,"hide","hideAll","show","showBorder","showPages","add","render");this.title=this.options.title;this.modelViews={}},hide:function(){this.$el.hide()},hideAll:function(){this.$el.removeClass("border").hide();_.invoke(_.values(this.modelViews),"hide")},show:function(){this.$el.show()},showBorder:function(){this.$el.addClass("border")},showPages:function(a){var c=this;var b=false;_.each(a,function(e){var d=c.modelViews[e.cid];if(d){b=true;d.show()}});if(b){this.show()}return b},add:function(b){var a=new RY.PageView({model:b});this.modelViews[b.cid]=a;this.$list.append(a.render().el)},render:function(){this.$el.html(this.template({title:this.title}));this.$list=this.$("ul");return this}});RY.PageNavigator=function(a,e,c){var g=null;function f(){return a.find("li.shown")}function b(i){pageItems=f();var h=pageItems.index(pageItems.filter(".highlight"));if(g){g.removeClass("highlight")}i+=h;if(i<0){i=pageItems.length-1}if(i>=pageItems.length){i=0}g=pageItems.eq(i);g.addClass("highlight")}function d(){if(!g.length){return}var k=e;var l=k.children();var j=k.height();var i=g.outerHeight(true);var h=g.position().top;if(h<0){if(f().index(g)===0){k.scrollTop(0);return}k.scrollTop(g.offset().top-l.offset().top)}else{if(h>j){k.scrollTop(g.offset().top-l.offset().top-j+i)}}}c.on("select",function(){if(g&&g.is(":visible")){RY.util.analytics.trackPageOpen();var h=g.find(".page-title a").attr("href");window.location=h}},this);c.on("previous",function(){b(-1);d()},this);c.on("next",function(){b(1);d()},this)};RY.PageCollectionView=Backbone.View.extend({template:RY.Templates.pageCollection,events:{"click .page-title a":RY.util.analytics.trackPageOpen},initialize:function(){_.bindAll(this,"checkEmpty","filter","_groupForPage","addOne","showEmptyMessage","clearEmptyMessage","addAll","render");this.modelViews={};this.collection.on("reset",this.addAll,this);this.collection.on("add",this.addOne,this);this.collection.on("filter",this.filter,this)},checkEmpty:function(a,e){var f=this.collection.isEmpty();var b=a.length===0;if(f||b){var c;if(f){c="Sorry mate, looks like you haven\'t visited any pages yet."}else{var d=AJS.contextPath()+"/dosearchsite.action?queryString="+encodeURIComponent(e);c="We didn\'t find any matching pages in your history."+" "+AJS.format("\u003ca href=\"{0}\"\u003eClick here\u003c/a\u003e to search for this term instead.",d)}this.showEmptyMessage(c)}else{this.clearEmptyMessage()}},filter:function(b,d){d=d||"";this.checkEmpty(b,d);var a=[this.$today,this.$yesterday,this.$older];_.invoke(a,"hideAll");var c=[];_.each(a,function(f){var e=f.showPages(b);if(e){c.push(f)}});if(c.length>1){c.pop();_.invoke(c,"showBorder")}},_groupForPage:function(a){var b=a.daysSinceLastSeen();if(b===0){return this.$today}else{if(b===1){return this.$yesterday}else{return this.$older}}},addOne:function(a){var b=this._groupForPage(a);b.add(a)},showEmptyMessage:function(a){this.$(".empty").html(AJS.$("<p>").html(a))},clearEmptyMessage:function(){this.$(".empty").html("")},addAll:function(){this.collection.each(this.addOne)},render:function(){this.$el.html(this.template());this.$today=new RY.PageGroupView({title:"Today"});this.$yesterday=new RY.PageGroupView({title:"Yesterday"});this.$older=new RY.PageGroupView({title:"Older"});var a=this.$(".groups");a.append(this.$today.render().el);a.append(this.$yesterday.render().el);a.append(this.$older.render().el);_.invoke([this.$today,this.$yesterday,this.$older],"hideAll");return this}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:app-resources', location = 'js/quicknav/util.js' */
var RYQ=RYQ||{};(function(){RYQ.util={analytics:{trackQuickNavOpen:function(){AJS.trigger("analytics",{name:"recently-viewed-quicknav-open"})},trackQuickNavPageOpen:function(){AJS.trigger("analytics",{name:"recently-viewed-quicknav-click-page"})},trackQuickNavRecentlyDialogOpen:function(){AJS.trigger("analytics",{name:"recently-viewed-quicknav-click-more-recent"})}}}}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:app-resources', location = 'js/quicknav/quicknav.js' */
var RYQ=RYQ||{};RYQ.QuickNavEntry=Backbone.Model.extend({classNameByType:{blogpost:"content-type-blogpost",page:"content-type-page"},parse:function(a){return{className:this.classNameByType[a.type],name:a.title,href:AJS.contextPath()+a.url,id:a.id,spaceName:a.space,lastSeen:a.lastSeen}}},{escape:function(b){var a=_.map(b,_.clone);_.each(a,function(c){c.name=_.escape(c.name);c.spaceName=_.escape(c.spaceName)});return a}});RYQ.QuickNavEntryCollection=Backbone.Collection.extend({model:RYQ.QuickNavEntry,url:AJS.contextPath()+"/rest/recentlyviewed/1.0/recent?limit=8",search:function(b){var a;if(AJS.$.trim(b).length===0){a=this.models}else{var c=b.match(/[^\s-]+/g);a=this.filter(function(e){var f=e.get("name");var d=f.toLowerCase();return _.all(c,function(g){return d.indexOf(g.toLowerCase())!==-1})})}this.trigger("filter",a);return a},comparator:function(a){return -(a.get("lastSeen"))}});(function(a){RYQ.QuickNav=Backbone.View.extend({initialize:function(){this.moreLink={className:"recently-viewed",href:"#",name:"More recently viewed pages..."};this.$input=a("#quick-search-query");this.makeDropdown();this.addShowHideHandlers();this.getHistory=_.once(this._getHistory);_.bindAll(this,"makeDropdown","addSearchResultBoostingHandler","_getHistory","render","addShowHideHandlers","_getItemsToShow","showQuickResults","onQuickSearch")},makeDropdown:function(){var c=function(d){a("a",d).each(function(){var g=a(this);var e=g.find("span");var f=AJS.dropDown.getAdditionalPropertyValue(e,"spaceName");if(f&&!g.is(".content-type-spacedesc")){g.after(g.clone().attr("class","space-name").html(f));g.parent().addClass("with-space-name")}})};var b=this;this.$dropdown=AJS.inputDrivenDropdown({dropdownPlacement:function(d){b.$input.closest("form").find(".quick-nav-drop-down").append(d)},dropdownPostprocess:function(d){c(d)},ajsDropDownOptions:{className:"recently-viewed-dropdown"}})},addSearchResultBoostingHandler:function(){var b=this;a(window).on("quicksearch.ajax-success",function(g,f){var d=f.url.match("/json/contentnamesearch.action");var c=f.url.match(/rest\/quicknav\/\d\/search/);if(d||c){b.onQuickSearch(g,f)}})},_getHistory:function(){return this.collection.fetch().done(this.addSearchResultBoostingHandler)},render:function(){var b=this.getHistory();b.done(_.bind(function(){if(AJS.dropDown.current==null&&this.collection.length!==0&&this.$input.val().length===0){this.showQuickResults()}},this));var c=this.$input;c.trigger("quick-search-loading-start");b.always(function(){c.trigger("quick-search-loading-stop")})},addShowHideHandlers:function(){var b=this;this.$input.on("focus",function(){b.render()}).on("click",function(c){c.stopPropagation();b.render()}).on("keyup",function(f){var c=f.which===27;var g=f.which===13;var d=a(this).val().length!==0;if(d||c){if(b.$dropdown.dd&&b.$dropdown.dd.$.is(":visible")){b.$dropdown.hide()}}else{if(!g){b.render()}}})},_getItemsToShow:function(){var c=this.collection.toJSON();var b=c.length>0&&c[0].id==AJS.Meta.get("page-id");if(b){c.shift()}return c},showQuickResults:function(){var b=RYQ.QuickNavEntry.escape(this._getItemsToShow());this.$dropdown.show([b,[this.moreLink]],"","");a(".recently-viewed-dropdown").on("click",".recently-viewed",function(c){c.preventDefault();a("#view-user-history-link").click();RYQ.util.analytics.trackQuickNavRecentlyDialogOpen()});a(".recently-viewed-dropdown").on("click",".with-space-name",function(c){RYQ.util.analytics.trackQuickNavPageOpen()});RYQ.util.analytics.trackQuickNavOpen()},onQuickSearch:function(l,f){var o=f.json.query;var c=_.map(this.collection.search(o),function(e){return e.attributes});c=RYQ.QuickNavEntry.escape(c);if(c.length==0){return}var m=f.json.contentNameMatches;var p=-1;for(var g=0;g<m.length;g++){var n=m[g][0].className;if(n=="content-type-blogpost"||n=="content-type-page"){p=g;break}}if(p!=-1){var h=m[p];var b=Math.min(h.length>4?2:6-h.length,c.length);h.unshift.apply(h,_(c).first(b));m[p]=_.uniq(h,function(e){return +e.id});if(h.length>6){var k=6-b;for(var d=k;d>0;d--){h.pop()}}}else{m.unshift(_(c).first(6))}}})}(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:main-resources', location = 'js/main.js' */
var RY=RY||{};AJS.toInit(function(a){a("#view-user-history-link").unbind("click");a("#view-user-history-link").click(function(g){g.preventDefault();var c=new AJS.Dialog({width:600,height:500,id:"recently-viewed-dialog",closeOnOutsideClick:true});var f=a(RY.Templates.body());c.addHeader("Recently viewed pages");c.addPanel("SinglePanel",f);c.addLink("Close",function(e){e.hide()});var d=a("<div>",{"class":"dialog-tip"}).text("Hint: type \"g\" and then \"r\" anywhere to quickly open this menu");c.popup.element.find(".dialog-button-panel").append(d);var i=new RY.PageCollection();var b=new RY.PageCollectionView({collection:i});f.find(".pages").html(b.render().el);c.gotoPanel(0);c.show();var h=a("#recently-viewed-dialog").spin("large");i.fetch({success:function(){h.spinStop();var j=_.extend({},Backbone.Events);var k=new RY.PageNavigator(b.$el,f.parent(),j);var e=new RY.FilterView({collection:i,el:f.find(".filter"),navigationEvents:j}).render();e.search()}});RY.util.analytics.trackDialogOpen()})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.recently-viewed-plugin:main-resources', location = 'js/quicknav/main.js' */
var RYQ=RYQ||{};AJS.toInit(function(){var b=new RYQ.QuickNavEntryCollection();var a=new RYQ.QuickNav({collection:b})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.playsql.requirementyogi:ry-baseline-bp-resources', location = '/blueprint/blueprints.js' */
Confluence.Blueprint.setWizard("com.playsql.requirementyogi:ry-baseline-bp-create",function(a){a.on("submit.page1Id",function(d,c){$(".create-ry-baseline .error").text("");var g=c.pageData.title;var b=c.pageData.requirementPool;var h=c.pageData.queryString;var f=true;if(!g){$(".baseline-name .error").text("The title is required.");f=false}if(b=="query"&&!h){$(".requirement-pool .error").text("A query is required.");f=false}return f})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.playsql.requirementyogi:ry-baseline-bp-resources', location = '/blueprint/blueprints.soy' */
// This file was automatically generated from blueprints.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace RequirementYogi.Soy.
 */

if (typeof RequirementYogi == 'undefined') { var RequirementYogi = {}; }
if (typeof RequirementYogi.Soy == 'undefined') { RequirementYogi.Soy = {}; }


RequirementYogi.Soy.createBaseline = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui create-ry-baseline"><fieldset><div class="field-group baseline-name"><label for="title">Baseline name:</label><input id="title" class="text" type="text" name="title"><div class="error"></div></div></fieldset><fieldset class="group requirement-pool"><legend><span>Which requirements do you want to use?</span></legend><div class="radio"><input class="radio" type="radio" name="requirementPool" id="requirementPoolAll" value="all" checked="checked"><label for="requirementPoolAll">All requirements in this space.</label></div><div class="radio"><input class="radio" type="radio" name="requirementPool" id="requirementPoolQuery" value="query"><label for="requirementPoolQuery">Requirements from this query:<input type="text" class="text long-field search-input" name="queryString" id="query-string" value=""><div class="error"></div></label></div><div class="radio"><input class="radio" type="radio" name="requirementPool" id="requirementPoolDont" value="dont"><label for="requirementPoolDont">Don\'t make a snapshot now.</label></div></fieldset></form>';
};
if (goog.DEBUG) {
  RequirementYogi.Soy.createBaseline.soyTemplateName = 'RequirementYogi.Soy.createBaseline';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacemenu-resources', location = 'js/space-menu.js' */
AJS.toInit(function(a){var d=a(Confluence.Templates.BrowseSpaces.spacesLink());a("#space-directory-link").replaceWith(a(d));var b=a("#space-menu-link"),c=function(e){var f=a("#space-menu-link-content");f.html(e.template);if(AJS&&AJS.Confluence&&AJS.Confluence.Analytics&&AJS.Confluence.Analytics.setAnalyticsSource){AJS.Confluence.Analytics.setAnalyticsSource(f.find("a"),"spacemenu")}a("#create-space-header").click(function(){AJS.trigger("analytics",{name:"create-space-from-header"});Confluence.SpaceBlueprint.Dialog.launch();return false})};b.click(function(){if(!a("#space-menu-link-content .aui-dropdown2-section").length){a.ajax({url:Confluence.getContextPath()+"/rest/ia/1.0/spacesmenu",type:"GET",dataType:"json",cache:false,success:c})}return false});a("#space-menu-link-content").on("aui-dropdown2-show",function(){AJS.trigger("analytics",{name:"open-space-menu"})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:spacemenu-resources', location = 'soy/space-menu.soy' */
// This file was automatically generated from space-menu.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.BrowseSpaces.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.BrowseSpaces == 'undefined') { Confluence.Templates.BrowseSpaces = {}; }


Confluence.Templates.BrowseSpaces.spacesLink = function(opt_data, opt_ignored) {
  return '' + aui.dropdown2.trigger({menu: {id: 'space-menu-link-content'}, id: 'space-menu-link', tagName: 'a', extraClasses: 'aui-nav-link', title: "Spaces", showIcon: true, text: "Spaces"}) + aui.dropdown2.contents({id: 'space-menu-link-content', extraClasses: 'aui-style-default aui-dropdown2-in-header'});
};
if (goog.DEBUG) {
  Confluence.Templates.BrowseSpaces.spacesLink.soyTemplateName = 'Confluence.Templates.BrowseSpaces.spacesLink';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-space-ia:space-ia-analytics', location = 'js/space-ia-analytics.js' */
(function(b){var c=AJS.Confluence.Analytics.setAnalyticsSource;function d(){var g=b(".acs-side-bar");var f=g.find("a:not(.external_link a, #acs-configure-link)");c(f,"sidebar");var e=g.find(".quick-links-section li:not(.external_link) a");c(e,"spaceshortcut");var h=g.find(".ia-secondary-container a:not(.more-children-link)");if(g.find(".ia-secondary-container").data("tree-type")=="pages"){c(h,"contextnavchildmode")}else{if(g.find(".ia-secondary-container").data("tree-type")=="page-tree"){c(h,"contextnavpagetreemode")}else{c(h,"contextnav")}}}function a(e){return function(){AJS.trigger("analytics",{name:"space-ia-nav",data:{linkType:e}})}}AJS.toInit(function(e){e(".acs-side-bar").find(".ia-secondary-container .more-children-link").click(a("context-nav.more-children"));AJS.bind("sidebar.exit-configure-mode",d);AJS.bind("sidebar.flyout-triggered",function(g,f){a("flyout-triggered."+f.flyout)()});AJS.bind("pagetree-children-loaded",d);d()})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.aui.staging:persistable', location = 'js/persistable.js' */
define("confluence/persistable",["skate","confluence/storage-manager"],function(f,g){var d=g("confluence","userSettings");return f("data-persist",{type:f.types.ATTRIBUTE,ready:function(b){if(!b.name)throw'Missing attribute "name"';var c=b.getAttribute("data-persist"),a=b.getAttribute("data-persist-scope"),a=a?b.name+"."+a.replace(/\./g,"-"):b.name,a=d.getItem(a),e=b.getAttribute("data-default-value");if(/value|checked/.test(c))a=a||e||null,null!==a&&("checked"===c&&(a="true"===a),b[c]=a);else throw"Persistable only works with 'value' or 'checked' attributes!";
},events:{change:function(b){var c=b.getAttribute("data-persist"),a=b.getAttribute("data-persist-scope"),a=a?b.name+"."+a.replace(/\./g,"-"):b.name,e=b.getAttribute("data-default-value");String(b[c])===e?d.removeItem(a):d.setItem(a,b[c],2592E3)}}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.support.stp:stp-license-status-resources', location = 'js/stp-licenseStatus.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources', location = '/js/confluence-license-banner.js' */
require(["ajs","jquery"],function(a,b){a.toInit(function(){var d=WRM.data.claim("com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources.license-details");if(!d){a.warn("Unable to claim my required data");return}var c={destroyBanner:function(){b("#license-banner").slideUp(function(){b("#license-banner").remove()})},remindMeLater:function(){b.ajax({type:"POST",dataType:"json",url:a.contextPath()+"/rest/licensebanner/1.0/reminder/later"});c.destroyBanner()},remindMeNever:function(){b.ajax({type:"POST",dataType:"json",url:a.contextPath()+"/rest/licensebanner/1.0/reminder/never"});c.destroyBanner()},createBanner:function(g){var e;if(g.showLicenseExpiryBanner){e=Confluence.Templates.LicenseBanner.expiryBanner({days:g.daysBeforeLicenseExpiry,mac:g.renewUrl,sales:g.salesEmail})}else{if(g.showMaintenanceExpiryBanner){e=Confluence.Templates.LicenseBanner.maintenanceBanner({days:g.daysBeforeMaintenanceExpiry,mac:g.renewUrl,sales:g.salesEmail})}}if(e){var f=b(e);b("#full-height-container").prepend(f);b("#license-banner-later").click(function(h){h.preventDefault();c.remindMeLater()});b("#license-banner-never").click(function(h){h.preventDefault();c.remindMeNever()});f.find(".icon-close").click(function(h){h.preventDefault();c.remindMeLater()})}}};c.createBanner(d)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources', location = 'soy/confluence-license-banner.soy' */
// This file was automatically generated from confluence-license-banner.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.LicenseBanner.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.LicenseBanner == 'undefined') { Confluence.Templates.LicenseBanner = {}; }


Confluence.Templates.LicenseBanner.wrapper = function(opt_data, opt_ignored) {
  return '<div>' + soy.$$filterNoAutoescape(opt_data.contentHTML) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.LicenseBanner.wrapper.soyTemplateName = 'Confluence.Templates.LicenseBanner.wrapper';
}


Confluence.Templates.LicenseBanner.expiryBanner = function(opt_data, opt_ignored) {
  var output = '';
  var renewTag__soy8 = '<a id="license-banner-my-link" target="_blank" href="' + soy.$$escapeHtml(opt_data.mac) + '">';
  var end__soy12 = '</a>';
  var mailTag__soy14 = '<a id="license-banner-sales-link" href="mailto:' + soy.$$escapeHtml(opt_data.sales) + '">';
  output += Confluence.Templates.LicenseBanner.wrapper({contentHTML: '' + aui.message.warning({content: '<div id="license-banner-content" data-days="' + soy.$$escapeHtml(opt_data.days) + '" data-subscription="true">' + ((opt_data.days < 0) ? soy.$$filterNoAutoescape(AJS.format("Your license subscription has expired. This instance is now read-only. Please renew {0}online{1} or contact {2}sales{3}.",renewTag__soy8,end__soy12,mailTag__soy14,end__soy12)) : (opt_data.days == 0) ? soy.$$filterNoAutoescape(AJS.format("Your license subscription will expire today and Confluence will become read-only. Please renew {0}online{1} or contact {2}sales{3}.",renewTag__soy8,end__soy12,mailTag__soy14,end__soy12)) : soy.$$filterNoAutoescape(AJS.format("Your license subscription will expire in {0,choice,1#{0} day|1\x3c{0} days}. Confluence will become read-only after the expiry. Please renew {1}online{2} or contact {3}sales{4}.",opt_data.days,renewTag__soy8,end__soy12,mailTag__soy14,end__soy12))) + '</div>', isCloseable: opt_data.days > 7, id: 'license-banner'})});
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.LicenseBanner.expiryBanner.soyTemplateName = 'Confluence.Templates.LicenseBanner.expiryBanner';
}


Confluence.Templates.LicenseBanner.maintenanceBanner = function(opt_data, opt_ignored) {
  var output = '';
  var renewTag__soy39 = '<a id="license-banner-my-link" target="_blank" href="' + soy.$$escapeHtml(opt_data.mac) + '">';
  var end__soy43 = '</a>';
  var later__soy45 = '<a href="#" id="license-banner-later">';
  var never__soy47 = '<a href="#" id="license-banner-never">';
  output += Confluence.Templates.LicenseBanner.wrapper({contentHTML: '' + aui.message.warning({content: '<div id="license-banner-content" data-days="' + soy.$$escapeHtml(opt_data.days) + '" data-subscription="false">' + ((opt_data.days < 0) ? soy.$$filterNoAutoescape(AJS.format("You no longer have access Support and Updates. {0}Renew online{1}, {2}remind me later{3} or {4}never remind me again{5}.",renewTag__soy39,end__soy43,later__soy45,end__soy43,never__soy47,end__soy43)) : (opt_data.days == 0) ? soy.$$filterNoAutoescape(AJS.format("You will lose access to Support and Updates today. {0}Renew online{1}, {2}remind me later{3} or {4}never remind me again{5}.",renewTag__soy39,end__soy43,later__soy45,end__soy43,never__soy47,end__soy43)) : soy.$$filterNoAutoescape(AJS.format("You will lose access to Support and Updates in {0,choice,1#{0} day|1\x3c{0} days}. {1}Renew online{2}, {3}remind me later{4} or {5}never remind me again{6}.",opt_data.days,renewTag__soy39,end__soy43,later__soy45,end__soy43,never__soy47,end__soy43))) + '</div>', id: 'license-banner'})});
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.LicenseBanner.maintenanceBanner.soyTemplateName = 'Confluence.Templates.LicenseBanner.maintenanceBanner';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-user-rest:crowd-aggregation-warning', location = '/aggregation/js/directory-aggregation-warning.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-user-rest:crowd-aggregation-warning', location = 'aggregation/soy/directory-aggregation-warning.soy' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:clickable-resources', location = 'js/clickable.js' */
jQuery(function(a){a(".clickable").live("click",function(c){if(a(c.target).closest("a[href]").length===0&&a(c.target).closest(".clickable").length===1){var b=a(this).attr("href")||a("a[href]:first",this).attr("href");if(b){location.href=b}}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.adaptavist.confluence.contentFormattingMacros:rollover-resource', location = 'js/rollover.js' */
AJS.toInit(function(){var a=AJS.$(".rollover-parameters");AJS.$.each(a,function(f,h){var d=h.getAttribute("targetid");var c=h.getAttribute("normal-class");var b=h.getAttribute("over-class");var e=AJS.$("#"+d);var g=a[f].getAttribute("rollover-link");if(d!=null){e.addClass(c);if(!(b==="${overClass}")){e.hover(function(){AJS.$(this).removeClass(c);AJS.$(this).addClass(b)},function(){AJS.$(this).removeClass(b);AJS.$(this).addClass(c)})}if(!(g==="${link}")){e.html('<a class="external-link rolloverLink" rel="nofollow" href="" >'+e.text()+"</a>");e.children().attr("href",g)}}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'fr.spectrumgroupe.confluence.plugins.spectrum-api:dashboard-api', location = 'js/dashboard.js' */
AJS.toInit(function(b){function a(c){return c.charAt(0).toUpperCase()+c.slice(1)}if(b("#dashboard-header").length>0){b("head title").html(a(b("meta[name=dashboardContext]").attr("content"))+" Dashboard")}});(function(a){jQuery(document).ready(function(){var b=function(d){return d.hasClass("aui-iconfont-star")};a(".dashboard-star").click(function(){var e=b(a(this));var d=a(this).attr("data-fav-entity");$this=a(this);AJS.safe.ajax({url:AJS.contextPath()+"/labels/"+(e?"removefavourite.action":"addfavourite.action"),type:"POST",data:{entityId:d},success:function(f){$this.toggleClass("aui-iconfont-unstar aui-iconfont-star")}})});a(".sp-all-dashboard").click(function(d){a(this).parent().find(".aui-lozenge").addClass("aui-lozenge-subtle");a(this).removeClass("aui-lozenge-subtle");a(".dashboard-page-box").show()});a(".sp-favorites-dashboard").click(function(d){a(this).parent().find(".aui-lozenge").addClass("aui-lozenge-subtle");a(this).removeClass("aui-lozenge-subtle");a(".dashboard-page-box").hide();a(".dashboard-page-box .aui-iconfont-star").parent().show()});var c=jQuery(".sp-glossary-term").length;if(c>10){jQuery(".dashboard-inner-overlow:last").append("<div class='sp-page-navigation aui-buttons'></div>");jQuery(".dashboard-inner-overlow").pajinate({items_per_page:10,item_container_id:".dashboard-terms",nav_panel_id:".sp-page-navigation"})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'fr.spectrumgroupe.confluence.plugins.spectrum-api:dashboard-api', location = 'js/pagination.js' */
(function(a){jQuery.fn.pajinate=function(e){var k="current_page";var p="items_per_page";var n;var m={item_container_id:".content",items_per_page:10,nav_panel_id:".page_navigation",nav_info_id:".info_text",num_page_links_to_display:15,start_page:0,wrap_around:false,nav_label_first:"&laquo; First",nav_label_prev:"Prev",nav_label_next:"Next",nav_label_last:"Last &raquo;",nav_order:["first","prev","num","next","last"],nav_label_info:"Showing {0}-{1} of {2} results",show_first_last:true,abort_on_small_lists:false,jquery_ui:false,jquery_ui_active:"ui-state-highlight",jquery_ui_default:"ui-state-default",jquery_ui_disabled:"ui-state-disabled"};var e=jQuery.extend(m,e);var h;var g;var s;var c;var l;var r=e.jquery_ui?e.jquery_ui_default:"";var i=e.jquery_ui?e.jquery_ui_active:"";var u=e.jquery_ui?e.jquery_ui_disabled:"";return this.each(function(){g=jQuery(this);h=jQuery(this).find(e.item_container_id);s=g.find(e.item_container_id).children();if(e.abort_on_small_lists&&e.items_per_page>=s.size()){return g}n=g;n.data(k,0);n.data(p,e.items_per_page);var v=h.children().size();var D=Math.ceil(v/e.items_per_page);var y='<span class="ellipse more">...</span>';var A='<span class="ellipse less">...</span>';var x=!e.show_first_last?"":'<a class="aui-button first_link '+r+'" style="color:black; text-decoration:none;" href="">'+e.nav_label_first+"</a>";var C=!e.show_first_last?"":'<a class="aui-button last_link '+r+'" style="color:black; text-decoration:none;" href="">'+e.nav_label_last+"</a>";var B="";for(var w=0;w<e.nav_order.length;w++){switch(e.nav_order[w]){case"first":B+=x;break;case"last":B+=C;break;case"next":B+='<a class="aui-button next_link '+r+'" style="color:black; text-decoration:none;" href="">'+e.nav_label_next+"</a>";break;case"prev":B+='<a class="aui-button previous_link '+r+'" style="color:black; text-decoration:none;" href="">'+e.nav_label_prev+"</a>";break;case"num":B+=A;var z=0;while(D>z){B+='<a class="aui-button page_link '+r+'" style="color:black; text-decoration:none;" href="" longdesc="'+z+'">'+(z+1)+"</a>";z++}B+=y;break;default:break}}c=g.find(e.nav_panel_id);c.html(B).each(function(){jQuery(this).find(".page_link:first").addClass("first");jQuery(this).find(".page_link:last").addClass("last")});c.children(".ellipse").hide();c.find(".previous_link").next().next().addClass("active "+i);s.hide();s.slice(0,n.data(p)).show();l=g.children(e.nav_panel_id+":first").children(".page_link").size();e.num_page_links_to_display=Math.min(e.num_page_links_to_display,l);c.children(".page_link").hide();c.each(function(){jQuery(this).children(".page_link").slice(0,e.num_page_links_to_display).show()});g.find(".first_link").click(function(E){E.preventDefault();j(jQuery(this),0);q(0)});g.find(".last_link").click(function(F){F.preventDefault();var E=l-1;t(jQuery(this),E);q(E)});g.find(".previous_link").click(function(E){E.preventDefault();o(jQuery(this))});g.find(".next_link").click(function(E){E.preventDefault();d(jQuery(this))});g.find(".page_link").click(function(E){E.preventDefault();q(jQuery(this).attr("longdesc"))});q(parseInt(e.start_page));f();if(!e.wrap_around){b()}});function o(v){new_page=parseInt(n.data(k))-1;if(jQuery(v).siblings(".active").prev(".page_link").length==true){j(v,new_page);q(new_page)}else{if(e.wrap_around){q(l-1)}}}function d(v){new_page=parseInt(n.data(k))+1;if(jQuery(v).siblings(".active").next(".page_link").length==true){t(v,new_page);q(new_page)}else{if(e.wrap_around){q(0)}}}function q(x){var y=parseInt(n.data(p));var w=false;start_from=x*y;end_on=start_from+y;var v=s.hide().slice(start_from,end_on);v.show();g.find(e.nav_panel_id).children(".page_link[longdesc="+x+"]").addClass("active "+i).siblings(".active").removeClass("active "+i);n.data(k,x);g.find(e.nav_info_id).html(e.nav_label_info.replace("{0}",start_from+1).replace("{1}",start_from+v.length).replace("{2}",s.length));f();b()}function t(x,w){var v=w;var y=jQuery(x).siblings(".active");if(y.siblings(".page_link[longdesc="+v+"]").css("display")=="none"){c.each(function(){jQuery(this).children(".page_link").hide().slice(parseInt(v-e.num_page_links_to_display+1),v+1).show()})}}function j(x,w){var v=w;var y=jQuery(x).siblings(".active");if(y.siblings(".page_link[longdesc="+v+"]").css("display")=="none"){c.each(function(){jQuery(this).children(".page_link").hide().slice(v,v+parseInt(e.num_page_links_to_display)).show()})}}function f(){if(!c.children(".page_link:visible").hasClass("last")){c.children(".more").show()}else{c.children(".more").hide()}if(!c.children(".page_link:visible").hasClass("first")){c.children(".less").show()}else{c.children(".less").hide()}}function b(){if(c.children(".last").hasClass("active")){c.children(".next_link").add(".last_link").addClass("no_more "+u)}else{c.children(".next_link").add(".last_link").removeClass("no_more "+u)}if(c.children(".first").hasClass("active")){c.children(".previous_link").add(".first_link").addClass("no_more "+u)}else{c.children(".previous_link").add(".first_link").removeClass("no_more "+u)}}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.soy' */
// This file was automatically generated from appswitcher.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace navlinks.templates.appswitcher.
 */

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher == 'undefined') { navlinks.templates.appswitcher = {}; }


navlinks.templates.appswitcher.linkSection = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.list.length > 0) {
    output += '<div class="aui-nav-heading sidebar-section-header">' + soy.$$escapeHtml(opt_data.title) + '</div><ul class="aui-nav nav-links">';
    var linkList8 = opt_data.list;
    var linkListLen8 = linkList8.length;
    for (var linkIndex8 = 0; linkIndex8 < linkListLen8; linkIndex8++) {
      var linkData8 = linkList8[linkIndex8];
      output += navlinks.templates.appswitcher.applicationsItem(linkData8);
    }
    output += '</ul>';
  }
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.linkSection.soyTemplateName = 'navlinks.templates.appswitcher.linkSection';
}


navlinks.templates.appswitcher.applicationsItem = function(opt_data, opt_ignored) {
  return '<li class="nav-link"><a href="' + soy.$$escapeHtml(opt_data.link) + '" ' + ((opt_data.self) ? 'class="checked"' : '') + ' title="' + soy.$$escapeHtml(opt_data.link) + '"><span class="nav-link-label">' + soy.$$escapeHtml(opt_data.label) + '</span></a></li>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.applicationsItem.soyTemplateName = 'navlinks.templates.appswitcher.applicationsItem';
}


navlinks.templates.appswitcher.shortcutsItem = function(opt_data, opt_ignored) {
  return '<li class="nav-link"><a href="' + soy.$$escapeHtml(opt_data.link) + '" ' + ((opt_data.self) ? 'class="checked"' : '') + ' title="' + soy.$$escapeHtml(opt_data.link) + '"><span class="nav-link-label">' + soy.$$escapeHtml(opt_data.label) + '</span>' + ((opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '') + '</a></li>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.shortcutsItem.soyTemplateName = 'navlinks.templates.appswitcher.shortcutsItem';
}


navlinks.templates.appswitcher.error = function(opt_data, opt_ignored) {
  return '<div class="app-switcher-error">' + soy.$$filterNoAutoescape("Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.") + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.error.soyTemplateName = 'navlinks.templates.appswitcher.error';
}


navlinks.templates.appswitcher.sidebarContents = function(opt_data, opt_ignored) {
  return '<div class="aui-page-panel-nav"><nav class="aui-navgroup aui-navgroup-vertical"><div class="app-switcher-section app-switcher-applications"><div class="aui-nav-heading">' + soy.$$escapeHtml("Application Links") + '</div><div class="app-switcher-loading">' + soy.$$filterNoAutoescape("Loading\x26hellip;") + '</div></div><div class="app-switcher-section app-switcher-shortcuts"><div class="aui-nav-heading">' + soy.$$escapeHtml("Shortcuts") + '</div><div class="app-switcher-loading">' + soy.$$filterNoAutoescape("Loading\x26hellip;") + '</div></div></nav></div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.sidebarContents.soyTemplateName = 'navlinks.templates.appswitcher.sidebarContents';
}


navlinks.templates.appswitcher.trigger = function(opt_data, opt_ignored) {
  return '<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">' + soy.$$escapeHtml("Linked Applications") + '</span>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.trigger.soyTemplateName = 'navlinks.templates.appswitcher.trigger';
}


navlinks.templates.appswitcher.projectHeaderSection = function(opt_data, opt_ignored) {
  return '<div class="app-switcher-title">' + aui.avatar.avatar({size: 'large', avatarImageUrl: opt_data.avatarUrl, isProject: true, title: opt_data.name}) + '<div class="sidebar-project-name">' + soy.$$escapeHtml(opt_data.name) + '</div></div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.projectHeaderSection.soyTemplateName = 'navlinks.templates.appswitcher.projectHeaderSection';
}


navlinks.templates.appswitcher.cogDropdown = function(opt_data, opt_ignored) {
  var output = '';
  var dropdownList__soy74 = '' + navlinks.templates.appswitcher.dropdownList({list: opt_data.links});
  output += aui.dropdown2.dropdown2({menu: {id: opt_data.id, content: dropdownList__soy74, extraClasses: 'aui-style-default sidebar-customize-section'}, trigger: {showIcon: false, content: '<span class="aui-icon aui-icon-small aui-iconfont-configure"></span>', container: '#app-switcher'}});
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.cogDropdown.soyTemplateName = 'navlinks.templates.appswitcher.cogDropdown';
}


navlinks.templates.appswitcher.dropdownList = function(opt_data, opt_ignored) {
  var output = '<ul class="sidebar-admin-links">';
  var linkList82 = opt_data.list;
  var linkListLen82 = linkList82.length;
  for (var linkIndex82 = 0; linkIndex82 < linkListLen82; linkIndex82++) {
    var linkData82 = linkList82[linkIndex82];
    output += '<li class="nav-link"><a href="' + soy.$$escapeHtml(linkData82.href) + '" title="' + soy.$$escapeHtml(linkData82.title) + '"><span class="nav-link-label">' + soy.$$escapeHtml(linkData82.label) + '</span></a></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.dropdownList.soyTemplateName = 'navlinks.templates.appswitcher.dropdownList';
}


navlinks.templates.appswitcher.switcher = function(opt_data, opt_ignored) {
  var output = '';
  if (true) {
    if (AJS.DarkFeatures.isEnabled('rotp.sidebar')) {
      var sidebarContents__soy97 = '' + navlinks.templates.appswitcher.sidebarContents(null);
      var triggerContent__soy99 = '' + navlinks.templates.appswitcher.trigger(null);
      output += navlinks.templates.appswitcher.sidebar({sidebar: {id: 'app-switcher', content: sidebarContents__soy97}, trigger: {showIcon: false, content: triggerContent__soy99}}) + '<script>\n                (function (NL) {\n                    var initialise = function () {\n                        new NL.SideBar({\n                            sidebarContents: \'#app-switcher\'\n                        });\n                    };\n                    if (NL.SideBar) {\n                        initialise();\n                    } else {\n                        NL.onInit = initialise;\n                    }\n                }(window.NL = (window.NL || {})));\n                window.NL.isUserAdmin = ' + soy.$$escapeHtml(false) + '<\/script>';
    } else {
      output += navlinks.templates.appswitcher_old.switcher(null);
    }
  }
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.switcher.soyTemplateName = 'navlinks.templates.appswitcher.switcher';
}


navlinks.templates.appswitcher.sidebar = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml(opt_data.sidebar.id) + '" class="sidebar-trigger app-switcher-trigger" aria-owns="' + soy.$$escapeHtml(opt_data.sidebar.id) + '" aria-haspopup="true">' + soy.$$filterNoAutoescape(opt_data.trigger.content) + '</a><div id=' + soy.$$escapeHtml(opt_data.sidebar.id) + ' class="app-switcher-sidebar aui-style-default sidebar-offscreen">' + soy.$$filterNoAutoescape(opt_data.sidebar.content) + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.sidebar.soyTemplateName = 'navlinks.templates.appswitcher.sidebar';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.js' */
(function(c,a){a.SideBar=function(d){var e=this;this.$sidebar=null;d=c.extend({sidebarContents:null},d);this.getLinks=function(){return c.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateAppLinks).fail(this.showAppSwitcherError)};this.populateProjectHeader=function(g,f){e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").after(navlinks.templates.appswitcher.projectHeaderSection({avatarUrl:f,name:g}))};this.getProjectData=function(){var f=c(".project-shortcut-dialog-trigger"),g=f.data("key"),h=f.data("entity-type");if(f.size()==0||!g||!h){c(".app-switcher-shortcuts").remove();return}var j,i;i=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+g,cache:false,data:{entityType:h},dataType:"json"});j=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+g,cache:false,data:{entityType:h},dataType:"json"});c.when(i,j).then(function(l,k){e.updateProjectShortcuts(l,k,{key:g,entityType:h,name:f.data("name"),avatarUrl:f.find("img").prop("src")})},e.showProjectShortcutsError)};this.getSidebar=function(){if(!this.$sidebar){this.$sidebar=c(d.sidebarContents)}return this.$sidebar};this.addApplicationsCog=function(){c(".app-switcher-applications .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-applications-admin-dropdown",links:[{href:AJS.contextPath()+"/plugins/servlet/customize-application-navigator",label:"Customize navigator",title:"Add new entries, hide existing or restrict who sees what"},{href:AJS.contextPath()+"/plugins/servlet/applinks/listApplicationLinks",label:"Manage application links",title:"Link to more Atlassian applications"}]}))};this.addProjectShortcutsCog=function(f,h){var g=[{href:AJS.contextPath()+"/plugins/servlet/custom-content-links-admin?entityKey="+f,label:"Customize shortcuts",title:""}];if(e.entityMappings[h]){g.push({href:e.generateEntityLinksUrl(f,e.entityMappings[h]),label:"Manage product links",title:""})}e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-project-shortcuts-admin-dropdown",links:g}))};this.updateAppLinks=function(f){c(function(){e.getSidebar().find(".app-switcher-applications").html(navlinks.templates.appswitcher.linkSection({title:"Application Links",list:f}));if(a.isUserAdmin){e.addApplicationsCog()}e.bindAnalyticsHandlers(e.getSidebar(),f)})};this.updateProjectShortcuts=function(i,g,h){var j=i[0].shortcuts,f=g[0].shortcuts;e.getSidebar().find(".app-switcher-shortcuts").html(navlinks.templates.appswitcher.linkSection({title:"Shortcuts",list:j.concat(f)}));if(a.isUserAdmin){e.addProjectShortcutsCog(h.key,h.entityType)}e.populateProjectHeader(h.name,h.avatarUrl);e.bindAnalyticsHandlers(e.getSidebar(),data)};this.entityMappings={"confluence.space":"com.atlassian.applinks.api.application.confluence.ConfluenceSpaceEntityType","jira.project":"com.atlassian.applinks.api.application.jira.JiraProjectEntityType","bamboo.project":"com.atlassian.applinks.api.application.bamboo.BambooProjectEntityType","stash.project":"com.atlassian.applinks.api.application.stash.StashProjectEntityType"};this.generateEntityLinksUrl=function(f,g){if(g===e.entityMappings["confluence.space"]){return AJS.contextPath()+"/spaces/listentitylinks.action?typeId="+g+"&key="+f}else{return AJS.contextPath()+"/plugins/servlet/applinks/listEntityLinks/"+g+"/"+f}};this.showAppSwitcherError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-applications .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.showProjectShortcutsError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-shortcuts .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.retryLoading=function(f){this.getSidebar().html(navlinks.templates.appswitcher.sidebarContents());this.getLinks();this.getProjectData();f&&f.stopPropagation()};this.bindAnalyticsHandlers=function(f,g){};this.getLinks();c(this.getProjectData);this.toggleSidebar=function(h){var i=e.getSidebar(),g=c("body"),f=c(window.document);if(!g.hasClass("app-switcher-open")){var k=c("#header");i.css("left",-i.width());i.parent("body").length||i.appendTo("body");b({data:i});i.animate({left:0},300);function j(l){var n=l.target&&c(l.target),m=l.keyCode;if(l.originalEvent===h.originalEvent){return}if(n&&!m&&!(n.closest(i).length||n.closest(k).length)&&h.which==1&&!(l.shiftKey||l.ctrlKey||l.metaKey)){e.toggleSidebar()}else{if(m===27){e.toggleSidebar()}}}f.on("click.appSwitcher",j);f.on("keydown.appSwitcher",j);f.on("scroll.appSwitcher",i,b)}else{f.off(".appSwitcher")}g.toggleClass("app-switcher-open")};c("#header").on("click",".app-switcher-trigger",this.toggleSidebar)};function b(f){var d=c(document).scrollTop(),g=c("#header"),e=(g.height()+g.offset().top)-d;if(e>=0){f.data.css({top:e,position:"fixed"})}else{f.data.css({top:0,left:0,position:"fixed"})}}if(a.onInit){a.onInit()}}(jQuery,window.NL=(window.NL||{})));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.js' */
var APPSWITCHER_TRIGGER_CLICK="appswitcher.trigger.click";var APPSWITCHER_DROPDOWN_SHOW="appswitcher.dropdown.show";var APPSWITCHER_DROPDOWN_DISPLAY_ERROR="appswitcher.dropdown.display.error";var APPSWITCHER_APP_LINK_CLICK="appswitcher.app.link.click";var APPSWITCHER_CONFIGURE_LINK_CLICK="appswitcher.configure.link.click";(function(e,c){c.AppSwitcher=function(f){var h=AJS.contextPath()+"/plugins/servlet/customize-application-navigator";var g="unified.usermanagement";var i=this;this.$dropdown=null;f=e.extend({dropdownContents:null},f);this.getLinks=function(){return e.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateDropdown).fail(this.showError)};this.getDropdown=function(){if(!this.$dropdown){this.$dropdown=e(f.dropdownContents)}return this.$dropdown};this.updateDropdown=function(j){e(function(){i.getDropdown().html(navlinks.templates.appswitcher_old.applications({apps:j,showAdminLink:c.environment.isUserAdmin,adminLink:h}));i.bindAnalyticsHandlers();if(c.environment.isAppSuggestionAvailable===true){i.handleSuggestionApps(j)}})};this.bindAnalyticsHandlers=function(){e(".app-switcher-trigger").on("click",function(){AJS.trigger("analyticsEvent",{name:APPSWITCHER_TRIGGER_CLICK})});e("#app-switcher").on("aui-dropdown2-show",function(){AJS.trigger("analyticsEvent",{name:APPSWITCHER_DROPDOWN_SHOW})});e("#app-switcher .nav-link").on("click",function(){var l="custom";var m=e(this).find("a");var k=m.attr("href");var j=window.location.hostname;if(k.indexOf(j+"/wiki")>-1){l="confluence"}else{if(k.indexOf(j+"/build")>-1){l="bamboo"}else{if(k.indexOf(j)>-1){l="jira"}}}AJS.trigger("analyticsEvent",{name:APPSWITCHER_APP_LINK_CLICK,data:{product:l}})});e(".nav-link-edit-wrapper").on("click",function(){AJS.trigger("analyticsEvent",{name:APPSWITCHER_CONFIGURE_LINK_CLICK})})};this.isBillingSystemEnabled=function(){return(c.environment.isSiteAdminUser===true)&&AJS.DarkFeatures.isEnabled(g)};this.handleSuggestionApps=function(m){var n=_.map(m,function(o){return o.applicationType.toLowerCase()});var k=e("<div id='app-switcher-suggestion-apps' class='aui-dropdown2-section'/>");k.html(navlinks.templates.appswitcher_old.suggestionApps);var l=k.find(".suggestion-apps");var j=false;_.each(a,function(o){if(!_.contains(n,o.appName)){j=true;l.append(navlinks.templates.appswitcher_old.suggestionApp({suggestionApp:o,isBillingSystemEnabled:i.isBillingSystemEnabled()}))}});if(!j){return}e("#app-switcher").append(k);e(".app-discovery-suggestion-app").click(function(){var p=e(this).find("a");var o;if(c.environment.isSiteAdminUser){o="appswitcher.discovery.siteadmin.select.inproduct."}else{o="appswitcher.discovery.user.select."}o=o+p.attr("id").toLowerCase();AJS.trigger("analytics",{name:o})});e(".app-discovery-suggestion-app").hover(function(){e(this).find("a").removeClass("active").removeClass("aui-dropdown2-active")});e(".app-discovery-cancel-button").click(function(){AJS.trigger("analytics",{name:"appswitcher.discovery.nothanks.button.click"});d(b,"true");k.remove()})};this.showError=function(){e(function(){AJS.trigger("analyticsEvent",{name:APPSWITCHER_DROPDOWN_DISPLAY_ERROR});i.getDropdown().html(navlinks.templates.appswitcher_old.error()).off(".appswitcher").on("click.appswitcher",".app-switcher-retry",e.proxy(i.retryLoading,i))})};this.retryLoading=function(j){this.getDropdown().html(navlinks.templates.appswitcher_old.loading());this.getLinks();j&&j.stopPropagation()};this.getLinks()};var b="key-no-thanks";var a=[{appName:"jira",appDesc:"Issue & Project Tracking Software",discoveryUrl:"https://www.atlassian.com/software/jira",billingSystemDiscoveryUrl:"/admin/billing/addapplication"},{appName:"confluence",appDesc:"Collaboration and content sharing",discoveryUrl:"https://www.atlassian.com/software/confluence",billingSystemDiscoveryUrl:"/admin/billing/addapplication?product=confluence.ondemand"},{appName:"bamboo",appDesc:"Continuous integration",discoveryUrl:"https://www.atlassian.com/software/bamboo",billingSystemDiscoveryUrl:"/admin/billing/addapplication?product=bamboo.ondemand"}];var d=function(f,g){e.ajax({url:AJS.contextPath()+"/rest/menu/latest/userdata/",type:"PUT",contentType:"application/json",data:JSON.stringify({key:f,value:g})})};if(c.onInit){c.onInit()}}(jQuery,window.NL=(window.NL||{})));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.soy' */
// This file was automatically generated from appswitcher_old.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace navlinks.templates.appswitcher_old.
 */

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher_old == 'undefined') { navlinks.templates.appswitcher_old = {}; }


navlinks.templates.appswitcher_old.applications = function(opt_data, opt_ignored) {
  return '' + navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.apps, listClass: 'nav-links', showDescription: opt_data.showDescription}) + ((opt_data.custom) ? navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.custom, showDescription: opt_data.showDescription}) : '') + ((opt_data.showAdminLink) ? navlinks.templates.appswitcher_old.adminSection(opt_data) : '');
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.applications.soyTemplateName = 'navlinks.templates.appswitcher_old.applications';
}


navlinks.templates.appswitcher_old.applicationsSection = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.list.length > 0) {
    var param19 = '<ul' + ((opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '') + '>';
    var linkList27 = opt_data.list;
    var linkListLen27 = linkList27.length;
    for (var linkIndex27 = 0; linkIndex27 < linkListLen27; linkIndex27++) {
      var linkData27 = linkList27[linkIndex27];
      param19 += navlinks.templates.appswitcher_old.applicationsItem(soy.$$augmentMap(linkData27, {showDescription: opt_data.showDescription}));
    }
    param19 += '</ul>';
    output += aui.dropdown2.section({content: param19});
  }
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.applicationsSection.soyTemplateName = 'navlinks.templates.appswitcher_old.applicationsSection';
}


navlinks.templates.appswitcher_old.applicationsItem = function(opt_data, opt_ignored) {
  return '<li class="nav-link' + ((opt_data.self) ? ' nav-link-local' : '') + '"><a href="' + soy.$$escapeHtml(opt_data.link) + '" class="aui-dropdown2-radio ' + ((opt_data.self) ? 'aui-dropdown2-checked' : '') + '" title="' + soy.$$escapeHtml(opt_data.link) + '"><span class="nav-link-label">' + soy.$$escapeHtml(opt_data.label) + '</span>' + ((opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '') + '</a></li>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.applicationsItem.soyTemplateName = 'navlinks.templates.appswitcher_old.applicationsItem';
}


navlinks.templates.appswitcher_old.adminSection = function(opt_data, opt_ignored) {
  return '' + aui.dropdown2.section({content: '<ul class="nav-links"><li><a class="nav-link-edit-wrapper" href="' + soy.$$escapeHtml(opt_data.adminLink) + '"><span class="nav-link-edit">' + soy.$$filterNoAutoescape("Configure\x26hellip;") + '</span></a></li></ul>'});
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.adminSection.soyTemplateName = 'navlinks.templates.appswitcher_old.adminSection';
}


navlinks.templates.appswitcher_old.error = function(opt_data, opt_ignored) {
  return '<div class="app-switcher-error">' + soy.$$filterNoAutoescape("Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.") + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.error.soyTemplateName = 'navlinks.templates.appswitcher_old.error';
}


navlinks.templates.appswitcher_old.loading = function(opt_data, opt_ignored) {
  return '<div class="app-switcher-loading">' + soy.$$filterNoAutoescape("Loading\x26hellip;") + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.loading.soyTemplateName = 'navlinks.templates.appswitcher_old.loading';
}


navlinks.templates.appswitcher_old.trigger = function(opt_data, opt_ignored) {
  return '<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">' + soy.$$escapeHtml("Linked Applications") + '</span>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.trigger.soyTemplateName = 'navlinks.templates.appswitcher_old.trigger';
}


navlinks.templates.appswitcher_old.switcher = function(opt_data, opt_ignored) {
  var output = '';
  if (true) {
    var loadingContent__soy81 = '' + navlinks.templates.appswitcher_old.loading(null);
    var triggerContent__soy83 = '' + navlinks.templates.appswitcher_old.trigger(null);
    output += aui.dropdown2.dropdown2({menu: {id: 'app-switcher', content: loadingContent__soy81, extraClasses: 'aui-style-default'}, trigger: {showIcon: false, content: triggerContent__soy83, extraClasses: 'app-switcher-trigger', extraAttributes: {href: '#app-switcher'}}}) + '<script>\n            (function (NL) {\n                var initialise = function () {\n                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.\n                    window.atlassian = window.atlassian || window.aui;\n                    new NL.AppSwitcher({\n                        dropdownContents: \'#app-switcher\'\n                    });\n                };\n                if (NL.AppSwitcher) {\n                    initialise();\n                } else {\n                    NL.onInit = initialise;\n                }\n            }(window.NL = (window.NL || {})));\n            window.NL.environment = ' + soy.$$escapeHtml({}) + ';<\/script>';
  }
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.switcher.soyTemplateName = 'navlinks.templates.appswitcher_old.switcher';
}


navlinks.templates.appswitcher_old.suggestionApp = function(opt_data, opt_ignored) {
  var output = '';
  var href__soy92 = opt_data.isBillingSystemEnabled == true ? opt_data.suggestionApp.billingSystemDiscoveryUrl : opt_data.suggestionApp.discoveryUrl;
  output += '<li class="app-discovery-suggestion-app"><a id="' + soy.$$escapeHtml(opt_data.suggestionApp.appName) + '" href="' + soy.$$escapeHtml(href__soy92) + '" class="app-discovery-link aui-icon-container app-discovery-' + soy.$$escapeHtml(opt_data.suggestionApp.appName) + '-product-icon" title="' + soy.$$escapeHtml(href__soy92) + '" target="_blank"/><div class="app-discovery-small">' + soy.$$escapeHtml(opt_data.suggestionApp.appDesc) + '</div></li>';
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.suggestionApp.soyTemplateName = 'navlinks.templates.appswitcher_old.suggestionApp';
}


navlinks.templates.appswitcher_old.suggestionApps = function(opt_data, opt_ignored) {
  return '<ul class=\'nav-links suggestion-apps\'><li><span class=\'app-discovery-suggest-title nav-link-label\'><h6>' + soy.$$escapeHtml("Try other Atlassian apps") + '</h6></span></li></ul><div class=\'buttons-container app-discovery-suggest-apps-buttons\'><div class=\'buttons\'><button class=\'aui-button aui-button-link app-discovery-cancel-button\' name=\'cancel\' accesskey=\'c\' href=\'#\'>' + soy.$$escapeHtml("Don\x27t show this again") + '</button></div></div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.suggestionApps.soyTemplateName = 'navlinks.templates.appswitcher_old.suggestionApps';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.griffel.confluence.plugins.plant-uml:plantuml-resources', location = 'soy/wizard-templates.soy' */
// This file was automatically generated from wizard-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace plantuml.wizard.
 */

if (typeof plantuml == 'undefined') { var plantuml = {}; }
if (typeof plantuml.wizard == 'undefined') { plantuml.wizard = {}; }


plantuml.wizard.page1FormUml = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui"><fieldset><div class="field-group"><label for="template-key">' + soy.$$escapeHtml("Type") + '</label><select id="template-key" class="select" name="contentTemplateKey"><option value="plantuml_template_activity_diagram_simple">' + soy.$$escapeHtml("Activity Diagram") + '</option><option value="plantuml_template_class_diagram_simple">' + soy.$$escapeHtml("Class Diagram") + '</option><option value="plantuml_template_component_diagram_simple">' + soy.$$escapeHtml("Component Diagram") + '</option><option value="plantuml_template_state_diagram_simple">' + soy.$$escapeHtml("State Diagram") + '</option><option value="plantuml_template_sequence_diagram_simple">' + soy.$$escapeHtml("Sequence Diagram") + '</option><option value="plantuml_template_usecase_diagram_simple">' + soy.$$escapeHtml("Use Case Diagram") + '</option></select><p><a href="' + soy.$$escapeHtml("http://plantuml.sourceforge.net/classes.html") + '" class="external-link">' + soy.$$escapeHtml("UML Documentation") + '</a></p></div></fieldset></form>';
};
if (goog.DEBUG) {
  plantuml.wizard.page1FormUml.soyTemplateName = 'plantuml.wizard.page1FormUml';
}


plantuml.wizard.page1FormGraphviz = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui"><fieldset><div class="field-group"><label for="template-key">' + soy.$$escapeHtml("Type") + '</label><select id="template-key" class="select" name="contentTemplateKey"><option value="plantuml_template_graphviz_diagram_simple">' + soy.$$escapeHtml("Graphviz") + '</option><option value="plantuml_template_flowchart_diagram_simple">' + soy.$$escapeHtml("Flowchart") + '</option></select><p><a href="' + soy.$$escapeHtml("http://www.graphviz.org/Documentation.php") + '" class="external-link">' + soy.$$escapeHtml("Graphviz Documentation") + '</a></p></div></fieldset></form>';
};
if (goog.DEBUG) {
  plantuml.wizard.page1FormGraphviz.soyTemplateName = 'plantuml.wizard.page1FormGraphviz';
}


plantuml.wizard.page1FormDitaa = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui"><fieldset><div class="field-group"><label for="template-key">' + soy.$$escapeHtml("Type") + '</label><select id="template-key" class="select" name="contentTemplateKey"><option value="plantuml_template_ditaa_diagram_simple">' + soy.$$escapeHtml("DITAA") + '</option></select><p><a href="' + soy.$$escapeHtml("http://ditaa.sourceforge.net/") + '" class="external-link">' + soy.$$escapeHtml("DITAA Documentation") + '</a></p></div></fieldset></form>';
};
if (goog.DEBUG) {
  plantuml.wizard.page1FormDitaa.soyTemplateName = 'plantuml.wizard.page1FormDitaa';
}


plantuml.wizard.page1FormJcckit = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui"><fieldset><div class="field-group"><label for="template-key">' + soy.$$escapeHtml("Type") + '</label><select id="template-key" class="select" name="contentTemplateKey"><option value="plantuml_template_jcckit_diagram_simple">' + soy.$$escapeHtml("JCCKit") + '</option></select><p><a href="' + soy.$$escapeHtml("http://plantuml.sourceforge.net/jcckit.html") + '" class="external-link">' + soy.$$escapeHtml("JCCKit Documentation") + '</a></p></div></fieldset></form>';
};
if (goog.DEBUG) {
  plantuml.wizard.page1FormJcckit.soyTemplateName = 'plantuml.wizard.page1FormJcckit';
}


plantuml.wizard.page1FormPlantuml = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui"><fieldset><div class="field-group"><label for="template-key">' + soy.$$escapeHtml("Function") + '</label><select id="template-key" class="select" name="contentTemplateKey"><option value="plantuml_template_plantuml_spacegraph">' + soy.$$escapeHtml("Spacegraph") + '</option><option value="plantuml_template_plantuml_version">' + soy.$$escapeHtml("PlantUML Version Info") + '</option><option value="plantuml_template_plantuml_xearth">' + soy.$$escapeHtml("XEarth") + '</option></select><p><a href="' + soy.$$escapeHtml("plantuml.blueprint.wizard.plantumlxearth.documentation_url") + '" class="external-link">' + soy.$$escapeHtml("plantuml.blueprint.wizard.plantumlxearth.documentation") + '</a></p></div></fieldset></form>';
};
if (goog.DEBUG) {
  plantuml.wizard.page1FormPlantuml.soyTemplateName = 'plantuml.wizard.page1FormPlantuml';
}


plantuml.wizard.page1FormSalt = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui"><fieldset><div class="field-group"><label for="template-key">' + soy.$$escapeHtml("Type") + '</label><select id="template-key" class="select" name="contentTemplateKey"><option value="plantuml_template_salt_diagram_simple">' + soy.$$escapeHtml("Salt") + '</option></select><p><a href="' + soy.$$escapeHtml("http://plantuml.sourceforge.net/salt.html") + '" class="external-link">' + soy.$$escapeHtml("Salt Documentation") + '</a></p></div></fieldset></form>';
};
if (goog.DEBUG) {
  plantuml.wizard.page1FormSalt.soyTemplateName = 'plantuml.wizard.page1FormSalt';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:general-analytics-bindings', location = '/includes/js/analytics-bindings.js' */
define("confluence/analytics-bindings",["jquery","confluence/analytics-support"],function(b,d){return function(){function e(a,c){b(a).on("click",".view-historical-version-trigger",function(){d.publish("confluence.page.view-historical.from-"+(c||"unknown"))})}function f(a,c){b(a).on("click",".restore-historical-version-trigger",function(){d.publish("confluence.page.restore-historical.from-"+(c||"unknown"))})}function g(a,c){b("#header .aui-header-secondary "+a).on("click",function(){var a=b(this).hasClass("aui-dropdown2-active")?
"expanded":"collapsed";d.publish("confluence.header.dropdown."+c,{state:a})})}e("#page-history-warning","navigation");e("#page-history-container","history");e(".diff-menu","diff");f("#page-history-warning","navigation");f("#page-history-container","history");g("#admin-menu-link","administration");g("#user-menu-link","profile")}});require("confluence/module-exporter").safeRequire("confluence/analytics-bindings",function(b){require("ajs").toInit(b)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.team-calendars:calendar-on-space-resources', location = 'com/atlassian/confluence/extra/calendar3/js/calendar-on-space.js' */
(function(a){a(function(){function b(){var c="com.atlassian.confluence.extra.team-calendars:tc-on-space-blueprint-webitem";Confluence.Blueprint.setDirectCallback(c,function(f,d){d.finalUrl=Confluence.getContextPath()+"/display/"+d.spaceKey+"/calendars?src=sidebar&openAddCalDialog=true"})}b()})}(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-header-anchor', location = 'templates/anchor.soy' */
// This file was automatically generated from anchor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace MyWork.Templates.Anchor.
 */

if (typeof MyWork == 'undefined') { var MyWork = {}; }
if (typeof MyWork.Templates == 'undefined') { MyWork.Templates = {}; }
if (typeof MyWork.Templates.Anchor == 'undefined') { MyWork.Templates.Anchor = {}; }


MyWork.Templates.Anchor.tasksFeatureDiscovery = function(opt_data, opt_ignored) {
  return '<p>' + soy.$$escapeHtml("See the tasks assigned to you, or created by you, in the Tasks tab of your profile.") + '</p><ul class="mw-tasks-discovery-controls"><li><a id="mw-tasks-discovery-view" href="' + soy.$$escapeHtml(opt_data.tasksUrl) + '" class="aui-button aui-style"><p>' + soy.$$escapeHtml("View Tasks") + '</p></a></li><li><a id="mw-tasks-discovery-dismiss" href="#">' + soy.$$escapeHtml("Dismiss") + '</a></li></ul>';
};
if (goog.DEBUG) {
  MyWork.Templates.Anchor.tasksFeatureDiscovery.soyTemplateName = 'MyWork.Templates.Anchor.tasksFeatureDiscovery';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-header-anchor', location = 'js/miniview-anchor.js' */
var MW=MW||{$:AJS.$||Zepto};MW.MV={};AJS.toInit(function(){if(AJS.Meta&&!AJS.Meta.get("remote-user")){return}MW.MV.AnchorManager=function(){var l=contextPath,h=l+"/plugins/servlet/notifications-miniview",p=0,e=/[?&]show-miniview/.test(window.location.search);function r(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var s="[\\?\\#&]"+t+"=([^&#]*)";var v=new RegExp(s);var u=v.exec(window.location.search);if(u!==null){return decodeURIComponent(u[1].replace(/\+/g," "))}}var o=r("show-miniview");if(o){h+="#notification/"+o}function q(){var s="badge-i aui-icon aui-icon-small aui-iconfont-workbox-empty";MW.$("#notifications-anchor").html('<div class="'+s+'"></div><span class="badge-w"><span class="badge"></span></span>').attr("title","Open Notifications")}function f(u){var t=false,s;return function(){if(t){return s}t=true;s=u.apply(this,arguments);return s}}var n=f(function(){MW.Dialog.getOptions().closeOthers=false;MW.Dialog.preload=true;MW.Dialog.show();MW.Dialog.hide();MW.Dialog.getOptions().closeOthers=true});function k(s){return s<=9?s:"9+"}function j(s){var t=MW.$("#notifications-anchor"),u=t.find(".badge"),v=t.find(".aui-icon");u.html(k(s));p=s;if(s>0){t.addClass("unread").removeClass("read");v.addClass("aui-iconfont-workbox").removeClass("aui-iconfont-workbox-empty");if(t.is(":visible")&&!e){n()}}else{t.addClass("read").removeClass("unread");v.addClass("aui-iconfont-workbox-empty").removeClass("aui-iconfont-workbox")}}function m(){c("notifications",h);d()}function d(){MW.$(document).keydown(function(s){if(AJS.InlineDialog.current&&s.which==27&&!MW.$(s.target).is(":input")){AJS.InlineDialog.current.hide()}})}function i(){MW.$("#header-menu-bar").find(".ajs-drop-down").each(function(){this.hide()})}function c(x,v){var w;var u=function(){w=this};var s=function(){if(this.preload!==true){var y=JSON.stringify({markAllRead:true});MW.$("#"+x+"-miniview-iframe")[0].contentWindow.postMessage(y,"*")}};if(!window.addEventListener){window.attachEvent("onmessage",t)}else{window.addEventListener("message",t,false)}function t(A){function B(C){return C===location.protocol+"//"+location.host}if("escKey"===A.data){w.hide();MW.$("#notifications-anchor").focus();document.activeElement.blur()}else{if("getParentConfig"===A.data&&B(A.origin)){var z=JSON.stringify({parentConfig:{parentUrl:location.href,preload:MW.Dialog.preload,unread:p}}),y=MW.$("#"+x+"-miniview-iframe")[0].contentWindow;y.postMessage(z,"*");if(MW.Dialog.preload){MW.Dialog.preload=false}else{y.focus()}}}}MW.Dialog=AJS.InlineDialog(MW.$("#"+x+"-anchor"),x+"-miniview",function(B,z,C){if(MW.$(B).children().length===0){MW.$(B).append(MW.$('<iframe id="'+x+'-miniview-iframe" src="'+v+'" frameborder="0"></iframe>'))}else{var A=JSON.stringify({unread:p}),y=MW.$("#"+x+"-miniview-iframe")[0].contentWindow;y.postMessage(A,"*");setTimeout(function(){y.focus()},100)}i();C()},{width:500,height:520,hideDelay:null,initCallback:u,hideCallback:s,noBind:true});MW.Tasks=(function(){var A=300;var z=20;var B=16;var G;var D=AJS.$("#user-menu-link");var C=AJS.$("#user-menu-link-content");var y=C.find("#view-mytasks-link");var E=function(J,H,K){var I=MyWork.Templates.Anchor.tasksFeatureDiscovery({tasksUrl:AJS.contextPath()+"/plugins/inlinetasks/mytasks.action"});J.html(I);J.find("#mw-tasks-discovery-dismiss").click(function(){G.hide()});K()};var F=function(){MW.Dialog.hide();var J=function(){return C.is(":visible")};if(!J()){D.trigger("aui-button-invoke")}var H=function(){G.hide()};C.one("aui-dropdown2-hide",H);G=AJS.InlineDialog(y,"my-tasks-discovery",E,{hideCallback:function(){G.unbind("click focusin mousedown",I);C.unbind("aui-dropdown2-hide",H);if(J()){D.trigger("aui-button-invoke")}MW.$("#inline-dialog-my-tasks-discovery").remove()},gravity:"w",useLiveEvents:true,width:A,noBind:true});C.find(".user-item.active").removeClass("active");y.addClass("active");y.focus();var I=function(K){K.stopPropagation()};G.on("click focusin mousedown",I);G.show()};return{closeAndDiscoverMyTasks:F}})();MW.$("#"+x+"-anchor").click(function(y){y.preventDefault();if(MW.$("#"+x+"-miniview-iframe").is(":visible")){MW.Dialog.hide()}else{MW.Dialog.show()}});if(e){MW.$("#"+x+"-anchor").click()}}function g(){q();m()}return{setupAnchors:g,updateNotificationCount:j}}();MW.MV.AnchorManager.setupAnchors();var b=new MW.AnchorUtil(MW.$,contextPath,MW.MV.AnchorManager.updateNotificationCount);b.setupAnchors();MW.$("#notifications-anchor").click(function(){AJS.trigger("analytics",{name:"mywork.host.button.clicked.notifications",data:{}});MW.MV.AnchorManager.updateNotificationCount(0)});var a=function(){if(document.hidden){b.stopRequests(true)}else{b.startRequests()}};document.addEventListener("visibilitychange",a,false);if(typeof document.hidden==="undefined"){MW.$(window).focus(function(){b.startRequests()})}MW.$("body").click(function(){b.startRequests()})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.mywork.mywork-confluence-host-plugin:mw-header-anchor', location = 'js/util/anchor-util.js' */
MW.AnchorUtil=function(d,k,e){var f=30000,i=f,s,p=k+"/rest/mywork/latest/status/notification/count";var r=new Date().getTime();var b=5*60*1000;var t=1000*60*5;var h=1.25;var c=0;function q(u){window.clearInterval(s);s=undefined;if(u===true){i=f}}function o(){return(new Date().getTime()-r)<t}function m(){if(!o()||!s){l()}r=new Date().getTime()}function l(){if(s){clearTimeout(s)}s=setTimeout(function(){g()},c=n(c))}function a(w,u){var v=w*1000;b=u*1000||b;if(v&&v!=i){i=v;m()}}function n(u){return Math.min(o()?i:u*h,b)}function g(u){MW.$.getJSON(p+((u)?"?pageid="+u:""),function(w){a(w.timeout,w.maxTimeout);var v=w.count;e(v)});l()}function j(){var u=AJS&&AJS.Meta&&AJS.Meta.get&&(AJS.Meta.get("content-type")==="page"||AJS.Meta.get("content-type")==="blogpost");if(u){g(AJS.Meta.get("page-id"))}else{g()}m()}return{setupAnchors:j,startRequests:m,stopRequests:q,updateAnchors:g}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.dialog-wizard:dialog-wizard-resources', location = '/soy/dialog-wizard.soy' */
// This file was automatically generated from dialog-wizard.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.DialogWizard.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.DialogWizard == 'undefined') { Confluence.Templates.DialogWizard = {}; }


Confluence.Templates.DialogWizard.pageContainer = function(opt_data, opt_ignored) {
  return '<div class="dialog-wizard-page-wrapper"><div class="dialog-wizard-page-main"></div><div class="dialog-wizard-page-description">' + ((opt_data.descriptionHeaderLink && opt_data.descriptionHeader) ? '<h3><a href=\'' + soy.$$escapeHtml(opt_data.descriptionHeaderLink) + '\' target=\'_blank\'>' + soy.$$escapeHtml(opt_data.descriptionHeader) + '</a></h3>' : (opt_data.descriptionHeader) ? '<h3>' + soy.$$escapeHtml(opt_data.descriptionHeader) + '</h3>' : '') + '<p>' + soy.$$escapeHtml(opt_data.descriptionContent) + '</p></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.DialogWizard.pageContainer.soyTemplateName = 'Confluence.Templates.DialogWizard.pageContainer';
}


Confluence.Templates.DialogWizard.waitIcon = function(opt_data, opt_ignored) {
  return '<img class="wait-icon" src="' + soy.$$escapeHtml("") + '/images/icons/wait.gif">';
};
if (goog.DEBUG) {
  Confluence.Templates.DialogWizard.waitIcon.soyTemplateName = 'Confluence.Templates.DialogWizard.waitIcon';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.dialog-wizard:dialog-wizard-resources', location = '/js/dialog-wizard.js' */
(function($){function findNextPageId(pageId,pages){var thisPageIdIndex=-1;_.each(pages,function(element,index){if(element.id==pageId){thisPageIdIndex=index;return}});return pages[thisPageIdIndex+1].id}Confluence.DialogWizard=function(dialog,finalAction){function newPage(config,pageId,soyRenderContext,wizardData,wizard){var wizardPage=_.find(config.wizard.pages,function(page){return page.id==pageId});wizard.trigger("pre-render."+pageId,{soyRenderContext:soyRenderContext,wizardData:wizardData});try{var soyTemplateFunction=eval(wizardPage.templateKey);var $soyRender=$(soyTemplateFunction(soyRenderContext))}catch(e){throw Error("wizard points to a non-existent Soy template '"+wizardPage.templateKey+"'. Check your web-resources or server logs.")}$soyRender.find("a, area, button, input, object, select, textarea").attr("tabindex","10");var $panelContent;if(wizardPage.descriptionContent){$panelContent=$(Confluence.Templates.DialogWizard.pageContainer({descriptionHeaderLink:wizardPage.descriptionHeaderLink,descriptionHeader:wizardPage.descriptionHeader,descriptionContent:wizardPage.descriptionContent}));$panelContent.addClass("with-description").find(".dialog-wizard-page-main").append($soyRender)}else{$panelContent=$soyRender}var dialogPageId=pageId;if(dialog.id=="create-dialog"){dialogPageId="create-dialog-"+pageId}var page=dialog.addPage(dialogPageId).page[dialog.curpage];page.addHeader(wizardPage.title).addPanel("SinglePanel",$panelContent,"singlePanel");page.element.find("form").submit(function(){return false});if(wizardPage.descriptionContent){page.element.find(".dialog-panel-body").css({padding:0})}Confluence.Binder.autocompleteMultiUser($soyRender);Confluence.Binder.placeholder($soyRender);function nextCallback(ev){$soyRender.find(".placeholded").val("");var pageData={};var formArray=$soyRender.parent().find("form").serializeArray();_.each(formArray,function(item){pageData[item.name]=item.value});var e=$.Event("submit."+pageId);var state={$container:$soyRender,wizardData:wizardData,pageData:pageData};var validationDeferred=$.Deferred();validationDeferred.done(function(){wizardData.pages[pageId]=pageData;var nextPageId;if(state.nextPageId){nextPageId=state.nextPageId}else{nextPageId=!wizardPage.last&&findNextPageId(pageId,config.wizard.pages)}if(!state.nextPageId&&wizardPage.last){doFinalAction(ev,state,wizardData,finalAction,wizard);dialog.popup.element.find(":input,a").filter(":visible").disable().addClass("disabled");buttons.prepend(Confluence.Templates.DialogWizard.waitIcon())}else{newPage(config,nextPageId,soyRenderContext,wizardData,wizard)}});validationDeferred.fail(function(){AJS.log("dialog aborted by on-submit callback on page: "+pageId)});state.validationDeferred=validationDeferred;wizard.trigger(e,state);if(state.async){return}if(e.isDefaultPrevented()){validationDeferred.reject();return}validationDeferred.resolve()}var buttons=dialog.addFullButtonPanel(page,nextCallback,null,wizardPage.last);buttons.find(".button-panel-back").click(function(){delete wizardData.pages[pageId]});buttons.find(".aui-button-primary").attr("tabindex","10");$soyRender.find("input, select, textarea").eq(0).focus();wizard.trigger("post-render."+pageId,{$container:$soyRender,wizardData:wizardData})}function doFinalAction(ev,state,wizardData,finalAction,wizard){if(state.finalUrl){window.location=state.finalUrl}else{_.each(wizardData.pages,function(pageData){_.extend(wizardData,pageData)});delete wizardData.pages;finalAction(ev,wizardData,null,wizard)}}return{newPage:newPage,doFinalAction:doFinalAction}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.m20tech.tooltips:tooltip-resources', location = '/tooltips/tooltip-enable.js' */
AJS.toInit(function(){AJS.$("a").each(function(d){var f=AJS.$(this)[0];var c=f.href;var a=c.search("\\?tooltip=");if(a>0){var b=c.substring(0,a);if(b===""){b="#"}f.href=b;var e=decodeURIComponent(c.substr(a+9));f.title=e;AJS.$(this).addClass("link-tooltip")}});AJS.$(".link-tooltip").tooltip({live:true,gravity:$.fn.tipsy.autoNS})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.atlassian-nps-plugin:nps-acknowledgement-resources', location = 'js/nps/server/nps-initialiser.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-business-blueprints:common-template-resources', location = 'com/atlassian/confluence/plugins/blueprint/common/soy/common-templates.soy' */
// This file was automatically generated from common-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Blueprints.Common.Index.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Blueprints == 'undefined') { Confluence.Blueprints = {}; }
if (typeof Confluence.Blueprints.Common == 'undefined') { Confluence.Blueprints.Common = {}; }
if (typeof Confluence.Blueprints.Common.Index == 'undefined') { Confluence.Blueprints.Common.Index = {}; }


Confluence.Blueprints.Common.Index.detailsSummaryMacro = function(opt_data, opt_ignored) {
  return '<ac:macro ac:name="detailssummary"><ac:parameter ac:name="label">' + soy.$$escapeHtml(opt_data.label) + '</ac:parameter><ac:parameter ac:name="spaces">' + soy.$$escapeHtml(opt_data.spaces) + '</ac:parameter><ac:parameter ac:name="firstcolumn">' + soy.$$escapeHtml(opt_data.firstcolumn) + '</ac:parameter><ac:parameter ac:name="headings">' + soy.$$escapeHtml(opt_data.headings) + '</ac:parameter><ac:parameter ac:name="blankTitle">' + soy.$$escapeHtml(opt_data.blankTitle) + '</ac:parameter><ac:parameter ac:name="blankDescription">' + soy.$$escapeHtml(opt_data.blankDescription) + '</ac:parameter><ac:parameter ac:name="contentBlueprintId">' + soy.$$escapeHtml(opt_data.contentBlueprintId) + '</ac:parameter><ac:parameter ac:name="blueprintModuleCompleteKey">' + soy.$$escapeHtml(opt_data.blueprintModuleCompleteKey) + '</ac:parameter><ac:parameter ac:name="createButtonLabel">' + soy.$$escapeHtml(opt_data.createButtonLabel) + '</ac:parameter></ac:macro>';
};
if (goog.DEBUG) {
  Confluence.Blueprints.Common.Index.detailsSummaryMacro.soyTemplateName = 'Confluence.Blueprints.Common.Index.detailsSummaryMacro';
}


Confluence.Blueprints.Common.Index.createFromTemplateMacro = function(opt_data, opt_ignored) {
  return '<ac:macro ac:name="create-from-template"><ac:parameter ac:name="blueprintModuleCompleteKey">' + soy.$$escapeHtml(opt_data.moduleKey) + '</ac:parameter><ac:parameter ac:name="buttonLabel">' + soy.$$escapeHtml(opt_data.buttonLabel) + '</ac:parameter><ac:parameter ac:name="spaceKey">' + soy.$$escapeHtml(opt_data.spaceKey) + '</ac:parameter><ac:parameter ac:name="templateName">' + soy.$$escapeHtml(opt_data.templateName) + '</ac:parameter></ac:macro>';
};
if (goog.DEBUG) {
  Confluence.Blueprints.Common.Index.createFromTemplateMacro.soyTemplateName = 'Confluence.Blueprints.Common.Index.createFromTemplateMacro';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-business-blueprints:meeting-notes-resources', location = 'com/atlassian/confluence/plugins/meetingnotes/soy/how-to.soy' */
// This file was automatically generated from how-to.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Blueprints.Meeting.Notes.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Blueprints == 'undefined') { Confluence.Blueprints = {}; }
if (typeof Confluence.Blueprints.Meeting == 'undefined') { Confluence.Blueprints.Meeting = {}; }
if (typeof Confluence.Blueprints.Meeting.Notes == 'undefined') { Confluence.Blueprints.Meeting.Notes = {}; }


Confluence.Blueprints.Meeting.Notes.howTo = function(opt_data, opt_ignored) {
  return '<h1>' + soy.$$escapeHtml("With meeting notes you can...") + '</h1><ol class="howto-steps"><li class="howto-step"><div><h3>' + soy.$$escapeHtml("Crowd-source your agenda") + '</h3><p>' + soy.$$escapeHtml("Distribute an agenda and keep meetings focused.") + '</p></div></li><li class="howto-step"><div><h3>' + soy.$$escapeHtml("Capture meeting minutes") + '</h3><p>' + soy.$$escapeHtml("Take notes and make them available to everyone.") + '</p></div></li><li class="howto-step"><div><h3>' + soy.$$escapeHtml("Create and assign tasks") + '</h3><p>' + soy.$$escapeHtml("Assign action items for attendees to work on afterward.") + '</p></div></li></ol>';
};
if (goog.DEBUG) {
  Confluence.Blueprints.Meeting.Notes.howTo.soyTemplateName = 'Confluence.Blueprints.Meeting.Notes.howTo';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-business-blueprints:meeting-notes-resources', location = 'com/atlassian/confluence/plugins/meetingnotes/soy/user-mention.soy' */
// This file was automatically generated from user-mention.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Meeting.Notes.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Meeting == 'undefined') { Confluence.Templates.Meeting = {}; }
if (typeof Confluence.Templates.Meeting.Notes == 'undefined') { Confluence.Templates.Meeting.Notes = {}; }


Confluence.Templates.Meeting.Notes.userMention = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '' + ((opt_data.username) ? '<li><p><ac:link><ri:user ri:username="' + soy.$$escapeHtml(opt_data.username) + '" /></ac:link></p></li><li><p><ac:placeholder ac:type="mention">' + soy.$$escapeHtml("@mention a person to add them as an attendee and they will be notified.") + '</ac:placeholder></p></li>' : '<li><p><ac:placeholder ac:type="mention">' + soy.$$escapeHtml("@mention a person to add them as an attendee and they will be notified.") + '</ac:placeholder></p></li>');
};
if (goog.DEBUG) {
  Confluence.Templates.Meeting.Notes.userMention.soyTemplateName = 'Confluence.Templates.Meeting.Notes.userMention';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.support.healthcheck.support-healthcheck-plugin:shc-common-modules', location = 'js/ajs-amd.js' */
define("shc/ajs",[],function(){return AJS});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.support.healthcheck.support-healthcheck-plugin:shc-common-modules', location = 'js/shc-location.js' */
define("shc/location",[],function(){return{isSupportTools:function(){return window.location.pathname.toLowerCase().indexOf("/stp/view")>=0}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.support.healthcheck.support-healthcheck-plugin:healthcheck-resources', location = 'js/notification.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.support.healthcheck.support-healthcheck-plugin:healthcheck-resources', location = 'js/notification-config.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.support.healthcheck.support-healthcheck-plugin:healthcheck-resources', location = 'js/scheduler-last-run.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.support.healthcheck.support-healthcheck-plugin:healthcheck-resources', location = 'templates/soy/support-healthcheck-templates.soy' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.thed.zephyr.bp:zephyr-bp-resources', location = '/js/bp.js' */
(function(c){function a(k){AJS.$(k.currentTarget).parent().find("li.selected").removeClass("selected");AJS.$(k.currentTarget).addClass("selected");AJS.$("[name=contentTemplateKey]").val(AJS.$(k.currentTarget).attr("data-item-template-key"))}function f(l,k){AJS.$(".zephyr").click(a);AJS.$("[name=contentTemplateKey]").val("zephyr-blueprint-content-template-test-dashboard")}function h(m,l){var k=l.pageData.contentTemplateKey;if(k=="zephyr-blueprint-content-template-test-dashboard"){l.nextPageId="pickTDProjectDetailsPageId"}else{if(k=="zephyr-blueprint-content-template-test-plan"){l.nextPageId="pickTPProjectDetailsPageId"}else{if(k=="zephyr-blueprint-content-template-test-activities"){l.nextPageId="pickTAProjectDetailsPageId"}else{l.nextPageId="pickTDProjectDetailsPageId"}}}}function d(m,l){if(AJS.$("div#license-error")){AJS.$("div#license-error").remove()}if(g()&&i(l)){var k=l.wizardData.pages.pickATemplatePageId.contentTemplateKey;if(k=="zephyr-blueprint-content-template-test-dashboard"){l.nextPageId="testDashboardPageId"}else{if(k=="zephyr-blueprint-content-template-test-plan"){l.nextPageId="testPlanPageId"}else{if(k=="zephyr-blueprint-content-template-test-activities"){l.nextPageId="testActivityPageId"}}}}else{return false}}function g(){var k=false;AJS.$.ajax({url:Confluence.getContextPath()+"/rest/zbp/latest/zLicense",async:false}).done(function(l){if(l&&l.isLicenseValid&&l.isLicenseValid==true){k=true}else{AJS.log("Zephyr Blueprint: Invalid License");AJS.$("#projectDetailsForm").prepend(AJS.$("<div>",{id:"license-error"}).addClass("aui-message-container").append(AJS.$("<div>",{id:"error-inner"}).addClass("aui-message").addClass("error").append("Your Zephyr Blueprints license has expired, please renew.").append(AJS.$("<span>").addClass("aui-icon").addClass("icon-error"))))}});return k}function i(l){var n=l.$container;n.find(".error").html("");var m=j(n,"#zbp-project","Project field can not be empty.");var k=j(n,"#zbp-release","Release field can not be empty.");return m&&k}function j(n,k,l){var m=n.find(k);if(c.trim(m.val())==""){m.focus().siblings(".error").html(l);return false}return true}function e(m,l){var n=l.$container;n.find(".error").html("");var k=j(n,"#zbp-page-name","Page Title can not be empty.");return k}Confluence.Blueprint.setWizard("com.thed.zephyr.bp:zephyr-blueprint-item",function(k){k.on("submit.pickTDProjectDetailsPageId",d);k.on("submit.pickTPProjectDetailsPageId",d);k.on("submit.pickTAProjectDetailsPageId",d);k.on("submit.testDashboardPageId",e);k.on("submit.testPlanPageId",e);k.on("submit.testActivityPageId",e);k.on("submit.pickATemplatePageId",h);k.on("post-render.pickATemplatePageId",f)});c("#abt-zephyr-dialog-link").live("click",function(k){k.preventDefault();c.ajax({url:Confluence.getContextPath()+"/rest/zbp/latest/zLicense",async:false}).done(function(m){if(m){if(l){l.remove()}var l=new AJS.ConfluenceDialog({width:640,height:350,id:"zbp-about-zephyr-dialog"});l.addHeader("About Zephyr");var p=c("<div>").addClass("aui-dialog-content");var o=c("<div>");var n="Your Zephyr Blueprints license seems to have expired (if this was a trial) or is invalid.\u003cbr/\u003e\u003cbr/\u003e To unlock awesome test metrics capabilities inside Confluence, please consider buying licenses.  You can buy licenses from \u003ca href=https://marketplace.atlassian.com/plugins/com.thed.zephyr.bp target=_blank\u003eAtlassian Marketplace\u003c/a\u003e\u003cbr/\u003e If you think you erroneously got this message, please contact \u003ca href=https://support.getzephyr.com\u003eZephyr Support\u003c/a\u003e\u003cbr/\u003e.";if(m.isLicenseValid&&m.SEN){o.addClass("zephyr-about-dialog");n="<h2 class='dialog-title' style='align:left; margin-left:175px'>Zephyr Blueprints <small><span id='zbpVersion'>"+m.version+"</span></small></h2>		<ul style='align:left; margin-left:175px; padding:0 0 0 0'>			<b>Customer ID: </b><span id='zCustomerId'>"+m.customerId+"</span>			<br/>            <small><b>Support Entitlement Number: </b><span id='sen'>"+m.SEN+"</span></small>			<br/>			<span id='zLicnese'>"+m.licenseInformation+"</span>			<br/>           <small><b>Support available until: </b><span id='expdate'>"+m.expDateFormatted+"</span></small>		</ul>		<ul style='margin-left:175px; padding:5px 0 0 0; font-size:0.7em'>			&copy; 2015 <a href='http://www.getzephyr.com'>Zephyr</a>. All Rights Reserved.";"		</ul>"}o.append(n);p.append(o);l.addPanel("BP-Info",p);l.addLink("Close",function(q){q.hide()});l.show();l.gotoPanel(0)}})});c("#abt-zephyr-help-link").live("click",function(l){l.preventDefault();var k="1.0";c.ajax({url:Confluence.getContextPath()+"/rest/zbp/latest/zLicense",async:false}).done(function(m){if(m&&m.version){k=m.version}});window.open("http://support.yourzephyr.com/product_help/ZBP/"+b(k))});function b(l){var k=[];var m=l.split(".");m=m.slice(0,2);k.push(m.join("."));return k}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.thed.zephyr.bp:zephyr-bp-resources', location = 'zee-macro/js/util/zephyr-bp-util.js' */
if(typeof ZEPHYR=="undefined"){var ZEPHYR={}}if(typeof ZEPHYR.BP=="undefined"){ZEPHYR.BP={}}if(typeof ZEPHYR.BP.UTIL=="undefined"){ZEPHYR.BP.UTIL={}}ZEPHYR.BP.UTIL=AJS.$.extend(ZEPHYR.BP.UTIL,{type:"GET",url:(contextPath||AJS.params.contextPath||"")+"/plugins/servlet/applinks/proxy"});ZEPHYR.BP.UTIL=AJS.$.extend(ZEPHYR.BP.UTIL,{extend:function(a){return AJS.$.extend({},{appId:a.appId,appPath:a.appPath,type:a.type||ZEPHYR.BP.UTIL.type,url:a.url||ZEPHYR.BP.UTIL.url,cache:false,beforeSend:function(b){if(a.appId&&a.appPath){b.setRequestHeader("X-AppId",a.appId);b.setRequestHeader("X-AppPath",a.appPath)}}})}});ZEPHYR.BP.UTIL.ChartTypes={BAR:"bar",LINE:"line",PIE:"pie"};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.thed.zephyr.bp:zephyr-bp-resources', location = '/soy/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Zephyr.Blueprints.Test.
 */

if (typeof Zephyr == 'undefined') { var Zephyr = {}; }
if (typeof Zephyr.Blueprints == 'undefined') { Zephyr.Blueprints = {}; }
if (typeof Zephyr.Blueprints.Test == 'undefined') { Zephyr.Blueprints.Test = {}; }


Zephyr.Blueprints.Test.pickATemplate = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui"><fieldset><ol><input type="hidden" name="contentTemplateKey"><li class="zephyr template selected" data-item-template-key="zephyr-blueprint-content-template-test-dashboard"><span class="template-preview icon-template-dashboard"></span><div class="template-meta"><div class="template-name">' + soy.$$escapeHtml("Create and share a Test Dashboard") + '</div><div class="template-description">' + soy.$$escapeHtml("Provide testing status updates, display Test Metrics from either Zephyr for JIRA or Zephyr Enterprise Edition, display defect metrics from JIRA, provide commentary and attach reports") + '</div></div></li><li class="zephyr template" data-item-template-key="zephyr-blueprint-content-template-test-plan"><span class="template-preview icon-template-plan"></span><div class="template-meta"><div class="template-name">' + soy.$$escapeHtml("Plan and manage your testing") + '</div><div class="template-description">' + soy.$$escapeHtml("Track requirements, create a test plan, share and track it") + '</div></div></li><li class="zephyr template" data-item-template-key="zephyr-blueprint-content-template-test-activities"><span class="template-preview icon-template-activities"></span><div class="template-meta"><div class="template-name">' + soy.$$escapeHtml("Track testing activities") + '</div><div class="template-description">' + soy.$$escapeHtml("Create and track ongoing testing activities and action items with the team") + '</div></div></li></ol></fieldset></form>' + Zephyr.Blueprints.Test.aboutZephyr(null);
};
if (goog.DEBUG) {
  Zephyr.Blueprints.Test.pickATemplate.soyTemplateName = 'Zephyr.Blueprints.Test.pickATemplate';
}


Zephyr.Blueprints.Test.howToUse = function(opt_data, opt_ignored) {
  return '<h2>' + soy.$$escapeHtml("Zephyr Blueprints") + '</h2><p>' + soy.$$escapeHtml("Click next for Test Project and Release details.") + '</p>';
};
if (goog.DEBUG) {
  Zephyr.Blueprints.Test.howToUse.soyTemplateName = 'Zephyr.Blueprints.Test.howToUse';
}


Zephyr.Blueprints.Test.projectDetailsTemplate = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="projectDetailsForm"><fieldset class="group"><div class="field-group"><label for="zbp-project">' + soy.$$escapeHtml("Project") + '<span class="aui-icon icon-required"> required</span></label><input id="zbp-project" class="text" type="text" name="project" title="' + soy.$$escapeHtml("Project") + '" maxlength="255"><div class="error"></div></div><div class="field-group"><label for="zbp-release">' + soy.$$escapeHtml("Release") + '<span class="aui-icon icon-required"> required</span></label><input id="zbp-release" class="text" type="text" name="release" title="' + soy.$$escapeHtml("Release") + '" maxlength="255"><div class="error"></div></div></fieldset></form>' + Zephyr.Blueprints.Test.aboutZephyr(null);
};
if (goog.DEBUG) {
  Zephyr.Blueprints.Test.projectDetailsTemplate.soyTemplateName = 'Zephyr.Blueprints.Test.projectDetailsTemplate';
}


Zephyr.Blueprints.Test.testDashboardTemplate = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="dashboardForm"><fieldset class="group"><div class="field-group"><label for="zbp-page-name">' + soy.$$escapeHtml("Page Title") + '<span class="aui-icon icon-required"> required</span></label><input id="zbp-page-name" class="text" type="text" name="pageName" title="' + soy.$$escapeHtml("Page Title") + '" placeholder="' + soy.$$escapeHtml("Title your page") + '" maxlength="255" size="100"><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="include-zfj">' + soy.$$escapeHtml("Test Metrics") + '</label></div><div class="checkbox"><label for="include-zfj">' + soy.$$escapeHtml("Zephyr for JIRA Test Metrics") + '</label><input id="include-zfj" type="checkbox" class="checkbox" name="includeZfj" title="' + soy.$$escapeHtml("Zephyr for JIRA Test Metrics") + '" checked="checked"></div><div class="checkbox"><label for="include-zee">' + soy.$$escapeHtml("Zephyr Enterprise Edition Test Metrics") + '</label><input id="include-zee" type="checkbox" class="checkbox" name="includeZee" title="' + soy.$$escapeHtml("Zephyr Enterprise Edition Test Metrics") + '"></div></fieldset></form>' + Zephyr.Blueprints.Test.aboutZephyr(null);
};
if (goog.DEBUG) {
  Zephyr.Blueprints.Test.testDashboardTemplate.soyTemplateName = 'Zephyr.Blueprints.Test.testDashboardTemplate';
}


Zephyr.Blueprints.Test.testPlanTemplate = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="testPlanForm"><fieldset class="group"><div class="field-group"><label for="zbp-page-name">' + soy.$$escapeHtml("Page Title") + '<span class="aui-icon icon-required"> required</span></label><input id="zbp-page-name" class="text" type="text" name="pageName" title="' + soy.$$escapeHtml("Page Title") + '" placeholder="' + soy.$$escapeHtml("Title your page") + '" maxlength="255" size="40"><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="include-requirements">' + soy.$$escapeHtml("Test Sections") + '</label></div><div class="checkbox"><label for="include-requirements">' + soy.$$escapeHtml("Requirements") + '</label><input id="include-requirements" type="checkbox" class="checkbox" name="includeReq" title="' + soy.$$escapeHtml("Requirements") + '" maxlength="255" checked="checked"></div><div class="checkbox"><label for="include-dtl-plan">' + soy.$$escapeHtml("Detailed Plan") + '</label><input id="include-dtl-plan" type="checkbox" class="checkbox" name="includePlan" title="' + soy.$$escapeHtml("Detailed Plan") + '" maxlength="255" checked="checked"></div><div class="checkbox"><label for="include-test-schedule">' + soy.$$escapeHtml("Testing Schedules") + '</label><input id="include-test-schedule" type="checkbox" class="checkbox" name="includeSchedules" title="' + soy.$$escapeHtml("Testing Schedules") + '" maxlength="255" checked="checked"></div></fieldset></form>' + Zephyr.Blueprints.Test.aboutZephyr(null);
};
if (goog.DEBUG) {
  Zephyr.Blueprints.Test.testPlanTemplate.soyTemplateName = 'Zephyr.Blueprints.Test.testPlanTemplate';
}


Zephyr.Blueprints.Test.testActivityTemplate = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="testActivityForm"><fieldset class="group"><div class="field-group"><label for="zbp-page-name">' + soy.$$escapeHtml("Page Title") + '<span class="aui-icon icon-required"> required</span></label><input id="zbp-page-name" class="text" type="text" name="pageName" title="' + soy.$$escapeHtml("Page Title") + '" placeholder="' + soy.$$escapeHtml("Title your page") + '" maxlength="255" size="40"><div class="error"></div></div></fieldset></form>' + Zephyr.Blueprints.Test.aboutZephyr(null);
};
if (goog.DEBUG) {
  Zephyr.Blueprints.Test.testActivityTemplate.soyTemplateName = 'Zephyr.Blueprints.Test.testActivityTemplate';
}


Zephyr.Blueprints.Test.aboutZephyr = function(opt_data, opt_ignored) {
  return '<span style="position:absolute;bottom:18px;font-size:0.7em;"><div>&copy; 2015 <a href=\'http://www.getzephyr.com\'>' + soy.$$escapeHtml("Zephyr") + '</a>&nbsp;' + soy.$$escapeHtml("All Rights Reserved") + '&nbsp; &nbsp;<a id="abt-zephyr-dialog-link" href="#">' + soy.$$escapeHtml("About") + '</a>&nbsp;&nbsp;<a id="abt-zephyr-help-link" href="#">' + soy.$$escapeHtml("Help") + '</a></div></span>';
};
if (goog.DEBUG) {
  Zephyr.Blueprints.Test.aboutZephyr.soyTemplateName = 'Zephyr.Blueprints.Test.aboutZephyr';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-questions:create-content-resources', location = 'widget/createcontent/ask-question.js' */
(function(b){function a(){var e="com.atlassian.confluence.plugins.confluence-questions:ask-a-question-blueprint-webitem";Confluence.Blueprint.setDirectCallback(e,function(g,f){f.finalUrl=Confluence.getContextPath()+"/questions/ask?src=createdialog"});function d(i,h){var g;if(h){if(h.config){g=h.config}else{if(h.item){g=h.item.data()}}}var f=g&&g.itemModuleCompleteKey||null;b(".create-dialog-body .space-select").select2("enable",f!==e)}AJS.bind(Confluence.Dialogs.Events.ITEM_SELECTED,d)}function c(){var d="com.atlassian.confluence.plugins.confluence-questions:ask-a-space-question-blueprint-webitem";Confluence.Blueprint.setDirectCallback(d,function(g,f){f.finalUrl=Confluence.getContextPath()+"/display/"+f.spaceKey+"/questions/ask?src=createdialog"})}a();c()}(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-questions:util-resources', location = 'util/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace CQ.Templates.util.
 */

if (typeof CQ == 'undefined') { var CQ = {}; }
if (typeof CQ.Templates == 'undefined') { CQ.Templates = {}; }
if (typeof CQ.Templates.util == 'undefined') { CQ.Templates.util = {}; }


CQ.Templates.util.metaData = function(opt_data, opt_ignored, opt_ijData) {
  return '' + CQ.Templates.util.meta({prefix: 'ajs-', meta: opt_data.metaData}, null, opt_ijData);
};
if (goog.DEBUG) {
  CQ.Templates.util.metaData.soyTemplateName = 'CQ.Templates.util.metaData';
}


CQ.Templates.util.meta = function(opt_data, opt_ignored, opt_ijData) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.meta) {
    var datumList9 = soy.$$getMapKeys(opt_data.meta);
    var datumListLen9 = datumList9.length;
    for (var datumIndex9 = 0; datumIndex9 < datumListLen9; datumIndex9++) {
      var datumData9 = datumList9[datumIndex9];
      output += '<meta name="' + ((opt_data.prefix) ? soy.$$escapeHtml(opt_data.prefix) : '') + soy.$$escapeHtml(datumData9) + '" content="' + soy.$$escapeHtml(opt_data.meta[datumData9]) + '">';
    }
  }
  return output;
};
if (goog.DEBUG) {
  CQ.Templates.util.meta.soyTemplateName = 'CQ.Templates.util.meta';
}


CQ.Templates.util.actionErrors = function(opt_data, opt_ignored, opt_ijData) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.actionErrors && opt_data.actionErrors.length > 0) {
    var param25 = '<ul>';
    var errorList27 = opt_data.actionErrors;
    var errorListLen27 = errorList27.length;
    for (var errorIndex27 = 0; errorIndex27 < errorListLen27; errorIndex27++) {
      var errorData27 = errorList27[errorIndex27];
      param25 += '<li>' + soy.$$escapeHtml(errorData27) + '</li>';
    }
    param25 += '</ul>';
    output += aui.message.warning({titleContent: "The following error(s) occurred:", closeable: 'true', id: 'messageIDattribute', content: param25}, null, opt_ijData);
  }
  return output;
};
if (goog.DEBUG) {
  CQ.Templates.util.actionErrors.soyTemplateName = 'CQ.Templates.util.actionErrors';
}


CQ.Templates.util.fieldErrors = function(opt_data, opt_ignored, opt_ijData) {
  var output = '';
  if (opt_ijData.fieldErrors && opt_ijData.fieldErrors[opt_data.field]) {
    var errorList37 = opt_ijData.fieldErrors[opt_data.field];
    var errorListLen37 = errorList37.length;
    for (var errorIndex37 = 0; errorIndex37 < errorListLen37; errorIndex37++) {
      var errorData37 = errorList37[errorIndex37];
      output += aui.form.fieldError({message: " + errorData37 + "}, null, opt_ijData);
    }
  }
  return output;
};
if (goog.DEBUG) {
  CQ.Templates.util.fieldErrors.soyTemplateName = 'CQ.Templates.util.fieldErrors';
}


CQ.Templates.util.dataAttributes = function(opt_data, opt_ignored, opt_ijData) {
  opt_data = opt_data || {};
  var output = '';
  if (opt_data.attributes) {
    var keyList44 = soy.$$getMapKeys(opt_data.attributes);
    var keyListLen44 = keyList44.length;
    for (var keyIndex44 = 0; keyIndex44 < keyListLen44; keyIndex44++) {
      var keyData44 = keyList44[keyIndex44];
      output += (keyData44.indexOf('data-') != -1) ? soy.$$escapeHtml(keyData44) + '="' + soy.$$escapeHtml(opt_data.attributes[keyData44]) + '"' : '';
    }
  }
  return output;
};
if (goog.DEBUG) {
  CQ.Templates.util.dataAttributes.soyTemplateName = 'CQ.Templates.util.dataAttributes';
}


CQ.Templates.util.contentMeta = function(opt_data, opt_ignored, opt_ijData) {
  var output = '<div class="cq-content-meta ' + ((opt_data.extraClasses) ? soy.$$escapeHtml(opt_data.extraClasses) : '') + '"><ul>';
  var itemList58 = opt_data.items;
  var itemListLen58 = itemList58.length;
  for (var itemIndex58 = 0; itemIndex58 < itemListLen58; itemIndex58++) {
    var itemData58 = itemList58[itemIndex58];
    output += '<li class="' + ((itemData58.styleClass) ? 'cq-meta-li-' + soy.$$escapeHtml(itemData58.styleClass) : '') + ' ' + ((itemData58.id) ? 'cq-meta-li-' + soy.$$escapeHtml(itemData58.id) : '') + '"><a ' + ((itemData58.id) ? 'id="' + soy.$$escapeHtml(itemData58.id) + '"' : '') + ' href="' + soy.$$escapeHtml(itemData58.url) + '" class="' + soy.$$escapeHtml(itemData58.styleClass) + '"' + CQ.Templates.util.dataAttributes({attributes: itemData58.params}, null, opt_ijData) + '>' + ((itemData58.params && itemData58.params['iconClass']) ? '<span class="aui-icon aui-icon-small ' + soy.$$escapeHtml(itemData58.params['iconClass']) + '"></span>&nbsp;' : '') + soy.$$escapeHtml(itemData58.label) + '</a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  CQ.Templates.util.contentMeta.soyTemplateName = 'CQ.Templates.util.contentMeta';
}


CQ.Templates.util.compactInteger = function(opt_data, opt_ignored, opt_ijData) {
  return '' + ((opt_data.value > 999) ? '<div class="' + soy.$$escapeHtml(opt_data.extraClasses) + ' cq-tooltip" data-value="' + soy.$$escapeHtml(opt_data.value) + '" title="' + soy.$$escapeHtml(opt_data.value) + '">' + soy.$$escapeHtml(require('cq/util/util').formatInteger(opt_data.value)) + '</div>' : '<div class="' + soy.$$escapeHtml(opt_data.extraClasses) + '" data-value="' + soy.$$escapeHtml(opt_data.value) + '">' + soy.$$escapeHtml(opt_data.value) + '</div>');
};
if (goog.DEBUG) {
  CQ.Templates.util.compactInteger.soyTemplateName = 'CQ.Templates.util.compactInteger';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-request-access-plugin:confluence-request-access-plugin-resources', location = '/js/request-access.js' */
AJS.toInit(function(e){var b=AJS.Meta.get("page-id"),c=e("#page-restricted-container"),a=AJS.Meta.get("remote-user"),d=e("#page-restricted-container button");if(c.length){e("#breadcrumbs").hide();e("#title-text.with-breadcrumbs").hide();if(d.length){AJS.trigger("analyticsEvent",{name:"confluence.request.access.plugin.request.access.to.page.view",data:{pageId:b,requestAccessUser:a}})}}d.click(function(){AJS.trigger("analyticsEvent",{name:"confluence.request.access.plugin.request.access.to.page",data:{pageId:b,requestAccessUser:a}});d.attr("aria-disabled","true");var f,g=e(Confluence.Request.Access.loading({}));d.replaceWith(g);e.ajax({url:Confluence.getContextPath()+"/rest/request-access/latest/page/restriction/"+b,success:function(h){f=e(Confluence.Request.Access.result({success:true,recipient:h}));c.removeClass("page-restricted");c.addClass("access-requested")},error:function(h,i){f=e(Confluence.Request.Access.result({success:false}))},complete:function(){g.replaceWith(f);Confluence.Binder.userHover()}})})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-request-access-plugin:confluence-request-access-plugin-resources', location = '/js/grant-access.js' */
AJS.toInit(function(d){var a=AJS.Meta.get("page-id"),f=AJS.Meta.get("remote-user"),h=j("username"),e=j("userFullName");var c=e.split("+");e=c.join(" ");var g=d("#system-content-items");var k=d("#content-metadata-page-restrictions.restricted").length!==0;if(!g.length||!k||!j("grantAccess")){return}var b=d(Confluence.Request.Access.loading());var i=AJS.InlineDialog(g,"grantAccessDialog",function(m,l,n){m.css({padding:"20px"}).html(Confluence.Grant.Access.dialog({requestAccessUsername:h,requestAccessUserFullName:e}));m.on("click",".aui-button.grant-access",function(q){q.stopPropagation();var p=m.find(".actions-result");p.replaceWith(b);AJS.trigger("analyticsEvent",{name:"confluence.request.access.plugin.grant.access.to.page",data:{pageId:a,grantAccessUser:f,requestAccessUser:h}});var o="",r=true;d.ajax({url:Confluence.getContextPath()+"/rest/request-access/latest/page/restriction/"+a,type:"POST",contentType:"application/json; charset=utf-8",data:h,success:function(t,u,s){if(s.status==202){o="Access was already granted to the user."}else{o="Access was granted, a notification to the user will be sent."}},error:function(s){r=false;if(s.status==412){o="Access was granted, but there is not a mail server configured so the notification could not be sent."}else{if(s.status==502){o="Access was granted, but an unexpected error happened while sending the notification."}else{o="Sorry, there was an unexpected error while granting access."}}},complete:function(s){b.replaceWith(d(Confluence.Grant.Access.result({success:r,message:o})));setTimeout(function(){i.hide()},6000)}})});m.on("click",".aui-button.deny-access",function(o){AJS.trigger("analyticsEvent",{name:"confluence.request.access.plugin.deny.access.to.page",data:{pageId:a,grantAccessUser:f,requestAccessUser:h}});i.hide()});n();return false},{offsetY:2,offsetX:0,width:350,hideDelay:null,noBind:true,hideCallback:function(){setTimeout(i.hide(),5000)}});i.show();function j(l){l=l.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+l+"=([^&#]*)"),m=n.exec(location.search);return m==null?"":decodeURIComponent(m[1].replace(/\+/g," "))}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-request-access-plugin:confluence-request-access-plugin-resources', location = '/templates/soy/request-access.soy' */
// This file was automatically generated from request-access.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Request.Access.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Request == 'undefined') { Confluence.Request = {}; }
if (typeof Confluence.Request.Access == 'undefined') { Confluence.Request.Access = {}; }


Confluence.Request.Access.result = function(opt_data, opt_ignored) {
  var output = '<div id="request-access">';
  if (opt_data.success) {
    var usernameLink__soy6 = '' + Confluence.Request.Access.usernameLink({user: opt_data.recipient});
    output += '<span class="aui-icon aui-icon-small aui-iconfont-approve" data-unicode="UTF+E005" original-title=""></span><p class="title">' + soy.$$filterNoAutoescape(AJS.format("Your request has been sent to {0}. If approved you will receive an email shortly.",usernameLink__soy6)) + '</p>';
  } else {
    output += '<span class="aui-icon aui-icon-small aui-iconfont-error" data-unicode="UTF+E011" original-title=""></span><p class="title">' + soy.$$escapeHtml("Your request for access has not been sent. Contact your space admin.") + '</p>';
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Request.Access.result.soyTemplateName = 'Confluence.Request.Access.result';
}


Confluence.Request.Access.usernameLink = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml("") + '/display/~' + soy.$$escapeUri(opt_data.user.name) + '" class="url fn confluence-userlink" title data-username="' + soy.$$escapeHtml(opt_data.user.name) + '">' + soy.$$escapeHtml(opt_data.user.fullName) + '</a>';
};
if (goog.DEBUG) {
  Confluence.Request.Access.usernameLink.soyTemplateName = 'Confluence.Request.Access.usernameLink';
}


Confluence.Request.Access.loading = function(opt_data, opt_ignored) {
  return '<span class=\'aui-icon aui-icon-wait\'>' + soy.$$escapeHtml("Loading, please wait") + '</span>"';
};
if (goog.DEBUG) {
  Confluence.Request.Access.loading.soyTemplateName = 'Confluence.Request.Access.loading';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-request-access-plugin:confluence-request-access-plugin-resources', location = '/templates/soy/grant-access.soy' */
// This file was automatically generated from grant-access.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Grant.Access.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Grant == 'undefined') { Confluence.Grant = {}; }
if (typeof Confluence.Grant.Access == 'undefined') { Confluence.Grant.Access = {}; }


Confluence.Grant.Access.dialog = function(opt_data, opt_ignored) {
  var output = '<div class="grant-access-dialog">';
  var usernameLink__soy4 = '' + Confluence.Grant.Access.usernameLink({username: opt_data.requestAccessUsername, userFullName: opt_data.requestAccessUserFullName});
  output += '<h2 class="grant-access-title">' + soy.$$escapeHtml("Access request") + '</h2><p class="grant-access-message">' + soy.$$filterNoAutoescape(AJS.format("{0} wants to view this page.",usernameLink__soy4)) + '</p><div class="actions-result"><button class="aui-button grant-access">' + soy.$$escapeHtml("Grant access") + '</button><button class="aui-button aui-button-link deny-access">' + soy.$$escapeHtml("Deny") + '</button><div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Grant.Access.dialog.soyTemplateName = 'Confluence.Grant.Access.dialog';
}


Confluence.Grant.Access.result = function(opt_data, opt_ignored) {
  return '<span class="aui-icon aui-icon-small aui-iconfont-' + ((opt_data.success) ? 'approve' : 'error') + '" data-unicode="UTF+E011" original-title=""></span><p class="title">' + soy.$$escapeHtml(opt_data.message) + '</p>';
};
if (goog.DEBUG) {
  Confluence.Grant.Access.result.soyTemplateName = 'Confluence.Grant.Access.result';
}


Confluence.Grant.Access.usernameLink = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml("") + '/display/~' + soy.$$escapeHtml(opt_data.username) + '" class="url fn" title data-username="' + soy.$$escapeHtml(opt_data.username) + '"><strong>' + soy.$$escapeHtml(opt_data.userFullName) + '</strong> (' + soy.$$escapeHtml(opt_data.username) + ')</a>';
};
if (goog.DEBUG) {
  Confluence.Grant.Access.usernameLink.soyTemplateName = 'Confluence.Grant.Access.usernameLink';
}

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.quickedit:quick-comment-hide-traditional', location = 'jscripts/add-comment-hider.js' */
define("confluence-quick-edit/add-comment-hider",[],function(){return function(a){a("#comments-actions").hide()}});require("confluence/module-exporter").safeRequire("confluence-quick-edit/add-comment-hider",function(a){require("ajs").toInit(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
